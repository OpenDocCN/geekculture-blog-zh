<html>
<head>
<title>Reinforcement Learning Path Planner for 6DOF Robot in ROS2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于ROS2的6自由度机器人强化学习路径规划器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/reinforcement-learning-path-planner-for-6dof-robot-in-ros2-518581dc72c7?source=collection_archive---------7-----------------------#2022-07-21">https://medium.com/geekculture/reinforcement-learning-path-planner-for-6dof-robot-in-ros2-518581dc72c7?source=collection_archive---------7-----------------------#2022-07-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/212db5755d95b6a2f977499d984b7923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*REh0I3WdI6kgNR-7aUQZtg.png"/></div></div></figure><div class=""/><p id="73cb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我会给你一些例子，如何在ROS2(福克西)中创建机器人仿真。<br/> <a class="ae jo" href="https://github.com/doosan-robotics/doosan-robot2" rel="noopener ugc nofollow" target="_blank">斗山</a>协作机器人将是我们项目的一部分。我们将使用强化学习代理来寻找最优路径。我们使用数值<a class="ae jo" rel="noopener" href="/geekculture/inverse-kinematics-solver-in-c-e999f1b7f353">逆运动学</a>来计算机器人的关节位置。最后，一组机器人关节将被发送到机器人控制器，以执行避障运动。<br/>机器人将根据路径规划器(寻找A点和B点之间的最佳路径以避开障碍物)移动。有许多算法可以找到最佳路径。通常，机器人运动的最佳路径是通过例如<a class="ae jo" rel="noopener" href="/geekculture/graph-algorithms-in-c-161d2d3c245"> A*算法</a>(参见我的文章和C++实现)来搜索的，该算法在关节空间坐标空间中找到最佳路径。在这篇文章中，我们使用笛卡尔空间。强化学习代理使用贝尔曼方程进行路径计算(见我以前的<a class="ae jo" rel="noopener" href="/geekculture/reinforcement-learning-bellman-equation-in-c-b4c52b3300a9">文章</a>)。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="b923" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">项目详情</strong></h1><p id="3e93" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">为了简单起见，在这个项目中，路径是在2D (XY)中计算的，Z平面被认为是常数。我在上一篇文章中描述的强化学习的想法。这里重用了这个方法。将Z轴视为常数，代理在3×3迷宫中寻找最佳路径。请注意，在src文件夹中，您将精细实现3D planner，其中代理与27个状态(3x3x3矩阵)进行交互。迷宫的每个点都被认为是一个XYZ位置。因此，对于三维迷宫在我们的情况下可以表示为一个27个节点的立方体(正如我在这个项目中提到的，我们认为Z轴是常数，所以我们的代理在9空间环境中找到路)。<br/>当到达目标机器人位置的路径满足时(起点和目标之间的路径)。这些位置被发送到反向运动学管理器，以便(数值地)计算机器人的关节部分(对于迷宫中的节点)。反向动力学管理器计算特定方向的机器人位置，但您很容易改变(考虑代码中的注释)。模拟可以在Gazebo看到。下面考虑ROS2节点之间的“信号”流。<br/>该项目是对一般机器人运动规划问题的简化。实际上，机器人的关节空间由覆盖机器人工作空间的数千或数百万个节点来模拟。<br/>在这个项目中，我们使用简化的方法来熟悉这个可以用作路径规划器的算法。对于具有许多节点(机器人的位置)的环境，我们应用深度强化学习，其中我们的Q表(机器人的大脑)由神经网络代替(参见may以前关于深度强化学习的文章)。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="a70a" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">ROS 2中的解决方案</strong></h1><p id="2eb5" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">在接下来的部分，我将描述允许你从头开始构建ROS2模拟的步骤。你也可以在我的<a class="ae jo" href="https://github.com/markusbuchholz/6DOF_Robot_in_ROS2_Doosan" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整的工作包。<br/>注。我不打算预设ROS2的架构以及它是如何工作的。有优秀的文档:<a class="ae jo" href="https://docs.ros.org/en/foxy/index.html" rel="noopener ugc nofollow" target="_blank"> ROS2 </a>，<a class="ae jo" href="https://moveit.picknik.ai/foxy/index.html" rel="noopener ugc nofollow" target="_blank"> Moveit </a>，<a class="ae jo" href="https://control.ros.org/master/index.html" rel="noopener ugc nofollow" target="_blank"> Control </a>。<br/>我也推荐一下<a class="ae jo" href="https://classic.gazebosim.org/tutorials?tut=ros_urdf" rel="noopener ugc nofollow" target="_blank"> URDF在凉亭的教程</a>。</p><p id="254e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一开始，创造你的工作空间。这里我创建了robotPP(在“colcon build”命令之后)</p><figure class="la lb lc ld fd hk er es paragraph-image"><div class="er es kz"><img src="../Images/a366e7f544ac81934ba32fcc646968b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*xg-0hqgnuV3VK56SKYNKJw.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx">after command: colcon build</figcaption></figure><p id="fdc0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如你在下图中看到的，在src中有4个文件夹(包),你将一步一步地创建它们。<br/> <strong class="is hu"> ai_path_planner_pkg </strong>是一个主包，在这里你可以启动你的主函数。<br/> <strong class="is hu"> gazebo_ros2_control </strong>是一个负责控制我们将要使用的机器人的包。我们将从官方仓库克隆这个包。<br/> <strong class="is hu"> ik_interface </strong>是管理节点间数据的<a class="ae jo" href="https://docs.ros.org/en/foxy/Tutorials/Beginner-CLI-Tools/Understanding-ROS2-Services/Understanding-ROS2-Services.html" rel="noopener ugc nofollow" target="_blank">服务</a>包。在此项目中,( ai_path_planner_pkg)中的主程序通过服务包(在本例中为ik_iterface)与其ik_manager通信。<br/>请检查ik _ interface/SRV/XYZ points . SRV中的文件。前三行是请求的参数(发送给管理器)，破折号下面是响应(计算的联合)。</p><pre class="la lb lc ld fd li lj lk ll aw lm bi"><span id="1807" class="ln jx ht lj b fi lo lp l lq lr">float32 x<br/>float32 y<br/>float32 z<br/>---<br/>float32 j1<br/>float32 j2<br/>float32 j3<br/>float32 j4<br/>float32 j5<br/>float32 j6</span></pre><p id="ded7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> robot_ik </strong>是机器人逆运动学的“管理者”。经理用数字计算机器人关节。这些计算的输入是由强化学习代理“建立”的XYZ位置XYZ。XYZ位置和计算关节通过上述定义的服务(IK_interface)传输</p><p id="f73a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在src文件夹中执行以下“操作”:</p><pre class="la lb lc ld fd li lj lk ll aw lm bi"><span id="9a47" class="ln jx ht lj b fi lo lp l lq lr">// 1. <br/>ros2 pkg create --build-type ament_python ai_path_planner_pkg --dependencies rclpy</span><span id="8948" class="ln jx ht lj b fi ls lp l lq lr">// 2.<br/>ros2 pkg create --build-type ament_cmake ik_interface<br/>cd ik_interface/<br/>mkdir srv</span><span id="314a" class="ln jx ht lj b fi ls lp l lq lr">// 3.<br/>ros2 pkg create --build-type ament_python robot_ik</span><span id="ff03" class="ln jx ht lj b fi ls lp l lq lr">// 4.<br/>git clone -b foxy <a class="ae jo" href="https://github.com/ros-simulation/gazebo_ros2_control.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ros-simulation/gazebo_ros2_control.git</a></span></pre><p id="3622" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行上面的命令，你的机器上应该有类似的文件夹设置。请查看我的<a class="ae jo" href="https://github.com/markusbuchholz/6DOF_Robot_in_ROS2_Doosan" rel="noopener ugc nofollow" target="_blank"> gitHub </a>以便检查项目设置。</p><figure class="la lb lc ld fd hk er es paragraph-image"><div class="er es lt"><img src="../Images/75d5d252a2d4eac0970f214ed6793f58.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*SHQulM3430g_4F-hhsgsqA.png"/></div></figure><p id="d471" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我将把重点放在ai_path_planner_pkg包上，因为它包括机器人的定义、启动文件和控制设置。<br/>该文件夹如下所示</p><figure class="la lb lc ld fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lu"><img src="../Images/ed6d9ba1f701c329e8e68854bbaaffb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzmSKlegNplq77bVDkUf_g.png"/></div></div></figure><p id="40b2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">文件夹/描述包括“构建”机器人虚拟模型所需的所有文件。子文件夹和包含的文件由斗山机器人生成(见<a class="ae jo" href="https://github.com/doosan-robotics/doosan-robot2/tree/master/dsr_description2" rel="noopener ugc nofollow" target="_blank">此处</a>)。启动文件夹包括启动Gazebo模拟的python脚本。在python脚本中，我们调用定义机器人的第一个xacro文件(机器人运动学和物理参数，如:质量、惯性、链接类型、速度等)。<br/>为了影响机器人运动，您必须调用控制器(见macro . gazebo _ config _ control . xacro ),正如您所想象的，该控制器可被视为机器人(如moveL或moveJ)命令和物理机器人(此处为Gazebo中的模拟)之间的接口。控制器接受命令并计算关节轨迹，以实现目标。</p><p id="59fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您必须构建和采购:</p><pre class="la lb lc ld fd li lj lk ll aw lm bi"><span id="7dca" class="ln jx ht lj b fi lo lp l lq lr">colcon build</span></pre><p id="ad10" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在打开您的终端(或终端)并运行以下命令(在终端的单独实例中运行命令)</p><pre class="la lb lc ld fd li lj lk ll aw lm bi"><span id="58b6" class="ln jx ht lj b fi lo lp l lq lr">ros2 run robot_ik doosan_inverse<br/>ros2 launch ai_path_planner_pkg ai_gazebo_controller.launch.py<br/>ros2 run ai_path_planner_pkg reach_target</span></pre><p id="d14f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器人的预期运动。</p><figure class="la lb lc ld fd hk er es paragraph-image"><div class="er es lv"><img src="../Images/90b83d9997e65efe2510086af5181fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*qSMggLtbrsOSf9n3w7NUTA.gif"/></div></figure><p id="2bb1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">参考文献:</strong></p><p id="323d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大卫·瓦伦西亚</p><p id="966d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">[2] <a class="ae jo" href="https://roboticscasual.com/" rel="noopener ugc nofollow" target="_blank">机器人休闲</a></p></div></div>    
</body>
</html>
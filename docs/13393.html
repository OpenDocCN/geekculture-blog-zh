<html>
<head>
<title>Enemy Wave Spawner in Unity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">统一中的敌人波产卵器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/enemy-wave-spawner-in-unity-f6d63f1dce4d?source=collection_archive---------3-----------------------#2022-07-06">https://medium.com/geekculture/enemy-wave-spawner-in-unity-f6d63f1dce4d?source=collection_archive---------3-----------------------#2022-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/45f7991df4a31d0585f122422b2d8fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5Lnk5l_ihjlKp5cHaOZ_Rg.gif"/></div></div></figure><p id="723d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天的核心编程挑战将集中在使用协程来控制我们的敌人如何进入游戏。</p><p id="470b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目标:创造一个协程，让每波都有越来越多的敌人出现。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="0b4e" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">添加波形指示器文本</h1><p id="b85c" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">我们将使用一组变量来控制wave的生成，另一组变量用来设置屏幕上的wave指示器文本。对于文本，我们将使用<a class="ae ky" href="https://docs.unity3d.com/Manual/com.unity.textmeshpro.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> TextMeshPro </strong>，</a>一种更高级的高质量替代常规UI文本。</p><ol class=""><li id="c583" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">添加一个TextMeshPro并相应地重命名，例如WaveText或WaveIndicator_text。</li></ol><blockquote class="li lj lk"><p id="5386" class="iq ir ll is b it iu iv iw ix iy iz ja lm jc jd je ln jg jh ji lo jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:如果你以前从未使用过TextMeshPro，你可能需要导入它的基本组件。</p></blockquote><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/4a7fc98bbe552c8a6040c377f5a85c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gVNQsgMHzxS3ZXRbM09YAg.gif"/></div></div></figure><p id="0a8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">保留文本为空，并在检查器中停用它，因为它的内容将在以后通过代码添加。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/e128573b9883c6a604ee4a9821ced776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xfAo4PbaJvTOg9-r9RW8NQ.gif"/></div></div></figure><p id="a355" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">确保文本位置居中。您可以添加一些占位符文本来调整其位置。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/f4c6b26144e7fa645adb1a628cabdb39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DpiFDSwFBf6sTYL2wMTehw.gif"/></div></div></figure><p id="8ae5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.要使用TextMeshPro，您需要<strong class="is hj">将其特定的库添加到您的脚本</strong>中。理想情况下，您的脚本应该专门用于处理繁殖。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/c67f70b3bfed92ccea620a0cf32b6bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*F9idWe79Ys53maIJYLXV3w.png"/></div></figure><p id="dc95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.现在一切都设置好了，我们需要一个文本的全局变量，序列化的变量将在inspector中赋值。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/e76840e629babeddc911a6a5d5738798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ep0Xyu_VQAKk8HZV8kUAQ.png"/></div></div></figure><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/85d87dfa769184a30b6d94853680565e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OVSbXLYD64cxfI-AbDnZ4A.gif"/></div></div></figure><p id="e662" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.添加全局变量来控制种子。这可能看起来很多，但我们将一个接一个地讨论。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/f71458cfa0a8cb5a6d2cf0ebd9a993ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SByW1spVq_EOw5xPNzA6TA.png"/></div></div></figure><blockquote class="li lj lk"><p id="715f" class="iq ir ll is b it iu iv iw ix iy iz ja lm jc jd je ln jg jh ji lo jk jl jm jn hb bi translated"><strong class="is hj">注</strong>:您可以根据需要修改数值变量的值。</p></blockquote><ul class=""><li id="1506" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn ma lf lg lh bi translated"><strong class="is hj">波数:</strong>这将记录波数，并在必要时增加数量。</li><li id="eb93" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">敌人计数:</strong>负责增加每波的敌人数量。</li><li id="46b1" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj"> waveTextTimer: </strong>文本在屏幕上显示多长时间后会褪色。</li><li id="d0e3" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">产卵率:</strong></li><li id="13cf" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">波间时间:</strong>每一波开始需要多长时间。</li><li id="ec17" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj"> _isWaveActive: </strong>这是控制协程所需要的，我们将在本文的下一部分对协程进行编码。</li><li id="5fa3" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">_ stop spacing:</strong>协程的附加控制变量。您的脚本可能不需要使用两个bool变量，在这种情况下，只使用_isWaveActive bool就可以了。在我的例子中，这是必要的，因为在两种情况下，控制布尔值需要改变它们的默认值:当屏幕上有一个游戏时，其中_stopSpawaning必须设置为true，因为继续产生玩家已经失去的波浪或能量没有意义。第二个实例是每当需要启动一个新的wave时，其中_isWaveActive必须设置为true。因此，这两个变量需要相互独立。</li></ul></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="b805" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">创建敌人波产卵器协程</h1><p id="6ce6" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">如果你想知道什么是协程，这是我迄今为止从C#中学到的最喜欢的东西之一！你可以通过下面的链接了解更多。这将教你开始时需要知道的东西，我将在本文中重点解释Wave Spawn例程。</p><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/codex/coroutines-with-unity-b5a2b3fc3426"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">统一的协程！</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">任何在Unity中编程的人都知道，迟早你会积累大量的方法…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx io mj"/></div></div></a></div><ol class=""><li id="3356" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn le lf lg lh bi translated">这是我们协程的第一部分，在这里我们随机选择敌人将从哪个位置产生，我们也随机选择哪些敌人类型将产生。我的游戏目前有6种敌人类型，它们通过一个带有SerializedField的GameObject数组在检查器中设置。这里的<strong class="is hj"> _isWaveActive被设置为false </strong>，因为我们的spawn例程还没有开始，这只是设置。</li></ol><figure class="lq lr ls lt fd ij er es paragraph-image"><div class="ab fe cl my"><img src="../Images/aa2df83e3e2585c494adbf60c04ab6e3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*BlorFT0b3Nu1eNLuGuNk7w.png"/></div></figure><blockquote class="li lj lk"><p id="e9af" class="iq ir ll is b it iu iv iw ix iy iz ja lm jc jd je ln jg jh ji lo jk jl jm jn hb bi translated">注意:由于我们将会产生很多敌人，学习如何在不打乱你的层级的情况下产生物体可能是有用的。</p></blockquote><div class="mg mh ez fb mi mj"><a href="https://levelup.gitconnected.com/spawning-objects-without-clutter-in-unity-c23c2aa347ed" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hj fi z dy mo ea eb mp ed ef hh bi translated">在Unity中生成没有混乱的对象</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">对象的迭代生成可能是核心游戏循环的重要部分。然而，有些时候…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="ms l"><div class="mz l mu mv mw ms mx io mj"/></div></div></a></div><p id="81cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.接下来，我们将使用for循环对wave逻辑进行给定次数的迭代。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/fc370bc8687c6b9d2643f255b05677e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N9QndKMGrhUcrfgitzPtBw.png"/></div></div></figure><ul class=""><li id="80dd" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn ma lf lg lh bi translated">ActivateWaveText: 这是一个负责显示波数文本的方法，它被放在一个单独的方法上，以保持协同程序尽可能的整洁和可理解。</li><li id="1e20" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated">接下来的几行将使Unity等待指定的秒数，然后通过取消激活使文本消失。</li></ul><blockquote class="li lj lk"><p id="0500" class="iq ir ll is b it iu iv iw ix iy iz ja lm jc jd je ln jg jh ji lo jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:这是前面提到的从协程调用的方法。这将更新显示实际数字和波形文本的cout。随着我们继续使用协程，您将看到这是如何实现的。</p></blockquote><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/2b179bb2c1257586361931e5de58cb12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XbsXZqx3oxTcGDvTRx0bWA.png"/></div></div></figure><p id="b09a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.下一组，这里突出显示的代码，是我们实际实例化对象的地方。繁殖速率控制敌人被实例化到场景中的速率。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/6b50f422ef7b8cd834a20f651d5ff68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_tIQ_nSUGiXuld6cHDozQ.png"/></div></div></figure><p id="a7cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.在这个集合之后，我们有一个if语句，它定义了当你到达最后一波时会发生什么。最后一波可以是你想要的任何数字，在我的例子中，是第五波。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/abd4baa3c80650913b3cb7e90a040179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AU6A_rGrFO215SpFbpvs1w.png"/></div></div></figure><p id="de1a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里发生了很多事情，让我们来分析一下！</p><ul class=""><li id="f673" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn ma lf lg lh bi translated">当我的游戏到达第五波时，将会出现一个3秒钟的文字，提示boss大战即将到来。(我会在后面的文章里教你我的boss搏击码！)</li><li id="60bd" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated">这里有一个方法可以结束敌人的波动，因为我们不能让敌人在转换到boss战时攻击玩家。</li><li id="3d4b" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated">这一波结束后，我们加载下一个场景，这是老板打架。</li></ul><blockquote class="li lj lk"><p id="5db5" class="iq ir ll is b it iu iv iw ix iy iz ja lm jc jd je ln jg jh ji lo jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:上面代码末尾的两个括号关闭了if语句，然后是for循环。我想在这里设置一个小标记，因为我已经展示了代码块。我将在最后展示一个完整的视图，这只是为了分解它。</p></blockquote><p id="9f06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是前面提到的结束波浪的方法。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/7811e2d36e566edf2d632966f0c0b037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92WaR0eHJE3PH_VLxAhCsQ.png"/></div></div></figure><ul class=""><li id="8b28" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn ma lf lg lh bi translated">这里我们将_ stopSpawning控制布尔设置为true，这将停止协程。</li><li id="4522" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated">下一行搜索每一个被标记为敌人的物体并摧毁它。这是为了确保没有任何敌人从浪潮中幸存下来。</li></ul><p id="c329" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.关闭if语句和for循环后，我们必须为下一波更新所有内容。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/94c0474d37f600e8fc6afb3d07ccf84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VE4pewBmA1y4mEhQyUzXDA.png"/></div></div></figure><ul class=""><li id="eb6c" class="kz la hi is b it iu ix iy jb lb jf lc jj ld jn ma lf lg lh bi translated"><strong class="is hj">产卵率</strong>将会降低，这样敌人产卵会更快，每波会有越来越多的敌人产卵。</li><li id="533c" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">敌人计数</strong>增加以保持for循环条件运行</li><li id="c9b9" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj">在增加<strong class="is hj">波数</strong>之前，等待指定的秒数</strong>，这导致波数增加。</li><li id="b4a7" class="kz la hi is b it mb ix mc jb md jf me jj mf jn ma lf lg lh bi translated"><strong class="is hj"> _isWaveActive </strong>再次被设置为真，以便协程在下一波设置完成后继续运行。</li></ul><p id="c4b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在剩下的就是将脚本添加到场景中的一个空游戏对象中，并在脚本开始时调用协程。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/0295ec46207e9ceb0c6d577304f1c081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aqhr0ShNYVgpBrwEcmloDg.png"/></div></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="10af" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">这里是代码的完整视图</h1><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/94fd01acce64d9259a301ccffb2b78e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qV8h5CVBRl6bNwRv_YXuyg.png"/></div></div></figure><h1 id="a185" class="jv jw hi bd jx jy nh ka kb kc ni ke kf kg nj ki kj kk nk km kn ko nl kq kr ks bi translated">结果呢</h1><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nm"><img src="../Images/c8c18bcd5a65d1bf1090cd023f6b6d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aYF41pLEn6V913wcIw45PQ.gif"/></div></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="4940" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文是GameDevHQ的核心编程挑战系列的一部分！在下一篇文章中，我将谈论寻的射弹！这组编码挑战的最后一篇文章将以本文中提到的boss之战为特色。</p><p id="815d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特别感谢技术朋友帮助我理解我应该实现的那种逻辑。剖析这段代码的功能并分解所有内容简直是一场爆炸！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Go Geospatial in Home Finding with Google Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌云在家庭搜索中使用地理空间</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/get-geo-data-from-google-cloud-for-your-next-new-home-f0a02c185d5f?source=collection_archive---------4-----------------------#2021-02-28">https://medium.com/geekculture/get-geo-data-from-google-cloud-for-your-next-new-home-f0a02c185d5f?source=collection_archive---------4-----------------------#2021-02-28</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><h1 id="a864" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">介绍</h1><p id="6b57" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">寻找新家是一项艰巨的任务。买家被信息轰炸。除了经纪人提供的通常数据之外，买家通常希望了解更多关于邻居的信息，即所谓的地理空间数据或“geo”。这包括基本的和一般的问题，如“附近有多少超市和学校？”到更个人化的问题，比如“离我工作的地方有多远，开车去需要多长时间”。</p><p id="25f2" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">如果名单很短，在谷歌地图上搜索几下，甚至亲自实地查看一下，就有可能回答所有这些问题。但通常情况下，买家首先会在房地产网站上进行筛选。在那里，他们通过价格、面积、朝向和房间数量等常见参数进行筛选。地理空间数据将真正成为这一过程的一部分。因此，挑战在于:如何一次获得大量房产的邻居信息？幸运的是，在一点Python和谷歌云的帮助下，这很容易做到(图。1).</p><p id="5de8" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">在本教程中，我将向您展示如何获得两个重要的地理空间数据:首先是1公里半径内的学校，其次是距离和开车上班的时间。</p><p id="ffe1" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">这三个函数的脚本可以在这里找到。</p><div class="kh ki fa fc kj kk"><a href="https://github.com/dgg32/google_house" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dx"><div class="km ab kn cl cj ko"><h2 class="bd hk fj z dz kp eb ec kq ee eg hi bi translated">GitHub - dgg32/google_house</h2><div class="kr l"><h3 class="bd b fj z dz kp eb ec kq ee eg dy translated">这个库包含了博客文章的代码:使用谷歌云在家中查找地理空间，它包含三个…</h3></div><div class="ks l"><p class="bd b fq z dz kp eb ec kq ee eg dy translated">github.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky kz kk"/></div></div></a></div><h1 id="d2d5" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">建筑师</h1><p id="4325" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">在本教程中，我们需要Google Cloud，确切地说是三个Google APIs:</p><ol class=""><li id="05cf" class="la lb hj jg b jh kc jl kd jp lc jt ld jx le kb lf lg lh li bi translated">“distancematrix”可以为我们提供两个地址之间的距离和行驶时间，在我们的案例中是工作地址和财产地址。</li><li id="4e95" class="la lb hj jg b jh lj jl lk jp ll jt lm jx ln kb lf lg lh li bi translated">“地理编码”将文字地址转换成纬度和经度(lat-lon)对。</li><li id="ad5a" class="la lb hj jg b jh lj jl lk jp ll jt lm jx ln kb lf lg lh li bi translated">“nearbysearch”采用纬度-经度对、机构类型和可选的搜索半径，并返回机构列表。</li></ol><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et lo"><img src="../Images/908ef1917e6a2a31aa3c977b602b8b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52FU4UUKKbdnpwTwK9i9sQ.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 2. Details of the architect</figcaption></figure><p id="793e" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">我创建了一个Github库来存放项目代码。然而，在我们使用这些功能之前，我们需要创建一个Google Cloud项目，启用API，获取凭证密钥，并将这个密钥放在config.py中。</p><div class="kh ki fa fc kj kk"><a href="https://github.com/dgg32/google_house" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dx"><div class="km ab kn cl cj ko"><h2 class="bd hk fj z dz kp eb ec kq ee eg hi bi translated">dgg32/google_house</h2><div class="kr l"><h3 class="bd b fj z dz kp eb ec kq ee eg dy translated">这个库包含了博客文章的代码:使用谷歌云在家中查找地理空间，它包含三个…</h3></div><div class="ks l"><p class="bd b fq z dz kp eb ec kq ee eg dy translated">github.com</p></div></div><div class="kt l"><div class="md l kv kw kx kt ky kz kk"/></div></div></a></div><h1 id="8220" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated"><strong class="ak">谷歌云设置</strong></h1><p id="d917" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">前往谷歌云控制台，点击“谷歌云平台”旁边的项目下拉菜单，创建一个名为“邻居检查”的项目。初始化后，单击进入项目。</p><p id="0e19" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">单击“API和服务”-&gt;“仪表板”-&gt;“启用API和服务”。在搜索栏中，搜索并启用以下API:</p><ol class=""><li id="d015" class="la lb hj jg b jh kc jl kd jp lc jt ld jx le kb lf lg lh li bi translated">地理编码API</li><li id="6a5f" class="la lb hj jg b jh lj jl lk jp ll jt lm jx ln kb lf lg lh li bi translated">距离矩阵API</li><li id="0865" class="la lb hj jg b jh lj jl lk jp ll jt lm jx ln kb lf lg lh li bi translated">位置API</li></ol><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et me"><img src="../Images/d4511ee7841b96fec8559235e95b8e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gk5mIaA84SknFPV74g0_EQ.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 3. Add the “Places API”</figcaption></figure><p id="da31" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">因此，在添加这些API之后，您的“API”页面应该看起来像这样:</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et mf"><img src="../Images/b353a850c1b2f1cbf440434193c8c154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmPUbDE-cImjZDRIxlnm0w.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 4. Enabled APIs</figcaption></figure><p id="e695" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">之后，点击“凭证”-&gt;“创建凭证”-&gt;“API密钥”。</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et mg"><img src="../Images/a0a02e28112f00a260b5f83eaf7521d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n26zK_P-EtyL4P13K4WRg.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 5. Create an API key</figcaption></figure><p id="9ce7" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">出现一个标题为“API key created”的弹出窗口。用“复制”按钮复制“你的API key”，粘贴到“config.py”中的API_KEY变量中。</p><p id="2ac2" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">最后，我们需要为这个项目启用计费。进入<a class="ae mh" href="https://console.cloud.google.com/project/_/billing/enable" rel="noopener ugc nofollow" target="_blank">计费页面</a>，选择项目“邻居检查”，在弹出窗口中选择“计费账户”，点击“设置账户”。</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et mi"><img src="../Images/6cafed8ac0a85e55fc5be4e0ba2b98be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-JaYGgm8tsN6FkXTV6uUQ.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 6. How to enable billing.</figcaption></figure><p id="f7b9" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">请注意，默认情况下，谷歌云只允许五个项目与一个计费账户相关联。因此，如果您收到关于“无法启用计费”的消息，您可以请求增加您的配额，或者在您的旧项目中禁用计费以腾出空间。</p><h1 id="ed7f" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">使用Python提取地理空间信息</h1><p id="ad93" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">一旦设置完成，与这些Google APIs进行交互并提取我们需要的地理空间信息是非常容易的。由于它们是REST APIs，几乎所有的编程语言都可以与之交互。这里，我使用Python展示了图3中提到的三个函数。</p><p id="ae71" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">在我的<a class="ae mh" href="https://github.com/dgg32/google_house" rel="noopener ugc nofollow" target="_blank">仓库</a>里，我打包了三个Python文件。“config.py”存储API密钥，“functions.py”包含与Google APIs通信的三个函数。最后，在“demo.py”中，我将我的位置设置为“赫尔佐格·安东·乌尔里希博物馆”，将我的工作地点设置为我的实际雇主德国DSMZ·布伦瑞克的地址。</p><figure class="lp lq lr ls fe lt"><div class="bz dz l di"><div class="mj mk l"/></div></figure><p id="3af3" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">如您所见，坐标、博物馆周围的前五所学校以及博物馆与DSMZ之间的距离被成功返回:</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et ml"><img src="../Images/c2d24faae44ed68481ead489830d44a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SW2omKrwau58SffP29cMvw.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 7. The output of demo.py</figcaption></figure><h1 id="9809" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">将地理空间数据添加到房屋搜索中</h1><p id="abb6" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">有了这些功能，我们就能丰富找房子的体验。从你的经纪人或他们的网站上，你可以得到诸如价格、面积、方位等数据，最重要的是，房产的地址。在设置了房产和工作地点的地址之后，你应该获得关于邻居和工作距离的信息。我没有在这里提供脚本，因为数据收集和后来的数据集成都过于个性化和网站特定。</p><p id="327b" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">但是在下图中，你可以看到我已经在中国广州自己的找房子中使用了我的函数。基本房产数据由<a class="ae mh" href="https://m.lianjia.com/" rel="noopener ugc nofollow" target="_blank">贾立安</a>提供。我在表中添加了“纬度”、“经度”、“学校_计数”、“超市_计数”、“上班开车时间”和“上班距离”。</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et mm"><img src="../Images/e31b29f5b2ca5cbcf3c7722ddb8b4fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWGyeGcpJHEuzDGuZgwb3w.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 8. My own house hunt with the help of Google Cloud</figcaption></figure><p id="1681" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">事实上，在地理编码之后，我甚至可以用<a class="ae mh" href="https://python-visualization.github.io/folium/" rel="noopener ugc nofollow" target="_blank">叶子</a>来绘制属性(图9。).有了这张图和这些数字，我可以对一些候选房产有一种空间感，并大大缩小我的搜索范围。</p><figure class="lp lq lr ls fe lt es et paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="es et mn"><img src="../Images/9ebddf7cd0187214f992fd007335cd35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpySDp7I5gEOuQS1uQVbXA.png"/></div></div><figcaption class="lz ma eu es et mb mc bd b be z dy">Figure 9. Plotting the properties with folium</figcaption></figure><h1 id="cfa5" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">费用</h1><p id="5492" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">然而，所有这些巨大的好处并不完全是免费的。在附近搜索时要格外小心。谷歌每月慷慨地给我们200美元的“地点”和“路线”积分。即“距离矩阵”中的前40000个电话和“附近搜索”中的前5000个电话都在Goolge上。但是一旦每月配额用完，你将在“距离矩阵”中被收取每1000个电话5美元的费用，在“附近搜索”(<a class="ae mh" href="https://cloud.google.com/maps-platform/pricing/sheet" rel="noopener ugc nofollow" target="_blank">价格表</a>)中被收取每1000个电话40美元的巨额费用。问题是，附近的搜索通常会返回几页结果，查看每一页都被视为一次访问(Stackoverflow讨论<a class="ae mh" href="https://stackoverflow.com/questions/54558881/what-is-the-price-for-a-call-to-google-place-near-by-search-api-next-results" rel="noopener ugc nofollow" target="_blank">这里</a>和Reddit讨论<a class="ae mh" href="https://www.reddit.com/r/webdev/comments/8vrkm6/google_places_api_new_pricing_from_0_to_2180_per/" rel="noopener ugc nofollow" target="_blank">这里</a>)。因此，一个不小心的“for循环”会很快增加成本。</p><p id="037d" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">我不得不承认，我找房子时收到了一大笔账单。因为我的列表有大约1300个属性，我做了一些重新运行，所以我总共进行了大约7700次附近搜索API调用。结果，那个月结束时，我收到了一份令人瞠目结舌的€135.02英镑的账单。</p><p id="fee0" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">但是不要因为我的经历而气馁，因为这是完全可以避免的。我建议疏用这些函数。首先，也是最重要的，首先根据其他标准缩短候选列表，然后在上面运行这些Google APIs。第二，通过将您的通话时间分配到不同的月份来利用每月点数。但是后者会有风险，你的候选房产可能会在你等待下个月贷款的时候被卖掉。所以平衡你的选择是很重要的。</p><h1 id="9538" class="ig ih hj bd ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd bi translated">结论</h1><p id="3027" class="pw-post-body-paragraph je jf hj jg b jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb hc bi translated">我必须承认，这整件事是一个非常古怪的方式来完成一个古老的任务，那就是找房子。即使不是所有人，大多数人也可以在不知道谷歌云是什么的情况下找到他们的下一个梦想家园。但是嘿，这个时代，一切都是“数据驱动”的。因此，对于我们这些极客来说，充分利用谷歌所能提供的东西并没有错。在找房子的过程中，就像在其他柠檬市场一样，我们获得的数据越多，我们就越能稍微平衡对经纪人的不利，我们就能做出更好的决定。</p><p id="3ebe" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">这个项目正好说明了这一点。有了Google APIs和一些数据争论，丰富我们最初的数据收集是可能的。我相信来自谷歌的地理空间数据有助于一个好的购买。它节省了我们大量的参观时间，并帮助我们比较一个简短的属性列表。事实上，这种技巧也可以用在你寻找新办公室甚至新工厂的时候。</p><p id="e8eb" class="pw-post-body-paragraph je jf hj jg b jh kc jj jk jl kd jn jo jp ke jr js jt kf jv jw jx kg jz ka kb hc bi translated">找房子开心！</p><div class="kh ki fa fc kj kk"><a href="https://dgg32.medium.com/membership" rel="noopener follow" target="_blank"><div class="kl ab dx"><div class="km ab kn cl cj ko"><h2 class="bd hk fj z dz kp eb ec kq ee eg hi bi translated">加入媒介与我的介绍链接-黄思兴</h2><div class="kr l"><h3 class="bd b fj z dz kp eb ec kq ee eg dy translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ks l"><p class="bd b fq z dz kp eb ec kq ee eg dy translated">dgg32.medium.com</p></div></div><div class="kt l"><div class="mo l kv kw kx kt ky kz kk"/></div></div></a></div></div></div>    
</body>
</html>
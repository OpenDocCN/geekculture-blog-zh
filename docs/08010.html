<html>
<head>
<title>Building Your First App Using C++ Builder (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用C++ Builder构建您的第一个应用程序(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/building-your-first-app-using-c-builder-part-2-dc26040bffb8?source=collection_archive---------11-----------------------#2021-10-10">https://medium.com/geekculture/building-your-first-app-using-c-builder-part-2-dc26040bffb8?source=collection_archive---------11-----------------------#2021-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e4a9e377a3b388d8c697cb1837e8f31d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1VD0SANNsqpwH6r2xOafg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@kellysikkema?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Kelly Sikkema</a> on <a class="ae iu" href="https://unsplash.com/s/photos/app?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6105" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">欢迎回到我们关于在<a class="ae iu" href="https://www.embarcadero.com/products/cbuilder?utm_source=Medium&amp;utm_medium=Leads%20Acquisition&amp;utm_content=BuildingYourFirstAppUsingBuilderPart2&amp;utm_campaign=BuildingYourFirstAppUsingBuilderPart2" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> C++Builder </strong> </a>中创建提醒应用的系列！</p><p id="15da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们上一篇文章讨论了<a class="ae iu" href="https://learncplusplus.org/how-to-set-up-cbuilder-for-your-first-project/" rel="noopener ugc nofollow" target="_blank">如何设置C++Builder </a>，通过拖拽组件设计用户界面，编写代码控制一些组件。</p><p id="d3be" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">如果你没有读过:</em> <a class="ae iu" rel="noopener" href="/geekculture/building-your-first-app-using-c-builder-part-1-e400789f03b3"> <em class="jt">使用C++ Builder构建你的第一个应用(第一部分)</em> </a></p><p id="43dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这一部分将把SQLite集成到应用程序中，并尝试将用户添加的提醒存储到数据库中。</p><p id="da36" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将提醒添加到数据库后，我们将在用户请求时向他们显示提醒。</p><h1 id="7161" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">第四步:创建数据库</h1><p id="3599" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated"><a class="ae iu" href="https://www.embarcadero.com/products/cbuilder?utm_source=Mediumn&amp;utm_medium=Leads%20Acquisition&amp;utm_content=BuildingYourFirstAppUsingCBuilderPart2&amp;utm_campaign=BuildingYourFirstAppUsingCBuilderPart2" rel="noopener ugc nofollow" target="_blank"> C++Builder </a>允许你在一个带有FireDAC库的程序中使用多个数据库。我们将把我们的SQLite数据库集成到这个应用程序中。</p><p id="f412" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们需要从下载和安装SQLite数据库开始。请随意选择您想要使用的数据库。</p><p id="4dc7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，firedac允许您将多个数据库集成到应用程序中。下载并设置好数据库后，您需要选择数据库的类型并将其链接到您的应用程序。</p><p id="9f1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">双击设计表单中的Fdconnection。此操作将打开firedac连接编辑器。在这里，您可以选择要使用的数据库的名称，并提供有关该数据库的更多详细信息。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/bea7bd2e8247f1f0647619072dc3d4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fOosPix2NQQeabhZ"/></div></div></figure><p id="fcdd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于这个简单的应用程序，我们需要修改的只是驱动程序Id和我们在桌面上创建的数据库的位置(在数据库标签旁边)。</p><p id="dde1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成这一步后，我们可以开始编写代码从数据库中检索数据，并将从用户那里收集的数据存储到数据库中。</p><p id="3127" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在位于以下路径的桌面上创建了一个数据库:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="bbe6" class="lh jv hi ld b fi li lj l lk ll"><em class="jt">C:\\Users\\uk\\OneDrive\\Desktop\\reminderdb.db</em></span></pre><h1 id="d4ad" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">第五步:写入数据库</h1><p id="6ac9" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">当我们单击add reminder按钮时，我们希望获取用户的当前时间，以及分别使用时间和日期时间选择器选择的日期，并将它们存储到数据库中。</p><p id="d6e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将需要编写一些SQL语句，以便在数据库中创建一个提醒表(如果它还不存在的话),并在触发onClick事件时将日期/时间值作为字符串插入到数据库中。</p><p id="671b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还添加了一个“显示提醒”按钮，从数据库中检索提醒，并在备忘录中显示它们。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/2c60298878643eaa5e6fedb32a439bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3kw3zFXPLfNNjwN2"/></div></div></figure><p id="d2c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">双击“添加提醒”按钮，为“添加提醒”按钮创建一个空的快速调用功能。在这个函数中，我们将利用FDConnection连接到数据库。</p><p id="1917" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">需要指定数据库的驱动程序名称和路径。这将有助于程序识别将与之通信的数据库的位置。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="ecf0" class="lh jv hi ld b fi li lj l lk ll">FDConnection1-&gt;DriverName = "SQLite";<br/>FDConnection1-&gt;Params-&gt;Values["Database"] = "C:\\Users\\uk\\OneDrive\\Desktop\\reminderdb.db";</span></pre><p id="19f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成后，您可以编写代码来修改、插入、更新、删除或检索数据库中的数据。首先使用以下命令打开到数据库的连接，</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="3002" class="lh jv hi ld b fi li lj l lk ll"><em class="jt">FDConnection1-&gt;Open();</em></span></pre><p id="da30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该命令与close database命令一起使用，一旦我们执行完所有查询，我们将需要使用以下命令关闭与数据库的连接:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="0263" class="lh jv hi ld b fi li lj l lk ll"><em class="jt">FDConnection1-&gt;Close();</em></span></pre><p id="eeac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">建立并打开通信门户后，如果提醒数据库中没有提醒表，我们将执行SQL语句来创建提醒表。</p><p id="97d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该表只需要两个字段，即id字段和DateTime字段，以字符串格式存储。</p><p id="a400" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了创建一个表，我们可以调用ExecSQL语句来执行一个SQL查询。</p><p id="e4f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每当您想要创建表、插入或删除数据时，都可以调用这个ExecSQL函数，但是如果需要从数据库中检索数据，就不能使用它。</p><p id="b87c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果数据库中不存在表，则添加以下语句来创建表。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="9a16" class="lh jv hi ld b fi li lj l lk ll">FDConnection1-&gt;ExecSQL("CREATE TABLE IF NOT EXISTS Reminder (Id int, time TEXT NOT NULL)");</span></pre><p id="b46a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们要将时间插入数据库。在使用本文前一部分编写的代码检索日期时间值之后，我们仍然可以使用ExecSQL函数:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="4922" class="lh jv hi ld b fi li lj l lk ll">String date =  dateTime.FormatString("dd/mm/yyyy HH:mm");<br/>FDConnection1-&gt;ExecSQL("INSERT INTO Reminder (time) VALUES ('"+date+"')");</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/886b0ce7e02baf6ced1ed71eb7832a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z05Tr-pSOpS9AYHb"/></div></div></figure><h1 id="ad57" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">第六步:从数据库中读取</h1><p id="3e1a" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">要从数据库中检索添加的提醒，双击“显示提醒”按钮创建一个空的快速调用功能来检索提醒。</p><p id="8771" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用TFDQuery。TFDQuery用于执行查询，并允许我们利用结果集。</p><p id="1410" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是一些说明如何使用TFDquery的示例代码。在这里，我们希望从提醒表中选择所有提醒，并将它们显示给用户。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="6482" class="lh jv hi ld b fi li lj l lk ll">TFDQuery *query;<br/>query = new TFDQuery(this);<br/>query-&gt;Connection = FDConnection1;<br/>query-&gt;SQL-&gt;Text = "SELECT * FROM Reminder";<br/>query-&gt;Open();</span></pre><p id="f70f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要使用TFDQuery <strong class="ix hj">，</strong>，需要将以下头添加到您的代码中:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="2e5f" class="lh jv hi ld b fi li lj l lk ll"><em class="jt">#include &lt;FireDAC.DApt.hpp&gt;</em></span></pre><p id="a8f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用于输出检索数据的代码</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="03b5" class="lh jv hi ld b fi li lj l lk ll">TVarRec args[1] = {"time"};<br/>Memo1-&gt;Lines-&gt;Add(System::UnicodeString::Format("|%25s |", args,ARRAYSIZE(args) - 1));<br/>while (!query-&gt;Eof) {<br/>TVarRec arguments[1] = { query-&gt;FieldByName("time")-&gt;AsString};<br/>	Memo1-&gt;Lines-&gt;Add(System::UnicodeString::Format("|%-25s |", arguments, ARRAYSIZE(arguments) - 1));<br/>	query-&gt;Next();<br/>}</span></pre><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/f8de63f627593d24679df3e4042c73ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fTGhr_l-dQkajrAH"/></div></div></figure><p id="e84b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当所有共享代码的不同部分加在一起时，我们得到下面的程序:</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="2bce" class="lh jv hi ld b fi li lj l lk ll">#include &lt;FireDAC.DApt.hpp&gt; <br/>void __fastcall TForm2::buttonAddReminderOnClick(TObject *Sender)<br/>{<br/>    TDateTime dateTime;<br/>	ReplaceDate(dateTime, DateTimePicker1-&gt;Date);<br/>	ReplaceTime(dateTime, TimePicker1-&gt;Time);<br/>	Memo1-&gt;Text = "";<br/>	FDConnection1-&gt;DriverName = "SQLite";<br/>	FDConnection1-&gt;Params-&gt;Values["Database"] =  "C:\\Users\\k_umm\\OneDrive\\Desktop\\reminderdb.db";<br/>	try<br/>	{<br/>		FDConnection1-&gt;Open();<br/>		FDConnection1-&gt;ExecSQL("CREATE TABLE IF NOT EXISTS Reminder (id INTEGER PRIMARY KEY AUTOINCREMENT, time TEXT NOT NULL)");<br/>		String date =  dateTime.FormatString("dd/mm/yyyy HH:mm");<br/>		FDConnection1-&gt;ExecSQL("INSERT INTO Reminder (time) VALUES ('"+date+"')");<br/>		FDConnection1-&gt;Close();<br/>	}<br/>	catch (Exception&amp; E)<br/>	{<br/>		Memo1-&gt;Text = E.Message;<br/>	}<br/>}<br/>//---------------------------------------------------------------------------<br/>void __fastcall TForm2::buttonShowReminderOnClick(TObject *Sender)<br/>{<br/>	FDConnection1-&gt;DriverName = "SQLite";<br/>	FDConnection1-&gt;Params-&gt;Values["Database"] =  "C:\\Users\\k_umm\\OneDrive\\Desktop\\reminderdb.db";<br/>	try<br/>	{<br/>		FDConnection1-&gt;Open();<br/>		TFDQuery *query;<br/>		query = new TFDQuery(this);<br/>		query-&gt;Connection = FDConnection1;<br/>		query-&gt;SQL-&gt;Text = "SELECT * FROM Reminder";<br/>		query-&gt;Open();<br/>		TVarRec args[1] = {"time"};<br/>		Memo1-&gt;Lines-&gt;Add(System::UnicodeString::Format("|%25s |", args, ARRAYSIZE(args) - 1));<br/>		while (!query-&gt;Eof) {<br/>		  TVarRec arguments[1] = { query-&gt;FieldByName("time")-&gt;AsString};<br/>		  Memo1-&gt;Lines-&gt;Add(System::UnicodeString::Format("|%-25s |", arguments, ARRAYSIZE(arguments) - 1));<br/>		  query-&gt;Next();<br/>		}<br/>		query-&gt;Close();<br/>		FDConnection1-&gt;Close();<br/>	}<br/>	catch (Exception&amp; E)<br/>	{<br/>		Memo1-&gt;Text = E.Message;<br/>	}<br/>}</span></pre><h1 id="bb1d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">第七步:</h1><p id="f43c" class="pw-post-body-paragraph iv iw hi ix b iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo kw jq jr js hb bi translated">到目前为止，我们已经构建了一个迷你提醒应用程序，它从用户那里获得输入并将其存储在数据库中。</p><p id="f6bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的用户也希望在指定的时间内收到通知。</p><p id="d295" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Android、macOS和iOS都支持FireDate。可以通过传递应该触发通知的日期和时间信息来使用它。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="2b8d" class="lh jv hi ld b fi li lj l lk ll">MyNotification-&gt;FireDate = System::Dateutils::EncodeDateTime(2015, 12, 16, 17, 30, 00, 00);</span></pre><p id="5882" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有关如何在应用程序中使用通知的更多信息，请点击<a class="ae iu" href="https://docwiki.embarcadero.com/CodeExamples/Sydney/en/Category:Sample?utm_source=Medium&amp;utm_medium=Leads%20Acquisition&amp;utm_content=BuildingYourFirstAppUsingCBuilderPart2&amp;utm_campaign=BuildingYourFirstAppUsingCBuilderPart2" rel="noopener ugc nofollow" target="_blank">这里</a>:</p><p id="cbf8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于一些可以参考的样例代码，<a class="ae iu" href="https://docwiki.embarcadero.com/RADStudio/Sydney/en/Using_Notifications?utm_source=Mediumn&amp;utm_medium=Leads%20Acquisition&amp;utm_content=BuildingYourFirstAppUsingCBuilderPart2&amp;utm_campaign=BuildingYourFirstAppUsingCBuilderPart2" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p></div></div>    
</body>
</html>
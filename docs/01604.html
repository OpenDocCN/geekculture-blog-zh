<html>
<head>
<title>Creating/Reading an Excel in Android.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android中创建/读取Excel。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/creating-an-excel-in-android-cd9c22198619?source=collection_archive---------1-----------------------#2021-04-17">https://medium.com/geekculture/creating-an-excel-in-android-cd9c22198619?source=collection_archive---------1-----------------------#2021-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/df55646d4f088ce7d395349439dd243d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9MGaPTEPLGcPhuVG"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@firmbee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">William Iven</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6c29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着移动设备的指数级增长，数据访问的便利性增加了十倍。</p><p id="f872" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以在移动设备上看到与任何领域相关的所有数据，例如，一个组织的年营业额、上个月加入的员工人数等。然而，在移动应用程序上显示数据是有用的，尽管当我们需要与管理层或其他人共享相关数据时，它变得非常无用。这是数据导出派上用场的地方，并且可以在今天的大多数移动应用程序中看到。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="b0bb" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">概述:</h1><p id="c457" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们想创建一个我们自己的<em class="ld">‘Contact’</em>应用程序，如下面的视频所示。</p><p id="814a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在此应用中:</p><ul class=""><li id="0dd2" class="le lf hi ix b iy iz jc jd jg lg jk lh jo li js lj lk ll lm bi translated">最初，我们将查询Contacts内容提供者，以便检索Android设备中存在的所有联系人。</li><li id="b279" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">接下来，我们将所有联系人导出到一个Excel工作簿(。xls格式)</li><li id="cbb9" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">最后，我们将从先前生成的xls工作簿中读取数据，并在recycler视图中显示结果。</li><li id="c201" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">作为一个额外的功能，我们还可以通过支持的应用程序(例如:附近的共享，蓝牙等)共享excel。)</li></ul><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="lw lx l"/></div><figcaption class="iq ir et er es is it bd b be z dx">Contacts Entrepot Android application preview</figcaption></figure><p id="fd01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ld">你可以在这里</em>  <em class="ld">找到这个应用程序的代码</em> <a class="ae iu" href="https://github.com/ranitraj/ContactsEntrepot" rel="noopener ugc nofollow" target="_blank"> <em class="ld">。</em></a></p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="9cb6" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">但是，在本文中，我们将只涉及以下内容:</h2><ol class=""><li id="ed35" class="le lf hi ix b iy ky jc kz jg mm jk mn jo mo js mp lk ll lm bi translated"><em class="ld">下载jar文件。</em></li><li id="471e" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js mp lk ll lm bi translated"><em class="ld">在Android Studio中将jar导出为依赖项。</em></li><li id="9c65" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js mp lk ll lm bi translated"><em class="ld">创建Excel工作簿。</em></li><li id="a8cd" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js mp lk ll lm bi translated"><em class="ld">从Excel工作簿导入数据(读取)。</em></li><li id="6fc8" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js mp lk ll lm bi translated"><em class="ld">将数据导出(写入)到Excel工作簿。</em></li></ol></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="557f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到本文结束时，你将能够生成下面的excel工作簿:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/df416fc2eb4d3c8ffe19850dbd119a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6B3syCnMLSFEsTz9IrNrQ.png"/></div></div></figure><p id="b606" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不要再浪费时间了，让我们马上开始吧！</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="3499" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">下载JAR文件</h1><p id="d305" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们将利用<a class="ae iu" href="https://poi.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache的POI </a>项目来实现我们的目标。完全免费，可以从<a class="ae iu" href="http://www.java2s.com/Code/Jar/p/Downloadpoi37jar.htm" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">这里</strong> </a>下载。</p><p id="7eed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据官方文件:</p><blockquote class="mr ms mt"><p id="e136" class="iv iw ld ix b iy iz ja jb jc jd je jf mu jh ji jj mv jl jm jn mw jp jq jr js hb bi translated">你可以用Java读写MS Excel文件。此外，您还可以使用Java读写MS Word和MS PowerPoint文件。Apache POI是您的Java Excel解决方案(适用于Excel 97–2008)。</p></blockquote><p id="84d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们不仅可以使用POI来生成excel，它还可以用于创建MS Word和MS Power point。但是，这超出了本文的范围。</p><h1 id="736c" class="ka kb hi bd kc kd mx kf kg kh my kj kk kl mz kn ko kp na kr ks kt nb kv kw kx bi translated"><em class="nc">在Android Studio中将jar导出为依赖项</em></h1><p id="78a3" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">接下来，我们需要在Android Studio中将JAR导出为一个依赖项。我在下面一步一步地描述了同样的情况:</p><h2 id="38f7" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">步骤1:导航到左侧的项目结构</h2><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/c5f8a3066e1b1313ba68ebeecc2ed789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UN6mqF4OlgL4vmQFty0wrw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Android file structure</figcaption></figure><h2 id="bc7a" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">第二步:通过选择下拉菜单切换到“Android”的“项目”表单</h2><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/8a5fc51e9d5f52bac495a974142c43a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AmRjLS5Uv3fljYhzefsOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Switching to Project view</figcaption></figure><h2 id="f9b5" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">步骤3:在“app”目录中选择“libs”文件夹</h2><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/8a0bc807273aba77aa202e7992eb4e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6icdQB3jVj824UVm4nIkA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Navigate to libs folder within the Project structure</figcaption></figure><h2 id="7bb9" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">第4步:复制下载的JAR并粘贴到“libs”目录</h2><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/2c4491f3d67ce3545f4bf896b580ad81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mixram-8cnhxY7aCwSaWzQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Copy and paste the JAR file into the libs directory</figcaption></figure><h2 id="9b82" class="ly kb hi bd kc lz ma mb kg mc md me kk jg mf mg ko jk mh mi ks jo mj mk kw ml bi translated">步骤5:(最重要的)添加JAR作为库</h2><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ng"><img src="../Images/d6ecbef937384600d7a80de74f5d9e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCwVSR3Isp90RCQuTw7QtQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Right click on the newly added JAR and select the option ‘Add as library’</figcaption></figure><p id="17c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将其添加为库会自动处理添加和编译<em class="ld"> build.gradle </em>中的文件<em class="ld">(' libs/library _ name . jar ')</em>。我们不需要手动添加。</p><p id="f033" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！现在，您已经将Android Studio中的JAR导出为一个库。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="e215" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">创建Excel工作簿</h1><p id="7fc9" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在本节中，我们将详细介绍创建excel工作簿的过程。</p><p id="7111" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在此之前，让我们先熟悉几个excel术语:</p><ul class=""><li id="0517" class="le lf hi ix b iy iz jc jd jg lg jk lh jo li js lj lk ll lm bi translated"><em class="ld">细胞</em></li><li id="5be0" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated"><em class="ld">工作表</em></li><li id="9245" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">排</li><li id="46d7" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated"><em class="ld">工作簿</em></li></ul><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nh"><img src="../Images/280298a0e559eb0b192db109f7379ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A5Ghm15b_5BijepaXgE9HA.png"/></div></div></figure><p id="6ff8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以试着用以下方式联系这些术语:</p><ul class=""><li id="c5fd" class="le lf hi ix b iy iz jc jd jg lg jk lh jo li js lj lk ll lm bi translated"><strong class="ix hj">工作簿</strong>是<strong class="ix hj">工作表的集合。</strong></li><li id="f913" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="ix hj">工作表</strong>是<strong class="ix hj">行</strong>(和列)的集合。</li><li id="376a" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="ix hj">行</strong>是<strong class="ix hj">单元格</strong>的集合。</li></ul><p id="cec8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么，让我们开始吧！</p><p id="6688" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤1:创建新的“工作簿”</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="c02f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2:创建新的“工作表”</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="61f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤3:创建新的“行”</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="6322" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤4:创建一个新的“<em class="ld">单元格”</em>，并为其分配“样式”</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><ul class=""><li id="2d54" class="le lf hi ix b iy iz jc jd jg lg jk lh jo li js lj lk ll lm bi translated">最初，我们声明一个类型为“cell”的变量“Cell”</li><li id="8cb9" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">接下来，我们要创建一个“单元格样式”，它可以分配给任何单元格<em class="ld">(例如，excel表中的标题行)</em>，并根据需要定制它。例如，设置前景色、对齐等。</li><li id="1686" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">接下来，我们创建一个新的“单元格”并将其分配给一个“行”</li><li id="c197" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">最后，我们为单元格设置值和样式。</li></ul><p id="0fc3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">合并步骤1至4: </strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="d4d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面的代码将生成一个包含4个单元格的单行，如下所示:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nj"><img src="../Images/b0f55ef56b92507b740bce9ed1ee5d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljhxVhb4-hIY0szsOQSmwQ.png"/></div></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="ce93" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们继续下一步之前，请确保您已经在“清单”中添加了必要的权限</p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="236f" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">从Excel工作簿导入数据(读取)</h1><p id="16ee" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在本节中，我们将尝试理解从excel工作簿中读取数据的过程。</p><p id="c8c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本节结束时，我们将能够从下面显示的excel工作簿中读取数据，即从android设备中导出的联系人列表(假设在Android设备中显示)。</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/4362271ac5fc205ce0be4148050f23a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2h4EOg1eOuLtIMGTnJq3og.png"/></div></div></figure><p id="dcf2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第一步:从存储器中访问Excel文件</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="e404" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2:创建一个引用。xls文件</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="a2ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤3:从工作簿中提取所需索引处的工作表</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="02d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤4:遍历工作表中的行和单元格</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><ul class=""><li id="75ab" class="le lf hi ix b iy iz jc jd jg lg jk lh jo li js lj lk ll lm bi translated">遍历工作表中的每一行。</li><li id="2ba3" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">使用<em class="ld"> 'row.cellIterator()' </em>迭代一行中的每个单元格</li><li id="7f64" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">检查每个单元格的单元格类型，并相应地设置数据格式。</li><li id="b4ad" class="le lf hi ix b iy ln jc lo jg lp jk lq jo lr js lj lk ll lm bi translated">打印值<em class="ld">(参考GitHub应用程序的链接</em> <a class="ae iu" href="https://github.com/ranitraj/ContactsEntrepot" rel="noopener ugc nofollow" target="_blank"> <em class="ld">这里</em> </a> <em class="ld">我已经将数据存储在一个列表中)</em></li></ul><p id="a6e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">合并步骤1至4: </strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="f421" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">将数据导出(写入)到Excel工作簿中</h1><p id="5829" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在本节中，我们将了解将Android应用程序中的数据(比如手机中所有联系人的列表)导出到excel工作簿并将其存储在外部存储中的机制。</p><p id="760a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这真的很简单，因为我们之前已经研究过生成工作簿的机制。这里我们需要做的就是从任何数据源(例如:List)读取数据，并将其适当地转换为单元格和行，以生成如下所示的excel表格:</p><figure class="ls lt lu lv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nk"><img src="../Images/4362271ac5fc205ce0be4148050f23a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2h4EOg1eOuLtIMGTnJq3og.png"/></div></div></figure><p id="ecf9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，将数据写入excel的完整代码可以在本节末尾找到。</p><p id="3f1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第一步:将列表中的数据填入Excel </strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="e570" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2:检查外部存储器是否为只读</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="d85b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第三步:检查存储空间是否可用</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="df57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤4:将Excel存储在外部存储器中</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="47ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">结合所有步骤:</strong></p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure><p id="ea70" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在代码中使用上述函数时(假设在MainActivity中)，只需执行以下操作:</p><figure class="ls lt lu lv fd ij"><div class="bz dy l di"><div class="ni lx l"/></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="d5ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们如何使用“Apache POI”库生成Excel。此外，还可以从中读取和写入数据。</p><p id="a0fd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ld">如果你有兴趣看完整的代码，可以从</em> <a class="ae iu" href="https://github.com/ranitraj/ContactsEntrepot" rel="noopener ugc nofollow" target="_blank"> <em class="ld">这里</em> </a> <em class="ld">随意克隆这个库。</em></p></div></div>    
</body>
</html>
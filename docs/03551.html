<html>
<head>
<title>Akaike Information Criterion: Model Selection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">赤池信息准则:模型选择</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/akaike-information-criterion-model-selection-c47df96ee9a8?source=collection_archive---------10-----------------------#2021-06-10">https://medium.com/geekculture/akaike-information-criterion-model-selection-c47df96ee9a8?source=collection_archive---------10-----------------------#2021-06-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fe3aff59777562db6c5e9e72a85a63e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJ1oPS6pvdOhMsX6M-FwrA.jpeg"/></div></div></figure><p id="8803" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">阿凯克信息准则或AIC是一种用于<strong class="is hj">模型选择</strong>的统计方法。它帮助你比较<strong class="is hj">的候选型号</strong>，并从中选出最好的。</p><p id="fcea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">候选模型可以是各自包含独立/预测变量的不同子集或组合的模型。</p><p id="1be4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AIC的目标是选择一个模型，它的<strong class="is hj">最好的</strong>解释了自变量(参数)数量最少<strong class="is hj">的因变量的方差。因此，它有助于选择一个<strong class="is hj">更简单的</strong>模型(参数更少)而不是一个<strong class="is hj">复杂的</strong>模型(参数更多)。</strong></p><p id="8566" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是为什么选择简单的模型而不是复杂的模型呢？</p><ul class=""><li id="b0c6" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">为了减少过度拟合:</li></ul><p id="acb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们知道模型越复杂，它就越适合。然而，复杂性的增加可能导致过度拟合，即低偏差(高训练精度)和高方差(低测试精度)。因此，AIC帮助处理简单和复杂模型之间的权衡。</p><ul class=""><li id="75c3" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">减少参数数量(减少维度数量):</li></ul><p id="0aff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加参数会增加计算成本。此外，不需要的参数可能会导致噪声的增加，从而妨碍模型中的<strong class="is hj">拟合优度</strong>。AIC分数有助于确定添加任何给定参数的成本是否合理。</p><p id="5e03" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AIC测量丢失的信息，因此具有较低<strong class="is hj">AIC分数的模型表明<strong class="is hj">更适合</strong>。</strong></p><p id="143a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AIC由两个重要方面组成</p><ul class=""><li id="0c03" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">最大对数似然(衡量给定模型在多大程度上捕捉了因变量的方差)</li><li id="966e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">参数数量</li></ul><p id="1d45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它是通过以下公式计算的:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/8e424b5e921d53e02b3a22b7ae2fd31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*sadddjTXEavxqY7glR23iQ.png"/></div></figure><p id="1ef7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为更小的AIC分数是优选的，基于这个公式，增加更多的参数实际上<strong class="is hj">惩罚了</strong>分数。因此，如果两个模型同等地解释了给定数据中的方差，则具有较少参数的模型将具有较低的AIC分数，并将被选为更好的拟合模型。</p><p id="6f29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">什么时候需要AIC？</p><ul class=""><li id="06af" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">假设对于一个给定的问题陈述，您已经使用您的领域知识收集或搜集了必要的变量，但是您不确定这些变量是否是该问题的重要指标。</li><li id="03fa" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">您缺少正确测试准确性所需的数据量。</li></ul><p id="74a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">需要注意的重要一点是，AIC分数本身没有任何意义。必须将<strong class="is hj">与</strong>另一款车型进行比较。</p><p id="0a1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">让我们用一个例子深入探讨一下</strong></p><p id="8fc9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我有一个回归问题，我必须预测汽车的价格。让我给你一个数据框架的概述。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="848f" class="km kn hi ki b fi ko kp l kq kr">df.head()</span></pre><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/a4724abaecffa9ccdbb9c2d3f8ab7810.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*MM4gjecEv6NiwyXZKige4w.png"/></div></figure><ul class=""><li id="0fa4" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">自变量:<strong class="is hj"> <em class="kt">马力</em> </strong> <em class="kt">，</em> <strong class="is hj"> <em class="kt">发动机尺寸</em> </strong> <em class="kt">，</em> <strong class="is hj"> <em class="kt">高速公路mpg </em> </strong></li><li id="aa99" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">因变量:<strong class="is hj"> <em class="kt">价格</em> </strong></li></ul><p id="95b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有三个参数。所以，</p><ul class=""><li id="69af" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">K = 3 + 1 = 4(模型中的参数数量+截距)</li></ul><p id="838a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，子集(给定参数的组合)的数量是参数的2^number = 2 = 8，因此换句话说，有8个候选模型。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="6a1d" class="km kn hi ki b fi ko kp l kq kr"># Print the subsets of parameters<br/>import itertools</span><span id="277e" class="km kn hi ki b fi ku kp l kq kr">for i in range(len(all_cols)+1):<br/>    for subset in itertools.combinations(all_cols, i):<br/>        print(list(subset))</span></pre><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es kv"><img src="../Images/ae2fa99e4938579c0919b18a530c0110.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*mBU4S7S0D-YUFxK3nuSWFg.png"/></div></figure><p id="bae7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的空集指的是仅截取模型，可能是最简单的模型。</p><p id="a438" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将使用线性回归来拟合给定的模型。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="d0ce" class="km kn hi ki b fi ko kp l kq kr">y = df['price']<br/>r2_scores = []<br/>predictor_subsets = []</span><span id="4f5d" class="km kn hi ki b fi ku kp l kq kr">for i in range(len(all_cols)+1):<br/>    for subset in itertools.combinations(all_cols, i):<br/>        model = LinearRegression(n_jobs = -1, normalize=False)<br/>        <br/>        cols = list(subset)<br/>        predictor_subsets.append(cols)</span><span id="2f53" class="km kn hi ki b fi ku kp l kq kr">        # If intercept-only model<br/>        if len(cols) &lt; 1:<br/>            x = np.full(len(y), 0)<br/>            x = x.reshape(-1, 1)<br/>            <br/>            model.fit(x, y)</span><span id="1487" class="km kn hi ki b fi ku kp l kq kr">            ypred = model.predict(x</span><span id="e375" class="km kn hi ki b fi ku kp l kq kr">            score = model.score(x, y)<br/>            r2_scores.append(score)<br/>            <br/>            <br/>        else:     <br/>            x = df[cols]</span><span id="203e" class="km kn hi ki b fi ku kp l kq kr">            model.fit(x, y)</span><span id="c17f" class="km kn hi ki b fi ku kp l kq kr">            ypred = model.predict(x)</span><span id="e85b" class="km kn hi ki b fi ku kp l kq kr">            score = model.score(x, y)            <br/>            r2_scores.append(score)</span></pre><p id="d719" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些是拟合每个模型后的R2分数:</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="00f2" class="km kn hi ki b fi ko kp l kq kr">results_df = pd.DataFrame({'Predictor Subset': predictor_subsets,<br/>                          'R2 Score': r2_scores})</span></pre><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/2d8647a9004f8e125ea1c8ca95792624.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*XFmKLWyU8OcW_T4qOG40IQ.png"/></div></figure><p id="3330" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以看到得分最高的模型包含所有的参数，而第二个模型包含除了<em class="kt"> highwaympg </em>之外的所有参数，但是它们的R2得分的差异非常小。那么，R2分数的这种轻微上升合理吗？</p><p id="6792" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了找出答案，让我们首先计算每个候选模型的AIC分数。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="0b7a" class="km kn hi ki b fi ko kp l kq kr"># Function to calculate the AIC score<br/># N: number of obervations<br/># K: Number of parameters<br/># mse: Mean squared error (SSe/N)</span><span id="5913" class="km kn hi ki b fi ku kp l kq kr">def calculate_aic(N, mse, K):<br/>    aic = N*np.log(mse)+2*K<br/>    return aic</span><span id="d8d0" class="km kn hi ki b fi ku kp l kq kr">y = df['price']<br/>aic_scores = []</span><span id="a00f" class="km kn hi ki b fi ku kp l kq kr">for i in range(len(all_cols)+1):<br/>    for subset in itertools.combinations(all_cols, i):<br/>        model = LinearRegression(n_jobs = -1, normalize=False)<br/>        <br/>        cols = list(subset)</span><span id="7cf0" class="km kn hi ki b fi ku kp l kq kr">        #If intercept-only model<br/>        if len(cols) &lt; 1:<br/>            x = np.full(len(y), 0)<br/>            x = x.reshape(-1, 1)<br/>            <br/>            model.fit(x, y)</span><span id="b459" class="km kn hi ki b fi ku kp l kq kr">            ypred = model.predict(x)<br/>            <br/>            N = len(y)<br/>            K = len(model.coef_) + 1<br/>            mse = mean_squared_error(y, ypred)</span><span id="f7ce" class="km kn hi ki b fi ku kp l kq kr">            aic = calculate_aic(N, mse, K)<br/>            aic_scores.append(aic)            <br/>            <br/>        else:     <br/>            x = df[cols]</span><span id="7085" class="km kn hi ki b fi ku kp l kq kr">            model.fit(x, y)</span><span id="bf3a" class="km kn hi ki b fi ku kp l kq kr">            ypred = model.predict(x)<br/>            <br/>            N = len(y)<br/>            K = len(model.coef_) + 1<br/>            mse = mean_squared_error(y, ypred)</span><span id="d654" class="km kn hi ki b fi ku kp l kq kr">            aic = calculate_aic(N, mse, K)<br/>            aic_scores.append(aic)</span></pre><p id="d05f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AIC的分数是:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/46c73e571450245bf112d2a13122dc7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*ClKamDadMykzEEqAJcUWXA.png"/></div></figure><p id="1166" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如你所看到的，最佳型号<strong class="is hj">的AIC分数</strong>(AIC分数<strong class="is hj">最低的型号</strong>)仅略低于次佳型号。为了证明额外参数的合理性，AIC分数必须至少低<strong class="is hj"> 2个单位</strong>。</p><p id="c230" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们为每个模型计算<strong class="is hj">δAIC</strong>。德尔塔AIC只是每个模型与最佳模型的AIC分数的<strong class="is hj">差</strong>。所以，最佳模型的德尔塔AIC应该是0。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="86cd" class="km kn hi ki b fi ko kp l kq kr">results_df['Delta AIC'] = results_df['AIC score']- min(results_df['AIC score'])</span></pre><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/d3d6589e16e3286433419c19e7bf97c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*V9awUGpIWIoPYHAVAmjP_A.png"/></div></figure><p id="d5b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以看到，最佳模型的AIC分数比第二好的模型低2个单位以上。由于AIC分数的差异足够显著，我们可以得出结论，通过添加<em class="kt"> highwaympg </em>来略微增加R2分数是合理的。</p><p id="765f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，通过添加<em class="kt"> highwaympg </em>解释的方差的增加对于添加它来说足够重要。</p><p id="7da3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以更进一步，计算每个模型的<strong class="is hj">加权AIC分数</strong>。加权AIC分数给出了给定模型相对于所有其他模型的<strong class="is hj">预测能力</strong>。</p><p id="36f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了首先计算加权AIC，计算模型的<strong class="is hj">相对可能性</strong>，其正好是模型的exp(-0.5 *δAIC)除以所有模型的加权AIC分数的总和。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="47b4" class="km kn hi ki b fi ko kp l kq kr">results_df['Weighted AIC'] = round(np.exp(-0.5 * results_df['Delta AIC'])/sum(np.exp(-0.5 * results_df['Delta AIC'])), 4)</span></pre><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/78e26cd59765abaf8abe752753dce0be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*D8XQ7VHGqpVAi1pnMlstAA.png"/></div></figure><p id="eb60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该表显示，与所有候选模型相比，前2个模型解释了几乎100%的差异。</p><p id="a017" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以最好的模型是包含数据框架中所有独立变量的候选模型。它具有最低的AIC分数，包含大约75%的预测能力，相比之下，第二好的模型包含25%的预测能力。</p><p id="4913" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于以上分析，你可以选择由所有自变量组成的给定最佳模型来预测汽车的<em class="kt">价格</em>。</p><p id="70b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">总结</strong></p><ul class=""><li id="f385" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">Akaike信息标准帮助您比较和选择最佳候选模型。</li><li id="ddab" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">具有较低AIC分数的模型显示出更好的拟合。</li><li id="24c3" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">更喜欢用最少的参数解释最大差异的模型。</li><li id="c09e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">用更多的参数惩罚模型。</li><li id="0c76" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">与其他模型相比，AIC分数必须至少低2个单位，才能足够显著。</li><li id="b70f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">加权AIC显示了给定模型相对于其他模型的预测能力。</li><li id="c236" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">AIC分数本身没有意义。它必须与另一个模型进行比较。</li></ul><p id="2277" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据:<a class="ae kz" href="https://www.kaggle.com/hellbuoy/car-price-prediction" rel="noopener ugc nofollow" target="_blank">来源</a></p></div></div>    
</body>
</html>
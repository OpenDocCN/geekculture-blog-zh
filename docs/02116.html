<html>
<head>
<title>Swift Animated Floating Menu</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift动画浮动菜单</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swift-animated-floating-menu-38b952bfeffc?source=collection_archive---------16-----------------------#2021-05-04">https://medium.com/geekculture/swift-animated-floating-menu-38b952bfeffc?source=collection_archive---------16-----------------------#2021-05-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7dd1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">向应用程序中的任何视图添加动画浮动菜单</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/eb5cdba135b309f16de3773eed7d6e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*uqBlpqayD9uMYjRtrm3Yzg.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx">Books Table View Showing the In-Place Sort Floating Menu</figcaption></figure><h1 id="5655" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">方案</h1><p id="887f" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们的应用程序将允许用户通过使用一个动画，浮动菜单排序图书表视图。点击“汉堡”菜单按钮就可以触发菜单，并提供4种分类标准:按标题、作者、系列和(用户)评级。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kx"><img src="../Images/9e5ac2278c0de7bfb1367bb1a891bd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/1*Zm7VSFKPThw1_s54lVVZUw.gif"/></div><figcaption class="jf jg et er es jh ji bd b be z dx">GIF Books Table View Animated, Floating Sort By Menu</figcaption></figure><h1 id="01f2" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">技术</h1><p id="200b" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们在它自己单独的视图中设计菜单，一个<strong class="kd hj">nimatedmenuviewcontroller . swift</strong>，然后在表格视图上覆盖一个透明背景。动画由GitHub的孟托的春天包提供。当表格排序“就地”发生时，我们在<strong class="kd hj"> viewWillAppear() </strong>中刷新表格视图。</p><p id="03dd" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">BooksTableViewController . swift</strong>作为<strong class="kd hj">委托</strong>给AnimatedMenuViewController，这样用户在菜单上的任何动作都可以被BooksTableViewController检测到，排序逻辑被执行。</p><h1 id="dc6a" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">观众</h1><p id="fa66" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">本文面向寻求完整、成熟、以代码为中心的解决方案来加速开发项目的Swift开发人员。下面的代码片段可以通过最小的定制来使用。</p><h1 id="b159" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">应用模型</h1><p id="d51c" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们的文章基于苹果应用商店发布的<a class="ae ld" href="https://appsgym.com/projects/books/" rel="noopener ugc nofollow" target="_blank">apps gam Books</a>模型应用，你可以在AppsGym.com上免费下载完整的<a class="ae ld" href="https://appsgym.com/appsgym-books-swift-xcode-project-tour/" rel="noopener ugc nofollow" target="_blank"> Xcode项目</a>。</p><h1 id="9ff3" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">用户界面</h1><p id="ebfe" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">有2个视图需要考虑:菜单<strong class="kd hj">视图</strong>视图(顶部/覆盖)和<strong class="kd hj">表格</strong>视图(底部/底层)。菜单视图将清楚地显示菜单选项，具有透明或半透明的背景，因此它不会覆盖底层的表格视图。</p><p id="6f12" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">animatedmenuviewcontroller . swift</strong>将菜单本身作为<strong class="kd hj">designable view</strong>:SpringView(从萌到GitHub上的Spring包；meng@designcode.io)，从而让<strong class="kd hj">挤下</strong>动画(下图)。当然，你可以选择任何其他的动画包或者你自己的代码。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/274186c8bff16167aaa2e16cd7e073fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhej-pvy2WlrrA4csml23g.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx">AnimatedMenuViewController.swift Storyboard, Showing DesignableView Menu</figcaption></figure><p id="6e5a" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated"><strong class="kd hj">bookstableviewcontroller . swift</strong>显示我们的应用程序书籍(来自核心数据)，并显示汉堡菜单的左上角图标，这将触发(通过segue)浮动菜单。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lj"><img src="../Images/83ed2f78f38aca90611cc002fcc9aa76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*meZLq2S91ojNCDLCHtOmWQ.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx">BooksTableViewController.swift Storyboard, Showing Hamburger Menu Icon</figcaption></figure><h1 id="19df" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">逻辑</h1><p id="ab1b" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">首先，我们设计浮动菜单来执行4个动作:按照书名、作者、系列或(用户)评级对底层UITableView进行就地排序。我们选择一个正方形的设计，但是你可以把按钮放在任何堆栈中(水平的，垂直的，等等)。).</p><p id="fbf1" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">我们的<strong class="kd hj">animatedmenuviewcontroller . swift</strong>类将有一个<strong class="kd hj">委托协议</strong>，AnimatedMenuViewControllerDelegate，有4个函数对应于4个菜单操作。</p><p id="0170" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">然后，我们为每个被触摸/轻击的按钮构造@<strong class="kd hj">I action</strong>，简单地将哪个菜单按钮被触摸/轻击的指示传递给调用视图(BooksTableViewController)。然后我们关闭浮动菜单，这样UITableView知道哪个按钮被触摸/点击，将对显示的记录执行相应的操作。</p><p id="31af" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">示例:用户点击(sort) <strong class="kd hj"> <em class="lk"> By Author </em> </strong>按钮，菜单委托协议将把该按钮传递给图书表格视图。UITableView作为一个委托，将“感知”按钮点击并执行相关的逻辑代码(按作者对显示的图书记录进行排序并刷新视图)。</p><p id="dee8" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">如果用户决定不使用菜单,我们还需要一种方法让菜单<strong class="kd hj">消失。因此，我们将在菜单后面添加一个透明按钮，看不见但覆盖整个视图，并将其连接到一个菜单解除逻辑。因此，如果用户点击菜单“框”外的任何地方，菜单将被取消，并且不采取任何行动。我们也可以选择让菜单消失，而不是突然消失，在我们的例子中，我们将让它“落下”屏幕。</strong></p><h1 id="f9d1" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">密码</h1><h1 id="39a5" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">代码:动画菜单</h1><p id="fd83" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">以下Swift代码片段摘自<strong class="kd hj">animatedmenuviewcontroller . Swift，</strong>显示菜单并设置代理协议功能。</p><p id="d5ee" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">animatedmenuviewcontroller . swift</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h1 id="35a1" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">代码:表格视图</h1><p id="1af0" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kd hj">bookstableviewcontroller . swift</strong>viewwilappear检查选中的用户菜单排序选项，为每个菜单选项定义排序描述符，检索核心数据记录，对其进行排序，并通过<strong class="kd hj"> reloadData() </strong>刷新表格视图。</p><p id="5022" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">bookstableviewcontroller . swift<strong class="kd hj">viewwilappear()</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="66f0" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">准备(为了继续..):检查segue标识符是否为‘MenuSegue’并启动菜单。</p><p id="a769" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">bookstableviewcontroller . swift<strong class="kd hj">准备(对于segue:..)</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="62ca" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">bookstableviewcontroller . swift<strong class="kd hj">委托</strong> <strong class="kd hj">功能</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="9b76" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">以下两个功能是针对menuviewcontrollerdidtuchbutton 3中的<strong class="kd hj">系列</strong>和<strong class="kd hj">系列No </strong>分类的。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="6929" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">本文介绍了实现动态浮动菜单的完整设置、逻辑和代码。我们使用的例子是书籍的显示表格视图的就地排序。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ln"><img src="../Images/18adddaa07bf70f41017453f9a77e523.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*jOliOPwIgDururwNwrmO-w.png"/></div></figure><p id="78fc" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">然而，浮动菜单可以在应用程序的任何视图中使用，从任何方向动画和浮动，并执行任何操作，利用相同的代理和协议原则。例如:在一些应用程序中，我们利用浮动菜单作为媒体菜单，包含相册、相机、音频(麦克风)、视频和共享选项。</p><p id="6a22" class="pw-post-body-paragraph kb kc hi kd b ke ky ij kg kh kz im kj kk la km kn ko lb kq kr ks lc ku kv kw hb bi translated">希望你发现浮动菜单对你的应用有用。感谢阅读！</p></div></div>    
</body>
</html>
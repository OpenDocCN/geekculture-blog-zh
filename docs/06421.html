<html>
<head>
<title>ARP ( Address Resolution Protocol ) demystified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ARP(地址解析协议)解密</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/arp-address-resolution-protocol-demystified-63a88d5f8c35?source=collection_archive---------13-----------------------#2021-08-19">https://medium.com/geekculture/arp-address-resolution-protocol-demystified-63a88d5f8c35?source=collection_archive---------13-----------------------#2021-08-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5af44afb7e099298322fde0ddc13b384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cknGucDTmBBs5IQ0"/></div></div></figure><p id="b089" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">每当主机需要联系另一台主机时，无论是在它的子网中还是在另一个子网中，或者可能是在互联网上，它都会发送ARP(地址解析请求)</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/51a4b6337fc394a5a0d89015f4737124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2a9KUHMYBNJsRZrg"/></div></div></figure><p id="ecb6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">截图是在我的FortiGate 60F【https://amzn.to/2W1cHkQ T2】上做的</p><p id="734e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">顾名思义，发送的ARP请求实际上是询问<strong class="is hj">“谁有我需要联系的IP地址”</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/548328d15b876633731667d82cdd6747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TodnZyNCcNSgfoIc"/></div></div></figure><p id="b8d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请求在广播域中发送，或者有时被转发到另一个子网，拥有该IP地址的主机发回其MAC地址</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jv"><img src="../Images/12b714475c5b2f45018b389d356140fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rx2xIn-WkpmIbViG"/></div></div></figure><p id="50a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">MAC地址对于制作数据包本身至关重要。它是IP路由中最重要的功能之一。</p><p id="2c38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一方面，您的FortiGate防火墙有一个ARP表，其中保存了不同接口上不同MAC地址和IP地址之间的绑定。所以让我们更深入地看看ARP表</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6bca7cd9fc453f1f6493af3cd713b350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0FsVrdZN5Qebf1rx"/></div></div></figure><p id="04d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">嗅探ARP </strong></p><p id="2b95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们从检查从我们的局域网发出的ARP请求开始</p><p id="49ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将使用<strong class="is hj">“diag sniffer packet”</strong>，这是一种FortiGate Wireshark方法，用于捕获在不同接口之间传输的数据包，并检查发生了什么。</p><p id="ace1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们检查数据包时，我们可以使用过滤器来捕获特定的流量。</p><p id="eb55" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们将不使用任何过滤器，只使用端口号和详细级别</p><p id="4841" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">“诊断嗅探器数据包端口2无4”</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jw"><img src="../Images/4b4c01241b19a6ba9d82cf6fb02e8510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FFSnN5z3jwT3elUf"/></div></div></figure><p id="ffd3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按回车键，您可以看到不同的ARP请求<strong class="is hj">“谁拥有那个IP地址”</strong>。</p><p id="2ef5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请求的IP地址是网关地址。</p><p id="6e23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">现在让我们看看其他一些命令。</strong></p><p id="415f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以使用的第一个命令是:</p><p id="1e14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">“获取系统ARP”</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/fc3ab2e2f48b9e4d56bbd71be246d46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*leejV4hIjC3V1Se0"/></div></div></figure><p id="5cbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里你可以看到，IP地址，MAC地址，以及相关的接口。</p><p id="efc2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二个命令将显示ARP表缓存</p><p id="bccd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">“诊断ip arp列表”</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6d13a68eb2bb96591be4fcb0005c171b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zaa3XTgc22w52ZjX"/></div></div></figure><p id="6fb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如Fortinet文档中所述，默认的ARP超时值是5分钟(300秒),并且可以根据ARP条目的状态和正在使用的对象而变化。使用该命令，我们可以看到ARP缓存的不同状态(收到ARP，设备不支持ARP…)。</p><p id="7c88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我们的第三个命令是</strong></p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/a96e155ce1b4b022839f0445f729d16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rbDbHn4ijeW_SQh7"/></div></div></figure><p id="155f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们从“配置系统全局”开始，然后，我们将使用“设置最大值”条目，在这里我们可以输入一个带有条目数量的整数。</p><p id="4b0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，有时您需要删除整个ARP表。</p><p id="d3c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用“执行清除系统arp表”</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/6ffa1ffebd90aa98c770ea1ee4ef3a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*12559z5ZJBejEoAd"/></div></div></figure><p id="7b2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们只看系统ARP表。是的，我们只有一个ARP表，它的使用时间(以分钟计)为零。所以现在才收到。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/cd67afd190acf6fdaebb5b736d742834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W92cDK71-YUAuGnJ"/></div></div></figure><p id="ce4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们要看的最后一个命令是“配置系统arp表”</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/2f6d4088d69fbe78594d88b4b9ede127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_hG0EXu1hpzxTVTR"/></div></div></figure><p id="df45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们可以添加特定的IP地址，并根据需要绑定特定的MAC地址。作为端口2的接口。IP、MAC地址，并将它们关联在一起。</p><p id="43e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的书<strong class="is hj">“Fortigate防火墙管理袖珍指南”</strong>【https://amzn.to/37Zobbn T2】中了解更多关于如何管理您的Fortigate防火墙的信息</p></div></div>    
</body>
</html>
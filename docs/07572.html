<html>
<head>
<title>Gradient Descent: Design Your First Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">梯度下降:设计你的第一个机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/gradient-descent-design-your-first-machine-learning-model-ad431cb9295f?source=collection_archive---------22-----------------------#2021-09-22">https://medium.com/geekculture/gradient-descent-design-your-first-machine-learning-model-ad431cb9295f?source=collection_archive---------22-----------------------#2021-09-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a80e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Pytorch从头开始构建一个简单的机器学习模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/58d83d913b6605b07628b8c2ae02bb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zk2OFlDeGajjS2KbOa7cuQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Image by <a class="ae jt" href="https://www.mygreatlearning.com/blog/gradient-descent/" rel="noopener ugc nofollow" target="_blank">mygreatlearning</a></figcaption></figure><p id="73cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">梯度下降是一种优化算法，用于训练机器学习模型，现在用于神经网络。训练数据有助于模型随着时间的推移进行学习，因为梯度下降作为一个自动系统，可以调整参数以实现更好的结果。这些参数在每次迭代后更新，直到函数达到最小的可能误差。IBM </p><p id="ec5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图中的红色箭头是一个梯度，通过在每次迭代后更新我们的参数，我们可以减少损失，这是我们的主要目标。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/48d1c015fef34a19205f982359d0312e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*ejuFUHZEVGLzouSW1ZDb2A.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Edited by Author | Original <a class="ae jt" href="https://console.paperspace.com/tema658q6/notebook/rh2lioxu5no44hu?file=04_mnist_basics.ipynb" rel="noopener ugc nofollow" target="_blank">Fast.AI</a></figcaption></figure><p id="bf7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据Arthur Samuel的说法，梯度下降是改变权重以最大化性能的自动处理<a class="ae jt" href="https://course.fast.ai/videos/?lesson=4" rel="noopener ugc nofollow" target="_blank">快速人工智能</a>。更具体地说，我们将讨论他处理的将功能转化为机器学习模型所需的每一步。</p><ul class=""><li id="3739" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated"><strong class="ih hj">初始化:</strong>我们将参数初始化为随机值。这些初始权重是我们模型的起点，因此我们可以通过使用损失函数来确定我们离目标有多远。</li><li id="a1cc" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated"><strong class="ih hj"> Loss: </strong>我们需要一个函数，它将采用实际值和预测值来计算误差度量。最常见的损失函数是均方误差。</li><li id="5a01" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated"><strong class="ih hj">步骤:</strong>我们将通过增加或减少少量重量来检查体重是增加还是减少，从而找出最佳效果。这种方法效率不高，因为找到正确的方向需要时间。这就是梯度拯救我们的地方。梯度减缓了我们找出我们应该在哪个方向改变权重以获得更好的结果。我们通过函数传递初始权重来预测值，并使用它来计算损失。然后我们取参数的梯度，从原始参数中减去。这个过程重复进行，直到你取得最好的成绩。</li><li id="99d7" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated"><strong class="ih hj">停止:</strong>我们需要决定训练模型需要多少个历元。之后这些迭代就会告一段落。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/02732769e2b0da28db489e2835289d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1givQJwDya9BJ2ppi7iiA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Image by Author | Lucid Chart of Gradient Descent</figcaption></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="8e2d" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">密码</h1><p id="4db7" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">代码受到杰瑞米·霍华德深度学习课程<a class="ae jt" href="https://console.paperspace.com/tema658q6/notebook/rh2lioxu5no44hu?file=04_mnist_basics.ipynb" rel="noopener ugc nofollow" target="_blank"> Paperspace + Fast的影响。AI </a>。我们将使用<a class="ae jt" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> Pytorch </a>进行建模，使用<a class="ae jt" href="https://matplotlib.org/stable/tutorials/introductory/pyplot.html" rel="noopener ugc nofollow" target="_blank"> Pyplot </a>进行可视化。最后设置人工种子重现结果。如果您使用的是Deepnote 环境，您可以复制并粘贴我的代码来获得相同的结果。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h2 id="0401" class="lw ks hi bd kt lx ly lz kx ma mb mc lb iq md me lf iu mf mg lj iy mh mi ln mj bi translated">创造价值</h2><p id="0a6b" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated"><strong class="ih hj"> X </strong>一个从0到19的整数序列。我们可以使用<code class="du mk ml mm mn b">torch.arrange(start,end)</code>来生成</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mo lv l"/></div></figure><p id="be73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Y </strong>用二次函数计算。我们在代码中添加了<strong class="ih hj">随机噪声，使其看起来像真实数据。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/b03d8a9dbd7ace7faf5e080c7dda577e.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*Fvbrsxt7IXxzkQapPgDvFg.jpeg"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mq lv l"/></div></figure><h2 id="443f" class="lw ks hi bd kt lx ly lz kx ma mb mc lb iq md me lf iu mf mg lj iy mh mi ln mj bi translated">核心功能</h2><p id="cfd8" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">找到一个符合我们观察的函数。我们使用一般的二次函数<a class="ae jt" href="https://en.wikipedia.org/wiki/Quadratic_equation" rel="noopener ugc nofollow" target="_blank">因为很难考虑所有可能的函数。</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/0a23391e8e461e32b44b7e0022af201c.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*xJ1xMUB89x0cGojTZT3IHg.jpeg"/></div></div></figure><p id="f7a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的函数有两个参数，<strong class="ih hj"> t </strong> &amp; <strong class="ih hj"> params。</strong>梯度下降将改变这些参数以提高我们模型的性能。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="42c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用均方差(MSE)作为损失函数，均方根误差(RMSE)作为性能指标。MSE是通过计算预测值和实际值之间差值的平均平方来计算的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ms"><img src="../Images/7acd6f259d7eda3907b11245236eef55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*_n254U5_lQr2PA9JyLMVpQ.jpeg"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mt lv l"/></div></figure><p id="b546" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">学习率</strong>是一个步长，用于在每次迭代中更新参数，同时使损失最小化。如果学习率太低，将需要许多步骤才能得到最好的结果，另一方面，如果你选择太高，它可能会反弹而不是发散。最佳实践是从小处开始，然后在每次运行后改变它，以实现最小损失。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/7b8616d7f7bb4d4dced35af06fd427b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*yV9KUSvpLr9r1G9M4VqaeQ.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Edited by Author | Original <a class="ae jt" href="https://console.paperspace.com/tema658q6/notebook/rh2lioxu5no44hu?file=04_mnist_basics.ipynb" rel="noopener ugc nofollow" target="_blank">Fast.AI</a></figcaption></figure><p id="0101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du mk ml mm mn b">torch.randn(3)</code>设置初始权重，并告诉PyTorch我们想要使用<code class="du mk ml mm mn b">requires_grad_</code>跟踪它们的梯度。其次，我们将学习率设置为1e-5。最后，我们需要创建原始参数的克隆，以便我们可以在以后使用它来展示准确性度量。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mu lv l"/></div></figure><h2 id="6163" class="lw ks hi bd kt lx ly lz kx ma mb mc lb iq md me lf iu mf mg lj iy mh mi ln mj bi translated">形象化</h2><p id="c96d" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">可视化功能比较预测值和实际值的散点图。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mv lv l"/></div></figure><p id="04d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们将初始参数添加到我们的函数中，并尝试使用<code class="du mk ml mm mn b">matplotlib.pyplot</code>来预测输出和绘图。正如我们所看到的，两者走向相反的方向。接下来，我们将使用梯度下降，以减少两个函数之间的差异。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mw lv l"/></div></figure><h2 id="4e89" class="lw ks hi bd kt lx ly lz kx ma mb mc lb iq md me lf iu mf mg lj iy mh mi ln mj bi translated"><strong class="ak">机器学习模型</strong></h2><p id="ccf2" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">我们将使用Arthur Samuel机器学习模型来自动改变参数以减少损失。</p><ol class=""><li id="869a" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc mx kb kc kd bi translated">使用函数初始化权重</li><li id="fd7d" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">计算损失</li><li id="a9b4" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">使用parameters.required_grads_允许我们回调损失，然后帮助我们计算参数的梯度。</li><li id="5a7a" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">通过乘以学习率然后减去原始参数来计算参数的梯度。</li><li id="20f9" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">重置参数的梯度</li><li id="ed23" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">打印RMSE</li><li id="c2ce" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc mx kb kc kd bi translated">回报预测</li></ol><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="my lv l"/></div></figure><p id="1a3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们运行6次迭代，并将结果作为实际值和预测值之间的比较。正如我们可以看到的，随着每一次迭代，预测函数的红色散点图正在慢慢模拟我们的实际函数。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mz lv l"/></div></figure><p id="b0c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们需要使用<code class="du mk ml mm mn b">orig_params</code>重置我们的参数。我们将运行10次迭代并打印出RMSE。正如我们可以看到的，在第四次迭代之后，RMSE度量稳定并且缓慢降低。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="na lv l"/></div></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="0c10" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">结论</h1><p id="f93e" class="pw-post-body-paragraph if ig hi ih b ii lp ik il im lq io ip iq lr is it iu ls iw ix iy lt ja jb jc hb bi translated">我曾经认为，你可以在不深入机制的情况下建立机器学习模型，事实证明，我的策略有缺陷，因为我局限于现有的模型和库。如果你想创建自己的尖端深度学习模型，你需要学习神经网络如何工作的机制。你不需要学习数学，但是学习最小的构建模块将会帮助你创建你的模型，它甚至会比现有的模型表现得更好。</p><p id="68ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们已经了解了梯度体面如何在深度学习中工作，并通过使用亚瑟塞缪尔的原始框架，我们已经产生了我们的模型，并在该模型上训练我们的数据。我们还通过比较可视化和RMSE度量分数来评估我们的结果。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="28d3" class="kr ks hi bd kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">学习资源</h1><ul class=""><li id="eacc" class="jv jw hi ih b ii lp im lq iq nb iu nc iy nd jc ka kb kc kd bi translated"><a class="ae jt" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank">程序员实用深度学习|程序员实用深度学习(fast.ai) </a></li><li id="68e4" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated"><a class="ae jt" href="https://www.amazon.com/Deep-Learning-Coders-fastai-PyTorch/dp/1492045527" rel="noopener ugc nofollow" target="_blank">针对拥有Fastai和PyTorch的程序员的深度学习:没有博士学位的ai应用:Howard、Jeremy、Gugger、Sylvain </a></li><li id="ab88" class="jv jw hi ih b ii ke im kf iq kg iu kh iy ki jc ka kb kc kd bi translated"><a class="ae jt" href="https://www.youtube.com/watch?v=GIsg-ZUy0MY" rel="noopener ugc nofollow" target="_blank">深度学习PyTorch全程/教程— YouTube </a></li></ul><blockquote class="ne nf ng"><p id="caf4" class="if ig nh ih b ii ij ik il im in io ip ni ir is it nj iv iw ix nk iz ja jb jc hb bi translated">你可以在<a class="ae jt" href="https://www.linkedin.com/in/1abidaliawan/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae jt" href="https://www.polywork.com/kingabzpro" rel="noopener ugc nofollow" target="_blank"> Polywork </a>上关注我，我在那里发布了关于数据科学和机器学习的惊人文章。</p></blockquote><p id="969b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="nh">本文中显示的媒体不归Analytics Vidhya所有，由作者自行决定使用。</em> </strong></p><p id="1425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="nh">相关</em></p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="3d9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="nh">原载于2021年8月23日</em><a class="ae jt" href="https://www.analyticsvidhya.com/blog/2021/08/gradient-descent-design-your-first-machine-learning-model" rel="noopener ugc nofollow" target="_blank"><em class="nh">【https://www.analyticsvidhya.com】</em></a><em class="nh">。</em></p></div></div>    
</body>
</html>
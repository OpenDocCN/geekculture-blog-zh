<html>
<head>
<title>Establishing connection to Couchbase server from aws ec2 instance using Couchbase Java SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Couchbase Java SDK从aws ec2实例建立到Couchbase服务器的连接</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/establishing-connection-to-couchbase-server-from-aws-ec2-instance-using-couchbase-java-sdk-5bdc4a1aeaaa?source=collection_archive---------31-----------------------#2021-04-16">https://medium.com/geekculture/establishing-connection-to-couchbase-server-from-aws-ec2-instance-using-couchbase-java-sdk-5bdc4a1aeaaa?source=collection_archive---------31-----------------------#2021-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/73da25f67ddcbbd9fc95cdcf6bb5f03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BK4giDj8uaVNxP-x"/></div></div></figure><p id="e010" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在使用Couchbase java sdk中的公共ip从我的笔记本电脑建立到ec2中Couchbase服务器的连接时遇到了问题。所以对我来说，前进的唯一方法是在ec2实例中创建maven项目，并使用连接字符串“localhost”连接到Couchbase。</p><p id="352b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这篇博客是关于我如何从终端在Ubuntu ec2实例中创建maven项目，并建立到Couchbase服务器的连接以从bucket获取数据。</p><p id="db3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Maven是一个Java工具，因此您必须安装Java才能继续。<br/>首先，下载Maven并按照<a class="ae jo" href="https://maven.apache.org/install.html" rel="noopener ugc nofollow" target="_blank">安装说明</a>进行操作。我在ec2中使用ubuntu，所以，如果你使用windows或mac，你的步骤可能会改变。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="50f6" class="jy jz hi ju b fi ka kb l kc kd">mvn --version</span></pre><p id="d0a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦确认安装了maven，就进入创建maven项目。</p><p id="295b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个文件夹并在那里启动shell，然后执行下面的Maven命令。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="3aab" class="jy jz hi ju b fi ka kb l kc kd">mvn archetype:generate -DgroupId=com.couchbase.client -DartifactId=couchbaseanalytics -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false</span></pre><p id="44ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里“DartifactId”是您的项目名称，“DarchetypeArtifactId”是Maven项目的类型。</p><p id="7262" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您在键入上述命令后按Enter键，它将开始创建Maven项目。如果您刚刚安装了Maven，第一次运行可能需要一段时间。这是因为Maven正在将最新的工件(插件jar和其他文件)下载到您的存储库中。在成功之前，您可能还需要执行几次该命令。这是因为远程服务器可能会在您的下载完成之前超时。</p><p id="6ad3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">错误</strong>:如果构建失败，请检查pom.xml文件中的Maven版本号。它应该与您机器上安装的Maven版本相匹配。</p><p id="b79b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行该命令后，它会创建一个与artifactId同名的目录。换到那个目录。</p><p id="5be7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ke kf kg ju b">cd couchbaseanalytics</code></p><p id="5c98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个目录下，您会注意到下面的标准项目结构。如果不是这样，那么你可能已经偏离了某个地方。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="8062" class="jy jz hi ju b fi ka kb l kc kd">couchbaseanalytics<br/>|-- pom.xml<br/>`-- src<br/>    |-- main<br/>    |   `-- java<br/>    |       `-- com<br/>    |           `-- couchbase<br/>    |               `-- client<br/>    |                   `-- App.java<br/>    `-- test<br/>        `-- java<br/>            `-- com<br/>                `-- couchbase<br/>                    `-- client<br/>                        `-- AppTest.java</span></pre><p id="b77c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">src/main/java目录应该包含项目源代码，pom.xml文件是项目的项目对象模型，即pom。</p><p id="1a8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">pom.xml文件是Maven中项目配置的核心。它是一个单一的配置文件，包含按照您想要的方式构建项目所需的大部分信息。</p><p id="206e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开pom文件，尝试探索不同的领域。</p><p id="101e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在运行下面的命令来构建项目。</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="5637" class="jy jz hi ju b fi ka kb l kc kd">mvn package</span></pre><p id="bd06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦构建成功，您可以使用以下命令测试新编译和打包的JAR:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="f619" class="jy jz hi ju b fi ka kb l kc kd">java -cp target/couchbaseanalytics-1.0-SNAPSHOT.jar com.couchbase.client.App</span></pre><p id="b684" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该命令将打印:</p><p id="4b07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ke kf kg ju b">Hello World!</code></p><h1 id="e1b6" class="kh jz hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">现在修改这个项目以连接到couchbase:</h1><p id="2fdc" class="pw-post-body-paragraph iq ir hi is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hb bi translated">现在将下面的内容添加到<code class="du ke kf kg ju b">&lt;dependencies&gt;</code>内的pom.xml文件中:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="7482" class="jy jz hi ju b fi ka kb l kc kd">&lt;dependency&gt;<br/>        &lt;groupId&gt;com.couchbase.client&lt;/groupId&gt;<br/>        &lt;artifactId&gt;java-client&lt;/artifactId&gt;<br/>        &lt;version&gt;3.1.3&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="7c53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，编辑Java App.java文件:<br/>您可以使用vi打开，我使用了以下命令来代替cd目录:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="46a3" class="jy jz hi ju b fi ka kb l kc kd">vi /home/ubuntu/kiran/couchbaseanalytics/src/main/java/com/couchbase/client/App.java</span></pre><p id="db5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:您的路径可能不同，因此分别进行更改。</p><p id="dd08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在主类中添加下面的代码</p><p id="351d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ke kf kg ju b">Cluster cluster = Cluster.connect(connectionString, username, password);</code></p><p id="0464" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">connectionString是“本地主机”</p><p id="b078" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">集群提供对集群级操作的访问，如N1Ql查询、分析或全文搜索。</p><p id="1bfe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下导入是构建代码片段所必需的:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="74bf" class="jy jz hi ju b fi ka kb l kc kd">import com.couchbase.client.java.*;<br/>import com.couchbase.client.java.kv.*;<br/>import com.couchbase.client.java.json.*;<br/>import com.couchbase.client.java.query.*;</span></pre><p id="a895" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要访问KV(键/值)API或查询视图，您需要打开一个存储桶:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="33cc" class="jy jz hi ju b fi ka kb l kc kd">// get a bucket reference Bucket bucket = cluster.bucket(bucketName);</span></pre><p id="f401" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在集群级别执行N1QL查询:</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="e71b" class="jy jz hi ju b fi ka kb l kc kd">QueryResult result = cluster.query("select * from `beer-sample` limit 10"); <br/>System.out.println(result.rowsAsObject());</span></pre><p id="1726" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:我有bucket <code class="du ke kf kg ju b">beer-sample</code>你可以用你拥有的bucket名称替换它。</p><p id="3aaf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在运行:</p><p id="91d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ke kf kg ju b">mvn clean install</code></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="0e02" class="jy jz hi ju b fi ka kb l kc kd">mvn compile exec:java -Dexec.mainClass="com.couchbase.client.App" -Dexec.arguments="Hello World,Bye"</span></pre><p id="008f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您应该可以在终端中看到bucket中的记录。</p><h1 id="597a" class="kh jz hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">如果你想复制粘贴运行完整的代码，这里是:</h1><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="8ede" class="jy jz hi ju b fi ka kb l kc kd">import com.couchbase.client.java.*;<br/>import com.couchbase.client.java.kv.*;<br/>import com.couchbase.client.java.json.*;<br/>import com.couchbase.client.java.query.*;</span><span id="2edb" class="jy jz hi ju b fi lj kb l kc kd">public class App {<br/>    public static void main(String[] args) {</span><span id="0299" class="jy jz hi ju b fi lj kb l kc kd">Cluster cluster = Cluster.connect(connectionString, username, password);<br/>    Bucket bucket = cluster.bucket(bucketName);</span><span id="1994" class="jy jz hi ju b fi lj kb l kc kd">QueryResult result = cluster.query("select * from `beer-sample` limit 10");<br/>    System.out.println(result.rowsAsObject());</span><span id="6ba3" class="jy jz hi ju b fi lj kb l kc kd">}</span></pre><p id="8715" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">万岁！！！就是这样。现在您已经与Couchbase服务器建立了连接。你可以在App.java编辑代码来适应你的用例。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="cae3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lr">原发布于</em><a class="ae jo" href="https://blog.learnwithdata.me/establishing-connection-to-couchbase-server-from-aws-ec2-instance" rel="noopener ugc nofollow" target="_blank"><em class="lr">https://blog . learnwithdata . me</em></a><em class="lr">。</em></p></div></div>    
</body>
</html>
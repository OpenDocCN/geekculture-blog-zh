<html>
<head>
<title>Crop type classification with satellite imagery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用卫星图像进行作物类型分类</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/crop-type-classification-with-satellite-imagery-dfc200f82927?source=collection_archive---------3-----------------------#2022-08-14">https://medium.com/geekculture/crop-type-classification-with-satellite-imagery-dfc200f82927?source=collection_archive---------3-----------------------#2022-08-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7e51" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解我们的作物类型分类方法</h2></div><p id="8f8a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作物类型分类是农业中的一项常见任务。作物类型分类的主要目标是创建一个地图/图像，其中每个点都有一类生长在那里的作物，如下图所示。有很多方法可以解决这个问题。然而，探索最多的方法之一是利用遥感数据。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/ae4165db3379809226cec5763e026704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/0*HSnwnO9eyfvCoYHn"/></div><figcaption class="kb kc et er es kd ke bd b be z dx">Figure 1 — Example of crop-type classification map</figcaption></figure><p id="e168" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">有许多关于作物类型分类的文章</strong> —其中一些<a class="ae kf" href="https://www.mdpi.com/2072-4292/12/24/4052" rel="noopener ugc nofollow" target="_blank">研究使用多时相图像的可能性</a> —这意味着拍摄图像的时间序列而不是一个日期的图像。其他人使用多光谱图像研究<a class="ae kf" href="https://www.researchgate.net/publication/280945828_Land_Cover_and_Crop_Type_Classification_along_the_Season_Based_on_Biophysical_Variables_Retrieved_from_Multi-Sensor_High-Resolution_Time_Series" rel="noopener ugc nofollow" target="_blank">的机会，结合来自不同卫星</a>的<a class="ae kf" href="https://www.semanticscholar.org/paper/Deep-Learning-Classification-of-Land-Cover-and-Crop-Kussul-Lavreniuk/7a9e471e31ac156cf22a5e2a5c1463697df866ab" rel="noopener ugc nofollow" target="_blank">图像，并改进</a><a class="ae kf" href="https://www.semanticscholar.org/paper/Semantic-Segmentation-of-Crop-Type-in-Africa%3A-A-and-Rustowicz-Cheong/87f0cffad2d7527273a25a945736c1e813c08312" rel="noopener ugc nofollow" target="_blank">模型</a>本身。</p><p id="d6b4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的案例中，我们使用来自Sentinel-1和Sentinel-2卫星的多时相图像作为模型输入数据。至于模型，我们使用了一个更常见的模型架构来完成细分任务——Unet，以及Conv-LSTM。</p><h1 id="8d24" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">数据集准备</h1><blockquote class="ky kz la"><p id="38c9" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated"><em class="hi">用于训练模型的数据集包括:</em></p><p id="5036" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated"><em class="hi"> 1。标签-来自2019年生长季节</em> <a class="ae kf" href="https://nassgeodata.gmu.edu/CropScape/" rel="noopener ugc nofollow" target="_blank"> <em class="hi">作物景观</em> </a> <em class="hi">的数据。</em></p><p id="fe18" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated"><em class="hi"> 2。模型输入-哨兵-1和哨兵-2卫星图像的时间序列。</em></p><p id="ba3b" class="ix iy lb iz b ja jb ij jc jd je im jf lc jh ji jj ld jl jm jn le jp jq jr js hb bi translated">我们选择俄亥俄州作为研究地区。</p></blockquote><h1 id="380d" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">农作物景观</h1><ol class=""><li id="a357" class="lf lg hi iz b ja lh jd li jg lj jk lk jo ll js lm ln lo lp bi translated">前10个最常见的类被用作目标，所有其他类被标记为背景。大豆和玉米是这十大类中的一部分，也是我们研究的主要作物。</li><li id="db3c" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">一些不太常见的类别必须合并为一个类别以获得更高的准确性，例如，几种类型的森林(混合林、落叶林、常绿林)必须合并为一个类别。不同强度的城市地区也遵循同样的程序。</li><li id="0bc8" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">在训练、验证和测试过程中使用的最后一组类如下:玉米、大豆、休闲/闲置耕地、城市地区、森林、草地/牧场和背景。</li></ol><h1 id="ae5c" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">哨兵-1</h1><ol class=""><li id="aebd" class="lf lg hi iz b ja lh jd li jg lj jk lk jo ll js lm ln lo lp bi translated">我们只下载了GRD生产的哨兵-1图像。</li><li id="f930" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">使用了具有VV和VH偏振的两个S1波段。</li><li id="a6e4" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">我们使用ESA SNAP工具箱对Sentinel-1图像进行预处理。这种预处理的主要目的是对Sentinel-1图像进行地形校正，同时去除噪声。</li><li id="332e" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">在快照预处理后，Sentinel-1图像被归一化，使值从0到1。</li></ol><p id="5876" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于使用Sentinel-1图像的更多细节，你可以阅读我们关于Sentinel-1预处理的博客。</p><h1 id="29ca" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">哨兵-2</h1><ol class=""><li id="ad87" class="lf lg hi iz b ja lh jd li jg lj jk lk jo ll js lm ln lo lp bi translated">仅下载了哨兵-2图像的L2A产品。</li><li id="c72a" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">使用了十个S2波段(蓝、绿、红、近红外(NIR)、四个红边波段和两个短波红外(SWIR)波段)，并计算了遥感中常用的另外两个波段——NDVI和NDMI。</li><li id="c864" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">所有12个波段都进行了归一化，使值在0到1的范围内。</li></ol><p id="1653" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你对Sentinel-2图像感兴趣，你可以阅读<a class="ae kf" href="https://quantumobile.com/rd-blog/sentinel2tools-simple-lib-for-downloading-sentinel-2-satellite-images/" rel="noopener ugc nofollow" target="_blank">我们的博客</a>关于我们下载Sentinel-2图像的工具。</p><h1 id="3665" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">数据平铺</h1><p id="2438" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">在卫星图像被下载和预处理以用于训练之后。大的哨兵图像必须被分割成更小的图像(平铺)(图。1).我们过滤掉了云百分比高于20%的Sentinel-2瓦片。哨兵-1号瓷砖保持原样。在训练循环期间，如果几幅Sentinel-2图像重叠，并且只有一个采集日期，则只拍摄其中一幅图像，以避免数据重复。俄亥俄州的最终版本如图1所示。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ly"><img src="../Images/c4da195fc0f78af076dea9459a115b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/0*vx7BUDi_Nyc1Kb-u"/></div><figcaption class="kb kc et er es kd ke bd b be z dx">Figure 2 — Tile coverage of Ohio</figcaption></figure><h1 id="119d" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">建模</h1><h2 id="aed7" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">输入特征</h2><p id="39b0" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">如上所述，我们使用了Sentinel-2的十个波段、两个额外的索引波段和Sentinel-1的两个波段。我们在实验中使用它们，没有使用子集进行实验。图像拼贴是192x192像素，在训练期间，对它们应用了一些基本的增强，如裁剪、翻转、旋转和调整大小。数据集以70/20/10的比例分为训练集、验证集和测试集。必须实施一种采样策略来对成批的图像时间序列进行训练。这将允许我们将相似长度的序列归入一批。</p><h2 id="af69" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">模型架构</h2><p id="6f5f" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">本文<a class="ae kf" href="https://openaccess.thecvf.com/content_CVPRW_2019/papers/cv4gc/Rustowicz_Semantic_Segmentation_of_Crop_Type_in_Africa_A_Novel_Dataset_CVPRW_2019_paper.pdf" rel="noopener ugc nofollow" target="_blank">中描述的架构之一</a> — 2D U-Net + CLSTM被使用。每颗卫星都有自己的编码器-解码器-CLSTM模型，随后每颗卫星的输出被连接起来并传递到最终的线性层。文章中模型的架构如图3所示。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="er es mn"><img src="../Images/8a308748461f25dfa6dd2ba44e726c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i-X8Ps8PpWL31akF"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx">Figure 3 — Model architecture</figcaption></figure><h2 id="708e" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">超参数</h2><p id="6c52" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">使用<a class="ae kf" href="https://machinelearningmastery.com/cross-entropy-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">交叉熵损失</a>和<a class="ae kf" rel="noopener" href="/ai-salon/understanding-dice-loss-for-crisp-boundary-detection-bb30c2e5f62b#:~:text=Dice%20loss%20originates%20from%20S%C3%B8rensen,for%203D%20medical%20image%20segmentation.">骰子损失</a>的加权组合来训练模型。Adam用于参数优化，学习率的起始值为0.003，在20个时期的训练后降低到0.0003。所有的模型总共被训练了40个时期。</p><h1 id="6f1c" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">实验</h1><p id="78de" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated"><a class="ae kf" href="https://en.wikipedia.org/wiki/F-score" rel="noopener ugc nofollow" target="_blank"> F1-score </a>分别对每个类别的像素级别计算度量，以评估在所进行的实验期间训练的模型。我们只选择了作物类的指标，因为它们是我们的主要类，而其他类是辅助类，以提高作物类的模型性能。</p><h2 id="7462" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">使用不同的卫星图像组合</h2><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ms"><img src="../Images/76a1120fa8792360fa61cb26c9acd671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*iJvqc03TlKudH2Zy4UvWIQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx">Table 1 — Comparison of the model performance based on what satellite combinations were used, 5-months of satellite data were used at 30m resolution.</figcaption></figure><p id="4512" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，Sentinel-1和Sentinel-2的组合为我们的作物类别提供了比仅使用Sentinel-2稍好的结果。</p><h2 id="698c" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">使用不同的输入分辨率</h2><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="er es mt"><img src="../Images/30728c646256f13653cffc701962e921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXm1UHhGmS_w0dtz7ySBOQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx">Table 2 — Comparison of the model performance based on the input resolution. Both Sentinel-1 and Sentinel-2 images were used.</figcaption></figure><p id="ee6f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在两个不同的日期范围内比较了两种输入分辨率。在这两种情况下，10m分辨率比30m分辨率给出的结果更好，而最好的结果是从4月初到8月底的5个月的覆盖范围。</p><h2 id="9513" class="lz kh hi bd ki ma mb mc km md me mf kq jg mg mh ks jk mi mj ku jo mk ml kw mm bi translated">使用不同的时间框架</h2><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mu"><img src="../Images/499c53109c41b281929b57f2f1370b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*r53G6vZ4Qei0c0GrsN6InQ.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx">Table 3 — Comparison of the model performance based on how many months of data were taken, both Sentinel-1 and Sentinel-2 were used at 10m resolution.</figcaption></figure><p id="db69" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并且进行最后的实验以确认所有的夏季生长季节都给出了最好的结果，并且如果时间间隔减少，则匹配模型性能。结果表明，4个月的范围变化降低了准确性，但没有3个月范围的情况差，这意味着植物实际上准备好收获的月份远不如植物正在积极生长的月份重要。</p><h1 id="6639" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">结论</h1><p id="ff55" class="pw-post-body-paragraph ix iy hi iz b ja lh ij jc jd li im jf jg lv ji jj jk lw jm jn jo lx jq jr js hb bi translated">因此，我们的数据集准备和建模的方法进行了描述。以下是我们得到的实验结果:</p><ol class=""><li id="c379" class="lf lg hi iz b ja jb jd je jg mv jk mw jo mx js lm ln lo lp bi translated">光学图像(Sentinel-2)和合成孔径雷达图像(Sentinel-1)的结合比仅使用光学图像的效果更好。</li><li id="b55b" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">分辨率较高的图像(10米)比分辨率为30米的图像效果更好。</li><li id="4372" class="lf lg hi iz b ja lq jd lr jg ls jk lt jo lu js lm ln lo lp bi translated">涵盖生长季节的日期范围比较短的日期范围好得多。</li></ol><p id="2cb5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望您对我们解决作物类型分类方法的描述感兴趣。如果你有任何问题或意见，请在下面的评论区留言。</p></div></div>    
</body>
</html>
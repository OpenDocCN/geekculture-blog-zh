<html>
<head>
<title>Detecting if a record was created from a desktop or mobile device in ServiceNow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在ServiceNow中检测记录是从桌面还是移动设备创建的</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/detecting-if-a-record-was-created-from-a-desktop-or-mobile-device-4a3f95ac702d?source=collection_archive---------29-----------------------#2021-06-05">https://medium.com/geekculture/detecting-if-a-record-was-created-from-a-desktop-or-mobile-device-4a3f95ac702d?source=collection_archive---------29-----------------------#2021-06-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a421" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用isMobile()方法检查记录是否是从移动设备创建的。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/98b6b2a97a48c49e7a39d51b8d906e75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OA10GbRRthyw6htJTLLvsA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@firmbee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Firmbee.com</a> on <a class="ae jn" href="https://unsplash.com/s/photos/mobile-phone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="065d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我正在处理一个需求，我需要知道记录是从移动设备还是桌面设备创建的，因此，我想尝试一下JavaScript navigator方法，以检测记录是从移动设备还是桌面设备创建的，并发现ServiceNow有一个来自GlideSystem类的方法来完成这个任务。GlideSystem提供了几种有用的方法来获取关于系统、当前登录系统的用户以及日期和时间函数的信息。尽管这个脚本只适用于新创建的记录，但是了解这个方法以便将来使用还是很有好处的。</p><p id="8033" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所以，现在，isMobile()方法。</p><p id="5f7f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，我们在<em class="kk">事件</em>表中创建一个新字段，称为“u_source”选择列表，有两个选项；“移动”和“桌面”</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kl"><img src="../Images/aae64f52fe84ff8c7b9c1dbcf8cfe0b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*gj_0t_5PrF6_DEq_hZgjBg.png"/></div></figure><p id="bd11" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后，我们为每次插入运行的<em class="kk">事件</em>表创建一个before业务规则。</p><p id="f061" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们用<code class="du km kn ko kp b">gs.isMobile()</code>检查记录是否是从移动设备上创建的。如果它返回true，那么我们使用<code class="du km kn ko kp b">current</code>对象；<strong class="jq hj">当前对象</strong>从GlideRecord类实例化而来，可以访问记录的所有字段和所有GlideRecord方法。因为我们刚刚创建了一个新的字段，它应该可以使用<code class="du km kn ko kp b">current.u_source;</code>来访问，在这种情况下，我们希望在条件返回true的实例中，为字段<em class="kk"> u_source，</em>赋值<em class="kk">e“Mobile”。</em></p><pre class="iy iz ja jb fd kq kp kr ks aw kt bi"><span id="ab05" class="ku kv hi kp b fi kw kx l ky kz">if (gs.isMobile())<br/>     current.u_source = 'Mobile';<br/> else<br/>     current.u_source = 'Desktop';</span></pre><p id="360a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">业务规则的完整主体:</p><pre class="iy iz ja jb fd kq kp kr ks aw kt bi"><span id="4147" class="ku kv hi kp b fi kw kx l ky kz">(function executeRule(current, previous /*null when async*/ ) {<br/> if (gs.isMobile())<br/>     current.u_source = 'Mobile';<br/> else<br/>     current.u_source = 'Desktop';<br/>})(current, previous);</span></pre><p id="247d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通过创建新的事件记录从桌面测试输出，将<em class="kk">源</em>字段设置为“桌面”，当从移动设备创建事件时，将“源”字段设置为“移动”。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Human Emotions Recognition through Facial Expressions and Sentiment Analysis for Emotionally Aware Deep Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于情感感知深度学习模型的通过面部表情和情感分析的人类情感识别</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/human-emotions-recognition-through-facial-expressions-and-sentiment-analysis-for-emotionally-aware-4a41d7f8b80e?source=collection_archive---------26-----------------------#2021-05-30">https://medium.com/geekculture/human-emotions-recognition-through-facial-expressions-and-sentiment-analysis-for-emotionally-aware-4a41d7f8b80e?source=collection_archive---------26-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/27839fd0136507d2e5578f987d4fe5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEAZ2dOxOXGra9BPtvc3vg.png"/></div></div></figure><p id="0a95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">情绪经常调解和促进人类之间的互动。因此，理解情绪通常会给看似怪异和/或复杂的社会交流带来背景。情绪识别可以通过各种方法来识别，如语音语调和肢体语言，也可以通过更复杂的手段，如脑电图。最可行和简单的方法仍然是观察面部表情。人类的七种基本情绪是快乐、恐惧、愤怒、悲伤、惊讶、鄙视和厌恶，这些情绪在世界各地的任何社会或文化群体中都很常见。当考虑这些事实时，可以看出人类的情绪对行动和对情况的反应有巨大的影响。</p><p id="aadc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开发像情绪感知深度学习模型这样的人工智能模型时，对情绪的识别对于为用户提供适当的响应非常重要。下图简单描述了根据用户情绪提供响应的重要性。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/2662c7317245f602ff79aa134ac551b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*o7bHow0wlMV4_QSkeIxDJg.png"/></div></figure><p id="ed8a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文讨论了两种识别情感的方法(情感分析和人脸表情识别)。</p><h2 id="69c0" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">情感分析</h2><p id="8813" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">情感分析是NLP一个子领域，它试图提取给定文本的主观观点。情感分析跨越识别文本情感、意图和讽刺。简单地说，这给一个给定的文本分配极性。例如，句子“M&amp;M是我尝过的最糟糕的冰淇淋之一”，包含负极性。情感阶段是“最糟糕的冰淇淋”，并针对情感目标“M&amp;M”。“运动鞋和火星明天将发布他们最新的巧克力口味”，这是一个关于运动鞋和火星的事实句子，因此它包含一个中性的上下文。“运动鞋冰淇淋成为去年最受欢迎和最畅销的冰淇淋”，有正面评价，因为它有“最受欢迎”和“最畅销”等词指运动鞋。</p><h2 id="5b0d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">情感分析的挑战</h2><p id="5321" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">人类语言包含某些传统上与语言相关的微妙之处，提取某一阶段的准确情感是一项具有挑战性的任务。</p><p id="2178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">否定处理:——例如:——“你的办公室工作怎么样？不算太差！不过，我对最近的加薪不太满意。。. "虽然第一句包含中性极性，第二句包含积极的意见，但同时它有“太坏了”，这原本是一个消极的阶段。第三句话有一个否定的上下文，但包含了原本有肯定意见的“超级开心”。</p><p id="be28" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">讽刺:“这正是我今天需要的。。。太好了！”不考虑“棒极了”这个表达，这句话很可能是在讽刺，包含了一个负极性。</p><p id="ad9c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">比较:——例如:——“我喜欢运动鞋和新的冰淇淋，它们比M&amp;M的好得多”虽然“喜欢”和“好得多”有积极的一面，但在M&amp;M看来，这不是一个好的说法。</p><p id="e16f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述所有例子都需要理解整个上下文的意思以及单词的意思。使用情感分析算法时，准确性和速度之间的权衡是一个必须面对的实际挑战。朴素贝叶斯、支持向量机和逻辑回归是一些被广泛用于大规模情感分析的传统ML技术，因为它们具有很好的扩展性。已经证明，DL策略可以在各种NLP任务(如情感分析)中实现更高水平的准确性，但是它们的训练成本更高，并且通常更慢。</p><p id="4a3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">缺乏可用的人工注释数据导致了NLP任务的局限性。最近，twitter作为一个微博平台在世界范围内获得了很高的人气。一些组织通过使用从Tweepy API收集的Tweepy进行数据挖掘研究。</p><h2 id="eac4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">情感分析方法</h2><p id="bf66" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">基于规则的系统和机器学习系统是情感分析的两种主要方法。</p><p id="01b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">基于规则的系统</strong></p><p id="f02e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在基于规则的系统中，存在代表特定观点的极化术语和表达的预定义数据集。作为一个例子，这个预定义的数据集可以包含诸如“快乐”、“有趣”、“好”、“漂亮”的正面词列表和诸如“悲伤”、“糟糕”、“最糟糕”的负面词列表。然后，对于给定的相位，计算正项和负项的数量。基于规则的系统根据该计数定义句子的最终极性。如果句子包含肯定列表中较高数量的术语，则认为是肯定意见，反之亦然。</p><p id="51d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">机器学习系统</strong></p><p id="59d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于机器学习系统，需要有一个训练数据集。该数据集包含具有不同表达方式的示例，如阳性、阴性和中性等。ML算法用于这种技术。因为ML算法不直接理解文本，所以示例阶段被转换成向量。接下来，这些向量被用于通过朴素贝叶斯和SVM等算法来训练模型。然后，通过将文本转换成向量并将其馈送给分类器，使用训练好的模型来预测新句子的情感。这将返回包含该特定句子的表达式的标签。</p><p id="57a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">ML系统情感分析阶段</strong></p><p id="18a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用twitter数据集作为训练数据集具有可扩展性、实时分析和一致性标准等优点。下图是情感训练和预测的流程图。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/e8d10091074b86065496795acf7f25f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5sbTB-iqhIxhpebyBEyWg.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">Flow Chart of Sentiment Analysis Process</figcaption></figure><p id="0ec2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数据采集</strong></p><p id="c7d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Twitter数据集可用于训练ML模型，并对测试数据运行实际的情感分析。twitter数据主要有两种类型，即当前推文和历史推文。当前推文有助于跟踪最新的关键词和标签。这有助于用实时数据更新模型。而历史数据有助于训练具有大量阶段的模型。可以使用twitter API、Tweepy API等API和Zapier、IFTTT、导出Tweet、Tweet Download等工具从Twitter中提取数据。</p><p id="6326" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">数据预处理</strong></p><p id="e3cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">情感分析结果的可靠性主要取决于数据的质量。因此，需要清理数据。在预处理阶段，像符号、表情符号、标签、多余的空格、特殊字符等不相关的信息被删除。预处理还包括删除少于三个字符的tweet和删除重复的tweet。</p><p id="0821" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">特征提取</strong></p><p id="a5ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在特征提取阶段，文本被转换成向量。这是通过使用表示给定文本的频率的维度向量来实现的。</p><p id="8523" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">=&gt; ML方法</p><p id="6c64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">机器学习分类包括监督学习和非监督学习两大类。标记的数据集被输入到模型中，并在监督学习中进行训练，而非监督学习根本没有提供任何目标或类别。下面描述了ML方法中使用的几个分类器，</p><p id="b6ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">朴素贝叶斯分类器</p><p id="19e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">朴素贝叶斯分类器使用在特征向量中使用的大量特征。这些特征是独立的。朴素贝叶斯条件概率数学表示如下:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/9576d8e340b6f7f6e7bb749bb638a47a.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*2IwuEkL9KGDaIpCIqcjpTQ.png"/></div></figure><p id="4344" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“X”代表由X=x1，x2，…表示的特征向量。xm和“yj”代表类别标签。独立特征分类使用朴素贝叶斯分类器进行有效分类。</p><p id="1f21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(b) SVM(支持向量机分类器)</p><p id="2d6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SVM利用巨大的差距进行分类。以下功能用于SVM、</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/4c84127459ec0072b710bf7b37f2e71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*leuoYBQbjOwqOtDHP2_oMA.png"/></div></figure><p id="ef38" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“X”代表特征向量，“w”代表权重向量，“b”代表偏差向量。信息空间转换到高维特征空间的⏀denotes非线性映射。</p><p id="40d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">= &gt;基于词典的方法</p><p id="bd5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于词典的方法是将文本消息的组块表示为单词包。对于这种表示，情感值被标记。像average或sum这样的函数用于识别最终的情感。在识别最终情感时，消息的本地上下文也被考虑在内。</p><h2 id="990c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">人脸表情识别</h2><p id="544c" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb kq jd je jf kr jh ji jj ks jl jm jn hb bi translated">可以通过分析诸如身体运动、声音、面部和其他生物信号之类的身体特征来收集对用户情绪的识别。从这些方法中，最可行、最有效的获取情感的物理特征是人脸。虽然人类可以毫不费力地理解情感，但计算机需要像FER(面部表情识别)这样的技术。</p><p id="7331" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自然语言处理中基于模式的识别是人脸识别和情感识别的基础。采集、预处理、特征提取和情感分类是FER的主要阶段。从输入图像中识别面部区域，并且在检测图像中的面部之后检测像鼻子、眼睛和嘴这样的标志。然后提取特征并分类以识别情感。</p><h2 id="5919" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jb ke kf kg jf kh ki kj jj kk kl km kn bi translated">FER的主要阶段</h2><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es la"><img src="../Images/e286899ca5ab36d596b9babef7b37cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*iWypJFrrdO5Ij_x1Wt3bpg.png"/></div></figure><p id="f4f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">采集</strong></p><p id="1a30" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用人脸定位过程来确定图像中的人脸。图像的位置和大小也通过使用人脸定位来捕捉。换句话说，就是划定脸部区域的过程。根据区别特征的使用，策略的分类被用于本地化。面部边缘用于整个面部限定。此外，人脸纹理的细节也用于定位。皮肤肤色具有独特的特征，并且肤色的信息经常用于定位，因为它在颜色空间中是独立突出的。</p><p id="1810" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">预处理</strong></p><p id="acda" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">预处理的目的是为下一步处理增强图像的特征，并抑制不利的失真。预处理的主要阶段包括读取图像、图像大小的归一化、去除噪声(去噪)、分割和形态学(平滑边缘)。</p><p id="98f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">提取</strong></p><p id="e872" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特征提取是从图像中捕获关键数据，如向量、符号和值。特征提取技术取决于应用环境和分类方法。局部二值模式(LBP)、Gabor特征提取、Haar-like特征提取、特征点跟踪和光流法等。当选择适当的特征提取方法时，需要考虑应用特定方法的适用性和可行性，因为这可能直接控制算法的性能，而算法的性能是FER应用的瓶颈。</p><p id="80b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">分类</strong></p><p id="7f39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">进行分类以识别图像的面部表情。选择合适的分类器对FER系统捕捉情感的准确性有重要影响。支持向量机(SVM)、贝叶斯、k近邻(kNN)、概率神经网络(PNN)和基于稀疏表示的分类器(SRC)是FER应用中广泛使用的一些分类器。与其他深度学习方法相比，FER方法相对较少依赖于硬件和数据，但是特征提取和分类不能同时优化。因此，需要将它们分开设计。FER结果的准确性，取决于每个阶段的性能和准确性。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="e272" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所述，SA和FER方法可以用于识别与系统交互的用户的情绪，以便在像情绪感知深度学习模型这样的AI模型中更好地创建响应。这些方法仍然存在限制和不确定性。处理时间是不被评估的，它在FER是非常重要的。情绪可能急剧变化，并且如果FER技术花费更多的处理时间，则呈现的结果不是实时的，并且可能被认为是低准确度的结果。</p><p id="4824" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，SA只为英语开发，重要的是在其他母语上也有SA，以表明机器具有情感智能。此外，在多语言阶段捕获情感的技术尚未开发，这些是研究空白，使得计算机人类对话交互限于英语和单语。</p></div></div>    
</body>
</html>
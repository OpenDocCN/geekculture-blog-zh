<html>
<head>
<title>How to handle javascript promise in various scenario</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在各种场景中处理javascript承诺</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-handle-javascript-promise-in-various-scenario-3e47959fe80a?source=collection_archive---------44-----------------------#2021-05-30">https://medium.com/geekculture/how-to-handle-javascript-promise-in-various-scenario-3e47959fe80a?source=collection_archive---------44-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c887" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jd" href="http://cybertrons.in/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">虚拟赛伯龙私人有限公司</strong> </a> <strong class="ih hj">做项目的时候。</strong>，我在处理javascript场景时遇到了困难，它要求代码以同步方式执行，并为此使用承诺。</p><p id="00be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为没有合适的解决方法，所以我决定自己做。我将逐一讨论这些场景。</p><p id="02db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从场景1 开始，在这个场景中，我们必须不止一次地调用一个函数(不返回任何东西)，以同步的方式一个接一个地调用。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code snippet with problem for scenario 1</figcaption></figure><p id="a4df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预期输出:<br/></strong>102与308之和:<br/>410<br/>-1与38之和:<br/> 37</p><p id="5ba0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际输出:<br/></strong>102和308之和:<br/>-1和38之和:<br/> 410 <br/> 37</p><p id="7ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际输出与预期不同，因为代码以异步方式执行。上面的代码可以用Promise解决。下面是处理它的正确代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code Snippet with solution for scenario 1</figcaption></figure><p id="47f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们转到第二个场景，在这个场景中，我们必须不止一次地调用一个函数(返回一些东西)，以同步的方式一个接一个地调用。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code Snippet with problem to be resolved</figcaption></figure><p id="0d52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预期输出:</strong><br/>102和308之和:410<br/>1和38之和:37</p><p id="63f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际输出:</strong><br/>102和308之和:未定义<br/>-1和38之和:未定义</p><p id="f5a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，实际输出与预期不同，因为代码以异步方式执行。上面的代码可以用Promise解决。下面是处理它的正确代码。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code Snippet with solution for scenario 2</figcaption></figure><p id="77e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然在上面讨论的两个场景中，我们已经实现了我们想要的工作，但是随着代码复杂性的增加，代码的可读性降低，代码可能变得难以理解。所以为了让代码易于理解，我们可以使用async-await。</p><p id="1392" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在使用async-await解决上述场景之前，理解async-await实际上是如何工作的很重要。</p><p id="0376" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">下面是理解异步等待工作的例子。</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code snippet with misconception</figcaption></figure><p id="444b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预期输出:</strong> <br/>调用someFunction <br/>在someFunction完全执行后，使用参数:10 <br/>调用了someFunction</p><p id="db2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实际输出:</strong></p><p id="625d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正确的做法如下:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Code Snippet with correct way to use async-await</figcaption></figure><p id="ec7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用异步等待的场景1的解决方案代码:</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div></figure><p id="a4a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用异步等待的场景2的解决方案代码:</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jj jk l"/></div></figure><p id="6975" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>:在最后一个代码片段中，调用resolve时作为参数传递的内容被分配给sum1(或下一个调用中的sum2)。</p><p id="54e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于在async-await中处理拒绝的更多场景和解决方案将在文章<a class="ae jd" href="https://yashgovindani.medium.com/how-to-handle-javascript-promise-rejection-in-case-of-async-await-5c9902b50970" rel="noopener">‘如何在async-await中处理javascript promise拒绝’</a>中讨论。<br/>谢谢你。</p></div></div>    
</body>
</html>
<html>
<head>
<title>ExpressJS and Back-end Middleware that you should know about…</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该知道的ExpressJS和后端中间件…</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/expressjs-and-back-end-middleware-that-you-should-know-about-a48b6c9298de?source=collection_archive---------37-----------------------#2021-06-08">https://medium.com/geekculture/expressjs-and-back-end-middleware-that-you-should-know-about-a48b6c9298de?source=collection_archive---------37-----------------------#2021-06-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e3b98d985f7886ac0e1c28e9b9d3b05c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jZk6HDkgCOnZMUD2"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@ianjbattaglia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ian Battaglia</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7417" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于我们这些学习后端的人来说，开始时事情可能没有太多意义，结构与我们在前端学到的完全不同，现在我们与服务器而不是客户端进行通信。</p><p id="d532" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Node中的结构非常简单，您在一开始就导入项目需要的所有包和不同的资源，然后是中间件，这是您想要注入代码的软件，然后是您想要设置的路线。我们还需要记住listen()函数，这对于初始化端口并从中获得反馈是至关重要的。</p><p id="a452" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本指南中，我们将重点关注后端的中间件方面，因为一旦我们学习了Node的基础知识，并希望继续学习更复杂的框架，为我们提供更多像ExpressJs这样的选项，这是必不可少的。</p><p id="56c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，让我们仔细看看什么是中间件，它被定义为“除了操作系统提供的服务之外，为软件应用程序提供服务的计算机软件”，或者换句话说，中间件是一个可以访问请求和响应对象及其周期的软件，因此，它可以执行任何代码，对请求和响应对象进行更改，结束请求-响应周期，并调用堆栈中的下一个中间件。</p><p id="a4b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以用一行简单的代码导入ExpressJs:</p><blockquote class="jt ju jv"><p id="44b9" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">var express = require(' express ')；</p></blockquote><p id="641f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后初始化它:</p><blockquote class="jt ju jv"><p id="f00b" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">const app = express()；</p></blockquote><p id="1a56" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这样，Express就设置好了，并准备好在我们的应用程序中运行，我们现在可以利用它的资源丰富的中间件，最常用的是app.use()函数，它用于在指定的路径上安装指定的中间件函数。它主要用于为您的应用程序设置中间件。</p><p id="debe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">举例来说，我们需要使用一个中间件函数来记录被调用时的响应方法，然后我们需要将该中间件函数包装在app.use()函数中，如下所示:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="be0c" class="kj kk hi kf b fi kl km l kn ko">app.use('/print', function (req, res, next) {<br/>  console.log(res.method);<br/>  next();<br/>})</span></pre><p id="a1bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重要的是在方法的末尾注明方法next()的使用，因为函数跳转到下一个中间件是必不可少的，如果没有这个方法，只有第一个中间件函数会运行，其余的路由会被阻塞。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/a43bc53eb584f9b3b46db9a83093a67b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*ju6ROz0qPEmplrztubTIlA.png"/></div></figure><p id="194e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经学会了如何设置express，让我们来看看允许我们在服务器上设置路线的不同中间件，由于express及其HTTP函数，我们可以仅使用中间件轻松创建CRUD(创建、读取、更新、删除)应用程序:</p><p id="b654" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">app.get()将帮助使用从服务器读取get响应。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="e37e" class="kj kk hi kf b fi kl km l kn ko">app.get('/', function (req, res) {<br/>  res.send('GET request to the homepage')<br/>})</span></pre><p id="1a3a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">app.post()将用于创建一个新对象并将其添加到数据库中。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="33cf" class="kj kk hi kf b fi kl km l kn ko">app.post('/', function (req, res) {<br/>  res.send('POST request to the homepage')<br/>})</span></pre><p id="c441" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">app.put()是用于更新现有对象数据的方法。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="a0f1" class="kj kk hi kf b fi kl km l kn ko">app.put('/user', function (req, res) {<br/>  res.send('Got a PUT request at /user')<br/>})</span></pre><p id="d55c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">app.delete()用于从数据库中移除现有对象。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="9dbc" class="kj kk hi kf b fi kl km l kn ko">app.delete('/user', function (req, res) {<br/>  res.send('Got a DELETE request at /user')<br/>})</span></pre><p id="5acd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如在前面的例子中看到的，我们的路由可以有不同的处理函数，甚至在同一条路由上。这就是路由作为Express的一个资源丰富的工具发挥作用的地方，路由指的是应用程序的端点(URIs)如何响应客户端请求。</p><p id="9361" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一种更有效、更简洁的处理路线的方式是使用<em class="jw">路由器，在express中使用</em>，这可以通过以下代码简单地设置:</p><blockquote class="jt ju jv"><p id="7d69" class="iv iw jw ix b iy iz ja jb jc jd je jf jx jh ji jj jy jl jm jn jz jp jq jr js hb bi translated">常量路由器= express。路由器()；</p></blockquote><p id="5eb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个工具允许我们为单个路由设置可链接的路由处理程序，路由器作为一个模块，在其中加载一个中间件功能，定义一些路由，并将路由器模块挂载到主app中的一个路径上。需要注意的是，主应用程序中的路由必须在语法上用app代替router。</p><p id="094b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以在下面的例子中看到这是如何工作的(假设这是route.js):</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="bc84" class="kj kk hi kf b fi kl km l kn ko">// middleware that is specific to this router<br/>router.use(function timeLog (req, res, next) {<br/>  console.log('Time: ', Date.now())<br/>  next()<br/>})<br/>// define the home page route<br/>router.get('/', function (req, res) {<br/>  res.send('home page')<br/>})<br/>// define the about route<br/>router.get('/about', function (req, res) {<br/>  res.send('About Us')<br/>})<br/><br/>module.exports = router</span></pre><p id="76d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们看看这条路线在app.js上的样子:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="59ad" class="kj kk hi kf b fi kl km l kn ko">var routes = require('./routes.js')<br/><br/>// ...<br/><br/>app.use('/routes', routes)</span></pre><p id="02d3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此处路由器的功能是让我们以更有组织的方式访问'/routes '的路由处理程序，例如'/routes/'和'/routes/about '，只需使用导入/导出工具并使用app.use()安装此中间件。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/e657b16c35bbe6c6573e0ca2b16029a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JT7ArJrlDbQ40IK5"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@blueskin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Terry</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f15a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些概念可以更深入地扩展，但是我希望这篇文章能够帮助您基本理解后端是如何工作的，以及expressJS如何成为NodeJS的必要补充，以便通过使用中间件软件来提高代码效率和功能。和所有事情一样，你测试和实现这些想法越多，你就能更好地理解它们，所以不要害怕钻研它们，慢慢地但肯定地事情会变得有意义。</p><p id="94d9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下一篇文章再见。编码快乐！</p></div></div>    
</body>
</html>
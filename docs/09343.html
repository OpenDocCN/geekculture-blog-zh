<html>
<head>
<title>Javascript 101: Web workers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Javascript 101:网络工作者</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/javascript-101-web-workers-1c70bcb4ba90?source=collection_archive---------12-----------------------#2021-12-06">https://medium.com/geekculture/javascript-101-web-workers-1c70bcb4ba90?source=collection_archive---------12-----------------------#2021-12-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b0e1b276710df6ff42ef59e9b205a855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-O8v_7CkKtvce79ClyRJTg.png"/></div></div></figure><p id="9f6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Javascript是单线程语言，这意味着它一次只能处理一个任务。为了处理多任务，Javascript在任务之间切换，就像单核机器通过一个称为并发性的概念来处理一样——虚拟并行性。</p><p id="a8eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种模式虽然对于非阻塞任务来说是安全的，但对于大量资源需求的程序(例如客户端上的音频压缩和声音转换)来说却是一场噩梦，这些程序大多数时候需要同时运行(<strong class="is hj">并行</strong>)，而不仅仅是与主应用程序有重叠的时间段(<strong class="is hj">并发</strong>)。这就是网络工作者的用武之地。</p><h1 id="42cc" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">什么是网络工作者？</h1><blockquote class="km kn ko"><p id="ed4a" class="iq ir kp is b it iu iv iw ix iy iz ja kq jc jd je kr jg jh ji ks jk jl jm jn hb bi translated">Web Worker是浏览器(也称为主机环境)的一个特性，它提供了Javascript引擎的多个实例，允许我们在不同的线程中运行不同的程序。</p></blockquote><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/432955bbfd9df7dd51fc952663236f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mh4BvzNU9EminMNHYDQ_GQ.png"/></div></div></figure><p id="2727" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">web worker可以如上所示进行初始化，浏览器将启动一个单独的线程，让worker文件作为一个独立的程序运行。这种类型的并行性被称为“任务并行性”，因为它强调的是将程序的各个部分分开来并行运行。</p><blockquote class="km kn ko"><p id="5123" class="iq ir kp is b it iu iv iw ix iy iz ja kq jc jd je kr jg jh ji ks jk jl jm jn hb bi translated">注意——JavaScript仍然不支持多线程执行。但是通过浏览器，网络工作者让我们有能力。</p></blockquote><h1 id="b4a0" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">工人环境</strong></h1><p id="cff6" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">Worker无权访问页面的DOM，但拥有navigator、location、JSON和applicationCache变量的副本，并且可以执行网络操作(Ajax、Websockets)和设置计时器操作。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/68db3a8efad9c37d0256b96387ce1565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*MpZ5bSVCf8khjl1azHpx8w.png"/></div></figure><p id="df85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> w1 </strong> Worker对象是一个事件监听器和触发器，它允许您订阅由Worker发送的事件以及向Worker发送事件，如上所示；</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div class="er es le"><img src="../Images/43f19f088579b4f40afb7577764a6b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*6PQRyKXwqa-Q6GF8Z1pKdA.png"/></div></figure><p id="24e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同时，在上面的worker文件中，我们监听消息事件，并从事件参数的data属性访问传输的有效负载。我们看到的所有片段的组合将创建一个专用的worker文件，该文件将在5000毫秒后输出<em class="kp">“完成的严肃计算”</em>，此时主应用程序可以执行其他活动，而不会阻塞其单线程。</p><p id="e62a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个web workers的例子虽然不够实用，但却描绘了其他较重的进程如何最好地在浏览器上处理的图像；处理密集的数学计算、分类大型数据集、数据操作(压缩、音频分析、图像像素操作等)。)</p><h1 id="f3c4" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">共享工人</h1><p id="1377" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">随着浏览器选项卡间共享资源需求的增长，让一个工作人员专门负责主应用程序变得有些笨拙。为同一应用程序的每个浏览器实例重新创建它们的想法似乎是多余的。这就是共享工作者的用武之地。</p><blockquote class="km kn ko"><p id="e529" class="iq ir kp is b it iu iv iw ix iy iz ja kq jc jd je kr jg jh ji ks jk jl jm jn hb bi translated">共享工作器是一种可以从多个浏览上下文访问的工作器:窗口、iframes或其他工作器</p></blockquote><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/340a44f0ac1e10d5e07cf23b7c63c770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyIE-KLOwm1zQQRBRA-1aQ.png"/></div></div></figure><p id="d61e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为共享工作器可以连接到或来自站点上的多个程序实例或页面，所以工作器需要一种方法来知道消息来自哪个程序。这个唯一的标识被称为“端口”——想想网络套接字端口。所以调用程序必须使用Worker的端口对象进行通信。</p><figure class="ku kv kw kx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/b5534a70601a301da6a6a90e9507c2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kY2nAbsKKWfE-bH7iHKHQ.png"/></div></div></figure><p id="e139" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在共享工作者内部，必须处理一个额外的事件:“连接”。此事件为该特定连接提供端口对象。除了这些细微差别之外，共享和专用工人实际上有相同的实现。</p><h1 id="d2d8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="e785" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">Web workers是一项令人兴奋的技术，如果使用得当，它可以在浏览器中提供javascript的多线程感觉。它在网页之外的灵活性为可以作为服务执行的特性(推送通知、后台同步等)打开了大门，并且大多数时候不需要用户交互。</p><p id="9b1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一站— <a class="ae lh" href="https://caleb-codes.medium.com/javascript-101-events-9c90fb7e2dce" rel="noopener">事件</a></p><h1 id="cd28" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">参考</h1><ul class=""><li id="902c" class="li lj hi is b it ky ix kz jb lk jf ll jj lm jn ln lo lp lq bi translated"><a class="ae lh" href="https://www.amazon.ca/You-Dont-Know-JS-Performance/dp/1491904224" rel="noopener ugc nofollow" target="_blank">你不知道的JS: Async &amp;性能</a></li></ul></div></div>    
</body>
</html>
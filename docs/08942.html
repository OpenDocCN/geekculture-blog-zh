<html>
<head>
<title>How I built Advanced SDN PoC Designer with mxGraph &amp; VueJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何使用mxGraph &amp; VueJS构建高级SDN概念验证设计器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-i-built-advanced-sdn-poc-designer-with-mxgraph-vuejs-887cbc40bbbf?source=collection_archive---------15-----------------------#2021-11-20">https://medium.com/geekculture/how-i-built-advanced-sdn-poc-designer-with-mxgraph-vuejs-887cbc40bbbf?source=collection_archive---------15-----------------------#2021-11-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/021b455485be00f401a91b54f8fc9640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18AGxjX00NSRes1KDuw-Xw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd iu">SDN PoC Designer (Attribution GreekMythology.com)</strong></figcaption></figure><p id="123e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是我在危险的网络可视化世界中的第三篇后续文章，这是又一次带有刺激味道的不懈研究。如果你从未听说过<a class="ae jt" href="https://jgraph.github.io/mxgraph/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">mxGraph</strong></a>——那么它已经过时了，被千年行话埋没了。</p><p id="236a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">衍生自<a class="ae jt" href="https://github.com/jgraph" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj"><em class="ju">JGraph</em></strong></a>(Java)<a class="ae jt" href="https://github.com/jgraph/mxgraph" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj"><em class="ju">mxGraph</em></strong></a>基于JavaScript，其大部分代码库的灵感来源于<strong class="ix hj"> <em class="ju"> JGraph </em> </strong>。从血统的角度来看，它大约开始于2005年末，并在2020年后停产，正如Github注释所述:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="6a64" class="ke kf hi ka b fi kg kh l ki kj">NOTE 09.11.2020 : Development on mxGraph has now stopped, this repo is effectively end of life.</span></pre><p id="bd54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你仍然可以在<a class="ae jt" href="https://github.com/jgraph" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> JGraph </strong> </a> aka中找到它。<a class="ae jt" href="https://www.diagrams.net/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">Diagrams.net</strong></a>，在桌面和web上都可以用。这个库的一个有趣的部分是它的基于XML的文件格式，它可以完美地处理2005年创建的图表文件。</p><h1 id="d23a" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">mxGraph是什么？🤨</h1><p id="ed6e" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">简而言之，它是一个JavaScript开发人员库，旨在提供即插即用组件来绘制、移动上下文图或具有属性的图形元素，并与之交互。它是用纯JavaScript编写的，没有转换程序或NPM依赖。一个普通的mxGraph编辑器看起来像:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/e760e9857ebc1cf98e285113f3e1554b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30fO1PMxO8AN5XebjPu0tQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae jt" href="https://jgraph.github.io/mxgraph/javascript/examples/grapheditor/www/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="bd iu">mxGrpah Editor</strong></a></figcaption></figure><p id="abab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最左边是一个模板(形状)库或可以放置、交互和连接的节点对象，中间是一个画图画布，最右边是画图画布或选定节点对象的属性面板。布局画布上放置和连接的节点被渲染为SVG，但在后台以<strong class="ix hj"> <em class="ju"> XML </em> </strong>文件格式粘合。</p><h1 id="119f" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">了解mxGraph库结构🧐</h1><p id="2a3a" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在迈出一大步之前，了解这个库的确切结构是至关重要的。画布编辑器、模板(形状)库、交互、输入/输出(IO)、实用程序的几个目录和文件，以及它们在画布上的显示方式。总结一下<code class="du lm ln lo ka b">tree</code>输出:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="2d39" class="ke kf hi ka b fi kg kh l ki kj">.<br/>├── editor<br/>├── handler<br/>├── io<br/>├── layout<br/>├── model<br/>├── shape<br/>├── util<br/>├── view<br/>└── <strong class="ka hj">mxClient.js</strong></span><span id="c11e" class="ke kf hi ka b fi lp kh l ki kj">11 directories, 143 files</span></pre><p id="569d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="ju"> mxGraph </em> </strong>的初始化由<code class="du lm ln lo ka b">mxClient.js</code>文件完成，该文件包括所有需要的工厂设置、模板(形状)、交互、事件监听器、菜单项、工具栏和布局画布。通过搜索数百个文件，我对这个架构有了更深入的了解。大量组件基于JavaScript原型对象<em class="ju">，可以被继承或覆盖</em>。外观上的改变很大程度上取决于如何在不影响核心的情况下覆盖。</p><h1 id="e763" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">mxGraph与VueJS🤦🏻</h1><p id="d6f1" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">当读到PoC设计者的需求时,“脸谱化”非常符合我的第一反应。客户端运行一个Python (Django)应用程序，用于管理/供应通过供应商、网络和云对象注册表维护的集群。整个工作流程可以浓缩在下图中(用diagram.io制作)</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/1915faf9efeaa9404339d3d7eb07682b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDoO6PVw3pG-eEQlOwuF8g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd iu">SDN PoC Designer Workflow</strong></figcaption></figure><p id="c14b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然PoC designer充当可视化SDN构建器工具，但它仍然需要使用节点对象(模板)、它们的默认属性以及在Python API (JSON)中提供、暂停、终止和冻结实例的集群操作。一旦集群设计准备好了持久属性和可以是动态的连接器，就可以使用另一个Python API以XML格式(base64编码)保存模板。</p><p id="a46c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一系列<em class="ju">艰巨的工作</em>摆在面前——为具有持久性的属性创建动态控件、事件绑定、流畅的知识传递和可持续的代码库只是其中的一部分。<strong class="ix hj"> <em class="ju"> VueJS </em> </strong>在可读代码、即插即用架构、会话持久性(通过模型进行数据绑定)等方面实现了正确的对称——没有捆绑器依赖性。</p><h1 id="ee13" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">解耦MX graph——第一次艰难的劳动💪🏻</h1><p id="e5fc" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">分而治之！演绎的科学不可能出错，检验这个假设。在上帝模式下工作🤞🏻我决定先解耦<strong class="ix hj"> <em class="ju"> mxGraph </em> </strong>布局。用小心的切口把它分开，把它分解成布局画布。切口位于<code class="du lm ln lo ka b">EditorUI.js</code>和<code class="du lm ln lo ka b">Editor.js</code>文件中(还有更多):</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="77bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注释去掉了菜单、工具栏和侧边栏。在这里，如何包含、初始化和覆盖是最重要的。我的包含层次结构如下所示:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="11d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意第97行和第98行，这差不多做到了😊。随后的步骤变得更加清晰，我所要做的就是在<code class="du lm ln lo ka b">mxClient.js</code>之后覆盖和包含文件，最多只是克隆和/或修改它们以进行翻新。</p><blockquote class="lt lu lv"><p id="5e1e" class="iv iw ju ix b iy iz ja jb jc jd je jf lw jh ji jj lx jl jm jn ly jp jq jr js hb bi translated">专业建议:不要篡改原唱，即使是80-90年代的歌曲！</p></blockquote><p id="e497" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">说这是一种黑客，但正确的是有效的。后来使用<strong class="ix hj"> <em class="ju"> VueJS </em> </strong> <code class="du lm ln lo ka b">x-template</code>语法糖为<strong class="ix hj">模板</strong>和<strong class="ix hj">属性</strong>引入了微小的添加。多控件组件模板:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="9a7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这给了我用基于模板的语法构建动态属性的能力，而且它允许用Python API (JSON)进行动态绑定:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/72a8d54fa9e04f7689eea7663d2e5e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*Xw1ETfedkCa2hXkjvrGejg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd iu">SDN NAT Rules</strong></figcaption></figure><p id="0c10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我能够用Python API拼凑整个模板(形状)库、动态节点/连接器属性。默认模具库和节点/连接器对象属性需要预先初始化:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h1 id="1028" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">用VueJS改装mxGraph第二项艰巨的工作💪🏻</h1><p id="2d64" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">既然所有的细节都准备好了，是时候铺开红地毯了。mxGraph编辑器的大多数部分需要修饰性的更改(自定义模板和属性侧栏面板),这意味着:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="fb39" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在GIS领域中，非空间属性指的是扩展的地理位置数据，相同的自定义属性保存在一个<code class="du lm ln lo ka b">&lt;CustomData&gt;</code> XML标记中(作为JSON)，这是<strong class="ix hj"> <em class="ju"> mxGraph </em> </strong>的一个简洁特性。图形源XML看起来像这样:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/281209a910bf29130d29d8a04a80a5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjmkXpIRhOBTAloUAClLjA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd iu">SDN Diagram XML Source</strong></figcaption></figure><p id="3251" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个<code class="du lm ln lo ka b">&lt;CustomData&gt;</code>也用于VueJS模型绑定。XML和JSON对象之间的转换是通过编解码器进行的。<code class="du lm ln lo ka b">CustomData(value)</code>编解码器的定义:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="db66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你点击一个节点对象/连接器时，它通过codec被解析，返回<strong class="ix hj"> <em class="ju"> VueJS </em> </strong>模型的所有属性绑定对象。属性绑定部分在<code class="du lm ln lo ka b">Properties.js</code>文件中定义为:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h1 id="dac0" class="kk kf hi bd iu kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">综上所述——第三项艰巨的劳动💪🏻</h1><p id="f1bf" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">很多建筑学的想法都发挥了作用——这不是软球、曲线球或硬球，这是一个接一个的Atlas石头，只有强壮的人才能生存。将一个普通的图组件库变成一个成熟的<strong class="ix hj"> <em class="ju"> SDN PoC设计师</em> </strong>将午夜马拉松带到了最后的前沿:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/40b11a8a4c213c7681c1208c6c1ad857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGuQToieYOoKL7TvQbu19Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><strong class="bd iu">SDN PoC Designer</strong></figcaption></figure><p id="54ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">三个月的不懈追求，很少有管理火花与伤亡——是的，我已经学会低调😉。只要客户高兴，我可以接受。无论如何，这一直是我的开发者之旅。</p></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><h1 id="8832" class="kk kf hi bd iu kl mi kn ko kp mj kr ks kt mk kv kw kx ml kz la lb mm ld le lf bi translated">参考</h1><ul class=""><li id="4922" class="mn mo hi ix b iy lg jc lh jg mp jk mq jo mr js ms mt mu mv bi translated"><a class="ae jt" href="https://github.com/jgraph" rel="noopener ugc nofollow" target="_blank">https://github.com/jgraph</a></li><li id="8142" class="mn mo hi ix b iy mw jc mx jg my jk mz jo na js ms mt mu mv bi translated"><a class="ae jt" href="https://www.diagrams.net/" rel="noopener ugc nofollow" target="_blank">https://www.diagrams.net</a></li><li id="a8ab" class="mn mo hi ix b iy mw jc mx jg my jk mz jo na js ms mt mu mv bi translated"><a class="ae jt" href="https://github.com/jgraph/mxgraph" rel="noopener ugc nofollow" target="_blank">https://github.com/jgraph/mxgraph</a></li><li id="15e1" class="mn mo hi ix b iy mw jc mx jg my jk mz jo na js ms mt mu mv bi translated"><a class="ae jt" href="https://jgraph.github.io/mxgraph/javascript/examples/grapheditor/www/index.html" rel="noopener ugc nofollow" target="_blank">https://jgraph . github . io/mxgraph/JavaScript/examples/graphe editor/www/index . html</a></li><li id="c2d2" class="mn mo hi ix b iy mw jc mx jg my jk mz jo na js ms mt mu mv bi translated"><a class="ae jt" href="https://jgraph.github.io/mxgraph/docs/js-api/files/index-txt.html" rel="noopener ugc nofollow" target="_blank">https://jgraph . github . io/MX graph/docs/js-API/files/index-txt . html</a></li><li id="e6f5" class="mn mo hi ix b iy mw jc mx jg my jk mz jo na js ms mt mu mv bi translated"><a class="ae jt" href="https://www.greekmythology.com/Myths/Heroes/Heracles/heracles.html" rel="noopener ugc nofollow" target="_blank">https://www . Greek mythology . com/Myths/Heroes/赫拉克剌斯/heracles.html </a></li></ul><p id="66d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如需在线直播演示，请联系:<a class="ae jt" href="mailto:anithegregorian@gmail.com" rel="noopener ugc nofollow" target="_blank">anithegregorian@gmail.com</a></p></div></div>    
</body>
</html>
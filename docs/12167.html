<html>
<head>
<title>Scrape Google Scholar Papers within a particular conference in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python在一个特定的会议上收集谷歌学术的论文</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/scrape-google-scholar-papers-within-a-particular-conference-in-python-1eef3318dc16?source=collection_archive---------12-----------------------#2022-04-29">https://medium.com/geekculture/scrape-google-scholar-papers-within-a-particular-conference-in-python-1eef3318dc16?source=collection_archive---------12-----------------------#2022-04-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/371f52c40eda7aa6e2ad42c36f00cf83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oa4AvIg7-KlaabXCjS69_g.jpeg"/></div></div></figure><div class=""/><h1 id="7a65" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">会刮什么</h1><figure class="jp jq jr js fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es jo"><img src="../Images/1b90da0781e3079a84f1eee7bee07bab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F7rwZuhAD6xOQTWM.png"/></div></div></figure><h1 id="ab54" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><p id="2705" class="pw-post-body-paragraph jt ju ht jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hu">CSS选择器基础知识抓取</strong></p><p id="38d4" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">CSS选择器声明样式应用于标记的哪一部分，从而允许从匹配的标签和属性中提取数据。</p><p id="39b9" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你没有使用过CSS选择器，我有一篇专门的博文是关于<a class="ae kw" href="https://serpapi.com/blog/web-scraping-with-css-selectors-using-python/" rel="noopener ugc nofollow" target="_blank">如何在抓取网页时使用CSS选择器</a>的，它涵盖了什么是CSS选择器，优点和缺点，以及为什么从抓取网页的角度来看它们很重要，并展示了抓取网页时使用CSS选择器的最常见的方法。</p><p id="3d33" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hu">单独的虚拟环境，如果它将是一个项目</strong></p><p id="4f3e" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">简而言之，它创建了一组独立的已安装库，包括不同的Python版本，这些版本可以在同一系统中共存，从而防止库或Python版本冲突。</p><p id="b093" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你以前没有使用过虚拟环境，可以看看我的博客文章《使用Virtualenv和poeties》中专门的<a class="ae kw" href="https://serpapi.com/blog/python-virtual-environments-using-virtualenv-and-poetry/" rel="noopener ugc nofollow" target="_blank"> Python虚拟环境教程来熟悉一下。</a></p><p id="5527" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">📌注意:这不是这篇博文的严格要求。</p><p id="0c14" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hu">安装库:</strong></p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="8180" class="lc ir ht ky b fi ld le l lf lg">pip install requests parsel google-search-results</span></pre><p id="e5b6" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated"><strong class="jv hu">减少被封的几率</strong></p><p id="1bc4" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">请求有可能被阻止。看看<a class="ae kw" href="https://serpapi.com/blog/how-to-reduce-chance-of-being-blocked-while-web/" rel="noopener ugc nofollow" target="_blank">如何降低抓取网页时被屏蔽的几率</a>，有11种方法可以绕过大多数网站的屏蔽。</p><h1 id="7d60" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">过滤的工作原理</h1><p id="7ea8" class="pw-post-body-paragraph jt ju ht jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">要过滤结果，您需要使用source: operator，它将搜索结果限制在名称中包含“NIPS”的源发布的文档中。</p><p id="2492" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">该操作符可与or操作符一起使用，即<em class="lh">源:NIPS或源:“神经信息”</em>。因此，搜索查询将变成:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="8ebe" class="lc ir ht ky b fi ld le l lf lg">search terms source:NIPS OR source:"Neural Information"</span></pre><h1 id="f782" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">完整代码</h1><figure class="jp jq jr js fd hk"><div class="bz dy l di"><div class="li lj l"/></div></figure><h1 id="607c" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">代码解释</h1><p id="c93a" class="pw-post-body-paragraph jt ju ht jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">添加一个接受<code class="du lk ll lm ky b">str</code>的<code class="du lk ll lm ky b">list</code>或<code class="du lk ll lm ky b">str</code>的函数，如果它是一个<code class="du lk ll lm ky b">list</code>则转换它:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="bd5f" class="lc ir ht ky b fi ld le l lf lg">def check_sources(source: list or str):<br/>    if isinstance(source, str):<br/>        return source <br/>    elif isinstance(source, list):<br/>        return " OR ".join([f'source:{item}' for item in source])</span></pre><p id="46ae" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">定义一个解析函数:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="5b5d" class="lc ir ht ky b fi ld le l lf lg">def scrape_conference_publications(query: str, source: list[str]):<br/>    # further code...</span></pre><ul class=""><li id="62ea" class="ln lo ht jv b jw kr ka ks ke lp ki lq km lr kq ls lt lu lv bi translated"><code class="du lk ll lm ky b">query: str</code> —告诉Python<code class="du lk ll lm ky b">query</code>参数应该是<code class="du lk ll lm ky b">string</code>。</li><li id="97f9" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated"><code class="du lk ll lm ky b">source: list or str</code> —告诉Python<code class="du lk ll lm ky b">source</code>参数应该是<code class="du lk ll lm ky b">list</code>或<code class="du lk ll lm ky b">string</code>。</li></ul><p id="0594" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">检查源是否可用，并转换收到的源参数:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="d99f" class="lc ir ht ky b fi ld le l lf lg">if source:<br/>    # iterates via list comprehension over recieved list of sources (strings)<br/>    # and joins() them with " OR "<br/>    sources = " OR ".join([f'source:{item}' for item in source]) <br/>    <br/># becomes: source:NIPS OR source:Neural Information, which can be used in a search query</span></pre><p id="2b64" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">创建URL参数、用户代理并将它们传递给请求:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="717c" class="lc ir ht ky b fi ld le l lf lg"># <a class="ae kw" href="https://docs.python-requests.org/en/master/user/quickstart/#passing-parameters-in-urls" rel="noopener ugc nofollow" target="_blank">https://docs.python-requests.org/en/master/user/quickstart/#passing-parameters-in-urls</a><br/>params = {<br/>    "q": f'{query.lower()} {sources}',  # search query<br/>    "hl": "en",                         # language of the search<br/>    "gl": "us"                          # country of the search<br/>}</span><span id="66ed" class="lc ir ht ky b fi mb le l lf lg"># <a class="ae kw" href="https://docs.python-requests.org/en/master/user/quickstart/#custom-headers" rel="noopener ugc nofollow" target="_blank">https://docs.python-requests.org/en/master/user/quickstart/#custom-headers</a><br/>headers = {<br/>    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36"<br/>}</span><span id="0e8f" class="lc ir ht ky b fi mb le l lf lg">html = requests.get("https://scholar.google.com/scholar", params=params, headers=headers, timeout=30)<br/>selector = Selector(html.text)</span></pre><ul class=""><li id="9981" class="ln lo ht jv b jw kr ka ks ke lp ki lq km lr kq ls lt lu lv bi translated"><a class="ae kw" href="https://docs.python-requests.org/en/master/user/quickstart/#timeouts" rel="noopener ugc nofollow" target="_blank">超时</a> —告诉请求在30秒后停止等待响应。</li><li id="f9d3" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated">选择器—是一个解析数据的HTML/XML处理器。喜欢<a class="ae kw" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup() </a>。</li><li id="3d6b" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated"><a class="ae kw" href="https://developer.mozilla.org/en-US/docs/Glossary/User_agent" rel="noopener ugc nofollow" target="_blank">用户代理</a>——用于充当“真实”的用户访问。默认请求用户代理是一个python-requests 所以网站知道它是一个发送请求的脚本，可能会阻止它。<a class="ae kw" href="https://www.whatismybrowser.com/detect/what-is-my-user-agent" rel="noopener ugc nofollow" target="_blank">检查你的用户代理</a>。</li></ul><p id="8a52" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">创建一个临时列表来存储数据，并迭代有机结果:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="7c81" class="lc ir ht ky b fi ld le l lf lg">publications = []<br/>        <br/>for result in selector.css(".gs_r.gs_scl"):<br/>    title = result.css(".gs_rt").xpath("normalize-space()").get()<br/>    link = result.css(".gs_rt a::attr(href)").get()<br/>    result_id = result.attrib["data-cid"]<br/>    snippet = result.css(".gs_rs::text").get()<br/>    publication_info = result.css(".gs_a").xpath("normalize-space()").get()<br/>    cite_by_link = f'https://scholar.google.com/scholar{result.css(".gs_or_btn.gs_nph+ a::attr(href)").get()}'<br/>    all_versions_link = f'https://scholar.google.com/scholar{result.css("a~ a+ .gs_nph::attr(href)").get()}'<br/>    related_articles_link = f'https://scholar.google.com/scholar{result.css("a:nth-child(4)::attr(href)").get()}'<br/>    pdf_file_title = result.css(".gs_or_ggsm a").xpath("normalize-space()").get()<br/>    pdf_file_link = result.css(".gs_or_ggsm a::attr(href)").get()</span></pre><ul class=""><li id="3e62" class="ln lo ht jv b jw kr ka ks ke lp ki lq km lr kq ls lt lu lv bi translated">css( <selector> ) — <a class="ae kw" href="https://github.com/scrapy/parsel/blob/90397dcd0b2c1cbb91e44f65c50f9e11628ba028/parsel/selector.py#L351-L362" rel="noopener ugc nofollow" target="_blank">从给定的css选择器</a>中提取数据。在后台，parsel使用cssselect将每个CSS查询转换为XPath查询。</selector></li><li id="9ead" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated">XPath(" normalize-space()")-<a class="ae kw" href="https://github.com/scrapy/parsel/issues/62#issuecomment-1042309376" rel="noopener ugc nofollow" target="_blank">获取空白文本节点</a>。默认情况下，空白文本节点将被跳过，导致不完整的输出。</li><li id="0848" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated">* text/::attr()是一个<a class="ae kw" href="https://github.com/scrapy/parsel/blob/90397dcd0b2c1cbb91e44f65c50f9e11628ba028/parsel/csstranslator.py#L48-L51" rel="noopener ugc nofollow" target="_blank"> parsel伪元素，用于从HTML节点中提取文本或属性</a>数据。</li><li id="7939" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated">get() —获取实际数据。</li></ul><p id="4268" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">将结果作为字典附加到临时列表，返回或打印提取的数据:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="1f56" class="lc ir ht ky b fi ld le l lf lg">publications.append({<br/>        "result_id": result_id,<br/>        "title": title,<br/>        "link": link,<br/>        "snippet": snippet,<br/>        "publication_info": publication_info,<br/>        "cite_by_link": cite_by_link,<br/>        "all_versions_link": all_versions_link,<br/>        "related_articles_link": related_articles_link,<br/>        "pdf": {<br/>            "title": pdf_file_title,<br/>            "link": pdf_file_link<br/>        }<br/>    })<br/>    <br/># return publications</span><span id="ab16" class="lc ir ht ky b fi mb le l lf lg">print(json.dumps(publications, indent=2, ensure_ascii=False))<br/></span><span id="021a" class="lc ir ht ky b fi mb le l lf lg">scrape_conference_publications(query="anatomy", source=["NIPS", "Neural Information"])</span></pre><p id="fdeb" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">产出:</p><pre class="jp jq jr js fd kx ky kz la aw lb bi"><span id="fe53" class="lc ir ht ky b fi ld le l lf lg">[<br/>  {<br/>    "result_id": "hjgaRkq_oOEJ",<br/>    "title": "Differential representation of arm movement direction in relation to cortical anatomy and function",<br/>    "link": "https://iopscience.iop.org/article/10.1088/1741-2560/6/1/016006/meta",<br/>    "snippet": "… ",<br/>    "publication_info": "T Ball, A Schulze-Bonhage, A Aertsen… - Journal of neural …, 2009 - iopscience.iop.org",<br/>    "cite_by_link": "https://scholar.google.com/scholar/scholar?cites=16258204980532099206&amp;as_sdt=2005&amp;sciodt=0,5&amp;hl=en",<br/>    "all_versions_link": "https://scholar.google.com/scholar/scholar?cluster=16258204980532099206&amp;hl=en&amp;as_sdt=0,5",<br/>    "related_articles_link": "https://scholar.google.com/scholar/scholar?q=related:hjgaRkq_oOEJ:scholar.google.com/&amp;scioq=anatomy+source:NIPS+OR+source:Neural+Information&amp;hl=en&amp;as_sdt=0,5",<br/>    "pdf": {<br/>      "title": "[PDF] psu.edu",<br/>      "link": "http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.324.1523&amp;rep=rep1&amp;type=pdf"<br/>    }<br/>  }, ... other results<br/>]</span></pre><h1 id="8142" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">学者有机结果API</h1><p id="aaa1" class="pw-post-body-paragraph jt ju ht jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">或者，您可以使用SerpApi的<a class="ae kw" href="https://serpapi.com/google-scholar-organic-results" rel="noopener ugc nofollow" target="_blank">谷歌学术有机结果API </a>来实现。</p><p id="5da1" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">最大的区别是，你不需要从头开始创建一个解析器，维护它，弄清楚如何扩展它，最重要的是，如何绕过谷歌的封锁，从而弄清楚如何设置代理和验证码解决方案。</p><pre class="jp jq jr js fd kx ky mc bn md me bi"><span id="6187" class="mf ir ht ky b be mg mh l mi lg"># pip install google-search-results<br/><br/>import os, json<br/>from serpapi import GoogleSearch<br/>from urllib.parse import urlsplit, parse_qsl<br/><br/>params = {<br/>    # https://docs.python.org/3/library/os.html#os.getenv<br/>    "api_key": os.getenv("API_KEY"), # your serpapi API key<br/>    "engine": "google_scholar",      # search engine<br/>    "q": "AI source:NIPS",           # search query<br/>    "hl": "en",                      # language<br/>    # "as_ylo": "2017",              # from 2017<br/>    # "as_yhi": "2021",              # to 2021<br/>    "start": "0"                     # first page<br/>    }<br/><br/>search = GoogleSearch(params)<br/><br/>publications = []<br/><br/>publications_is_present = True<br/>while publications_is_present:<br/>    results = search.get_dict()<br/><br/>    print(f"Currently extracting page #{results.get('serpapi_pagination', {}).get('current')}..")<br/><br/>    for result in results["organic_results"]:<br/>        position = result["position"]<br/>        title = result["title"]<br/>        publication_info_summary = result["publication_info"]["summary"]<br/>        result_id = result["result_id"]<br/>        link = result.get("link")<br/>        result_type = result.get("type")<br/>        snippet = result.get("snippet")<br/><br/>        publications.append({<br/>            "page_number": results.get("serpapi_pagination", {}).get("current"),<br/>            "position": position + 1,<br/>            "result_type": result_type,<br/>            "title": title,<br/>            "link": link,<br/>            "result_id": result_id,<br/>            "publication_info_summary": publication_info_summary,<br/>            "snippet": snippet,<br/>            })<br/><br/>        <br/>    if "next" in results.get("serpapi_pagination", {}):<br/>        # splits URL in parts as a dict and passes it to a GoogleSearch() class.<br/>        search.params_dict.update(dict(parse_qsl(urlsplit(results["serpapi_pagination"]["next"]).query)))<br/>    else:<br/>        papers_is_present = False<br/><br/>print(json.dumps(organic_results_data, indent=2, ensure_ascii=False))</span></pre><h1 id="54eb" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">链接</h1><ul class=""><li id="630a" class="ln lo ht jv b jw jx ka kb ke mj ki mk km ml kq ls lt lu lv bi translated">【the onlie IDE中的代码</li><li id="45db" class="ln lo ht jv b jw lw ka lx ke ly ki lz km ma kq ls lt lu lv bi translated">塞尔帕皮谷歌学术有机产品API </li></ul></div><div class="ab cl mm mn gp mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hb hc hd he hf"><p id="4679" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">加入我们的<a class="ae kw" href="https://twitter.com/serp_api" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae kw" href="https://www.youtube.com/channel/UCUgIHlYBOD3yA3yDIRhg_mg" rel="noopener ugc nofollow" target="_blank"> YouTube </a></p><p id="b63f" class="pw-post-body-paragraph jt ju ht jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">添加一个<a class="ae kw" href="https://github.com/serpapi/public-roadmap/issues" rel="noopener ugc nofollow" target="_blank">特征请求</a>💫还是一个<a class="ae kw" href="https://github.com/serpapi/public-roadmap/issues" rel="noopener ugc nofollow" target="_blank"> Bug </a>🐞</p></div></div>    
</body>
</html>
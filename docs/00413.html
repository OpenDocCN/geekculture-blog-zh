<html>
<head>
<title>Approach to Solve Regression Problems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决回归问题的方法</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/approach-to-solve-regression-problems-e67c6dd08537?source=collection_archive---------5-----------------------#2021-02-03">https://medium.com/geekculture/approach-to-solve-regression-problems-e67c6dd08537?source=collection_archive---------5-----------------------#2021-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="62b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多数据科学家忘记考虑一些重要的事情</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2965109f36d0b8e4698c6f7d7c4fb6e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jS4gFNBzFo6QJgRf"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@heyerlein?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">h heyerlein</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="db8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗨伙计们！🌞</p><p id="9018" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望，你们都会喜欢我的方法和我看待这个问题的小细节的方式。那么，让我们开始吧🏃</p><h1 id="6fce" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">目录:</h1><ol class=""><li id="68c3" class="ks kt hi ih b ii ku im kv iq kw iu kx iy ky jc kz la lb lc bi translated">介绍</li><li id="88a0" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">标准化和分布</li><li id="8175" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">特征工程</li><li id="c76c" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">目标特征</li><li id="72e1" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">分类特征</li><li id="ce42" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">关系</li><li id="2156" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">模型评估</li><li id="2850" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc kz la lb lc bi translated">管道</li></ol><p id="25f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我想向您介绍自行车租赁的数据集。我们的目标功能是具有13个其他<strong class="ih hj">数字</strong>功能的租赁。相同的描述如下所述:</p><ul class=""><li id="576e" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated"><strong class="ih hj"> instant </strong>:唯一的行标识符</li><li id="5728" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj"> dteday </strong>:观察数据的日期——在这个例子中，数据是每天收集的；所以每个日期占一行。</li><li id="51ee" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">季节</strong>:表示季节的数字编码值(1:春天，2:夏天，3:秋天，4:冬天)</li><li id="b2ec" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj"> yr </strong>:进行观察的研究年份(研究历时两年——0年代表2011年，1年代表2012年)</li><li id="de8e" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">月份</strong>:观测的日历月份(1:1月…12:12月)</li><li id="0bdb" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">假日</strong>:一个二进制值，表示观察是否在公共假日进行</li><li id="b44d" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">工作日</strong>:一周中进行观测的那一天(0:周日… 6:周六)</li><li id="3b20" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">工作日</strong>:一个二进制值，表示这一天是否是工作日(不是周末或假日)</li><li id="954f" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj"> weathersit </strong>:表示天气状况的分类值(1:晴，2:雾/云，3:小雨/雪，4:大雨/冰雹/雪/雾)</li><li id="5a6a" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj"> temp </strong>:摄氏温度(归一化)</li><li id="5f10" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated">atemp :以摄氏度为单位的表观(“感觉上”)温度(归一化)</li><li id="6c4c" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">嗡嗡声</strong>:湿度水平(归一化)</li><li id="33cf" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">风速</strong>:风速(归一化)</li><li id="2252" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">租赁</strong>:记录的自行车租赁次数。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/a8ccb4dffc2ebefc2b87e48d65d1fa04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kPRFH0p0w4wLEqpSBOxvQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Image by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><blockquote class="ln lo lp"><p id="67d0" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">我<!-- -->已经清理并预处理了数据集，因为你们大多数人都知道如何处理缺失值、应用归一化、将分类特征转换为数值以及其他预处理技术。</p></blockquote><h1 id="f59e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">1.标准化和分布</h1><p id="03de" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">如果仔细看数据，我已经归一化了<code class="du lx ly lz ma b">temp</code>、<code class="du lx ly lz ma b">atemp</code>、<code class="du lx ly lz ma b">hum</code>、<code class="du lx ly lz ma b">windspeed</code>等特征。标准化将防止模型出现偏差，并防止过度依赖其他功能。</p><p id="a73e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们通过<code class="du lx ly lz ma b">Describe()</code>方法来探究这些特性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/34413810cd2f52f1dfc44a39ac210f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*4mTxVqVtvTTqqHrCpel3XQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Image by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><ul class=""><li id="6761" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">统计数据揭示了每个数值字段中数据分布的一些信息。由此可见，日均租用次数在848左右；但是有一个相对较大的标准差，表明每天的租赁数量有很大的差异。通过可视化数据，我们可能会对租金值的分布有更清楚的了解。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/71ecc3b881bef3a7501069bbad80423d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDwEXzg4Qb7Dbnl4dgwqTA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><ul class=""><li id="b34d" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">数字特征似乎更符合<em class="lq">正态</em>分布，平均值和中值更接近值范围的中间，与最常出现的值一致。</li></ul><blockquote class="ln lo lp"><p id="a148" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>:在统计意义上，分布并不是真正的<em class="hi">正态</em>，这将导致一个平滑、对称的“钟形曲线”直方图，其平均值和众数(最常见的值)位于中心；但是它们通常表明大部分的观察值接近中间值。</p></blockquote><h1 id="2c13" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">2.特征工程</h1><p id="8292" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">例如，让我们通过从现有的<strong class="ih hj"> dteday </strong>列中提取day组件，向dataframe添加一个名为<strong class="ih hj"> day </strong>的新列。新列表示一个月中从1到31的某一天。</p><p id="5c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管如此，这个特性并没有多大用处——想知道为什么吗？</p><div class="je jf jg jh fd ab cb"><figure class="md ji me mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/e7b5bb0b66d5436456b3057d0ed220ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*00rwEmxlFdifbaRieqnPyA.png"/></div></figure><figure class="md ji mj mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/5e4e6ea7377f316209ccd696276fbc22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*_GmMAW_SKpCzndYcerfmPQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx mk di ml mm">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure></div><ul class=""><li id="5732" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">我们为一个月中的某一天创建的<strong class="ih hj"> day </strong>特性显示变化很小，这表明它可能无法预测租赁数量，并且也是均匀分布的。</li></ul><h1 id="e549" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">3.目标特征</h1><p id="94f3" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated"><em class="lq">租金分布-我们来看hist-plot和box plot。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/f1d25242da1f0fbd0a4f310cc30552a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*lmVSYKhESCTKclw9jF-bKw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Histogram Distribution | Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/005ebe6a6d485eff21a2975aa06f9df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*Du2nAH31jeaDCbtzA74EpA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Box Plot | Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><ul class=""><li id="e959" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">这些图显示日租金的数量范围从0到3400多一点。然而，日租金的平均数(和中位数)更接近该范围的低端，大多数数据在0到2，200次租赁之间。高于这个值的几个值在方框图中显示为小圆圈，表明它们是<em class="lq">异常值</em>——换句话说，超出大多数数据的典型范围的异常高值或低值。</li></ul><h1 id="265e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">4.分类特征</h1><p id="e46a" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">我们已经研究了数据集中数值的分布，但是分类特征呢？这些不是连续的数字，所以我们不能使用直方图，但我们可以绘制一个条形图，显示每个类别的每个离散值的计数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/ac96ef284371c2c0947ad1cd6c0b7d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7AWhedKQyqn_70LOS_w77A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><p id="6b4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多分类特征显示出或多或少的均匀分布(意味着每个类别的行数大致相同)。例外情况包括:</p><ul class=""><li id="1350" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">假日:假日比非假日要少得多。</li><li id="ee0c" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated"><strong class="ih hj">工作日</strong>:工作日比非工作日多。</li><li id="bed6" class="ks kt hi ih b ii ld im le iq lf iu lg iy lh jc ll la lb lc bi translated">天气状况:大部分日子都是第一类<em class="lq">第一类</em>(晴)，第二类<em class="lq">第二类</em>(雾和云)最常见。第三类<em class="lq"/>(小雨或小雪)天气相对较少，根本没有第四类<em class="lq"/>(大雨、冰雹或大雾)天气。</li></ul><h1 id="b48a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">5.审视人际关系</h1><p id="aa9f" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">现在我们已经了解了列中数据的分布情况，我们可以开始寻找特性和我们希望能够预测的<strong class="ih hj">租赁</strong>标签之间的关系。</p><p id="3fec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于数字要素，我们可以创建散点图来显示要素和标注值的交集。我们还可以计算<em class="lq">相关性</em>统计量来量化这种明显的关系。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/cfa9a24633611bb320968affd5335c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQ_eefbdzn4jHTX3y9X7Hw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><p id="06b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果并不是决定性的，但是如果你仔细观察<strong class="ih hj"> temp </strong>和<strong class="ih hj"> atemp </strong>的散点图，你可以看到一个模糊的对角线趋势，表明较高的租赁数量往往与较高的温度相一致；这两个特征的相关值刚好超过0.5支持了这一观察。相反，<strong class="ih hj">嗡嗡声</strong>和<strong class="ih hj">风速</strong>的曲线图显示出轻微的负相关性，表明在高湿度或高风速的日子里租赁较少。</p><h2 id="80fa" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">现在让我们将分类特征与标签进行比较。</h2><div class="je jf jg jh fd ab cb"><figure class="md ji nf mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/5abd69a05dabf65518130cfa215e6ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*7oqr4HEjE8aJTWtnSS7pTQ.png"/></div></figure><figure class="md ji ng mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/bd16426312d78a7d019e08031d09bf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*FLMVMTCZuvBlonnYEga5jQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx nh di ni mm">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure></div><ul class=""><li id="47c8" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">有一个明显的趋势显示，与春季和冬季相比，夏季和秋季的租金分布有所不同。</li></ul><div class="je jf jg jh fd ab cb"><figure class="md ji nj mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/4b18ebf411670a5ea3cdf8b519154d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*5F1ZTjQh_hNiEPAaoymJoA.png"/></div></figure><figure class="md ji nk mf mg mh mi paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/f2b8a8c6041d9b4fe8840d63562d26ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*GkGTOakyMUsNY5sIMAV8Jw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx nl di nm mm">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure></div><ul class=""><li id="9228" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">周末(<strong class="ih hj">工作日</strong> 0和6)和工作日(<strong class="ih hj">工作日</strong> 1至5)的租金分布有明显的不同。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nn"><img src="../Images/ec865e7330144813daf5ee06219f0ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*2llAPkFg6fvZ3ObuUu4FnQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><ul class=""><li id="b1d4" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">同样，工作日类别也有明显的差异。</li></ul><h1 id="e96a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">6.模型评估</h1><p id="89f7" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">尝试不同的回归模型，对于模型评估，您可以使用RMSE(均方根误差)、R2等。使用<strong class="ih hj">超参数</strong> <strong class="ih hj">调整</strong>以获得更好的结果。</p><blockquote class="ln lo lp"><p id="72ba" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated"><strong class="ih hj">注</strong>:您可以在<a class="ae jt" href="https://scikit-learn.org/stable/modules/model_evaluation.html#regression-metrics" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn文档</a>中找到更多关于评估回归模型的这些和其他指标的信息</p></blockquote><ul class=""><li id="44bd" class="ks kt hi ih b ii ij im in iq li iu lj iy lk jc ll la lb lc bi translated">对于这个示例，将每个预测与其对应的“基本事实”实际值进行比较并不是确定模型预测效果的非常有效的方法。让我们看看是否可以通过可视化散点图来比较预测和实际标签，从而获得更好的指示。</li></ul><h2 id="13d2" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">一.线性回归</h2><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="1d96" class="mr jv hi ma b fi ns nt l nu nv"><strong class="ma hj">RMSE: 449.4135728595166<br/>R2: 0.6040454736919189</strong></span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nw"><img src="../Images/e8bb2f96e87a8823d62f97972297554e.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*dZP-yw4zzh9VFyefIeSQtQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><h2 id="4180" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">二。套索回归</h2><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="2463" class="mr jv hi ma b fi ns nt l nu nv">RMSE: 448.5038527519959<br/>R2: 0.605646863782449</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nx"><img src="../Images/682cee61d8c1bf795c1823dd9114aac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*6Dyq_zYX9vPZ8SxUXFIJpw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><h2 id="7a7c" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">三。决策图表</h2><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="b2fc" class="mr jv hi ma b fi ns nt l nu nv">RMSE: 490.7097271948421<br/>R2: 0.5279344839454737</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ny"><img src="../Images/3155e882c46e56010f5b16b1a97d668e.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*1C2BE0jsf3iJKau2U5ilrQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><h2 id="ba96" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">四。随机森林</h2><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="53fa" class="mr jv hi ma b fi ns nt l nu nv">RMSE: 329.46670935564396<br/>R2: 0.7871978460868888</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nz"><img src="../Images/f75636685c6c5c98ce4d352a6a61b043.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*Gj2IIbRYrQAZ9V5gnt1KTg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><blockquote class="ln lo lp"><p id="6205" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">F <!-- -->还是好办法，让我们也试试一个<em class="hi">助推</em>集成算法。</p></blockquote><h2 id="dff7" class="mr jv hi bd jw ms mt mu ka mv mw mx ke iq my mz ki iu na nb km iy nc nd kq ne bi translated">动词 （verb的缩写）梯度推进</h2><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="4725" class="mr jv hi ma b fi ns nt l nu nv">RMSE: 322.4734419735391<br/>R2: 0.7961358554502365</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oa"><img src="../Images/6d8b16b16f71cf67bd68cf6093918a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*cgKOxba9OXL8rJDf-jW4JQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://harshkothari21.medium.com/" rel="noopener">Author</a></figcaption></figure><h1 id="b105" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">7.管道</h1><p id="345b" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">现在您已经知道使用哪种型号了！您可以使用管道封装所有预处理步骤以及回归算法。相同的示例代码如下所示:</p><pre class="je jf jg jh fd no ma np nq aw nr bi"><span id="7168" class="mr jv hi ma b fi ns nt l nu nv">from sklearn.compose import ColumnTransformer<br/>from sklearn.pipeline import Pipeline<br/>from sklearn.impute import SimpleImputer<br/>from sklearn.preprocessing import StandardScaler, OneHotEncoder<br/>from sklearn.linear_model import LinearRegression<br/>import numpy as np</span><span id="193c" class="mr jv hi ma b fi ob nt l nu nv"><strong class="ma hj"># Define preprocessing for numeric columns (scale them)</strong><br/>numeric_features = [6,7,8,9]<br/>numeric_transformer = Pipeline(steps=[<br/> (‘scaler’, StandardScaler())])</span><span id="2b73" class="mr jv hi ma b fi ob nt l nu nv"><strong class="ma hj"># Define preprocessing for categorical features (encode them)</strong><br/>categorical_features = [0,1,2,3,4,5]<br/>categorical_transformer = Pipeline(steps=[<br/> (‘onehot’, OneHotEncoder(handle_unknown=’ignore’))])</span><span id="7c00" class="mr jv hi ma b fi ob nt l nu nv"><strong class="ma hj"># Combine preprocessing steps</strong><br/>preprocessor = ColumnTransformer(<br/> transformers=[<br/> (‘num’, numeric_transformer, numeric_features),<br/> (‘cat’, categorical_transformer, categorical_features)])</span><span id="bcd2" class="mr jv hi ma b fi ob nt l nu nv"><strong class="ma hj"># Create preprocessing and training pipeline</strong><br/>pipeline = Pipeline(steps=[(‘preprocessor’, preprocessor),<br/> (‘regressor’, GradientBoostingRegressor())])</span><span id="c64b" class="mr jv hi ma b fi ob nt l nu nv"><strong class="ma hj"># fit the pipeline to train model on the training set</strong><br/>model = pipeline.fit(X_train, (y_train))</span></pre><p id="27a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👉感谢你阅读这个故事，❤.</p></div></div>    
</body>
</html>
<html>
<head>
<title>Hands-on Regression Analysis with BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用BigQuery进行回归分析</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/hands-on-regression-analysis-with-bigquery-7925dca179ff?source=collection_archive---------5-----------------------#2022-09-27">https://medium.com/geekculture/hands-on-regression-analysis-with-bigquery-7925dca179ff?source=collection_archive---------5-----------------------#2022-09-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9a2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何使用BiqQuery执行线性回归分析的分步指南</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/be92847361ccac8ed1912fca7dd616b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A89iYyp8ULAq8Dmk_wv0Ag.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">Image Source</a></figcaption></figure><p id="1ade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们生活在大数据时代。很难给出大数据的准确定义。然而，作为一个很好的经验法则，如果数据集不能放在单个系统的内存或磁盘中，它可以被称为大数据。大数据用于医疗保健、生物学、生物信息学和教育等领域。</p><p id="9005" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经典计算机足以分析中小型数据。但是大数据从根本上改变了数据分析。这些计算机无法分析大数据，因为大数据不适合内存。</p><p id="6923" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">云计算改变了游戏规则。现在云计算平台中的工具可以分析大数据。在本文中，我将向您展示如何使用BigQuery执行线性回归分析，并涵盖以下主题:</p><ul class=""><li id="0037" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">什么是BiqQuery？</li><li id="9aa5" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">什么是BigQuery ML？</li><li id="c308" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">BigQuery定价</li><li id="e6d7" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">使用BigQuery的线性回归分析</li></ul><p id="3c32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始吧！</p><h1 id="ee64" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">什么是BigQuery？</h1><p id="d725" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated"><a class="ae jt" href="https://cloud.google.com/bigquery/docs/introduction" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> BigQuery </strong> </a>是一个完全托管的无服务器数据仓库，允许您使用内置功能(如机器学习、地理空间分析和商业智能)来管理和分析您的数据。使用BigQuery可以在几秒钟内查询TB，在几分钟内查询Pb。</p><p id="52d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在Google云控制台界面和BigQuery命令行工具中访问BigQuery。您还可以使用<a class="ae jt" href="https://github.com/googleapis/python-bigquery" rel="noopener ugc nofollow" target="_blank"> Python </a>、Java、JavaScript和Go中的客户端库以及BigQuery的REST API和RPC API来转换和管理数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/9bc9a98a1fc74c42131211e75fb87e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEX3Pb0IBnOsnvl_vj5bZg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">BigQuery Page</figcaption></figure><h1 id="6841" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">什么是BigQuery ML？</h1><p id="9db8" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">您可以使用BigQuery来查询大数据，也可以使用标准SQL查询来构建机器学习模型。BigQuery ML允许您发现、实现和管理数据工具，以做出关键的业务决策。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lm"><img src="../Images/5c8b499494bb634161b036eea6f4b4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1iVd2IfvsTY-dncK1SSmuA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" href="https://cloud.google.com/static/bigquery-ml/images/ml-model-cheatsheet.pdf" rel="noopener ugc nofollow" target="_blank">BigQuery Cheatsheet</a></figcaption></figure><p id="fc9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所知，在大数据集上建立机器学习模型需要大量的编程和ML框架知识，如TensorFlow和PyTorch。BigQuery ML帮助SQL从业者使用现有的SQL工具和技能建立和评估机器学习模型。</p><p id="d88d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是BigQuery ML的一些优点:</p><ul class=""><li id="bb5b" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">BigQuery ML民主化了机器学习的使用，你只需要懂SQL。</li><li id="bdd8" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">它提供了各种可以开箱即用的预构建模型。</li><li id="98d0" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">不用从数据仓库导出数据，就可以快速建立机器学习模型。</li><li id="a36b" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">它易于使用，可以集成到现有的工作流程中。</li><li id="eda8" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">它具有成本效益，可用于在现收现付的基础上训练模型。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/9fdc3283e24c8c1b728d25fbbeb20657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKKwQzjCtfIglWwt-MMSIw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" rel="noopener" href="/google-cloud/how-to-integrate-external-data-sources-with-bigquery-9e126d5751ea">Data Processing Pipeline</a></figcaption></figure><p id="e8c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过以下方式使用BigQuery ML:</p><ul class=""><li id="52cb" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">谷歌云控制台</li><li id="5ec6" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated"><code class="du lo lp lq lr b">bq</code>命令行工具</li><li id="8fb4" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">BigQuery REST API</li><li id="7140" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">外部工具，如Jupyter笔记本电脑或商业智能平台</li></ul><h1 id="be77" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">BigQuery定价</h1><p id="4528" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">Bigquery不是免费的，它向你收取数据存储和运行查询的费用。但是作为谷歌云免费层的一部分，BigQuery免费提供一些资源，直到一个特定的限制。这些免费使用限制在免费试用期期间和之后可用。关于免费使用层的更多信息，你可以在这里查看<a class="ae jt" href="https://cloud.google.com/bigquery/pricing#free-tier" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ls lt gp lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="hb hc hd he hf"><h1 id="b98c" class="ki kj hi bd kk kl lz kn ko kp ma kr ks kt mb kv kw kx mc kz la lb md ld le lf bi translated">使用BigQuery进行回归分析</h1><p id="1fa2" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">线性回归是一种统计技术，用于根据给定的自变量预测因变量的未来值。因变量是被预测的变量，而自变量是用于进行预测的变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/73de85215436e2f640ade11280b56711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ST2_sSnxPsxnaIrO5gMQ5A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" href="https://simple.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">Linear Regression</a></figcaption></figure><p id="5777" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是线性回归的一些优点:</p><ol class=""><li id="0fe3" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc me ka kb kc bi translated">线性回归是一种简单易用的技术。</li><li id="8567" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc me ka kb kc bi translated">这是一种强大的技术，可以用来预测未来的价值。</li><li id="f495" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc me ka kb kc bi translated">这是一种可靠的技术，可用于获得准确的预测。</li><li id="1e67" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc me ka kb kc bi translated">这是一种灵活的技术，可用于预测不同自变量的值。</li><li id="a7d7" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc me ka kb kc bi translated">这是一种广泛使用的技术，为许多统计学家所熟知和理解。</li></ol><p id="2e5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看如何通过6个步骤使用BigQuery执行线性回归分析。</p><h2 id="6ca3" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第一步。创建数据集</h2><p id="3185" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">在建立机器学习模型之前，您需要创建一个数据集。为此，我们先转到bigquery页面。之后，点击项目名称旁边的三个点，然后按下<em class="mt">创建数据集</em>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/26ea011d8bdb1359665d33cd82df745f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJ--gl1n2Y-tb1f7NkCt4g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Creating dataset</figcaption></figure><p id="f0d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj"> Create dataset </strong>页面上，输入一个名称，比如说<em class="mt"> reg_analysis，</em>保留所有其他选项的默认值，然后单击Create dataset。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/35e74a4d202b4faf0e6308d48e98596d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJ_AIZiGUVVbzX0d9rC6yA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Creating dataset</figcaption></figure><h2 id="76d7" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第二步。探索数据集</h2><p id="b94c" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我要用的数据集是<strong class="ih hj"> new_york_citibike </strong>数据集<strong class="ih hj">。</strong>该数据集存在于托管所有bigquery公共数据集的<strong class="ih hj">big query-public-data</strong>GCP项目中。让我们来看看这个数据集。打开<strong class="ih hj">big query-public-data</strong>GCP项目，找到<strong class="ih hj"> new_york_citibike </strong>数据集。然后点击citibike_trips表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mu"><img src="../Images/f7ac73b862354a40357a56682bb55245.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*KuFJemjietUr02Ko1sQTsw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">The new york citibike dataset in bigquery-public-data project</figcaption></figure><p id="5a5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将打开一个新窗口，显示关于数据集的信息。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/bf2396fb0fffcdc5e94af51a11a31a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26Uhy_y3TVTZRN4W-c8Xgw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The citibike_trips table</figcaption></figure><p id="422b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在方案选项卡中，citibike_trips表的结构显示了可用作标注和要素的所有字段。在这里，tripduration字段指示每次自行车租赁的持续时间，以秒为单位。这个列将是我们的目标变量。表中的所有其他字段都是潜在要素，因为这些字段与要经过的距离直接相关，并影响行程的持续时间。</p><p id="7ec2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们用一个SQL查询来看看tripduration列的行数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/a633267d89be11d9a6913051a3d35a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qdn5uonHTt4hKhjzhV-hYQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/ceecfa644d87b392f190b48943c96636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PC8w9_t0hLDElY64K0N6PQ.png"/></div></div></figure><p id="7634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，有超过500万条记录的tripduration字段没有被正确赋值。</p><h2 id="349c" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第三步。创建表</h2><p id="87fe" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">在训练模型之前，数据集在机器学习项目中被分成三组。这些是训练集、验证集和测试集。模型是用定型集构建的，模型是用验证集评估的，测试集中的值是用模型预测的。</p><p id="1135" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先创建训练集:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/8471c0f1c0922c1f4ebbecc8a5191d40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wqCfe9nnj-FTgJzT87rTg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Creating the training table</figcaption></figure><p id="2160" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查一下这些SQL注释。您可以使用<code class="du lo lp lq lr b">CREATE OR REPLACE TABLE</code>语句创建一个新表。查询的结果存储在新的<code class="du lo lp lq lr b">nyc_bike.training_table</code>中。您可以在<code class="du lo lp lq lr b">SELECT</code>语句中编写想要使用的列。</p><p id="0691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lo lp lq lr b">WHERE</code>语句用于过滤数据。在这个语句中，我使用了<code class="du lo lp lq lr b">EXTRACT</code>方法从<code class="du lo lp lq lr b">starttime</code>字段中获取年份和月份，这表示自行车旅行开始的确切时间。为了排除<strong class="ih hj"> tripduration </strong>列中的异常值，我只考虑最小租赁时间为3分钟、最大租赁时间为3小时的行。我还可以为我们的客户的出生年份添加一个过滤器，通过过滤所有带有空<strong class="ih hj"> birth_year </strong>的记录，忽略所有出生于<strong class="ih hj"> 2007 </strong>之后的客户。</p><p id="2566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行该查询后，您将看到如下表格。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/926725351ef6dc9f94272e7cecb901fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_D6tJxGOWP3Q47sKckpN4A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The training table</figcaption></figure><p id="2a19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建评估表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/f5533c5ff0a798a1111a2be4c8b7009c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDNXFb_SPB2LsbFngE5TmQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The evaluation table</figcaption></figure><p id="1084" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，让我们创建预测表。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/ec7339d0d1eebc5c84f57ffcdfa841af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYyZYEp6x8JeReDqCxohHw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The prediction table</figcaption></figure><p id="9531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不错！我们创造了桌子。下一步是使用训练表创建回归模型</p><h2 id="d456" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第四步。构建模型</h2><p id="3ca6" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">现在让我们使用带有BigQuery的训练表构建一个线性回归模型。我们可以使用下面的标准SQL查询来构建用于预测旅行持续时间的模型。我要给模型起个名字，就说<code class="du lo lp lq lr b">reg_model</code>吧。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/3ed2e8603c9837cbdb53e55845806ac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrQlqCTqQF9s3cYLM0MljQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Building the model</figcaption></figure><h2 id="0b9d" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">查询详细信息</h2><p id="34ee" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">您可以使用<code class="du lo lp lq lr b">CREATE MODEL</code>子句通过<code class="du lo lp lq lr b">OPTIONS(model_type='linear_reg')</code>子句创建并训练名为<code class="du lo lp lq lr b">nyc_bike.reg_model </code>的模型。</p><p id="168e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想加一个<code class="du lo lp lq lr b">is_weekend</code>。该字段是一个<strong class="ih hj">布尔值</strong>，用于计算和提取自行车租赁发生在一周中的哪一天。它由一条<strong class="ih hj"> IF </strong>语句生成，如果当天是星期天或星期六，该语句返回<strong class="ih hj"> true </strong>，用值<strong class="ih hj"> 1 </strong>和<strong class="ih hj"> 7 </strong>表示；否则就是<strong class="ih hj">假</strong>。<code class="du lo lp lq lr b">tripduration</code>列是我们的输入标签列。</p><p id="39b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击run按钮后，查询大约需要30秒，然后您的模型会出现在导航面板中。注意，因为我们使用了一个<code class="du lo lp lq lr b">CREATE MODEL</code>语句来创建一个表，所以我们看不到查询结果。</p><p id="9796" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击reg_model查看模型定型统计信息。然后点击教育选项卡，然后点击表。结果应该是这样的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/9baf95568a1d4a25bd2c1b0a0cdeba1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnmquKXc-bb7kdmyOdqdvw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The mean squared error metric</figcaption></figure><p id="fc83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，您可以看到均方误差指标。</p><h2 id="166f" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第五步。评估模型</h2><p id="30b9" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">创建您的模型后，您可以使用<code class="du lo lp lq lr b">ML.EVALUATE</code>函数来评估模型。让我们使用以下查询来评估评估表上的ML模型:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nc"><img src="../Images/3f520befdd57f6d3ba9c0af7a8e3578f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtcFfoXrdpgMXiMJx-Lmfg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Evaluating the model using the evaluation_table</figcaption></figure><h2 id="4a3f" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">查询详细信息</h2><p id="d07a" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">最上面的<code class="du lo lp lq lr b">SELECT</code>语句从模型中检索列。我在<code class="du lo lp lq lr b">FROM</code>子句中设置了<code class="du lo lp lq lr b">ML.EVALUATE</code>函数来评估模型。当您运行这个查询时，结果如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nd"><img src="../Images/540a4aed9e4b518b4b430592348e5d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igiIoelJFG2ITx8XJ_prFA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The metrics</figcaption></figure><h2 id="a5d4" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">第六步。使用模型预测结果</h2><p id="0b07" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">评估模型后，下一步是用它来预测结果。让我们使用预测表中的数据来预测标注:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/4d62b8f57b3a527522ec022b96fa394a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kk8avruYyxtXGYAWMbaQQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Predicting the data in the prediction_table</figcaption></figure><h2 id="a79c" class="mf kj hi bd kk mg mh mi ko mj mk ml ks iq mm mn kw iu mo mp la iy mq mr le ms bi translated">查询详细信息</h2><p id="d85d" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我在<code class="du lo lp lq lr b">FROM</code>子句中设置了<code class="du lo lp lq lr b">ML.PREDICT</code>函数来预测预测表中的数据。在下面的截图中，可以看到预测的标签。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/7193defb7fd08dd2c75eec8244b3933c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znejxqNOOtFxD-827fEMRQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Predicting the data in the prediction table</figcaption></figure><p id="f369" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样。在本教程中，我们首先创建了一个线性回归模型，然后使用该模型来预测在构建模型时没有使用的数据。</p><h1 id="6ba6" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">打扫</h1><p id="a932" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">为了避免您的Google Cloud帐户因本教程中使用的资源而产生费用，您可以删除您创建的项目，或者保存项目并删除数据集。</p><h1 id="4dac" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">结论</h1><p id="e411" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">在这篇文章中，我一步一步地展示了如何使用BigQuery执行线性回归分析。您可以通过微调超参数获得更好的输出。你可以在这里找到我在本教程中使用的BigQuery查询。这里还有一个youtube视频，展示了我在这篇文章中讨论的分析。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="e88b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读。我希望你喜欢它。别忘了关注我们的<a class="ae jt" href="https://jovian.ai/outlink?url=http%3A%2F%2Fyoutube.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae jt" href="https://jovian.ai/outlink?url=http%3A%2F%2Ftirendazacademy.medium.com" rel="noopener ugc nofollow" target="_blank">Medium</a>|<a class="ae jt" href="https://jovian.ai/outlink?url=http%3A%2F%2Ftwitter.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae jt" href="https://jovian.ai/outlink?url=http%3A%2F%2Fgithub.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae jt" href="https://jovian.ai/outlink?url=https%3A%2F%2Fwww.linkedin.com%2Fin%2Ftirendaz-academy" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae jt" href="https://jovian.ai/outlink?url=https%3A%2F%2Fwww.kaggle.com%2Ftirendazacademy" rel="noopener ugc nofollow" target="_blank">ka ggle</a>😎</p><div class="ni nj ez fb nk"><div role="button" tabindex="0" class="ab bv ff cb dy nl nm bn nn jn no"><div class="np l"><div class="ab q"><div class="l di"><img alt="Tirendaz AI" class="l de bw nq nr du" src="../Images/384c46a0053e6856ca4df470ae6476d6.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*kmflHCCpj1_qrGGBdH3BJA.png"/><div class="dr bw l nq nr ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://tirendazacademy.medium.com/?source=post_page-----7925dca179ff--------------------------------" rel="noopener follow" target="_top">提伦达兹艾</a></p></div></div><div class="nu nv fg l"><h2 class="bd hj tm ju dy tn ea eb to ed ef hh bi translated">用Python实践机器学习</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi tp au tq tr ts qo tt an fx fy tu tv tw gb gc gd de bk ge" href="https://tirendazacademy.medium.com/list/handson-machine-learning-with-python-24dbaf45d18a?source=post_page-----7925dca179ff--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="tx l dw"><span class="bd b fp z dx">19 stories</span></div></div></div><div class="oh dh oi dy ab oj dw di"><div class="di nz bv oa ob"><div class="dh l"><img alt="" class="dh" src="../Images/4b5164276b34a32e66bb51f979717194.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*0AKj8jEQSgE3TGcGWLFdvw.jpeg"/></div></div><div class="di nz bv oc od oe"><div class="dh l"><img alt="" class="dh" src="../Images/e84792838ccc8ec4f0d46e6b0f225973.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*nWuREg_9FIYuXLeM3xzyhg.jpeg"/></div></div><div class="di bv of og oe"><div class="dh l"><img alt="" class="dh" src="../Images/c85ae7c4c1c4cfc46d3271d98d78886a.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*53I38gjv4DfIUeKK"/></div></div></div></div></div><h1 id="70d0" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">资源</h1><ul class=""><li id="ac8e" class="ju jv hi ih b ii lg im lh iq oo iu op iy oq jc jz ka kb kc bi translated"><a class="ae jt" href="https://cloud.google.com/bigquery-ml/docs/" rel="noopener ugc nofollow" target="_blank"> Google BigQuery ML文档</a></li><li id="b061" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated"><a class="ae jt" href="https://www.amazon.com.tr/Machine-Learning-BigQuery-ML-learning/dp/1800560303" rel="noopener ugc nofollow" target="_blank">使用BigQuery的机器学习</a></li></ul><p id="5db7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>
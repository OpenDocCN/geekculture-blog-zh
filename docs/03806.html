<html>
<head>
<title>Exploring Detailed POI Data with the TomTom Search API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TomTom搜索API探索详细的POI数据</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/exploring-detailed-poi-data-with-the-tomtom-search-api-121c7de2980d?source=collection_archive---------55-----------------------#2021-06-15">https://medium.com/geekculture/exploring-detailed-poi-data-with-the-tomtom-search-api-121c7de2980d?source=collection_archive---------55-----------------------#2021-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/bcaf5f5336b2bf9f56163e95f4a88405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNiYbAC66WRP66dGexoAYg.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="0153" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">通过一点JavaScript，我们将使用TomTom POI Details API创建一个简单的地图网页，突出显示西雅图周围不同的披萨店，并允许用户更详细地探索每家企业。</h2></div><p id="1494" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">TomTom搜索API v6帮助开发者访问<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation/points-of-interest-details" rel="noopener ugc nofollow" target="_blank">详细的兴趣点(POI)信息</a>。示例包括商店的评级和评论、营业时间和照片。这为基于地图的应用程序增加了价值，通过每个POI的详细信息增强了用户体验。</p><p id="ad0f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">本文使用TomTom POI Details API创建了一个简单的地图网页，突出显示了西雅图周围不同的披萨店，并允许用户更详细地了解每家企业。要学习这篇教程，你只需要知道一些JavaScript。</p><h1 id="1fb0" class="kf kg ht bd kh ki kj kk kl km kn ko kp iz kq ja kr jc ks jd kt jf ku jg kv kw bi translated">兴趣点详细信息示例</h1><p id="2c68" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">常规搜索API已经返回了基本信息和兴趣点。这些信息包括企业名称、联系信息(如地址和电话号码)和POI类别类型。它还包含一个POI详细信息ID，我们可以使用它来请求其他详细信息。您可以在嵌套在每个搜索API结果中的dataSources对象中找到它，如下所示:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="cc12" class="ll kg ht lh b fi lm ln l lo lp">"dataSources": {<br/>  "poiDetails": [<br/>    {<br/>      "id": "45d78933f964a520e1421fe3",<br/>      "sourceName": "Foursquare"<br/>    }<br/>  ]<br/>}</span></pre><p id="da87" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">详细数据添加了更具体的信息，如果可用的话。例子包括照片、价格区间、社交媒体链接、一周中每天的热门时段，甚至是文字评论。</p><p id="5318" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">例如，下面是我在西雅图最喜欢的一家比萨饼店的JSON格式的详细数据示例:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="d833" class="ll kg ht lh b fi lm ln l lo lp">{<br/>        "result": {<br/>        "description": "Thin crust pizza in bustling Chinatown. World Pizza originated in the 1990's in the Belltown neighborhood.",<br/>        "rating": {<br/>            "totalRatings": 27,<br/>            "value": 7.7,<br/>            "minValue": 0,<br/>            "maxValue": 10<br/>            "id": "Rm91cnNxdWFyZTo0ZTE4YmI1NDdkOGI4YWY5MTM5MGQ3ZDg=",</span><span id="7f4a" class="ll kg ht lh b fi lq ln l lo lp">        },<br/>        "priceRange": {<br/>            "value": 1,<br/>            "label": "Cheap",<br/>            "minValue": 1,<br/>            "maxValue": 4<br/>        },<br/>        "socialMedia": [<br/>            {<br/>                "name": "facebook",<br/>                "url": "https://facebook.com/profile.php?id=158562957492458"<br/>            },<br/>            {<br/>                "name": "twitter",<br/>                "url": "https://twitter.com/World_Pizza"<br/>            }<br/>        ],<br/>        "photos": [<br/>            {<br/>                "id": "a35f4c83-2463-366f-a07b-1fde5877d415"<br/>            },<br/>            {<br/>                "id": "ea498b33-d06c-3fa5-abbb-33662e6f32b7"<br/>            },<br/>            {<br/>                "id": "08f6a677-f976-3c44-a1f2-0baacbd1870c"<br/>            },<br/>            {<br/>                "id": "2b2c84da-df78-3e50-8682-03625e6993a6"<br/>            },<br/>            {<br/>                "id": "0fa0f767-5181-3449-a62f-3d4f2337dcc0"<br/>            }<br/>        ],<br/>        "reviews": [<br/>            {<br/>                "text": "Great by the slice vegetarian pizza!",<br/>                "date": "2018-09-25"<br/>            },<br/>            {<br/>                "text": "The potato-gorgonzola pizza is delicious.",<br/>                "date": "2018-03-10"<br/>            },<br/>            {<br/>                "text": "The crust is crunchy the sauce is delicious!the vegetarian is delicious I was very worried about a pizza joint in the international district , I am here at least once a week yummy",<br/>                "date": "2017-06-28"<br/>            },<br/>            {<br/>                "text": "Owner's very kind. Vegan pizza is honestly the best I've ever had! The happy hour was SUPER cheap (beer was only $1.50) and the atmosphere was perfect",<br/>                "date": "2015-12-18"<br/>            },<br/>            {<br/>                "text": "Best veggie pizzas",<br/>                "date": "2015-05-16"<br/>            },<br/>            {<br/>                "text": "Spicy field roast + pineapple pizza is awesome",<br/>                "date": "2014-08-20"<br/>            },<br/>            {<br/>                "text": "The red potato pizza is a delicious comfort food. Ingredients are super fresh and tasty (and all vegetarian!). The two owners are very nice guys! Excellent happy hour at 3 with pizza &amp; drink specials.",<br/>                "date": "2014-01-28"<br/>            },<br/>            {<br/>                "text": "They have amazingly crispy chocolate chip cookies too!",<br/>                "date": "2013-06-08"<br/>            },<br/>            {<br/>                "text": "I'm not vegetarian, but that doesn't keep me from saying it's perhaps  the best pizza I've ever had. My favorites: the potato &amp; the spicy veg pepperoni. Adam &amp; Aaron are great guys!",<br/>                "date": "2011-09-09"<br/>            }<br/>        ],<br/>        "popularHours": [<br/>            {<br/>                "dayOfWeek": 1,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 14,<br/>                            "minute": 0<br/>                        }<br/>                    },<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 17,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 20,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 2,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 14,<br/>                            "minute": 0<br/>                        }<br/>                    },<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 16,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 21,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 3,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 19,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 4,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 21,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 5,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 21,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 6,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 11,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 20,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            },<br/>            {<br/>                "dayOfWeek": 7,<br/>                "timeRanges": [<br/>                    {<br/>                        "startTime": {<br/>                            "hour": 12,<br/>                            "minute": 0<br/>                        },<br/>                        "endTime": {<br/>                            "hour": 18,<br/>                            "minute": 0<br/>                        }<br/>                    }<br/>                ]<br/>            }<br/>        ]<br/>    }<br/>}</span></pre><p id="79ce" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">很不错，对吧？JSON对象中的大部分数据应该是不言自明的，但是您可能会注意到photos部分包含一组id而不是URL。</p><p id="bde8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">您可以使用这些id和<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation/points-of-interest-photos" rel="noopener ugc nofollow" target="_blank">TomTom Points of Interest Photos API</a>来检索指定宽度和高度的图像。使用该API时，请务必遵循<a class="ae ke" href="https://developer.tomtom.com/terms-and-conditions" rel="noopener ugc nofollow" target="_blank">条款和条件</a>。这包括将来自细节API和照片API的结果归为“由Foursquare提供支持”另外，缓存结果的时间不要超过30天。</p><h1 id="8d89" class="kf kg ht bd kh ki kj kk kl km kn ko kp iz kq ja kr jc ks jd kt jf ku jg kv kw bi translated">从TOMTOM获取POI详细数据</h1><p id="c635" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">现在，看看如何使用兴趣点细节API通过JavaScript获取详细数据。</p><p id="3b25" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">首先，收集一个<a class="ae ke" href="https://developer.tomtom.com/how-to-get-tomtom-api-key" rel="noopener ugc nofollow" target="_blank"> TomTom API密钥</a>来使用这些API。注册TomTom开发者门户既快捷又免费。TomTom自动生成第一个密钥。</p><p id="65f2" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">下一步是用<a class="ae ke" href="https://developer.tomtom.com/maps-sdk-web-js/documentation" rel="noopener ugc nofollow" target="_blank"> TomTom Maps SDK for Web </a>设置网页，这样就可以详细搜索兴趣点。创建一个新网页，并在标题中包含TomTom SDK文件。下面使用了<a class="ae ke" href="https://api.tomtom.com/maps-sdk-for-web/6.x/6.13.0/documentation/dist/modules/Maps.html" rel="noopener ugc nofollow" target="_blank">映射JS库</a>、它的CSS样式表和<a class="ae ke" href="https://api.tomtom.com/maps-sdk-for-web/6.x/6.13.0/documentation/dist/modules/Services.html" rel="noopener ugc nofollow" target="_blank">服务JS库</a>。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="321b" class="ll kg ht lh b fi lm ln l lo lp">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>    &lt;head&gt;<br/>        &lt;meta http-equiv='X-UA-Compatible' content='IE=Edge' /&gt;<br/>        &lt;meta charset='UTF-8'&gt;<br/>        &lt;title&gt;TomTom POI Details API Example&lt;/title&gt;<br/>        &lt;meta name='viewport'<br/>              content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'/&gt;<br/>        &lt;link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.12.0/maps/maps.css'&gt;<br/>        &lt;script src='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.12.0/maps/maps-web.min.js'&gt;&lt;/script&gt;<br/>        &lt;script src='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.13.0/services/services-web.min.js'&gt;&lt;/script&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;script&gt;<br/>            ( async () =&gt; {<br/>                // Your Code Here<br/>            })();<br/>        &lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="af15" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">接下来，获取一些兴趣点位置。从各种选项中进行选择，以从TomTom搜索和检索POI位置，如<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation-search/fuzzy-search" rel="noopener ugc nofollow" target="_blank">模糊搜索</a>、<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation-search/category-search" rel="noopener ugc nofollow" target="_blank">类别搜索</a>和<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation-search/nearby-search" rel="noopener ugc nofollow" target="_blank">附近搜索</a>。使用<a class="ae ke" href="https://developer.tomtom.com/search-api/search-api-documentation-search/points-interest-search" rel="noopener ugc nofollow" target="_blank"> TomTom Maps POI搜索API </a>并以经纬度坐标为中心获取默认距离半径内的结果。</p><p id="2c2a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">POI搜索API支持许多选项来帮助缩小结果范围，包括企业类型或位置。本例使用带有<strong class="jk hu">中心</strong>选项的<strong class="jk hu">查询</strong>字段来查找与某个位置附近的搜索短语相匹配的任何兴趣点。我们将尝试搜索西雅图附近的比萨饼。</p><p id="667f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">使用SDK，将<a class="ae ke" href="https://developer.tomtom.com/how-to-get-tomtom-api-key" rel="noopener ugc nofollow" target="_blank"> API键</a>连同查询文本“pizza”和西雅图的经度和纬度位置坐标(-122.33，47.60)传递给<strong class="jk hu"> tt.services.poiSearch </strong>服务:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="452c" class="ll kg ht lh b fi lm ln l lo lp">const data = await tt.services.poiSearch({<br/>    key: "YOUR API KEY HERE",<br/>    query: "pizza",<br/>    center: [ -122.33, 47.60 ] // Seattle<br/>});</span></pre><p id="5a49" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">返回的数据应该类似于以下内容:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="e9d5" class="ll kg ht lh b fi lm ln l lo lp">{<br/>    "summary": {<br/>        "query": "pizza",<br/>        "queryType": "NON_NEAR",<br/>        "queryTime": 276,<br/>        "numResults": 100,<br/>        "offset": 0,<br/>        "totalResults": 369504,<br/>        "fuzzyLevel": 1,<br/>        "geoBias": {<br/>            "lat": 47.6,<br/>            "lon": -122.33<br/>        }<br/>    },<br/>    "results": [<br/>        {<br/>            "type": "POI",<br/>            "id": "g6JpZK84NDA1MzkwMDMwNzQ0MTShY6NVU0GhdqdVbmlmaWVk",<br/>            "score": 2.5745153427,<br/>            "dist": 195.61886948402355,<br/>            "info": "search:ta:840539003074414-US",<br/>            "poi": {<br/>                "name": "Mod Pizza",<br/>                "phone": "+1 206-338-7356",<br/>                "brands": [<br/>                    {<br/>                        "name": "Mod Pizza"<br/>                    }<br/>                ],<br/>                "categorySet": [<br/>                    {<br/>                        "id": 7315036<br/>                    }<br/>                ],<br/>                "url": "https://modpizza.com/locations/occidental-square/",<br/>                "categories": [<br/>                    "pizza",<br/>                    "restaurant"<br/>                ],<br/>                "classifications": [<br/>                    {<br/>                        "code": "RESTAURANT",<br/>                        "names": [<br/>                            {<br/>                                "nameLocale": "en-US",<br/>                                "name": "restaurant"<br/>                            },<br/>                            {<br/>                                "nameLocale": "en-US",<br/>                                "name": "pizza"<br/>                            }<br/>                        ]<br/>                    }<br/>                ]<br/>            },<br/>            "address": {<br/>                "streetNumber": "202",<br/>                "streetName": "Occidental Avenue South",<br/>                "municipalitySubdivision": "Downtown Seattle",<br/>                "municipality": "Seattle",<br/>                "countrySecondarySubdivision": "King",<br/>                "countrySubdivision": "WA",<br/>                "countrySubdivisionName": "Washington",<br/>                "postalCode": "98104",<br/>                "extendedPostalCode": "98104-3120",<br/>                "countryCode": "US",<br/>                "country": "United States",<br/>                "countryCodeISO3": "USA",<br/>                "freeformAddress": "202 Occidental Avenue South, Seattle, WA 98104",<br/>                "localName": "Seattle"<br/>            },<br/>            "position": {<br/>                "lng": -122.33251,<br/>                "lat": 47.60048<br/>            },<br/>            "viewport": {<br/>                "topLeftPoint": {<br/>                    "lng": -122.33384,<br/>                    "lat": 47.60138<br/>                },<br/>                "btmRightPoint": {<br/>                    "lng": -122.33118,<br/>                    "lat": 47.59958<br/>                }<br/>            },<br/>            "entryPoints": [<br/>                {<br/>                    "type": "main",<br/>                    "position": {<br/>                        "lng": -122.33289,<br/>                        "lat": 47.60079<br/>                    }<br/>                }<br/>            ],<br/>            "dataSources": {<br/>                "poiDetails": [<br/>                    {<br/>                        "id": "Rm91cnNxdWFyZTo1Y2UzMTJlNTAxYmM1YTAwMmM3M2MzNDE=",<br/>                        "sourceName": "Foursquare"<br/>                    }<br/>                ]<br/>            }<br/>        },<br/>        ...<br/>    ]<br/>}</span></pre><p id="7525" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">一些结果包括一个<strong class="jk hu">数据源</strong>字段，指示它们具有额外的POI细节。通过使用兴趣点细节API引用ID值，从TomTom检索这些细节。作为测试，通过使用TomTom SDK for Web传递API键和POI数据源ID值，接收第一个POI结果的详细信息:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="8eb9" class="ll kg ht lh b fi lm ln l lo lp">const details = await tt.services.poiDetails({<br/>    key: "YOUR API KEY HERE",<br/>    id: data.results[ 0 ].dataSources.poiDetails[ 0 ].id<br/>});</span></pre><p id="2faa" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这就是访问应用程序位置数据的全新细节的全部内容。但是，这还没有完成。</p><p id="a4c0" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">既然我们已经设置好检索感兴趣点的详细信息，那么让我们将它与TomTom地图显示API结合起来，创建一个该地区周围比萨饼店的交互式地图。</p><h1 id="de5d" class="kf kg ht bd kh ki kj kk kl km kn ko kp iz kq ja kr jc ks jd kt jf ku jg kv kw bi translated">集成兴趣点详细信息数据</h1><p id="64ef" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">要完成该应用程序，请向代码中添加一些用户界面(UI)元素:地图显示和细节部分。</p><h2 id="c970" class="ll kg ht bd kh lr ls lt kl lu lv lw kp jr lx ly kr jv lz ma kt jz mb mc kv md bi translated"><strong class="ak">添加地图显示</strong></h2><p id="670d" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">首先，在网页标题的<style>标签中添加下面的CSS代码。这将适当地调整两个UI元素的大小，并确保细节部分保持在左侧:&lt;/root&gt;</style></p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="7d27" class="ll kg ht lh b fi lm ln l lo lp">&lt;style&gt;<br/>    #map {<br/>        width: 48vw;<br/>        height: 98vh;<br/>    }<br/></span><span id="77d6" class="ll kg ht lh b fi lq ln l lo lp">    #details {<br/>        width: 48vw;<br/>        padding: 3px;<br/>        float: left;<br/>    }<br/>&lt;/style&gt;</span></pre><p id="f9f3" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">接下来，在UI页面主体中添加这两个<div>元素:</div></p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="14ee" class="ll kg ht lh b fi lm ln l lo lp">&lt;div id="details"&gt;&lt;h1&gt;Click on a shop!&lt;/h1&gt;&lt;/div&gt;<br/>&lt;div id="map"&gt;&lt;/div&gt;</span></pre><p id="0500" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">将API键、位置坐标和搜索查询作为全局变量放在顶部。(请注意，在产品发布应用程序中，保持API密钥比将其直接放在网页中更安全)。</p><p id="babf" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">然后初始化地图显示并添加一些控件:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="645b" class="ll kg ht lh b fi lm ln l lo lp">const key = "YOUR API KEY HERE";<br/>const position = [ -122.33, 47.60 ]; // Seattle<br/>const query = "pizza";</span><span id="f69a" class="ll kg ht lh b fi lq ln l lo lp">( async () =&gt; {<br/>    var map = tt.map({<br/>        key: key,<br/>        container: "map",<br/>        dragPan: true,<br/>        center: position,<br/>        zoom: 13<br/>    });<br/>    map.addControl(new tt.FullscreenControl());<br/>    map.addControl(new tt.NavigationControl());<br/>    const data = await tt.services.poiSearch({<br/>        key: key,<br/>        query: query,<br/>        center: position<br/>    });<br/>})();</span></pre><p id="aa70" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">此时，当您在浏览器中打开网页时，您应该会在页面的右半部分看到以西雅图为中心的交互式地图，在页面的左半部分看到详细信息的空间。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es me"><img src="../Images/073881c17dd1f9c755ab0214a8498b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/0*RBAV40s9AMYI-nR9.jpg"/></div></figure><h2 id="67be" class="ll kg ht bd kh lr ls lt kl lu lv lw kp jr lx ly kr jv lz ma kt jz mb mc kv md bi translated">添加兴趣点搜索结果</h2><p id="4dcb" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">接下来，将我们的POI搜索结果的标记添加到地图中，并使用户能够单击它们来动态加载和查看POI的详细信息。</p><p id="4b49" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">创建一个名为<strong class="jk hu"> createMarker </strong>的辅助函数，在地图显示的特定位置放置一个定制颜色的标记，并弹出一个位置名称的弹出窗口。如果作为参数传入，它应该分配并调用<strong class="jk hu"> onclick </strong>事件处理程序:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="7c05" class="ll kg ht lh b fi lm ln l lo lp">function createMarker( map, position, color, data, onClick ) {<br/>    const popup = new tt.Popup({ offset: 30 }).setText( data.poi.name );<br/>    const marker = new tt.Marker({ anchor: "bottom", color: color })<br/>        .setLngLat( position )<br/>        .setPopup( popup )<br/>        .addTo( map );<br/>    if( onClick ) {<br/>        marker._element.addEventListener( "click", onClick );<br/>    }<br/>}</span></pre><p id="76ff" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">然后，创建第二个名为<strong class="jk hu"> displayDetails </strong>的辅助函数。这使用基本POI数据和详细数据来填充我们的详细信息部分，这是页面左半部分的一个信息面板。此外，根据API条款和条件，确保文本“由Foursquare提供支持的结果”显示在底部。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="8aca" class="ll kg ht lh b fi lm ln l lo lp">function displayDetails( data, details ) {<br/>    const element = document.getElementById( "details" );<br/>    // Clear out the current details<br/>    element.innerHTML = "";<br/>    // Show the location name<br/>    const title = document.createElement( "h1" );<br/>    title.innerText = data.poi.name;<br/>    element.append( title );<br/>    // Show additional information if it is included<br/>    if( data.address ) {<br/>        const address = document.createElement( "p" );<br/>        address.innerText = `Address: ${data.address.freeformAddress}`;<br/>        element.append( address );<br/>    }<br/>    if( data.poi.phone ) {<br/>        const phone = document.createElement( "p" );<br/>        phone.innerText = `Phone: ${data.poi.phone}`;<br/>        element.append( phone );<br/>    }<br/>    if( details ) {<br/>        if( details.photos ) {<br/>            const photo = document.createElement( "img" );<br/>            photo.src = `https://api.tomtom.com/search/2/poiPhoto?key=${key}&amp;id=${details.photos[ 0 ].id}&amp;width=200&amp;height=200`;<br/>            element.append( photo );<br/>        }<br/>        if( details.rating ) {<br/>            const rating = document.createElement( "p" );<br/>            rating.innerText = `Rating: ${details.rating.value} / ${details.rating.maxValue} (${details.rating.totalRatings} ratings)`;<br/>            element.append( rating );<br/>        }<br/>        if( details.priceRange ) {<br/>            const price = document.createElement( "p" );<br/>            price.innerText = `Price: ${details.priceRange.label} ${details.priceRange.value} / ${details.priceRange.maxValue}`;<br/>            element.append( price );<br/>        }<br/>        if( details.socialMedia ) {<br/>            const social = document.createElement( "p" );<br/>            social.innerHTML = `Social: ${details.socialMedia.map( s =&gt; `&lt;a href="${s.url}"&gt;${s.name}&lt;/a&gt;` ).join( " " )}`;<br/>            element.append( social );<br/>        }<br/>        if( details.reviews ) {<br/>            const reviewsHeader = document.createElement( "p" );<br/>            reviewsHeader.innerText = "Reviews:";<br/>            element.append( reviewsHeader );<br/>            const reviews = document.createElement( "ul" );<br/>            details.reviews.forEach( r =&gt; {<br/>                const review = document.createElement( "li" );<br/>                review.innerHTML = `&lt;li&gt;${r.date}: ${r.text}&lt;/li&gt;`;<br/>                reviews.append( review );<br/>            });<br/>            element.append( reviews );<br/>        }<br/>        // Per usage terms and conditions<br/>        const poweredText = document.createElement( "p" );<br/>        poweredText.innerText = "Results powered by Foursquare";<br/>        element.append( poweredText );<br/>    }<br/>    else {<br/>        const detailText = document.createElement( "p" );<br/>        detailText.innerText = "No Additional Details";<br/>        element.append( detailText );<br/>    }<br/>}</span><span id="c804" class="ll kg ht lh b fi lq ln l lo lp">Also, expand the POI Search from the default limit of 10 results to 100. This shows more locations on the map.</span><span id="b92e" class="ll kg ht lh b fi lq ln l lo lp">const data = await tt.services.poiSearch({<br/>    key: key,<br/>    query: query,<br/>    center: position,<br/>    limit: 100,<br/>});</span></pre><p id="3d85" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">最后，遍历搜索结果。在地图上为每个结果放置一个标记，并在click事件处理程序中加载和显示详细信息:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="5673" class="ll kg ht lh b fi lm ln l lo lp">data.results.forEach( p =&gt; {<br/>    createMarker( map, [ p.position.lng, p.position.lat ], "#c30b82", p, async () =&gt; {<br/>        if( p.dataSources &amp;&amp; p.dataSources.poiDetails.length &gt; 0 ) {<br/>            // Detail sources available<br/>            const details = await tt.services.poiDetails({<br/>                key: key,<br/>                id: p.dataSources.poiDetails[ 0 ].id<br/>            });<br/>            displayDetails( p, details.result );<br/>        }<br/>        else {<br/>            // No detail sources<br/>            displayDetails( p, null );<br/>        }<br/>    });<br/>});</span></pre><p id="8fa6" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">一切就绪后，点击地图上的披萨店，查看照片、评分和评论、价格范围等。</p><figure class="lc ld le lf fd hk er es paragraph-image"><div class="er es mf"><img src="../Images/69ec8707cf76252119eec576b0749821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*0W8YXFvO3i_dB8aw.jpg"/></div></figure><p id="fc97" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">以下是完整的项目代码，供参考:</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="46f8" class="ll kg ht lh b fi lm ln l lo lp">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>    &lt;head&gt;<br/>        &lt;meta http-equiv='X-UA-Compatible' content='IE=Edge' /&gt;<br/>        &lt;meta charset='UTF-8'&gt;<br/>        &lt;title&gt;TomTom POI Details API Example&lt;/title&gt;<br/>        &lt;meta name='viewport'<br/>              content='width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no'/&gt;<br/>        &lt;link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.12.0/maps/maps.css'&gt;<br/>        &lt;script src='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.12.0/maps/maps-web.min.js'&gt;&lt;/script&gt;<br/>        &lt;script src='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.13.0/services/services-web.min.js'&gt;&lt;/script&gt;<br/>        &lt;style&gt;<br/>            #map {<br/>                width: 48vw;<br/>                height: 98vh;<br/>            }<br/></span><span id="ffa7" class="ll kg ht lh b fi lq ln l lo lp">            #details {<br/>                width: 48vw;<br/>                padding: 3px;<br/>                float: left;<br/>            }<br/>        &lt;/style&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;div id="details"&gt;&lt;h1&gt;Click on a shop!&lt;/h1&gt;&lt;/div&gt;<br/>        &lt;div id="map"&gt;&lt;/div&gt;<br/>        &lt;script&gt;<br/>            const key = "YOUR API KEY HERE";<br/>            const position = [ -122.33, 47.60 ]; // Seattle<br/>            const query = "pizza";<br/></span><span id="4575" class="ll kg ht lh b fi lq ln l lo lp">            function createMarker( map, position, color, data, onClick ) {<br/>                const popup = new tt.Popup({ offset: 30 }).setText( data.poi.name );<br/>                const marker = new tt.Marker({ anchor: "bottom", color: color })<br/>                    .setLngLat( position )<br/>                    .setPopup( popup )<br/>                    .addTo( map );<br/>                if( onClick ) {<br/>                    marker._element.addEventListener( "click", onClick );<br/>                }<br/>            }<br/></span><span id="fc39" class="ll kg ht lh b fi lq ln l lo lp">            function displayDetails( data, details ) {<br/>                const element = document.getElementById( "details" );<br/>                // Clear out the current details<br/>                element.innerHTML = "";<br/>                // Show the location name<br/>                const title = document.createElement( "h1" );<br/>                title.innerText = data.poi.name;<br/>                element.append( title );<br/>                // Show additional information if it is included<br/>                if( data.address ) {<br/>                    const address = document.createElement( "p" );<br/>                    address.innerText = `Address: ${data.address.freeformAddress}`;<br/>                    element.append( address );<br/>                }<br/>                if( data.poi.phone ) {<br/>                    const phone = document.createElement( "p" );<br/>                    phone.innerText = `Phone: ${data.poi.phone}`;<br/>                    element.append( phone );<br/>                }<br/>                if( details ) {<br/>                    if( details.photos ) {<br/>                        const photo = document.createElement( "img" );<br/>                        photo.src = `https://api.tomtom.com/search/2/poiPhoto?key=${key}&amp;id=${details.photos[ 0 ].id}&amp;width=200&amp;height=200`;<br/>                        element.append( photo );<br/>                    }<br/>                    if( details.rating ) {<br/>                        const rating = document.createElement( "p" );<br/>                        rating.innerText = `Rating: ${details.rating.value} / ${details.rating.maxValue} (${details.rating.totalRatings} ratings)`;<br/>                        element.append( rating );<br/>                    }<br/>                    if( details.priceRange ) {<br/>                        const price = document.createElement( "p" );<br/>                        price.innerText = `Price: ${details.priceRange.label} ${details.priceRange.value} / ${details.priceRange.maxValue}`;<br/>                        element.append( price );<br/>                    }<br/>                    if( details.socialMedia ) {<br/>                        const social = document.createElement( "p" );<br/>                        social.innerHTML = `Social: ${details.socialMedia.map( s =&gt; `&lt;a href="${s.url}"&gt;${s.name}&lt;/a&gt;` ).join( " " )}`;<br/>                        element.append( social );<br/>                    }<br/>                    if( details.reviews ) {<br/>                        const reviewsHeader = document.createElement( "p" );<br/>                        reviewsHeader.innerText = "Reviews:";<br/>                        element.append( reviewsHeader );<br/>                        const reviews = document.createElement( "ul" );<br/>                        details.reviews.forEach( r =&gt; {<br/>                            const review = document.createElement( "li" );<br/>                            review.innerHTML = `&lt;li&gt;${r.date}: ${r.text}&lt;/li&gt;`;<br/>                            reviews.append( review );<br/>                        });<br/>                        element.append( reviews );<br/>                    }<br/>                    // Per usage terms and conditions<br/>                    const poweredText = document.createElement( "p" );<br/>                    poweredText.innerText = "Results powered by Foursquare";<br/>                    element.append( poweredText );<br/>                }<br/>                else {<br/>                    const detailText = document.createElement( "p" );<br/>                    detailText.innerText = "No Additional Details";<br/>                    element.append( detailText );<br/>                }<br/>            }<br/></span><span id="2cdd" class="ll kg ht lh b fi lq ln l lo lp">            ( async () =&gt; {<br/>                var map = tt.map({<br/>                    key: key,<br/>                    container: "map",<br/>                    dragPan: true,<br/>                    center: position,<br/>                    zoom: 13<br/>                });<br/>                map.addControl(new tt.FullscreenControl());<br/>                map.addControl(new tt.NavigationControl());<br/>                const data = await tt.services.poiSearch({<br/>                    key: key,<br/>                    query: query,<br/>                    center: position,<br/>                    limit: 100,<br/>                });<br/>                data.results.forEach( p =&gt; {<br/>                    createMarker( map, [ p.position.lng, p.position.lat ], "#c30b82", p, async () =&gt; {<br/>                        if( p.dataSources &amp;&amp; p.dataSources.poiDetails.length &gt; 0 ) {<br/>                            // Detail sources available<br/>                            const details = await tt.services.poiDetails({<br/>                                key: key,<br/>                                id: p.dataSources.poiDetails[ 0 ].id<br/>                            });<br/>                            displayDetails( p, details.result );<br/>                        }<br/>                        else {<br/>                            // No detail sources<br/>                            displayDetails( p, null );<br/>                        }<br/>                    });<br/>                });<br/>            })();<br/>        &lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="2e72" class="kf kg ht bd kh ki kj kk kl km kn ko kp iz kq ja kr jc ks jd kt jf ku jg kv kw bi translated">后续步骤</h1><p id="b16b" class="pw-post-body-paragraph ji jj ht jk b jl kx iu jn jo ky ix jq jr kz jt ju jv la jx jy jz lb kb kc kd hb bi translated">只需一点代码，TomTom Maps SDK for Web和Points of Interest Details API，我们就可以在网页中创建一个完全可探索的披萨地图。游客可以查看每家披萨店的有用信息。现在我们可以找个地方今晚吃晚饭了！</p><p id="0d50" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">尝试使用这段代码的有趣想法包括:</p><ul class=""><li id="3789" class="mg mh ht jk b jl jm jo jp jr mi jv mj jz mk kd ml mm mn mo bi translated">将位置更改为不同的城市，或在应用程序中启用城市选择</li><li id="0395" class="mg mh ht jk b jl mp jo mq jr mr jv ms jz mt kd ml mm mn mo bi translated">通过将查询更改为“冰激凌”或“咖啡”来创建不同的POI搜索地图</li><li id="2b50" class="mg mh ht jk b jl mp jo mq jr mr jv ms jz mt kd ml mm mn mo bi translated">将自定义图标添加到标记中，以指示商店的类型</li><li id="4487" class="mg mh ht jk b jl mp jo mq jr mr jv ms jz mt kd ml mm mn mo bi translated">添加一个HTML元素覆盖图，将详细信息直接嵌入到弹出窗口中</li></ul><p id="c93c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">TomTom的iOS SDK和T2的Android SDK也有助于将这一功能嵌入到移动应用中。要了解更多关于TomTom地图API的信息，请查看<a class="ae ke" href="https://developer.tomtom.com/docs-and-tools" rel="noopener ugc nofollow" target="_blank">文档</a>和<a class="ae ke" href="https://developer.tomtom.com/tutorials" rel="noopener ugc nofollow" target="_blank">教程</a>。此外，<a class="ae ke" href="https://developer.tomtom.com/maps-sdk-web-js" rel="noopener ugc nofollow" target="_blank">在线文档和示例</a>是展示TomTom SDK for Web还能做什么的很好的资源。</p><p id="9690" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated"><em class="mu">本文原载于</em><a class="ae ke" href="https://developer.tomtom.com/blog" rel="noopener ugc nofollow" target="_blank"><em class="mu">https://developer.tomtom.com/blog</em></a><em class="mu">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Dask or Spark? A Comparison for Data Scientists</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Dask还是Spark？数据科学家的比较</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/dask-or-spark-a-comparison-for-data-scientists-d4cba8ba9ef7?source=collection_archive---------0-----------------------#2022-06-04">https://medium.com/geekculture/dask-or-spark-a-comparison-for-data-scientists-d4cba8ba9ef7?source=collection_archive---------0-----------------------#2022-06-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="56c1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Dask更适合数据科学项目的3个原因(以及何时不适合)</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/ec25ec9349f9994c1d50ff63940f5f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*dbUA5oJxia41XAL3.jpg"/></div><figcaption class="jf jg et er es jh ji bd b be z dx">By <a class="ae jj" href="https://imgflip.com/memegenerator" rel="noopener ugc nofollow" target="_blank">imgflip.com</a></figcaption></figure><h1 id="a970" class="jk jl hi bd jm jn jo jp jq jr js jt ju io jv ip jw ir jx is jy iu jz iv ka kb bi translated">简介:数据科学中的大数据</h1><p id="96e7" class="pw-post-body-paragraph kc kd hi ke b kf kg ij kh ki kj im kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">作为一名数据科学家，您可能会遇到数据不适合内存的项目。在这些情况下，流行的工具如<a class="ae jj" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>和<a class="ae jj" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>都无法支持你的操作，甚至优化后的<a class="ae jj" rel="noopener" href="/bigdatarepublic/advanced-pandas-optimize-speed-and-memory-a654b53be6c2"/>。在使用大数据解决方案(如<a class="ae jj" href="https://spark.apache.org/docs/latest/api/python/" rel="noopener ugc nofollow" target="_blank"> PySpark </a>)之前，您应该问自己三个问题:</p><ol class=""><li id="c6cb" class="ky kz hi ke b kf la ki lb kl lc kp ld kt le kx lf lg lh li bi translated"><strong class="ke hj">我为什么会有大数据？我真的需要所有的数据吗？有什么办法可以通过采样或者过滤来减小它的大小？</strong></li><li id="4a6a" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><strong class="ke hj">怎么才能再变小？</strong>我真的需要这种级别的聚合吗？我可以通过聚合或使用块来减小它的大小吗？</li><li id="baf3" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><strong class="ke hj">我的大数据需求是什么，有哪些工具支持它？</strong>我的瓶颈在哪里？<br/>？我是否在大数据方面进行培训或预测？<br/>我是在大型数据集上训练一个模型，还是在小型数据集上训练多个模型？</li></ol><p id="c169" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">如果在回答了前两个问题后，您的数据仍然不适合内存，那么这篇文章的目的是介绍<a class="ae jj" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> Dask </a>相对于<a class="ae jj" href="https://spark.apache.org/docs/latest/api/python/" rel="noopener ugc nofollow" target="_blank"> Apache Spark </a>的优势(和劣势),以满足您的数据科学需求，并建议何时选择哪一种。</p><h1 id="d7c4" class="jk jl hi bd jm jn jo jp jq jr js jt ju io jv ip jw ir jx is jy iu jz iv ka kb bi translated">Dask是什么？</h1><blockquote class="lr ls lt"><p id="54a8" class="kc kd lu ke b kf la ij kh ki lb im kk lv lo kn ko lw lp kr ks lx lq kv kw kx hb bi translated">Dask是一个纯Python大数据解决方案，集成了Python数据科学生态系统。</p></blockquote><p id="b9fb" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">Dask 是一个Python模块和大数据工具，可以扩展pandas和NumPy。像Spark一样，Dask支持并行执行，并处理内存不足的数据帧和数组。但是，虽然Spark是用Scala编写的，并提供了Python API (PySpark)，但Dask是一个纯粹的Python解决方案，是Python数据科学生态系统的一部分。</p><p id="535e" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">Dask与Spark有许多共同的特点。和Spark一样，Dask的执行力也很懒。这意味着当您在控制台中运行一个命令时，实际的操作并没有被执行，而是被附加到一个执行图中。当执行命令被调用时，Dask将在执行它之前优化图形。你可以用<code class="du ly lz ma mb b">.compute()</code>和<code class="du ly lz ma mb b">.persist()</code>方法<a class="ae jj" href="http://distributed.dask.org/en/stable/manage-computation.html" rel="noopener ugc nofollow" target="_blank">管理Dask的执行图</a>。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/f22c2d846db1ed2c8d154705b1edb518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M19s5GddXfmgnDjcsd9YFw.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx">High level collections are used to generate task graphs which can be executed by schedulers on a single machine or a cluster. Image taken with permission from <a class="ae jj" href="https://docs.dask.org/en/latest/" rel="noopener ugc nofollow" target="_blank">dask.org</a>.</figcaption></figure><p id="7440" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">另一个相似之处是通过部署集群进行扩展的能力。像Spark一样，<a class="ae jj" href="https://docs.dask.org/en/stable/scheduler-overview.html" rel="noopener ugc nofollow" target="_blank"> Dask调度器</a>可以部署到使用各种技术的机器集群上。在这种情况下，您可以与许多Dask工作人员一起工作，他们的资源将由调度程序管理。不像Spark，没有调度器也可以工作<a class="ae jj" href="https://docs.dask.org/en/stable/deploying.html" rel="noopener ugc nofollow" target="_blank">；你可以去<code class="du ly lz ma mb b">import dask.dataframe as dd</code>然后开始工作。</a></p><h1 id="895f" class="jk jl hi bd jm jn jo jp jq jr js jt ju io jv ip jw ir jx is jy iu jz iv ka kb bi translated">选择Dask的3个理由</h1><h2 id="3e01" class="mh jl hi bd jm mi mj mk jq ml mm mn ju kl mo mp jw kp mq mr jy kt ms mt ka mu bi translated">I:与熊猫和NumPy的融合</h2><p id="ebe6" class="pw-post-body-paragraph kc kd hi ke b kf kg ij kh ki kj im kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">pandas和NumPy是任何数据科学家的面包和黄油，Dask就是建立在这些库之上的。这一事实给我们带来了一些积极的结果。首先是通用API如果您很好地控制了pandas和NumPy API，那么您已经成功迁移到Dask了，因为Dask继承了这些模块的大部分API。</p><p id="b195" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">第二是在同一个项目中使用这些库的能力。由于熊猫数据帧是Dask数据帧的“构建模块”, Dask知道如何处理它们。例如，如果我在项目中同时处理大数据帧和小数据帧，我可以使用Dask管理大数据帧，使用pandas管理小数据帧。我可以毫不费力地将它们连接和合并在一起。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mv"><img src="../Images/a4048d72e24cb8cdd758a319680a59d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*F7YlsjUq2NUgd-8YPvWjIw.png"/></div><figcaption class="jf jg et er es jh ji bd b be z dx">Dask scales NumPy arrays and pandas dataframes. Images taken with permission from <a class="ae jj" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank">dask.org</a>.</figcaption></figure><p id="4b97" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">然而，重要的是要记住<strong class="ke hj">达斯克不是熊猫</strong>。与pandas不同，Dask对象是不可变的，并且不支持就地操作。这可能非常令人沮丧，例如，您不能使用<code class="du ly lz ma mb b">.loc</code>方法分配新值。然而，Dask提供了<code class="du ly lz ma mb b">.map_partitions</code>方法来支持pandas在每个分区上的操作。</p><p id="6e8c" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">这些属性使您可以毫不费力地编写既适用于Dask又适用于pandas数据框架的项目。反过来，这使得开发和调试您的项目变得非常简单:您可以在pandas中进行开发，使用简单的调度程序进行调试，使用分布式调度程序进行部署。</p><h2 id="18df" class="mh jl hi bd jm mi mj mk jq ml mm mn ju kl mo mp jw kp mq mr jy kt ms mt ka mu bi translated">II:与SciKit-Learn和JobLib的集成</h2><p id="e494" class="pw-post-body-paragraph kc kd hi ke b kf kg ij kh ki kj im kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">Dask与SciKit-Learn紧密集成，并继承了它的常规API这是相对于Spark的一个巨大优势，因为<code class="du ly lz ma mb b">pyspark.ml</code>使用了我们需要学习的全新的非常规API。</p><p id="475a" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">Dask提供了一些内部预处理和机器学习算法，从线性模型和朴素贝叶斯到聚类、分解和XG-Boost。尽管如此，Dask支持大多数SKLearn模型的并行化，作为JobLib库的后端。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mw"><img src="../Images/260ec891d3fa63046c3c2d5ce77e6925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*af4t59aV49gyNb0T.jpg"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx">Image taken with permission from <a class="ae jj" href="https://github.com/dask/dask/issues/4471" rel="noopener ugc nofollow" target="_blank">github.com/dask</a></figcaption></figure><p id="cf3a" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">最后，如果您需要在小数据集上训练您的模型并在大数据集上进行预测，Dask提供了SciKit-Learn模型上的<code class="du ly lz ma mb b">ParallelPostFit</code>包装器。这个包装器允许任何SKLearn模型在其<code class="du ly lz ma mb b">.predict</code>方法中支持Dask数据帧和数组。</p><h2 id="f7ad" class="mh jl hi bd jm mi mj mk jq ml mm mn ju kl mo mp jw kp mq mr jy kt ms mt ka mu bi translated">III:纯Python解决方案</h2><p id="e957" class="pw-post-body-paragraph kc kd hi ke b kf kg ij kh ki kj im kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">Dask完全是用Python实现的，所以它没有前Python依赖。这对我们的数据科学家和支持我们运营的工程师都有影响。</p><p id="5a42" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">对于我们数据科学家来说，这意味着开发和调试变得更加简单。为了在本地运行项目，不需要安装Scala、Java和Spark等非pythonic依赖项。如果您正在使用一个简单的调度程序，那么您不需要处理本地集群，并且项目依赖关系可以通过环境管理器(比如Anaconda)轻松管理。这使得研究、开发和调试我们的项目变得更加简单。</p><p id="600c" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">对于数据工程师来说，这意味着部署项目变得更加简单。如果您的数据是中等大小的，并且您在项目中使用简单的调度程序，那么它可以部署在虚拟环境中，而不是构建Spark集群(例如，使用YARN调度程序)。</p><h2 id="7e92" class="mh jl hi bd jm mi mj mk jq ml mm mn ju kl mo mp jw kp mq mr jy kt ms mt ka mu bi translated">Spark相对于Dask的优势</h2><p id="ad89" class="pw-post-body-paragraph kc kd hi ke b kf kg ij kh ki kj im kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">虽然Dask更适合数据科学项目，并且集成在Python生态系统中，但Spark有许多主要优势，包括:</p><ol class=""><li id="0e10" class="ky kz hi ke b kf la ki lb kl lc kp ld kt le kx lf lg lh li bi translated"><em class="lu"> Spark能够处理比Dask大得多的工作量。</em>如果你的数据量大于1TB，Spark可能是个不错的选择。</li><li id="6357" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><em class="lu"> Dask的SQL引擎早熟。</em>不像Spark，你不能用SQL查询操作你的数据(现在是<a class="ae jj" href="https://dask-sql.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"/>)。</li><li id="43bf" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><em class="lu"> Spark是阿帕奇生态系统的一部分。</em>与Dask不同，它集成了Hive和Iceberg等其他Apache工具。</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mx"><img src="../Images/778ec1a8996d65138d785fb1289c826d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*LF4iXrriwzb1gnye"/></div><figcaption class="jf jg et er es jh ji bd b be z dx">The Apache Eco-System. Image taken from <a class="ae jj" href="https://dzone.com/articles/example-of-etl-application-using-apache-spark-and" rel="noopener ugc nofollow" target="_blank">dzone.com</a>.</figcaption></figure><h1 id="04dd" class="jk jl hi bd jm jn jo jp jq jr js jt ju io jv ip jw ir jx is jy iu jz iv ka kb bi translated">摘要</h1><blockquote class="lr ls lt"><p id="01ea" class="kc kd lu ke b kf la ij kh ki lb im kk lv lo kn ko lw lp kr ks lx lq kv kw kx hb bi translated">你应该把大枪留给大战争Spark是真正的大枪。</p></blockquote><p id="1b1e" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">请记住作为处理大数据的数据科学家，您需要问自己的3个问题:</p><ol class=""><li id="87f6" class="ky kz hi ke b kf la ki lb kl lc kp ld kt le kx lf lg lh li bi translated">为什么我有大数据？</li><li id="2c7e" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated">怎么才能让它再变小？</li><li id="e8ab" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated">适合我的项目需求的大数据工具是什么？</li></ol><p id="67c2" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">在这篇博客文章中，我提出了Dask更适合数据科学项目的3个原因:它与pandas和NumPy集成，它与SciKit-Learn集成，它是一个纯Python解决方案——使我们数据科学家和支持我们的工程师的生活变得更加容易。虽然Spark打算成为一个一体化的解决方案，但Dask打算融入Python数据科学生态系统。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es my"><img src="../Images/871bbe9c50108d1c58ebfa398cd87d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fxmt4LG0j4CObyLoQIZ7Rg.png"/></div></div><figcaption class="jf jg et er es jh ji bd b be z dx">Dask, Modin, Vaex, Ray, and CuDF are often considered potential alternatives to each other. Image generated with <a class="ae jj" href="https://anvaka.github.io/vs/?query=Dask" rel="noopener ugc nofollow" target="_blank">this tool</a>, cited also in <a class="ae jj" href="https://www.datarevenue.com/en-blog/pandas-vs-dask-vs-vaex-vs-modin-vs-rapids-vs-ray" rel="noopener ugc nofollow" target="_blank">datarevenue.com</a>.</figcaption></figure><p id="3b26" class="pw-post-body-paragraph kc kd hi ke b kf la ij kh ki lb im kk kl lo kn ko kp lp kr ks kt lq kv kw kx hb bi translated">然而，Dask也可能不是最适合您的项目的工具；在选择解决方案之前，想想你需要什么。大数据还有其他的Pythonic解决方案，比如<a class="ae jj" href="https://www.ray.io/" rel="noopener ugc nofollow" target="_blank">雷</a>和<a class="ae jj" href="https://modin.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">摩丁</a>、<a class="ae jj" href="https://vaex.io/" rel="noopener ugc nofollow" target="_blank"> Vaex </a>和<a class="ae jj" href="https://rapids.ai/" rel="noopener ugc nofollow" target="_blank">激流</a>；各有各的<a class="ae jj" href="https://www.datarevenue.com/en-blog/pandas-vs-dask-vs-vaex-vs-modin-vs-rapids-vs-ray" rel="noopener ugc nofollow" target="_blank">利弊</a>。如果您有超过几TB的数据，Spark仍然是一个不错的选择。</p><h1 id="7f87" class="jk jl hi bd jm jn jo jp jq jr js jt ju io jv ip jw ir jx is jy iu jz iv ka kb bi translated">参考</h1><ol class=""><li id="1f40" class="ky kz hi ke b kf kg ki kj kl mz kp na kt nb kx lf lg lh li bi translated"><a class="ae jj" href="https://docs.dask.org/en/stable/spark.html" rel="noopener ugc nofollow" target="_blank">对比火花</a>、<em class="lu">dask.org</em></li><li id="f336" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><a class="ae jj" href="https://databricks.com/session/dask-and-apache-spark" rel="noopener ugc nofollow" target="_blank">达斯克和阿帕奇火花</a>，<em class="lu">databricks.com</em></li><li id="e6ff" class="ky kz hi ke b kf lj ki lk kl ll kp lm kt ln kx lf lg lh li bi translated"><a class="ae jj" href="https://www.datarevenue.com/en-blog/pandas-vs-dask-vs-vaex-vs-modin-vs-rapids-vs-ray" rel="noopener ugc nofollow" target="_blank">攀比熊猫:对比达斯克、雷、摩丁、瓦克斯、急流</a>、<em class="lu">datarevenue.com</em></li></ol></div></div>    
</body>
</html>
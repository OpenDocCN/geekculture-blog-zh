<html>
<head>
<title>What is Data leakage in Machine Learning and what are its effects?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是机器学习中的数据泄露，有什么影响？</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/what-is-data-leakage-in-machine-learning-and-what-are-its-effects-811d58be7ccd?source=collection_archive---------10-----------------------#2022-11-23">https://medium.com/geekculture/what-is-data-leakage-in-machine-learning-and-what-are-its-effects-811d58be7ccd?source=collection_archive---------10-----------------------#2022-11-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b106e6ac1e0cfa0a9b51d49b60fbc3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JTIwdD8dQFAEVWVc"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e085" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文将阐述机器学习中的<strong class="ix hj">数据泄露</strong>现象、其原因、影响以及一些现实生活中的用例，以便更好地理解。</p><h2 id="1f6c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">数据泄露</strong></h2><p id="592e" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><strong class="ix hj">数据泄漏</strong>(或<strong class="ix hj">泄漏</strong>)发生在训练数据包含关于目标的信息时，但当模型用于预测时，类似的数据将不可用。这导致<strong class="ix hj">在<strong class="ix hj">训练数据集</strong>(甚至可能是<strong class="ix hj">验证数据</strong>)上的高性能</strong>，但是该模型在生产中的性能将会很差。</p><p id="cc09" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简而言之，数据泄漏导致任何机器学习模型看起来都很准确，直到使用该模型进行预测，而该模型显示不正确的结果。</p><p id="cbbb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">泄漏主要有两种类型:<strong class="ix hj">目标泄漏</strong>和<strong class="ix hj">列车测试污染。</strong></p><h2 id="53ca" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">目标泄漏</h2><p id="264b" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><strong class="ix hj">目标泄漏</strong>发生在预测器包含预测时不可用的数据时。</p><p id="11ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，有人想预测谁会得肺炎。人们在得了肺炎后服用抗生素药物以便康复，但如果没有肺炎就不会服药。</p><p id="8163" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据在那些列之间具有<strong class="ix hj">强关系</strong>，但是在确定值<code class="du kt ku kv kw b">got_pneumonia</code>之后频繁改变<code class="du kt ku kv kw b">took_antibiotic_medicine</code>。这是目标泄漏。</p><p id="8e7f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个模型将会看到任何一个<code class="du kt ku kv kw b">False</code>值为<code class="du kt ku kv kw b">took_antibiotic_medicine</code>的人都没有患肺炎。由于验证数据与训练数据来自相同的来源，因此模式将总是在验证中重复自身，并且模型将具有很高的验证(或交叉验证)分数。</p><p id="2fe1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，当随后在现实世界中部署时，该模型将会非常不准确，因为当我们需要预测他们未来的健康状况时，即使是患肺炎的病人也不会接受抗生素治疗。</p><p id="ebe6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了防止这种类型的<strong class="ix hj">数据泄露</strong>，任何在目标值实现后更新(或创建)的变量<strong class="ix hj">都应该被排除。</strong></p><h2 id="7e0f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">列车测试污染</h2><p id="8dd5" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">当用户没有足够小心来<strong class="ix hj">区分训练数据和验证数据时，就会发生不同类型的泄漏。</strong></p><p id="69eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">验证</strong>是衡量模型如何处理以前没有考虑的数据。如果验证数据影响预处理行为，它可能会被微妙地破坏。这有时被称为<strong class="ix hj">列车测试污染</strong>。</p><p id="da21" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，想象在调用<code class="du kt ku kv kw b"><a class="ae iu" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">train_test_split()</a></code>之前运行一个预处理(比如<strong class="ix hj">为缺失值拟合一个估算器</strong>)。下一步什么？创建的模型可能会得到<strong class="ix hj">良好的验证分数</strong>，给予其极大的信心，但在部署进行决策时，表现<strong class="ix hj">不佳。</strong></p><p id="91e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">毕竟，用户将来自<strong class="ix hj">验证或测试数据</strong>的数据合并到如何进行预测中，所以他们可能在特定数据上做得很好，即使它<strong class="ix hj">不能推广到新数据</strong>。当一个人做更多复杂的特征工程时，这个问题变得更加微妙(也更加危险)。</p><p id="d5b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果验证基于<strong class="ix hj">简单列车测试分割</strong>，从任何类型的拟合中排除验证数据，包括预处理步骤的拟合。如果使用<strong class="ix hj"> scikit-learn管道</strong>，这就更容易了。当使用交叉验证时，预处理在管道内部完成就更加重要了！</p><h2 id="4f0d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">数据泄露用例</strong></h2><ol class=""><li id="0916" class="kx ky hi ix b iy ko jc kp jg kz jk la jo lb js lc ld le lf bi translated">需要多少根鞋带？</li></ol><p id="0201" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">耐克希望在鞋材上省钱。因此，耐克需要审查一个他们的员工建立的模型，以预测他们每个月需要多少根鞋带。进入机器学习模型的<strong class="ix hj">功能</strong>有:</p><ul class=""><li id="42e1" class="kx ky hi ix b iy iz jc jd jg lg jk lh jo li js lj ld le lf bi translated">当月(一月、二月等)</li><li id="f1fa" class="kx ky hi ix b iy lk jc ll jg lm jk ln jo lo js lj ld le lf bi translated">上个月的广告支出</li><li id="f813" class="kx ky hi ix b iy lk jc ll jg lm jk ln jo lo js lj ld le lf bi translated">截至本月初的各种宏观经济特征(如失业率)</li><li id="5381" class="kx ky hi ix b iy lk jc ll jg lm jk ln jo lo js lj ld le lf bi translated">当月他们最终使用的皮革数量</li></ul><p id="5ae2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果显示，如果使用<strong class="ix hj">皮革量</strong>的特征，模型几乎<strong class="ix hj">完全准确</strong>。但是如果不考虑这个特征的话，这仅仅是适度准确的，因为他们使用的皮革数量是他们生产多少鞋子的完美指标，这反过来又告诉他们需要多少鞋带。</p><p id="00ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您认为<strong class="ix hj">使用的皮革量</strong>特征是否构成数据泄露的来源？如果你的答案是“<strong class="ix hj">视情况而定，</strong>”取决于什么？</p><p id="5a71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这很棘手，而且取决于数据收集的细节(在考虑泄漏时这很常见)。有人会在月初决定那个月要用多少皮革吗？如果是这样，这是可以的。但是，如果这是在当月确定的，那么当用户做出预测时，用户将无法访问它。如果你在月初的<strong class="ix hj">有一个猜测，并且是<strong class="ix hj">随后在该月内改变</strong>，则该月内的实际使用量不能作为一个特性(因为它会造成泄漏)。</strong></p><p id="4c7c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用一个新的想法。我们可以在鞋带模型中使用<strong class="ix hj">耐克订购的皮革</strong>数量(而不是他们实际使用的数量)作为预测。</p><p id="f5ac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这可能没问题，但这取决于他们是先订购鞋带还是先订购皮革。如果他们先订购鞋带，当你预测他们的鞋带需求时，你不会知道他们订购了多少皮革。如果他们先订购皮革，然后<strong class="ix hj">当你下<strong class="ix hj">鞋带订单</strong>时，你就有那个号码</strong>了，你应该没问题。</p><h2 id="273c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">预防患者感染</strong></h2><p id="76cd" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">一家提供医疗保健的机构希望预测<strong class="ix hj">哪些罕见手术的患者</strong>有感染<strong class="ix hj">的风险</strong>，这样它就可以提醒护士在随访这些患者时要更加小心。</p><p id="b2b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们想要建立一个模型。建模数据集中的每一行将是接受手术的单个患者，而<strong class="ix hj">预测目标</strong>将是<strong class="ix hj">他们是否受到感染</strong>。</p><p id="6aa1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一些外科医生可能会以提高或降低感染风险的方式进行手术。但是如何才能最好地将外科医生的信息整合到模型中呢？</p><p id="7188" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下几点可以考虑。</p><ol class=""><li id="bf44" class="kx ky hi ix b iy iz jc jd jg lg jk lh jo li js lc ld le lf bi translated">取每个外科医生的所有手术，并<strong class="ix hj">计算这些外科医生的感染率</strong>。</li><li id="3ff7" class="kx ky hi ix b iy lk jc ll jg lm jk ln jo lo js lc ld le lf bi translated">对于数据中的每个患者，找出外科医生是谁，并将该外科医生的平均感染率作为一个特征插入。</li></ol><p id="f8ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是否会造成任何目标泄漏问题？它会造成任何列车测试污染问题吗？</p><p id="6e3a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这造成了<strong class="ix hj">目标泄漏和列车测试污染的风险。</strong></p><p id="211b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果给定患者的结果对其外科医生的<strong class="ix hj">感染率有影响，则存在目标泄漏，然后将其插回到该患者是否被感染的预测模型中。如果<strong class="ix hj">外科医生的感染率</strong>仅通过使用我们预测的患者之前的手术来计算，就可以避免目标泄露。在训练数据中为每个手术计算这个可能有点棘手。</strong></p><p id="918f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果一个外科医生执行的所有<strong class="ix hj">手术</strong>都计算在内，包括那些来自测试集的手术，那么还有一个<strong class="ix hj">训练测试污染</strong>的问题。结果将是<strong class="ix hj">模型在测试集</strong>上看起来非常准确，即使在模型部署后<strong class="ix hj">不会很好地推广到新患者</strong>。这是因为外科医生风险特征考虑了测试集中的数据。测试集用于评估模型在看到新数据时的表现。所以这种污染违背了测试设备的目的。</p><h2 id="297d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated"><strong class="ak">学期考试准备</strong></h2><p id="5450" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我认为这个例子与<strong class="ix hj">数据泄露</strong>的情况有关，如果这种情况发生在现实生活中，它也会被证明是灾难性的。假设有一个学生正在准备他的学期考试。他期中考试考得很好，所以他了解课程内容和问题模式。到现在都很好。现在让我们假设一种情况，他以某种方式得到了<strong class="ix hj">泄露的学期试卷(泄露的数据)</strong>并出现在<strong class="ix hj">学期期末考试</strong>中。由于显而易见的原因，他在<strong class="ix hj">学期的期末考试</strong>中得了<strong class="ix hj">高分</strong>。现在，由于课程与工业项目直接相关，这意味着如果一个<strong class="ix hj">在课程</strong>中取得好成绩，这意味着候选人能够<strong class="ix hj">在完成任何现实生活中的工业项目</strong>中表现出色(基本上，考试的目的与创造现实生活中的工业经验是一致的)。现在的候选人<strong class="ix hj">在行业环境</strong> ( <strong class="ix hj">部署环境</strong>)中不能很好的表现 <strong class="ix hj">，因为他使用了不正当的手段通过考试。在这里，不公平的做法与<strong class="ix hj">数据泄露问题</strong>直接相关，尽管模型在培训和测试环境中表现良好，但<strong class="ix hj">在现实生产环境中会失败</strong>。</strong></p><p id="a95f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总的来说，这就是现实生活中的数据泄露现象。还可以有其他的用例。我在这里从<a class="ae iu" href="https://www.kaggle.com/code/alexisbcook/data-leakage/tutorial" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">得到了</strong> </a> <strong class="ix hj">的帮助。</strong></p><p id="1bf1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将在不久的将来继续上传更多的<strong class="ix hj">网络抓取、Python自动化、数据分析、机器学习、NLP、深度学习、使用云部署的端到端ML和DL项目，以及相关教程</strong>，因为我一直在努力学习、提升自己并分享我的工作。敬请期待，直到那时，请查看我的其他<a class="ae iu" rel="noopener" href="/@abhi2652254"> <strong class="ix hj">文章</strong> </a>，说<a class="ae iu" href="https://www.linkedin.com/in/obhinaba17/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">嗨</strong> </a>，<strong class="ix hj"> </strong>，让我知道你是否想要一个技术作家为你写作，我们可以通过一个简短的电话讨论。</p><p id="5cf9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，如果你喜欢我的工作，你可以捐赠给我几杯<a class="ae iu" href="https://ko-fi.com/abhinababanerjee" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">咖啡</strong> </a>，我可以在这个旅程中不断提高内容的质量。</p></div></div>    
</body>
</html>
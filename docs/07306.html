<html>
<head>
<title>Word similarity extraction with Machine learning Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习Python的词语相似度抽取</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/word-similarity-extraction-with-machine-learning-python-b90c8cfc7c73?source=collection_archive---------13-----------------------#2021-09-14">https://medium.com/geekculture/word-similarity-extraction-with-machine-learning-python-b90c8cfc7c73?source=collection_archive---------13-----------------------#2021-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="744d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习、深度学习和人工智能已经存在了十年，但是现在它比以往任何时候都更加明显，以至于每个人都在使用日常生活中的人工智能产品，如IG过滤器、网飞电影推荐、垃圾邮件检测等等。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/907e63801426f388f47f6e6991506191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PKizpeUoLkZCKdl_.jpg"/></div></div></figure><p id="288d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">近年来，这项技术主要用于市场营销，以获取、保留和发展客户。它过去是取代单调乏味和重复的任务，但现在它转向分析和创造性。令人惊讶的是，在人工智能驱动的初创企业中，文本提取的数量大幅增加。</p><p id="f434" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本是用户在互联网上表达想法或阅读产品内部文档的一种方式。对于我们来说，能够获得文本文档的有用信息是另一个层面，它对我们是有帮助的，并引导我们获得关于用户或消费者使用单词的更多信息。</p><p id="d8bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不想为你们修复数据，所以我会使用一种网络抓取技术，这样你就可以使用任何网站来进行单词相似度提取。</p><h1 id="9201" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用美汤获取数据</h1><p id="2446" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">Beautifulsoup是最强大的Python抓取库之一，它是从HTML、XML和其他标记语言网站获取数据的完美工具。要获得漂亮的效果，请在命令行中运行以下命令。对于那些喜欢探索更多关于这个库的人，请点击这里查看他们的网站。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="92f9" class="ky jq hi ku b fi kz la l lb lc">pip install beautifulsoup4</span></pre><p id="aa93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还需要安装“解析器”来解释网站内部的HTML元素。您可以运行pip来安装<strong class="ih hj"> lxml </strong>解析器。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="4151" class="ky jq hi ku b fi kz la l lb lc">pip install lxml</span></pre><p id="b279" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，导入从网站获取数据所需的库。一个是Beautifulsoup，它是bs4，另一个是urllib模块，它是用于处理获取URL的库。但是我们将只使用请求协议来打开和读取URL。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="aec4" class="ky jq hi ku b fi kz la l lb lc">import bs4 as bs<br/>import urllib.request</span></pre><p id="bbe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获取数据的代码分三步从维基百科网站获取数据(如果您愿意，可以选择任何其他网站)。</p><ol class=""><li id="09eb" class="ld le hi ih b ii ij im in iq lf iu lg iy lh jc li lj lk ll bi translated">用urllib发送URL请求来打开和读取网站，这里我用的是维基百科关于机器学习的内容，你只需要把参数改成你喜欢的任何网站。</li><li id="b18a" class="ld le hi ih b ii lm im ln iq lo iu lp iy lq jc li lj lk ll bi translated">用bs4解析器阅读这篇文章，这里是bs4将加载网站HTML的时候，然后我们将选择一个包含文本信息的部分，稍后进行处理。文本部分包含在HTML的段落标记中。</li><li id="c550" class="ld le hi ih b ii lm im ln iq lo iu lp iy lq jc li lj lk ll bi translated">得到段落标签后，我们需要删除HTML标记语言，只保留文本。</li></ol><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="c0aa" class="ky jq hi ku b fi kz la l lb lc"># send the url request to open and read the website<br/>scrapped_data = urllib.request.urlopen('<a class="ae ks" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/</a>Machine_learning')</span><span id="7fd8" class="ky jq hi ku b fi lr la l lb lc"># read the article with beautiful soup lxml parser<br/>article = scrapped_data.read()<br/>parsed_article = bs.BeautifulSoup(article,'lxml')</span><span id="d2e6" class="ky jq hi ku b fi lr la l lb lc"># parse only the paragraph tag inside the website HTML<br/>paragraphs = parsed_article.find_all('p')<br/></span><span id="c295" class="ky jq hi ku b fi lr la l lb lc"># get the string of the website from the paragraph tag<br/>article_text = ""<br/>for p in paragraphs:<br/>    article_text += p.text</span></pre><p id="5286" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你用和我一样的网址，你看到的会是这样的。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="e1fc" class="ky jq hi ku b fi kz la l lb lc">print(article_text)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/2067c0d1e23d3798998a4136f88e8c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3KyUahXyaMv5ldTxEhOgg.png"/></div></div></figure><h1 id="2db3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">文本预处理</h1><p id="603e" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">对于那些不熟悉文本的NLP或ML的人来说，在你开始获取单词相似度之前，我们要做的第一件事是将非结构化的文本准备成结构化的格式。我将使用自然语言工具包或NLTK来完成这项任务。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/a7019323726327748572fc1140fe0481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*empClzN19ZXvk1bz.jpeg"/></div></div></figure><p id="67b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在文本预处理或自然语言处理中，在我们可以在机器学习任务中使用文本之前，我们需要首先做一件事，这就是标记化。</p><p id="4c95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算机实际上不像人类那样理解文本或字符串，标记化所做的是将单词从句子中分离出来，以便计算机可以记住每个单词。然后，标记化的单词将被用作代码中用于计算的id或数字。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3151" class="ky jq hi ku b fi kz la l lb lc">import nltk<br/>nltk.download('punkt')</span><span id="de16" class="ky jq hi ku b fi lr la l lb lc">import string</span></pre><p id="b941" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在使用nltk时，模块的某些部分需要在pip安装之外手动下载。这里是“punkt”，这是标点符号化，它不纯粹从句子中标记单词，而是将标点符号考虑在内。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3ade" class="ky jq hi ku b fi kz la l lb lc">from nltk.corpus import stopwords<br/>from nltk.tokenize import sent_tokenize, word_tokenize</span><span id="037b" class="ky jq hi ku b fi lr la l lb lc">processed_article = article_text.lower()<br/>processed_article = re.sub(r'\s+', ' ', processed_article)<br/>processed_article = re.sub(r'[!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\]^_`{|}~]','', processed_article)</span><span id="2d72" class="ky jq hi ku b fi lr la l lb lc"># Preparing the dataset<br/>all_sentences = sent_tokenize(processed_article)</span><span id="a04a" class="ky jq hi ku b fi lr la l lb lc"># <br/>all_words = [word_tokenize(sent) for sent in all_sentences]</span></pre><p id="aa1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要做的另一件事是去除停用词，它是语言中纯粹为了语法用法而使用的一组词，对我们人类来说，它并不真正产生有意义的关系或洞察力。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="b186" class="ky jq hi ku b fi kz la l lb lc">import nltk<br/>from nltk.corpus import stopwords</span><span id="9245" class="ky jq hi ku b fi lr la l lb lc">nltk.download('stopwords')</span><span id="87f0" class="ky jq hi ku b fi lr la l lb lc"># Removing Stop Words<br/>stops = set(stopwords.words('english'))<br/>for i in range(len(all_words)):<br/>    all_words[i] = [w for w in all_words[i] if w not in stops]</span></pre><p id="0958" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们删除了停用词之后，我们可以通过使用Word2Vec模型，使用单词列表来计算文本相似性。</p><h1 id="0598" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Word2Vec</h1><p id="e224" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">Word2Vec是将单词转化为向量的算法。通过把它转换成向量，它允许这个词被计算、量化和测量。这允许一个词显示与另一个词的关系，彼此相距有多远。我们可以利用这一点来看我们文本中的这个单词和另一个单词有什么联系。</p><p id="351e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个词的相似性是很有见地的，因为当我们在生活中使用一个世界时，我们倾向于使用许多不同的词，但意思相同。同样，当你在网上销售你的产品时，你称它为来自你的公司“超级卖家”的“超级产品”。消费者喜欢你的产品，但通常他们会改变名称以适应他们的敌人，这将成为像“我只是一个绿色商店的SP。”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/a747de05cb979be5724abc71f0989350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*H2WQPZu-_fzIfDry.png"/></div></figure><p id="64f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，SP是“SuperProduct”的缩写，这是一种常见的人类交流，试图将语言的使用减少到仍然可以用于交流的水平。“绿色商店”是你的客户称之为你的公司或商店。就营销而言，这些信息很有见地，但大多数营销人员已经知道客户用来称呼他们的产品或公司的词。</p><p id="fe79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，每当公司向客户披露新信息时，这种事情总是会发生，让营销团队跟踪每个反馈意见的活动既费时又低效。真正的应用是使过程自动化，并减少营销人员寻找客户创建的这些新同义词的时间，以便营销人员能够致力于提高客户满意度、获取或目标重新定位。</p><h1 id="bf5f" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">单词相似度</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/4d76d05912f6158628d4848452ae587d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nxjINwyic27gOb8j.png"/></div></div></figure><p id="64c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Gensim是一个免费的开源Python库，用于将文档表示为语义向量，尽可能高效(对计算机而言)和无痛苦(对人类而言)。要对我们的数据使用word2vec算法，我们需要用我们的数据训练word2vec模型。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3adb" class="ky jq hi ku b fi kz la l lb lc">from gensim.models import Word2Vec</span><span id="0f8f" class="ky jq hi ku b fi lr la l lb lc">word2vec = Word2Vec(all_words, min_count=2)</span></pre><p id="d982" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导入Word2Vec模块，并将参数声明为我们的单词，以及将在模型中保留的最小计数或频率。训练时间取决于你的数据，但如果你和我使用相同的维基文本，应该不到几分钟。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7c4d" class="ky jq hi ku b fi kz la l lb lc">vocabulary = word2vec.wv.vocab</span></pre><p id="5668" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们创建模型之后，我们可以通过使用wv.vocab来访问所有要查询的单词，但是当我们想要查看单词相似性时，我们将使用wv.most_similar(str)。这里我把字符串“data”放在里面，看看和“data”有语义关系的词是什么。</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="9bb7" class="ky jq hi ku b fi kz la l lb lc">word2vec.wv.most_similar('data')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es et"><img src="../Images/d77b41bb59f851aefceed9e9a177abca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQ-NlaLkj6MfiF6QvWLtOw.png"/></div></div></figure><p id="acb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果显示与单词数据相关的所有单词，相似性得分从1到0，得分越高的单词越相似。看起来维基百科在特定的上下文中主题的变化很小。因此，相似性并没有反映到适用于现实世界的程度，但当我们去与更广泛和多样化的消费者数据打交道时，这将是一个挖掘关键词的巨大数据。</p><h1 id="ab62" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">感谢说明和进一步的工作</h1><p id="4130" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">感谢大家的阅读，如果你喜欢我的作品，请关注我以获取更多关于应用ML的文章。我目前正在做很多项目，但是如果你们想看什么特别的东西，我会为你们写一个评论。</p></div></div>    
</body>
</html>
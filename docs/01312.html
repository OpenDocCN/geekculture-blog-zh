<html>
<head>
<title>JavaScript: Objects &amp; Their Prototypes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript:对象及其原型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/javascript-objects-their-prototypes-99e0206edfba?source=collection_archive---------19-----------------------#2021-04-05">https://medium.com/geekculture/javascript-objects-their-prototypes-99e0206edfba?source=collection_archive---------19-----------------------#2021-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="8a52" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">简单看一下JS原型</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/3e89060a36f260a4e94d6349d03acfb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Y6qvgJ36t-S3Fqr"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sigmund</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3d64" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">又一周，又一次深入JavaScript。这个小系列可能会接近尾声，但不是在本周。哦，不，我的朋友们，我们将讨论JS原型。一些对我来说太陌生的东西，所以我显然会写信给大众，告诉他们我的发现。</p><p id="25e0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当我观察对象的<code class="du kk kl km kn b">__proto__</code>属性时，我试图更好地理解这个主题的第一个发现发生了有趣的转变。这绝对是我听说过的东西，但在我过去的项目中从来没有要求过。当我了解了使用这个属性的能力并考虑了我将为这个博客写些什么时，我发现这个特性不再被推荐了！MDN声明如下:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ko"><img src="../Images/2d7e47a883d821255652db8136e2bd21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFORTra1pr1Mp3TXgc8srg.png"/></div></div></figure><p id="8aff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我想我们今天都会学到一些新东西！下面说一下<code class="du kk kl km kn b">__proto__</code>属性的推荐替代方案。但是，首先，为什么不再推荐使用<code class="du kk kl km kn b">__proto__</code>访问器？我会让<a class="ae jn" href="https://javascript.info/" rel="noopener ugc nofollow" target="_blank"> JavaScript.info </a>的团队，由<a class="ae jn" href="https://javascript.info/profile/ilya-kantor" rel="noopener ugc nofollow" target="_blank"> Ilya Kantor </a>领导，来解释一下。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kp"><img src="../Images/179a68347d79fdd9219e2209b0b8f1b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WlCq1vJbBYGK_X5PVKFpPQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx"><a class="ae jn" href="https://javascript.info/prototype-methods#brief-history" rel="noopener ugc nofollow" target="_blank">Link</a></figcaption></figure></div><div class="ab cl kq kr gp ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="hb hc hd he hf"><p id="e76b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">好吧。我真正想写的东西，嗯，算是吧。现在，<code class="du kk kl km kn b">__proto__</code>已经被<code class="du kk kl km kn b">getPrototypeOf</code> / <code class="du kk kl km kn b">setPrototypeOf</code>所取代，让我们来看看这两个函数在处理JS对象时是如何帮助我们的。</p><p id="64e4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我们回顾一下之前<a class="ae jn" href="https://javascript.plainenglish.io/javascript-how-to-avoid-object-mutation-7cd733913a9f" rel="noopener ugc nofollow" target="_blank">博客中的对象，我们会发现:</a></p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="85a9" class="lb lc hi kn b fi ld le l lf lg">let character = {<br/>    firstName: 'Captain',<br/>    lastName: 'America'<br/>};</span><span id="a345" class="lb lc hi kn b fi lh le l lf lg">let avenger = character;</span><span id="2761" class="lb lc hi kn b fi lh le l lf lg">character.lastName = 'Marvel';</span></pre><p id="675a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">上面展示了在两个不同变量中持有的同一个对象。在博客中，我谈到了我们如何无意中改变了我们在复仇者中持有的对象，因为两个变量引用了同一个对象。那么，我们如何在使用上面讨论的原型函数的同时创建两个独特的对象呢？</p><p id="fd73" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，我们从字符变量引用的对象开始。</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="b565" class="lb lc hi kn b fi ld le l lf lg">let character = {<br/>    firstName: 'Captain',<br/>    lastName: 'America'<br/>};</span></pre><p id="2b4e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，让我们创建另一个对象，但是我们将使用角色对象作为这个新对象的原型。</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="3bdb" class="lb lc hi kn b fi ld le l lf lg">let avenger = Object.setPrototypeOf({}, character);</span><span id="5dd0" class="lb lc hi kn b fi lh le l lf lg">console.log(avenger.firstName);</span></pre><p id="e9c9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你认为控制台上会打印出什么？</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="6168" class="lb lc hi kn b fi ld le l lf lg">// Captain</span></pre><p id="9e61" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">是不是很酷！？我们从来没有设置过<code class="du kk kl km kn b">avenger.firstName</code>，但是JavaScript打印了除了<code class="du kk kl km kn b">undefined</code>以外的东西！这都与<code class="du kk kl km kn b">__proto__</code>的特殊属性有关。由于我们用原型<code class="du kk kl km kn b">character</code>设置了新创建的对象，JavaScript遍历原型链来寻找对我们的请求<code class="du kk kl km kn b">avenger.firstName</code>的回答。它首先检查由<code class="du kk kl km kn b">avenger</code>变量引用的对象是否有属性<code class="du kk kl km kn b">firstName</code>，意识到它没有，检查<code class="du kk kl km kn b">__proto__</code>属性，并返回保存在那里的值，即<code class="du kk kl km kn b">Captain</code>！这叫做<a class="ae jn" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Inheritance_and_the_prototype_chain#inheritance_with_the_prototype_chain" rel="noopener ugc nofollow" target="_blank">属性遮蔽</a>。伙计，哦，伙计。令人兴奋的东西。下面是在<code class="du kk kl km kn b">avenger</code>引用的对象的样子。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es li"><img src="../Images/dd24dbd70c4fb64ad378666a04af889c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*hIvyCG7VuXNPjSV7hiSm3w.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Our avenger object from the Chrome DevTools</figcaption></figure><p id="a470" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您会注意到该对象是用两个<code class="du kk kl km kn b">__proto__</code>属性创建的。上面列出的第一个是从字符变量引用的对象中创建的，也就是我们指定的那个。第二个<code class="du kk kl km kn b">__proto__</code>，通常称为<code class="du kk kl km kn b">[[Prototype]]</code>，是一个内部属性，它赋予我们可以在对象上使用的内部函数，比如<code class="du kk kl km kn b">toString</code> &amp; <code class="du kk kl km kn b">valueOf</code>。</p><p id="df8e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们需要确保我们的复仇者对象拥有<code class="du kk kl km kn b">'Marvel’</code>的<code class="du kk kl km kn b">lastName</code>。</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="65d4" class="lb lc hi kn b fi ld le l lf lg">avenger.lastName = 'Marvel';</span><span id="fa54" class="lb lc hi kn b fi lh le l lf lg">console.log(avenger.lastName);<br/>console.log(character.lastName;</span></pre><p id="7df2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你认为现在会发生什么？你认为我们改变了存储在<code class="du kk kl km kn b">character</code>的原始对象吗？<code class="du kk kl km kn b">avenger.lastName</code>现在有一个<code class="du kk kl km kn b">__proto__</code>属性引用了一个属性<code class="du kk kl km kn b">lastName</code>，它将打印到控制台？</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="2e70" class="lb lc hi kn b fi ld le l lf lg">// Marvel<br/>// America</span></pre><p id="71b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">哦，宝贝！看那个！我们现在有了我们想要的两个独特的对象，就像我以前的博客一样。这是我们创造物体同时避免变异的另一种方式。我现在将向你展示如何使用<code class="du kk kl km kn b">setPrototypeOf</code>方法一次性创建复仇者对象，而不是添加一行<code class="du kk kl km kn b">avenger.lastName = ‘Marvel’</code>。</p><pre class="iy iz ja jb fd kx kn ky kz aw la bi"><span id="0575" class="lb lc hi kn b fi ld le l lf lg">let character = {<br/>    firstName: 'Captain',<br/>    lastName: 'America'<br/>}</span><span id="7688" class="lb lc hi kn b fi lh le l lf lg">let avenger = Object.setPrototypeOf({lastName: 'Marvel'}, character)</span><span id="05d4" class="lb lc hi kn b fi lh le l lf lg">console.log(avenger.lastName);<br/>console.log(character.lastName);</span><span id="21a0" class="lb lc hi kn b fi lh le l lf lg">// Marvel<br/>// America</span></pre><p id="ff99" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">就这样，朋友们。<code class="du kk kl km kn b">setPrototypeOf</code>接受两个论点，使得使用另一个对象作为原型来创建对象变得轻而易举。显然，这很有趣。这是一种我们已经知道如何使用<code class="du kk kl km kn b">Object.create</code>的新方法，但是有点不同，因为<code class="du kk kl km kn b">avenger.firstName</code>属性实际上来自我们的<code class="du kk kl km kn b">character</code>对象。事实上，如果我们改变我们的<code class="du kk kl km kn b">character</code>对象属性中的任何值，它也会改变<code class="du kk kl km kn b">avenger</code>对象的输出。您可以看到当以这种方式使用原型时，这是如何成为一个问题的。原型可能很有趣，但是…</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lj lk l"/></div></figure></div></div>    
</body>
</html>
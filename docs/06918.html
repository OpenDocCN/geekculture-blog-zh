<html>
<head>
<title>Build &amp; Deploy your software using CircleCI.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CircleCI构建和部署您的软件。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/build-deploy-your-software-using-circleci-4e3c0cc870cd?source=collection_archive---------20-----------------------#2021-09-01">https://medium.com/geekculture/build-deploy-your-software-using-circleci-4e3c0cc870cd?source=collection_archive---------20-----------------------#2021-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2963ceafc12a784399ff417f41c4d0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRAGcBNgyBO8xlCC2hZItA.png"/></div></div></figure><p id="d284" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将熟悉CircleCI，以及如何使用它来自动化我们的部署。您可以通过CircleCi执行任何软件进入生产所需的所有步骤，即<strong class="is hj">构建</strong>、<strong class="is hj">测试</strong>和<strong class="is hj">部署。</strong>在这篇文章中，我们将跳过测试步骤。</p><h1 id="b6d3" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">目标</h1><ul class=""><li id="8dae" class="km kn hi is b it ko ix kp jb kq jf kr jj ks jn kt ku kv kw bi translated">让你熟悉CircleCI。</li><li id="d5db" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">在CircleCI环境中构建一个React项目。</li><li id="1227" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">在Heroku服务器上部署React项目。</li></ul><h1 id="fded" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">什么是CircleCI？</h1><p id="d948" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">CircleCI是一个现代工具，用于项目的<a class="ae lf" href="https://www.atlassian.com/continuous-delivery/principles/continuous-integration-vs-delivery-vs-deployment" rel="noopener ugc nofollow" target="_blank">持续集成和持续部署</a> (CI/CD)。您可以在个人云中设置它，并在有限的时间内使用它。</p><p id="e0cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以通过访问<a class="ae lf" href="https://circleci.com/vcs-authorize/" rel="noopener ugc nofollow" target="_blank">https://circleci.com/vcs-authorize/</a>在CircleCI上创建一个账户，并使用Github或Bitbucket登录。</p><p id="55b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过Github或Bitbucket登录会要求访问您的存储库的权限，并自动将您的所有存储库导入到CircleCI仪表板中。</p><p id="04a4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，让我简单介绍一下CircleCI的主要元素。</p><h2 id="9549" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">管道—</h2><p id="6cef" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">管道是在您触发项目工作时运行的一整套流程。管道包含工作流，而工作流又与作业相协调。</p><h2 id="1b24" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">球体—</h2><p id="e034" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">orb是代码片段，可以帮助您自动化重复的过程，加快项目设置，并且易于与第三方工具集成。</p><h2 id="30e2" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">工作—</h2><p id="232c" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">工作是你管道的组成部分。作业是步骤的集合，根据需要运行命令/脚本。并且每个作业必须有一个可以是VM或容器的执行器。</p><h2 id="b552" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">遗嘱执行人—</h2><p id="772d" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">您的配置中定义的每个作业都将在一个唯一的执行器中运行。此外，执行器可以是Docker容器或运行Linux、Windows或macOS的虚拟机。</p><h2 id="594a" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">步骤—</h2><p id="e24e" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">步骤是完成一项工作所需的一组动作。步骤通常是可执行命令的集合，CircleCI提供了内置步骤，您可以使用例如<em class="lu"> checkout </em>。</p><h2 id="7070" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">工作流程—</h2><p id="4fb1" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">工作流是作业的集合，可以以并发、顺序或预定的方式运行这些作业。</p><p id="b5d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望到现在为止，您已经对CircleCI有了足够的了解，可以为您的项目建立一个CI/CD。</p><h1 id="8827" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">在CircleCI环境下构建ReactJS项目</h1><p id="6f17" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">接下来，我们将为React项目设置CircleCI，这是一个React应用程序示例，它位于Github(<a class="ae lf" href="https://github.com/mountainfirefly/search-yc-top-companies" rel="noopener ugc nofollow" target="_blank">https://github.com/mountainfirefly/search-yc-top-companies</a>)上。</p><p id="5d58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">稍后，我将托管一个web应用程序来搜索YC关于回购的顶级公司，现在它只是呈现一个样本react应用程序。</p><h2 id="0804" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated">创建一个Heroku应用程序来托管React项目</h2><p id="8723" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">在这一步中，我们需要创建一个Heroku应用程序来托管React项目，为此我们将使用Heroku命令行。</p><p id="5ce9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您的计算机上没有Heroku CLI，您可以使用下面的命令安装它。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="849b" class="lg jp hi ma b fi me mf l mg mh">$ npm i -g heroku</span></pre><p id="eae9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以登录你的Heroku账户，然后会打开一个浏览器询问凭证</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="d402" class="lg jp hi ma b fi me mf l mg mh">$ heroku login</span></pre><p id="950a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们将使用buildpack部署React项目，如果您不知道build pack，它们只是一组用于在Heroku上编译应用程序的脚本。你可以在这里阅读更多关于构建包<a class="ae lf" href="https://devcenter.heroku.com/articles/buildpacks" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="f79f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的例子中，我们将使用create-react-app-buildpack来部署react项目。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="1153" class="lg jp hi ma b fi me mf l mg mh">$ heroku create yc-top-companies --buildpack <a class="ae lf" href="https://github.com/mars/create-react-app-buildpack.git" rel="noopener ugc nofollow" target="_blank">https://github.com/mars/create-react-app-buildpack.git</a></span></pre><p id="9012" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个命令将输出一个属于你的Heroku应用程序的URL，你可以把它放在你的浏览器中检查是否一切运行顺利。</p><h2 id="d91b" class="lg jp hi bd jq lh li lj ju lk ll lm jy jb ln lo kc jf lp lq kg jj lr ls kk lt bi translated"><strong class="ak"> CircleCI配置</strong></h2><p id="74a9" class="pw-post-body-paragraph iq ir hi is b it ko iv iw ix kp iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">现在，我们将为我们的项目创建CircleCI配置文件，并转到您的项目。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="fa6e" class="lg jp hi ma b fi me mf l mg mh">$ cd search-yc-top-companies/</span></pre><p id="048e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要添加的第一件事是一个配置文件，它将告诉CircleCI如何构建我们的React项目。这个配置文件需要添加到我们项目根目录下的<code class="du mi mj mk ma b">.circleci</code>目录中，命名为<code class="du mi mj mk ma b">config.yml</code>。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="d7af" class="lg jp hi ma b fi me mf l mg mh">$ mkdir .circleci</span></pre><p id="c577" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里是<code class="du mi mj mk ma b">config.yml</code></p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="acbc" class="lg jp hi ma b fi me mf l mg mh">version: 2.1</span><span id="ee8b" class="lg jp hi ma b fi ml mf l mg mh">orbs:<br/>  heroku: circleci/heroku@0.0.10</span><span id="2a36" class="lg jp hi ma b fi ml mf l mg mh">jobs:<br/>  build:<br/>    docker:<br/>      - image: circleci/node:10.16.3<br/>    working_directory: ~/search-yc-top-companies<br/>    steps:<br/>      - checkout<br/>      # install dependencies<br/>      - run:<br/>          name: Install Dependencies<br/>          command: npm install<br/>      - run:<br/>          name: Build<br/>          command: npm run build</span><span id="a428" class="lg jp hi ma b fi ml mf l mg mh">workflows:<br/>  heroku_deploy:<br/>    jobs:<br/>      - build<br/>      - heroku/deploy-via-git: # Use the pre-configured job, deploy-via-git<br/>          requires:<br/>            - build<br/>          filters:<br/>            branches:<br/>              only: master</span></pre><p id="ab04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个非常简单的配置文件，我们在其中有两个任务<code class="du mi mj mk ma b">build</code>和<code class="du mi mj mk ma b">heroku/deploy-via-git</code>。</p><p id="7d21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦这个配置文件创建完成，现在提交并将其推送到Github存储库。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="7f1d" class="lg jp hi ma b fi me mf l mg mh">$ git add .circleci<br/>$ git commit -m "Add circleci configuration"<br/>$ git push origin master</span></pre><p id="f5b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将转到CircleCI仪表板，并执行以下步骤:-</p><ul class=""><li id="1693" class="km kn hi is b it iu ix iy jb mm jf mn jj mo jn kt ku kv kw bi translated">点击左侧菜单上的<code class="du mi mj mk ma b">Add Projects</code>项</li><li id="de8b" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">搜索<code class="du mi mj mk ma b">search-yc-top-companies</code> Github项目</li><li id="136e" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">点击右侧的<code class="du mi mj mk ma b">Set up Project</code>按钮。</li><li id="243d" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">接下来，它会要求您提供一个包含circleci配置的分支，另一个选项是创建一个分支。在我们的例子中，我们已经有了它，所以选择<code class="du mi mj mk ma b">master</code>。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/364589ba36d01e5ca9afce5466ecefd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WBWI6c2oTgfINqYjTPTysQ.png"/></div></div></figure><p id="b2ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦完成，接下来我们必须链接Heroku和CircleCI，为此，您需要从Heroku仪表板添加您的应用程序名称和API密钥。</p><p id="82c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述详细信息可在Heroku仪表板上找到</p><ul class=""><li id="fcd0" class="km kn hi is b it iu ix iy jb mm jf mn jj mo jn kt ku kv kw bi translated">应用程序名称可在仪表板项目列表iteself中找到。</li><li id="cb37" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">对于API密匙，进入你的账户设置，向下滚动到API密匙部分，你会找到它。</li></ul><p id="eb66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按照以下步骤将这些变量添加到CircleCI环境变量中</p><ul class=""><li id="77c5" class="km kn hi is b it iu ix iy jb mm jf mn jj mo jn kt ku kv kw bi translated">现在转到CircleCI仪表板</li><li id="9a8c" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">点击项目下屏幕右侧的<code class="du mi mj mk ma b">Project Settings</code>按钮。</li><li id="c1d2" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">选择左边的<code class="du mi mj mk ma b">Environment Variables</code>菜单。</li><li id="f0b4" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">点击<code class="du mi mj mk ma b">Add Environment Variable</code>按钮。</li><li id="2d11" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">对于应用程序名称，输入名称字段作为<code class="du mi mj mk ma b">HEROKU_APP_NAME</code>，并在值的位置输入您的Heroku应用程序名称。</li><li id="f9ba" class="km kn hi is b it kx ix ky jb kz jf la jj lb jn kt ku kv kw bi translated">对于API键，输入名称字段为<code class="du mi mj mk ma b">HEROKU_API_KEY</code>，而不是我们之前讨论过的值API键，您可以在Heroku的帐户设置中获得。</li></ul><figure class="lv lw lx ly fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/6576b60761a29ec2b391b694a14ea606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IYNZ9ATF6hVzdmb9jWHrZg.png"/></div></div></figure><p id="60c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你正确地遵循了上述步骤，一切都会好的😁。</p><p id="18e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在转到你的CircleCI项目，点击<code class="du mi mj mk ma b">Run Pipeline</code>，在它成功完成后，打开你的Heroku应用程序URL，你会看到一个样本react应用程序在那里运行。</p><p id="20d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在是时候体验持续集成和持续部署的力量了，在本地机器上进入react项目并进行更改，然后将其推送到GitHub。</p><p id="4053" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你在CircleCI仪表板上，你会看到管道被自动触发，过一会儿，Heroku应用程序应该会根据你在本地机器上所做的最新更改进行更新。</p><p id="514e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你们喜欢这篇文章，就像我喜欢写它一样。</p><p id="a332" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将为此写一篇后续文章，其中我们将集成Slack并获得构建部署状态的通知。</p><p id="0c95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请继续关注，我们会不时发布更多这样的文章，你也可以查看我的网站<a class="ae lf" href="https://mountainfirefly.dev/" rel="noopener ugc nofollow" target="_blank"> mountainfirefly.dev </a>，我在那里写了很多这样的文章。</p><p id="3684" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你在阅读这篇文章时遇到任何问题，可以在Twitter @mountainfirefly上联系我。</p><p id="1212" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">感谢</strong>阅读！！</p></div></div>    
</body>
</html>
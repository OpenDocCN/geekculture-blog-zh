<html>
<head>
<title>Creating a Reactive CRUD todo app with Kotlin, MongoDB, Panache and Quarkus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Kotlin、MongoDB、Panache和Quarkus创建一个反应式CRUD todo应用程序</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/building-a-reactive-crud-todo-app-with-kotlin-mongodb-panache-and-quarkus-1bcac2335e23?source=collection_archive---------7-----------------------#2021-07-31">https://medium.com/geekculture/building-a-reactive-crud-todo-app-with-kotlin-mongodb-panache-and-quarkus-1bcac2335e23?source=collection_archive---------7-----------------------#2021-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a0bc1ceb4eed0def1a12ec99ada0f225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXIqBoA4alshS5yaUH2eGA.jpeg"/></div></div></figure><div class=""/><p id="295c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://kotlinlang.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Kotlin </strong> </a> <strong class="is hu"> </strong>是一种非常流行的编程语言，目标是<strong class="is hu"> JVM </strong>(以及其他环境)。Kotlin在过去几年里经历了一次流行的激增，使它成为最流行的JVM语言，当然除了Java。在基于<strong class="is hu"> Quarkus </strong>的项目中拥有<strong class="is hu"> Kotlin </strong>可以给我们带来更多好处，同时仍然有可能使用来自<strong class="is hu"> Quarkus </strong>生态系统的其他扩展。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es jp"><img src="../Images/bc128b7ffb79db90ae4014ec9d76c2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/0*czB4qSTIOoL9jzwu.png"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">kotlinlang.org</figcaption></figure><p id="6044" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Quarkus为Kotlin和一个<strong class="is hu"> MongoDB Panache Kotlin </strong>扩展一起使用提供了出色的支持，该扩展以一种反应方式无缝地与反应<strong class="is hu"> Panache </strong>实体一起工作时，给用户一些熟悉感。本指南提供了使用该扩展的简单实践经验。</p><figure class="jq jr js jt fd hk er es paragraph-image"><div class="er es jy"><img src="../Images/0070f6a815d074063ef44e82644ff27a.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/0*i1EEXCpkL8zWVi-O.png"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">code.quarkus.io</figcaption></figure><h1 id="9215" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">先决条件</h1><ul class=""><li id="1535" class="kx ky ht is b it kz ix la jb lb jf lc jj ld jn le lf lg lh bi translated">码头工人</li><li id="9b93" class="kx ky ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">Java 8+</li><li id="418f" class="kx ky ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">Maven ≥ 3.6.2</li><li id="3007" class="kx ky ht is b it li ix lj jb lk jf ll jj lm jn le lf lg lh bi translated">科特林≥ 1.5.21</li></ul></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="9cf6" class="jz ka ht bd kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">Quarkus扩展</h1><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="a26a" class="me ka ht ma b fi mf mg l mh mi">$ ./mvnw quarkus:add-extension -Dextensions="quarkus-mongodb-panache-kotlin,quarkus-resteasy-reactive-jackson,quarkus-resteasy-reactive"</span></pre><h1 id="d8ef" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">开发服务的最低配置</h1><p id="aa8e" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">当您开发或测试应用程序时，开发服务会自动启动所需的容器。在我们的例子中，它将把<strong class="is hu"> MongoDB </strong>数据库开箱即用。仅需要在<strong class="is hu"> application.properties </strong>文件中进行配置。</p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="14ba" class="me ka ht ma b fi mf mg l mh mi">quarkus.mongodb.database = todos</span></pre><p id="6aa5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就是这样！当运行<strong class="is hu">开发服务时</strong>将根据所提供的扩展使用<strong class="is hu"> Testcontainers </strong>旋转特定的数据库。</p><h1 id="ac5a" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">派头和科特林</h1><p id="a7c5" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">在<strong class="is hu"> MongoDB Panache </strong>指南中，简要提到了两种设计模式方法，即<strong class="is hu">活动记录模式</strong>和<strong class="is hu">存储库模式</strong>。使用Kotlin，我们可以从两者中选择一个稍有变化的。在Kotlin版本中，使用<code class="du mm mn mo ma b"><strong class="is hu">companion object</strong></code>提供活动记录模式。</p><p id="3365" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">伴随对象</strong>包含所有与特定实例无关的方法，允许一般管理和查询绑定到特定类型。有多种选择，但目前是<code class="du mm mn mo ma b">lateinit</code>方法。这允许我们将这些字段声明为非空，因为我们知道它们将由构造函数(未显示)或从数据库加载数据的<strong class="is hu"> MongoDB POJO编解码器</strong>正确分配。</p><h1 id="eb1d" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">科特林和杰克逊</h1><p id="7eb1" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">在本指南中，我们将使用<strong class="is hu"> rest-easy-jackson </strong>扩展。如果<code class="du mm mn mo ma b">com.fasterxml.jackson.module:jackson-module-kotlin</code>依赖项和<code class="du mm mn mo ma b">quarkus-jackson</code>扩展(或<code class="du mm mn mo ma b">quarkus-resteasy-jackson</code>扩展)已经被添加到项目中，那么Quarkus会自动将<code class="du mm mn mo ma b">KotlinModule</code>注册到<code class="du mm mn mo ma b">ObjectMapper</code> bean中(参见<a class="ae jo" href="https://quarkus.io/guides/rest-json#jackson" rel="noopener ugc nofollow" target="_blank">本</a>指南了解更多细节)。</p><h1 id="6a06" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">反应性实体和储存库</h1><p id="8931" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">带有<strong class="is hu"> Panache </strong>的<strong class="is hu"> MongoDB </strong>允许对实体和存储库使用反应式实现。为此，在定义您的实体:<code class="du mm mn mo ma b">ReactivePanacheMongoEntity</code>或<code class="du mm mn mo ma b">ReactivePanacheMongoEntityBase</code>，以及定义您的存储库:<code class="du mm mn mo ma b">ReactivePanacheMongoRepository</code>或<code class="du mm mn mo ma b">ReactivePanacheMongoRepositoryBase</code>时，您需要使用反应变量。</p><blockquote class="mp mq mr"><p id="b507" class="iq ir ms is b it iu iv iw ix iy iz ja mt jc jd je mu jg jh ji mv jk jl jm jn hb bi translated">MongoDB with Panache的反应式API使用哗变反应式类型。如果你不熟悉哗变，查看<a class="ae jo" href="https://quarkus.io/guides/mutiny-primer" rel="noopener ugc nofollow" target="_blank">哗变——一个直观的反应式编程库</a>。</p></blockquote><h1 id="ffcc" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">问题域</h1><p id="c4d2" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">在这个场景中，我们将使用包含实体方法的<strong class="is hu">活动记录模式</strong>。这将是一个典型的待办事项列表应用程序，具有包含待办事项的待办事项列表。没什么特别的，只是给出一个关于从哪里开始以及如何对不同的实体和它们的操作建模的想法。</p><h1 id="a50a" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">TodoList反应式Panache MongoDB实体</h1><p id="d49b" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">这是我们的<strong class="is hu"> TodoList </strong>实体及其包含由<strong class="is hu">small rye-哗变</strong>提供的不同反应方法的伙伴对象。使用<strong class="is hu"> smallrye哗变</strong>将conscise Kotlin代码和优雅的流处理这两个世界混合起来有几个好处。</p><figure class="jq jr js jt fd hk"><div class="bz dy l di"><div class="mw mx l"/></div></figure><h1 id="dcc5" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">待办事项实体</h1><figure class="jq jr js jt fd hk"><div class="bz dy l di"><div class="mw mx l"/></div></figure><h1 id="27f7" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">待办事项列表API资源</h1><p id="c46f" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">我们定义的所有可用的支持API调用。</p><figure class="jq jr js jt fd hk"><div class="bz dy l di"><div class="mw mx l"/></div></figure></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="30ea" class="jz ka ht bd kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">运行应用程序</h1><p id="a1e0" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">从现在开始，只需要运行带有实时编码预览的quarkus应用程序。</p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="1f58" class="me ka ht ma b fi mf mg l mh mi">$ ./mvnw compile quarkus:dev</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="5f82" class="jz ka ht bd kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">API调用</h1><p id="fde9" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">下面是我们可以对反应式API端点进行的API调用。</p><p id="5b0c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个<strong class="is hu">待办事项列表</strong></p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="2964" class="me ka ht ma b fi mf mg l mh mi">$ curl -X POST "localhost:8080/v1/todos"</span><span id="b313" class="me ka ht ma b fi my mg l mh mi">{"name":"Travel"}</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><p id="73da" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">获取所有<strong class="is hu">待办事项列表</strong></p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="2fa2" class="me ka ht ma b fi mf mg l mh mi">$ curl "localhost:8080/v1/todos"</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><p id="76fc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将<strong class="is hu">待办事项</strong>添加到<strong class="is hu">待办事项列表</strong></p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="23be" class="me ka ht ma b fi mf mg l mh mi">$ curl -X PUT "localhost:8080/v1/todos/61054ea7c547c3533bc06a25"<br/><br/>{<br/>    {"title":"Hotelbooking","description":"Somewhere to stay"}<br/>}</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><p id="6b64" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过<strong class="is hu">待办事项列表</strong> id和<strong class="is hu">待办事项</strong> Id完成一个<strong class="is hu">待办事项</strong>项</p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="9e4a" class="me ka ht ma b fi mf mg l mh mi">$ curl -X PUT "localhost:8080/v1/todos/610547059137493daac0367a/3b955596-442d-481a-947b-396d06bdd7b4/complete"</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><p id="af76" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按id删除<strong class="is hu">待办事项列表</strong></p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="92f3" class="me ka ht ma b fi mf mg l mh mi">$ curl -X DELETE "localhost:8080/v1/todos/60db4b085d2d613300cc136b"</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="d2cb" class="jz ka ht bd kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">示例响应</h1><p id="99e5" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">获取所有<strong class="is hu">待办事项列表</strong></p><pre class="jq jr js jt fd lz ma mb mc aw md bi"><span id="b4f9" class="me ka ht ma b fi mf mg l mh mi">[<br/>   {<br/>      "id":"61054ea1c547c3533bc06a24",<br/>      "name":"Groceries",<br/>      "todos":[<br/>         {<br/>            "title":"Avocado",<br/>            "description":"Something Interesting",<br/>            "created":"2021-07-31",<br/>            "id":"3acf9399-55cc-4418-af07-4b194ef37b8b",<br/>            "completed":true<br/>         },<br/>         {<br/>            "title":"Bananas",<br/>            "description":"Something nice",<br/>            "created":"2021-07-31",<br/>            "id":"ea1ebf70-62df-47a6-b5e4-f4a4c73c9eb1",<br/>            "completed":false<br/>         }<br/>      ]<br/>   },<br/>   {<br/>      "id":"61054ea7c547c3533bc06a25",<br/>      "name":"Travel",<br/>      "todos":[<br/>         {<br/>            "title":"Hotelbooking",<br/>            "description":"Somewhere to stay",<br/>            "created":"2021-07-31",<br/>            "id":"3be2f3cc-32ea-4553-b099-45f6a3a440e0",<br/>            "completed":false<br/>         }<br/>      ]<br/>   }<br/>]</span></pre></div><div class="ab cl ln lo gp lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="hb hc hd he hf"><h1 id="5772" class="jz ka ht bd kb kc lu ke kf kg lv ki kj kk lw km kn ko lx kq kr ks ly ku kv kw bi translated">科特林协同作战和兵变</h1><p id="7cf4" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb mj jd je jf mk jh ji jj ml jl jm jn hb bi translated">Kotlin协同例程提供了一个命令式编程模型，它实际上是以异步、反应式的方式执行的。如果你想深入研究夸库和科特林，特别是协程。有一个模块<code class="du mm mn mo ma b">io.smallrye.reactive:mutiny-kotlin</code>，这里描述的<a class="ae jo" href="https://smallrye.io/smallrye-mutiny/guides/kotlin" rel="noopener ugc nofollow" target="_blank">是</a>。</p><p id="b7ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想看这个项目的完整源代码，你可以在GitHub上找到。</p><p id="66ce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://github.com/dvddhln/quarkus-kotlin-reactive-mongodb" rel="noopener ugc nofollow" target="_blank">在这里找到GitHub源码项目</a></p><p id="5ba2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其他有用的资源可以在下面的链接中找到。</p><p id="964c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">祝你好运！</p><div class="hh hi ez fb hj mz"><a href="https://quarkus.io/guides/kotlin" rel="noopener  ugc nofollow" target="_blank"><div class="na ab dw"><div class="nb ab nc cl cj nd"><h2 class="bd hu fi z dy ne ea eb nf ed ef hs bi translated">夸库斯-使用科特林</h2><div class="ng l"><h3 class="bd b fi z dy ne ea eb nf ed ef dx translated">当没有选择Kotlin时，生成的pom.xml相对于它的对应物包含以下修改:</h3></div><div class="nh l"><p class="bd b fp z dy ne ea eb nf ed ef dx translated">quarkus.io</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn hp mz"/></div></div></a></div><div class="hh hi ez fb hj mz"><a href="https://quarkus.io/guides/mongodb-panache-kotlin" rel="noopener  ugc nofollow" target="_blank"><div class="na ab dw"><div class="nb ab nc cl cj nd"><h2 class="bd hu fi z dy ne ea eb nf ed ef hs bi translated">Quarkus -带有Panache和Kotlin的简化MongoDB</h2><div class="ng l"><h3 class="bd b fi z dy ne ea eb nf ed ef dx translated">正如我们在MongoDB with Panache指南中看到的，它允许我们扩展我们的实体和存储库中的功能…</h3></div><div class="nh l"><p class="bd b fp z dy ne ea eb nf ed ef dx translated">quarkus.io</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn hp mz"/></div></div></a></div><div class="hh hi ez fb hj mz"><a href="https://quarkus.io/guides/mongodb-panache" rel="noopener  ugc nofollow" target="_blank"><div class="na ab dw"><div class="nb ab nc cl cj nd"><h2 class="bd hu fi z dy ne ea eb nf ed ef hs bi translated">Quarkus -简化的MongoDB</h2><div class="ng l"><h3 class="bd b fi z dy ne ea eb nf ed ef dx translated">Kotlin数据类是定义数据载体类的一种非常方便的方式，使它们成为定义数据载体类的一个很好的匹配</h3></div><div class="nh l"><p class="bd b fp z dy ne ea eb nf ed ef dx translated">quarkus.io</p></div></div><div class="ni l"><div class="np l nk nl nm ni nn hp mz"/></div></div></a></div></div></div>    
</body>
</html>
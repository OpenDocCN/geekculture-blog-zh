<html>
<head>
<title>Setup your Rust-React project and deploy it to Heroku.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设置Rust-React项目并将其部署到Heroku。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/setup-your-rust-react-project-and-deploy-it-to-heroku-888a16d603ea?source=collection_archive---------5-----------------------#2021-05-24">https://medium.com/geekculture/setup-your-rust-react-project-and-deploy-it-to-heroku-888a16d603ea?source=collection_archive---------5-----------------------#2021-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/be86732c085191a48ed0137d8d094a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HFvkhuE82edRBM1ZaNhhSQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">#Rustacean</figcaption></figure><p id="9636" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我花了一周时间学习铁锈的基本知识。作为一个学习实验，我决定在Rust中构建一个简单的后端，与我在React中构建的前端进行交互。Rust没有在Heroku上列出的官方支持的构建包，因此，部署过程没有很好的记录。这肯定不是火箭科学，但我想分享我的学习，因为我花了一些时间来收集资源和成功部署我的应用程序。</p><p id="6353" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">该项目将在您的前端和后端之间建立尽可能简单的交互，并将其部署到Heroku。我希望你能够重复这个设置，发射一个比我在这个指南中更酷的火箭！🚀</p><p id="49c8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们创建一个新的react应用程序。我们将把React应用程序放在一个名为“前端”的文件夹中。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es js"><img src="../Images/22173cde01a7b2d73abc8906b84d960a.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*kqyaU6uVxQFzktSrWZE7KA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae jx" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank">https://create-react-app.dev/</a></figcaption></figure><p id="5dbb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们将创建我们的Rust服务器。这是假设你的电脑上安装了Rust。如果没有，下面是链接:<a class="ae jx" href="https://www.rust-lang.org/tools/install" rel="noopener ugc nofollow" target="_blank"><em class="jy"/></a></p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="3ad3" class="ke kf hi ka b fi kg kh l ki kj">cargo new rust-server --bin</span></pre><p id="a167" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这将为我们创建一个“Hello World”示例。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/3163319f17e872239eceaf59572f2132.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*g5xe9apaujbGjULhme0MZQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae jx" href="https://doc.rust-lang.org/cargo/guide/creating-a-new-project.html" rel="noopener ugc nofollow" target="_blank">https://doc.rust-lang.org/cargo/guide/creating-a-new-project.html</a></figcaption></figure><p id="d62b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们进入我们的后端文件夹，运行“货物运行”，我们应该看到“你好，世界！”在我们的终点站。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/4b3ba6705a3d83dce932f28002ad9230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BzkBvn3ZYqLUggMbghtGA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Great success!</figcaption></figure><p id="7c4c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在为了使用火箭🚀我们需要使用Rust的“夜间”版本。我们通过在终端中运行以下命令来安装“nightly”。</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="330d" class="ke kf hi ka b fi kg kh l ki kj">rustup toolchain install nightly</span></pre><p id="cfe4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">其次是:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="e761" class="ke kf hi ka b fi kg kh l ki kj">rustup default nightly</span></pre><p id="b19d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在如果你跑:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="04a2" class="ke kf hi ka b fi kg kh l ki kj">rustc --version</span></pre><p id="f956" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您应该看到我们使用的版本是夜间版本:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/31a4e997a591f54ebc21730e7c283653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_egRIqHTcS4hE0sDa-NOA.png"/></div></div></figure><p id="1c67" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们现在将添加Rocket作为项目依赖项。火箭🚀是一个允许我们在Rust中构建网络应用的框架。在Rust中，我们在Cargo.toml文件中处理依赖关系。通过将Rocket添加到列表中，将其作为依赖项添加:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="3f58" class="ke kf hi ka b fi kg kh l ki kj">[package]</span><span id="369f" class="ke kf hi ka b fi kn kh l ki kj">name = "back-end"</span><span id="5aba" class="ke kf hi ka b fi kn kh l ki kj">version = "0.1.0"</span><span id="de85" class="ke kf hi ka b fi kn kh l ki kj">edition = "2018"</span><span id="d69b" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">[dependencies]</strong></span><span id="d35f" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">rocket = "0.4.10"</strong></span></pre><p id="0fda" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">回到我们的“main.rs”文件中，我们将复制粘贴“Hello World”示例到Rocket中🚀文档。我们的main.rs现在看起来像这样:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="4fe8" class="ke kf hi ka b fi kg kh l ki kj">#![feature(proc_macro_hygiene, decl_macro)]<br/><br/>#[macro_use] extern crate rocket;</span><span id="165e" class="ke kf hi ka b fi kn kh l ki kj"><br/>#[get("/")]</span><span id="7b01" class="ke kf hi ka b fi kn kh l ki kj">fn index() -&gt; &amp;'static str {</span><span id="5351" class="ke kf hi ka b fi kn kh l ki kj">"Hello, world!"</span><span id="1fe1" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="8f73" class="ke kf hi ka b fi kn kh l ki kj">#[get("/api/myrocket")]</span><span id="879a" class="ke kf hi ka b fi kn kh l ki kj">fn myrocket() -&gt; String {</span><span id="3abc" class="ke kf hi ka b fi kn kh l ki kj">"My 🚀 server".to_string()</span><span id="c772" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="cd01" class="ke kf hi ka b fi kn kh l ki kj">fn main() {<br/>    rocket::ignite().mount("/", routes![index, myrocket]).launch();<br/>}</span></pre><p id="8e81" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们将通过运行以下命令来启动服务器:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="a7c2" class="ke kf hi ka b fi kg kh l ki kj">cargo run</span></pre><p id="9b3e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这一次，您的终端将开始安装rocket，并在安装结束时向您显示以下消息:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/97a23d09ffea22400a3be3199cec08d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FfCo8XZ0AMAsi-cLfYYryg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Our server is running on localhost 8000!</figcaption></figure><p id="0e9f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们检查一下我们的服务器！</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kp"><img src="../Images/ed0f9f97ae747677083d655be8d86882.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*aKOP8FFKk10RQN9YWclFZw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae jx" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/</a></figcaption></figure><p id="53d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们现在要把这个变成“你好，世界！”通过从我们刚刚创建的服务器获取数据，消息出现在我们的前端。</p><p id="2048" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将让我们的火箭服务器运行，同时我们打开一个新的终端窗口。运行以下命令:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="1336" class="ke kf hi ka b fi kg kh l ki kj">cd front-end<br/>npm start</span></pre><p id="3849" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您访问您的本地主机，您应该会看到旋转的react徽标。</p><p id="ce8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们将尝试从我们的火箭服务器获取数据。</p><p id="d5f0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在app.js中，我们将使用axios向运行在localhost 8000上的服务器发出http请求。如果您也选择使用axios，您将必须安装依赖项并导入它！</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9ebe" class="ke kf hi ka b fi kg kh l ki kj">function App() {</span><span id="2623" class="ke kf hi ka b fi kn kh l ki kj">const getData = async () =&gt; {</span><span id="e90a" class="ke kf hi ka b fi kn kh l ki kj">const response = await axios("http://localhost:8000/myrocket");</span><span id="9b8d" class="ke kf hi ka b fi kn kh l ki kj">console.log(response.data);</span><span id="ab69" class="ke kf hi ka b fi kn kh l ki kj">};</span><span id="cbf7" class="ke kf hi ka b fi kn kh l ki kj">useEffect(() =&gt; {</span><span id="a624" class="ke kf hi ka b fi kn kh l ki kj">getData();</span><span id="00e7" class="ke kf hi ka b fi kn kh l ki kj">}, []);</span><span id="65e7" class="ke kf hi ka b fi kn kh l ki kj">return (</span><span id="2a8f" class="ke kf hi ka b fi kn kh l ki kj">&lt;div <em class="jy">className</em>="App"&gt;</span><span id="1a61" class="ke kf hi ka b fi kn kh l ki kj">......</span></pre><p id="ff5a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们看看我们的控制台。我们有一个错误:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/31b4c9dd0b51fb7253a2f242760f6bc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yF1z4J7GE1Q3Lp1_C06Ppw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Our server doesn’t allow Cross-origin resource sharing (CORS).</figcaption></figure><p id="fbbc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了处理这个错误，我们需要配置当请求来自不同来源时，我们的服务器应该如何操作。为此，我们将在项目中添加另一个依赖项:“rocket_cors”。在我们的Cargo.toml中添加以下内容:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="cbd4" class="ke kf hi ka b fi kg kh l ki kj">[dependencies]</span><span id="86ba" class="ke kf hi ka b fi kn kh l ki kj">rocket = "0.4.10"<br/><strong class="ka hj">rocket_cors = "0.5.1"</strong></span></pre><p id="c5c3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们将配置如何处理来自main.rs内部不同来源的调用。</p><p id="6c70" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们将把这个新的依赖项导入main.rs</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9ced" class="ke kf hi ka b fi kg kh l ki kj">extern crate rocket_cors;</span></pre><p id="c5ea" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">记住分号在Rust中是强制执行的！:)</p><p id="c2bb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，我们需要从Rocket导入http方法:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="6187" class="ke kf hi ka b fi kg kh l ki kj">rocket::http::Method;</span></pre><p id="67d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们将使用以下代码配置我们的CORS选项。如果你有兴趣了解更多关于配置选项的信息，我建议你看看github repo中的例子或者阅读链接中的文档。</p><p id="6d2f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">回购:<a class="ae jx" href="https://github.com/lawliet89/rocket_cors" rel="noopener ugc nofollow" target="_blank">https://github.com/lawliet89/rocket_cors</a></p><p id="ae62" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">医生:<a class="ae jx" href="https://docs.rs/rocket_cors/0.5.2/rocket_cors/" rel="noopener ugc nofollow" target="_blank">https://docs.rs/rocket_cors/0.5.2/rocket_cors/</a></p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="58c4" class="ke kf hi ka b fi kg kh l ki kj">use rocket_cors::{</span><span id="f835" class="ke kf hi ka b fi kn kh l ki kj">AllowedHeaders, AllowedOrigins, Error,</span><span id="31aa" class="ke kf hi ka b fi kn kh l ki kj">Cors, CorsOptions</span><span id="6c5a" class="ke kf hi ka b fi kn kh l ki kj">};</span><span id="80d7" class="ke kf hi ka b fi kn kh l ki kj">fn make_cors() -&gt; Cors {</span><span id="7a47" class="ke kf hi ka b fi kn kh l ki kj">let allowed_origins = AllowedOrigins::some_exact(&amp;[<em class="jy"> // 4.<br/></em><strong class="ka hj"><em class="jy">//CHANGE THESE TO MATCH YOUR PORTS</em></strong></span><span id="a80f" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">"http://localhost:3000",</strong></span><span id="57a8" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">"http://127.0.0.1:3000",</strong></span><span id="fd30" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">"http://localhost:8000",</strong></span><span id="22f1" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">"http://0.0.0.0:8000",</strong></span><span id="9004" class="ke kf hi ka b fi kn kh l ki kj">]);</span><span id="30a4" class="ke kf hi ka b fi kn kh l ki kj">CorsOptions {<em class="jy"> // 5.</em></span><span id="375c" class="ke kf hi ka b fi kn kh l ki kj">allowed_origins,</span><span id="e711" class="ke kf hi ka b fi kn kh l ki kj">allowed_methods: vec![Method::Get].into_iter().map(From::from).collect(),<em class="jy"> // 1.</em></span><span id="1b4c" class="ke kf hi ka b fi kn kh l ki kj">allowed_headers: AllowedHeaders::some(&amp;[</span><span id="f90c" class="ke kf hi ka b fi kn kh l ki kj">"Authorization",</span><span id="7ac5" class="ke kf hi ka b fi kn kh l ki kj">"Accept",</span><span id="1048" class="ke kf hi ka b fi kn kh l ki kj">"Access-Control-Allow-Origin",<em class="jy"> // 6.</em></span><span id="76e0" class="ke kf hi ka b fi kn kh l ki kj">]),</span><span id="72f3" class="ke kf hi ka b fi kn kh l ki kj">allow_credentials: true,</span><span id="5165" class="ke kf hi ka b fi kn kh l ki kj">..Default::default()</span><span id="cc9b" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="0f18" class="ke kf hi ka b fi kn kh l ki kj">.to_cors()</span><span id="5170" class="ke kf hi ka b fi kn kh l ki kj">.expect("error while building CORS")</span><span id="9ba4" class="ke kf hi ka b fi kn kh l ki kj">}</span></pre><p id="2578" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们就快成功了，但在准备发射之前，我们需要将CORS选项安装到火箭上。🚀</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="c499" class="ke kf hi ka b fi kg kh l ki kj">fn rocket() -&gt; rocket::Rocket {</span><span id="bfa9" class="ke kf hi ka b fi kn kh l ki kj">rocket::ignite()</span><span id="0d32" class="ke kf hi ka b fi kn kh l ki kj">.mount(</span><span id="82ca" class="ke kf hi ka b fi kn kh l ki kj">"/",</span><span id="ae35" class="ke kf hi ka b fi kn kh l ki kj">routes![<br/><strong class="ka hj">//PASS IN THE NAME OF YOUR ROUTES HERE</strong></span><span id="d3e5" class="ke kf hi ka b fi kn kh l ki kj">index,</span><span id="a17c" class="ke kf hi ka b fi kn kh l ki kj">myrocket</span><span id="78df" class="ke kf hi ka b fi kn kh l ki kj">],</span><span id="ea87" class="ke kf hi ka b fi kn kh l ki kj">)</span><span id="680e" class="ke kf hi ka b fi kn kh l ki kj">.attach(make_cors())</span><span id="7c28" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="243a" class="ke kf hi ka b fi kn kh l ki kj">fn main() {</span><span id="0a7a" class="ke kf hi ka b fi kn kh l ki kj">rocket().launch();</span><span id="c47b" class="ke kf hi ka b fi kn kh l ki kj">}</span></pre><p id="4d84" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请注意，我们的main函数看起来与上一个示例略有不同。</p><p id="3ba8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们现在尝试发出一个http请求，我们应该能够检索到一些数据！我在控制台上看到了以下内容:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/980560c16c3a68800aea77f92f39b0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e887_5xG-Ruotq9QX1PImQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">GREAT SUCCESS! 🔥</figcaption></figure><p id="394f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们把它很好地显示在我们的前端。我们将通过导入useState挂钩来实现这一点，使用该挂钩来存储我们检索的数据，并在App.js的return语句中的p标记内呈现它。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/ff2791717c54c4795c38d36d8155d825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*nmY0f-QCgAtY9OLeCFsQXA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Not rusty at all. 🚀</figcaption></figure><p id="b52a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在功能都好了。让我们从前端生成一些静态文件。</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="b207" class="ke kf hi ka b fi kg kh l ki kj">npm run build</span></pre><p id="9bd9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们现在将把整个构建文件夹移动到我们的后端文件夹中，从那里它们将得到服务。</p><p id="a656" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将通过Rocket提供静态文件。这是有点混乱的部分，因为我们将不得不写相当多的代码来服务我们的静态文件。我已经突出显示了自上次我们查看“main.rs”以来我们添加的内容。这是我们修改后main.rs的样子:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="5b84" class="ke kf hi ka b fi kg kh l ki kj">#![feature(proc_macro_hygiene, decl_macro)]</span><span id="b574" class="ke kf hi ka b fi kn kh l ki kj">#[macro_use]</span><span id="715d" class="ke kf hi ka b fi kn kh l ki kj">extern crate rocket;</span><span id="2011" class="ke kf hi ka b fi kn kh l ki kj">extern crate rocket_cors;</span><span id="3ef2" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">use std::io;</strong></span><span id="915f" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">use std::path::{Path, PathBuf};</strong></span><span id="202a" class="ke kf hi ka b fi kn kh l ki kj">use rocket::http::Method;</span><span id="84b5" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">use rocket_contrib::serve::StaticFiles;</strong></span><span id="5f89" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">use rocket::response::{NamedFile};</strong></span><span id="20c5" class="ke kf hi ka b fi kn kh l ki kj">use rocket_cors::{</span><span id="5a5b" class="ke kf hi ka b fi kn kh l ki kj">AllowedHeaders, AllowedOrigins, Error,</span><span id="723b" class="ke kf hi ka b fi kn kh l ki kj">Cors, CorsOptions</span><span id="ef9b" class="ke kf hi ka b fi kn kh l ki kj">};</span><span id="273f" class="ke kf hi ka b fi kn kh l ki kj">fn make_cors() -&gt; Cors {</span><span id="4c4b" class="ke kf hi ka b fi kn kh l ki kj">let allowed_origins = AllowedOrigins::some_exact(&amp;[<em class="jy"> // 4.</em></span><span id="18af" class="ke kf hi ka b fi kn kh l ki kj">"http://localhost:3000",</span><span id="af37" class="ke kf hi ka b fi kn kh l ki kj">"http://127.0.0.1:3000",</span><span id="a14d" class="ke kf hi ka b fi kn kh l ki kj">"http://localhost:8000",</span><span id="0cb1" class="ke kf hi ka b fi kn kh l ki kj">"http://0.0.0.0:8000",</span><span id="5413" class="ke kf hi ka b fi kn kh l ki kj">]);</span><span id="1921" class="ke kf hi ka b fi kn kh l ki kj">CorsOptions {<em class="jy"> // 5.</em></span><span id="076c" class="ke kf hi ka b fi kn kh l ki kj">allowed_origins,</span><span id="5dc5" class="ke kf hi ka b fi kn kh l ki kj">allowed_methods: vec![Method::Get].into_iter().map(From::from).collect(),<em class="jy"> // 1.</em></span><span id="b9a1" class="ke kf hi ka b fi kn kh l ki kj">allowed_headers: AllowedHeaders::some(&amp;[</span><span id="8fa8" class="ke kf hi ka b fi kn kh l ki kj">"Authorization",</span><span id="e359" class="ke kf hi ka b fi kn kh l ki kj">"Accept",</span><span id="d4bd" class="ke kf hi ka b fi kn kh l ki kj">"Access-Control-Allow-Origin",<em class="jy"> // 6.</em></span><span id="f766" class="ke kf hi ka b fi kn kh l ki kj">]),</span><span id="af15" class="ke kf hi ka b fi kn kh l ki kj">allow_credentials: true,</span><span id="2691" class="ke kf hi ka b fi kn kh l ki kj">..Default::default()</span><span id="0423" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="e146" class="ke kf hi ka b fi kn kh l ki kj">.to_cors()</span><span id="b066" class="ke kf hi ka b fi kn kh l ki kj">.expect("error while building CORS")</span><span id="c534" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="fa87" class="ke kf hi ka b fi kn kh l ki kj">#[get("/api/myrocket")]</span><span id="660e" class="ke kf hi ka b fi kn kh l ki kj">fn myrocket() -&gt; String {</span><span id="68db" class="ke kf hi ka b fi kn kh l ki kj">"My 🚀 server".to_string()</span><span id="4e42" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="0108" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">#[get("/&lt;file..&gt;")]</strong></span><span id="9bcc" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">fn files(file: PathBuf) -&gt; Option&lt;NamedFile&gt; {</strong></span><span id="f02f" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">NamedFile::open(Path::new("build/").join(file)).ok()</strong></span><span id="585e" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">}</strong></span><span id="3eab" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">#[get("/")]</strong></span><span id="81e3" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">fn index() -&gt; io::Result&lt;NamedFile&gt; {</strong></span><span id="5c63" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">NamedFile::open("build/index.html")</strong></span><span id="0ef4" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">}</strong></span><span id="93c9" class="ke kf hi ka b fi kn kh l ki kj">fn rocket() -&gt; rocket::Rocket {</span><span id="eea2" class="ke kf hi ka b fi kn kh l ki kj">rocket::ignite()</span><span id="468a" class="ke kf hi ka b fi kn kh l ki kj">.mount(</span><span id="6aff" class="ke kf hi ka b fi kn kh l ki kj">"/",</span><span id="5913" class="ke kf hi ka b fi kn kh l ki kj">routes![</span><span id="35f1" class="ke kf hi ka b fi kn kh l ki kj">index,</span><span id="6951" class="ke kf hi ka b fi kn kh l ki kj">myrocket,</span><span id="590b" class="ke kf hi ka b fi kn kh l ki kj"><strong class="ka hj">files,</strong></span><span id="799c" class="ke kf hi ka b fi kn kh l ki kj">],</span><span id="404a" class="ke kf hi ka b fi kn kh l ki kj">)</span><span id="aa61" class="ke kf hi ka b fi kn kh l ki kj">.attach(make_cors())</span><span id="45bf" class="ke kf hi ka b fi kn kh l ki kj">}</span><span id="f877" class="ke kf hi ka b fi kn kh l ki kj">fn main() {</span><span id="3cf2" class="ke kf hi ka b fi kn kh l ki kj">rocket().launch();</span><span id="e79b" class="ke kf hi ka b fi kn kh l ki kj">}</span></pre><p id="7535" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，当我们运行我们的服务器时，我们应该看到我们的反应前端。💯</p><p id="c0dd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以我答应给你一个结合使用Rust和React的最简单的骨骼应用。我认为你可以从这里开始用你自己的想法来建造它。我们会说我们的应用程序现在已经完成，可以部署了！</p><p id="9add" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们登录Heroku并开始我们的部署。(你需要安装heroku CLI这里只需<code class="du kt ku kv ka b">npm install -g heroku</code>就可以了)</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9fa4" class="ke kf hi ka b fi kg kh l ki kj">heroku login</span></pre><p id="f70e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">按照这些步骤操作之后，您的终端应该会告诉您已经登录。</p><p id="628b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Heroku还没有正式的Rust构建包，但是已经有了。我们只需要自己设置一个。我们将使用“emk/rust”。</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9520" class="ke kf hi ka b fi kg kh l ki kj">heroku apps:create my-rocket-launch --buildpack emk/rust</span></pre><p id="4a7e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="jy"> Github回购:</em><a class="ae jx" href="https://github.com/emk/heroku-buildpack-rust" rel="noopener ugc nofollow" target="_blank"><em class="jy">https://github.com/emk/heroku-buildpack-rust</em></a></p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/8fcf92e0ef67af93c716e878e6919109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYHJ3sEm9broTWAltFPraA.png"/></div></div></figure><p id="772d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">创建一个名为“Procfile”的文件，并在文件中写入以下内容:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="0c21" class="ke kf hi ka b fi kg kh l ki kj">web: ROCKET_PORT=$PORT ROCKET_KEEP_ALIVE=0 ./target/release/<strong class="ka hj">&lt;name of your rocket server&gt;</strong></span></pre><p id="5e59" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，在我们的终端中，我们运行:</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="66fb" class="ke kf hi ka b fi kg kh l ki kj">cargo build --release</span></pre><p id="79a1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这一部分可能需要一些摆弄(至少对我来说是这样)。我们需要指定使用什么“夜间”版本。为此，我们创建了一个名为“rust-toolchain”的文件。里面我们放了哪些夜间使用的版本。</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="5962" class="ke kf hi ka b fi kg kh l ki kj">nightly-2021-05-20</span></pre><p id="1114" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我能够使用上面的版本进行部署。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/16a6d1bfa266dd7b8fc8097582408cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*R7a_DCj3OOR_cOnspxUT5Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Our file tree now looks like this.</figcaption></figure><p id="c2b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">快到了。接下来，我们设置我们的远程回购。</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="e68a" class="ke kf hi ka b fi kg kh l ki kj">heroku git:remote -a my-rocket-launch</span></pre><p id="eabb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们提交我们的更改之前，不要忘记将API-call更改为您的heroku-address！T3】</p><p id="5c46" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">提交您的更改并推送。</p><p id="3d39" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">部署时间！</p><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="83de" class="ke kf hi ka b fi kg kh l ki kj">git push heroku master</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/ab818f4c10c055778dae74d2c03e7b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7eakIWFIe_zddgADFtzRQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Our app has been deployed!</figcaption></figure><p id="4f5b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们在后端使用Rust进行了最简单的往返，在前端使用React。</p><h1 id="a08c" class="kz kf hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">恭喜你！</h1><h1 id="da19" class="kz kf hi bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">如果你能走到这一步！非常感谢你的阅读，我真的希望你觉得这个指南有用。如果你有，请给我一个关注我，并留下评论！🚀🔥</h1><p id="d9b7" class="pw-post-body-paragraph iu iv hi iw b ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn ma jp jq jr hb bi">ありがとう！</p><p id="8884" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在推特上关注我:@ johanthestrup</p></div></div>    
</body>
</html>
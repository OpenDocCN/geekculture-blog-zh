<html>
<head>
<title>How to Create Non-linear Measures of Temperature</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建温度的非线性测量</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-create-non-linear-measures-of-temperature-f533df51eca7?source=collection_archive---------57-----------------------#2021-06-29">https://medium.com/geekculture/how-to-create-non-linear-measures-of-temperature-f533df51eca7?source=collection_archive---------57-----------------------#2021-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="05b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不同领域的研究人员，如环境研究和经济学，在研究温度对一系列健康结果的影响时，经常使用非线性的温度测量方法。温度的非线性可以用下面的例子来解释，比如说，温度从<a class="ae jd" href="https://www.nature.com/articles/s41598-018-28392-z" rel="noopener ugc nofollow" target="_blank"> 25C上升到27C对健康的影响远没有从34C上升到36C </a>严重。这篇博文讨论了温度的非线性测量，并提供了在r。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/bcdf98bfd6f42c68bd85add4f2ef6d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67ydaBjptXw0b-W_r6wv1Q.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Image Source: <a class="ae jd" href="https://unsplash.com/@sumekler" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@sumekler</a></figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><ul class=""><li id="69cb" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">数据</strong></li></ul><p id="8c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本博客中使用的温度数据可在<a class="ae jd" href="http://climate.geog.udel.edu/~climate/html_pages/download.html" rel="noopener ugc nofollow" target="_blank">网站档案</a>上获得，标题为<a class="ae jd" href="http://climate.geog.udel.edu/~climate/html_pages/download.html#T2017" rel="noopener ugc nofollow" target="_blank">地球气温:1900–2017</a>。这种全球0.5*0.5度经纬度网格温度<a class="ae jd" href="http://climate.geog.udel.edu/~climate/html_pages/download.html#T2017" rel="noopener ugc nofollow" target="_blank">数据</a>可以与住户调查或任何行政级别的数据匹配，这些数据具有相同类型的采样单位坐标。我们还使用了<a class="ae jd" href="https://dhsprogram.com/data/" rel="noopener ugc nofollow" target="_blank">人口和健康调查</a> (DHS)，它提供了所需的坐标，并可以与温度数据相结合。然后，我们可以调查区域层面的温度对与抽样单位(家庭和个人)相关的各种变量的影响。</p><ul class=""><li id="cdf0" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">研究问题</strong></li></ul><p id="77cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是两个研究问题的例子。为了回答上面提到的问题，我们需要一个温度测量，这将在博客的其余部分解释(用代码)。</p><p id="c3b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1."一生中每月平均温度对个人的身体质量指数有什么影响？"</p><p id="4954" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.“上一年的平均气温对一个人短期患病有什么影响？”</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="1da8" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">测量</h1><p id="41fa" class="pw-post-body-paragraph if ig hi ih b ii li ik il im lj io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">我们将像研究人员经常做的那样，把测量称为“累积度-月”。为了构建这个测量，我们需要假设一个温度阈值(这个阈值是位置特定的)。例如，如果我们假设阈值为25C，则可以使用下面的示例来解释“累积度大于25C的月份”的度量，例如，在2005年，有两个月的温度超过了阈值25C。一个月，一个是30C，一个是40C。那么“大于25C的累积度-月”将是(30–25)+(40–25)= 20。根据这个定义，我们将计算两个温度测量值。</p><p id="125c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)度月&gt; 25C，终生有效，</p><p id="6498" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)在调查前的12个月中，度月&gt; 25C。</p><p id="bdd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步</strong></p><p id="151b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的第一步是使用Moumita Ghorai的教程<a class="ae jd" rel="noopener" href="/swlh/easiest-way-to-convert-data-from-geospatial-format-to-csv-d1c81f571238">将温度数据加入DHS坐标。将DHS数据与温度数据匹配将产生一个横截面数据集，其中所有特定月份的温度都显示为列。下面是最终结果的一部分:</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ln"><img src="../Images/698991810f025cae11408954c1f5da4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WiITXVJVHStjtvC-tE4jwQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">What you see after merging the temperature data with DHS coordinates</figcaption></figure><p id="d626" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用前缀“month”和对应于<a class="ae jd" href="https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf" rel="noopener ugc nofollow" target="_blank"> DHS变量的月份号b3 </a>对月份变量进行序列化。以<em class="lo">月</em>为前缀的温度变量包含我们感兴趣的一年中所有月份的温度。</p><p id="0a56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了计算儿童一生的平均体温，下一步是</p><p id="1917" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)选择b3和hv003*中提到的月份，</p><p id="3e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)根据这些月份温度变量计算寿命温度。</p><p id="a661" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">*DHS数据码本在这里是<a class="ae jd" href="https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="66ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步</strong></p><p id="951c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面的R代码块中，我们将最终数据集称为<em class="lo"> df </em>。第一个数据块将生成DHS儿童一生的平均体温- <em class="lo"> avgtemp- </em>(截至访谈月)。</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="5caa" class="lu kl hi lq b fi lv lw l lx ly">#... Run this code on R!</span><span id="2792" class="lu kl hi lq b fi lz lw l lx ly">browseURL("<a class="ae jd" href="https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf" rel="noopener ugc nofollow" target="_blank">https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf</a>")</span><span id="668f" class="lu kl hi lq b fi lz lw l lx ly"># HV008 Century month code of date of interview, calculated from HV007 and HV006 (see note on century month codes)<br/>#B3 Century month code for the date of birth of the child (see note on century month codes).</span><span id="9385" class="lu kl hi lq b fi lz lw l lx ly">#install.packages("dplyr")<br/>library(dplyr)</span><span id="7f5b" class="lu kl hi lq b fi lz lw l lx ly">df$avgtemp&lt;-NA<br/>for (i in 1:dim(df)[1]){</span><span id="03b8" class="lu kl hi lq b fi lz lw l lx ly">  a1&lt;-df$hv008[i]<br/>  a2&lt;-df$b3[i]<br/>  a3&lt;- a2-a1<br/>  sumtemp&lt;-vector()<br/>  <br/>  for (j in 0:a3) {<br/>    damju&lt;- df[i,paste0("month", eval(a1+j))]<br/>    sumtemp&lt;-c(sumtemp,damju)<br/>  }<br/>  df$avgtemp[i]&lt;-mean(sumtemp)<br/>}</span></pre><p id="9450" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，这个变量不会对儿童产生非线性的温度测量。因此我们需要非线性测量！接下来，我们创建平均温度高于25℃的天数的总温度—度月&gt; 25℃或<em class="lo">度月</em>。</p><p id="7377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (1)总度月&gt; 25C过一生</strong></p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="ed99" class="lu kl hi lq b fi lv lw l lx ly">#... Run this code on R!</span><span id="d426" class="lu kl hi lq b fi lz lw l lx ly">#install.packages("dplyr")<br/>library(dplyr)</span><span id="00b8" class="lu kl hi lq b fi lz lw l lx ly">browseURL("<a class="ae jd" href="https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf" rel="noopener ugc nofollow" target="_blank">https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf</a>")</span><span id="c2bd" class="lu kl hi lq b fi lz lw l lx ly"># HV008 Century month code of date of interview, calculated from HV007 and HV006 (see note on century month codes)<br/>#B3 Century month code for the date of birth of the child (see note on century month codes).</span><span id="963a" class="lu kl hi lq b fi lz lw l lx ly">df&lt;-data.frame(df)<br/>colnames(df)<br/>df$degmonth&lt;-NA<br/>for (i in 1:dim(df)[1]){<br/>  <br/>  a1&lt;-df$b3[i]<br/>  a2&lt;-df$hv008[i]<br/>  a3&lt;- a2-a1<br/>  sumtemp&lt;-vector()<br/>  <br/>  for (j in 0:a3) {<br/>    damju&lt;- df[i,paste0("month", eval(a1+j))]<br/>    sumtemp&lt;-c(sumtemp,damju)<br/>  }<br/>  <br/>  #turn values less than 25 into NAs<br/>  for (m in 1:length(sumtemp)) {<br/>    if (sumtemp[m] &lt; 25) {<br/>      sumtemp[m] &lt;- NA<br/>    } <br/>  }<br/>    <br/>    #drop NAs, subtract 25 from every value and create sum of temp above 25<br/>  sumtemp&lt;-sumtemp[!is.na(sumtemp)]<br/>  <br/>  for (n in 1:length(sumtemp)) {<br/>    sumtemp[n]&lt;-sumtemp[n]-25<br/>  }<br/>  <br/>  df$degdays[i]&lt;- sum(sumtemp, na.rm = TRUE)<br/>  <br/>}</span></pre><p id="bfc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">截至调查月份的最后一年— <em class="lo">,最终温度测量值为度日&gt; 25C。</em></p><p id="478d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (2)截至调查月</strong>的前12个月中的总学位月&gt; 25C</p><pre class="jf jg jh ji fd lp lq lr ls aw lt bi"><span id="91c1" class="lu kl hi lq b fi lv lw l lx ly">#... Run this code on R!</span><span id="89d5" class="lu kl hi lq b fi lz lw l lx ly">#install.packages("dplyr")<br/>library(dplyr)</span><span id="a9a3" class="lu kl hi lq b fi lz lw l lx ly">browseURL("<a class="ae jd" href="https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf" rel="noopener ugc nofollow" target="_blank">https://dhsprogram.com/pubs/pdf/DHSG4/Recode7_DHS_10Sep2018_DHSG4.pdf</a>")</span><span id="76e3" class="lu kl hi lq b fi lz lw l lx ly">#HV008 Century month code of date of interview, calculated from HV007 and HV006 (see note on century month codes)<br/>#B3 Century month code for the date of birth of the child (see note on century month codes).</span><span id="261f" class="lu kl hi lq b fi lz lw l lx ly">df&lt;-data.frame(df)<br/>colnames(df)<br/>df$yrdedeg&lt;-NA<br/>for (i in 1:dim(df)[1]){<br/>  <br/>  a2&lt;-df$hv008[i]<br/>  a3&lt;- a2-12<br/>  sumtemp&lt;-vector()<br/>  <br/>  for (j in 0:a3) {<br/>    damju&lt;- df[i,paste0("month", eval(a1+j))]<br/>    sumtemp&lt;-c(sumtemp,damju)<br/>  }<br/>  <br/>  #turn values less than 25 into NAs<br/>  for (m in 1:length(sumtemp)) {<br/>    if (sumtemp[m] &lt; 25) {<br/>      sumtemp[m] &lt;- NA<br/>    } <br/>  }<br/>  <br/>  #drop NAs, subtract 25 from every value and create sum of temp above 25<br/>  sumtemp&lt;-sumtemp[!is.na(sumtemp)]<br/>  <br/>  for (n in 1:length(sumtemp)) {<br/>    sumtemp[n]&lt;-sumtemp[n]-25<br/>  }<br/>  <br/>  df$yrdedeg[i]&lt;- sum(sumtemp, na.rm = TRUE)<br/>  <br/>}</span></pre><p id="d877" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo"> ** </em> <a class="ae jd" href="https://sites.google.com/view/moumitaghorai/home" rel="noopener ugc nofollow" target="_blank"> <em class="lo">西密歇根大学经济系Moumita Ghorai</em></a><em class="lo">是这篇博文的合著者。</em></p></div></div>    
</body>
</html>
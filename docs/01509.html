<html>
<head>
<title>GraphQL QuickStart with Spring Boot, Kotlin and MongoDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spring Boot、科特林和MongoDB的GraphQL快速入门</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/graphql-quickstart-with-spring-boot-kotlin-and-mongodb-c16f301b8aeb?source=collection_archive---------6-----------------------#2021-04-13">https://medium.com/geekculture/graphql-quickstart-with-spring-boot-kotlin-and-mongodb-c16f301b8aeb?source=collection_archive---------6-----------------------#2021-04-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ea8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">先说GraphQL官方定义</em> </strong> <em class="jd"> : </em></p><p id="bd0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL是一种API查询语言，也是一种用现有数据完成这些查询的运行时语言。GraphQL为API中的数据提供了完整且易于理解的描述，使客户能够准确地要求他们需要的东西，使API更容易随时间发展，并支持强大的开发工具。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/803e6de1aff2edf200b4d4aff7226565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Qae2qZzokoLnMzPnW2eKg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Logo’s taken from official sites</figcaption></figure><p id="e1f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将了解什么是GraphQL，通过用Spring Boot和MongoDB构建一个简单的GraphQL服务器来使用GraphQL的好处，以及它相对于REST实现的好处。</p><p id="7e12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了上面的官方定义，我们可以理解以下几点</p><ul class=""><li id="2cfb" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">它是API的查询语言，也是完成查询的运行时</li><li id="3848" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">它还提供了API数据的完整描述，这有助于客户端根据需要获取数据。</li></ul><p id="da1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL允许我们定义需要获取的数据的结构和格式，还允许我们在一个请求中查询多个模型。</p><p id="bf6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL架构将在扩展名为'的文件中定义。“graphqls ”,它包含模式、查询、变异和对象类型。</p><p id="608b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">graph QL如何解决REST API的缺点:</strong></p><ul class=""><li id="8f61" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">GraphQL为消费者提供了根据需要请求属性的灵活性，即它在请求中提供动态数据。REST API响应总是固定的，因为它为每个请求发送整个JSON对象。</li><li id="0066" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">REST API存在取多取少的问题。</li><li id="72d5" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">用更少的代码获得更好的性能。</li><li id="581b" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">GraphQL为所有带有查询和变异的操作及其HTTP POST方法公开了一个端点。在REST中，每个操作都有一个单独的API，根据需求使用不同的HTTP动词(GET、PUT、POST、DELETE)。</li><li id="795a" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">GraphQL依赖于为应用程序定义的模式文件。只有在架构文件上指定的属性或操作才会向使用者公开。</li></ul><h2 id="cccb" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated"><strong class="ak"> GraphQL模式:</strong></h2><p id="9079" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">Schema根据查询和变异操作以及它们的类型和属性来表示GraphQL API。</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="f469" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">schema </strong>{<br/>    <strong class="lj hj">query </strong>: GadgetQuery<br/>    <strong class="lj hj">mutation</strong>: GadgetMutation<br/>}</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lr"><img src="../Images/a2833390301282ff8b1d1fb9b42da616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*ob_1aX_F11lB28LyYmk2TA.png"/></div></figure><h2 id="d051" class="ki kj hi bd kk kl km kn ko kp kq kr ks iq kt ku kv iu kw kx ky iy kz la lb lc bi translated"><strong class="ak">查询类型:</strong></h2><p id="b353" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">查询类型是GraphQL模式中的根类型，用于创建从GraphQL服务器获取数据的查询。它通常用于定义只读(GET)操作。让我们考虑一个Gadget gallery应用程序的例子，查询类型可以用来定义一组操作，如下所示</p><p id="72fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">注</em> </strong> <em class="jd">:数组或对象列表用一对方括号/方框表示，例如:[Gadget]，感叹号表示为其强制/必需属性。</em></p><blockquote class="ls lt lu"><p id="d848" class="if ig jd ih b ii ij ik il im in io ip lv ir is it lw iv iw ix lx iz ja jb jc hb bi translated">按GadgetId获取小工具<br/>获取所有小工具<br/>按类别获取小工具<br/>按类别获取可用小工具</p></blockquote><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="eb7b" class="ki kj hi lj b fi ln lo l lp lq"><em class="jd">## Root type<br/></em><strong class="lj hj">type </strong>GadgetQuery {<br/>    <strong class="lj hj">application </strong>: String<br/>    <strong class="lj hj">gadget</strong>(gadgetId : String!) : GadgetResponse<br/>    <strong class="lj hj">allGadgets </strong>: [GadgetResponse]!<br/>}</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/ee25f14da7df9c54d87ac4ab96675a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EzO5-IECnWGV9vx4ZdNMvw.png"/></div></div></figure><p id="e964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">突变类型:</strong></p><p id="c3b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">突变类型是GraphQL模式中的另一个根类型，用于定义操纵数据的操作(POST、PUT、DELETE)。让我们考虑Gadget gallery应用程序的同一个例子，突变类型可以用来定义如下操作</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="e4ec" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">type </strong>GadgetMutation {<br/>    <strong class="lj hj">persistGadgetData</strong>(gadgetInput : GadgetInput) : GadgetResponse<br/>}</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/5d4f34819d9ff3b8813f5f5145bf60ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktc2GHHBOwc7B4XD3oLeiA.png"/></div></div></figure><p id="bc8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对象类型:</strong></p><p id="795f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对象类型用于定义用户定义的类型(Java/Kotlin中的类),属性和数据类型用作输入/输出参数，以执行模式文件中定义的查询和变异类型的操作。</p><p id="d321" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">示例:</em>可以在模式文件中定义小工具类型，如下所示。</p><p id="de07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">注</em> </strong> <em class="jd">:感叹号表示其为强制/必需参数。例句:串串！</em></p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="d735" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">type </strong>Gadget {<br/>    <strong class="lj hj">gadgetId</strong>: String!<br/>    <strong class="lj hj">gadgetName</strong>: String!<br/>    <strong class="lj hj">gadgetCategory</strong>: String<br/>    <strong class="lj hj">gadgetAvailability</strong>: Boolean!<br/>    <strong class="lj hj">gadgetPrice</strong>: Float!<br/>}</span></pre><p id="9720" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GraphQL解析器:</strong></p><ul class=""><li id="d2a8" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated"><strong class="ih hj"><em class="jd">GraphQLQueryResolver</em></strong><em class="jd">:</em></li></ul><p id="e27f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">它是用于解析查询类型操作的主要解析器之一。它充当应用程序(模式文件)中定义的所有只读操作的起点。</em></p><p id="ebfc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> GadgetQueryResolver实现了“GraphQLQueryResolver ”,并为模式文件中定义的查询操作提供实现。Spring扫描解析器beans的包结构，并调用模式文件中声明的正确方法。</em></p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="31ed" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">class </strong>GadgetQueryResolver : GraphQLQueryResolver {...}</span></pre><ul class=""><li id="b244" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated"><strong class="ih hj"><em class="jd">graphqlmationresolver</em></strong><em class="jd">:</em></li></ul><p id="ef0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是另一个主要的解析器，用于解析突变类型的操作。它充当GraphQL模式文件中定义的所有alter data操作(即POST、PUT和DELETE操作)的起点。</p><p id="7bdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd"> GadgetMutationResolver类实现了“GraphQLMutationResolver ”,并为模式文件中定义的所有变异方法提供了实现。</em></p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="c6f6" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">class </strong>GadgetMutationResolver : GraphQLMutationResolver {...}</span></pre><ul class=""><li id="24f4" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated"><strong class="ih hj"><em class="jd">graphql resolver:</em></strong></li></ul><p id="999c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它充当GraphQL模式文件中所有其他类型(自定义用户定义类型)的通用解析器。当我们有多个通过一些映射相互链接的模型类时，这尤其有用。为了识别类型，它使用泛型。</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="4386" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">class </strong>PhoneTypeResolver : GraphQLResolver&lt;Phone&gt; {...}</span></pre><p id="960e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GraphQL服务器:动手示例</strong></p><p id="4a00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">技术/工具</em> </strong>:</p><blockquote class="ls lt lu"><p id="3673" class="if ig jd ih b ii ij ik il im in io ip lv ir is it lw iv iw ix lx iz ja jb jc hb bi translated">IDE:IntelliJ(STS/Eclipse)<br/>Kotlin:1.4 . x<br/>graph QL&amp;GraphiQL:5 . x . x<br/>构建工具:Maven <br/> Spring Boot: 2.4.x <br/>数据库:MongoDB服务器(或任何其他数据库——H2或MySQL)</p></blockquote><p id="6275" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ma" href="https://start.spring.io/#!type=maven-project&amp;language=kotlin&amp;platformVersion=2.4.4.RELEASE&amp;packaging=jar&amp;jvmVersion=11&amp;groupId=com.shashir&amp;artifactId=gadgetapp-graphql-kotlin-mongodb&amp;name=gadgetapp-graphql-kotlin-mongodb&amp;description=GraphQL%20Crud%20API%20with%20Spring%20Boot%2C%20Kotlin%20and%C2%A0MongoDB&amp;packageName=com.shashir.gadgetapp-graphql-kotlin-mongodb&amp;dependencies=web,lombok,data-mongodb" rel="noopener ugc nofollow" target="_blank"> Spring Boot + MongoDB +科特林配置</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/6a9967071845941c594684b9578fc3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50XvHcRAUtLzqYST-oy-Ow.png"/></div></div></figure><p id="a2d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下面添加GraphQL Maven依赖项</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="385e" class="ki kj hi lj b fi ln lo l lp lq">&lt;<strong class="lj hj">dependencies</strong>&gt;<br/>   ...<br/>   <em class="jd">&lt;!-- Enable GraphQL servlet-mapping at URI - '/graphql' --&gt;<br/>   </em>&lt;<strong class="lj hj">dependency</strong>&gt;<br/>      &lt;<strong class="lj hj">groupId</strong>&gt;com.graphql-java-kickstart&lt;/<strong class="lj hj">groupId</strong>&gt;<br/>      &lt;<strong class="lj hj">artifactId</strong>&gt;graphql-spring-boot-starter&lt;/<strong class="lj hj">artifactId</strong>&gt;<br/>      &lt;<strong class="lj hj">version</strong>&gt;5.7.0&lt;/<strong class="lj hj">version</strong>&gt;<br/>   &lt;/<strong class="lj hj">dependency</strong>&gt;<br/><br/>   <em class="jd">&lt;!-- GraphQL UI at '/graphiql' by default - GraphQL testing --&gt;<br/>   </em>&lt;<strong class="lj hj">dependency</strong>&gt;<br/>      &lt;<strong class="lj hj">groupId</strong>&gt;com.graphql-java-kickstart&lt;/<strong class="lj hj">groupId</strong>&gt;<br/>      &lt;<strong class="lj hj">artifactId</strong>&gt;graphiql-spring-boot-starter&lt;/<strong class="lj hj">artifactId</strong>&gt;<br/>      &lt;<strong class="lj hj">version</strong>&gt;5.5.0&lt;/<strong class="lj hj">version</strong>&gt;<br/>   &lt;/<strong class="lj hj">dependency</strong>&gt;<br/><br/>   &lt;<strong class="lj hj">dependency</strong>&gt;<br/>      &lt;<strong class="lj hj">groupId</strong>&gt;com.graphql-java-kickstart&lt;/<strong class="lj hj">groupId</strong>&gt;<br/>      &lt;<strong class="lj hj">artifactId</strong>&gt;graphql-java-tools&lt;/<strong class="lj hj">artifactId</strong>&gt;<br/>      &lt;<strong class="lj hj">version</strong>&gt;5.4.1&lt;/<strong class="lj hj">version</strong>&gt;<br/>   &lt;/<strong class="lj hj">dependency</strong>&gt;<br/>   ...<br/>&lt;/<strong class="lj hj">dependencies</strong>&gt;</span></pre><p id="1499" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用配置—<strong class="ih hj"><em class="jd">application . yml</em></strong></p><p id="2c40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们将默认的graphiql url从“graphiql”覆盖到“gadget-ui ”,并提供了MongoDB配置</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="2652" class="ki kj hi lj b fi ln lo l lp lq"><em class="jd">## Server port<br/></em><strong class="lj hj">server</strong>:<br/>  <strong class="lj hj">port</strong>: 9997<br/><br/><em class="jd">## Graphiql Mapping<br/></em><strong class="lj hj">graphiql</strong>:<br/>  <strong class="lj hj">mapping</strong>: gadget-ui<br/><br/><em class="jd">## MongoDB configuration (optional - if not provided spring boot takes default values)<br/></em><strong class="lj hj">spring</strong>:<br/>  <strong class="lj hj">data</strong>:<br/>    <strong class="lj hj">mongodb</strong>:<br/>      <strong class="lj hj">host</strong>: localhost<br/>      <strong class="lj hj">port</strong>: 27017<br/>      <strong class="lj hj">database</strong>: srsgadgetdb</span></pre><p id="a3e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mongo存储库——连接MongoDB服务器</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="5ebe" class="ki kj hi lj b fi ln lo l lp lq">@Repository<br/><strong class="lj hj">interface </strong>GadgetRepository : MongoRepository&lt;Gadget?, String?&gt; { }</span></pre><p id="fce4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看放在项目类路径中的小工具库应用程序“gadget.graphqls”的完整GraphQL模式。</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="1705" class="ki kj hi lj b fi ln lo l lp lq"><strong class="lj hj">schema </strong>{<br/>    <strong class="lj hj">query </strong>: GadgetQuery<br/>    <strong class="lj hj">mutation</strong>: GadgetMutation<br/>}<br/><br/><em class="jd">## Root type<br/></em><strong class="lj hj">type </strong>GadgetQuery {<br/>    <strong class="lj hj">application </strong>: String<br/>    <strong class="lj hj">gadget</strong>(gadgetId : String!) : GadgetResponse<br/>    <strong class="lj hj">allGadgets </strong>: [GadgetResponse]!<br/>}<br/><br/><em class="jd">## Root type<br/></em><strong class="lj hj">type </strong>GadgetMutation {<br/>    <strong class="lj hj">persistGadgetData</strong>(gadgetInput : GadgetInput) : GadgetResponse<br/>}<br/><br/><strong class="lj hj">type </strong>Gadget {<br/>    <strong class="lj hj">gadgetId</strong>: String!<br/>    <strong class="lj hj">gadgetName</strong>: String!<br/>    <strong class="lj hj">gadgetCategory</strong>: String<br/>    <strong class="lj hj">gadgetAvailability</strong>: Boolean!<br/>    <strong class="lj hj">gadgetPrice</strong>: Float!<br/>}<br/><br/><strong class="lj hj">type </strong>GadgetResponse {<br/>    <strong class="lj hj">gadgetId</strong>: String!<br/>    <strong class="lj hj">gadgetName</strong>: String!<br/>    <strong class="lj hj">gadgetCategory</strong>: String<br/>    <strong class="lj hj">gadgetAvailability</strong>: Boolean!<br/>    <strong class="lj hj">gadgetPrice</strong>: Float!<br/>}<br/><br/><strong class="lj hj">input </strong>GadgetInput {<br/>    <strong class="lj hj">gadgetName</strong>: String!<br/>    <strong class="lj hj">gadgetCategory</strong>: String<br/>    <strong class="lj hj">gadgetAvailability</strong>: Boolean!<br/>    <strong class="lj hj">gadgetPrice</strong>: Float!<br/>}</span></pre><p id="5ef6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">带有属性集的小工具集合和文档详细信息</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="65f0" class="ki kj hi lj b fi ln lo l lp lq">@Document(collection = <strong class="lj hj">"Gadget"</strong>)<br/><strong class="lj hj">data class </strong>Gadget(<br/><br/>    @Id<br/>    <strong class="lj hj">val gadgetId</strong>: String? = <strong class="lj hj">null</strong>,<br/>    <strong class="lj hj">var gadgetName</strong>: String? = <strong class="lj hj">null</strong>,<br/>    <strong class="lj hj">var gadgetCategory</strong>: String? = <strong class="lj hj">null</strong>,<br/>    <strong class="lj hj">var gadgetAvailability</strong>: Boolean? = <strong class="lj hj">true</strong>,<br/>    <strong class="lj hj">var gadgetPrice</strong>: Double? = <strong class="lj hj">null<br/></strong>)</span></pre><p id="4bdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">T5【GadgetQueryResolver:T7】</strong></p><p id="a540" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个类中，我们为查询根类型的模式文件中定义的操作提供了实现。</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="673e" class="ki kj hi lj b fi ln lo l lp lq">@Component<br/><strong class="lj hj">class </strong>GadgetQueryResolver : GraphQLQueryResolver {<br/><br/>    @Autowired<br/>    <strong class="lj hj">var gadgetRepository</strong>: GadgetRepository? = <strong class="lj hj">null<br/><br/>    fun </strong>application() : String {<br/>        <strong class="lj hj">return "Welcome to GraphQL with Kotlin and MongoDB...!"<br/>    </strong>}<br/><br/>    <strong class="lj hj">fun </strong>getGadget(gadgetId: String): GadgetResponse? {<br/>        <strong class="lj hj">var </strong>gadget = <strong class="lj hj">gadgetRepository</strong>?.findById(gadgetId)?.get()<br/>        <strong class="lj hj">return </strong>mapGadgetToGadgetResponse(gadget)<br/>    }<br/><br/>    <strong class="lj hj">fun </strong>getAllGadgets(): List&lt;GadgetResponse?&gt;? {<br/>        <strong class="lj hj">return </strong>getGadgetResponse(<strong class="lj hj">gadgetRepository</strong>?.findAll() <strong class="lj hj">as </strong>List&lt;Gadget&gt;)<br/>    }<br/><br/>    <strong class="lj hj">private fun </strong>getGadgetResponse(gadgetList: List&lt;Gadget&gt;): List&lt;GadgetResponse&gt;? {<br/>        <strong class="lj hj">val </strong>gadgetResponseList: MutableList&lt;GadgetResponse&gt; = ArrayList()<br/>        gadgetList.stream().forEach <strong class="lj hj">{ </strong>gadget: Gadget <strong class="lj hj">-&gt;<br/>            </strong>gadgetResponseList.add(mapGadgetToGadgetResponse(gadget))<br/>        <strong class="lj hj">}<br/>        return </strong>gadgetResponseList<br/>    }<br/><br/>    <strong class="lj hj">private fun </strong>mapGadgetToGadgetResponse (gadget : Gadget?) : GadgetResponse {<br/>        <strong class="lj hj">var </strong>gadgetResponse = GadgetResponse()<br/>        gadgetResponse.<strong class="lj hj">gadgetId </strong>= gadget?.<strong class="lj hj">gadgetId<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetName </strong>= gadget?.<strong class="lj hj">gadgetName<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetCategory </strong>= gadget?.<strong class="lj hj">gadgetCategory<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetPrice </strong>= gadget?.<strong class="lj hj">gadgetPrice<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetAvailability </strong>= gadget?.<strong class="lj hj">gadgetAvailability<br/>        return </strong>gadgetResponse;<br/>    }<br/>}</span></pre><p id="cfb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jd">GadgetMutationResolver:</em></strong></p><p id="79d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个类中，我们提供了在模式文件中为突变类型定义的操作的实现。</p><pre class="jf jg jh ji fd li lj lk ll aw lm bi"><span id="e688" class="ki kj hi lj b fi ln lo l lp lq">@Component<br/><strong class="lj hj">class </strong>GadgetMutationResolver : GraphQLMutationResolver {<br/><br/>    @Autowired<br/>    <strong class="lj hj">var gadgetRepository</strong>: GadgetRepository? = <strong class="lj hj">null<br/><br/>    fun </strong>persistGadgetData(persistGadget: GadgetInput): GadgetResponse {<br/>        <strong class="lj hj">val </strong>saveGadgetData = Gadget()<br/>        saveGadgetData.<strong class="lj hj">gadgetName </strong>= persistGadget.<strong class="lj hj">gadgetName<br/>        </strong>saveGadgetData.<strong class="lj hj">gadgetCategory </strong>= persistGadget.<strong class="lj hj">gadgetCategory<br/>        </strong>saveGadgetData.<strong class="lj hj">gadgetPrice </strong>= persistGadget.<strong class="lj hj">gadgetPrice<br/>        </strong>saveGadgetData.<strong class="lj hj">gadgetAvailability </strong>= persistGadget.<strong class="lj hj">gadgetAvailability<br/>        val </strong>persistedGadget: Gadget? = <strong class="lj hj">gadgetRepository</strong>?.save(saveGadgetData)<br/>        <strong class="lj hj">return </strong>mapGadgetToGadgetResponse(persistedGadget)<br/>    }<br/><br/>    <strong class="lj hj">private fun </strong>mapGadgetToGadgetResponse (gadget : Gadget?) : GadgetResponse {<br/>        <strong class="lj hj">var </strong>gadgetResponse = GadgetResponse()<br/>        gadgetResponse.<strong class="lj hj">gadgetId </strong>= gadget?.<strong class="lj hj">gadgetId<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetName </strong>= gadget?.<strong class="lj hj">gadgetName<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetCategory </strong>= gadget?.<strong class="lj hj">gadgetCategory<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetPrice </strong>= gadget?.<strong class="lj hj">gadgetPrice<br/>        </strong>gadgetResponse.<strong class="lj hj">gadgetAvailability </strong>= gadget?.<strong class="lj hj">gadgetAvailability<br/>        return </strong>gadgetResponse;<br/>    }<br/>}</span></pre></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="84f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GraphQL —小工具应用测试:</strong></p><p id="eec1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，GraphQL servlet映射如下<br/><a class="ae ma" href="http://localhost:9997/graphiql" rel="noopener ugc nofollow" target="_blank">http://localhost:9997/graph QL</a></p><p id="013b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">基于application.yml文件中提供的配置自定义URL:</em><a class="ae ma" href="http://localhost:9997/gadget-ui" rel="noopener ugc nofollow" target="_blank"><em class="jd">http://localhost:9997/gadget-ui</em></a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mj"><img src="../Images/793b1a6c8404d33eed6f5cf101b97461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9vCijNYfKMZh57awqp6pA.png"/></div></div></figure><p id="43a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">测试小工具突变:</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mk"><img src="../Images/dcdaa9a3f96eae4465f04422438fb610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZPciBM1wKwI9K-4Ce7WoA.png"/></div></div></figure><p id="2f28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">测试小工具查询:</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ml"><img src="../Images/2a282be6c31da784bf05afedb352d324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*va8jhJT8dcS0ekqVRRXayw.png"/></div></div></figure><p id="f0e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">验证MongoDB数据库中的小工具集合，我们可以在其中找到如下3个文档:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mm"><img src="../Images/90211a97129477dfabf2bb2ef536c36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWiwm-YzT46RihO1zKroEw.png"/></div></div></figure></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="baa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了..我希望这篇文章对您开始使用GraphQL有所帮助。在本文中，我们从GraphQL的基础知识以及如何使用GraphQL实现查询和变异开始，并给出了一个从MongoDB持久化和读取数据的例子。</p><p id="87a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面例子的完整代码可以在GitHub上找到</p><div class="mn mo ez fb mp mq"><a href="https://github.com/shashirl9/gadgetapp-graphql-kotlin-mongodb" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hj fi z dy mv ea eb mw ed ef hh bi translated">shashirl 9/gadgetapp-graph QL-kot Lin-MongoDB</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">Permalink无法加载最新的提交信息。验证MongoDB数据库的小工具集合，在那里我们可以找到3…</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">github.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne jo mq"/></div></div></a></div><p id="55ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL官方文档:</p><div class="mn mo ez fb mp mq"><a href="https://graphql.org/learn/" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hj fi z dy mv ea eb mw ed ef hh bi translated">GraphQL简介</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">了解GraphQL，它如何工作，以及如何使用它。寻找关于如何构建GraphQL服务的文档…</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">graphql.org</p></div></div><div class="mz l"><div class="nf l nb nc nd mz ne jo mq"/></div></div></a></div></div></div>    
</body>
</html>
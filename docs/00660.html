<html>
<head>
<title>Graphing r/Investing and r/WallStreetBets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">投资和华尔街赌注图表</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/graphing-r-investing-and-r-wallstreetbets-c9f9f9276d69?source=collection_archive---------7-----------------------#2021-03-09">https://medium.com/geekculture/graphing-r-investing-and-r-wallstreetbets-c9f9f9276d69?source=collection_archive---------7-----------------------#2021-03-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f56a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看看r/Investing和r/WallStreetBets的图形表示，通常被视为reddit熊市与牛市情绪的代表。希望从这些表示中，我们可以根据语义相似性对用户、帖子和股票进行聚类，同时根据它们对每个特定子主题的社交网络的影响对它们进行排名。集群和排名应该能够告诉我们，哪些股票是一起推广，在哪些职位，由谁和他们如何在这两个社区不同。</p><p id="83ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">TL；DR </em>一些交互式仪表盘，用于<a class="ae je" href="https://public.tableau.com/profile/zuye.zheng#!/vizhome/GraphAnalyticsonrInvesting/rInvesting" rel="noopener ugc nofollow" target="_blank">投资</a>和<a class="ae je" href="https://public.tableau.com/profile/zuye.zheng#!/vizhome/GraphAnalyticsonrWallStreetBets/rWallStreetBets" rel="noopener ugc nofollow" target="_blank">华尔街下注</a>的最终聚类和排名(使用左上角的符号图表导航)。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/e784c0863d40970e9de0ab3bd67bc62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQZnF1kdSUsEifG9uRtMJA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Rorschach of graph communities of stocks (beige), posts (green), and users (blue).</figcaption></figure><p id="36fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从2020年1月1日到2021年2月28日，每天都有排名前20的帖子。对于投资，从104，605个用户中提取了8，411个帖子和<strong class="ih hj"> 777，516条评论。对于WallStreetBets，从288，645个用户中提取了8，380个帖子和2，219，525条评论。评论数量的差异可能来自于子reddit的大小(1.7M对9.5M)和Reddit基于其自身指标对回复树的默认剪裁。</strong></p><h1 id="82a7" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">构建图表</h1><p id="540f" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">Reddit已经是一个图表，有帖子，有回复的树，还有回复的用户。此外，我们需要提取和链接代表股票符号的节点，并旋转图形，以更好地模拟用户和股票之间的社交互动。</p><p id="5a11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以对于每个帖子，比如这个简单的单个分支的例子:</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es ky"><img src="../Images/8038af6d22c4108340d60fc44cfb2cd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*36VqmfKkpHjry2UHS64-xA.jpeg"/></div></figure><p id="0de2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将创建1个发布节点、4个用户节点(<code class="du kz la lb lc b">AutoModerator, UserA, UserB, UserC</code>)和3个符号节点(<code class="du kz la lb lc b">BRK.B, DGRO, GME</code>)。</p><p id="0cab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将用户和符号连接到单个post节点的边将被创建，其中边权重将与深度成反比，因此<code class="du kz la lb lc b">AutoModerator → Post</code>将具有1的边权重，<code class="du kz la lb lc b">UserA → Post</code>将具有1/2的边权重，<code class="du kz la lb lc b">UserB</code>为1/3，<code class="du kz la lb lc b">UserC</code>为1/4。重量为1/3的<code class="du kz la lb lc b">BRK.B</code>和<code class="du kz la lb lc b">DGRO</code>以及重量为1/4的<code class="du kz la lb lc b">GME</code>也是如此。</p><p id="e625" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">边也将把用户连接到他们在回复链中回复的人，并进行类似的加权。<code class="du kz la lb lc b">UserA → AutoModerator</code>权重为1，<code class="du kz la lb lc b">UserB → UserA</code>权重为1，<code class="du kz la lb lc b">UserB → AutoModerator</code>权重为1/2，以此类推。用户被进一步连接到回复链中提到的符号，使得<code class="du kz la lb lc b">UserC → GME</code>的权重为1，<code class="du kz la lb lc b">UserC → BRK.B, DGRO</code>的权重为1/2，而<code class="du kz la lb lc b">UserB → BRK.B, DGRO</code>的权重为1。</p><p id="8c34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一篇文章的结果图看起来像这样，文章用绿色，符号用米色，用户用蓝色。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ld"><img src="../Images/64b273af4d3d6c32a0b66e7ac16740e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cO7Y6mpVSHiL97lKc-um9A.png"/></div></div></figure><p id="5cea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r/Investing的结果图是116，696个节点和3，803，470条边的图；和11，616，316条边的图。</p><h1 id="53cd" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">聚类和排序</h1><p id="cc86" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">这是一个50个节点的图，考虑到多达300，00个节点的完整图，我们首先需要对节点进行聚类和排序，以便我们可以分割和考虑各个子图。</p><p id="95f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<a class="ae je" href="https://en.wikipedia.org/wiki/Louvain_method" rel="noopener ugc nofollow" target="_blank"> Louvain </a>模块性，我们能够对图进行聚类(这样每个节点只能属于一个聚类)以达到两个目的。使用只有边的有向图来划分用户和帖子的符号，我们能够形成包含许多帖子和用户，但只有一个符号的聚类。这种聚类允许我们查询特定股票代码的图表，例如<code class="du kz la lb lc b">BRK.B</code>，以找到该代码最有影响力的帖子和用户。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es le"><img src="../Images/cca2df904cb7843486ee57e0bfea160a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-X3wNCVSk9H_1LGt1qA_VA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">BRK.B subgraph in r/Investing</figcaption></figure><p id="afef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过在聚类之前将边改变为无方向的符号，我们现在还可以查询相似的符号，其中我们发现<code class="du kz la lb lc b">BRK.A, BRK.B</code>和<code class="du kz la lb lc b">BH</code>聚集在同一个社区中。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lf"><img src="../Images/c12f7badd526b42456b9da0669908961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8c0jD9vISqnNxgqwbepDpQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">BRK.B subgraph with similar symbols in r/Investing</figcaption></figure><p id="4d8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r/wsb中的另一个展示了<code class="du kz la lb lc b">PINS</code>和<code class="du kz la lb lc b">ETSY</code>在单个社区中的聚集，以及<code class="du kz la lb lc b">CRM</code>与多个企业云公司(如<code class="du kz la lb lc b">OKTA, TWLO, VEEV,</code>和<code class="du kz la lb lc b">WDAY</code>)的聚集。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lg"><img src="../Images/daffa2ea065b238521bce2f41874300b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DIRICToKirpODa8JvW4NCw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">PINS subgraph in r/wsb</figcaption></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lh"><img src="../Images/5cf5b7bb5751065914efba57b78342e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWzw3nIJc5K7Tl2Df_BabQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">CRM subgraph in r/wsb</figcaption></figure><p id="e899" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以通过符号查询热门帖子和用户，以及基于常见用户和帖子的类似符号。<a class="ae je" href="https://en.wikipedia.org/wiki/PageRank" rel="noopener ugc nofollow" target="_blank">由边“深度分数”加权的PageRank </a>然后可以用于对结果进行排序，因为这些子图也变得相当大。</p><p id="010b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以将这些结果放到仪表板上(用于<a class="ae je" href="https://public.tableau.com/profile/zuye.zheng#!/vizhome/GraphAnalyticsonrInvesting/rInvesting" rel="noopener ugc nofollow" target="_blank"> r/Investing </a>和<a class="ae je" href="https://public.tableau.com/profile/zuye.zheng#!/vizhome/GraphAnalyticsonrWallStreetBets/rWallStreetBets" rel="noopener ugc nofollow" target="_blank"> r/WallStreetBets </a>)，以便更容易地探索社区。选择左上方的一个符号将过滤其他3个图表中的热门用户和该符号以及类似符号的帖子。</p><p id="b96c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快速检查一下，DFW大学在r/wsb中的GME排名第二。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es li"><img src="../Images/3a4fa684ed8aca09fe2b8d43fa0c8622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RaRIxJwVLMK5BwRBxHfvrQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Top Users, Posts and similar Symbols of GME on r/wsb</figcaption></figure><h1 id="f3ce" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">权重和情绪的支持票</h1><p id="5d24" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">Upvotes似乎是边缘权重的一个明确选择，通常用于这些子区域中帖子的“情绪”分类，正面意义为看涨，负面意义为看跌。然而，我认为赞成票更像是大众认同和情绪的同义词。我可以说一只特定的股票将会崩溃，这是一种悲观的情绪，会被投票赞成，或者一只特别不受欢迎的股票将会下跌。</p><p id="61e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，作为权重的向上投票(尽管提取到图表中)似乎赋予特定帖子或回复更普遍的认同，而不是这些用户、帖子和符号的相关性有多强。尽管存在边缘<a class="ae je" href="https://www.reddit.com/r/wallstreetbets/comments/libn68/screw_with_the_hedgefunds/" rel="noopener ugc nofollow" target="_blank">情况</a>，但是反向深度分数似乎工作得很好。</p><h1 id="8a6d" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">符号识别</h1><p id="77a4" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated">文本中的股票符号识别实际上并不简单。排名前三的交易所中有大约9000个符号，其中许多与常用词和首字母缩略词相同，从HOLD到CEO到DD再到YOLO。</p><p id="711e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个稍微严格的正则表达式，查看所有大写单词或那些以<code class="du kz la lb lc b">$</code>开头或包含<code class="du kz la lb lc b">:</code>的单词(如在纽约证券交易所:PLTR)似乎就足够了，但a肯定会导致许多误报，正如可以看到的YOLO和DD在符号列表中名列前茅。</p><p id="1b13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个更健壮的方法是像定制训练的NER模型一样，考虑句子的语法。</p><h1 id="9b80" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">代码</h1><p id="3e45" class="pw-post-body-paragraph if ig hi ih b ii kt ik il im ku io ip iq kv is it iu kw iw ix iy kx ja jb jc hb bi translated"><a class="ae je" href="https://github.com/zuyezheng/RedditSentiment" rel="noopener ugc nofollow" target="_blank">https://github.com/zuyezheng/RedditSentiment</a></p><h1 id="50a9" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">[数]子图</h1><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lj"><img src="../Images/392f5e09b86e9dd14a96b6fc036c59e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svXD1_lzyiE1CakpKog9PA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lk"><img src="../Images/2643000f9a7ab9e9f24aa2aa493a6f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y_TseKK1AmMyo0P7Qxc2Wg.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ll"><img src="../Images/8580b9a53efed1c5d0c74ca47b9d057a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_vyGvbv4TsiDDZRu0h8uQ.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lm"><img src="../Images/22b1419b6f37b1cfb36887f0b0d56857.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvxetdy85oLNfhWRbjHnKQ.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ln"><img src="../Images/2c387a3dd51572caa163fddea38af5c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nsbRoBym3xAjt2jF3MlfwA.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lo"><img src="../Images/3b89fb7e7e0be57819ebede1252ef006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iDkugMvp9_waSdy1TO3ZtQ.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lk"><img src="../Images/4bf8ccb04411e072b512361fc751706d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBV0XoGG41iJM__D_ZC4nw.png"/></div></div></figure></div></div>    
</body>
</html>
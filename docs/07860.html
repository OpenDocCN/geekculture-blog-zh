<html>
<head>
<title>Hack This Site: Realistic Web Mission — Level 7</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客这个网站:现实的网络任务-第7级</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-7-7404c9909c39?source=collection_archive---------14-----------------------#2021-10-04">https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-7-7404c9909c39?source=collection_archive---------14-----------------------#2021-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/97edc72e38178b4038970642c5d58c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRe3q7YMLF7XwCUrmnjv_w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Hack This Site: Realistic Web Mission — Level 7</figcaption></figure><p id="bfd5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢您的光临，今天我们来看看<a class="ae js" href="https://hackthissite.org/" rel="noopener ugc nofollow" target="_blank">黑掉这个网站</a>现实网络任务第7级。这次挑战非常有趣。不管这个网站的黑客历史有多长，它仍然是测试你黑客技能的最具沉浸感的平台之一。所使用的技术今天仍然适用。然而，许多你肯定不希望在大公司网站上发现的漏洞。如果你没有看过我在现实系列上的其他帖子，你可以在这里看到:<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-missions-level-1/" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-2/" rel="noopener ugc nofollow" target="_blank">第二部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-3/" rel="noopener ugc nofollow" target="_blank">第三部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-4/" rel="noopener ugc nofollow" target="_blank">第四部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-5/" rel="noopener ugc nofollow" target="_blank">第五部分</a>和<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-6/" rel="noopener ugc nofollow" target="_blank">第六部分</a>。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/11ef935540ac95d73249d8f330a54a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*oqfgGpsQ3_JfDOEN"/></div><figcaption class="iq ir et er es is it bd b be z dx">What’s Right For America</figcaption></figure><h1 id="1946" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="c13a" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">导航到此挑战，您将收到来自FreedomOfChoice的消息。套用这条信息，他们解释了他们是如何发现一个要求黑客攻击的仇恨言论网站的。该网站是一个仇视同性恋的网站，喜欢规定其他人应该如何生活。令人担忧的是，尽管这些挑战由来已久，但这些问题在今天仍然具有相关性。我猜进展很慢。我跑题了，FreedomOfChoice想让我们黑进网站的管理区，他认为这个管理区藏在目录结构的某个地方。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/8759018df251de5210a7c92c172158f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*NydpV9omWDjGnSOk"/></div><figcaption class="iq ir et er es is it bd b be z dx">Message From FreedomOfChoice</figcaption></figure><h1 id="15b7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">探索Web应用程序</h1><p id="6fbc" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">在访问这个应用程序时，我们看到的是标准的仇恨言论，互联网可以少用一些。不过没关系，通过我们的努力，这个网站将不复存在。乍一看，这个网站似乎相当简单，只有几个超链接。我们需要更深入地研究应用程序的黑暗角落，以找到我们可以利用的东西。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/615386db1a2fee21e6077153397b7e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*0MMEC8c6f_4kjY8I"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application</figcaption></figure><p id="25eb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">点击应用程序后，我注意到它以一种奇怪的方式调用图像文件。这很奇怪，因为它似乎是在执行本地文件包含来访问文本文件。本地文件包含立即敲响了警钟。如您所见，showimages.php脚本有一个名为file的参数，它调用patriot.txt</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/e5c4fefb34dcfce04f0474efaf8d6f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*03Q3EsdvWPXTPdBv"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — File Parameter</figcaption></figure><p id="3558" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们导航到patriot.txt，我们可以看到它有一个图像目录中的图像列表。这是一种将图像嵌入网站的奇怪方式。或许，我们可以利用这一点。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/06c7501ba6a45d9cc6eebd31b6f75767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/0*ze5FFmcQEbeyDslY"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Patriot.txt</figcaption></figure><h1 id="59ce" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Web目录列表已启用</h1><p id="0324" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">导航到图像目录，我们已经得分。如您所见，下图显示启用了目录列表。请注意，网络安全的一个重要因素是尽量减少信息泄露。启用目录列表可能会泄露有关应用程序的信息，如其结构、使用的技术，甚至通过可读文件泄露其他敏感信息。似乎有一个管理目录。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/569f6be7aff782e41a34f4a0ebf9b6c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*Gct8MtZTbupf0YFL"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Directory Listing</figcaption></figure><p id="aa2f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">试图访问admin目录会给我们预期的未授权错误信息。但是，登录提示似乎是由htaccess和htpasswd文件组合生成的。以前，我们看到的其他挑战使用SQL支持的应用程序登录。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/166b3db86224450f89e11690ee90b89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*13GC88VrFWG7Wloh"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Authentication Failure</figcaption></figure><h1 id="433f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">开发Web应用程序</h1><p id="1474" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">此时，可以安全地假设应用程序正在使用htpasswd进行身份验证。我们还知道file参数执行本地文件包含来获取图像文件。总而言之，也许我们可以利用本地文件包含来获得我们的优势，并列出管理目录的内容，而无需进行身份验证。</p><p id="f913" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了测试这一点，我使用了一个叫做DIRB的工具。DIRB是一个目录和文件暴力工具。管理目录的位置在/images/admin，所以我告诉DIRB通过showimages.php搜索这个目录？文件=参数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/bef26fd9138cf2a6677ff0f1afca2edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*xmJg0MYd3IFQjycb"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — DIRB Directory Brute Force</figcaption></figure><h1 id="fc0a" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Web本地文件包含</h1><p id="bb10" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">上图显示了运行DIRB的结果。如您所见，DIRB发现了隐藏在admin目录中的htaccess和htpasswd文件。这也意味着，我们可以使用showimages.php。file=参数来读取这些文件的内容。让我们从htaccess文件开始。从下图可以看出，htaccess文件引用的是htpasswd文件。这证实了我们的怀疑，它被用于认证。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/624c2eca76f31a6fc046e666aef4a47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*MrBrPr_wvPPJHp_e"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — .htaccess File</figcaption></figure><p id="a369" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，如果我们去查看htpasswd文件。我们可以看到htpasswd文件包含管理员用户的密码散列。或许，我们可以破解这个密码散列，并使用它登录到应用程序的管理区域。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/110d99eda32986bcd37537061cc3ab17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*zbOHEK42U4sACMOz"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — .htpasswd File</figcaption></figure><h1 id="bedc" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">哈希破解</h1><p id="93ea" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">散列保存在一个名为hash.txt的文件中，我们启动我们的Linux ParrotOS虚拟机，并请我们亲爱的老朋友John The Ripper为我们破解它。我没有提供任何标志，我只是把文件指给约翰，他就开始工作了。约翰很快识别出这是一个MD5散列。鉴于我是在虚拟机上运行密码，约翰破解密码的速度也快得惊人。然而，我假设shadow在默认单词列表中的位置相当高。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/c375fa2f65ab938a6825d1830b54a481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*b8NguGEwc3GH9izJ"/></div><figcaption class="iq ir et er es is it bd b be z dx">John The Ripper — Hash Cracking</figcaption></figure><p id="658f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">随着哈希的破解和密码的保存，我们可以导航回/images/admin目录，看看我们新获得的管理员密码是否有效。当登录框弹出时，输入用户名administrator和密码shadow。点击登录，你应该通过验证。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/146f154e8b0138eb2f395b014dc36b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/0*-XYwL67yT7gcJYIX"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Authenticating</figcaption></figure><p id="81ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">至此，你应该完成了，祝贺你现在已经完成了一个现实的7。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es le"><img src="../Images/4dbbdb05fed858ce1532017d512cad53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/0*A6J7tpgEvquyS9N5"/></div><figcaption class="iq ir et er es is it bd b be z dx">Congratulations</figcaption></figure><h1 id="4c7a" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="5ee2" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">这项任务中有相当多的部分需要分解。让我们把目录列出来，因为这是我们以前接触过的东西。目录列表会将敏感信息暴露给公众。在大多数web服务器上关闭是相当容易的，这样做将限制恶意行为者可以获得的关于环境的信息量。</p><p id="429b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">本地文件包含是我们用来收集应用程序信息的下一项技术。我很高兴看到应用程序使用了相对路径而不是绝对路径。这最大限度地减少了信息泄露，但问题在于应用程序调用图像文件的方式。它没有将它们硬编码到源代码中，而是使用了一个参数。这允许我们利用该参数的信任，并使用它来调用web服务器上的其他文件。</p><p id="c3f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">许可也很宽松。这个参数允许我们访问admin目录中的文件，这是不可能的。</p><p id="511b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">无论如何，我感觉有点像马后炮队长，所以随着挑战的完成，我希望你喜欢这篇文章。请稍后回来查看更多黑客攻击。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lf lg l"/></div></figure></div></div>    
</body>
</html>
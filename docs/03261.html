<html>
<head>
<title>Webflow form processing using nodemailer &amp; Firebase cloud functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用nodemailer和Firebase云函数的Webflow表单处理</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/webflow-form-processing-using-nodemailer-firebase-cloud-functions-da41672371b8?source=collection_archive---------24-----------------------#2021-06-04">https://medium.com/geekculture/webflow-form-processing-using-nodemailer-firebase-cloud-functions-da41672371b8?source=collection_archive---------24-----------------------#2021-06-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9a27f49b0d2f136a5762aa32f1ddbddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CM9huz4LAXIhtvs1gptlhg@2x.png"/></div></div></figure><p id="ec14" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Webflow太神奇了。真的是。</p><p id="7981" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">构建自己的表单也不例外。他们使得在你的网站中设计、构建和使用任何形式都变得非常容易。</p><p id="75f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么，如果这么简单，为什么还要费神去阅读这个指南并创建自己的第三方表单处理器呢？</p><p id="de34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在一些情况下，Webflow并不是最佳解决方案。</p><p id="327c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最常见的一个问题发生在想要导出代码并将其托管在Webflow本身以外的其他平台上时。</p><p id="4ab2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过导出代码，您可以访问所有的静态前端代码，但是所有花哨、复杂和乏味的后端代码都不见了。这包括任何形式使用的任何可能性。</p><p id="15b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了解决这个问题，Webflow用户通常使用其他非代码工具来处理表单数据。您会发现一些值得推荐的方法:</p><ul class=""><li id="53a6" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae jx" href="https://formspree.io/" rel="noopener ugc nofollow" target="_blank"> Formspree.io </a>(起价8美元/月)</li><li id="6366" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">【Formden.com T2】(9美元/月起)</li><li id="614c" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">Jotform.com<a class="ae jx" href="https://www.jotform.com/" rel="noopener ugc nofollow" target="_blank">(最多100份免费，然后每月24美元)</a></li></ul><p id="886c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我还没有尝试过这些，但我相信他们都很棒。我只是觉得对于这样一个基本工具来说，价格太高了。</p><p id="1d4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是为什么你应该继续阅读。</p><p id="9ccc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本指南将向您展示如何编写您自己的表单数据处理器，它将在99.9%的用例中保持免费(除非您每月处理数万个表单请求)。</p><p id="6382" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以让我们开始吧。</p><h2 id="9132" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">设置</h2><p id="7800" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为了跟进，您需要以下内容:</p><ul class=""><li id="4a88" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">代码编辑器。我爱我的小VSCode。</li><li id="ef4d" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">Webflow帐户</li><li id="ecee" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">煽动性的报道</li><li id="f250" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">安装在计算机上的Node.js</li><li id="ec20" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">outlook / hotmail或Gmail帐户。(在本指南中，我将使用hotmail帐户)</li></ul><p id="0329" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们开始创建一个新的Firebase项目。</p><h2 id="cbf7" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">一个新的消防基地项目</h2><p id="f025" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">我称我的项目为“webflow-node-mail”。建立一个新的Firebase项目非常简单。</p><p id="4339" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">万一你卡住了，你可以通过编码来使用本指南。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/17623bead9d633f0e24330add1069057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*97I8mWpR_d_K-ay3nvJwbA.png"/></div></div></figure><p id="d879" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们想利用Firebase的“云功能”特性。</p><p id="a7d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些基本上是运行在云中的Javascript(节点)函数，每当请求到达其端点时，就会按需调用。</p><p id="8410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这听起来可能很复杂也很吓人，但是相信我，过一会儿你就会明白了。</p><p id="1f23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了在Firebase项目中使用云功能，您不得不将项目升级为“Blaze计划”，</p><p id="0048" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是通过将信用卡/借记卡连接到您的帐户，并选择“火焰计划”选项来完成的。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/7e5c8e5ff69615664dc2a8a626290244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBJb1HYTj66Z2lX_OlSjVg.png"/></div></div></figure><p id="4f64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不过不要担心，除非你每月处理成千上万的表单请求，否则你可能一分钱都不用付。</p><p id="dec9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击此处，您可以了解更多关于Firebase定价计划的信息。(每月多达200万次免费函数调用等。).</p><h2 id="74d8" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">Firebase CLI</h2><p id="1acd" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">好了，让我们设置Firebase CLI，以便能够在您的计算机上本地创建Firebase项目。</p><p id="a6d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开一个终端(例如在VSCode内部),使用下面的命令从NPM直接安装它:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="330a" class="kd ke hi lk b fi lo lp l lq lr">npm install -g firebase-tools</span></pre><p id="3ee0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将在您的计算机上全局安装CLI，使您能够在计算机的任何位置创建新的Firebase项目。太神奇了。</p><p id="eb9d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在使用以下命令登录Firebase:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="9cb4" class="kd ke hi lk b fi lo lp l lq lr">firebase login</span></pre><p id="4645" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">会弹出一个浏览器，你就可以用你的谷歌账户登录了。酷毙了。</p><h2 id="2193" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">火基云函数</h2><p id="39fb" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">现在为您的代码创建一个文件夹，并通过终端导航到该文件夹。我们只是为函数的使用进行初始化，因为我们不需要这个项目的任何其他Firebase特性。</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="7b17" class="kd ke hi lk b fi lo lp l lq lr">firebase init functions</span></pre><p id="a915" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择“使用现有项目”以便将Firebase项目与本地计算机同步。</p><p id="ea7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可能会在终端中看到一些弹出的选项。例如，您可以选择使用Javascript或Typescript，使用Eslint for林挺等。选择你觉得舒服的东西。</p><p id="8d32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，您应该会看到在本地项目文件夹中创建了一些文件和文件夹。</p><p id="f50d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它应该是这样的:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/d14bc7ffefd9896def748ae1574de8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*DQkv0_KOSqSS5DX5wY9cwg.png"/></div></figure><p id="91d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">图像中突出显示的index.js文件是您将在该项目的其余部分使用的文件。在文本编辑器中打开它。</p><p id="692c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Firebase为您提供了一些样板代码，如下所示:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/b8dda16503d1d5775b68d9faa3ffaff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*CfxgRHxJfndPs2hYdDrtWg.png"/></div></figure><p id="100d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">大部分代码将在这个“导出”中编写，每当请求到达其端点时，就会被调用。</p><p id="577b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们开始编码吧。</p><h2 id="f1ab" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">节点邮件程序</h2><p id="bf80" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">Nodemailer是Node.js的一个包，可以让你通过自己的电子邮件帐户发送电子邮件。这是相当简单的工作，并似乎非常适合这样的事情。</p><p id="0d5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在终端中使用以下命令，在“functions”文件夹中安装nodemailer:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="13b7" class="kd ke hi lk b fi lo lp l lq lr">npm install nodemailer</span></pre><h2 id="d370" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">云函数</h2><p id="76de" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">为了让Nodemailer发送电子邮件，我们需要执行以下操作:</p><ul class=""><li id="b1d5" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">创建一个包含我们的电子邮件身份验证的“transporter”对象</li><li id="302e" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">接受来自我们的Webflow表单的数据</li><li id="cc69" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">暂时存储我们的数据</li><li id="234c" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">通过我们的传送器把数据发送到我们的邮箱</li></ul><p id="b776" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，使用下面的代码在index.js文件中导入nodemailer包:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="b85a" class="kd ke hi lk b fi lo lp l lq lr">const nodemailer = require("nodemailer");</span></pre><p id="11cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在创建传送器。它应该包含以下属性:</p><ul class=""><li id="6bc0" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">您想使用的服务(在我的例子中是hotmail)</li><li id="5dfa" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">您的用户名和密码</li><li id="d54b" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">某种node.js TLSSocket选项(tbh我并不完全了解这个选项的用途，但是如果它有效的话，它就有效)。</li></ul><p id="2873" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，让我们创建一个新的对象，如下所示:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="9125" class="kd ke hi lk b fi lo lp l lq lr">const transporter = nodemailer.createTransport({</span><span id="e66f" class="kd ke hi lk b fi lu lp l lq lr">  service: "hotmail",</span><span id="17d1" class="kd ke hi lk b fi lu lp l lq lr">  auth: {</span><span id="a8a7" class="kd ke hi lk b fi lu lp l lq lr">    user: "youremail@hotmail.se",</span><span id="8eee" class="kd ke hi lk b fi lu lp l lq lr">    pass: "yourpassword",</span><span id="5a40" class="kd ke hi lk b fi lu lp l lq lr">  },</span><span id="4616" class="kd ke hi lk b fi lu lp l lq lr">  tls: {</span><span id="c230" class="kd ke hi lk b fi lu lp l lq lr">    rejectUnauthorized: false,</span><span id="2b5a" class="kd ke hi lk b fi lu lp l lq lr">  },</span><span id="6a29" class="kd ke hi lk b fi lu lp l lq lr">});</span></pre><p id="806f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们继续我们的选项对象。如前所述，我们希望用通过表单发送的数据填充它。</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="cfe0" class="kd ke hi lk b fi lo lp l lq lr">const subject = req.body.subject;<br/>const name = req.body.name;<br/>const message = req.body.message;</span><span id="f7b8" class="kd ke hi lk b fi lu lp l lq lr">const options = {</span><span id="38eb" class="kd ke hi lk b fi lu lp l lq lr">  from: "youremail@hotmail.se",</span><span id="8c6a" class="kd ke hi lk b fi lu lp l lq lr">  to: "youremail@hotmail.se",</span><span id="9e78" class="kd ke hi lk b fi lu lp l lq lr">  subject: subject,</span><span id="0c69" class="kd ke hi lk b fi lu lp l lq lr">  html: `&lt;b&gt;Message sent from ${name}&lt;/b&gt;&lt;br&gt;&lt;br&gt;${message}`,</span><span id="0c0f" class="kd ke hi lk b fi lu lp l lq lr">};</span></pre><p id="e4bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如您所见，我使用了request (short: req)变量来访问发送到端点的任何数据。</p><p id="5777" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些名称基于您在Webflow中对表单输入的命名，因此请确保您记住了它们。我的如下:</p><ul class=""><li id="154e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">名称(req.body.name)</li><li id="43c0" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">主题(请求主体主题)</li><li id="14af" class="jo jp hi is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated">消息(req.body.message)</li></ul><p id="2bc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据表单的大小，您可以拥有任意多或任意少的数据属性。</p><p id="1c27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在您的“选项对象”中，您应该指定电子邮件地址从哪个帐户发送，以及它应该发送到哪个地址。</p><p id="8cd3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您需要使用上面验证的电子邮件作为您的“发件人”电子邮件，但是数据可以发送到一个或多个不同的地址。</p><p id="c0fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想将它发送给多个地址，您可以创建一个地址数组，如下所示:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="4e8e" class="kd ke hi lk b fi lo lp l lq lr">to: ["youremail@hotmail.se", "anotheremail@hotmail.com"]</span></pre><p id="eea2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你也可以使用html来设计你的邮件，就像我在options对象中使用“HTML”属性一样。</p><p id="5841" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我只是简单地为名称使用了粗体文本样式，并为消息使用了几个换行符。</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="3104" class="kd ke hi lk b fi lo lp l lq lr">html: `&lt;b&gt;Message sent from ${name}&lt;/b&gt;&lt;br&gt;&lt;br&gt;${message}`</span></pre><p id="98a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，现在我们可以访问函数中的数据了。让我们把它进一步发送到我们的电子邮件地址。</p><p id="b925" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要在transporter对象中使用一个名为“sendMail”的方法。我们能够指定我们希望在成功和错误时发生什么。</p><p id="2126" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在Webflow项目中创建了两个页面，分别名为“成功”和“错误”(与使用原生表单类似)，并根据成功或错误简单地将用户重定向到其中一个页面。</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="8730" class="kd ke hi lk b fi lo lp l lq lr">transporter.sendMail(options, function(err) {</span><span id="d93a" class="kd ke hi lk b fi lu lp l lq lr">  // Error</span><span id="b610" class="kd ke hi lk b fi lu lp l lq lr">  if (err) {</span><span id="4e84" class="kd ke hi lk b fi lu lp l lq lr">    return res.redirect("https://node-mailer-  form.webflow.io/error");</span><span id="ce29" class="kd ke hi lk b fi lu lp l lq lr">  }</span><span id="907c" class="kd ke hi lk b fi lu lp l lq lr">  // Success</span><span id="9312" class="kd ke hi lk b fi lu lp l lq lr">  return res.redirect("https://node-mailer-form.webflow.io/success");</span><span id="0772" class="kd ke hi lk b fi lu lp l lq lr">});</span></pre><p id="b489" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是我们的功能。检查，复制和/或修改下面的完整代码。</p><p id="641f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">密码</p><p id="a2e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们需要部署该功能。我们通过在终端中使用以下命令来实现这一点:</p><pre class="le lf lg lh fd lj lk ll lm aw ln bi"><span id="3090" class="kd ke hi lk b fi lo lp l lq lr">firebase deploy</span></pre><p id="d05d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这么简单。太神奇了。</p><p id="4817" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">部署可能需要一点时间，但应该会在一两分钟内完成。完成后，您应该会看到类似这样的内容:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/f74e47d4c36d75d8067369972f528b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yd40pNdlm1bhNgaMTRUYlg.png"/></div></div></figure><p id="34f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们转到Webflow并创建我们的表单。</p><p id="64f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下是我的函数的完整代码:</p><figure class="le lf lg lh fd ij"><div class="bz dy l di"><div class="lv lw l"/></div></figure><h2 id="0324" class="kd ke hi bd kf kg kh ki kj kk kl km kn jb ko kp kq jf kr ks kt jj ku kv kw kx bi translated">Webflow表单</h2><p id="02f0" class="pw-post-body-paragraph iq ir hi is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">我的表单非常简单，但是在这个例子中效果很好。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/c3b4c0176048207b41d39ebb84f991b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrpdMp4N-xDC7cTlPkl-bQ.png"/></div></div></figure><p id="8ba6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，正确命名输入极其重要。如前所述，我们的nodemailer函数中使用了输入的名称。</p><p id="8011" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下是我的电子邮件输入设置示例:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/fca52fe4c0b3670b153b9ec3e81ca968.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*RSs2rHv63WweYfnRk6qQ8Q.png"/></div></figure><p id="7f23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有输入字段的名称属性应该与我们的云函数中使用的名称相关联。</p><p id="0823" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们需要为表单指定一个动作端点。进入你的<a class="ae jx" href="https://console.firebase.google.com/u/0/" rel="noopener ugc nofollow" target="_blank"> Firebase控制台</a>，进入你的项目并导航到“功能”。</p><p id="b967" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，您应该可以找到您部署的函数。</p><p id="3611" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只需复制并粘贴您功能的URL，并将其作为您的“操作URL”粘贴到Webflow的表单设置中。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/423327581b3a7bd1d258e466e53fca6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2G56VM2BMROtQ805k8DWw.png"/></div></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/7da04770278f1520e361aeeca62f44c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*Yv8Z8_7U_VqfwFA3pkPz7w.png"/></div></figure><p id="c482" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后一部分是将你的表单方法从GET改为POST。太神奇了。</p><p id="a1a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们可以测试我们的形式。发布您的Webflow站点并发送提交内容。</p><p id="5d96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果一切正常，您应该被重定向到您在函数中指定的任何url，并且您的收件箱应该看起来像这样:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/62fb269f5bc8e2ae4131ecbd9102e015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWEkEFyzZHi4b1nt9VJOyQ.png"/></div></div></figure><p id="6e24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">女士们先生们，这就是全部。</p><p id="1cb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你现在已经创建了你自己的、可修改的、免费的、非常漂亮的小云函数，它能够为你处理任何表单数据。</p><p id="1e6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有任何问题，请随时留下评论，我会尽量回复。</p><p id="c122" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">玩得开心，</p><p id="a0f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">知更鸟🤙</p></div></div>    
</body>
</html>
<html>
<head>
<title>Using JavaScript to Display ActiveRecord Validation Errors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript显示ActiveRecord验证错误</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-javascript-to-display-activerecord-validation-errors-ecce915212c0?source=collection_archive---------11-----------------------#2021-08-10">https://medium.com/geekculture/using-javascript-to-display-activerecord-validation-errors-ecce915212c0?source=collection_archive---------11-----------------------#2021-08-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a5e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博客探讨了ActiveRecord提供的几种服务器端验证方法，以及如何在JavaScript的帮助下以用户友好的方式显示它们。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="0bbc" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">什么是验证？</h1><p id="541d" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在编程环境中，验证是指检查和/或证明数据输入的有效性、相关性和准确性的过程。它的范围从检查是否填写了必需的年龄字段到检查信用卡号是否有效。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="9af2" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">为什么验证很重要？</h1><p id="0a61" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">验证是非常重要的，因为它是程序员或软件开发人员确保输入的数据准确且有用的一种方式。它避免了程序员错误地授权未经验证的用户，同时还能够以所需的方式组织用户输入，而不必遍历数据库中的所有数据。</p><p id="6db8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，验证也有助于避免边缘情况，并确保程序在其设计的情况下运行。通过数据验证，程序员可以不必为所有可能的用户输入编写条件。相反，简单的数据验证将确保用户只能输入满足某些预定义要求的数据。</p><p id="3d4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是说，尽管数据验证看起来像是一个额外的高级功能，可能会减慢您的开发过程，但它非常重要，因为它可以帮助您创建健壮的结果。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="8fd7" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">验证的类型</h1><p id="6178" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">根据它们发生的阶段，有两种主要的验证类型——客户端验证和服务器端验证。</p><ul class=""><li id="7beb" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated"><strong class="ih hj">客户端验证</strong></li></ul><p id="0c72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户端验证是指确保表单输入的格式与填写时的格式一致的过程。它确保用户输入的数据在被发送到服务器进行处理之前符合程序员设定的要求。</p><p id="ef13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种类型的验证对于良好的用户体验非常重要，因为它通知并允许用户在发送输入并被服务器拒绝之前修复输入是否无效。因此，它避免了数据从客户端到服务器来回传输所造成的延迟。不仅如此，它还减少了计算量，从而节省了更多的资源，这对开发人员和客户都有好处。</p><p id="8e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户端验证的一个示例如下:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="711d" class="lf jl hi lb b fi lg lh l li lj">&lt;form&gt;<br/>&lt;input type="text" name="first_name" required&gt;<br/>&lt;/form</span><span id="b20f" class="lf jl hi lb b fi lk lh l li lj">&lt;!-- The "required" keyword in the HTML above makes sure that the user does not submit the form without providing a first name. If the user forgets to do so, the form will not go ahead and send the data to the server. Rather, it does not perform any action until the user fills out the required input field --&gt;</span></pre><ul class=""><li id="3000" class="kn ko hi ih b ii ij im in iq kp iu kq iy kr jc ks kt ku kv bi translated"><strong class="ih hj">服务器端验证</strong></li></ul><p id="3b84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在服务器端验证中，用户的输入由存储在服务器上的代码进行验证。服务器中的后端代码向客户端发送回一个关于输入验证的响应，不管它是否有效。由于客户端无法直接访问服务器端的后端源代码(与前端HTML不同)，因此在服务器端进行验证可以更好地防范任何恶意尝试。在服务器端修改代码比用浏览器的开发工具修改页面的HTML要困难得多。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="9aad" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">为什么最好同时使用服务器端验证和客户端验证</strong></h1><p id="62f3" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">尽管用户友好，但是客户端验证是脆弱和不可靠的。可以通过更改给定网页的前端代码来绕过它们。但是，如果将它们与服务器端验证结合起来，它们的漏洞将不会成为大问题，因为服务器端验证将能够处理任何可能绕过客户端验证的恶意尝试。</p><p id="a9af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，结合使用这两种验证技术有助于开发人员建立健壮的、用户友好的、响应迅速的和详尽的验证。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="a808" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak"> ActiveRecord </strong></h1><p id="cf95" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">按照其官网上的定义，ActiveRecord是“系统中负责表现业务数据和逻辑的层”。它“方便了数据需要持久存储到数据库的业务对象的创建和使用。”更简单地说，它指的是用于管理数据库资源的对象关系映射系统(Ruby编程语言及其Rails开发框架)。</p><p id="47d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了其他几个函数之外，ActiveRecord还为我们提供了几个内置的验证函数，其中一些如下所示:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="808b" class="lf jl hi lb b fi lg lh l li lj">acceptance<br/>validates_associated<br/>confirmation<br/>exclusion<br/>format<br/>inclusion<br/>length<br/>numericality<br/>presence<br/>absence<br/>uniqueness<br/>validates_with<br/>validates_each</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="2c17" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用活动记录验证</h1><p id="58a5" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">ActiveRecord验证通常应用于模型中，我们希望在将数据存储到数据库之前验证这些模型的数据。它们通常遵循以下通用格式:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="241d" class="lf jl hi lb b fi lg lh l li lj">class <strong class="lb hj">className</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :attribute_to_be_validated, validation_method: <strong class="lb hj">parameter</strong><br/>end</span></pre><p id="7143" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是使用内置助手ActiveRecord验证函数的不同验证示例:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="83da" class="lf jl hi lb b fi lg lh l li lj">class <strong class="lb hj">Person</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :name, presence: <strong class="lb hj">true</strong><br/>end</span><span id="5046" class="lf jl hi lb b fi lk lh l li lj">#=&gt; Return this if the name attribute is blank: ActiveRecord::RecordInvalid: Validation failed: Name can't be blank</span><span id="1151" class="lf jl hi lb b fi lk lh l li lj">class <strong class="lb hj">Coffee</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :size, inclusion: { in: %w(small medium large),<br/>    message: "%{value} is not a valid size" }<br/>end</span><span id="8bb1" class="lf jl hi lb b fi lk lh l li lj">#=&gt; We can customize the error message returned by failed validations as we want</span><span id="6b5d" class="lf jl hi lb b fi lk lh l li lj">class <strong class="lb hj">Person</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :name, length: { minimum: 2 }<br/>  validates :bio, length: { maximum: 500 }<br/>  validates :password, length: { in: 6<strong class="lb hj">..</strong>20 }<br/>  validates :registration_number, length: { is: 6 }<br/>end</span><span id="5895" class="lf jl hi lb b fi lk lh l li lj">#=&gt; Validating the character lengths of different attributes</span><span id="b04d" class="lf jl hi lb b fi lk lh l li lj">class <strong class="lb hj">Player</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :points, numericality: <strong class="lb hj">true</strong><br/>  validates :games_played, numericality: { only_integer: <strong class="lb hj">true</strong> }<br/>end</span><span id="75dc" class="lf jl hi lb b fi lk lh l li lj">#=&gt; Validating the data types of different attributes</span></pre><blockquote class="ll lm ln"><p id="1611" class="if ig lo ih b ii ij ik il im in io ip lp ir is it lq iv iw ix lr iz ja jb jc hb bi translated"><a class="ae ls" href="https://guides.rubyonrails.org/active_record_validations.html" rel="noopener ugc nofollow" target="_blank">https://guides . ruby on rails . org/active _ record _ validations . html</a></p></blockquote></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="f9db" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">使用JavaScript显示验证错误</strong></h1><p id="86b5" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">当显示服务器端验证返回的错误消息时，JavaScript就进入了验证的范畴。最简单、最方便的方法是检查某个类函数在控制器中被调用时是否返回错误，如果是，则将错误呈现为JSON。然后，我们可以从前端监听这个响应，并将错误显示为警报或不同的文本形式。</p><p id="18c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是如何实现这一点的简单演示:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ec3a" class="lf jl hi lb b fi lg lh l li lj">In the model...<br/>class <strong class="lb hj">Person</strong> <strong class="lb hj">&lt;</strong> ApplicationRecord<br/>  validates :name, presence: <strong class="lb hj">true</strong><br/>end</span><span id="4e81" class="lf jl hi lb b fi lk lh l li lj">In the controller...<br/>def create<br/>    person = Person.create(person_params)<br/>    if person<br/>        render json: person<br/>    else <br/>        render person.errors.full_messages<br/>    end<br/>end</span><span id="e13f" class="lf jl hi lb b fi lk lh l li lj">In the front-end...<br/>fetch(CORRESPONDING_LINK)<br/>.then(r =&gt; r.json())<br/>.then()<br/>.catch((error) =&gt; {<br/>        alert(error);<br/>    });</span></pre><p id="4ad0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总而言之，数据验证是网站开发中的一个重要步骤，它可以从客户端和服务器端完成。HTML、JavaScript和ActiveRecord可以协同使用，为不同的用户输入创建一个健壮的验证系统。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="2fe3" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">参考作品</h1><div class="lt lu ez fb lv lw"><a href="https://guides.rubyonrails.org/active_record_validations.html" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">活动记录验证——Ruby on Rails指南</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">活动记录验证本指南教你如何在对象进入数据库之前验证它们的状态…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">guides.rubyonrails.org</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk ml lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://www.tjvantoll.com/2015/09/13/fetch-and-errors/" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">用fetch()处理失败的HTTP响应</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">测验:这个对web的新fetch() API的调用是做什么的？fetch("http://httpstat.us/500 ")。然后(function() {…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">www.tjvantoll.com</p></div></div><div class="mf l"><div class="mm l mh mi mj mf mk ml lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="http://net-informations.com/faq/asp/validation.htm#:~:text=In%20the%20Server%20Side%20Validation,new%20dynamically%20generated%20web%20page" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">区分客户端验证和服务器端验证</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">客户端验证与服务器端验证有一个常见的问题，即哪种类型的验证更好或…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">net-informations.com</p></div></div><div class="mf l"><div class="mn l mh mi mj mf mk ml lw"/></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://www.safe.com/what-is/data-validation/" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">什么是数据验证？它的工作原理及其重要性</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">数据验证是任何数据处理任务的重要组成部分，无论您是在现场收集信息…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">www.safe.com</p></div></div></div></a></div><div class="lt lu ez fb lv lw"><a href="https://guides.rubyonrails.org/active_record_basics.html" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">活动记录基础- Ruby on Rails指南</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">活动记录基础本指南介绍了活动记录。看完这本指南，你会知道:什么对象…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">guides.rubyonrails.org</p></div></div><div class="mf l"><div class="mo l mh mi mj mf mk ml lw"/></div></div></a></div></div></div>    
</body>
</html>
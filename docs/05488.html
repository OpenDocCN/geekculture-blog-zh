<html>
<head>
<title>Wavefunction of the 1D Schrodinger Equation using Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Julia研究1D薛定谔方程的波函数</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/wavefunction-of-the-1d-schrodinger-equation-using-julia-ee6c0e89bf67?source=collection_archive---------14-----------------------#2021-07-22">https://medium.com/geekculture/wavefunction-of-the-1d-schrodinger-equation-using-julia-ee6c0e89bf67?source=collection_archive---------14-----------------------#2021-07-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/68a4a2881f75553abdb68bf016d0ad6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9jjTAgwl16RmaPJ7"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">FLY:D</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0cf0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">量子力学的基石之一是波粒二象性。</p><p id="a33f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在显微镜下，事情的表现极不符合直觉。事实上，事物在眨眼之间出现和消失。</p><p id="0c4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">而物质的行为更像波浪，来回波动。</p><p id="074e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些波的控制方程遵循奥地利物理学家欧文·薛定谔发现的薛定谔方程。</p><div class="jt ju ez fb jv jw"><a href="https://en.wikipedia.org/wiki/Schr%C3%B6dinger_equation#Approximate_solutions" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">薛定谔方程-维基百科</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">薛定谔方程是一个线性偏微分方程，它决定了一个原子的波函数</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">en.wikipedia.org</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/f6e4ff808347332bcd7d1cbb7ac69fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-JQKUkHMo-iE4qIki373A.png"/></div></figure><p id="d5f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于这个例子，我们将处理一个最简单的情况。但即便如此，它也需要非同寻常的数学处理。</p><p id="d21e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">被限制在一维盒子里的粒子。</p><p id="d4a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它可能存在于盒子内部的任何地方，但不存在于盒子外部。</p><p id="9e30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个小小的口袋宇宙，如果你愿意的话。</p><figure class="km kn ko kp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/4237c12b5191590073caf02140d2a545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U1-qcEgby8SUz2D8.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The infinite potential well</figcaption></figure><p id="146d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它的行为受二阶微分方程控制，如下所示。</p><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/e64a40a0e7f3cc4a9ef694f337091293.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*-RUyFcA6vyUvNQcJSqcUrQ.png"/></div></figure><p id="e72f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中h_bar是普朗克常数，m是粒子的质量。</p><h1 id="ac26" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">通用解决方案</h1><p id="1337" class="pw-post-body-paragraph iv iw hi ix b iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">二阶微分方程允许以下形式的一般解:</p><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/c66af8a6ef9fc005b2ce573756b0ca7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*TGY6Lis8yGNOMY4AZvhfIA.png"/></div></figure><p id="69d8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">利用<a class="ae iu" href="https://en.wikipedia.org/wiki/Euler%27s_formula" rel="noopener ugc nofollow" target="_blank">欧拉公式</a>计算复数</p><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/d70371033611af558ff7e18670acee06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*WnI65vAQCQhMJXEpeXudww.png"/></div></figure><p id="deaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以将解决方案改写成以下形式:</p><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/75823649268843e2e34de754d67f0a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*gaOdxdz-qt8RnolS83-lQQ.png"/></div></figure><h1 id="bbe0" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">边界条件</h1><p id="5579" class="pw-post-body-paragraph iv iw hi ix b iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">因为粒子被限制在盒子里，所以它不能存在于盒子的边界。</p><p id="3b03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">零点和L点</strong></p><p id="c930" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，</p><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="3444" class="md kt hi lz b fi me mf l mg mh">for x = 0, </span><span id="c93b" class="md kt hi lz b fi mi mf l mg mh">C sin(k(0)) + D cos(k(0)) = 0, </span><span id="baa1" class="md kt hi lz b fi mi mf l mg mh">&gt; D = 0 </span><span id="35e0" class="md kt hi lz b fi mi mf l mg mh"><br/>for x = L, </span><span id="784b" class="md kt hi lz b fi mi mf l mg mh">C sin(kL) + D cos(kL) = 0 <br/>C sin(kL) + 0         = 0</span><span id="ca50" class="md kt hi lz b fi mi mf l mg mh">Csin(kL) = 0<br/>kL = nπ , where n = 1, 2, 3,......</span><span id="b556" class="md kt hi lz b fi mi mf l mg mh">=&gt; <strong class="lz hj">k = nπ/L</strong></span></pre><p id="002d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">c是归一化常数，</p><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="ba4c" class="md kt hi lz b fi me mf l mg mh"><strong class="lz hj">√(2/L) </strong></span></pre><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/a3948c6e76ee0a29348ac39c38405d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*bVOnfkop-_gNzps0Thf8XQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Normalisation of the expression</figcaption></figure><h1 id="78ca" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">波函数</h1><p id="e58e" class="pw-post-body-paragraph iv iw hi ix b iy lq ja jb jc lr je jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">因此我们得到下面给出的波函数。</p><figure class="km kn ko kp fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/d42c9a9a98ccee9bffc90f97b1d154dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*7mejt2ea6NfFu-1rYIPQlQ.png"/></div></figure><p id="b8fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它决定了在井内定位该粒子的概率。</p><h1 id="420a" class="ks kt hi bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">朱莉娅代码</h1><div class="jt ju ez fb jv jw"><a href="https://chem.libretexts.org/Courses/University_of_California_Davis/UCD_Chem_110A%3A_Physical_Chemistry__I/UCD_Chem_110A%3A_Physical_Chemistry_I_%28Larsen%29/Text/03%3A_The_Schrodinger_Equation_and_the_Particle-in-a-Box_Model/3.I%3A_Interactive_Worksheets/3.I.2%3A_Particle_in_an_Infinite_Potential_Box_%28Python_Notebook%29" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">3.I.2:无限势盒中的粒子(Python笔记本)</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">在下一个单元格中，我们将导入笔记本中使用的库，并调用一些重要的函数…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">chem.libretexts.org</p></div></div><div class="kf l"><div class="ml l kh ki kj kf kk io jw"/></div></div></a></div><p id="5fbd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="mm">我实际上偶然发现了上面链接中提供的Python代码片段。</em> </strong></p><p id="8bcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="mm">并决定在Julia中重新编写代码。</em>T11】</strong></p><div class="jt ju ez fb jv jw"><a href="http://docs.juliaplots.org/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">家园地块</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">要开始，请参阅教程。几乎所有的绘图都是通过指定绘图属性来完成的。点击进入…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">docs.juliaplots.org</p></div></div><div class="kf l"><div class="mn l kh ki kj kf kk io jw"/></div></div></a></div><p id="c3b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于不需要特殊的库，我们只需要绘图库<strong class="ix hj">绘图。</strong></p><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="1b85" class="md kt hi lz b fi me mf l mg mh">using Plots<br/>plotly()<br/>Plots.PlotlyBackend()</span><span id="f8b1" class="md kt hi lz b fi mi mf l mg mh">#Declare plotly backend<br/>#At the time of publication, default "GR" backend is glitchy</span></pre><p id="1721" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建波函数并输入相关的输入</p><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="9451" class="md kt hi lz b fi me mf l mg mh"><strong class="lz hj">#Wave function</strong><br/>function Ψ(x,n,L)<br/>    √(2.0/L)*sin(Float16(n*π*x)/L)<br/>end</span><span id="9722" class="md kt hi lz b fi mi mf l mg mh"><strong class="lz hj">#n = energy level (n = 1,2,3, ....  ∞ )<br/>#L = box width in angstrom</strong></span><span id="859f" class="md kt hi lz b fi mi mf l mg mh">L = 20<br/>n =  3<br/>x = 0:0.1:L<br/>y = Ψ.(x,n,L)</span></pre><p id="386e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建绘图以可视化粒子的位置概率。</p><p id="0c11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">波函数提供了定位粒子的<strong class="ix hj">概率振幅</strong>。</p><p id="a2f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要平方它，以便获得<strong class="ix hj">概率分布。</strong></p><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="230e" class="md kt hi lz b fi me mf l mg mh">p1=plot(x,y, w=3, label=”probability amplitude: Ψ(x,$n,$L)”, <br/>xlabel=”x”, ylabel=”Ψ”, ylim=(-1,1))</span><span id="6283" class="md kt hi lz b fi mi mf l mg mh">p2=plot(x,<strong class="lz hj">y.^2</strong>, w=3, label=”probability distribution: Ψ²(x,$n,$L)”, xlabel=”x”, ylabel=”Ψ²”, line=:red)</span><span id="6a32" class="md kt hi lz b fi mi mf l mg mh">plot(p1, p2, layout=(1,2), legend=:bottomright, legendfontsize=7)</span></pre><p id="9650" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从下面的红色图表可以看出，粒子最有可能位于势阱中的三个地方。</p><figure class="km kn ko kp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/97af66f44c64534ff47bb2ecc847ec71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-U5Ize4omEwlHq9LDKvsA.png"/></div></div></figure><p id="6a9b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，为了确保我们的结果是正确的，让我们对psi_square提供的表达式进行积分，以确保我们是正确的。</p><p id="2536" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将在表达式下积分，看看是否能得到值1。</p><p id="c1e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于粒子被限制在盒子里，它在盒子里的可能性必须是100%。</p><p id="57b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">并且我们使用下面的<strong class="ix hj">高斯Konrod积分算法</strong></p><div class="jt ju ez fb jv jw"><a href="https://github.com/JuliaMath/QuadGK.jl" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">GitHub-Julia math/quad GK . JL:Julia中的自适应一维数值高斯-克朗罗德积分</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">文档:这个包在Julia中提供了对一维数值积分的支持，使用自适应…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">github.com</p></div></div><div class="kf l"><div class="mp l kh ki kj kf kk io jw"/></div></div></a></div><pre class="km kn ko kp fd ly lz ma mb aw mc bi"><span id="183c" class="md kt hi lz b fi me mf l mg mh">using QuadGK</span><span id="92db" class="md kt hi lz b fi mi mf l mg mh"><br/>g(x) = (√(2.0/L)*sin(Float64(n*π*x)/L))^2</span><span id="a47e" class="md kt hi lz b fi mi mf l mg mh">integral, err = quadgk(x -&gt; g(x), 0, 20, rtol=1e-5)</span><span id="5350" class="md kt hi lz b fi mi mf l mg mh"><strong class="lz hj"># rtol here refers to the error tolerance. <br/># Often in numerical methods, we cannot obtain an exact solution, and we terminate the solver once it get close enough. </strong></span><span id="910b" class="md kt hi lz b fi mi mf l mg mh">.<br/>.<br/>.</span><span id="e537" class="md kt hi lz b fi mi mf l mg mh">&lt; (1.0, 0.0) &gt; </span></pre><p id="2e1e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">和预期的一样，我们得到了<strong class="ix hj">1的值。</strong></p><p id="93bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于表达式简单到可以求解，相对误差为<strong class="ix hj">零。</strong></p></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><p id="5203" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了方便读者，整个代码被合并在下面。</p><figure class="km kn ko kp fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure></div></div>    
</body>
</html>
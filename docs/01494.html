<html>
<head>
<title>Simple MongoDB Load Testing With YCSB Using EC2, ECS, and Fargate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用EC2、ECS和Fargate对YCSB进行简单的MongoDB负载测试</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/simple-mongodb-load-testing-with-ycsb-using-ec2-ecs-and-fargate-343f828f53fb?source=collection_archive---------9-----------------------#2021-04-12">https://medium.com/geekculture/simple-mongodb-load-testing-with-ycsb-using-ec2-ecs-and-fargate-343f828f53fb?source=collection_archive---------9-----------------------#2021-04-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4107" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MongoDB是市场上最流行的文档数据库之一。从运营的角度来看，我们有很多不同的选项来设置MongoDB。为了进行简单的比较，我们将在AWS上下文中进行比较，以测试哪个选项最适合您设置MongoDB。在工具方面，我们将使用来自Yahoo的流行的YCSB来运行负载测试。由于本文没有演示Terraform脚本，如果需要，我们将简单地复制该脚本。不过，欢迎你来探索我的地形设置。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="13a4" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">先决条件</h1><p id="2bb2" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">如果你喜欢按照设置来，你可以查看一下这个<a class="ae kn" href="https://github.com/jazztong/mongo-load-test-tf" rel="noopener ugc nofollow" target="_blank">源代码</a>，自己准备下面的环境和工具。</p><ol class=""><li id="a759" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">Visual Studio代码(首选)</li><li id="1951" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">AWS帐户(如果您没有)</li><li id="aa6a" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">在本地设置AWS帐户</li><li id="01df" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">安装Terraform (0.14.9+)</li></ol></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="439c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">高级图表</h1><p id="86c9" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">一切都要从一张图开始。下图解释了整个设置。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lc"><img src="../Images/f38f8abffe02928d40cd64ed61100541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*liDi9YVg9_JA1VB_gkNEGw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">YCSB MongoDB test setup</figcaption></figure><h1 id="cb09" class="jk jl hi bd jm jn ls jp jq jr lt jt ju jv lu jx jy jz lv kb kc kd lw kf kg kh bi translated">设置说明</h1><p id="93df" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">我们将设置4组不同的堆栈，它们是:-</p><h2 id="6ec5" class="lx jl hi bd jm ly lz ma jq mb mc md ju iq me mf jy iu mg mh kc iy mi mj kg mk bi translated">测试客户</h2><p id="f421" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">EC2客户端安装YCSB来加载MongoDB，MongoDB运行在M5。大型实例类型以避免CPU瓶颈。</p><h2 id="43ed" class="lx jl hi bd jm ly lz ma jq mb mc md ju iq me mf jy iu mg mh kc iy mi mj kg mk bi translated">Mongo-EC2服务</h2><p id="b55c" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">与M5一起在EC2中运行的MongoDB服务。具有1000 IOPS IO1卷的大型实例类型和EBS根存储。</p><h2 id="2591" class="lx jl hi bd jm ly lz ma jq mb mc md ju iq me mf jy iu mg mh kc iy mi mj kg mk bi translated">蒙戈-法尔盖特服务公司</h2><p id="0f5d" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">一个运行在ECS Fargate中的MongoDB服务，具有2个vCPU和8GB Ram。它附有EFS卷，用于永久存储。</p><h2 id="d5de" class="lx jl hi bd jm ly lz ma jq mb mc md ju iq me mf jy iu mg mh kc iy mi mj kg mk bi translated">Mongo-ECS服务</h2><p id="f455" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在ECS中运行的MongoDB服务，具有EC2启动类型。EC2与M5建立了联系。具有1000 IOPS IO1卷的大型实例类型和EBS根存储。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="2b2f" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">MongoDB版本</h1><p id="c6c7" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">MongoDB社区版将在所有测试中使用。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="926c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">YCSB设置</h1><p id="ac3a" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated"><a class="ae kn" href="https://github.com/brianfrankcooper/YCSB" rel="noopener ugc nofollow" target="_blank"> YCSB </a>代表<strong class="ih hj">雅虎云服务基准</strong>。它用于对各种非SQL数据库进行基准测试。它有不同类型的工作负载来执行测试。为了简单起见，我们将只执行一个负载测试工作负载。我们将运行100个并发线程，测试500，000条记录的数据，其中1条记录的平均大小为1KB。下面的YCSB命令用于执行加载。</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="5e2d" class="lx jl hi mm b fi mq mr l ms mt">./bin/ycsb load mongodb -s -P workloads/workloada -p recordcount=500000 -threads 100 -p mongodb.url="mongodb://root:mypassword@mongo-ec2.loadtest.internel:27017/admin"</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="ec65" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">检验并构建您的环境</h1><p id="ec96" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">下载源代码，用Visual Studio代码打开它。你应该得到这样的东西。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es mu"><img src="../Images/30f330932ea2bf66fc9b978d40b1af01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*UWPVCnFkndCuGmKfxq1d-A.png"/></div></figure><p id="3f92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行以下terraform命令来配置基础架构。</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="1e77" class="lx jl hi mm b fi mq mr l ms mt">export AWS_DEFAULT_REGION=ap-southeast-1<br/>terraform init<br/>terraform plan<br/>terraform apply --auto-approve</span></pre><p id="4613" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得以下输出结果:-</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mv"><img src="../Images/cfd3a6e5c702f9e14519b8c7275c3776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5BCYglHsQRkSAiA_AUjzg.png"/></div></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="e07c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">使用SSM登录并执行加载</h1><p id="3c0b" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">为了方便起见，所有ec2都配置为允许SSM登录。你可以参考这本<a class="ae kn" href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager-working-with-sessions-start.html#start-ec2-console" rel="noopener ugc nofollow" target="_blank">SSM指南</a>。</p><p id="5b6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在AWS控制台中打开您的EC2仪表板，查看如下列表:-</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mw"><img src="../Images/938dd20537ed270078071e5531fe824f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2z3OANFmIXPmkP81elHtjQ.png"/></div></div></figure><p id="abd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用SSM连接名为<strong class="ih hj"> testclient-ec2-load-test </strong>的ec2</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mx"><img src="../Images/ab12e925c117604bdc2c2ea46b5fde03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RfQew2xXrwHdvvPPiUPH-g.png"/></div></div></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es my"><img src="../Images/1f0e01bbd9da8d0a6c141f0e667a6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgPTMtOzoWJxWWuys3I1gA.png"/></div></div></figure><p id="0542" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">登录SSM浏览器外壳后，使用命令<code class="du mz na nb mm b">sudo su</code>切换到超级用户以运行YCSB命令。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="28bc" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">运行Mongo EC2负载测试</h1><p id="7237" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">在SSM控制台中，使用以下命令运行Mongo EC2负载测试。因为专用DNS被有意配置为对所有DNS保持相同，所以您只需复制并运行:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="1dfe" class="lx jl hi mm b fi mq mr l ms mt">cd /ycsb-0.17.0</span><span id="0a94" class="lx jl hi mm b fi nc mr l ms mt">./bin/ycsb load mongodb -s -P workloads/workloada -p recordcount=500000 -threads 100 -p mongodb.url="mongodb://root:mypassword@mongo-ec2.loadtest.internel:27017/admin"</span></pre><p id="12f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得以下结果:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="4929" class="lx jl hi mm b fi mq mr l ms mt">[OVERALL], RunTime(ms), 48170</span><span id="27da" class="lx jl hi mm b fi nc mr l ms mt">[OVERALL], Throughput(ops/sec), 10379.904504878556</span><span id="f337" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_Scavenge], Count, 136</span><span id="c150" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_Scavenge], Time(ms), 325</span><span id="456f" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.6746937928171061</span><span id="d12f" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_MarkSweep], Count, 0</span><span id="564d" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 0</span><span id="5d15" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0</span><span id="3447" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCs], Count, 136</span><span id="e934" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME], Time(ms), 325</span><span id="6f8f" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%], Time(%), 0.6746937928171061</span><span id="4a95" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], Operations, 100</span><span id="89fd" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], AverageLatency(us), 32.24</span><span id="7b25" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MinLatency(us), 0</span><span id="3dc7" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MaxLatency(us), 3167</span><span id="9b6b" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 95thPercentileLatency(us), 1</span><span id="60b3" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 99thPercentileLatency(us), 14</span><span id="eb05" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Operations, 500000</span><span id="d228" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], AverageLatency(us), 9436.848092</span><span id="af94" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MinLatency(us), 150</span><span id="6a40" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MaxLatency(us), 6619135</span><span id="fc16" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 95thPercentileLatency(us), 18207</span><span id="4688" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 99thPercentileLatency(us), 46047</span><span id="f85d" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Return=OK, 500000</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="9c2b" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">运行Mongo Fargate负载测试</h1><p id="27fb" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">执行以下命令对Mongo Fargate运行负载测试:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="7ea6" class="lx jl hi mm b fi mq mr l ms mt">./bin/ycsb load mongodb -s -P workloads/workloada -p recordcount=500000 -threads 100 -p mongodb.url="mongodb://root:mypassword@mongo-fargate.fargate.load:27017/admin"</span></pre><p id="e912" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会得到以下结果:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="868a" class="lx jl hi mm b fi mq mr l ms mt">[OVERALL], RunTime(ms), 74961</span><span id="3ae0" class="lx jl hi mm b fi nc mr l ms mt">[OVERALL], Throughput(ops/sec), 6670.135136937874</span><span id="fcd8" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_Scavenge], Count, 203</span><span id="a3b8" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_Scavenge], Time(ms), 417</span><span id="1ce0" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.5562892704206187</span><span id="4420" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_MarkSweep], Count, 0</span><span id="a132" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 0</span><span id="1a69" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0</span><span id="9701" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCs], Count, 203</span><span id="e5a5" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME], Time(ms), 417</span><span id="2617" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%], Time(%), 0.5562892704206187</span><span id="3b30" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], Operations, 100</span><span id="7a74" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], AverageLatency(us), 30.54</span><span id="2080" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MinLatency(us), 0</span><span id="5d2e" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MaxLatency(us), 2959</span><span id="bb55" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 95thPercentileLatency(us), 2</span><span id="08d5" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 99thPercentileLatency(us), 8</span><span id="82b6" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Operations, 500000</span><span id="d547" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], AverageLatency(us), 13731.694948</span><span id="3be4" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MinLatency(us), 1056</span><span id="9e66" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MaxLatency(us), 18743295</span><span id="e54d" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 95thPercentileLatency(us), 28191</span><span id="c8b5" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 99thPercentileLatency(us), 67647</span><span id="3a27" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Return=OK, 500000</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="ebb7" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">运行Mongo ECS负载测试</h1><p id="58ad" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">执行下面的命令，对带有EC2启动类型的Mongo ECS运行负载测试:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="97dd" class="lx jl hi mm b fi mq mr l ms mt">./bin/ycsb load mongodb -s -P workloads/workloada -p recordcount=500000 -threads 100 -p mongodb.url="mongodb://root:mypassword@mongo-ecs.ecs.load:27017/admin"</span></pre><p id="5d9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得以下结果:-</p><pre class="ld le lf lg fd ml mm mn mo aw mp bi"><span id="973d" class="lx jl hi mm b fi mq mr l ms mt">[OVERALL], RunTime(ms), 45572</span><span id="52ed" class="lx jl hi mm b fi nc mr l ms mt">[OVERALL], Throughput(ops/sec), 10971.64925831651</span><span id="d939" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_Scavenge], Count, 136</span><span id="ea7e" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_Scavenge], Time(ms), 304</span><span id="aff2" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_Scavenge], Time(%), 0.6670762749056438</span><span id="a144" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCS_PS_MarkSweep], Count, 0</span><span id="f2aa" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_PS_MarkSweep], Time(ms), 0</span><span id="c261" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%_PS_MarkSweep], Time(%), 0.0</span><span id="0467" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GCs], Count, 136</span><span id="adea" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME], Time(ms), 304</span><span id="b515" class="lx jl hi mm b fi nc mr l ms mt">[TOTAL_GC_TIME_%], Time(%), 0.6670762749056438</span><span id="221a" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], Operations, 100</span><span id="a81b" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], AverageLatency(us), 36.33</span><span id="3bd5" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MinLatency(us), 0</span><span id="6116" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], MaxLatency(us), 3517</span><span id="cd56" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 95thPercentileLatency(us), 2</span><span id="86e2" class="lx jl hi mm b fi nc mr l ms mt">[CLEANUP], 99thPercentileLatency(us), 64</span><span id="be81" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Operations, 500000</span><span id="256b" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], AverageLatency(us), 8879.413404</span><span id="07ac" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MinLatency(us), 149</span><span id="84af" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], MaxLatency(us), 6688767</span><span id="bb84" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 95thPercentileLatency(us), 18639</span><span id="a180" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], 99thPercentileLatency(us), 56287</span><span id="3880" class="lx jl hi mm b fi nc mr l ms mt">[INSERT], Return=OK, 500000</span></pre></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="e1e5" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">重新运行并清理</h1><p id="5ae9" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">如果希望重新运行负载测试，必须删除每次创建的YCSB数据库。在您对测试感到满意之后，您可以运行<code class="du mz na nb mm b">terraform destroy --auto-approve</code>来清理一切。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="5527" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">摘要</h1><p id="cb1e" class="pw-post-body-paragraph if ig hi ih b ii ki ik il im kj io ip iq kk is it iu kl iw ix iy km ja jb jc hb bi translated">下表显示了3种设置之间的比较。</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="nd ne l"/></div></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es nf"><img src="../Images/9c34ae513abf57ad77a7f2f979530d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UY2YAwDjcdnGxMc30eHtRA.png"/></div></div></figure><p id="7d90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个明显的比较是Fargate与EFS设置在写入磁盘时会产生更多的延迟。这反映了AWS <a class="ae kn" href="https://docs.aws.amazon.com/efs/latest/ug/performance.html" rel="noopener ugc nofollow" target="_blank">声称</a>与EBS相比，EFS的每次操作延迟更长。如果使用EC2设置作为基本指标，EFS的Fargate具有<strong class="ih hj"> 55% </strong>更高的延迟。同时，EC2启动类型的ECS具有相同的延迟。</p><p id="9210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据测试结果，建议在基本EC2或ECS中设置MongoDB，使用EC2启动类型而不是Fargate。希望AWS将在Fargate启动类型中宣布EBS支持，以简化docker管理，这需要低延迟的持久存储。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Linear Regression with Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Scikit-Learn进行线性回归</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/linear-regression-with-scikit-learn-84730e49eb9c?source=collection_archive---------9-----------------------#2021-05-08">https://medium.com/geekculture/linear-regression-with-scikit-learn-84730e49eb9c?source=collection_archive---------9-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="59b7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用Python实现线性回归的快速指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f31a3a406604c108027507ae0d750d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gnkLpCuZ5dEXvF4e0ervg.jpeg"/></div></div></figure><h1 id="db4c" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">介绍</h1><p id="4f17" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">线性回归是最简单的机器学习算法，非常适合初学者。事实上，它是如此简单，以至于你今天就可以开始学习机器——就像现在。所以想开始你的机器学习之旅吗？这是一个好的开始。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="fae9" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated"><strong class="ak">什么是线性回归？</strong></h1><p id="1ff5" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">线性回归的目的是确定自变量(解释变量)如何影响因变量(响应变量)。</p><p id="2324" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">你可以把自变量和因变量看成因果关系。自变量是你认为是原因的变量，因变量是结果。例如，在考试环境中，答对问题的数量会导致及格分数。所以答对的题(q)是因(自变量)，那么及格分数(p)就是果(因变量)。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="6515" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated">使用样本数据集解释线性回归</h1><p id="ebc9" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">为了分享我对我所知道的概念和技术的理解，我们将以UCI机器学习知识库上可用的<a class="ae lo" href="https://archive.ics.uci.edu/ml/datasets/Student+Performance" rel="noopener ugc nofollow" target="_blank">学生表现数据集</a>为例，并尝试基于学生行为和学生过去的成绩来预测成绩。</p><p id="15f6" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">出于我们的目的，构建线性回归模型将涉及以下五个步骤:</p><p id="90d1" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated"><strong class="kd hj">步骤1: </strong>导入库/数据集<br/> <strong class="kd hj">步骤2: </strong>数据预处理<br/> <strong class="kd hj">步骤3: </strong>将数据集拆分成训练集和测试集<br/> <strong class="kd hj">步骤4: </strong>将线性回归模型拟合到训练集<br/> <strong class="kd hj">步骤5: </strong>进行预测</p><h1 id="cab7" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">1.导入库/数据集</h1><p id="04bd" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们将从使用熊猫导入数据集开始(遗憾的是，不是这些🐼)并且还导入了numpy、sklearn等其他库。</p><pre class="iy iz ja jb fd lp lq lr ls aw lt bi"><span id="4621" class="lu jk hi lq b fi lv lw l lx ly">import numpy as np<br/>import pandas as pd<br/>import sklearn<br/>from sklearn import linear_model</span></pre><p id="3963" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">注意:无论我能得出什么样的推论，我都提到了要点。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/7ed739922345506b823fd1c84e6f83c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LbU03z_D0iQ4WgywPKQs9g.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><ul class=""><li id="eba0" class="me mf hi kd b ke lj kh lk kk mg ko mh ks mi kw mj mk ml mm bi translated">原始数据用分号分隔符隔开，我们需要做sep = "；"。</li><li id="8f8d" class="me mf hi kd b ke mn kh mo kk mp ko mq ks mr kw mj mk ml mm bi translated"><code class="du ms mt mu lq b">students.head()</code>显示了数据框中前5名学生的属性。</li></ul><h1 id="2689" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">2.数据预处理</h1><p id="844f" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">由于我们有如此多的属性，并且不是所有的都相关，我们需要选择我们想要使用的属性。我们可以通过键入以下命令来实现。在本演练结束时，您可以随意尝试不同的属性以及对模型的影响。</p><p id="578a" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">注意:记住你可以在这里看到每个属性<a class="ae lo" href="https://archive.ics.uci.edu/ml/datasets/Student+Performance" rel="noopener ugc nofollow" target="_blank">的描述。</a></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mv"><img src="../Images/fe157dfb2e53ba1ca25c14ce16a373cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1lTffpBZKjGdImCUsyGfw.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><ul class=""><li id="272b" class="me mf hi kd b ke lj kh lk kk mg ko mh ks mi kw mj mk ml mm bi translated">基于这些属性，我们希望预测学生的最终成绩(G3)。我们的下一步是将数据分为X“特征”(解释变量)和y“目标”(响应变量)。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/28238e0ec812d9d7fd91783347e84c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afWwLQgaSB6x6kBPbKMjnw.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><h1 id="a4de" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">3.将数据集分成训练集和测试集</h1><h2 id="1ef3" class="lu jk hi bd jl mx my mz jp na nb nc jt kk nd ne jv ko nf ng jx ks nh ni jz nj bi translated">为什么要进行拆分？</h2><p id="ce91" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们希望我们的算法学习数据中的相关性，然后根据它所学习的内容做出预测。将数据分成两个不同的集合可以确保我们的线性回归算法不会过度学习。</p><p id="588d" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">想想这个场景:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/c74aec8fad6bd9bb60ea5e72a92520ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O-3VT_dJgng0UXW0h9Focw.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image: <a class="ae lo" href="https://unsplash.com/photos/ORDz1m1-q0I" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a332" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">假设你教一个孩子乘法，让他在小乘法表上练习，也就是从1*1到9*9的所有数字。接下来，你要测试这个孩子是否能够完成同样的乘法运算。结果是成功的。这孩子几乎每次都答对了。</p><p id="33fe" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">问题？你根本不知道这个孩子是否理解乘法，或者只是简单地记住了这个表！所以你要做的是测试孩子的乘法，比如10*12，这是在桌子之外。</p><p id="9bb7" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">这正是为什么我们需要在<em class="nl">看不见的</em>数据上测试机器学习模型。我们检查模型对测试集数据做出的预测是否与数据集中给出的预测相匹配。如果匹配，这意味着我们的模型是准确的，并且做出了正确的预测。否则，我们无法知道该算法是否已经学习了一个可概括的模式，或者只是记住了训练数据。</p><p id="d3fc" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">我们可以通过键入以下内容来拆分该数据集:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nm"><img src="../Images/fcfe4914fe0a91fd0a77d5d6233e4180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_FAjCpKCapZN-_DBcSsTA.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><p id="f0fe" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">对于训练:测试分割，没有理想的比率。但是在本教程中，我们将使用80: 20的比例。即80%作为训练集，20%作为测试集。当然，您可以随意使用其他比率，例如70:30、90:10等</p><h1 id="859a" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">4.将线性回归模型拟合到训练集</h1><p id="d7f8" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">现在我们的数据已经准备好了，我们的第一步是使简单的线性回归模型适合我们的训练集。为此，我们将调用<strong class="kd hj"> fit </strong>方法——函数来将回归变量拟合到训练集。</p><p id="fef4" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">我们需要将X_train(特征矩阵的训练数据)拟合到目标值(y_train)中。因此，该模型学习相关性，并学习如何根据自变量预测因变量。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nn"><img src="../Images/b9a1fec7835a0bb4aceff72a2fa328df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hs35i59ZZuJUniagEk-h8g.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><h1 id="8809" class="jj jk hi bd jl jm jn jo jp jq jr js jt io ju ip jv ir jw is jx iu jy iv jz ka bi translated">5.做预测</h1><p id="0178" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">为了了解我们的算法在测试数据上的表现，我们将使用度量𝑅。𝑅分数显示了回归模型与观察数据的拟合程度。例如，70%的r平方表明70%的数据符合回归模型。通常，较高的r平方表示模型更适合。但是，需要注意的是，高r平方并不总是对回归模型有利。</p><p id="627e" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">我们可以使用<code class="du ms mt mu lq b">.score().</code>获得𝑅的值</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es no"><img src="../Images/e226bee2982cf0f27aef02ead371f3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMrX3O_44r4kaoFFEZ8mgw.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><p id="c5d1" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">对于这个特定的数据集，得分约为87%。现在，如果我们回想一下为什么我们开始这个项目，我们的目标是训练一个线性回归模型，根据学生的行为和学生过去的成绩来预测成绩。看到一个分值很酷，但我们更想看到的是我们的算法在特定学生身上的表现。为此，我们将用这行代码打印模型的预测成绩和我们的实际最终成绩:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es np"><img src="../Images/09ad3a13a7bfb282acf81265596d45d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H20jE24NAUvAuJnbokCF4w.jpeg"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx">Image by Author</figcaption></figure><p id="b01b" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">我们看到大多数的分数都非常接近实际分数，例如，我们预测第一个学生的最终分数是8分，结果是9分。</p><h2 id="2ed7" class="lu jk hi bd jl mx my mz jp na nb nc jt kk nd ne jv ko nf ng jx ks nh ni jz nj bi translated">完整代码:GitHub Gist</h2><p id="266b" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">您可以在该数据集中尝试不同的属性，并查看它如何提高或降低模型的𝑅分数。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="nq nr l"/></div></figure></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="4277" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated">一些线性回归假设</h1><ol class=""><li id="1834" class="me mf hi kd b ke kf kh ki kk ns ko nt ks nu kw nv mk ml mm bi translated"><strong class="kd hj">线性</strong>:X和y的关系是线性的。</li><li id="c741" class="me mf hi kd b ke mn kh mo kk mp ko mq ks mr kw nv mk ml mm bi translated"><strong class="kd hj">没有或很少多重共线性</strong>:当自变量之间的相关性太高时，就会出现多重共线性。</li><li id="e883" class="me mf hi kd b ke mn kh mo kk mp ko mq ks mr kw nv mk ml mm bi translated"><strong class="kd hj">正态</strong>:对于X的任意固定值，Y是正态分布的。</li></ol></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="f048" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated">线性回归的其他实际应用</h1><ul class=""><li id="f6b8" class="me mf hi kd b ke kf kh ki kk ns ko nt ks nu kw mj mk ml mm bi translated"><strong class="kd hj">业务:</strong>随着房屋面积的增加预测房价。</li><li id="f26b" class="me mf hi kd b ke mn kh mo kk mp ko mq ks mr kw mj mk ml mm bi translated"><strong class="kd hj">农业:</strong>测量肥料和水对作物产量的影响。</li><li id="31bb" class="me mf hi kd b ke mn kh mo kk mp ko mq ks mr kw mj mk ml mm bi translated"><strong class="kd hj">医疗保健:</strong>预测烟草消费的影响及其与心脏病的关联。</li></ul></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="30c8" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated">结论</h1><p id="5719" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">请注意，我们关注的是使用Python的Scikit-Learn库实现线性回归，我们没有对线性回归进行任何数学解释。为了有所帮助，我在下面的资源列表中添加了非常棒的教程，以最简单的方式解释了线性回归背后的数学原理。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="f289" class="jj jk hi bd jl jm le jo jp jq lf js jt io lg ip jv ir lh is jx iu li iv jz ka bi translated"><strong class="ak">资源:</strong></h1><p id="0a7e" class="pw-post-body-paragraph kb kc hi kd b ke kf ij kg kh ki im kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">[1]<a class="ae lo" href="https://www.youtube.com/watch?v=ujTCoH21GlA&amp;list=PLzMcBGfZo4-mP7qA9cagf68V06sko5otr" rel="noopener ugc nofollow" target="_blank">Tech With Tim的Python机器学习播放列表</a></p><p id="2e5a" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">[2] <a class="ae lo" href="https://www.youtube.com/watch?v=kHwlB_j7Hkc" rel="noopener ugc nofollow" target="_blank">吴恩达的线性回归</a></p><p id="2814" class="pw-post-body-paragraph kb kc hi kd b ke lj ij kg kh lk im kj kk ll km kn ko lm kq kr ks ln ku kv kw hb bi translated">[3] <a class="ae lo" href="https://www.youtube.com/watch?v=nk2CQITm_eo" rel="noopener ugc nofollow" target="_blank">通过StatQuest进行线性回归</a></p></div></div>    
</body>
</html>
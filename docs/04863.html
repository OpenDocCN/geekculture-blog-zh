<html>
<head>
<title>Deploy Docker Apps on AWS Elastic Beanstalk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS Elastic Beanstalk上部署Docker应用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/deploy-docker-apps-on-aws-elastic-beanstalk-82a0c6871297?source=collection_archive---------14-----------------------#2021-07-05">https://medium.com/geekculture/deploy-docker-apps-on-aws-elastic-beanstalk-82a0c6871297?source=collection_archive---------14-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6878ab66fd09512683c7eb9e8225a9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qdJvE_rUbe4CiakiahW1gA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">AWS Beanstalk + Spring boot</figcaption></figure><h2 id="8d34" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">概观</h2><p id="e71c" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km hb bi translated">Elastic Beanstalk(EB)是一个AWS服务，它在内部利用了亚马逊EC2和S3。它还可以为您部署、管理和扩展应用程序。</p><blockquote class="kn ko kp"><p id="a50e" class="js jt kq ju b jv kr jx jy jz ks kb kc kt ku ke kf kv kw kh ki kx ky kk kl km hb bi translated">AWS Elastic Beanstalk是一个易于使用的服务，用于部署和扩展用Java开发的web应用程序和服务。NET、PHP、Node.js、Python、Ruby、Go、Docker在Apache、Nginx、Passenger、IIS等熟悉的服务器上。</p></blockquote><p id="0abc" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">使用Elastic Beanstalk部署应用程序有多种方式。您可以使用管理控制台、CLI或API进行部署。Elastic Beanstalk的惊人之处在于，一旦你上传了你的应用程序，它就会负责负载平衡、健康监控、伸缩等工作。查看更多关于<a class="ae kz" href="https://aws.amazon.com/elasticbeanstalk/" rel="noopener ugc nofollow" target="_blank">弹性豆茎</a>的信息。</p><p id="ca48" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">在这篇博客中，我们将探讨如何在<a class="ae kz" href="https://aws.amazon.com/elasticbeanstalk/" rel="noopener ugc nofollow" target="_blank"> AWS Elastic Beanstalk </a>上部署docker映像的以下步骤:</p><ol class=""><li id="73dc" class="la lb hi ju b jv kr jz ks jf lc jj ld jn le km lf lg lh li bi translated">用一个简单的控制器创建一个非常简单的<a class="ae kz" href="https://spring.io/projects/spring-boot" rel="noopener ugc nofollow" target="_blank"> Spring Boot </a>应用程序。</li><li id="7827" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">将这个Spring Boot应用程序Docker化，并将其推送到<a class="ae kz" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker hub </a>。</li><li id="43e8" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">从docker hub中提取这个dockerized Spring Boot应用程序映像，并将其部署到<a class="ae kz" href="https://aws.amazon.com/elasticbeanstalk/" rel="noopener ugc nofollow" target="_blank"> Amazon Elastic Beanstalk。</a></li></ol><p id="d0d1" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">因此，本教程分为3个部分:创建应用程序，将应用程序Dockerize，以及使用Elastic Beanstalk部署应用程序。</p><p id="6e3f" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated"><strong class="ju hj"> <em class="kq">注意</em> </strong> <em class="kq">:我跳过第1步和第2步，因为我在之前的</em> <a class="ae kz" href="https://praveeng-nair.medium.com/containerize-your-spring-boot-app-with-jib-plugin-50127d99a22f" rel="noopener"> <em class="kq">帖子</em> </a> <em class="kq">中已经这样做了。你不限于使用我在以前的</em> <a class="ae kz" href="https://praveeng-nair.medium.com/containerize-your-spring-boot-app-with-jib-plugin-50127d99a22f" rel="noopener"> <em class="kq">教程</em> </a> <em class="kq">中创建的一个spring boot应用程序，如果你已经有任何dockerized应用程序，请随意跳过第1和第2部分。</em></p><h2 id="644d" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">要求</h2><ol class=""><li id="0ad6" class="la lb hi ju b jv jw jz ka jf lo jj lp jn lq km lf lg lh li bi translated">创建一个AWS账户。AWS提供了一个免费层，可以访问许多很酷的服务，如亚马逊EC2和S3。</li><li id="9680" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">你也可以下载<a class="ae kz" href="https://docs.docker.com/docker-for-mac/install/" rel="noopener ugc nofollow" target="_blank"> Docker </a>。</li><li id="c45f" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">任何最喜欢的IDE。我选择Visual Studio代码。</li></ol><h1 id="ce37" class="lr iv hi bd iw ls lt lu ja lv lw lx je ly lz ma ji mb mc md jm me mf mg jq mh bi translated">第1部分:创建应用程序</h1><p id="38b5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km hb bi translated">参考我之前的<a class="ae kz" href="https://praveeng-nair.medium.com/containerize-your-spring-boot-app-with-jib-plugin-50127d99a22f" rel="noopener">帖子</a>。</p></div><div class="ab cl mi mj gp mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="hb hc hd he hf"><h1 id="fb3b" class="lr iv hi bd iw ls mp lu ja lv mq lx je ly mr ma ji mb ms md jm me mt mg jq mh bi translated">第2部分:对应用程序进行分类</h1><p id="3811" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km hb bi translated">参考我之前的<a class="ae kz" href="https://praveeng-nair.medium.com/containerize-your-spring-boot-app-with-jib-plugin-50127d99a22f" rel="noopener">帖子</a>。</p></div><div class="ab cl mi mj gp mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="hb hc hd he hf"><h1 id="19d5" class="lr iv hi bd iw ls mp lu ja lv mq lx je ly mr ma ji mb ms md jm me mt mg jq mh bi translated">第3部分:在弹性Beanstalk上部署应用程序</h1><p id="bfd7" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km hb bi translated">无论您选择哪个选项，您总是将单个文件上传到Elastic Beanstalk进行部署。该上传可以是:</p><ol class=""><li id="16c9" class="la lb hi ju b jv kr jz ks jf lc jj ld jn le km lf lg lh li bi translated">一份简单的文件。</li><li id="6353" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">普通的Docker.aws.json文件。</li><li id="80c1" class="la lb hi ju b jv lj jz lk jf ll jj lm jn ln km lf lg lh li bi translated">包含Dockerfile或Dockerrun.aws.json以及其他应用程序资产的Zip文件。</li></ol><p id="abbe" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">我们将使用第二个选项，即<strong class="ju hj"> Dockerrun.aws.json </strong>定义文件，因为我们已经在docker hub中有我们的图像。</p><figure class="mu mv mw mx fd ij"><div class="bz dy l di"><div class="my mz l"/></div></figure><p id="d456" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated"><em class="kq">图像名称</em>:在之前<a class="ae kz" href="https://praveeng-nair.medium.com/containerize-your-spring-boot-app-with-jib-plugin-50127d99a22f" rel="noopener">帖子</a>中创建的docker图像的名称。从<a class="ae kz" href="https://hub.docker.com/layers/104823926/prgnr173/springboot-jib/0.0.1-SNAPSHOT/images/sha256-092c4140156535e128676e616cd57e20e131550afee4098988e68eaa1d4a9044?context=explore" rel="noopener ugc nofollow" target="_blank">对接毂</a>中拉出。如果您想运行任何其他应用程序，只需更新上述文件中的映像名称和端口。</p><ol class=""><li id="e237" class="la lb hi ju b jv kr jz ks jf lc jj ld jn le km lf lg lh li bi translated">登录<a class="ae kz" href="https://console.aws.amazon.com/console/home?#" rel="noopener ugc nofollow" target="_blank"> AWS管理控制台</a>。选择<strong class="ju hj">弹性豆杆</strong>维修。</li></ol><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/73221b5623aef496e47805701cf2abe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79PScewLdVFYx1-ndz-2kQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">AWS Management Console</figcaption></figure><p id="8071" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">2.每个弹性Beanstalk应用程序的第一步都是一样的——只需单击创建应用程序，填写名称和描述:</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/d6c1e1ce635978e7f760f96bc86d3042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j70ozLCouxbWOAACyiFVxw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Create Application</figcaption></figure><p id="aae0" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">3.选择平台<strong class="ju hj"> Docker，</strong>上传Dockerrun.aws.json文件，点击创建应用。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/3ebf3c0d2d6081236d9683ee8e80cb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YOhRydh4jJ6Q9vXYqRU2xQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Upload Dockerrun.aws.json file</figcaption></figure><p id="38c6" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">4.这将在我们的应用程序的后台启动安全组、目标组、负载平衡器、自动扩展组和EC2实例。您可以看到如下的日志。我们可以等到它结束。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/17accbcdd0336f33c1ef07b43f06e682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKy2K-Nb_vJxmtFpyT46Qw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Starting App and logs</figcaption></figure><p id="d883" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">5.一旦部署完成，过一会儿我们会看到一个应用程序创建了主动健康。如果我们点击URL，我们会看到欢迎文本。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/3684ac62b378281e7daf9e70a5ff6af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3NexKVnZ6Z8MOePVB24JUQ.png"/></div></div></figure><p id="d752" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">6.为我们的应用程序创建的默认环境在左侧有健康、事件、平台和其他配置的详细信息，这将帮助您定制应用程序的任何行为。</p><figure class="mu mv mw mx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/d6f84d53eacc220412bf3303335a43ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcJjEXFK_DevxjyUWkXURg.png"/></div></div></figure><pre class="mu mv mw mx fd nc nd ne nf aw ng bi"><span id="6683" class="iu iv hi nd b fi nh ni l nj nk">$ curl http://springbootsample-env.eba-m9amqwhu.ap-southeast-2.elasticbeanstalk.com/</span><span id="930d" class="iu iv hi nd b fi nl ni l nj nk">Welcome to Jib sample app</span></pre><h2 id="3093" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">摘要</h2><p id="5737" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km hb bi translated">就这么简单。只需点击几下，我们就可以在AWS Elastic Beanstalk上部署我们的dockerized应用程序。我们可以使用AWS CLI命令执行相同的步骤。</p><p id="3389" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">您不需要担心手动设置EC2实例、供应或扩展，所有这些都由Elastic Beanstalk为您完成。请记住，使用Elastic Beanstalk，您不仅限于使用Docker或CLI，Elastic Beanstalk为您提供了使用多种语言和平台的选项，以及适合您需求的不同应用部署方式。</p><p id="d5e0" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">现在，如果您已经注意到在beanstalk中创建的URL是一个<strong class="ju hj"> HTTP </strong> URL。由于<strong class="ju hj"/>是rest通信的安全方式，我们将在我的下一篇<a class="ae kz" href="https://praveeng-nair.medium.com/installing-a-self-signed-ssl-certificate-on-aws-elastic-beanstalk-1d4acd2c0cd" rel="noopener">帖子</a>中看到，我们如何为beanstalk应用程序创建一个<strong class="ju hj"> HTTPS </strong> url。</p><p id="803e" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc jf ku ke kf jj kw kh ki jn ky kk kl km hb bi translated">编码快乐！！</p><h2 id="d671" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">参考</h2><div class="nm nn ez fb no np"><a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create_deploy_docker.html" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hj fi z dy nu ea eb nv ed ef hh bi translated">从Docker容器部署弹性Beanstalk应用程序</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">Elastic Beanstalk支持从Docker容器部署web应用程序。使用Docker容器，您可以…</h3></div><div class="nx l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">docs.aws.amazon.com</p></div></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Create Digital Signature Using RSA in Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Go中使用RSA创建数字签名</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-digital-signature-using-rsa-in-go-8da82552f028?source=collection_archive---------5-----------------------#2021-03-21">https://medium.com/geekculture/create-digital-signature-using-rsa-in-go-8da82552f028?source=collection_archive---------5-----------------------#2021-03-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f312" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">你收到你祖母的一封转账信，但是信上没有她的签名。你能转账吗？我希望你不要。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/bf25b57f56a33882702447c07591a4d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7ughhI2CqdZqcoqt.jpg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Cover Photo by <a class="ae jn" href="https://unsplash.com/@skillscouter?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">SkillScouter</a> on <a class="ae jn" href="https://unsplash.com/s/photos/signature?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="11b3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">签名是确保信息真实性的最常见方式。自罗马帝国时代就有了。具有讽刺意味的是，在这个数字时代，有许多公司和应用程序在没有适当的数字签名的情况下进行交互。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="3f56" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">项目范围</h1><p id="a291" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">构建一个简单的go应用程序，它基于示例文本创建签名。然后验证签名是否为有效签名。</p><p id="7f7b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">社区图书馆</p><ul class=""><li id="0429" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">壁垒:<a class="ae jn" href="https://github.com/purnaresa/bulwark" rel="noopener ugc nofollow" target="_blank">https://github.com/purnaresa/bulwark</a></li></ul></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="94df" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">已完成的项目预览</h1><p id="e12c" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">通过调用go build文件在命令shell中运行应用程序。</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="52ce" class="mc ks hi ly b fi md me l mf mg">go run main.go</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/f1375f8a9186e4aced71d43eecb862db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7mDtI4TioAj8T42J.png"/></div></div></figure><p id="02fb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，应用程序打印出伪明文。然后它创建一个签名。如果创建签名成功，签名将被打印出来。最后一部分是应用程序验证明文的签名。如果验证成功，它将打印成功消息。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="08e5" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">应用设计</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/469827285de7034ac6df0554d607410d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XDrzt1ir3IlR-HI6.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Example Application Design</figcaption></figure><blockquote class="mj mk ml"><p id="d3a3" class="jo jp mm jq b jr js ij jt ju jv im jw mn jy jz ka mo kc kd ke mp kg kh ki kj hb bi translated"><em class="hi">在继续之前，请订阅我们的网站，如果我们有新的教程内容，您会得到通知。</em></p></blockquote></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="5386" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">密码</h1><h1 id="7b80" class="kr ks hi bd kt ku mq kw kx ky mr la lb io ms ip ld ir mt is lf iu mu iv lh li bi translated">主要应用</h1><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="9259" class="mc ks hi ly b fi md me l mf mg">package main</span><span id="b6dc" class="mc ks hi ly b fi mv me l mf mg">import (<br/>	"log"</span><span id="4ccb" class="mc ks hi ly b fi mv me l mf mg">	"github.com/purnaresa/bulwark/crypto"<br/>)</span><span id="7128" class="mc ks hi ly b fi mv me l mf mg">func main() {<br/>	// provision key pair<br/>	privateKey, publicKey, err := crypto.GenerateKeyPair()<br/>	if err != nil {<br/>		log.Fatalln(err)<br/>	}</span><span id="d07e" class="mc ks hi ly b fi mv me l mf mg">	// create dummy plaintext<br/>	plaintext := []byte("hello, my name is plaintext")<br/>	log.Printf("plaintext : %s\n\n", string(plaintext))</span><span id="e8be" class="mc ks hi ly b fi mv me l mf mg">	// create signature<br/>	log.Println("creating signature...")<br/>	signature, err := crypto.SignDefault(plaintext, privateKey)<br/>	if err != nil {<br/>		log.Fatalln(err)<br/>	} else {<br/>		log.Printf("signature : %s\n\n", string(signature))<br/>	}</span><span id="0262" class="mc ks hi ly b fi mv me l mf mg">	// verify signature<br/>	log.Println("verifying signature and plaintext...")<br/>	errVerify := crypto.VerifyDefault(plaintext, publicKey, signature)<br/>	if errVerify != nil {<br/>		log.Fatalln(errVerify)<br/>	} else {<br/>		log.Println("verification success!")<br/>	}</span><span id="8241" class="mc ks hi ly b fi mv me l mf mg">}</span></pre><p id="a2cc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">上面的代码是main.go的完整代码，下面我们将对代码进行分解并给出解释。</p><p id="dad0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">第一部分:提供密钥对</strong></p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="b78f" class="mc ks hi ly b fi md me l mf mg">privateKey, publicKey, err := crypto.GenerateKeyPair()<br/>	if err != nil {<br/>		log.Fatalln(err)<br/>	}</span></pre><p id="d37a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在生产环境中，RSA密钥对是在系统之外提供的。您必须将私钥存储在安全的地方。整体而言——如果您的私钥被泄露，签名就是有缺陷的，因为签名不能保证其真实性。公钥应该与和你通信的伙伴共享。如果您的私钥泄露，请生成新的密钥对！</p><p id="6863" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了简单起见，这个项目中的密钥对是动态生成的。</p><p id="1cdd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">第2部分:创建伪明文</strong></p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="1b6d" class="mc ks hi ly b fi md me l mf mg">plaintext := []byte("hello, my name is plaintext")<br/>log.Printf("plaintext : %s\n\n", string(plaintext))</span></pre><p id="235f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你可以加密任何东西，只要它是字节格式的。重要的是明文的大小。RSA只能加密有限大小的明文。在大多数情况下，加密短信就足够了。如果您需要加密像图像或pdf这样的大数据，请使用双重加密方法。首先，使用AES/symmetrical用随机生成的密钥加密文件。然后使用RSA加密生成的密钥。</p><p id="3bef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">第3部分:创建签名</strong></p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="7b40" class="mc ks hi ly b fi md me l mf mg">log.Println("creating signature...")<br/>signature, err := crypto.SignDefault(plaintext, privateKey)<br/>	if err != nil {<br/>		log.Fatalln(err)<br/>	} else {<br/>		log.Printf("signature : %s\n\n", string(signature))<br/>	}</span></pre><p id="e866" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">用私钥对明文签名。输出是一个签名，可以使用密钥对中的公钥进行验证。签名是使用随机数发生器创建的。即使明文相同，每次签名也会不同。</p><p id="c953" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">创建签名的用例就在将数据和签名一起发送给合作伙伴之前。如果您的应用程序正在处理个人身份信息(PII)，您将需要加密数据。加密前基于明文创建签名。如果您在加密后创建签名，攻击者可能会破坏(修改)签名，从而导致验证失败，因此信息不会得到处理。通过加密密文和签名来保护信息。</p><p id="0a10" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">第4部分:验证签名</strong></p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="2868" class="mc ks hi ly b fi md me l mf mg">log.Println("verifying signature and plaintext...")<br/>errVerify := crypto.VerifyDefault(plaintext, publicKey, signature)<br/>	if errVerify != nil {<br/>		log.Fatalln(errVerify)<br/>	} else {<br/>		log.Println("verification success!")<br/>	}</span></pre><p id="383b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">必须使用签名创建者的公钥来验证签名。明文是检验签名是否有效的必要材料。如果验证失败，它将返回一个错误对象。</p><p id="db6f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在生产场景中，验证签名的是您正在与之通信的伙伴。因此，您必须与他们共享您的公钥，以便他们验证签名。</p><h1 id="75f3" class="kr ks hi bd kt ku mq kw kx ky mr la lb io ms ip ld ir mt is lf iu mu iv lh li bi translated">图书馆</h1><p id="9a20" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">上面的主要应用程序是从</p><pre class="iy iz ja jb fd lx ly lz ma aw mb bi"><span id="4505" class="mc ks hi ly b fi md me l mf mg">"github.com/purnaresa/bulwark/crypto"</span></pre><p id="b75e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是一个安全应用架构库。该应用中使用的三个功能是:</p><ul class=""><li id="2a54" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">GenerateKeyPair()</li><li id="91db" class="lo lp hi jq b jr mw ju mx jx my kb mz kf na kj lt lu lv lw bi translated">SignDefault(明文[]字节，私钥[]字节)(签名字符串，err错误)</li><li id="bdfe" class="lo lp hi jq b jr mw ju mx jx my kb mz kf na kj lt lu lv lw bi translated">VerifyDefault(明文[]字节，公钥[]字节，签名字符串)(err错误)</li></ul><p id="db3d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> GenerateKeyPair </strong>是生成RSA密钥对的函数。函数的细节和例子可以在这篇文章中找到<a class="ae jn" href="https://www.purnaresa.co/build-rsa-private-public-key-generator-in-go/" rel="noopener ugc nofollow" target="_blank">在Go </a>中生成RSA私钥-公钥对</p><p id="1017" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> SignDefault </strong>是创建签名的函数。输入是明文和私钥。输出是base64字符串的签名，以便于存储和传送。该功能对于大多数用例都是灵活的。如果您需要了解引擎盖下的情况，请查看此<a class="ae jn" href="https://github.com/purnaresa/bulwark/blob/master/crypto/encryption_public.go" rel="noopener ugc nofollow" target="_blank"> Github代码</a>。</p><p id="c283" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> VerifyDefault </strong>是验证签名的函数。输入是明文、公钥和公钥。如果验证成功，输出是一个空的错误对象。如果您需要了解引擎盖下的情况，请查看此<a class="ae jn" href="https://github.com/purnaresa/bulwark/blob/master/crypto/encryption_public.go" rel="noopener ugc nofollow" target="_blank"> Github代码</a>。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h1 id="c336" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">摘要</h1><p id="4f38" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">创建数字签名很容易。许多社区图书馆可供使用。你可以用一个你信任的。重要的是确保这些库的规范符合行业标准。如果规范不符合行业标准，与您通信的合作伙伴将很难验证签名</p><p id="af56" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">此处提供示例代码:</p><p id="9f24" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae jn" href="https://github.com/purnaresa/bulwark/blob/master/crypto/example/create_signature/main.go" rel="noopener ugc nofollow" target="_blank">https://github . com/purnaresa/bulwark/blob/master/crypto/example/create _ signature/main . go</a></p></div></div>    
</body>
</html>
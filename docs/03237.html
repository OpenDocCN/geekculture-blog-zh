<html>
<head>
<title>Redux with React’s Functional Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Redux with React的功能组件</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/redux-with-reacts-functional-components-272f1008ee69?source=collection_archive---------0-----------------------#2021-06-04">https://medium.com/geekculture/redux-with-reacts-functional-components-272f1008ee69?source=collection_archive---------0-----------------------#2021-06-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ff8f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用Redux的useSelector和useDispatch钩子</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/88273c5b489e9dfddf6a6442cc1b9337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPzq9sMr8Vq4ALjI83dBfw.png"/></div></div></figure><p id="69f7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在阅读本文之前，您应该熟悉Redux是什么以及如何在React类组件中使用它。</p><h1 id="4567" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">设置</h1><p id="52e0" class="pw-post-body-paragraph jj jk hi jl b jm ky ij jo jp kz im jr js la ju jv jw lb jy jz ka lc kc kd ke hb bi translated">首先创建一个新的react应用程序。我将使用一个名为Redux Toolkit的包来快速设置应用程序的外壳。如果您想进行同样的跑步:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="51b7" class="li kh hi le b fi lj lk l ll lm">npx create-react-app my-app --template redux</span></pre><p id="5f94" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这将创建您的React应用程序，使用官方模板来使用Redux。然后在您的应用程序中运行:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="b105" class="li kh hi le b fi lj lk l ll lm">npm install @reduxjs/toolkit react-redux<br/>npm install redux</span></pre><p id="2f6f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在src/app/store.js中创建以下内容:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="d5dd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，转到index.js，像这样包装您的应用程序组件:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="3749" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在你已经准备好了。</p><h2 id="eef5" class="li kh hi bd ki lp lq lr km ls lt lu kq js lv lw ks jw lx ly ku ka lz ma kw mb bi translated">计数器组件</h2><p id="487b" class="pw-post-body-paragraph jj jk hi jl b jm ky ij jo jp kz im jr js la ju jv jw lb jy jz ka lc kc kd ke hb bi translated">对于这个例子，我们将创建一个简单的计数器。</p><p id="aa4d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">当使用类组件时，您会看到类似这样的内容:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="7e9f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这是标准的Redux设置，其中我们使用mapStateToProps来访问Redux存储上的属性，这些属性可作为Props供我们的组件使用，然后将操作分派给我们的reducer(也可作为props使用),以便更新这些属性。</p><p id="e5b7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然而当使用钩子时，我们需要做一些不同的事情。</p><h1 id="8e48" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">使用选择器</h1><p id="56f4" class="pw-post-body-paragraph jj jk hi jl b jm ky ij jo jp kz im jr js la ju jv jw lb jy jz ka lc kc kd ke hb bi translated">useSelector钩子是我们如何在组件中模拟mapStateToProps函数的。</p><p id="569e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">首先从“react-redux”导入useSelector。</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="50e8" class="li kh hi le b fi lj lk l ll lm">import { useSelector} from 'react-redux'</span></pre><p id="60a8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">与useState挂钩非常相似，您将在组件顶部声明一个变量，并将其设置为等于useSelector函数的返回值。useSelector函数将另一个函数作为其参数。这个函数将传递整个状态对象作为它的参数。</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="3bc0" class="li kh hi le b fi lj lk l ll lm">const count = useSelector((state) =&gt; state.counter)</span></pre><p id="8bf7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因此，基本上，您正在编写一个以state为参数的函数，然后返回该state对象的一些属性(在本例中是计数器的值)。然后，您将该函数传递给useSelector，后者赋予该函数访问状态对象的权限。然后，在函数内部将函数的返回值赋给声明的变量(在本例中为count)。</p><p id="3d81" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对你来说够困惑了吧？</p><p id="4945" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">本质上是这样的:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="671f" class="li kh hi le b fi lj lk l ll lm">const mapStateToProps = (state, props) = {</span><span id="17d3" class="li kh hi le b fi mc lk l ll lm">  counter: state.counter,</span><span id="1afb" class="li kh hi le b fi mc lk l ll lm">  user: state.user</span><span id="d9a2" class="li kh hi le b fi mc lk l ll lm">}</span></pre><p id="5834" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">还有这个:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="fbdc" class="li kh hi le b fi lj lk l ll lm">const count = useSelector((state) =&gt; state.counter)</span><span id="100c" class="li kh hi le b fi mc lk l ll lm">const user = useSelector((state) =&gt; state.user)</span></pre><p id="2d46" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">做着完全相同的事情，只是语法略有不同。</p><h1 id="eeb8" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">使用显示器</h1><p id="bf68" class="pw-post-body-paragraph jj jk hi jl b jm ky ij jo jp kz im jr js la ju jv jw lb jy jz ka lc kc kd ke hb bi translated">在我看来，useDispatch其实简单多了。这让我想起了很多使用历史。</p><p id="1efd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">首先，我们需要导入它:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="e27d" class="li kh hi le b fi lj lk l ll lm">import { useSelector, <strong class="le hj">useHistory</strong>} from 'react-redux'</span></pre><p id="c622" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，您需要做的就是将它放在组件的顶部:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="4e1e" class="li kh hi le b fi lj lk l ll lm">const dispatch = useDispatch()</span></pre><p id="1bc8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，您有一个名为dispatch的函数，它会将您传递的任何内容发送给reducer。它实际上比mapDispatchToProps简单得多。就像之前我们想从redux/actions导入我们的动作一样</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="263e" class="li kh hi le b fi lj lk l ll lm">import { incrementCounter, decrementCounter } from '../redux/actions/counterActions.js'</span></pre><p id="158e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但是，我们可以这样做，而不是完成将这些功能添加到另一个功能，然后将外部功能映射到我们的道具的整个复杂过程:</p><pre class="iy iz ja jb fd ld le lf lg aw lh bi"><span id="63c0" class="li kh hi le b fi lj lk l ll lm">onClick={() =&gt; dispatch(decrementCounter())}</span></pre><p id="d298" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">不需要任何道具，我们在JSX中用一行代码就定义了这个函数！</p><p id="c441" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最终组件将如下所示:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ln lo l"/></div></figure><p id="d07f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">注意，我们不再需要组件导出底部的connect函数来使Redux正常工作。</p><p id="bf22" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">还有一个快速介绍使用Redux和钩子的方法！</p><p id="b35d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><em class="md">更多内容尽在</em><a class="ae kf" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="md">plain English . io</em></a></p></div></div>    
</body>
</html>
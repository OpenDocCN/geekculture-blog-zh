<html>
<head>
<title>Setup Social Authentication in Django Rest Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Django Rest框架中设置社会认证</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/setup-social-authentication-in-django-rest-framework-1afdb675375f?source=collection_archive---------0-----------------------#2020-09-16">https://medium.com/geekculture/setup-social-authentication-in-django-rest-framework-1afdb675375f?source=collection_archive---------0-----------------------#2020-09-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1ba037d88c2fb6c0891a5b65cc2115e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d45k7N1jYjHujiscEg4IPA.jpeg"/></div></div></figure><p id="5dcb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随着全球互联网用户的激增，以及人们接受和访问数字产品，带来最佳用户体验并留住许多访客用户已成为许多应用程序的目标。社交认证旨在简化访问者的登录过程，从而提高用户注册的转化率。</p><p id="c438" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一些优势包括:</p><ul class=""><li id="171b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">更快的注册</li><li id="121c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">少记一个登录凭证</li><li id="fb60" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">更少的失败登录尝试。</li><li id="793f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">更轻松的移动体验。</li><li id="8af2" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">用户体验可以更加个性化和有针对性。</li></ul><p id="8c75" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样的例子不胜枚举。</p><h1 id="881d" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">背景</h1><p id="f92c" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">我最近需要为谷歌和脸书的社交提供商实现社交登录API。我曾多次尝试让它工作并与客户端应用程序对话，但事实证明这很有挑战性😧。</p><p id="e94a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">唉，我们得到了与客户端应用程序通信的社会认证API😊，在本教程中，我将向您展示如何轻松实现脸书社交登录。</p><p id="1bbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">假设。</strong>读者对Python、Django Rest框架和API有一些经验。</p><p id="7d64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将社交认证集成到应用程序的服务器端需要:</p><ul class=""><li id="0c7d" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">选定的社交认证提供商</li><li id="ef33" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">对社交认证提供者的登录请求</li><li id="f1ae" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">来自登录的身份验证令牌，用于访问受保护的API路由。</li></ul><p id="777f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开始之前，</p><ul class=""><li id="2166" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">前往<a class="ae lf" href="https://developers.facebook.com/apps/" rel="noopener ugc nofollow" target="_blank">脸书开发商</a>页面</li><li id="407c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建一个社交应用</li><li id="c97a" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">在仪表板上，设置&gt;&gt;基本，添加“应用程序域”和“站点URL ”,可以是任何URL，并记住在本地机器的<code class="du lg lh li lj b">/etc/hosts</code>文件中设置URL。</li><li id="6d31" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">复制FACEBOOK_APP_ID和FACEBOOK_APP_SECRET，并将它们设置为项目的环境变量。环境文件。</li></ul><p id="04eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一切就绪，让我们配置Django应用程序；</p><p id="3dd8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个项目中，我们将使用<a class="ae lf" href="https://django-rest-auth.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank"> django-rest-auth </a>库。该包旨在通过提供一组REST API端点来简化注册和认证任务。</p><p id="cfe1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.)安装django-rest-auth包:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="2f3e" class="ls kd hi lj b fi lt lu l lv lw">pip install django-rest-auth</span></pre><p id="b669" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.)将rest_auth app添加到Django <a class="ae lf" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中的INSTALLED_APPS中:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="79b6" class="ls kd hi lj b fi lt lu l lv lw">INSTALLED_APPS = ( ..., 'rest_framework', 'rest_framework.authtoken', ..., 'rest_auth' )</span></pre><p id="5bc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.)添加rest _ auth URLs:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="d86b" class="ls kd hi lj b fi lt lu l lv lw">urlpatterns = [ ..., path('api/&lt;version&gt;/rest-auth/', include('rest_auth.urls')) ]</span></pre><p id="c2ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.)我们还需要安装<a class="ae lf" href="https://django-allauth.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank"> django-allauth </a>包，因为我们需要启用标准注册过程。</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="e1ac" class="ls kd hi lj b fi lt lu l lv lw">pip install django-allauth</span></pre><p id="ce07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.)将django.contrib.sites、allauth、allauth.account、rest_auth.registration应用添加到您的Django <a class="ae lf" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中的INSTALLED_APPS:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="9be8" class="ls kd hi lj b fi lt lu l lv lw">INSTALLED_APPS = ( ..., 'django.contrib.sites', 'allauth', 'allauth.account', 'rest_auth.registration', )</span></pre><p id="63bd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.)将SITE_ID = 1添加到您的Django <a class="ae lf" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a></p><p id="fa1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.)添加rest _ auth.registration urls:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="4382" class="ls kd hi lj b fi lt lu l lv lw">urlpatterns = [ ..., path('api/&lt;version&gt;/rest-auth/', include('rest_auth.urls')), path('api/&lt;version&gt;/rest-auth/registration/', include('rest_auth.registration.urls')) ]</span></pre><p id="0776" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.)将allauth.socialaccount和allauth . social account . providers . Facebook或allauth . social account . providers . Twitter应用添加到您的Django <a class="ae lf" href="http://settings.py" rel="noopener ugc nofollow" target="_blank"> settings.py </a>中的INSTALLED_APPS:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="e49d" class="ls kd hi lj b fi lt lu l lv lw">INSTALLED_APPS = ( ..., 'rest_framework', 'rest_framework.authtoken', 'rest_auth' ..., 'django.contrib.sites', 'allauth', 'allauth.account', 'rest_auth.registration', ..., 'allauth.socialaccount', 'allauth.socialaccount.providers.facebook' )</span></pre><p id="50a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">9.)在Django管理面板中添加社交应用程序</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/e161b5ac0b9ea07ba87aac74b9c15ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XJpap-oZ0lSoaWhB"/></div></div></figure><p id="7e7e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">10.)创建一个新视图作为rest _ auth . registration . views . social log in view的子类:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="f6f8" class="ls kd hi lj b fi lt lu l lv lw">from allauth.socialaccount.providers.facebook.views import FacebookOAuth2Adapter from rest_auth.registration.views import SocialLoginView class FacebookLogin (SocialLoginView): adapter_class = FacebookOAuth2Adapter</span></pre><p id="cefb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">11.)为FacebookLogin登录视图创建一个URL:</p><pre class="lk ll lm ln fd lo lj lp lq aw lr bi"><span id="fe8a" class="ls kd hi lj b fi lt lu l lv lw">urlpatterns += [ path('api/&lt;version&gt;/rest-auth/facebook/', FacebookLogin.as_view(), name='fb_login'), ]</span></pre><p id="c8b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在没有任何身份验证令牌的情况下测试API，并获得适当的响应:</p><figure class="lk ll lm ln fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/a73183b6bf12804556625371006cb188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0Qhk8aFS_QC5k-vX"/></div></div></figure><p id="583c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">TaDa！！！后端社交认证配置已经设置完毕，可以与客户端应用程序通信了。</p><p id="c766" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望您可以通过支持更多的社交认证提供者来改善应用程序的用户体验🤓。</p><p id="e7e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢观众🤗。在<a class="ae lf" href="https://www.github.com/nextwebb" rel="noopener ugc nofollow" target="_blank"> Github </a>、<a class="ae lf" href="https://www.linkedin.com/m/in/peterson-oaikhenah-102645144" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>&amp;&amp;<a class="ae lf" href="https://www.twitter.com/i_am_nextwebb" rel="noopener ugc nofollow" target="_blank">Twitter</a>上与我联系。</p><h1 id="da2b" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">更多资源:</h1><div class="lz ma ez fb mb mc"><a href="https://django-rest-auth.readthedocs.io/en/latest/installation.html" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">Django-Rest-Auth文档</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">这个项目依赖于django-rest-framework库，所以如果您还没有安装它，请安装它。确保你也有…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">django-rest-auth . readthedocs . io</p></div></div></div></a></div><div class="lz ma ez fb mb mc"><a href="https://django-allauth.readthedocs.io/en/latest/installation.html" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hj fi z dy mh ea eb mi ed ef hh bi translated">Django-Allauth文件</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">指定上下文处理器如下:模板= [ { '后端'…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">django-allauth.readthedocs.io</p></div></div></div></a></div></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><p id="957a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="ms">最初发布于</em><a class="ae lf" href="https://nextwebb.hashnode.dev/setup-social-authentication-in-django-rest-framework" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://nextwebb . hashnode . dev</em></a><em class="ms">。</em></p></div></div>    
</body>
</html>
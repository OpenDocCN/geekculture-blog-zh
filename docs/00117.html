<html>
<head>
<title>Tutorial: Generate Swagger Specification and SwaggerUI for Echo Go Web Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:为Echo Go Web框架生成Swagger规范和SwaggerUI</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/tutorial-generate-swagger-specification-and-swaggerui-for-echo-go-web-framework-3ac33afc77e2?source=collection_archive---------0-----------------------#2020-06-20">https://medium.com/geekculture/tutorial-generate-swagger-specification-and-swaggerui-for-echo-go-web-framework-3ac33afc77e2?source=collection_archive---------0-----------------------#2020-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="5c8e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为什么选择Echo Web Framework？</h1><p id="0096" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Echo是最流行的围棋框架之一。<em class="kb"> Echo </em>将自己定位为高性能和极简的web框架。用起来很简单。</p><h1 id="603e" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">为什么要Swagger规范？</h1><p id="721e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">编写规格说明书是软件工程中一个细致的过程。不管怎样，如果我们想让其他人使用我们的API，这是必要的。它帮助其他人更轻松地集成没有API的组件。文档越好，其他人就越容易将它集成到他们的系统中。为了解决这个问题，我们应该遵循行业内创建API文档的标准化方式，即<strong class="jf hj"> </strong> <em class="kb"> OpenAPI规范或</em>原名Swagger规范。</p><blockquote class="kc kd ke"><p id="7c13" class="jd je kb jf b jg kf ji jj jk kg jm jn kh ki jq jr kj kk ju jv kl km jy jz ka hb bi translated">OpenAPI规范，以前被称为Swagger规范，是定义RESTful接口的世界标准。OAS使开发人员能够设计一个技术不可知的API接口，该接口构成了他们的API开发和消费的基础。</p></blockquote></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="30c8" class="if ig hi bd ih ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc bi translated">先决条件</h1><p id="9de0" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">你需要在你的机器上安装Go版本≥1.12。</p><h1 id="0875" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">步伐</h1><ol class=""><li id="5a0c" class="kz la hi jf b jg jh jk jl jo lb js lc jw ld ka le lf lg lh bi translated">为开发创建文件夹，我们将调用应用程序<em class="kb"> echosimple </em>。</li></ol><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="890d" class="lr ig hi ln b fi ls lt l lu lv">$ mkdir echosimple<br/>$ mkdir docs<br/>$ mkdir docs/echosimple</span></pre><p id="cb0b" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">2.为go供应商系统初始化go模式。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="b0be" class="lr ig hi ln b fi ls lt l lu lv">$ go mod init</span></pre><p id="ebc1" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">3.拉动<em class="kb">回显</em>库。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="8537" class="lr ig hi ln b fi ls lt l lu lv">$ go get -v github.com/labstack/echo/v4</span></pre><p id="7dd2" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">4.在<em class="kb"> echosimple </em>文件夹中，创建一个新文件<em class="kb"> main.go </em>并复制<em class="kb">下面的代码。</em></p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="2cec" class="lr ig hi ln b fi ls lt l lu lv"><strong class="ln hj">package </strong>main<br/><br/><strong class="ln hj">import </strong>(<br/>   "net/http"<br/><br/>   "github.com/labstack/echo/v4"<br/>   "github.com/labstack/echo/v4/middleware"<br/>)<br/><br/><strong class="ln hj">func </strong>main() {<br/>   // Echo instance<br/>   <em class="kb">e </em>:= echo.New()<br/><br/>   // Middleware<br/>   <em class="kb">e</em>.Use(middleware.Logger())<br/>   <em class="kb">e</em>.Use(middleware.Recover())<br/>   <em class="kb">e</em>.Use(middleware.CORS())<br/><br/>   // Routes<br/>   <em class="kb">e</em>.GET("/", HealthCheck)<br/><br/>   // Start server<br/>   <em class="kb">e</em>.<strong class="ln hj">Logger</strong>.Fatal(<em class="kb">e</em>.Start(":3000"))<br/>}<br/><br/><strong class="ln hj">func </strong>HealthCheck(<em class="kb">c </em>echo.Context) error {<br/>   <strong class="ln hj">return </strong><em class="kb">c</em>.JSON(http.<em class="kb">StatusOK</em>, <strong class="ln hj">map</strong>[string]<strong class="ln hj">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   })<br/>}</span></pre><p id="7501" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">5.运行应用程序。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="ac70" class="lr ig hi ln b fi ls lt l lu lv">$ go run echosimple/main.go</span></pre><p id="1d71" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">您应该会看到如下所示的输出。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="98ef" class="lr ig hi ln b fi ls lt l lu lv">   ____    __ <br/>  / __/___/ /  ___ <br/> / _// __/ _ \/ _ \ <br/>/___/\__/_//_/\___/ v4.1.16 <br/>High performance, minimalist Go web framework <br/>https://echo.labstack.com <br/>____________________________________O/_______ <br/>                                    O\ <br/>⇨ http server started on [::]:3000</span></pre><p id="7d18" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">这意味着我们的服务器在端口3000上启动并运行。</p><p id="46e0" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">6.通过添加<em class="kb">声明性注释格式</em>来更新我们的<em class="kb"> main.go </em>。这些注释将在以后自动生成<em class="kb"> Swagger规格</em>。您可以使用参考资料中的链接了解更多关于<em class="kb">声明性注释格式</em>的信息。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="7a24" class="lr ig hi ln b fi ls lt l lu lv"><strong class="ln hj">package </strong>main<br/><br/><strong class="ln hj">import </strong>(<br/>   "net/http"<br/><br/>   "github.com/labstack/echo/v4"<br/>   "github.com/labstack/echo/v4/middleware"<br/>)<br/><br/>// @title Echo Swagger Example API<br/>// @version 1.0<br/>// @description This is a sample server server.<br/>// @termsOfService http://swagger.io/terms/<br/><br/>// @contact.name API Support<br/>// @contact.url http://www.swagger.io/support<br/>// @contact.email support@swagger.io<br/><br/>// @license.name Apache 2.0<br/>// @license.url http://www.apache.org/licenses/LICENSE-2.0.html<br/><br/>// @host localhost:3000<br/>// @BasePath /<br/>// @schemes http<br/><strong class="ln hj">func </strong>main() {<br/>   // Echo instance<br/>   <em class="kb">e </em>:= echo.New()<br/><br/>   // Middleware<br/>   <em class="kb">e</em>.Use(middleware.Logger())<br/>   <em class="kb">e</em>.Use(middleware.Recover())<br/>   <em class="kb">e</em>.Use(middleware.CORS())<br/><br/>   // Routes<br/>   <em class="kb">e</em>.GET("/", HealthCheck)<br/><br/>   // Start server<br/>   <em class="kb">e</em>.<strong class="ln hj">Logger</strong>.Fatal(<em class="kb">e</em>.Start(":3000"))<br/>}<br/><br/>// HealthCheck godoc<br/>// @Summary Show the status of server.<br/>// @Description get the status of server.<br/>// @Tags root<br/>// @Accept */*<br/>// @Produce json<br/>// @Success 200 {object} map[string]interface{}<br/>// @Router / [get]<br/><strong class="ln hj">func </strong>HealthCheck(<em class="kb">c </em>echo.Context) error {<br/>   <strong class="ln hj">return </strong><em class="kb">c</em>.JSON(http.<em class="kb">StatusOK</em>, <strong class="ln hj">map</strong>[string]<strong class="ln hj">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   })<br/>}</span></pre><p id="5c0a" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">7.拉招摇图书馆。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="1e5b" class="lr ig hi ln b fi ls lt l lu lv">$ go get -v github.com/swaggo/swag/cmd/swag<br/>$ go get -v github.com/swaggo/echo-swagger</span></pre><p id="336f" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">8.生成<em class="kb">摆动规格</em>。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="7052" class="lr ig hi ln b fi ls lt l lu lv">$ swag init -g echosimple/main.go --output docs/echosimple</span></pre><p id="5f64" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">如果操作成功，您应该在文件夹<em class="kb"> docs/echosimple中看到3个新文件。这些文件是:</em></p><ul class=""><li id="eaaa" class="kz la hi jf b jg kf jk kg jo lw js lx jw ly ka lz lf lg lh bi translated"><em class="kb"> docs.go </em> = &gt;需要生成<em class="kb">swaggeri</em>。</li><li id="f99e" class="kz la hi jf b jg ma jk mb jo mc js md jw me ka lz lf lg lh bi translated"><em class="kb">Swagger . JSON</em>=&gt;<em class="kb">Swagger规范</em>中的<em class="kb"> json </em>文件格式。</li><li id="ad03" class="kz la hi jf b jg ma jk mb jo mc js md jw me ka lz lf lg lh bi translated"><em class="kb">Swagger . YAML</em>=&gt;<em class="kb">中的</em>Swagger规范<em class="kb"> yaml </em>文件格式。</li></ul><p id="f2ae" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">如果您使用<a class="ae mf" href="https://www.atlassian.com/software/confluence" rel="noopener ugc nofollow" target="_blank"><em class="kb">Confluence</em></a><em class="kb"/>来分发您的文档，您可以在<a class="ae mf" href="https://www.atlassian.com/software/confluence" rel="noopener ugc nofollow" target="_blank"><em class="kb">Confluence</em></a><em class="kb"/>中创建一个新文件，并选择添加OpenAPI规范。然后复制粘贴<em class="kb"> swagger.yaml </em>内容在里面。</p><p id="b64a" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">9.更新<em class="kb"> main.go到</em>添加<em class="kb">swaggeri。</em></p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="9981" class="lr ig hi ln b fi ls lt l lu lv"><strong class="ln hj">package </strong>main<br/><br/><strong class="ln hj">import </strong>(<br/>   "net/http"<br/><br/>   "github.com/labstack/echo/v4"<br/>   "github.com/labstack/echo/v4/middleware"<br/>   _ "github.com/rizalgowandy/go-swag-sample/docs/echosimple" // <strong class="ln hj"><em class="kb">you need to update github.com/rizalgowandy/go-swag-sample with your own project path</em></strong><br/>   echoSwagger "github.com/swaggo/echo-swagger"<br/>)<br/><br/>// @title Echo Swagger Example API<br/>// @version 1.0<br/>// @description This is a sample server server.<br/>// @termsOfService http://swagger.io/terms/<br/><br/>// @contact.name API Support<br/>// @contact.url http://www.swagger.io/support<br/>// @contact.email support@swagger.io<br/><br/>// @license.name Apache 2.0<br/>// @license.url http://www.apache.org/licenses/LICENSE-2.0.html<br/><br/>// @host localhost:3000<br/>// @BasePath /<br/>// @schemes http<br/><strong class="ln hj">func </strong>main() {<br/>   // Echo instance<br/>   <em class="kb">e </em>:= echo.New()<br/><br/>   // Middleware<br/>   <em class="kb">e</em>.Use(middleware.Logger())<br/>   <em class="kb">e</em>.Use(middleware.Recover())<br/>   <em class="kb">e</em>.Use(middleware.CORS())<br/><br/>   // Routes<br/>   <em class="kb">e</em>.GET("/", HealthCheck)<br/>   <em class="kb">e</em>.GET("/swagger/*", echoSwagger.<strong class="ln hj">WrapHandler</strong>)<br/><br/>   // Start server<br/>   <em class="kb">e</em>.<strong class="ln hj">Logger</strong>.Fatal(<em class="kb">e</em>.Start(":3000"))<br/>}<br/><br/>// HealthCheck godoc<br/>// @Summary Show the status of server.<br/>// @Description get the status of server.<br/>// @Tags root<br/>// @Accept */*<br/>// @Produce json<br/>// @Success 200 {object} map[string]interface{}<br/>// @Router / [get]<br/><strong class="ln hj">func </strong>HealthCheck(<em class="kb">c </em>echo.Context) error {<br/>   <strong class="ln hj">return </strong><em class="kb">c</em>.JSON(http.<em class="kb">StatusOK</em>, <strong class="ln hj">map</strong>[string]<strong class="ln hj">interface</strong>{}{<br/>      "data": "Server is up and running",<br/>   })<br/>}</span></pre><p id="beaa" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">如你所见，我们在<em class="kb">主页上添加了两个重要的东西</em></p><ul class=""><li id="5637" class="kz la hi jf b jg kf jk kg jo lw js lx jw ly ka lz lf lg lh bi translated"><em class="kb">swaggeri</em>的新路线。</li></ul><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="c229" class="lr ig hi ln b fi ls lt l lu lv"><em class="kb">e</em>.GET("/swagger/*", echoSwagger.<strong class="ln hj">WrapHandler</strong>)</span></pre><ul class=""><li id="a497" class="kz la hi jf b jg kf jk kg jo lw js lx jw ly ka lz lf lg lh bi translated">新导入生成的<em class="kb"> docs.go </em>和<em class="kb"> swag </em>库。不要忘记用你的项目路径替换github.com/rizalgowandy/go-swag-sample路径。</li></ul><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="d5ea" class="lr ig hi ln b fi ls lt l lu lv">import (<br/>   ...<br/>   _ "github.com/rizalgowandy/go-swag-sample/docs/echosimple" // <strong class="ln hj"><em class="kb">you need to update github.com/rizalgowandy/go-swag-sample with your own project path</em></strong><br/>   echoSwagger "github.com/swaggo/echo-swagger"<br/>   ...<br/>)</span></pre><p id="7b42" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">10.最后，再次运行应用程序。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="2247" class="lr ig hi ln b fi ls lt l lu lv">$ go run echosimple/main.go</span></pre><p id="aef6" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">11.现在尝试，调用新添加的路由。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="d547" class="lr ig hi ln b fi ls lt l lu lv">$ curl localhost:3000/swagger/doc.json</span></pre><p id="992b" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">您应该会看到如下输出。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="e8f2" class="lr ig hi ln b fi ls lt l lu lv">{ <br/>    "schemes": ["http"], <br/>    "swagger": "2.0", <br/>    "info": { <br/>        "description": "This is a sample server server.", <br/>        "title": "Echo Swagger Example API", <br/>        "termsOfService": "http://swagger.io/terms/", <br/>        "contact": { <br/>            "name": "API Support", <br/>            "url": "http://www.swagger.io/support", <br/>            "email": "support@swagger.io" <br/>        }, <br/>        "license": { <br/>            "name": "Apache 2.0", <br/>            "url": "http://www.apache.org/licenses/LICENSE-2.0.html" <br/>        }, <br/>        "version": "1.0" <br/>    }, <br/>    "host": "localhost:3000", <br/>    "basePath": "/", <br/>    "paths": { <br/>        "/": { <br/>            "get": { <br/>                "description": "get the status of server.", <br/>                "consumes": [ <br/>                    "*/*" <br/>                ], <br/>                "produces": [ <br/>                    "application/json" <br/>                ], <br/>                "tags": [ <br/>                    "root" <br/>                ], <br/>                "summary": "Show the status of server.", <br/>                "responses": { <br/>                    "200": { <br/>                        "description": "OK", <br/>                        "schema": { <br/>                            "type": "object", <br/>                            "additionalProperties": true <br/>                        } <br/>                    } <br/>                } <br/>            } <br/>        } <br/>    } <br/>}</span></pre><p id="590d" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">12.使用此URL在浏览器中打开SwaggerUI。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="b872" class="lr ig hi ln b fi ls lt l lu lv"><a class="ae mf" href="http://localhost:3000/swagger/index.html" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/swagger/index.html</a></span></pre><p id="a190" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">您应该会看到如下输出。</p><figure class="li lj lk ll fd mh er es paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="er es mg"><img src="../Images/ab95ee4a5cbec49f4f1256c0f5032405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NTHqG-MEDJVz1knIIiy9vA.png"/></div></div></figure><p id="8305" class="pw-post-body-paragraph jd je hi jf b jg kf ji jj jk kg jm jn jo ki jq jr js kk ju jv jw km jy jz ka hb bi translated">瞧，我们完成了。我们使用<em class="kb"> Echo </em>框架成功创建了一个简单的Go web服务器，并生成了<strong class="jf hj"><em class="kb"/></strong><em class="kb">Swagger规范</em>和<em class="kb"> SwaggerUI </em>。</p><h1 id="cbba" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">参考</h1><ul class=""><li id="15f5" class="kz la hi jf b jg jh jk jl jo lb js lc jw ld ka lz lf lg lh bi translated"><strong class="jf hj">来源:</strong><a class="ae mf" href="https://github.com/rizalgowandy/go-swag-sample" rel="noopener ugc nofollow" target="_blank">https://github.com/rizalgowandy/go-swag-sample</a></li><li id="7ec8" class="kz la hi jf b jg ma jk mb jo mc js md jw me ka lz lf lg lh bi translated"><strong class="jf hj">声明式评论格式:</strong><a class="ae mf" href="https://github.com/swaggo/swag#declarative-comments-format" rel="noopener ugc nofollow" target="_blank">https://github.com/swaggo/swag#declarative-comments-format</a></li></ul></div></div>    
</body>
</html>
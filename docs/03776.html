<html>
<head>
<title>Python for Beginners #2 — Importing files to python with pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python初学者#2 —用pandas将文件导入python</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/python-for-beginners-2-importing-files-to-python-with-pandas-dd2dec2f41da?source=collection_archive---------25-----------------------#2021-06-15">https://medium.com/geekculture/python-for-beginners-2-importing-files-to-python-with-pandas-dd2dec2f41da?source=collection_archive---------25-----------------------#2021-06-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/8c0b899f04bd80b57ef698566ed3f16f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s13dN4cZtcSxOYL55JQ2_g.png"/></div></div></figure><div class=""/><p id="9f32" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">用熊猫上传CSV、TXT、Excel文件</em></p><h1 id="e54e" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">开始前的故事时间</h1><p id="2256" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">学习Python并不是一件容易的事情。但是一致性是达到提升你职业水平的关键。</p><p id="508b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们经常听到千禧一代希望事情变得简单。事实上，有很多年轻的专业人士认为他们可以为公司做更多的事情，但他们在职业生涯开始时面临的工作文化阻碍了他们的发展。</p><p id="6bec" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我很幸运地在学业结束后找到了工作，我记得在开始新工作后不久，我立即感到一阵失望。我觉得自己就像一台巨大机器中的一个齿轮。除了一个“<strong class="is hu"> <em class="jo">资源</em> </strong>”之外，我其实什么也不是。每天额外的8-15个小时的人力，取决于我老板的突发奇想。</p><p id="6bc7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果是最终的醒悟和缺乏动力，原因很简单，在很大程度上，我被期望保持安静，做好我的工作，希望有一天我足够高，能够实现重大的改变。虽然老一辈人通常会告诉我要振作起来，但我看不出自己会在5年或更长时间内振作起来。我知道我会变得陈腐，害怕改变，就像那些告诉我呆在我的地方的人一样。</p><p id="89e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于任何处于类似情况的人来说，<strong class="is hu"> <em class="jo">尽最大努力提高自己的技能</em> </strong>找到一个适合自己的环境。这就是这些文章的全部目的。让你走上自由之路。</p><h1 id="3ca6" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">介绍</h1><p id="bd9f" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这次演示中，我将使用来自<a class="ae ks" href="https://www.kaggle.com/c/titanic/data?select=train.csv" rel="noopener ugc nofollow" target="_blank">这场卡格尔比赛</a>的数据。这是一个简单的CSV文件，包含泰坦尼克号上的个人数据和不同的个人资料，即(年龄，婚姻状况等。)</p><p id="5778" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我想把这个文件导入python。我将向您展示如何做到这一点，以及您可能遇到的所有可能的故障排除。</p><h1 id="be97" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">目录</h1><ol class=""><li id="9965" class="kt ku ht is b it kn ix ko jb kv jf kw jj kx jn ky kz la lb bi translated">你应该把你的文件放在哪里？T19】</li><li id="39b7" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><a class="ae ks" href="#559d" rel="noopener ugc nofollow"> <strong class="is hu">读取CSV和TXT文件</strong> </a></li><li id="a97e" class="kt ku ht is b it lc ix ld jb le jf lf jj lg jn ky kz la lb bi translated"><a class="ae ks" href="#6a43" rel="noopener ugc nofollow"> <strong class="is hu">读取excel (XLSX)文件</strong> </a></li></ol><h1 id="73e5" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">你应该把你的文件放在哪里？</h1><p id="3a3d" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">如果你知道什么是工作目录，就跳过。 </p><p id="f4b2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可能是你需要从这篇文章中学到的最重要的东西。我几乎放弃了Python的工作，因为我不理解这个非常简单的概念。</p><h2 id="7ac0" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated"><strong class="ak">工作目录</strong></h2><p id="24bf" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">要访问计算机上的文件，Python通常指向单个文件夹。默认情况下，这应该在你的<strong class="is hu"> <em class="jo"> C:/中的某个地方。</em> </strong>我们称这个文件夹为<strong class="is hu"> <em class="jo">工作目录，</em> </strong>本质上就是Python工作的地方。</p><p id="49a7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以这个文件夹(这个工作目录)中的任何文件都可以在Python上立即读取。</p><p id="2e6e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想知道你的工作目录在哪里，你可以使用<code class="du lv lw lx ly b">os</code>包。<code class="du lv lw lx ly b">os</code>是operating system的简称，在python中用来高效管理文件和文件夹。</p><p id="2974" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们首先导入包(不需要pip安装，因为这是python发行版附带的默认包。)</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="f864" class="lh jq ht ly b fi mh mi l mj mk">import os</span><span id="feff" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>os.getcwd()</span></pre><h2 id="9552" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated"><strong class="ak">在不改变工作目录的情况下获取文件位置</strong></h2><p id="3829" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">如果你想得到一个文件的位置而不需要改变你的工作目录，你必须给出文件的完整位置。</p><p id="5272" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将Kaggle网站上的train.csv文件存储在一个名为Class 3的文件夹中。</p><p id="c93c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，为了读取我的文件，我需要pandas函数的输入如下:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="2a3d" class="lh jq ht ly b fi mh mi l mj mk">"/home/caleb/Desktop/PythonClasses/Class 3/train.csv"</span></pre><p id="f20c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者在Windows上:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="4116" class="lh jq ht ly b fi mh mi l mj mk">"C:/Users/caleb/Desktop/PythonClasses/Class 3/train.csv"</span></pre><h2 id="474f" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated"><strong class="ak">更改您的工作目录</strong></h2><p id="8e11" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">要改变你的工作目录，你需要从<code class="du lv lw lx ly b">os</code>包中调用<code class="du lv lw lx ly b">chdir</code>函数。<strong class="is hu"> <em class="jo">但是需要使用完整的地名。如果你在工作中使用网络驱动器，这一点尤其重要。</em></strong></p><p id="6c42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我喜欢做的是将位置赋给一个变量，并在我的<code class="du lv lw lx ly b">chdir</code>函数中使用它。</p><p id="2729" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以在Linux上应该是这样的:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="8e8f" class="lh jq ht ly b fi mh mi l mj mk">LOCATION = "/home/caleb/Desktop/PythonClasses/Class 3"<br/>os.chdir(LOCATION)</span></pre><p id="7ba6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您使用的是Windows，应该是这样的:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="9e05" class="lh jq ht ly b fi mh mi l mj mk">LOCATION = ‘C:/Users/caleb/Desktop/PythonClasses/Class 3’<br/>os.chdir(LOCATION)</span></pre><p id="d951" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">注意:如果你在网络驱动器上，那么我倾向于使用双反斜杠(\\)以确保安全。</p><p id="a21b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，<strong class="is hu"> <em class="jo">网络名</em> </strong>和<strong class="is hu"> <em class="jo">网络子文件夹</em> </strong>为网络文件夹。在Windows上，你可以很容易地在你的文件浏览器的顶部找到这些。</p><p id="a1e8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意从斜杠到双反斜杠的变化</strong>:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="f2fc" class="lh jq ht ly b fi mh mi l mj mk">LOCATION = ‘\\\\NETWORKNAME\\NETWORKSUBFOLDER\\Folder\\SubFolder\\’<br/>os.chdir(LOCATION)</span></pre><h1 id="559d" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">读取CSV和TXT文件</h1><p id="797b" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">既然我们已经讨论了工作目录，导入文件就容易多了。</p><p id="e88e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Python中，<code class="du lv lw lx ly b">read_csv</code>函数读取CSV和TXT文件。所以就像导入<code class="du lv lw lx ly b">pandas</code>运行一样简单:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="c9e6" class="lh jq ht ly b fi mh mi l mj mk">import pandas as pd</span><span id="26e1" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the file<br/>file_loc = "C:/Users/caleb/Desktop/PythonClasses/Class 3/train.csv"</span><span id="f010" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv(file_loc)</span></pre><p id="432f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当然，如果您已经更改了工作目录，那么您可以使用:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="6744" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="91d3" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="1ed0" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="048e" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv("train.csv")</span></pre><h2 id="b5f9" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated">逗号中的不同分隔符</h2><p id="fba8" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">所以不同的TXT文件有不同的分隔符。默认分隔符是逗号。为了定义要使用的分隔符，我们在函数中使用了<code class="du lv lw lx ly b">sep</code>参数。在我们的例子中，我们使用:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="c49e" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="a36d" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="77a3" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="141a" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv("train.csv", sep = ",")</span></pre><h2 id="26ae" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated">成块读取大型CSV文件</h2><p id="250d" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">一个有趣的参数是<code class="du lv lw lx ly b">chunksize</code>,它允许您成块读取csv文件。我们可以要求熊猫逐行读取50个、100个甚至更多，以优化文件的上传。</p><p id="b4b9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们的代码应该是这样的:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="8d86" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="6939" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="e1d2" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="73e8" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv("train.csv", <br/>                              sep = ",",<br/>                              chunksize = 100)</span></pre><h2 id="0578" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated">将特定列作为数字或字符串读取</h2><p id="545d" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">因此，如果我们想上传一个特定的列作为字符串或数字，我们必须使用<code class="du lv lw lx ly b">dtype</code>和一个字典，在这里我们定义列和我们想要使用的类型。</p><p id="fbdd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以在我们的例子中，我们希望数据中的<code class="du lv lw lx ly b"><strong class="is hu"><em class="jo">Survived</em></strong></code>列为真或假(布尔值)。为此，我们使用<code class="du lv lw lx ly b">dtpye</code>参数。</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="0193" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="c0b1" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="2ae0" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="73c2" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv("train.csv", <br/>                              sep = ",",<br/>                              chunksize = 100,<br/>                              dtype = {'Survived': bool})</span></pre><h2 id="6e20" class="lh jq ht bd jr li lj lk jv ll lm ln jz jb lo lp kd jf lq lr kh jj ls lt kl lu bi translated">定义标题列</h2><p id="b0e1" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们可以定义想要在Python中使用的列名。</p><p id="3ce6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们甚至可以决定导入没有列名的文件，在这种情况下，我们将<code class="du lv lw lx ly b">header</code>设置为<code class="du lv lw lx ly b">None</code>，但是如果我们想要使用特定的行，我们将从<code class="du lv lw lx ly b">0</code>开始设置行的索引。</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="3348" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="56a0" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="474c" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="f804" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_csv("train.csv", <br/>                              sep = ",",<br/>                              chunksize = 100,<br/>                              dtype = {'Survived': bool},<br/>                              header = 0)</span></pre><h1 id="6a43" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">读取Excel (XLSX)文件</h1><p id="0970" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们对CSV文件所做的一切，都可以在pandas中使用<code class="du lv lw lx ly b">read_excel</code>函数对XLSX文件进行处理。因此，如果我们在同一位置有train.xlsx，我们使用:</p><pre class="lz ma mb mc fd md ly me mf aw mg bi"><span id="86c9" class="lh jq ht ly b fi mh mi l mj mk">import os<br/>import pandas as pd</span><span id="19d7" class="lh jq ht ly b fi ml mi l mj mk"># Find the full location of the working directory<br/>LOCATION = "C:/Users/caleb/Desktop/PythonClasses/Class 3"</span><span id="17cc" class="lh jq ht ly b fi ml mi l mj mk"># Change working directory<br/>os.chdir(LOCATION)</span><span id="d556" class="lh jq ht ly b fi ml mi l mj mk"># Find the current working directory<br/>training_data =  pd.read_excel("train.xlsx",<br/>                            dtype = {'Survived': bool},<br/>                            header = 0)</span></pre><p id="f51d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意:</strong>我们不能将<code class="du lv lw lx ly b">chunksize</code>与<code class="du lv lw lx ly b">read_excel.</code>一起使用，最简单的方法是使用CSV或TXT文件。</p></div></div>    
</body>
</html>
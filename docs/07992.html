<html>
<head>
<title>Hack This Site: Realistic Web Mission — Level 11</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑掉这个网站:现实的网络任务——11级</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-11-302e0a64c02f?source=collection_archive---------11-----------------------#2021-10-09">https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-11-302e0a64c02f?source=collection_archive---------11-----------------------#2021-10-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e1dd65bb23b76ab187a5a58ec4accf22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*545L4jdDj-E566azoqZNVg@2x.jpeg"/></div></div></figure><p id="71a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你好，谢谢光临哈克斯。今天我们来看看<a class="ae jo" href="https://hackthissite.org/" rel="noopener ugc nofollow" target="_blank">黑掉这个网站</a>现实网络任务11级。我不像其他人那样喜欢这个挑战。原因是因为任务不再按预期进行。我怀疑这可能是由于浏览器安全性的改进或应用程序的更改。这个挑战最初要求你通过一个用户代理来窃取cookies。然而，情况似乎不再如此。如果你没有看过我在现实系列上的其他帖子，你可以在这里看到:<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-missions-level-1/" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-2/" rel="noopener ugc nofollow" target="_blank">第二部分</a>、<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-3/" rel="noopener ugc nofollow" target="_blank">第三部分</a>、<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-4/" rel="noopener ugc nofollow" target="_blank">第四部分</a>、<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-5/" rel="noopener ugc nofollow" target="_blank">第五部分</a>、<a class="ae jo" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-6/" rel="noopener ugc nofollow" target="_blank">第六部分</a>、<a class="ae jo" href="https://haxez.org/2021/10/hack-this-site-realistic-web-mission-level-7/" rel="noopener ugc nofollow" target="_blank">第七部分</a>和<a class="ae jo" href="https://haxez.org/2021/10/hack-this-site-realistic-web-mission-level-8/" rel="noopener ugc nofollow" target="_blank">第八部分</a></p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jp"><img src="../Images/42e01c882f762c6f68fc6a74e6d287a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/0*QOlcDqjSQJeo9QG8"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">BudgetServ Web Hosting</figcaption></figure><h1 id="088f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="ec00" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">我们收到了来自Space46的消息，他解释说他们的ISP已经暂停了他们的网络应用程序，因为他们怀疑他们入侵了服务器上的另一个网站。他要求我们恢复他的网站的备份，该网站仍然托管在服务器上。备份的文件名是“src.tar.gz”。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jp"><img src="../Images/1a32d515df5ecf115becf8784608e4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/0*ypuZyXtHPdt5mqYG"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Message From Space46</figcaption></figure><h1 id="06d9" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">探索Web应用程序</h1><p id="ed2b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">导航到web应用程序，我们可以看到它看起来像一个基本的主机提供商的网站。有很多导航选项，但没有一个链接到任何有趣的东西。如果我们找不到其他任何东西，我们可以尝试暴力破解一个网络邮件页面。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/05c6b88c3ae9b062fa8e34fc3066990a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*SAnqgE_V7zSG3_fO"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Web Application — Budget Serv</figcaption></figure><h1 id="90b7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">操作系统命令注入</h1><p id="7e00" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">引起我注意的一件事是应用程序调用页面的方式。似乎有一个Perl脚本正在用page参数调用不同的文件。您可以在下面看到一个调用特性页面的Perl脚本示例。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="3111" class="lg jz hi lc b fi lh li l lj lk"><a class="ae jo" href="https://www.hackthissite.org/missions/realistic/11/page.pl?page=features" rel="noopener ugc nofollow" target="_blank">https://www.hackthissite.org/missions/realistic/11/<strong class="lc hj">page.pl?page=features</strong></a></span></pre><p id="e102" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以尝试利用这一功能，通过将page参数的值更改为Linux操作系统命令来利用它。在本例中，我们将使用ls命令列出当前目录的内容。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="c1ad" class="lg jz hi lc b fi lh li l lj lk"><a class="ae jo" href="https://www.hackthissite.org/missions/realistic/11/page.pl?page=|ls|" rel="noopener ugc nofollow" target="_blank">https://www.hackthissite.org/missions/realistic/11/<strong class="lc hj">page.pl?page=|ls|</strong></a></span></pre><p id="4ca9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从下面的截图中可以看到，这个命令起作用了，我们可以看到目录的内容。我们应该记下列出的所有文件，因为它们将来可能会对我们有所帮助。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/9ceb3b30aa3d0f6af19e929259c7db06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*WJAmjXWnptjURoU5"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Web Application — OS Command Injection</figcaption></figure><h1 id="6db9" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">进一步探索</h1><p id="6533" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">OS命令注入的结果显示了一个管理目录。导航到该目录会显示一个登录页面。不幸的是，我们还没有任何证书，所以我们将继续探索web应用程序。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/ab835827ac545f2f4ddbe2c4edd9f3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*AZg3U2PcsAyhBbib"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Admin Log In Page</figcaption></figure><p id="02b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">清单中的下一个文件是一个“bs.dbase”文件，它似乎是一个数据库文件。不用说，我们无法访问它，但我们应该记住这个名称，以便以后使用。下一个目录是“client_http_docs”目录，该目录似乎包含所有托管的web应用程序。导航到这个目录会显示许多目录列表，包括space46。遗憾的是，试图访问这个目录会产生一条错误消息，通知我们应用程序已被挂起。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/7cd4c2f8d0bfff19fa5e91f99173b809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*arVf-612WqKyy0bF"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Directory Listing</figcaption></figure><p id="13b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其他目录似乎服务于其他应用程序。其中一个应用是神奇饮食，如下图所示。另一个是关于仍在建造中的马铃薯。浏览这些应用程序并没有提供太多我们可以利用的东西。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/a5b6e41d7bf43a3f3cecf6f0c529c2d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*f9wo8YvAv3UAP6_B"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">The Wonder Diet</figcaption></figure><h1 id="6b13" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">合适的Web应用程序</h1><p id="3647" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">rightwayradio目录包含看起来像是一个广播web应用程序的内容。它似乎有一些基本的功能，包括一个登录表单。还有一条关于登陆年龄的消息来自用户“rsmith”。如果我们点击那个用户，它会把我们带到关于那个用户的“用户信息”页面。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/fc7f257d46751d570330d0a6b272dcb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*vy8Lpao5Yj2fk4UM"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">The Right Way Radio</figcaption></figure><h1 id="e029" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">利用Web应用程序用户</h1><p id="5735" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">如果我们查看URL，我们可以推断出用户页面是由userinfo脚本中的id参数调用的。此外，我们可以看到用户“rsmith”的用户id为-1。如果我们试验这个参数，我们可以检索其他用户的信息。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="2157" class="lg jz hi lc b fi lh li l lj lk">client_http_docs/therightwayradio/?page=userinfo&amp;<strong class="lc hj">id=-1</strong></span></pre><p id="c237" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过将参数值从-1更改为0，我们可以检索用户“aclu_bomber_08290”的页面。从下图可以看出，我们还能够更改该用户的密码。起初，我认为这是荒谬的，因为我们没有认证。然而，我已经看到了很多奇怪的应用程序行为，所以这不应该让我感到惊讶。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/87bcf4608d76c912fda9a8e2b01332f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*strXi4sKdmSOgbGh"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Changing Password</figcaption></figure><h1 id="b5d7" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Web应用程序SQL功能</h1><p id="303a" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">更改用户密码后，我们可以登录他们的帐户。他们的帐户似乎可以访问一个审核页面，该页面有一个用于SQL查询的输入框。从我们的OS命令注入中，我们还知道有一个名为bs.dbase的数据库文件。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/7da135df96c35bda07ee954b5e011750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*R3NvomNYy5wFM5eH"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">SQL Query</figcaption></figure><p id="58b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们查看应用程序的页面源代码，我们可以看到有一个名为sql_db的隐藏参数，其值为rwr.dbase。这不是我们想要查询的数据库。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/7b75a9560095be99ba94ed3526e1fbc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*tI1I0ziTypN72a2l"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Web Application — Page Source</figcaption></figure><p id="fe5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，我们可以修改参数，告诉它查询我们想要查询的数据库。我们还知道数据库的位置，因为我们的OS命令注入是在应用程序的根目录中运行的。通过修改参数并告诉它向上移动三个目录，我们应该能够查询主数据库。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/90bdef087d5126ee73368342f5ecac49.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/0*VwCyMVziJOQnp62j"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Changing Value</figcaption></figure><h1 id="564c" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">转储Web用户</h1><p id="fecb" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">因为这是一个SQL Lite数据库，所以我们需要查询sqlite_master表来找出数据库中保存了哪些表。我们可以通过运行下面的命令来做到这一点。我已经包含了输出，它通知我们有一个名为web_hosting的表。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="cb0d" class="lg jz hi lc b fi lh li l lj lk">SELECT name FROM sqlite_master WHERE type ='table';</span><span id="72fa" class="lg jz hi lc b fi lm li l lj lk">name<br/>web_hosting</span></pre><p id="3bd5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们可以告诉数据库转储web_hosting表的全部内容。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="85ae" class="lg jz hi lc b fi lh li l lj lk">SELECT * FROM web_hosting;</span></pre><p id="8aa5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如你从截图中看到的，我们能够得到一个用户列表，密码，电子邮件地址和他们的web_package标识符。我们可以从这些信息中看到，用户wonderdiet似乎是管理员用户。他们的web_package id是1，这表明他们的站点是第一个创建的站点。此外，他们的电子邮件地址中有admin。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/e64e0281da496e060e0a439e80f91a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*9rUnHsLONylsPiN2"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Users and Passwords Returned</figcaption></figure><h1 id="ded5" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">访问管理区</h1><p id="6b1b" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">如果我们回到之前发现的管理区域。我们现在应该可以用wonderdiet web用户和他们的密码suckereveryminute登录了。一旦登录到管理区，我们有许多选项，包括下载文件的能力。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/5b62d98e7768e809f6930421bc5ae370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*Wu1I1oyu9wWvtg4b"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Admin Area</figcaption></figure><p id="5d6f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过单击下载链接，我们将被重定向到一个页面，该页面显示正在下载的文件的完整路径。我们从客户给我们的目录列表和文件名中知道备份文件的位置。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es if"><img src="../Images/d7c1bd3559a31db09bded0224c48050a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*lFpicY_3rUOoEDhM"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">URL</figcaption></figure><p id="0cc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过修改URL指向客户指定的src.tar.gz文件，我们应该能够下载他们的备份文件并完成任务。我在下面包含了文件的完整URL路径。</p><pre class="jq jr js jt fd lb lc ld le aw lf bi"><span id="bac4" class="lg jz hi lc b fi lh li l lj lk"><a class="ae jo" href="https://www.hackthissite.org/missions/realistic/11/admin/d.pl?file=/var/www/budgetserv/html/client_http_docs/space46/src.tar.gz" rel="noopener ugc nofollow" target="_blank">https://www.hackthissite.org/missions/realistic/11/admin/d.pl?file=/var/www/budgetserv/html/client_http_docs/space46/src.tar.gz</a></span></pre><p id="f2eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">恭喜你，你现在应该已经完成了这个任务。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/a46f55a2c81d2df80e1d43d5b8e594d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/0*y1Cw6v5YPmUkfRVP"/></div></figure><figure class="jq jr js jt fd ij"><div class="bz dy l di"><div class="lo lp l"/></div></figure></div></div>    
</body>
</html>
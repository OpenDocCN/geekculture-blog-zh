<html>
<head>
<title>RESTful Web API with Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Flask的RESTful Web API</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/restful-web-api-with-flask-71ed18e3af20?source=collection_archive---------13-----------------------#2022-01-02">https://medium.com/geekculture/restful-web-api-with-flask-71ed18e3af20?source=collection_archive---------13-----------------------#2022-01-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/65acaed2eed515e67d947c025785089f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*BefYRpujz5jfYCnH3aaRwg.png"/></div></figure><h1 id="d05e" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">介绍</h1><p id="71ce" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">Flask使得创建RESTful web API变得非常容易。已知的route() decorator除了它的方法可选参数之外，还可以用来声明路由。它控制服务公开的资源URL。JSON数据工作太简单了。因为包含在请求中的JSON数据被自动公开为request.json Python字典。需要包含JSON的响应可以使用Flask的jsonify() helper函数从Python字典中创建。</p><p id="4111" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">在本文中，我们将学习如何用Flask创建一个RESTful web API。</p><h1 id="94d6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">描述</h1><p id="26f4" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">Flask-RESTful是Flask的扩展。它为快速构建<a class="ae ki" href="https://www.technologiesinindustry4.com/2021/12/restful-web-services.html" rel="noopener ugc nofollow" target="_blank">REST API提供了帮助。</a>这是一个轻量级的抽象，可以与现有的库一起工作。Flask-RESTful以最少的设置支持最佳实践。如果我们熟悉Flask，Flask-RESTful应该很容易上手。</p><h1 id="b6f1" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">装置</h1><p id="48ae" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">使用pip安装<a class="ae ki" href="https://www.technologiesinindustry4.com/2021/12/restful-web-services.html" rel="noopener ugc nofollow" target="_blank">烧瓶-RESTful </a></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="6645" class="kx in hi kt b fi ky kz l la lb">pip install flask-restful</span></pre><h1 id="4163" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">一个最小的烧瓶应用</h1><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="14d4" class="kx in hi kt b fi ky kz l la lb">from flask import Flaskapp = Flask(__name__)@app.route('/hello/', methods=['GET', 'POST'])<br/>def welcome():<br/>    return "Hello World!"if __name__ == '__main__':<br/>    app.run(host='0.0.0.0', port=105)</span></pre><ul class=""><li id="0927" class="lc ld hi jm b jn kj jr kk jv le jz lf kd lg kh lh li lj lk bi translated">将它保存为api.py，并使用python解释器运行它。</li><li id="2c0c" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">转到终端并键入<code class="du lq lr ls kt b">python app.py</code>(即<code class="du lq lr ls kt b">python &lt;filename&gt;.py</code>)</li></ul><p id="7150" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">我们会看到这样的情况:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="34b9" class="kx in hi kt b fi ky kz l la lb">Running on <a class="ae ki" href="http://0.0.0.0:105" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:105</a><br/>Press CTRL+C to quit</span></pre><ul class=""><li id="3b88" class="lc ld hi jm b jn kj jr kk jv le jz lf kd lg kh lh li lj lk bi translated">启动任何网络浏览器。</li><li id="9454" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">要查看应用程序的运行情况，请访问<code class="du lq lr ls kt b">http://localhost:105/hello/</code>。</li></ul></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><p id="f71a" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated"><strong class="jm hj">代码逐行工作</strong></p><ul class=""><li id="cd18" class="lc ld hi jm b jn kj jr kk jv le jz lf kd lg kh lh li lj lk bi translated">将烧瓶类导入为<code class="du lq lr ls kt b">from flask import Flask</code></li><li id="9066" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">创建一个类的实例作为<code class="du lq lr ls kt b">app = Flask(__name__)</code></li><li id="93da" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">我们使用<code class="du lq lr ls kt b">route()</code>装饰器来询问Flask什么URL应该触发这个函数。</li><li id="0afb" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">@app.route('/hello/', methods=['GET', 'POST'])</code></li><li id="72ac" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">methods</code>表示允许哪些HTTP方法。默认为<code class="du lq lr ls kt b">['GET']</code></li><li id="c7bc" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">if __name__ == '__main__'</code> → <code class="du lq lr ls kt b">__name__</code>是Python中的特定变量。</li><li id="6d9e" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">它接受脚本名的值。</li><li id="b477" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">这一行确保我们的Flask应用程序只有在主文件中执行时才运行。</li><li id="bfad" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">当它被导入到其他文件中时，将不会被执行。</li><li id="3ec7" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">运行烧瓶应用程序<code class="du lq lr ls kt b">app.run(host='0.0.0.0', port=105)</code></li><li id="7b47" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">host</code>表示我们希望flask应用程序运行的服务器。</li><li id="992f" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">host</code>的默认值是<code class="du lq lr ls kt b">localhost</code>和<code class="du lq lr ls kt b">127.0.0.1</code></li><li id="fad0" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated"><code class="du lq lr ls kt b">0.0.0.0</code>显示为<em class="ma">本地机器上的所有IPv4地址。</em></li><li id="8521" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">这确保了从所有地址都可以到达服务器。</li><li id="8983" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">默认的<code class="du lq lr ls kt b">port</code>值是<code class="du lq lr ls kt b">5000.</code></li><li id="b96c" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">我们可以设置参数<code class="du lq lr ls kt b">port</code>来使用我们选择的端口号。</li></ul></div><div class="ab cl lt lu gp lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="hb hc hd he hf"><h1 id="41e5" class="im in hi bd io ip mb ir is it mc iv iw ix md iz ja jb me jd je jf mf jh ji jj bi translated">变量规则</h1><ul class=""><li id="490f" class="lc ld hi jm b jn jo jr js jv mg jz mh kd mi kh lh li lj lk bi translated">我们可以通过使用<code class="du lq lr ls kt b">&lt;variable_name&gt;</code>向URL添加可变部分。</li><li id="d1d8" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">该函数获取变量作为关键字参数。</li></ul><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="13ea" class="kx in hi kt b fi ky kz l la lb">from flask import Flask<br/>app = Flask(__name__)@app.route('/&lt;int:number&gt;/')<br/>def incrementer(number):<br/>    return "Incremented number is " + str(number+1)@app.route('/&lt;string:name&gt;/')<br/>def hello(name):<br/>    return "Hello " + nameapp.run()</span></pre><ul class=""><li id="a39a" class="lc ld hi jm b jn kj jr kk jv le jz lf kd lg kh lh li lj lk bi translated">要启动Flask应用程序，请运行上面的代码。</li><li id="c4d9" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">打开浏览器并转到<code class="du lq lr ls kt b"><a class="ae ki" href="http://localhost:5000/Jimit." rel="noopener ugc nofollow" target="_blank">http://localhost:5000/Jimit.</a></code></li><li id="04e3" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">我们将输出视为<code class="du lq lr ls kt b">Hello Jimit</code>。</li><li id="6aa2" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">当我们转到<code class="du lq lr ls kt b">http://localhost:5000/10</code>时，输出将是<code class="du lq lr ls kt b">Incremented number is 11</code>。</li></ul><h1 id="fb37" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">创建API蓝图</h1><ul class=""><li id="9d91" class="lc ld hi jm b jn jo jr js jv mg jz mh kd mi kh lh li lj lk bi translated">与RESTful API<a class="ae ki" href="https://www.technologiesinindustry4.com/2021/12/restful-web-services.html" rel="noopener ugc nofollow" target="_blank">链接的路由构成了应用程序的一个独立子集。</a></li><li id="46d5" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">因此，将它们放在自己的蓝图中是保持它们井井有条的最好方法。</li><li id="e7fb" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">下面的例子显示了应用程序中API蓝图的通用结构。</li></ul><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="64aa" class="kx in hi kt b fi ky kz l la lb">|-flaky<br/>|-app/<br/>|-api_1_0<br/>|-__init__.py<br/>|-user.py<br/>|-post.py<br/>|-comment.py<br/>|-authentication.py<br/>|-errors.py<br/>|-decorators.py</span></pre><ul class=""><li id="2ea3" class="lc ld hi jm b jn kj jr kk jv le jz lf kd lg kh lh li lj lk bi translated">请注意用于API的包是如何在其名称中添加版本号的。</li><li id="5013" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">它可以作为具有不同版本号的另一个包来包含，并且当需要引入API的向后不兼容版本时，可以同时提供这两个API。</li><li id="d129" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">这个API蓝图在单独的模块中应用每个资源。</li><li id="9fa6" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">类似地添加模块来处理认证、错误处理，并提供定制的装饰器。</li><li id="081f" class="lc ld hi jm b jn ll jr lm jv ln jz lo kd lp kh lh li lj lk bi translated">蓝图构造器可以在下面的例子中看到。</li></ul><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="a3c2" class="kx in hi kt b fi ky kz l la lb">from flask import Blueprint<br/>api = Blueprint('api', __name__)<br/>from . import authentication, posts, users, comments, errors</span></pre><p id="0be4" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">API蓝图的注册可以在下面的例子中看到。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="865e" class="kx in hi kt b fi ky kz l la lb">def create_app(config_name):<br/># ...<br/>from .api_1_0 import api as api_1_0_blueprint<br/>app.register_blueprint(api_1_0_blueprint, url_prefix='/api/v1.0')<br/># ...</span></pre><p id="8cca" class="pw-post-body-paragraph jk jl hi jm b jn kj jp jq jr kk jt ju jv kl jx jy jz km kb kc kd kn kf kg kh hb bi translated">更多详情请访问:<a class="ae ki" href="https://www.technologiesinindustry4.com/2022/01/restful-web-api-with-flask.html" rel="noopener ugc nofollow" target="_blank">https://www . technologiesinindustry 4 . com/2022/01/restful-we b-API-with-flask . html</a></p></div></div>    
</body>
</html>
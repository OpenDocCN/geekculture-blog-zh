<html>
<head>
<title>Used Carprice Prediction -Complete Machine Learning Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">二手汽车价格预测-完整的机器学习项目</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/used-carprice-prediction-complete-machine-learning-project-d25559cf2d2a?source=collection_archive---------0-----------------------#2021-03-30">https://medium.com/geekculture/used-carprice-prediction-complete-machine-learning-project-d25559cf2d2a?source=collection_archive---------0-----------------------#2021-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="93d0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">汽车价格预测机器学习项目的分步指南！</h1><p id="0d0e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在本文中，我将带您了解我们如何训练一个模型来帮助我们预测汽车价格。您将练习到目前为止所学的机器学习工作流，使用汽车的属性来预测汽车的市场价格。我们将使用的数据集包含各种汽车的信息。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/8ad5205ff75ff87ebd244e858dd17eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y90VJ0bt2gQUWMMyju0nvQ.jpeg"/></div></div></figure><p id="1fe8" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated"><strong class="jf hj">潜在的业务问题</strong>--</p><p id="5c8b" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这个项目的主要目的是根据各种特征预测二手车的价格。</p><p id="65a1" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">关于汽车数据集，请访问https://www.kaggle.com/nehalbirla/motorcycle-dataset<a class="ae ks" href="https://www.kaggle.com/nehalbirla/motorcycle-dataset" rel="noopener ugc nofollow" target="_blank"/></p><blockquote class="kt ku kv"><p id="422d" class="jd je kw jf b jg kn ji jj jk ko jm jn kx kp jq jr ky kq ju jv kz kr jy jz ka hb bi translated">Github链接:<a class="ae ks" href="https://github.com/TEJASHREE8/car-price-prediction" rel="noopener ugc nofollow" target="_blank">https://github.com/TEJASHREE8/car-price-prediction</a></p></blockquote><p id="4304" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">该数据集包含二手车的信息。给定数据集中的列如下:</p><p id="2484" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">姓名，年份，售价，</p><p id="3a20" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">公里驱动，燃料，卖方类型</p><p id="dbe8" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">变速器，所有者</p><p id="4acf" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">该数据由大约301辆汽车和9个特征的记录组成。</p><h1 id="a095" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据科学项目的整个生命周期分为四个部分:</h1><ol class=""><li id="5cf9" class="la lb hi jf b jg jh jk jl jo lc js ld jw le ka lf lg lh li bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#f327" rel="noopener">探索性数据分析</a></li><li id="a7e5" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka lf lg lh li bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#d304" rel="noopener">特征工程</a></li><li id="7693" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka lf lg lh li bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#7edb" rel="noopener">功能选择</a></li><li id="ec0b" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka lf lg lh li bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#61e6" rel="noopener">模型部署</a></li></ol><p id="2f43" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="8b0c" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">现在，让我们从使用回归预测汽车价格的机器学习任务开始。</p><ol class=""><li id="f327" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka lf lg lh li bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#f327" rel="noopener"> <strong class="jf hj">探索性数据分析</strong> </a></li></ol><p id="cf81" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">现在，让我们从使用回归预测汽车价格的机器学习任务开始。首先，我将导入完成该任务所需的所有必要的库，并导入数据集。</p><p id="37e8" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">1)导入库</p><p id="f1ed" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">2)导入数据集</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lr"><img src="../Images/afaefb4302993762f4833925f8cbcf5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*1ikDoERC3YJSM_qLncDMDQ.png"/></div></figure><p id="2b01" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">在处理数据科学问题时，我们可以做的第一件事是了解您正在处理的数据集。记录下数据中的主要观察结果和趋势。监控变量和输出'<em class="kw">销售价格</em>'之间的所有相关性。为此，您可以使用<strong class="jf hj"> df.info </strong>、<strong class="jf hj"> df.head()等。</strong></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ls"><img src="../Images/513932affad5cb5fb2eda104952aa27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNOp9nmhNSfoqYoPflvpNw.png"/></div></div></figure><h2 id="f9e4" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">在数据分析中，我们将尝试找出以下内容</h2><ol class=""><li id="2d42" class="la lb hi jf b jg jh jk jl jo lc js ld jw le ka lf lg lh li bi translated">数据集中缺少值。</li></ol><p id="c8ed" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">2.所有的数值变量和数值变量的分布。</p><p id="4056" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">3.分类变量</p><p id="f883" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">4.极端值</p><p id="4b7a" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">5.独立特性和从属特性之间的关系(<em class="kw">销售价格</em>)</p><p id="02b5" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="d304" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#d304" rel="noopener"> <strong class="jf hj"> 2。特色工程</strong> </a></p><p id="3afa" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">您可以看到数据的样子，但是在使用它之前，我们需要对它进行定制。我们将在特征工程中执行以下所有步骤</p><ul class=""><li id="3413" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka mh lg lh li bi translated"><strong class="jf hj">缺失值的处理</strong></li></ul><p id="74b1" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">如果该列不在我们的模型中，我们将删除它，或者我们可以使用<strong class="jf hj">集中趋势度量，如平均值、中值或<strong class="jf hj">数字特征的模式</strong>。</strong></p><p id="4413" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这里我们删除了<em class="kw">‘Car _ Name’列，因为它对我们的模型没有帮助。我们的数据集中没有缺失值。</em></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mi"><img src="../Images/496a9814d07619454505cbe18d783bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ElPsbFhp5yMl0MjqKyIVlQ.png"/></div></div></figure><ul class=""><li id="fc0b" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka mh lg lh li bi translated"><strong class="jf hj">分类变量的替换</strong></li></ul><p id="588c" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">为了能够使用分类数据，我们使用了<strong class="jf hj"> pd.get_dummies() </strong>也称为<strong class="jf hj"> one hot encoding。</strong>这实质上是将变量的每个唯一值转换成它自己的二进制变量。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mj"><img src="../Images/960fed7fe33c71b230317ec987d02dd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xq-Gn6rmLAG9-bLtIhsZEA.png"/></div></div></figure><p id="4621" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">这里，我们还在数据集中增加了一个新的特征，即<em class="kw">‘no _ year’</em>，它是从<em class="kw">‘year’</em>列派生出来的，以便于分析数据。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mk"><img src="../Images/7dd7d0db56134fc51a82ccf36c29c5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLM0jwnBJGtuxQ6aLUG8jQ.png"/></div></div></figure><h1 id="850d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">可视化变量和关系</h1><p id="f4c2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">清理完数据后，我们可以将数据可视化，更好地理解不同变量之间的关系。您可以做更多的可视化工作来了解数据集，如散点图、直方图、箱线图等。使用<strong class="jf hj"> sns.heatmap() </strong>，我们可以看到'<em class="kw"> Present_Price' </em>与'<em class="kw"> Selling_Price' </em>和'<em class="kw"> Fuel_Type_Petrol' </em>和'<em class="kw"> Fuel_Type_Diesel' </em>与'<em class="kw">Selling _ Price '【T33]负相关</em></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ml"><img src="../Images/9d46b6b18fe8bd8385deec884e5b0690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7Ak_MPEHrdcdQFyen1SyA.png"/></div></div></figure><h2 id="7edb" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">3.<a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#7edb" rel="noopener">功能选择</a></h2><p id="511b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">模型训练:</strong></p><p id="5308" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">进行了列车测试数据分割。在这种情况下，我们将数据分为训练集和测试集，然后在训练集上拟合候选模型，在测试集上评估和选择它们。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mm"><img src="../Images/782676190a953da916e0adfbf6295bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6kb3cC1gFvLOt_XNwcGqeQ.png"/></div></div></figure><ul class=""><li id="769e" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka mh lg lh li bi translated">我们事先不知道哪个模型在这个问题上表现最好，因为它是不可知的。因此，我们在这个问题上拟合和评估了一套不同的模型。我们在训练集上使用随机森林回归和线性回归模型(特征选择)。我们还检查哪个模型给我们最好的结果。您可以尝试任意数量的回归模型，并从中选择一个最合适的模型。</li><li id="fdaa" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka mh lg lh li bi translated">我们使用随机网格来搜索最佳超参数。参数的随机搜索，在100个不同的组合中使用3折交叉验证搜索。</li></ul><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mn"><img src="../Images/44b7515081e5a08e64a3c5d26dc2cca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HjfbQtCAfoeONkeLVDUhAA.png"/></div></div></figure><ul class=""><li id="2843" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka mh lg lh li bi translated">模型选择是从预测建模问题的众多候选模型中选择一个模型的过程。在分析了这两个模型之后，我们选择了随机森林回归模型。</li></ul><p id="fecc" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated"><strong class="jf hj">拟合参数分布</strong></p><p id="b6b9" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">您还可以使用<code class="du mo mp mq mr b"><strong class="jf hj">distplot()</strong></code>来拟合数据集的参数分布，并直观地评估它与观察数据的对应程度。它应该是一个封闭的高斯分布图，并且“y_test”(真实值)和“预测值”之间的差异也应该是最小的。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ms"><img src="../Images/6bbc5e1faaf64bce951ec4aa018d8ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*648fiF3LaFWEFwYsFRfvFA.png"/></div></div></figure><p id="4e72" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">散点图用于观察变量之间的关系，并用点来表示变量之间的关系。这里的点几乎排成一条线。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mt"><img src="../Images/b3204a6670535479665d96d1348bf278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjADzyWkwGCC5EDzMMk9aA.png"/></div></div></figure><h2 id="8699" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">检查模型的准确性</h2><p id="3f26" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">评估模型准确性是创建机器学习模型以描述模型在预测中表现如何的过程中的一个重要部分。MSE、MAE和RMSE度量主要用于评估回归分析中的预测误差率和模型性能。</p><ul class=""><li id="5e8a" class="la lb hi jf b jg kn jk ko jo lo js lp jw lq ka mh lg lh li bi translated"><strong class="jf hj"> MAE </strong>(平均绝对误差)代表原始值和预测值之间的差异，通过对数据集的绝对差异进行平均来提取。</li><li id="c787" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka mh lg lh li bi translated"><strong class="jf hj"> MSE </strong>(均方误差)代表原始值和预测值之间的差异，通过对数据集的平均差异进行平方来提取。</li><li id="cff2" class="la lb hi jf b jg lj jk lk jo ll js lm jw ln ka mh lg lh li bi translated"><strong class="jf hj"> RMSE </strong>(均方根误差)是以MSE的平方根表示的误差率。</li></ul><p id="4deb" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">回归器保存为pickle文件，以便将来加快执行速度。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mu"><img src="../Images/a6b2d364e0432083e7591c4b0600936b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a48Tk9ugA-8Q1IXVIFsIeA.png"/></div></div></figure><p id="6555" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><h2 id="61e6" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated"><a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#61e6" rel="noopener"> 4。模型部署</a></h2><p id="9e28" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">模型部署是任何机器学习项目的最后阶段之一。在这里，我们将设计一个用户界面。我们用一个烧瓶制作了一个HTML文件，用于汽车价格预测。这将获取每个要素的输入值，并计算二手车的销售价格，如下图所示。</p><p id="61dd" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">您可以通过GitHub链接在Heroku上部署您的模型。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mv"><img src="../Images/57b409b09e6481fb09b068ad4d0e9bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4CZ5BAeQHWdbnqjcp0hjuQ.png"/></div></div></figure><p id="6844" class="pw-post-body-paragraph jd je hi jf b jg kn ji jj jk ko jm jn jo kp jq jr js kq ju jv jw kr jy jz ka hb bi translated">我希望你喜欢这篇关于如何用机器学习预测二手车价格的文章。<a class="ae ks" href="https://medium.com/p/d25559cf2d2a/edit#422d" rel="noopener">给出了Github的链接</a>，在那里你会找到所有的源代码。欢迎在下面的评论区提出你有价值的问题:)</p></div></div>    
</body>
</html>
<html>
<head>
<title>Better Protect Your Local #AWS Keys With Bitwarden</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Bitwarden更好地保护您的本地#AWS密钥</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/beter-protect-your-local-aws-keys-with-bitwarden-9f63055544dc?source=collection_archive---------15-----------------------#2021-04-21">https://medium.com/geekculture/beter-protect-your-local-aws-keys-with-bitwarden-9f63055544dc?source=collection_archive---------15-----------------------#2021-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/aa0f82ebf99765c660e6ca2a4af87913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dgWYhUftotSar9Fwj9DA_A.png"/></div></div></figure><div class=""/><p id="a0ed" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于不想在<code class="du jo jp jq jr b">.aws/credentials</code>文件中以普通 <strong class="is hu">文本</strong>存储<strong class="is hu">AWS键的人。这很容易实现。</strong></p><p id="2395" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可能有其他解决方案来实现同样的目的，但这是一个快速简单的设置，提供了一个<strong class="is hu">相当不错的额外安全级别</strong>。</p><p id="7489" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">.aws/credentials</code>文件提供了运行定制流程的能力。像AWS记载的<a class="ae js" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sourcing-external.html" rel="noopener ugc nofollow" target="_blank">。我正在使用macOS和一些基本的bash脚本。</a></p><p id="5aa8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样做的<code class="du jo jp jq jr b">.aws/credentials</code>文件看起来像这样。</p><p id="0ef7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jt">注意，我这里用的是2个AWS概要，</em> <code class="du jo jp jq jr b"><em class="jt">[turpin]</em></code> <em class="jt">和</em> <code class="du jo jp jq jr b"><em class="jt">[micropole]</em></code> <em class="jt">。如果您只有一个aws帐户，这将是AWS的默认配置文件:</em> <code class="du jo jp jq jr b"><em class="jt">[default]</em></code> <em class="jt">。</em></p><figure class="ju jv jw jx fd hk"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="1368" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将要调用的脚本，名为<code class="du jo jp jq jr b">awscreds</code>使用Bitwarden cli，基本上只用:<code class="du jo jp jq jr b">bw get username cli_&lt;&lt;profile&gt;&gt;</code>和<code class="du jo jp jq jr b">bw get password cli_&lt;&lt;profile&gt;&gt;</code>对Bitwarden做2次cli调用。</p><p id="9c90" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，脚本以预期的格式回显收集到的密钥(第41行)。</p><figure class="ju jv jw jx fd hk"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="beff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Bitwarden中，您需要尊重命名，并将您的密钥存储在<code class="du jo jp jq jr b">cli_&lt;&lt;profile&gt;&gt;</code>下。对于用户名，您提供您的访问密钥ID，对于密码，您提供秘密访问密钥。</p><figure class="ju jv jw jx fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ka"><img src="../Images/e7a96bb3bc4d0d4c2a28c47db2d3b3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUGW23QchSMnu7ENgKssyg.png"/></div></div></figure><h1 id="40e6" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">在行动！</h1><p id="6668" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">下面你可以看到如何使用该解决方案。</p><p id="b1ae" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您首先使用命令<code class="du jo jp jq jr b">bw unlock</code>解锁保险库，这将生成一个会话密钥，您需要导出该密钥:</p><p id="283b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">export BW_SESSION="____#bitwarden_generated_session_key#____</code>。</p><p id="9d53" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，您就可以使用AWS cli，例如<code class="du jo jp jq jr b">aws s3 ls --profile=turpin</code>！</p><figure class="ju jv jw jx fd hk"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="b8b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了用硬件MFA更好地保护Bitwarden帐户，我喜欢使用<a class="ae js" href="https://www.yubico.com/products/" rel="noopener ugc nofollow" target="_blank"> Yubikeys </a>，它也可以无缝地与Bitwarden cli配合使用。</p><p id="5db0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">提示，在Bitwarden应用程序中更新后，可能的更改不会立即反映在cli中，要调用<a class="ae js" href="https://bitwarden.com/help/article/cli/#sync" rel="noopener ugc nofollow" target="_blank"> sync </a>，只需执行:<code class="du jo jp jq jr b">bw sync</code>。</p><p id="70a5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望这能有所帮助，泰瑞</p></div></div>    
</body>
</html>
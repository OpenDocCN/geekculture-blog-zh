<html>
<head>
<title>What are Pods in Kubernetes?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kubernetes里的豆荚是什么？</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/what-are-pods-in-kubernetes-861beb65e138?source=collection_archive---------4-----------------------#2021-08-07">https://medium.com/geekculture/what-are-pods-in-kubernetes-861beb65e138?source=collection_archive---------4-----------------------#2021-08-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3cd3" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">什么是Kubernetes豆荚？我们如何使用它们来运行我们的容器呢？我们如何使用kubectl和YAML与他们互动？</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/5e4a0de4c9e26802113b6c080fb6c151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*up5b1m30jjhKLuOY.PNG"/></div></div></figure><p id="cd8f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在开了很长时间的玩笑说我要学Kubernetes之后，我终于在两周前认真地开始学了。我和我的老板聊了聊，他鼓励我学习一些我的领域之外的东西，所以这似乎是一个好机会，让我最终开始认真对待它。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kf"><img src="../Images/d38514c0cc577fc405d3f6ffea0abbfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/0*yMM56rg5DzEKVmzt.png"/></div></figure><p id="b96e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我是一个自学成才的程序员。我的大部分基础知识都来自于晚上在电脑前阅读文档、在线观看教程和实际操作。我一直是一个分享的学习者，这意味着当我学到一些技术时，我喜欢写一篇关于它的博客。部分原因是当我必须再次查找它时，我可以很容易地搜索它，但也是因为我可以与他人分享我所学到的东西，希望它能帮助任何碰巧找到它的人。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kg"><img src="../Images/f0e5d393ac5e3905f33816e94cdfb662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*lug53RPr_pWtimqK.png"/></div></figure><p id="3cec" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我仍然处于我的Kubernetes旅程的早期阶段，但是我已经为自己设定了一个目标，那就是今年获得我的认证Kubernetes应用程序开发人员(CKAD)认证。那还有很长的路要走，因为我还在思考一些基本的东西，但是我已经给自己设定了一个目标。</p><p id="7cfb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">带着这个目标，我的短期目标是理清基本思路，创建一系列涵盖每个主题的博客帖子。</p><p id="cc93" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">介绍完毕后，让我们开始讨论第一个主题，豆荚！</p><p id="5b4a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在这篇博文中，我们将讨论:</p><ul class=""><li id="5248" class="kh ki hi jl b jm jn jp jq js kj jw kk ka kl ke km kn ko kp bi translated">什么是豆荚？</li><li id="72d7" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated">单集装箱和多集装箱有什么区别？</li><li id="4af4" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated">如何在Kubernetes中创建pod？</li><li id="6299" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated">我们如何使用kubectl部署我们的Pods并与之交互？</li><li id="750f" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated">我们如何确保我们在Kubernetes的豆荚是健康的？</li></ul><h1 id="d1d6" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">什么是豆荚？</h1><p id="3ecc" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">Pods是Kubernetes对象，是在我们的Kubernetes集群中运行容器的基本单元。事实上，豆荚是Kubernetes模型中最小的物体。</p><p id="5056" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Kubernetes使用pod来运行我们应用程序的一个实例，一个pod代表该应用程序的一个实例。我们可以通过添加更多Pod副本来横向扩展我们的应用程序。</p><p id="1cc4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Pod可以包含一个或多个容器作为一个组，这些容器在Pod中共享相同的资源(存储、网络资源、名称空间)。Pod通常与容器有一对一的映射，但是在更高级的情况下，我们可能在一个Pod中运行多个容器。</p><p id="1ace" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Pods是短暂的资源，这意味着Pods可以在任何时候终止，然后在Kubernetes集群中的另一个节点上重新启动。他们活着又死去，但是豆荚永远不会复活。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/c318c9360c2ae37439c1e990196399f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e1IE4CyLnfsP7Wg_.PNG"/></div></div></figure><p id="e5b8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Pod容器将共享名称网络命名空间和接口。容器流程需要绑定到Pod中的不同端口，并且端口可以由单独容器中的容器重用。Pods不跨越Kubernetes集群中的节点。</p><h1 id="bcaf" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">单集装箱和多集装箱有什么区别？</h1><p id="9e0c" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">像我之前提到的，pod可以包含单个或多个容器。</p><p id="9ce7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在Pod 中运行<strong class="jl hj">单个容器是一个常见的用例。在这里，Pod充当单个容器的包装，Kubernetes管理Pod，而不是直接管理容器。</strong></p><p id="0aba" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们还可以在一个Pod中运行<strong class="jl hj">多个容器</strong>。在这里，Pod包装了一个由多个容器组成的应用程序，并共享资源。</p><p id="2550" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果我们需要在一个Pod中运行多个容器，建议我们只在容器紧密耦合的情况下这样做。</p><h1 id="0c0f" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">如何在Kubernetes中创建pod？</h1><p id="d01d" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">我们可以使用YAML文件在Kubernetes中定义pod。使用这些YAML文件，我们可以创建与Kubernetes API交互的对象(Pods、名称空间、部署等。).在幕后，kubectl将我们在YAML文件中定义的信息转换成JSON，从而向Kubernetes API发出请求。</p><p id="1d49" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我是YAML的粉丝，它很容易理解正在发生的事情，并且感谢像Visual Studio代码这样的工具中的扩展，它们很容易创建和管理。</p><p id="2369" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我知道压痕会很痛。我使用红帽在Visual Studio代码中开发的<a class="ae lt" href="https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml" rel="noopener ugc nofollow" target="_blank"> YAML代码扩展</a>来帮助我编写我的YAML文件。对于Kubernetes的intellisense，我使用了<a class="ae lt" href="https://marketplace.visualstudio.com/items?itemName=ms-kubernetes-tools.vscode-kubernetes-tools" rel="noopener ugc nofollow" target="_blank"> Kubernetes代码扩展</a>。</p><p id="fa39" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我们来看看YAML对Kubernetes Pod的定义示例:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="1108" class="lz kw hi lv b fi ma mb l mc md">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: nginx-2<br/>  labels:<br/>    name: nginx-2<br/>    env: production<br/>spec:<br/>  containers:<br/>  - name: nginx<br/>    image: nginx</span></pre><p id="b10b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我们把它分解一下。要使用YAML创建Kubernetes对象，我们需要为以下字段设置值。</p><p id="77b4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> apiVersion </strong> —这定义了我们想要在这个YAML文件中使用的Kubernetes API版本。你可以在Kubernetes <a class="ae lt" href="https://kubernetes.io/docs/reference/using-api/#api-versioning" rel="noopener ugc nofollow" target="_blank">这里</a>阅读更多关于API版本的内容。</p><p id="86b3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">种类</strong> —这定义了我们想要创建哪种Kubernetes对象。</p><p id="96c7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">元数据</strong> —这是帮助我们唯一识别想要创建的对象的数据。在这里，我们可以为我们的应用程序提供一个名称，并为我们的对象应用标签。</p><p id="b25f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj"> spec </strong> —这定义了我们想要的或我们的对象的状态。我们用于spec的格式。对于我们的Pod文件，我们已经提供了关于我们希望在Pod上托管的容器的信息。</p><p id="6862" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">要查看我们还可以在Pod YAML文件中定义什么，【Kubernetes的这个文档将会帮助您。</p><h1 id="eab9" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">我们如何使用kubectl部署我们的Pods并与之交互？</h1><p id="4f65" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">有几种方法可以让我们使用kubectl来部署我们pod并与之交互！</p><p id="c03d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><em class="me">等等，kubectl是什么？</em></p><p id="e3af" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">kubectl，(kube-control，或者有人称之为kube-cuddle)是Kubernetes的命令行工具。它允许我们对Kubernetes集群运行命令。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/31c56601d7ef8787d63470395b1aa5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/0*5tnatbvFj2wRSOxL"/></div></figure><p id="230f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过kubectl，我们可以使用YAML定义文件创建一个Pod，如下所示:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="33fd" class="lz kw hi lv b fi ma mb l mc md">kubectl apply -f mypod.yaml</span></pre><p id="bc83" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们可以像这样列出我们所有的pod:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="4513" class="lz kw hi lv b fi ma mb l mc md">kubectl get pods</span></pre><p id="7274" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们可以使用kubectl对外公开一个容器端口。记住，默认情况下，pod和容器只能在Kubernetes集群中访问。使用Kubectl，我们可以运行以下命令:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="9fb5" class="lz kw hi lv b fi ma mb l mc md">kubectl port-forward mypod 8080:80</span></pre><p id="26b3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们也可以删除pod。我们可以这样直接删除pod:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="f26a" class="lz kw hi lv b fi ma mb l mc md">kubectl delete pod mypod</span></pre><p id="d01a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这将导致圆荚体被摧毁和创造。我们还可以删除管理Pod的部署(我将在以后的文章中讨论Kubernetes部署)，如下所示:</p><pre class="iy iz ja jb fd lu lv lw lx aw ly bi"><span id="6835" class="lz kw hi lv b fi ma mb l mc md">kubectl delete deployment mydeployment</span></pre><h1 id="420c" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">我们如何确保我们在Kubernetes的豆荚是健康的？</h1><p id="fae4" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">Kubernetes依靠探针来确定一个Pod是否健康。探针是由Kubelet在容器上定期执行的诊断操作。</p><p id="a69e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有三种类型的探头:</p><ul class=""><li id="9dfa" class="kh ki hi jl b jm jn jp jq js kj jw kk ka kl ke km kn ko kp bi translated"><strong class="jl hj">活性探测器</strong> —这些探测器用于确定一个Pod是否正常运行。如果活跃度探测失败，kubelet将终止容器，然后容器将根据其定义的策略重新启动(我们可以将这些定义为总是、失败和从不)</li><li id="c20b" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><strong class="jl hj">准备就绪探测器</strong> —这些用于确定一个pod是否应该接收请求。如果探测失败，端点控制器将从所有与该Pod匹配的服务的端点中删除该Pod的IP地址。</li><li id="e172" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><strong class="jl hj">启动探针</strong> —用于确定集装箱是否已经启动。如果提供了启动探测，则所有其他探测都将被禁用，直到它成功。</li></ul><p id="f504" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了执行诊断检查，Kubelet将调用一个由容器实现的处理程序。这些类型的处理程序是:</p><ul class=""><li id="40bd" class="kh ki hi jl b jm jn jp jq js kj jw kk ka kl ke km kn ko kp bi translated"><strong class="jl hj">执行动作</strong> —这在容器内部执行一个动作</li><li id="7b66" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><strong class="jl hj">TCP检查操作</strong> —针对指定端口上的容器IP地址执行TCP检查。</li><li id="8c2d" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><strong class="jl hj"> HTTPGetAction </strong> — HTTP Get请求针对指定端口和路径上的Pods IP地址执行。</li></ul><p id="774b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这些探针可能导致<em class="me">成功</em>、<em class="me">失败</em>或<em class="me">未知</em>的结果。</p><h1 id="8bc5" class="kv kw hi bd kx ky kz la lb lc ld le lf io lg ip lh ir li is lj iu lk iv ll lm bi translated">结论</h1><p id="c11f" class="pw-post-body-paragraph jj jk hi jl b jm ln ij jo jp lo im jr js lp ju jv jw lq jy jz ka lr kc kd ke hb bi translated">希望这篇文章已经帮助你理解了Kubernetes中pod的基础知识！</p><p id="cc06" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果你想更多地了解Kubernetes中的Pods，我可以参考以下资源:</p><ul class=""><li id="c5a2" class="kh ki hi jl b jm jn jp jq js kj jw kk ka kl ke km kn ko kp bi translated">【Kubernetes Pod官方文档</li><li id="1a8f" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><a class="ae lt" href="https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/pod-v1/#PodSpec" rel="noopener ugc nofollow" target="_blank"> Kubernetes Pod YAML参考</a></li><li id="3309" class="kh ki hi jl b jm kq jp kr js ks jw kt ka ku ke km kn ko kp bi translated"><a class="ae lt" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes" rel="noopener ugc nofollow" target="_blank"> Pod生命周期</a></li></ul><p id="d2e9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">快乐编码💻👩‍💻👨‍💻</p></div></div>    
</body>
</html>
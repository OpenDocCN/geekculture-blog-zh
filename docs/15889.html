<html>
<head>
<title>Build Simple CLI-Based Voice Assistant with PyAudio, Speech Recognition, pyttsx3 and SerpApi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyAudio、语音识别、pyttsx3和SerpApi构建简单的基于CLI的语音助手</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/build-simple-cli-based-voice-assistant-with-pyaudio-speech-recognition-pyttsx3-and-serpapi-8bf605c02565?source=collection_archive---------8-----------------------#2022-11-28">https://medium.com/geekculture/build-simple-cli-based-voice-assistant-with-pyaudio-speech-recognition-pyttsx3-and-serpapi-8bf605c02565?source=collection_archive---------8-----------------------#2022-11-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/6892605de7813a480ca804c721ecf6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*vvQJ2u14cOAlvuOu6-UxbQ.png"/></div></figure><div class=""/><h1 id="dc2b" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">介绍</h1><p id="4d97" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">正如你看到的标题，这是一个演示项目，显示了一个非常基本的语音助手脚本，可以回答你的问题，在终端基于谷歌搜索结果。</p><p id="34c5" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">你可以在GitHub资源库中找到完整的代码:<code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/dimitryzub/serpapi-demo-projects/tree/4789cf3c2a5cb7af6c29ba13a4222a0eec05eadf/speech-recognition/cli-based" rel="noopener ugc nofollow" target="_blank">dimitryzub/serpapi-demo-projects/speech-recognition/cli-based/</a></code></p><p id="8ff9" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">后续博客帖子将会涉及:</p><ul class=""><li id="ebbb" class="ks kt hp jm b jn ki jr kj jv ku jz kv kd kw kh kx ky kz la bi translated">基于网络的解决方案使用了<a class="ae kr" href="https://flask.palletsprojects.com/en/2.2.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>，一些HTML，CSS和Javascript。</li><li id="090c" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated">使用<a class="ae kr" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>和<a class="ae kr" href="https://dart.dev/" rel="noopener ugc nofollow" target="_blank"> Dart </a>的基于Android和Windows的解决方案。</li></ul><h1 id="6505" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">我们将在这篇博文中构建什么</h1><figure class="lg lh li lj fd hk"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">SerpApi Voice Assistant Video Demo</figcaption></figure><h1 id="a211" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">先决条件</h1><p id="112d" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">首先，让我们确保我们处于一个不同的环境中，并正确安装项目所需的库。最难的(可能)是安装<code class="du kn ko kp kq b">pyaudio</code>。</p><h1 id="6890" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">虚拟环境和库安装</h1><p id="697b" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">在开始安装库之前，我们需要为这个项目创建并激活一个新环境:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="0101" class="lu in hp kq b be lv lw l lx ly"># if you're on Linux based systems<br/>$ python -m venv env &amp;&amp; source env/bin/activate<br/>$ (env) &lt;path&gt;<br/><br/># if you're on Windows and using Bash terminal<br/>$ python -m venv env &amp;&amp; source env/Scripts/activate<br/>$ (env) &lt;path&gt;<br/><br/># if you're on Windows and using CMD<br/>python -m venv env &amp;&amp; .\env\Scripts\activate<br/>$ (env) &lt;path&gt;</span></pre><p id="d31b" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">解释<code class="du kn ko kp kq b">python -m venv env</code>告诉Python运行模块(<code class="du kn ko kp kq b"><a class="ae kr" href="https://docs.python.org/2/using/cmdline.html#cmdoption-m" rel="noopener ugc nofollow" target="_blank">-m</a></code> ) <code class="du kn ko kp kq b"><a class="ae kr" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank">venv</a></code>，创建一个名为<code class="du kn ko kp kq b">env</code>的文件夹。<code class="du kn ko kp kq b">&amp;&amp;</code>代表和。将激活您的环境，您将只能在该环境中安装库。</p><p id="1eaf" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">现在安装所有需要的库:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="3239" class="lu in hp kq b be lv lw l lx ly">pip install rich pyttsx3 SpeechRecognition google-search-results</span></pre><p id="f2cd" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">现在到<code class="du kn ko kp kq b"><a class="ae kr" href="https://pypi.org/project/PyAudio/" rel="noopener ugc nofollow" target="_blank">pyaudio</a></code>。请记住，安装时<code class="du kn ko kp kq b">pyaudio</code>可能会抛出错误。你可能需要做额外的调查。</p><p id="026a" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">如果你在Linux上，我们需要<a class="ae kr" href="https://stackoverflow.com/a/50409644/15164646" rel="noopener ugc nofollow" target="_blank">安装一些开发依赖来使用</a> <code class="du kn ko kp kq b"><a class="ae kr" href="https://stackoverflow.com/a/50409644/15164646" rel="noopener ugc nofollow" target="_blank">pyaudio</a></code>:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="8598" class="lu in hp kq b be lv lw l lx ly">$ sudo apt-get install -y libasound-dev portaudio19-dev<br/>$ pip install pyaudio</span></pre><p id="9530" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">如果你在Windows上，那就更简单了(用CMD和Git Bash测试过):</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="6df9" class="lu in hp kq b be lv lw l lx ly">pip install pyaudio</span></pre><h1 id="1bd2" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">完整代码</h1><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="e1cc" class="lu in hp kq b be lv lw l lx ly">import os<br/>import speech_recognition<br/>import pyttsx3<br/>from serpapi import GoogleSearch<br/>from rich.console import Console<br/>from dotenv import load_dotenv<br/><br/>load_dotenv('.env')<br/>console = Console()<br/><br/>def main():<br/>    console.rule('[bold yellow]SerpApi Voice Assistant Demo Project')<br/>    recognizer = speech_recognition.Recognizer()<br/><br/>    while True:<br/>        with console.status(status='Listening you...', spinner='point') as progress_bar:<br/>            try:<br/>                with speech_recognition.Microphone() as mic:<br/>                    recognizer.adjust_for_ambient_noise(mic, duration=0.1)<br/>                    audio = recognizer.listen(mic)<br/>                    text = recognizer.recognize_google(audio_data=audio).lower()<br/>                    console.print(f'[bold]Recognized text[/bold]: {text}')<br/><br/>                    progress_bar.update(status='Looking for answers...', spinner='line')<br/>                    params = {<br/>                        'api_key': os.getenv('API_KEY'),<br/>                        'device': 'desktop',<br/>                        'engine': 'google',<br/>                        'q': text,<br/>                        'google_domain': 'google.com',<br/>                        'gl': 'us',<br/>                        'hl': 'en'<br/>                    }<br/>                    search = GoogleSearch(params)<br/>                    results = search.get_dict()<br/><br/>                    try:<br/>                        if 'answer_box' in results:<br/>                            try:<br/>                                primary_answer = results['answer_box']['answer']<br/>                            except:<br/>                                primary_answer = results['answer_box']['result']<br/>                            console.print(f'[bold]The answer is[/bold]: {primary_answer}')<br/>                        elif 'knowledge_graph' in results:<br/>                            secondary_answer = results['knowledge_graph']['description']<br/>                            console.print(f'[bold]The answer is[/bold]: {secondary_answer}')<br/>                        else:<br/>                            tertiary_answer = results['answer_box']['list']<br/>                            console.print(f'[bold]The answer is[/bold]: {tertiary_answer}')<br/><br/>                        progress_bar.stop() # if answered is success -&gt; stop progress bar.<br/>                        user_promnt_to_contiune_if_answer_is_success = input('Would you like to to search for something again? (y/n) ')<br/><br/>                        if user_promnt_to_contiune_if_answer_is_success == 'y':<br/>                            recognizer = speech_recognition.Recognizer()<br/>                            continue # run speech recognizion again until `user_promt` == 'n'<br/>                        else:<br/>                            console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>                            break<br/>                    except KeyError:<br/>                        progress_bar.stop()<br/>                        error_user_promt = input("Sorry, didn't found the answer. Would you like to rephrase it? (y/n) ")<br/><br/>                        if error_user_promt == 'y':<br/>                            recognizer = speech_recognition.Recognizer()<br/>                            continue # run speech recognizion again until `user_promt` == 'n'<br/>                        else:<br/>                            console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>                            break<br/>            except speech_recognition.UnknownValueError:<br/>                progress_bar.stop()<br/>                user_promt_to_continue = input('Sorry, not quite understood you. Could say it again? (y/n) ')<br/><br/>                if user_promt_to_continue == 'y':<br/>                    recognizer = speech_recognition.Recognizer()<br/>                    continue # run speech recognizion again until `user_promt` == 'n'<br/>                else:<br/>                    progress_bar.stop()<br/>                    console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>                    break<br/><br/>if __name__ == '__main__':<br/>    main()</span></pre><h1 id="dec2" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">代码解释</h1><p id="8425" class="pw-post-body-paragraph jk jl hp jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">导入库:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="7242" class="lu in hp kq b be lv lw l lx ly">import os<br/>import speech_recognition<br/>import pyttsx3<br/>from serpapi import GoogleSearch<br/>from rich.console import Console<br/>from dotenv import load_dotenv</span></pre><ul class=""><li id="002a" class="ks kt hp jm b jn ki jr kj jv ku jz kv kd kw kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Textualize/rich" rel="noopener ugc nofollow" target="_blank">rich</a></code> Python库，用于在终端中进行漂亮的格式化。</li><li id="ff8d" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/nateshmbhat/pyttsx3" rel="noopener ugc nofollow" target="_blank">pyttsx3</a></code> Python的文本到语音转换器，离线工作。</li><li id="254f" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Uberi/speech_recognition" rel="noopener ugc nofollow" target="_blank">SpeechRecognition</a></code> Python库将语音转换为文本。</li><li id="1c06" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/serpapi/google-search-results-python" rel="noopener ugc nofollow" target="_blank">google-search-results</a></code> SerpApi的Python API包装器，可解析来自15个以上搜索引擎的数据。</li><li id="9900" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank">os</a></code>读取秘密环境变量。在这种情况下，它是SerpApi API密钥。</li><li id="dcfb" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/theskumar/python-dotenv" rel="noopener ugc nofollow" target="_blank">dotenv</a></code>从<code class="du kn ko kp kq b">.env</code>文件加载您的环境变量(SerpApi API key)。<code class="du kn ko kp kq b">.env</code>文件可以重命名为任何文件:<code class="du kn ko kp kq b">.napoleon</code> <code class="du kn ko kp kq b">.</code>(点)代表一个环境变量文件。</li></ul><p id="90d2" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">定义<code class="du kn ko kp kq b">rich</code> <code class="du kn ko kp kq b"><a class="ae kr" href="https://rich.readthedocs.io/en/stable/console.html" rel="noopener ugc nofollow" target="_blank">Console()</a></code>。它将用于美化终端输出(动画等):</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="d676" class="lu in hp kq b be lv lw l lx ly">console = Console()</span></pre><p id="5794" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">定义<code class="du kn ko kp kq b">main</code>功能，所有功能将在此发生:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="2014" class="lu in hp kq b be lv lw l lx ly">def main():<br/>    console.rule('[bold yellow]SerpApi Voice Assistant Demo Project')<br/>    recognizer = speech_recognition.Recognizer()</span></pre><p id="4108" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在函数的开始，我们定义<code class="du kn ko kp kq b">speech_recognition.Recognizer()</code>和<code class="du kn ko kp kq b">console.rule</code>将产生以下输出:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="af2e" class="lu in hp kq b be lv lw l lz ly">───────────────────────────────────── SerpApi Voice Assistant Demo Project ─────────────────────────────────────</span></pre><p id="d629" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">下一步是创建一个while循环，该循环将持续监听麦克风输入以识别语音:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="e2a4" class="lu in hp kq b be lv lw l lx ly">while True:<br/>    with console.status(status='Listening you...', spinner='point') as progress_bar:<br/>        try:<br/>            with speech_recognition.Microphone() as mic:<br/>                recognizer.adjust_for_ambient_noise(mic, duration=0.1)<br/>                audio = recognizer.listen(mic)<br/><br/>                text = recognizer.recognize_google(audio_data=audio).lower()<br/>                console.print(f'[bold]Recognized text[/bold]: {text}')</span></pre><ul class=""><li id="3d73" class="ks kt hp jm b jn ki jr kj jv ku jz kv kd kw kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Textualize/rich/blob/5f4e93efb159af99ed51f1fbfd8b793bb36448d9/rich/console.py#L1144-L1163" rel="noopener ugc nofollow" target="_blank">console.status</a></code> -一个<code class="du kn ko kp kq b">rich</code>进度条，仅用于修饰目的。</li><li id="cb3b" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b">speech_recognition.Microphone()</code>开始从麦克风拾取输入。</li><li id="316a" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Uberi/speech_recognition/blob/353d4ef74a55082de1f32796601899506d1b8bc7/speech_recognition/__init__.py#L560-L567" rel="noopener ugc nofollow" target="_blank">recognizer.adjust_for_ambient_noise</a></code>旨在用环境能量水平校准能量阈值。</li><li id="356e" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Uberi/speech_recognition/blob/353d4ef74a55082de1f32796601899506d1b8bc7/speech_recognition/__init__.py#L636-L649" rel="noopener ugc nofollow" target="_blank">recognizer.listen</a></code>监听实际的用户文本。</li><li id="17df" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Uberi/speech_recognition/blob/353d4ef74a55082de1f32796601899506d1b8bc7/speech_recognition/__init__.py#L859-L874" rel="noopener ugc nofollow" target="_blank">recognizer.recognize_google</a></code>使用Google语音识别API执行语音识别。<code class="du kn ko kp kq b">lower()</code>是降低识别文本。</li><li id="1a98" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b">console.print</code>一条<code class="du kn ko kp kq b">rich</code> <code class="du kn ko kp kq b">print</code>语句，允许使用文本修改，如添加<strong class="jm hq">粗体</strong>、<em class="ma">斜体</em>等。</li></ul><p id="fd54" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><code class="du kn ko kp kq b">spinner='point'</code>将产生如下输出(<a class="ae kr" href="https://github.com/Textualize/rich/blob/5f4e93efb159af99ed51f1fbfd8b793bb36448d9/rich/console.py#L1157" rel="noopener ugc nofollow" target="_blank">使用</a> <code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Textualize/rich/blob/5f4e93efb159af99ed51f1fbfd8b793bb36448d9/rich/console.py#L1157" rel="noopener ugc nofollow" target="_blank">python -m rich.spinner</a></code> <a class="ae kr" href="https://github.com/Textualize/rich/blob/5f4e93efb159af99ed51f1fbfd8b793bb36448d9/rich/console.py#L1157" rel="noopener ugc nofollow" target="_blank">查看</a> <code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Textualize/rich/blob/5f4e93efb159af99ed51f1fbfd8b793bb36448d9/rich/console.py#L1157" rel="noopener ugc nofollow" target="_blank">spinners</a></code>列表):</p><figure class="lg lh li lj fd hk er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/0feafb91d82ce3549495e9e0b1c2be30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qgaTbUZIZ8aTs-qJ.gif"/></div></div></figure><p id="713d" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">之后，我们需要为搜索初始化SerpApi搜索参数:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="7795" class="lu in hp kq b be lv lw l lx ly">progress_bar.update(status='Looking for answers...', spinner='line') <br/>params = {<br/>    'api_key': os.getenv('API_KEY'),  # serpapi api key   <br/>    'device': 'desktop',              # device used for <br/>    'engine': 'google',               # serpapi parsing engine: https://serpapi.com/status<br/>    'q': text,                        # search query <br/>    'google_domain': 'google.com',    # google domain:          https://serpapi.com/google-domains<br/>    'gl': 'us',                       # country of the search:  https://serpapi.com/google-countries<br/>    'hl': 'en'                        # language of the search: https://serpapi.com/google-languages<br/>    # other parameters such as locations: https://serpapi.com/locations-api<br/>}<br/>search = GoogleSearch(params)         # where data extraction happens on the SerpApi backend<br/>results = search.get_dict()           # JSON -&gt; Python dict</span></pre><p id="5f5d" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><code class="du kn ko kp kq b">progress_bar.update</code>将使用新的<code class="du kn ko kp kq b">status</code>更新<code class="du kn ko kp kq b">progress_bar</code>(文本打印在控制台中)，并且<code class="du kn ko kp kq b">spinner='line'</code>将生成以下动画:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div class="er es mg"><img src="../Images/c1a167f9adaf57c58a761c7b683c72b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/0*pxHfDyyAnhCy0-wp.gif"/></div></figure><p id="4bea" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">之后，使用SerpApi的<a class="ae kr" href="https://serpapi.com/search-api" rel="noopener ugc nofollow" target="_blank">谷歌搜索引擎API </a>从谷歌搜索中提取数据。</p><p id="f64b" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">代码的以下部分将执行以下操作:</p><figure class="lg lh li lj fd hk er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mh"><img src="../Images/fccbb024cdd5bc068637fce6e9d83e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OTlq1oxeFhQuFXJV.png"/></div></div></figure><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="e87a" class="lu in hp kq b be lv lw l lx ly">try:<br/>    if 'answer_box' in results:<br/>        try:<br/>            primary_answer = results['answer_box']['answer']<br/>        except:<br/>            primary_answer = results['answer_box']['result']<br/>        console.print(f'[bold]The answer is[/bold]: {primary_answer}')<br/><br/>     elif 'knowledge_graph' in results:<br/>            secondary_answer = results['knowledge_graph']['description']<br/>            console.print(f'[bold]The answer is[/bold]: {secondary_answer}')<br/>        else:<br/>            tertiary_answer = results['answer_box']['list']<br/>            console.print(f'[bold]The answer is[/bold]: {tertiary_answer}')<br/>        progress_bar.stop()  # if answered is success -&gt; stop progress bar<br/><br/>        user_promnt_to_contiune_if_answer_is_success = input('Would you like to to search for something again? (y/n) ')<br/><br/>        if user_promnt_to_contiune_if_answer_is_success == 'y':<br/>            recognizer = speech_recognition.Recognizer()<br/>            continue         # run speech recognizion again until `user_promt` == 'n'<br/>        else:<br/>            console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>            break<br/><br/>    except KeyError:<br/>        progress_bar.stop()  # if didn't found the answer -&gt; stop progress bar<br/>        error_user_promt = input("Sorry, didn't found the answer. Would you like to rephrase it? (y/n) ")<br/><br/>        if error_user_promt == 'y':<br/>            recognizer = speech_recognition.Recognizer()<br/>            continue         # run speech recognizion again until `user_promt` == 'n'<br/>        else:<br/>            console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>            break</span></pre><p id="5df8" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">最后一步是处理麦克风没有声音时的错误:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="6bfd" class="lu in hp kq b be lv lw l lx ly"># while True:<br/>#     with console.status(status='Listening you...', spinner='point') as progress_bar:<br/>#         try:<br/>            # speech recognition code<br/>            # data extraction code<br/>        except speech_recognition.UnknownValueError:<br/>                progress_bar.stop()         # if didn't heard the speech -&gt; stop progress bar<br/>                user_promt_to_continue = input('Sorry, not quite understood you. Could say it again? (y/n) ')<br/><br/>          if user_promt_to_continue == 'y':<br/>              recognizer = speech_recognition.Recognizer()<br/>              continue               # run speech recognizion again until `user_promt` == 'n'<br/>          else:<br/>              progress_bar.stop()    # if want to quit -&gt; stop progress bar<br/>              console.rule('[bold yellow]Thank you for cheking SerpApi Voice Assistant Demo Project')<br/>              break</span></pre><p id="6547" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated"><code class="du kn ko kp kq b">console.rule()</code>将提供以下输出:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="2ac1" class="lu in hp kq b be lv lw l lz ly">───────────────────── Thank you for cheking SerpApi Voice Assistant Demo Project ──────────────────────</span></pre><p id="3dcc" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">添加<code class="du kn ko kp kq b">if __name__ == '__main__'</code>习语，防止用户在无意中意外调用某些脚本，并调用<code class="du kn ko kp kq b">main</code>函数运行整个脚本:</p><pre class="lg lh li lj fd lq kq lr bn ls lt bi"><span id="3e8e" class="lu in hp kq b be lv lw l lx ly">if __name__ == '__main__':<br/>    main()</span></pre><h1 id="00f1" class="im in hp bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">链接</h1><ul class=""><li id="70fb" class="ks kt hp jm b jn jo jr js jv mi jz mj kd mk kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Textualize/rich" rel="noopener ugc nofollow" target="_blank">rich</a></code></li><li id="ada0" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/nateshmbhat/pyttsx3" rel="noopener ugc nofollow" target="_blank">pyttsx3</a></code></li><li id="17b0" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/Uberi/speech_recognition" rel="noopener ugc nofollow" target="_blank">SpeechRecognition</a></code></li><li id="a019" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/serpapi/google-search-results-python" rel="noopener ugc nofollow" target="_blank">google-search-results</a></code></li><li id="9759" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank">os</a></code></li><li id="35e7" class="ks kt hp jm b jn lb jr lc jv ld jz le kd lf kh kx ky kz la bi translated"><code class="du kn ko kp kq b"><a class="ae kr" href="https://github.com/theskumar/python-dotenv" rel="noopener ugc nofollow" target="_blank">dotenv</a></code></li></ul><p id="cbf1" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">加入我们的<a class="ae kr" href="https://twitter.com/serp_api" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae kr" href="https://www.youtube.com/channel/UCUgIHlYBOD3yA3yDIRhg_mg" rel="noopener ugc nofollow" target="_blank">YouTube</a></p><p id="b1a5" class="pw-post-body-paragraph jk jl hp jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">添加一个<a class="ae kr" href="https://github.com/serpapi/public-roadmap/issues" rel="noopener ugc nofollow" target="_blank">特征请求</a>💫还是一个<a class="ae kr" href="https://github.com/serpapi/public-roadmap/issues" rel="noopener ugc nofollow" target="_blank"> Bug </a>🐞</p></div></div>    
</body>
</html>
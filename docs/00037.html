<html>
<head>
<title>Setup Amazon Elastic File System (EFS) and mount on to Ubuntu EC2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安装Amazon弹性文件系统(EFS)并挂载到Ubuntu EC2</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/ow-to-setup-amazon-elastic-file-system-efs-and-mount-on-to-ubuntu-ec2-b47346427d5?source=collection_archive---------2-----------------------#2019-08-01">https://medium.com/geekculture/ow-to-setup-amazon-elastic-file-system-efs-and-mount-on-to-ubuntu-ec2-b47346427d5?source=collection_archive---------2-----------------------#2019-08-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="31b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1)进入AWS控制台-&gt;服务菜单下的搜索<strong class="ih hj"> EFS </strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/50c8838cdf622e4f21fce4a924476645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rkuo4P5Da29VA_SxM-EJIw.png"/></div></div></figure><p id="2284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2)点击<strong class="ih hj">创建文件系统</strong>按钮</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/040ff0d1dd8f69c28ed202559975b519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OBvoaWasgB7u6PEt1iq49w.png"/></div></div></figure><p id="5955" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在VPC下选择您的VPC和可用性区域。选择EC2系统正在使用的安全组(如果不相同，请相应地配置安全组)。</p><p id="06e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3)点击<strong class="ih hj">下一步</strong>按钮，配置可选设置。您可以保留默认设置。您可以为标签添加名称和值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/e90cfcd039867cd35872cf90d4909a57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKJwpRiQJqLv4M7zMrs2RQ.png"/></div></div></figure><p id="4e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4)点击<strong class="ih hj">下一个</strong>按钮进行审核。审查完毕后，点击<strong class="ih hj">创建文件系统</strong>按钮。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jr"><img src="../Images/d29e1aeaff1d2efd152ae242e9247dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfDaY_6hTZJZCNuH9S4HCg.png"/></div></div></figure><p id="c249" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5)单击该行以查看已创建的EFS的详细信息，并复制DNS名称(例如:<strong class="ih hj">fs-xyz.efs.us-west-1.amazonaws.com)</strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es js"><img src="../Images/212c056bcfdae5dd311fdcf4d349032d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJED8ZzvWKzrnABtOqHKbQ.png"/></div></div></figure><p id="ede1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6)编辑EC2实例安全组，添加一条规则，在<strong class="ih hj">入站</strong>规则中选择<strong class="ih hj"> NFS端口</strong>(默认2049)。点击<strong class="ih hj">保存</strong>按钮保存编辑后的安全组。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/9039181a092fe37f16f8b5e143fd43f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PSKGnvw1nHDheUuKOux16g.png"/></div></div></figure><p id="1a80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7)将<strong class="ih hj">EFS</strong>安装到<strong class="ih hj"> EC2 </strong> (Ubuntu)上，接入EC2端子。</p><p id="03b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8) <strong class="ih hj"> cd /opt </strong>(假设你想挂载在/opt下)。</p><p id="785e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9) <strong class="ih hj"> sudo mkdir my_efs </strong>(假设文件夹名为my_efs)。</p><p id="91bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">10)<strong class="ih hj">sudo chmod+XXX/opt/my _ EFS</strong>(通过替换XXX给出合适的文件访问权限号)。</p><p id="1641" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">11) <strong class="ih hj"> sudo apt-get -y安装nfs-common </strong></p><p id="e814" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">12)运行命令(使用您的EFS DNS名称(在步骤5中复制)和挂载文件夹名称):<strong class="ih hj">sudo mount-t NFS 4-o NFS vers = 4.1，rsize=1048576，wsize=1048576，hard，timeo=600，retrans=2，nores port fs-XYZ . EFS . us-west-1 . amazonaws . com:/my _ EFS</strong></p><p id="79e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">13)完成上述步骤后，安装EFS。每当我们重新启动EC2时，它不会自动挂载。每当我们重新启动EC2时，后续步骤会自动将它挂载到EC2上。</p><p id="3eba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">14)在同一个EC2上，运行<strong class="ih hj"> sudo nano /etc/fstab </strong></p><p id="7f8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">15)将下面一行添加到/etc/fstab文件(<strong class="ih hj">不要更改中间的nfs </strong>名称。如果我们用amazon-efs-utils，那就是<strong class="ih hj"> efs </strong>。由于我们在步骤11中使用的是nfs-common，所以它应该是<strong class="ih hj"> nfs </strong>(它是一种文件类型，而不是挂载点。挂载点仅是my_efs)。<br/><strong class="ih hj">fs-XYZ . EFS . us-west-1 . Amazon AWS . com://opt/my _ EFS NFS defaults，_netdev 0 0 </strong></p><p id="80c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">16)在同一个EC2上，运行<strong class="ih hj"> sudo重启</strong></p><p id="b35d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您已经成功创建并挂载了EFS！</p><h1 id="3f7e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">常见问题</h1><p id="d471" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><strong class="ih hj">我正在部署一个新的EC2实例。如何配置现有的EFS？</strong></p><p id="8116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请浏览我的文章<a class="ae kx" rel="noopener" href="/@suryagutta/mount-existing-amazon-elastic-file-system-efs-during-ubuntu-ec2-launch-4dc32d1a617b"> <em class="ky">在Ubuntu EC2推出</em> </a>期间挂载现有的亚马逊弹性文件系统(EFS)。</p><p id="ce5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感谢</strong>的阅读！请👏如果你喜欢这篇文章，请跟我来，因为它鼓励我写更多！</p></div></div>    
</body>
</html>
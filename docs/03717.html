<html>
<head>
<title>The Lazy LazyPredict Prediction: An Exercise in Automated Python Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">懒惰的LazyPredict预测:自动化Python库中的一个练习</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/the-lazy-lazypredict-prediction-an-exercise-in-automated-python-libraries-f1adb4cd3f5a?source=collection_archive---------34-----------------------#2021-06-14">https://medium.com/geekculture/the-lazy-lazypredict-prediction-an-exercise-in-automated-python-libraries-f1adb4cd3f5a?source=collection_archive---------34-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d4ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://pypi.org/project/lazypredict/" rel="noopener ugc nofollow" target="_blank"> LazyPredict </a>是一个优秀的工具，它可以自动运行不同类型模型的数据，并返回每个模型的性能信息。这是一个很好的工具，可以节省时间，否则将花费在手工测试不同的模型上。然而，当我查看这个库时，我不禁想知道利用python库我还能做些什么。</p><p id="0783" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终，我登陆了<a class="ae jd" href="https://pypi.org/project/feature-engine/" rel="noopener ugc nofollow" target="_blank">特征引擎</a>和<a class="ae jd" href="https://pypi.org/project/featuretools/" rel="noopener ugc nofollow" target="_blank">特征工具</a>，进行EDA(探索性数据分析)和特征工程。有了这两个库和LazyPredict，我做了一个名为“懒惰的LazyPredict预测”的小练习</p><h1 id="c2aa" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">懒惰的懒惰预测</h1><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/7aa3a0763e5e75e8888937390144051b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSomT2UGCkKzboxiWhbfRQ.jpeg"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Image by <a class="ae jd" href="https://unsplash.com/@tmdpw" rel="noopener ugc nofollow" target="_blank">Tim De Pauw</a> from <a class="ae jd" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="259f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这提供了我所经历的过程的概述，为了更深入地了解，完整的笔记本可以在<a class="ae jd" href="https://github.com/ismizu/Lazy_LazyPredict" rel="noopener ugc nofollow" target="_blank">这个资源库</a>中找到。</p><p id="970d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个项目，我决定使用<a class="ae jd" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle的</a> <a class="ae jd" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a>。</p><p id="53e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开数据后，我首先查看缺失(NaN)值。快速检查显示有相当多的东西因年代久远而丢失。虽然根据不同的分类器估算年龄，例如:每个乘客等级或票价的平均年龄，可能会估算出更准确的值，但我认为这不符合本项目的精神。因此，我简单地利用了功能引擎中的MeanMedianImputer。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ks"><img src="../Images/effdfa0f84e8b6bd64dc9629f7e348bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TUZ7yQK0W7jrvxXanRRytA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Checking the sum of NaN values before/after imputing</figcaption></figure><p id="577d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在为缺失的年龄估算了一个值后，我把船舱和上船的两行都丢了。</p><h2 id="5d47" class="kt jf hi bd jg ku kv kw jk kx ky kz jo iq la lb js iu lc ld jw iy le lf ka lg bi translated">使用极端值</h2><p id="4f7e" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">处理完缺失信息后，我转向了极端值。极值可能会扭曲模型预测，因为模型会尝试使用不同范围的值。解决这个问题的一种方法是限制值在某一点停止，这是Feature Engine允许的。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lm"><img src="../Images/8914cf3e94762d68294be0ccb1c8627c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*cpxIXo2QsFPruvHsuN6Wlw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">df.describe() results</figcaption></figure><p id="9206" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打电话。在数据帧上描述()，我看了一下不同的值。看起来Age、SibSp、Parch和Fare有一些特别高的值。</p><p id="4975" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，年龄变量。平均值为29.70，第75百分位为35。然而，最大值是80。其他变量在最大值和其余值之间包含类似的差距。特别是票价，最大值为512英镑，而平均值为32.20英镑。</p><p id="9d1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，是时候用功能引擎的Winsorizer做一点价值封顶了。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ks"><img src="../Images/f78fd9e7b7663e251ae75fa79969cf4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPYlE4ypJHQxErsH_p3iGw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Running Winsorizer</figcaption></figure><p id="2ca4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">做完这个，我打了电话。再次在数据帧上描述()并获得以下结果:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es ln"><img src="../Images/da52531abd2bf6739b65a355a17a54fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*FIQ3bmF8-APPa9rFxA5B6Q.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">df.describe() post Winsorizer</figcaption></figure><p id="2cdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这成功地将极值降低到平均值的最大三倍标准差。例如，Fare以前的最大值是512.33，但现在是181.28。</p><h2 id="deea" class="kt jf hi bd jg ku kv kw jk kx ky kz jo iq la lb js iu lc ld jw iy le lf ka lg bi translated">特征工程</h2><p id="3203" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">最后，谈到特征工程。为此，我利用了特征工具库。</p><p id="bc5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我创建了一个字典，告诉特征工具每一列是什么类型的数据。这是为了允许特征工程功能识别它应该进行什么样的交互。我将它赋给变量“variable_types ”,然后使用这些类型为特征工具设置一个实体。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lo"><img src="../Images/083805e19857fe77a3011841b351cab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*jfYXDAe-nFcpE9Y72w54Pg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Creating a new EntitySet</figcaption></figure><p id="85a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，使用基本实体集，我创建了一些关系，我希望Feature Tool的深度特征合成能够从中探索和创建特征。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lp"><img src="../Images/471e37f74e6cf05ac0b36aa6a56894ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*6nUSDqJ7HOKOgKpz_lw1iQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Relationship Between Variables</figcaption></figure><p id="9d55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，剩下要做的就是运行深度特征合成工具来创建新的特征！</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lq"><img src="../Images/46edc0baaf9e4ce02764aa117ba3468e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POKnvXyloRnYUc0Q7vx9jg.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">New table showing 50 columns</figcaption></figure><p id="8fe4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此之前，经过数据清理和删除列，我最终获得了8个特性。然而，在运行Feature Tool的深度特征合成后，我最终得到了50个特征。这听起来很棒，但是这在模型中表现如何呢？是时候做些懒惰的预测了。</p><h2 id="20d9" class="kt jf hi bd jg ku kv kw jk kx ky kz jo iq la lb js iu lc ld jw iy le lf ka lg bi translated">使用惰性预测测试模型</h2><p id="da63" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">首先，我利用sklearn的train_test_split将我的数据分割成一个训练/测试分割。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lr"><img src="../Images/a14339ecd5ca9879b0f11edb1e581c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*ySFnDX1YdTEJrUOoWwjiVw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Train/Test Split</figcaption></figure><p id="542f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我实例化了LazyClassifer并使用我的数据运行它。另外，LazyClassifier会自动对数据进行缩放等操作。由于该过程可能与您选择的缩放/归一化数据的方式不同，因此最终结果可能会在您的最终模型中有所不同。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es ls"><img src="../Images/9ac3441364b8f6ab13880da575e00856.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*1eY5YY3srdnORRkzaPE6AA.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">LazyClassifer</figcaption></figure><p id="96fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我查看了输出。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lt"><img src="../Images/a2199e43d4b208f8547e17dbd3daab2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*995ouUR5BVm-BjAy0THS_w.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">LazyClassifier Output</figcaption></figure><p id="ea7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看起来我将使用Ada Boost分类器！</p><h2 id="43e7" class="kt jf hi bd jg ku kv kw jk kx ky kz jo iq la lb js iu lc ld jw iy le lf ka lg bi translated">最终注释</h2><p id="8d8f" class="pw-post-body-paragraph if ig hi ih b ii lh ik il im li io ip iq lj is it iu lk iw ix iy ll ja jb jc hb bi translated">利用特征工具、特征引擎和惰性预测，我能够缩小模型的使用范围，并设计出一系列新特征。</p><p id="72be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本着几乎只使用三个库的精神，我忽略了一些项目，但总的来说，我对结果很满意。</p><p id="b528" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这只是对这些库的功能，尤其是特性工具的一个简单介绍。用它们可以做更多的事情，它们都为它们的特性提供了广泛的笔记本教程，我期待着进一步深入研究。对于那些好奇的人来说，这里是以下内容的教程页面:<br/> - <a class="ae jd" href="https://github.com/alteryx/open_source_demos" rel="noopener ugc nofollow" target="_blank">特征工具</a>-<br/>-<a class="ae jd" href="https://nbviewer.jupyter.org/github/solegalli/feature_engine/tree/master/examples/" rel="noopener ugc nofollow" target="_blank">特征引擎</a></p></div></div>    
</body>
</html>
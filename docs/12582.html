<html>
<head>
<title>Working With List on Redis With .Net 6.0</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Redis上的列表。Net 6.0</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/working-with-list-on-redis-with-net-6-0-64f159f96b4e?source=collection_archive---------2-----------------------#2022-05-20">https://medium.com/geekculture/working-with-list-on-redis-with-net-6-0-64f159f96b4e?source=collection_archive---------2-----------------------#2022-05-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9db4ade882b50e76d2fb3f2e2bfd67d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4PNw7_hsus9Wg_EwrKPjw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://www.pinterest.com/pin/the-brickmaking-women-of-india--316026098839115994/" rel="noopener ugc nofollow" target="_blank"><strong class="bd iv">The Brick-Making Women of India(National Geographic)</strong></a></figcaption></figure><p id="2e51" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">今天我们将讨论如何在Redis中使用累积数据。首先，Redis不是一个缓存管理器工具。它是一个内存数据库。Redis的意思是“远程词典服务”。Redis中有五种不同的数据类型。今天我们将谈论“<strong class="iy hj">列表</strong>”。但是最终我们将不得不为新的商业规则改变我们的Redis数据类型。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es ju"><img src="../Images/a2ee8373f98e8f84e9f801d588ac827c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*6adwjVlLnAfQn05D7bu4Ug.jpeg"/></div></figure><p id="26b3" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj">场景</strong>:我们有几个不同的类别。可以添加一个新的，也可以删除其中的任何一个。类别模型如下所示。我们将保存Redis上的所有类别，以提高我们的服务性能。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="e6dd" class="ke kf hi ka b fi kg kh l ki kj">public class Category<br/>{<br/>   public int Id { get; set; }<br/>   public string Name { get; set; }<br/>   public int ParentID { get; set; }<br/>   public DateTime CreateDate { get; set; }<br/>}</span></pre><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/90ff90bb12007afa6df796fc504975ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FreNljiQnRsd3nI2tGz_UA.png"/></div></div></figure><p id="042c" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我们将在中为Redis使用ServiceStack库。Net 6.0</p><p id="b44a" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di">F</span>T6】第一种方法:</p><p id="71bc" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">当我检查初级开发人员的代码时，我看到他将类别列表设置为带有键值对的JSON数据。当他向类别列表中添加一个新条目时，他获取JSON数据，反序列化它，向列表中添加一个新的类别条目，然后再次序列化，并将列表作为JSON设置到Redis。这是不可接受的。对于大数据来说，这是一个性能杀手。</p><blockquote class="ku kv kw"><p id="ead1" class="iw ix kx iy b iz ja jb jc jd je jf jg ky ji jj jk kz jm jn jo la jq jr js jt hb bi translated">*这种方法类似于从库中取出所有书籍，添加新书，然后将所有取出的书籍再次放回库中:)</p></blockquote><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/71985d5f5a9ff1b72889c90f10248922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AhiOexFz2HOBabOvP608tQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">CategoryList Keeps in Redis as JSON</figcaption></figure><ol class=""><li id="bdd3" class="lc ld hi iy b iz ja jd je jh le jl lf jp lg jt lh li lj lk bi translated">我们创建了一些虚拟类别，并添加到“类别列表”</li></ol><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/2c1b2d768f655ccb7b5e403f845d6f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rniZ9_tMWxFqz_NhTv2S9g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Dummy Category Items</figcaption></figure><p id="1b2b" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">2.我们设置了Redis连接服务器，得到了Redis客户端。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/4e88c2f07f00c4c79258131c1f75231b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdcfBcvGRwPcpxSks-rd5g.png"/></div></div></figure><p id="6206" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">3.如上所示，我们将Redis的“CategoryList”设置为JSON。又得到了“CategoryList”。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/1ad841c32701f86f517a17007c7caf95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzmV005FhoRQecaDgD08vw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Set Current CategoryList to the Redis. And Got It back.</figcaption></figure><p id="2c60" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">4.我们删除了类别Id=2，添加了新的类别Id=4，最后将“CategoryList”再次设置为JSON。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/cd0ab10eec9881c6338735290634b1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xEGt3QjdtbwXVwyNFBJcfw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Remove “Category2” Add “CategoryBora”</figcaption></figure><p id="613f" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">5.最后，我们从Redis获得了所有的“CategoryList ”,并在一个循环中打印出来，如下所示。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/2f43731c7c5541612de13c6377868fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q00M-WbczLhvRUzmTwWg4w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Print All CategoryList to the Screen</figcaption></figure><p id="a7ab" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj"> Program.cs: </strong></p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="c317" class="ke kf hi ka b fi kg kh l ki kj">List&lt;Category&gt; categoryList = new();</span><span id="40b6" class="ke kf hi ka b fi lq kh l ki kj">categoryList.AddRange(new List&lt;Category&gt;() {<br/>new Category() { Id=1,Name="Category1",CreateDate=DateTime.Now},<br/>new Category() { Id=2,Name="Category2",CreateDate=DateTime.Now},<br/>new Category() { Id=3,Name="Category3",CreateDate=DateTime.Now}});</span><span id="3777" class="ke kf hi ka b fi lq kh l ki kj">RedisEndpoint conf = new RedisEndpoint { Host = "127.0.0.1", Port = 6379, Password = "test" };</span><span id="f1a6" class="ke kf hi ka b fi lq kh l ki kj">RedisClient redisClient = new RedisClient(conf);</span><span id="dabb" class="ke kf hi ka b fi lq kh l ki kj">redisClient.Set("CategoryList", categoryList);</span><span id="d9d7" class="ke kf hi ka b fi lq kh l ki kj">var list = redisClient.Get&lt;List&lt;Category&gt;&gt;("CategoryList");</span><span id="f83d" class="ke kf hi ka b fi lq kh l ki kj">list.Remove(list.First(item =&gt; item.Id == 2));</span><span id="5b4c" class="ke kf hi ka b fi lq kh l ki kj">list.Add(new Category() { Name = "CategoryBora", Id = 4, CreateDate = DateTime.Now });</span><span id="3683" class="ke kf hi ka b fi lq kh l ki kj">redisClient.Set("CategoryList", list);</span><span id="139c" class="ke kf hi ka b fi lq kh l ki kj">var finalList = redisClient.Get&lt;List&lt;Category&gt;&gt;("CategoryList");foreach (var item in finalList)<br/>{<br/>   Console.WriteLine(JsonSerializer.Serialize(item));<br/>}</span></pre><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/ebe652336b4ed16af5a7d4ba5e4fa387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufXdAALfysxRiaWlbBTq_g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Result Screen</figcaption></figure><p id="4631" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di">S</span>T12】第二种方法:</p><p id="7f22" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">现在是时候给Redis中的“列表数据类型”一个机会了。当我们在列表中添加、更新或删除一个条目时，我们不必处理Redis中的所有数据。只处理一个项目，可能会提高性能。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/d5af0313ca49753ae91d1e2715bb2c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQ-gcY6mMgNgQNyWbQhItA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">CategoryList Keeps in Redis as List</figcaption></figure><ol class=""><li id="4174" class="lc ld hi iy b iz ja jd je jh le jl lf jp lg jt lh li lj lk bi translated">我们在Redis上创建了“分类列表”。列表的类型是“类别”。它就像“<em class="kx">列表&lt;类别&gt; </em>”。</li></ol><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/a14018826ad646ff1d95768dc93e6e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxgo4d3oCTCDKdvuK0Zntg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Redis Lists[“CategoryList”]</figcaption></figure><p id="048b" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">2.我们将所有类别批量插入Redis上的“CategoryList”。最后添加了一个新的“类别4”而没有触及当前列表:)</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/103af72bd8cc3ea4112d18511bd03e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ev399GybEvkybuHoipOZ4Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Bulk Insert CategoryList and Add Category4</figcaption></figure><p id="3245" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">3.从Redis列表中删除一个项目是非常痛苦的:)你必须找到将被删除的项目的索引。我用“Id==3”的“单个”过滤关键字得到了(值，索引)</p><p id="531d" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">我取出removedCategory，将名称更改为“CategoryBora ”,并使用相同的索引号将其放回“CategoryList”。</p><p id="06d9" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj"> <em class="kx">不是:(</em> removedCategory。Index-1 <em class="kx"> ) </em> </strong> <em class="kx">因为删除了一项所以“当前索引号”= &gt; 1被删除。</em></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/7e1f57accc4d3cfaa2a37a5ea3c3da22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0i3W_4nBWTMz8WkfUOWVA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Remove Category 3, Change Name and Put It Back</figcaption></figure><p id="82a1" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">4.我们从Redis得到了“目录列表”。我们在一个循环中打印了所有的项目，如下所示。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/c037b95bce573c25369ff7835e2c2e9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_fiRoUahnGBNt-Llq2ZGpg.png"/></div></div></figure><p id="b258" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj"> Program.cs: </strong></p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="2bdf" class="ke kf hi ka b fi kg kh l ki kj">List&lt;Category&gt; categoryList = new();</span><span id="7549" class="ke kf hi ka b fi lq kh l ki kj">categoryList.AddRange(new List&lt;Category&gt;() {<br/>new Category() { Id=1,Name="Category1",CreateDate=DateTime.Now},<br/>new Category() { Id=2,Name="Category2",CreateDate=DateTime.Now},<br/>new Category() { Id=3,Name="Category3",CreateDate=DateTime.Now}});</span><span id="8bc7" class="ke kf hi ka b fi lq kh l ki kj">RedisEndpoint conf = new RedisEndpoint { Host = "127.0.0.1", Port = 6379, Password = "test" };</span><span id="ad0a" class="ke kf hi ka b fi lq kh l ki kj">RedisClient redisClient = new RedisClient(conf);</span><span id="bc43" class="ke kf hi ka b fi lq kh l ki kj">//Create CategoryList on Redis and add all items to the list..<br/>IRedisTypedClient&lt;Category&gt; categoryClient = redisClient.As&lt;Category&gt;();</span><span id="9a81" class="ke kf hi ka b fi lq kh l ki kj">var categoryRedisList = categoryClient.Lists["CategoryList"];</span><span id="626e" class="ke kf hi ka b fi lq kh l ki kj">categoryRedisList.AddRange(categoryList);</span><span id="316f" class="ke kf hi ka b fi lq kh l ki kj">//Add new Category4 to the CategoryList<br/>categoryRedisList.Add(new Category() { Id = 4, Name = "Category4", CreateDate = DateTime.Now });</span><span id="b8e6" class="ke kf hi ka b fi lq kh l ki kj">//Remove "Category Id=3" from the List with it's Index.<br/>var removeCategory = categoryRedisList.Select((Value, Index) =&gt; new { Value, Index }).Single(p =&gt; p.Value.Id == 3);</span><span id="a622" class="ke kf hi ka b fi lq kh l ki kj">categoryRedisList.RemoveAt(removeCategory.Index);</span><span id="4213" class="ke kf hi ka b fi lq kh l ki kj">//Change the Name of Removed Category and put it back<br/>removeCategory.Value.Name = "CategoryBora";<br/>categoryRedisList.Insert(removeCategory.Index - 1, removeCategory.Value);</span><span id="ea96" class="ke kf hi ka b fi lq kh l ki kj">//Get the CategoryList from the redis and print all items in a loop<br/>var getCategoryList = categoryRedisList.GetAll();<br/>getCategoryList.ForEach(item =&gt;{<br/>    Console.WriteLine(JsonSerializer.Serialize(item));<br/>});</span></pre><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/aa198893a72c852123a2fdd863cb4526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EB_QiUPzgnnK7iz_TE2FA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Result Screen</figcaption></figure><p id="1700" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di"> T </span> <strong class="iy hj">第三种方法:</strong></p><p id="5fa1" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">后来，我们从客户那里得到了一个新案例。"<em class="kx">每个类别都必须有一个到期时间。</em>“所以目前的Redis Lists数据类型解决方案到最后已经没用了。因为在列表中，我们无法为每个类别设置到期时间。只有我们可以为Redis列表中的类别组设置过期时间。所以批量过期时间对于客户来说是不可接受的。最后，上次我们在Redis中更改了数据类型。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/1a79fbf82d9e6b2c20176973b350d19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3fmpMGyKmeS85EmJMD6zhw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Every Category keeps in Category Group</figcaption></figure><p id="c941" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">1-)我们决定在Redis垂直增长。我们在“Category:”关键字下逐个添加了所有类别及其id。“<strong class="iy hj"> <em class="kx">类别</em> </strong>”是组的名称，“<strong class="iy hj"> <em class="kx"> id </em> </strong>”是每个类别的唯一标识。</p><blockquote class="ku kv kw"><p id="f90d" class="iw ix kx iy b iz ja jb jc jd je jf jg ky ji jj jk kz jm jn jo la jq jr js jt hb bi translated"><strong class="iy hj">"类别:{item。Id} </strong></p></blockquote><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/d84626bc0eaf72715363e4b63aa29588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7ZEDFfmjpecvCCnF1C2qQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Set All Categories Under The Category: Keyword.</figcaption></figure><p id="b13f" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">2-)我们在“Category:”关键字下添加一个新的“Category4”，其Id为“4”。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/d85700a772736d4ddfe94233fc51de19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3AEBZKeatO-V9YEd-MXp7Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Add “Category4” under The “Category:”</figcaption></figure><p id="e9d0" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">3-)我们很容易通过关键字找到“类别3”。对于列表数据类型，我们不需要任何索引来删除它。我们用“Bora”更改了“Category3”的名称，并通过使用它的“Category:3”关键字将其放回。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/858470a3fd2d38487cc39e13d555a3be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KoG-qCzY6O2TZreNfCUEEg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">We Found “Category3” And Update It</figcaption></figure><p id="41c9" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">4-)我们选择所有带有“<strong class="iy hj">类别* </strong>”关键字的类别。我们称之为Lua脚本。我们过滤了所有Redis条目，即从“<strong class="iy hj"><em class="kx"/></strong>”关键字开始。我们检查了是否有以“Category”关键字开始的项目。如果结果是肯定的，我们得到了它们，并按它们的“Id”排序。最后，我们把它们都打印到屏幕上。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/48638591b00570a774279e3b9c5597ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j56zemphy_mtj8QNwxisPA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">All Categories Printed One By One</figcaption></figure><p id="ee9b" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj"> Program.cs: </strong></p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="273c" class="ke kf hi ka b fi kg kh l ki kj">List&lt;Category&gt; categoryList = new();</span><span id="3c87" class="ke kf hi ka b fi lq kh l ki kj">categoryList.AddRange(new List&lt;Category&gt;() {<br/>new Category() { Id=1,Name="Category1",CreateDate=DateTime.Now},<br/>new Category() { Id=2,Name="Category2",CreateDate=DateTime.Now},<br/>new Category() { Id=3,Name="Category3",CreateDate=DateTime.Now}});</span><span id="60e0" class="ke kf hi ka b fi lq kh l ki kj">RedisEndpoint conf = new RedisEndpoint { Host = "127.0.0.1", Port = 6379, Password = "test" };</span><span id="0cd2" class="ke kf hi ka b fi lq kh l ki kj">RedisClient redisClient = new RedisClient(conf);</span><span id="4088" class="ke kf hi ka b fi lq kh l ki kj">//We added all categories under the "Category:" with theirs Ids.<br/>categoryList.ForEach(item =&gt;<br/>{<br/>   redisClient.Add($"Category:{item.Id}", item);<br/>});</span><span id="edfb" class="ke kf hi ka b fi lq kh l ki kj">//We add new "Category4" to under the "Category:" keyword.<br/>redisClient.Add("Category:4", new Category() { Id = 4, Name = "Category4", CreateDate = DateTime.Now });</span><span id="8335" class="ke kf hi ka b fi lq kh l ki kj">//We Found “Category3” And Update It.<br/>var category3 = redisClient.Get&lt;Category&gt;("Category:3");<br/>category3.Name = "Bora";<br/>redisClient.Set("Category:3", category3);</span><span id="a772" class="ke kf hi ka b fi lq kh l ki kj">//All Categories found with "Category*" keyword and printed one by one to the screen.<br/>var keys = redisClient.SearchKeys($"Category*");<br/>if (keys.Any())<br/>{<br/>   List&lt;Category&gt; getAllCategoryList = redisClient.GetAll&lt;Category&gt;(keys).Values.OrderBy(item =&gt; item.Id).ToList();</span><span id="e177" class="ke kf hi ka b fi lq kh l ki kj">   getAllCategoryList.ForEach(item =&gt;<br/>   {<br/>      Console.WriteLine(JsonSerializer.Serialize(item));<br/>   });<br/>}</span></pre><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/a6d2295e23aa8f41d26d6f8a0651a7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKpF1s2U_DPLsVbn-Y4NBg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Result Screen</figcaption></figure><p id="f9d4" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj">结论:</strong></p><p id="f1ca" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">Redis不是唯一的键/值内存管理工具。它是一个内存数据库。在Redis中，你可以用几种方式保存你的数据。垂直增长对Redis来说不是性能问题。但是在Redis中以Json的形式保存大数据在高流量时可能会有问题。序列化和反序列化是高成本操作。我在这篇文章中试图解释的是，“如果你把你的数据分开，放在一个有唯一标识的组中，你可以解决你的性能问题”</p><p id="cb04" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated">下一篇文章再见。再见。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="me mf l"/></div></figure><p id="4244" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><em class="kx">“如果你读到现在，首先感谢你的耐心和支持。欢迎大家来我的博客</em><a class="ae iu" href="http://www.borakasmer.com/" rel="noopener ugc nofollow" target="_blank"><em class="kx"/><strong class="iy hj"><em class="kx"/></strong></a><strong class="iy hj"><em class="kx"/></strong><em class="kx">了解更多！”</em></p><p id="ee5a" class="pw-post-body-paragraph iw ix hi iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt hb bi translated"><strong class="iy hj">来源:</strong></p><ul class=""><li id="84e7" class="lc ld hi iy b iz ja jd je jh le jl lf jp lg jt mg li lj lk bi translated"><a class="ae iu" href="https://redis.com" rel="noopener ugc nofollow" target="_blank"><strong class="iy hj">https://redis.com</strong></a></li><li id="36e8" class="lc ld hi iy b iz mh jd mi jh mj jl mk jp ml jt mg li lj lk bi translated"><a class="ae iu" href="https://redis.io/docs/manual/programmability/eval-intro/" rel="noopener ugc nofollow" target="_blank"><strong class="iy hj">https://redis.io/docs/manual/programability/eval-intro/</strong></a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Using GraphQL with AgilityCMS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GraphQL和AgilityCMS</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-graphql-with-agilitycms-75db6c03068b?source=collection_archive---------33-----------------------#2021-07-22">https://medium.com/geekculture/using-graphql-with-agilitycms-75db6c03068b?source=collection_archive---------33-----------------------#2021-07-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="118a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据JavaScript 2019 的<a class="ae jd" href="https://2019.stateofjs.com/data-layer/graphql/" rel="noopener ugc nofollow" target="_blank">状态，38.7%的开发者愿意使用GraphQL，而50.8%的开发者愿意学习GraphQL。</a></p><p id="933c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一种查询语言，GraphQL简化了构建客户端应用程序的工作流程。它消除了在客户端应用程序中管理API端点的复杂性，因为它公开了一个HTTP端点来获取所需的数据。因此，它<a class="ae jd" href="https://hub.packtpub.com/7-reasons-to-choose-graphql-apis-over-rest-for-building-your-apis/" rel="noopener ugc nofollow" target="_blank">消除了数据的过量提取和不足提取</a>，就像REST的情况一样。</p><p id="4ef9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong> : <em class="je">本教程将有益于那些过去在客户端使用RESTful或其他形式的API，并想看看GraphQL是否值得一试的人。这意味着你以前应该使用过API只有这样，你才能理解GraphQL对你有多大的好处。虽然我们将涉及GraphQL的一些基础知识，但是对headless CMSworks的良好了解将会派上用场。</em></p><h1 id="42de" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">GraphQL基础知识</h1><p id="a594" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">本文不是GraphQL的<a class="ae jd" href="https://www.howtographql.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">完整介绍</strong> </a>，但是在继续之前我们将定义一些约定。</p><p id="55c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是GRAPHQL？</strong></p><p id="57db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL是一个<a class="ae jd" href="http://spec.graphql.org/June2018/" rel="noopener ugc nofollow" target="_blank">规范</a>，它描述了一种声明式查询语言，客户可以使用这种语言向API请求他们想要的确切数据。这是通过为API创建强类型模式来实现的，具有极大的灵活性。它还确保API解析数据，并根据模式验证客户端查询。这个定义意味着GraphQL包含一些规范，使其成为一种声明式查询语言，具有静态类型化(围绕Typescript构建)的API，并使客户端能够利用这些类型系统向API请求它想要的确切数据。</p><p id="7b25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，如果我们创建了一些类型，其中包含一些字段，那么，从客户端来看，我们可以说，“给我们这些包含确切字段的数据”。然后API会以那个确切的形状来响应，就像我们在强类型语言中使用类型系统一样。你可以在<a class="ae jd" href="https://www.smashingmagazine.com/2020/05/typescript-modern-react-projects-webpack-babel/#comments-typescript-modern-react-projects-webpack-babel" rel="noopener ugc nofollow" target="_blank">我的打字稿文章</a>中了解更多。</p><p id="0b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GraphQL是针对API的查询语言，而不是针对数据库的。它是数据库不可知的。它可以用于任何数据库。GraphQL允许客户端在一次请求中查询来自API中多个来源的数据，并允许客户端定义自己需要的数据部分。同时为您提供这种灵活性。</p><p id="088d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看GraphQl的一些约定，它们将在我们继续的过程中对我们有所帮助。</p><p id="e66b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基础知识</strong></p><ul class=""><li id="afe3" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated"><strong class="ih hj">操作<br/> </strong>在GraphQL中，执行的每一个动作都称为一个操作。有几个操作，即:</li><li id="15c9" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">查询<br/> </strong>该操作与从服务器获取数据有关。你也可以称之为只读获取。</li><li id="eaa3" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">突变<br/> </strong>这个操作涉及到从服务器创建、更新和删除数据。它通常被称为CUD(创建、更新和删除)操作。</li><li id="65cb" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">订阅<br/></strong>graph QL中的这个操作涉及到当特定事件发生时从服务器向其客户端发送数据。它们通常用<a class="ae jd" href="https://itnext.io/how-we-manage-live-1m-graphql-websocket-subscriptions-11e1880758b0" rel="noopener ugc nofollow" target="_blank"> WebSockets </a>来实现。</li><li id="2447" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">操作</strong> <strong class="ih hj">人名<br/> </strong>有<strong class="ih hj">独有的</strong> <strong class="ih hj">人名</strong>供您进行客户端查询和变异操作。</li><li id="cf04" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">变量</strong> <strong class="ih hj">和自变量<br/> </strong>操作可以定义自变量，非常像大多数编程语言中的函数。然后，这些变量可以作为参数传递给操作内部的查询或变异调用。变量应该在运行时从客户端执行操作的过程中给出。</li><li id="6053" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><strong class="ih hj">别名<br/> </strong>这是客户端GraphQL中的一个约定，涉及到用简单易读的UI字段名来重命名冗长或模糊的字段名。在不希望字段名冲突的用例中，别名是必要的。</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es kw"><img src="../Images/41906432c7773f5750d07c545e275e3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*quFNXDKoA99mKSUC.png"/></div></figure><h1 id="1e75" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">如何使用GraphQL和Agility CMS</h1><p id="7483" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">为了开始使用GraphQL从Agility查询您的内容，您需要验证您的请求并设置您的GraphQL API客户端。</p><p id="9358" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，转到<a class="ae jd" href="https://manager.agilitycms.com/settings/apikeys" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">设置&gt; API键</strong> </a>并点击<strong class="ih hj">探索GraphQL API </strong>按钮，进入您的实例中的GraphQL IDE游乐场。</p><p id="67c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将注意到您想要更新的GraphQL API URL端点，以包括以下内容:</p><ol class=""><li id="adef" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc le ko kp kq bi translated">您的实例GUID。</li><li id="8db9" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc le ko kp kq bi translated">指示您是要获取已发布内容(获取)还是暂存内容(预览)。</li><li id="c9f4" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc le ko kp kq bi translated">要从中检索内容的区域设置。</li></ol><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/2c1b862dc761978ff15271334bb84ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bDu7K2LpVy_GPmdW.png"/></div></div></figure><p id="cb6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您还需要通过添加API密钥作为头来验证您的请求。为此，单击位于GraphQL API Playground左侧的<strong class="ih hj"> Set Headers </strong>按钮。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/15360528606ad4ed2fbbfbff38815de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ke4lwMISPl4Bv6V2.png"/></div></div></figure><p id="e496" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用哪个API键？</p><ul class=""><li id="47ba" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated"><em class="je">如果您正在获取已发布的内容，并且已经使用GraphQL API URL端点中的fetch对其进行了定义，请确保使用您的</em><strong class="ih hj"><em class="je">Fetch</em></strong><em class="je">API键。</em></li><li id="1c61" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><em class="je">如果您正在获取暂存内容，并且已经使用GraphQL API URL端点中的preview对其进行了定义，请确保使用您的</em><strong class="ih hj"><em class="je">Preview</em></strong><em class="je">API键。</em></li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es lk"><img src="../Images/a43373453663de15fd60e265ee14462d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/0*SAcgkH6ZAhE30WHn.png"/></div></figure><p id="7d27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<strong class="ih hj">保存</strong>将您的API密钥保存为请求中的标题。</p><p id="9591" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你更新了你的GraphQL API URL并添加了你的API密匙作为标题，你可以点击<strong class="ih hj"> Reload </strong>按钮来重新加载文档。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es ll"><img src="../Images/a3a872ea02de364734ed10586e06054b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qdkI8HW5xb_DQ__r.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx">4</figcaption></figure><p id="ce58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你重新加载了文档，你可以点击<strong class="ih hj">文档</strong>按钮，你应该会看到<strong class="ih hj">根</strong>。如果您单击Root，那么您将能够从您的实例中看到可查询的内容。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lq"><img src="../Images/443cf25d298a7933c2d38fe6012a8862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ktZ7rW1Jti0VVQw8.png"/></div></div></figure><h1 id="53ce" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">结论</h1><p id="d294" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq kf is it iu kg iw ix iy kh ja jb jc hb bi translated">到目前为止，我们已经了解了GraphQL模式定义语言、基本类型、变异和查询类型，以及如何用AgilityCMS实例对其进行认证。现在，您将能够创建一个包含突变和查询的基本模式。</p><h1 id="b7ea" class="jf jg hi bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">资源</h1><ul class=""><li id="e3ae" class="ki kj hi ih b ii kd im ke iq lr iu ls iy lt jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/guide/how-to-design-a-content-first-strategy-using-agility-cms" rel="noopener ugc nofollow" target="_blank">如何使用Agility CMS设计内容优先策略</a>——Agility CMS</li><li id="10b9" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://www.smashingmagazine.com/2018/11/structured-content-done-right/" rel="noopener ugc nofollow" target="_blank">结构化内容管理系统的无头项目策略</a>—Knut melvr</li><li id="d030" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/why-you-as-a-developer-should-be-using-a-cms" rel="noopener ugc nofollow" target="_blank">作为开发人员，你为什么应该使用CMS </a></li><li id="772c" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/headless-commerce-explained-definitions-use-cases-and-roadblocks" rel="noopener ugc nofollow" target="_blank">无头商务解释:定义、用例以及障碍|敏捷CMS </a></li><li id="1cfe" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/apis-vs-sdks-what-s-the-difference" rel="noopener ugc nofollow" target="_blank">API vs . SDK:有什么区别？|敏捷CMS </a></li><li id="ffc9" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/static-site-generators" rel="noopener ugc nofollow" target="_blank">2021年顶级静止站点发电机值得关注</a></li><li id="bd62" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/what-s-the-difference-between-headless-cms-and-static-site-generator/" rel="noopener ugc nofollow" target="_blank">https://agility CMS . com/resources/posts/what-s-the-difference-between-headless-CMS-and-static-site-generator/</a></li><li id="0c43" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/what-is-netlify-and-why-should-you-care-as-an-editor" rel="noopener ugc nofollow" target="_blank">什么是网络生活，作为一名编辑，你为什么要关心它？|敏捷CMS </a></li><li id="c4f0" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/guide/what-is-a-headless-cms" rel="noopener ugc nofollow" target="_blank">什么是无头CMS？|敏捷CMS </a></li><li id="b3d3" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/guide/top-10-reasons-why-you-should-choose-a-headless-cms-over-a-traditional-cms" rel="noopener ugc nofollow" target="_blank">无头CMS相对于传统CMS的优势|敏捷CMS </a></li><li id="8a4f" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/content-architecture" rel="noopener ugc nofollow" target="_blank">内容架构:组织和管理你的内容和团队的关键</a></li><li id="dd92" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">WordPress及其替代品:Headless CMS | Agility CMS </li><li id="8061" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/whitepaper/proprietary-vs-open-source-content-management-systems" rel="noopener ugc nofollow" target="_blank">开源CMS与专有CMS:你能拥有二者之长吗？|敏捷CMS </a></li><li id="17f4" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">选择React CMS:寻找什么？|敏捷CMS </li><li id="a203" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/content-modelling" rel="noopener ugc nofollow" target="_blank">掌控你的内容架构:内容建模</a></li><li id="ec36" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated"><a class="ae jd" href="https://agilitycms.com/resources/posts/the-benefits-of-a-hybrid-dxp" rel="noopener ugc nofollow" target="_blank"> DXP vs无头CMS:现代DXP建筑</a></li><li id="1eba" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">Jamstack开发:<a class="ae jd" href="https://agilitycms.com/resources/posts/top-jamstack-pioneers" rel="noopener ugc nofollow" target="_blank">2021年你需要了解的10个JAMstack先驱</a></li></ul></div></div>    
</body>
</html>
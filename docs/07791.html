<html>
<head>
<title>Hack This Site: Realistic Web Mission — Level 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑掉这个网站:现实的网络任务——第4级</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-4-5837af1f104?source=collection_archive---------4-----------------------#2021-10-01">https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-4-5837af1f104?source=collection_archive---------4-----------------------#2021-10-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/683af19e7e3303edba1a8786e6031aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FV6pEy-_ImiWq6X5QRhFhw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Hack This Site: Realistic Web Mission — Level 4</figcaption></figure><p id="7a29" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">大家好，欢迎来到HaXeZ，今天我们来看看<a class="ae js" href="https://hackthissite.org/" rel="noopener ugc nofollow" target="_blank">黑掉这个网站</a>现实网络任务第4级。我喜欢这个挑战，尽管我对完成任务的语法感到困惑。该任务要求您执行UNION ALL SQL注入，以便从数据库中获取电子邮件地址。一旦你有了电子邮件地址，你需要把它们发送给客户。如果你没有看过我的其他帖子是现实系列，你可以在这里看到:<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-missions-level-1/" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-2/" rel="noopener ugc nofollow" target="_blank">第二部分</a>和<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-3/" rel="noopener ugc nofollow" target="_blank">第三部分</a>。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/d37305a1feec83bdb0b4c332becfec43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*PT6g0ABkgbAKpmSZ"/></div><figcaption class="iq ir et er es is it bd b be z dx">Fischer’s Animal Products</figcaption></figure><p id="9c87" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你选择接受这个任务，那就是入侵FAP网站，窃取邮件列表上每个人的电子邮件地址。为什么？，因为FAP杀动物是为了把它们的毛皮卖给有钱的顾客。SaveTheWhales好心地问我们是否可以得到邮件列表并发给他，以便他可以“联系他们”。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/db162e00ea90846dff25a8385bbbc8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*HxEXbK-IOBqxs-sv"/></div><figcaption class="iq ir et er es is it bd b be z dx">Message From SaveTheWhales</figcaption></figure><h1 id="f285" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">探索网站</h1><p id="fd7b" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">访问该网站时，你会看到一个相当简单的页面，解释这个web应用程序是什么。有一个提交框，可以将您的电子邮件地址添加到邮件列表中。还有两个链接，一个是皮衣，一个是鳄鱼配饰(可怜的鳄鱼)。我们可以尝试攻击邮件列表提交系统，但是现在，让我们继续探索应用程序。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/387195602503742c9d0f52044904f19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*7rGC9p6yuNrrwcK2"/></div><figcaption class="iq ir et er es is it bd b be z dx">Main Web Application Page</figcaption></figure><p id="05cf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">点击毛皮大衣和鳄鱼皮配饰链接，您将进入相应的产品页面。这些页面看起来是动态的，好像是由SQL查询生成的。如果我们看一下页面的结构，它可以分为三个数据库列:图片、描述和价格。我们还可以假设有一个电子邮件地址表。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/b71504430cdc2047dac024597bd71055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*y4wIuBQIHwMfFiQ9"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application Product Page</figcaption></figure><h1 id="3525" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">网站黑客</h1><p id="5921" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">尽管应用程序在追加单引号时没有出现错误。我们仍然可以尝试建立一个联合SQL注入。特定SQL注入检索数据的语法让我有点困惑。例如，<a class="ae js" href="https://www.w3schools.com/sql/sql_ref_union.asp" rel="noopener ugc nofollow" target="_blank"> W3Schools </a>和<a class="ae js" href="https://portswigger.net/web-security/sql-injection/union-attacks" rel="noopener ugc nofollow" target="_blank"> Portswigger </a>都有关于UNION SELECT和UNION SQL注入的优秀文章。W3Schools解释说UNION SELECT和UNION ALL SELECT的区别在于UNION ALL SELECT将包含重复值，而UNION SELECT则不会。我们从数据库中提取的信息没有重复值，但是UNION SELECT注入不起作用。此外，Portswigger有许多例子，它们都以单引号开始，以脱离现有的SQL查询。在这里向UNION ALL SELECT命令添加单引号不起作用。我可能误解了正在发生的事情，但请随时给我留下评论。</p><p id="a757" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">无论如何，回到黑客。所以我们知道可能有三个表列。一个用于产品图片，一个用于产品描述，一个用于产品价格。我们还知道可能有一个叫做电子邮件的表格。有了这些信息，我们就可以构造UNION ALL SELECT命令了。</p><p id="3429" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们告诉数据我们正在执行什么类型的查询。</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="adfa" class="lg jz hi lc b fi lh li l lj lk">UNION ALL SELECT</span></pre><p id="b52a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">其次，我们告诉数据库我们想要什么列，以及我们想要将数据注入到什么列中。这适用于第二列和第三列。然而，如果你把它放入第二列，你的字体将会是正常的，但是如果你把它放入第三列，你的字体将会是粗体的。这与网站的格式相匹配。</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="958b" class="lg jz hi lc b fi lh li l lj lk">NULL, *, NULL, NULL</span></pre><p id="bef6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，我们告诉它我们想从哪里查询数据。例如，我们想从电子邮件表中提取数据。我们还需要用分号结束查询。</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="f411" class="lg jz hi lc b fi lh li l lj lk">FROM EMAIL;</span></pre><p id="3e31" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">把所有这些放在一起，你应该有一个看起来如下的SQL注入。</p><pre class="ju jv jw jx fd lb lc ld le aw lf bi"><span id="fb40" class="lg jz hi lc b fi lh li l lj lk">UNION ALL SELECT NULL, *, NULL, NULL FROM email;</span></pre><p id="afb6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们需要将SQL注入追加到URL末尾的1之后。根据您的注入点和字符的大小写，查询应该类似于下图。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/06be84443073d03f87bb418612692c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*aytyGBw4HpHyHIob"/></div><figcaption class="iq ir et er es is it bd b be z dx">UNION ALL SELECT SQL Injection</figcaption></figure><p id="09ec" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">完成后，按键盘上的return键，您应该看到web应用程序加载了一些附加信息。邮件列表中的电子邮件地址已包含在产品查询中。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/9be0baa6862d518577526815e231bd08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*x2Q5AoFh6n6t6P9v"/></div><figcaption class="iq ir et er es is it bd b be z dx">UNION ALL SELECT SQL Injection Returned Results</figcaption></figure><p id="63b8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">从页面上复制电子邮件地址，然后返回到主HackThisSite网站。点击你的名字在左边，然后当你的个人资料加载，再次点击它。你将看到一个发送信息框。将收件人改为SaveTheWhales，并将你从FAP网站窃取的电子邮件地址列表发送给他们。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/f49805f3e7f46f7b756fa1dfcaf0c5f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/0*ZhfbNow0qVFRld7t"/></div><figcaption class="iq ir et er es is it bd b be z dx">Replying to SaveTheWhales</figcaption></figure><p id="9c54" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就这样，你现在应该已经完成了这个任务。这是一个有趣的任务，使用了一种基于联盟的SQL注入形式的实用开发技术。虽然我认为语法有点奇怪，我会等着有人来纠正我，然后再改变主意，但这是一个很好的例子。从中我们可以了解到，对后端数据库的查询应该使用准备好的语句。使用准备好的语句！！！</p><p id="b7f1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">不管怎样，今天就到这里，希望你喜欢。请观看视频，我们下次再见。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure></div></div>    
</body>
</html>
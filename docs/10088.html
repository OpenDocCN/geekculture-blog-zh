<html>
<head>
<title>Predicting Netflix stock prices using Machine Learning, using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习和Python来预测网飞股票价格</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/predicting-netflix-stock-prices-using-machine-learning-using-python-d7ca73ae7d4e?source=collection_archive---------2-----------------------#2022-01-13">https://medium.com/geekculture/predicting-netflix-stock-prices-using-machine-learning-using-python-d7ca73ae7d4e?source=collection_archive---------2-----------------------#2022-01-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/cfac81deb1e45c14900612fcb636b2f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3s9o9OS4nvqapikmBiiJow.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Photo by <a class="ae hv" href="https://unsplash.com/@ventiviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Cameron Venti</a> on <a class="ae hv" href="https://unsplash.com/s/photos/netflix?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="9f48" class="pw-subtitle-paragraph iv hx hy bd b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm dx translated">使用SARIMA过程和线性回归预测网飞股票价格的实际应用</h2></div><p id="be26" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我将在这篇文章的开头陈述一个显而易见的事实:<strong class="jp hz">网飞是世界上主要的流媒体公司之一。</strong></p><p id="342f" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在意大利，有一句谚语说:“罗马人无所不能”。<br/>它的基本意思是<strong class="jp hz">“任何伟大的事情都需要时间去建造”</strong>。</p><p id="c5c9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hz">在这本笔记本中，我们将尝试使用一些非常著名的机器学习技术来预测网飞的股票价格</strong>。</p><p id="8ce2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">重要的是，我们要非常精确地预测什么。</p><p id="cd13" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">换句话说，我们将把我们的目标分成三部分:</p><ol class=""><li id="1731" class="kj kk hy jp b jq jr jt ju jw kl ka km ke kn ki ko kp kq kr bi translated"><strong class="jp hz">长期</strong>长期预测</li><li id="8817" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated"><strong class="jp hz">中期</strong>中期预测</li><li id="5748" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated"><strong class="jp hz">短期</strong>短期预测</li></ol><p id="3036" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我想让这个介绍尽可能简短，所以我会在介绍的时候解释我的意思。</p><h2 id="cf5b" class="kx ky hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">0.数据集+库</h2><p id="2c3e" class="pw-post-body-paragraph jn jo hy jp b jq ls iz js jt lt jc jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">数据集是开源的，可以从<a class="ae hv" href="https://www.kaggle.com/akpmpr/updated-netflix-stock-price-all-time" rel="noopener ugc nofollow" target="_blank">这里</a>下载。一点都不重，下载起来超级快。<br/>这些是我用过的库:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="834d" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是导入数据和绘制数据的方式:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><blockquote class="md me mf"><p id="97b6" class="jn jo mg jp b jq jr iz js jt ju jc jv mh jx jy jz mi kb kc kd mj kf kg kh ki hb bi translated">P.S .我对使用<strong class="jp hz">高</strong>股价没有什么特别的兴趣，我用的就是。你可以使用低的或者开放的，实际上我甚至不认为这对我们的情况有很大的影响。我相信，一般的方法，甚至可能是结论，将是真正相似的。无论如何，您可以轻松地用数据集的另一列运行这段代码，不会有任何问题！</p></blockquote><h2 id="9faf" class="kx ky hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">1.长期预测</h2><p id="bb19" class="pw-post-body-paragraph jn jo hy jp b jq ls iz js jt lt jc jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">我所说的<strong class="jp hz">长期预测</strong>指的是基于我们所有数据的所有时间预测。如果你考虑从开始到今天的所有数据集，你当然是在寻找你的函数的一般行为。这意味着你知道你无法捕捉到月份或天数的涨跌，但你希望能够捕捉到股价的<strong class="jp hz">趋势。</strong></p><p id="3bbf" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们要用的工具叫做<strong class="jp hz">多项式回归</strong>，它是<strong class="jp hz">线性回归的自然延伸。</strong>有很多可以读的，从更经典的<strong class="jp hz">书籍</strong>开始，比如<a class="ae hv" href="https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/#:~:text=This%20leading%20textbook%20provides%20a,well%20as%20researchers%20and%20practitioners." rel="noopener ugc nofollow" target="_blank">这本</a>或者更直接的方法，比如<strong class="jp hz"> Sklearn </strong>文档(这里<a class="ae hv" href="https://scikit-learn.org/stable/modules/linear_model.html" rel="noopener ugc nofollow" target="_blank">这里</a>，这里<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="7452" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">简而言之，我们将时间轴转换成一个N维矩阵，并对该矩阵应用线性回归模型。我将它应用于整个数据集，分为三部分:</p><ul class=""><li id="cf09" class="kj kk hy jp b jq jr jt ju jw kl ka km ke kn ki mk kp kq kr bi translated"><strong class="jp hz">训练集</strong>的90%</li><li id="37bb" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki mk kp kq kr bi translated"><strong class="jp hz">验证集</strong>的5%</li><li id="0bf2" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki mk kp kq kr bi translated"><strong class="jp hz">测试装置</strong>的5%</li></ul><p id="d6e5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我使用训练集来测试不同类型的模型，使用不同类型的多项式次数。然后我使用验证集来挑选具有最低<strong class="jp hz">均方误差</strong>的一个，并对测试集应用最优度。</p><p id="130c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这就是如何测试不同的多项式模型:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="9360" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是这个过程的结果:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="78a4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">因此，<strong class="jp hz">越简单越好</strong>:)</p><p id="6223" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">具有最低MSE的模型是度数= 3的模型。看起来是这样的:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="bd96" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们可以看到，我们很好地抓住了这一趋势。当然，它只是一个三次多项式，所以它不会跟随真实股票价格的所有起伏。好的一面是，它不应该预测涨跌，因为它被认为是一个长期预测。</p><p id="17d5" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">既然已经做出了这种预测，我们可以将它分离出来，并对原始信号进行去趋势化，以单独研究这些起伏:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="0186" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是新的信号，可以考虑用于<strong class="jp hz">中期预测。</strong></p><h2 id="f7dd" class="kx ky hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">2.中期预测</h2><p id="0606" class="pw-post-body-paragraph jn jo hy jp b jq ls iz js jt lt jc jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">要进行这种预测，首先要做的是对信号进行平均，并考虑其月均值:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="1be0" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在我们想考虑在一定数量的月份(比如说44个月)内发生了什么，并预测在接下来的三个月内会发生什么。</p><blockquote class="md me mf"><p id="4423" class="jn jo mg jp b jq jr iz js jt ju jc jv mh jx jy jz mi kb kc kd mj kf kg kh ki hb bi translated">附注:我们没有使用整个数据集，因为查看2010年发生的事情对理解2021年将要发生的事情没有帮助…至少在这个模型中没有:)</p></blockquote><p id="c5aa" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的案例中，我们将使用的工具是ARIMA模型。同样，我们试图理解线性模型的系数及其被建模为噪声的不确定性(<a class="ae hv" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.arima.model.ARIMA.html" rel="noopener ugc nofollow" target="_blank">此处</a>您可以找到文档)。</p><p id="888b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们考虑一下从2017年开始会发生什么:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="2f2c" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">给定我们蓝色的东西，我们想预测我们将在<strong class="jp hz">红色中看到什么。</strong></p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="5219" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是我们将要使用的函数:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="cfd4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是优化过程(不应超过5分钟):</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="ac50" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这就是AIC(赤池信息标准)的价值:我们将从中挑选出最好的模型</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="eba4" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是我们最佳型号的统计表:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="00ce" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里我们定义结果变量:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="82b8" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们在这里绘制它:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="b0cf" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一些注意事项:</p><ul class=""><li id="c53c" class="kj kk hy jp b jq jr jt ju jw kl ka km ke kn ki mk kp kq kr bi translated"><strong class="jp hz">界限相当大</strong>，但这是因为我们想要有95%的信心，如果我们接受我们可能在超过95%的不确定性中出错的事实，我们可以缩小界限</li><li id="3251" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki mk kp kq kr bi translated">该模型实际上是预测未来三个月我们将有一个上升趋势。耶。:D</li></ul><h2 id="c523" class="kx ky hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">3.短期预测</h2><p id="4af5" class="pw-post-body-paragraph jn jo hy jp b jq ls iz js jt lt jc jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">这基本上是相同的理论和过程，但是现在我们想根据之前的41天来预测接下来的三天。</p><p id="b89e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我将非常简要地解释这一过程，并强调其不同之处:</p><p id="780b" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是新数据集及其绘图的定义:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="9cb2" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是优化过程:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="edb9" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是模型选择和结果生成部分:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="af84" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是最后一部分:</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="mb mc l"/></div></figure><p id="4916" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">一些注意事项:</p><ul class=""><li id="915b" class="kj kk hy jp b jq jr jt ju jw kl ka km ke kn ki mk kp kq kr bi translated">短期预测更加不确定和难以预测</li><li id="61ea" class="kj kk hy jp b jq ks jt kt jw ku ka kv ke kw ki mk kp kq kr bi translated">尽管如此，我们的模型预测了第一次大的下跌，然后预测会有一些轻微的上涨，但大部分是持平的。<strong class="jp hz">这不是事实，但大体上符合现实中将要发生的事情。</strong></li></ul><h2 id="286d" class="kx ky hy bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">4.结论</h2><p id="c383" class="pw-post-body-paragraph jn jo hy jp b jq ls iz js jt lt jc jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">这本笔记本的目的只是为了强调一个我的教授们已经强调了无数次的概念:<strong class="jp hz">预测是一个时间尺度的问题。</strong></p><p id="c2eb" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">预测“不确定时期”是不可能的，因为短期预测需要不同的数据和相对于中期或长期预测的不同方法。</p><p id="f39e" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="b614" class="pw-post-body-paragraph jn jo hy jp b jq jr iz js jt ju jc jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">A.在<a class="ae hv" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hz"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae hv" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="jp hz">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae hv" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="jp hz">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。再见:)</p></div></div>    
</body>
</html>
<html>
<head>
<title>Mobile Automation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">移动自动化</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/mobile-automation-b56fd20a1082?source=collection_archive---------56-----------------------#2021-06-30">https://medium.com/geekculture/mobile-automation-b56fd20a1082?source=collection_archive---------56-----------------------#2021-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/eb5988bc73838b1434655162781d7f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TtSIbjTmfBCEeCo8"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@alexkixa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexandre Debiève</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="742a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到目前为止，主要的移动自动化是使用Appium的黑盒测试。Appium的优势是支持一长串编程语言。然后有机会在不同的项目中使用Python和Java。Appium的缺点是，安装步骤较长且复杂，执行速度比selenium和市场上的其他自动化工具慢。另一个缺点是片状剥落。然而，同意剥落与设计、数据、环境和许多因素有关。因此，现在是时候转向其他一些工具了，这些工具可能对这些问题有更好的解决方案。</p><p id="8b8e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Espresso来自谷歌，它在Android环境中的工作方式很有趣。Espresso会安装一个与原始App apk并行的测试apk，并发送UI事件。通过观察事件的行为，得出比较的结果。因此，称浓缩咖啡测试为黑盒测试可能是不正确的。它应该更好地称为灰盒或白盒测试工具。这种行为的优点是浓缩咖啡可以完全避免同步。Espresso比市面上很多工具都快；测试脚本更加稳定，也更容易配置。另一个优势是，由于该工具来自Google，它可以比市场上的开源工具获得更长时间的官方支持。</p><p id="6fa2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">说到缺点，Espresso不支持像Appium这样的大量语言列表。它只支持Java和Kotlin。Espresso只能支持Android自动化。因此，如果需要测试Android和iOS应用程序，请坚持使用Appium。另一方面，假设需求是测试Android应用。在这种情况下，Espresso的优势超过了Appium或市场上的任何其他工具。正确的说法应该是“完全取决于业务需求”。Espresso design只能支持测试一个应用程序。因此，如果条件是在一个工作流程中尝试多个应用程序，则需要与UIAutomator或Appium集成。</p><p id="8a28" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">处理同步场景决定了自动化框架的不完整；因此，我觉得应该理解没有同步的测试自动化背后的机制。Android中的测试主要包括两种类型:它们是单元测试或仪器测试。Espresso为自动化UI测试做仪器测试。换句话说，Espresso是Android编写可靠UI测试的原生测试框架。</p><p id="e5f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Espresso在自动化测试方面使用了一个简单的公式。食谱从在屏幕上定位一个视图开始。简单地说，屏幕上的矩形区域就是我们所说的视图。它负责绘制和处理该区域。确定屏幕上的视图后，就该行动了。在自动化测试中，这可以是点击或滑动或输入文本。这一行动的时机是同步进入画面。浓咖啡不需要被告知时间，可以很好地处理这种情况。最后，它验证动作的性能。该公式的表示如下所示。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="5236" class="kc kd hi jy b fi ke kf l kg kh">onView(ViewMatcher). Perform(ViewAction).check(ViewAssertion)</span></pre><p id="926b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ViewMatcher是匹配视图的hamcrest匹配器的集合。ViewAction负责在标识的视图上执行操作。正如所料，ViewAssertion负责完成视图中元素的断言。有几个on*方法是使用Espresso框架开始测试的切入点。<code class="du ki kj kk jy b">onView()</code>就是一个切入点的例子。<code class="du ki kj kk jy b">onView()</code>不适用于适配器视图。<em class="kl">适配器视图</em>是由包含数据的适配器支持的视图。适配器视图显示项目池中的数据集。适配器视图将重用滚动时从屏幕上消失的项目。从逻辑上来说，为了验证一段数据的显示，我们将滚动到屏幕上出现包含该段数据的项目视图。为了适应这种情况，浓缩咖啡有不同的配方。<code class="du ki kj kk jy b">onData(ObjectMatcher) </code>。DataOptions，后面是上面看到的<code class="du ki kj kk jy b">Perform()</code>和<code class="du ki kj kk jy b">check()</code>方法。ObjectMatcher是<code class="du ki kj kk jy b">onData()</code>方法的输入，它描述了要搜索的数据。</p><p id="243d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有一种通过标识符识别视图的方法，就像我们在selenium和Appium中识别视图一样，叫做<code class="du ki kj kk jy b">FindViewById()</code>。然而，Espresso通常不使用该方法，因为该方法不支持同步。使用<code class="du ki kj kk jy b">onView()</code>方法时，Espresso检查三项检查。</p><p id="95cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">发送事件之前，请检查主线程消息队列。如果消息队列不为空，Espresso会一直等到队列为空。这种等待通过等待线程消息队列精确来确保应用程序和测试之间的Espresso同步。此外，主线程消息队列包含应用程序在屏幕上呈现信息的指令。</p><p id="9762" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Espresso的另一个内置同步功能是异步任务。Espresso等待所有异步任务完成后再继续。这种心理检查功能可以防止Espresso脚本失败，因为脚本在后台作业运行时执行得更早。</p><p id="fca3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第三个内置特性是确保所有开发人员定义的空闲资源都是空闲的。一个<em class="kl">空闲资源</em>代表一个异步操作，其结果会影响UI测试中的后续操作。使用Espresso注册空闲资源可以在测试应用程序时更可靠地验证异步操作。</p><p id="b9da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过执行这些检查，Espresso大大增加了在任何给定时间只能发生一个UI动作或断言的可能性。这种能力提供了更可靠的测试结果。</p><p id="3f94" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在进行android测试时遇到的重大挑战是</p><ul class=""><li id="10fa" class="km kn hi ix b iy iz jc jd jg ko jk kp jo kq js kr ks kt ku bi translated">在代码改变后生成构建时，确保自动脚本的执行以验证改变。</li><li id="4a39" class="km kn hi ix b iy kv jc kw jg kx jk ky jo kz js kr ks kt ku bi translated">为了模拟今天的网络延迟或任何减速过程，我们必须依赖远程服务器和其他工作站。</li><li id="27a6" class="km kn hi ix b iy kv jc kw jg kx jk ky jo kz js kr ks kt ku bi translated">说到持续集成，需要涉及到持续集成工具。然后，部署和列表可以根据环境进行扩展。</li><li id="e06b" class="km kn hi ix b iy kv jc kw jg kx jk ky jo kz js kr ks kt ku bi translated">测试android应用程序的另一个主要挑战是测试支持新平台功能的最新Android API。为此，我们可能需要在模拟器和真实设备上进行尝试。</li></ul><p id="0ed9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当使用Espresso自动化框架进行Android测试时，处理这些挑战将会很容易。总之，最初的反馈是原生移动自动化可能更具挑战性和令人兴奋，但也会更有回报。</p></div></div>    
</body>
</html>
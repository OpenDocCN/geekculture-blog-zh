<html>
<head>
<title>How to store NFT metadata decentralized and dynamically</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何分散、动态地存储NFT元数据</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/storage-of-dynamic-nft-metadata-based-on-db3-network-f39bd1fe2a77?source=collection_archive---------5-----------------------#2022-12-08">https://medium.com/geekculture/storage-of-dynamic-nft-metadata-based-on-db3-network-f39bd1fe2a77?source=collection_archive---------5-----------------------#2022-12-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/268b228c047aa1e31647bcfe4329dc7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jqur9zVsPKGEF7HLo_G32A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The metadata of a dNFT representing a property can change to reflect maintenance history, past sales, etc. image from <a class="ae iu" href="https://blog.chain.link/what-is-a-dynamic-nft/" rel="noopener ugc nofollow" target="_blank">https://blog.chain.link/what-is-a-dynamic-nft/</a></figcaption></figure><p id="5c26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">dNFT(动态NFT)中的元数据很难同时实现“<strong class="ix hj">去中心化</strong>和“<strong class="ix hj">动态变化</strong>”。</p><h1 id="6394" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">分散元数据存储</h1><p id="665a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">关于<a class="ae iu" href="https://thecontrol.co/the-state-of-nft-data-storage-c471c1af58d5" rel="noopener ugc nofollow" target="_blank"> 48%的NFT </a>(大多数NFT是静态的)元数据是分散的，存储在IPFS上。格式后缀为<strong class="ix hj"><em class="kw">ipfs/your _ collection _ file _ hash/token id</em></strong><em class="kw">，</em>其中<strong class="ix hj"><em class="kw">your _ collection _ file</em></strong><em class="kw"/>是指NFT集合，其中<strong class="ix hj"> <em class="kw"> tokenid </em> </strong>是一个数字，如“26”。此类项目的一个例子是<a class="ae iu" href="https://opensea.io/assets/ethereum/0xbc4ca0eda7647a8ab7c2061c2e118a18a936f13d/2193" rel="noopener ugc nofollow" target="_blank"> Bored Ape Yacht Club </a>，其元数据存储在IPFS，尽管用于IPFS的BaseURI可以由合同所有者更改。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/71c90aa69e39467e93fc684c5cbd77ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vB0uGn0lo1VuXuF_dRrFRA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><em class="lc">The metadata of Bored Ape NFT is stored in IPFS, and it records multiple attributes, fur, mouth, etc. image from author</em></figcaption></figure><p id="28a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设平台想要提供NFT定制功能，并将元数据放在分散存储中。在这种情况下，开发人员需要穷尽所有可能的属性组合，将所有种类的元数据放在IPFS上，然后根据属性组合进行索引，找到IPFS的<em class="kw"> tokenURI </em>来获取元数据。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/b31f88cfdbcf4ca710b5bbe694614a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-U7fZuZaQK6Gsf7u9TGTA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The picture demonstrated the relationship between the links. image from author</figcaption></figure><p id="c5f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的缺点是:</p><p id="0dbf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">元数据组合多，导致前期存储成本大。你必须提前储存它们。</p><p id="14c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果平台希望在眼镜的功能中添加智能眼镜选项，或者当它提供动态更改的能力时，它可以根据世界杯在一场比赛中的进球，更改NFT中关于比赛级别的元数据信息和NFT中的其他元数据信息。此时，元数据更改的时效性要求更高。例如，这种动态变化几乎等于更换一个新的NFT，改变NFT元数据的成本将急剧上升。</p><h1 id="7cd6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">先动态更新</h1><p id="ec96" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">第二种方法是放弃分散的元数据存储，只把所有权放在链上，保证及时快速的动态变化。有些项目通过集中服务器生成元数据，定制NFT的元数据信息会集中合并生成。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/b2a419d5e5f805b931e7a7c4f495ed1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QsT69mUZDqcf-36e9oDJw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">image from author</figcaption></figure><p id="abd9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了能够显示2022年和2027年的不同房屋，NFT·明特应该首先将其他屋顶放在链上，存储链外的元数据，以及一个集中式服务的URL来进行关联，在2022年指向其中的一个，并在2037年将其替换为另一个。</p><p id="c162" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，他们将元数据存储在中央存储器上，这些服务器可能会在一眨眼的时间内发生故障，使全球NFT所有者损失数百万美元。</p><p id="94f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更重要的是，保证这样的存储不被篡改并不容易。尤其是一些游戏NFT，它们的价值不在于显示的画面，而在于游戏中至关重要的信息，比如武力值、等级等。这些信息存储在元数据中。不可能保证只有NFT所有者的所有者能够改变基于集中存储的元数据。</p><p id="1f29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当元数据存储与链上的数据分离时，动态元数据历史不会在链上留下痕迹，这两者是不相关的，因此不容易进行实际的分析和洞察。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/5b7fe2ab32dd177353bfbd265e7a492a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHFs60y_e5cRjdRPP6BKrA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The history of the house,image from author</figcaption></figure><p id="bcd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目前，只有前两列数据被保存在链上，这可以从OpenSea这样的平台上直接看到。但是你只知道价格是随着时间的推移而增加的，但是你需要明白为什么。最后一个数据列在平台的集中式服务器里，不可靠。例如，2029年的价格大幅上涨是由于维修新屋顶——关于此的信息在元数据的第三列中。因为元数据是变化的，没有存储在链上，可能被篡改，所以你无法知道，也没有挑战性去分析理解2037年一个比较合理的价格是多少。这些问题可能导致dNFT在NFT交易市场的展示体验不佳，使dNFT难以在二级市场流通和繁荣。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/4ee451d78d5d2dbfaf1ea8470b0c1ffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*GW15iBhd07E4TPD6GMo9XA.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">image from <a class="ae iu" href="https://i.ibb.co/8NcyKwh/dyanmic.gif" rel="noopener ugc nofollow" target="_blank">https://i.ibb.co/8NcyKwh/dyanmic.gif</a></figcaption></figure><p id="521b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，在OpenSea中，一个随每日日照条件变化的dNFT每8小时旋转一次动画，元数据的变化历史不会呈现在网站上，动态特征在你第一次进入时完全看不到。你无法知道这是动态的。</p><h1 id="b389" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">把所有的东西都放在链子上。</h1><p id="e84b" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">所以最好把所有的元数据，图片，交易信息等。并且可以方便地和动态地添加元数据和改变它。您的签名应该执行更改，NFT平台作为一个中介将数据的直接接触(读写、缓存等)减到最少。).</p><h1 id="53dc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">DB3网络</h1><p id="2afe" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在这里，让我介绍一下<a class="ae iu" href="https://github.com/dbpunk-labs/db3/" rel="noopener ugc nofollow" target="_blank"> DB3网络</a>，这是一个分散式存储解决方案，它采用了键值存储范式，并具有高级数据库属性，如突变和可编程性。</p><h2 id="a89f" class="lh ju hi bd jv li lj lk jz ll lm ln kd jg lo lp kh jk lq lr kl jo ls lt kp lu bi translated">基于分散存储轻松更改元数据。</h2><p id="3670" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">DB3可以支持方便的类似CRUD的操作，插入、更新、读取和删除存储的数据。这对于集中式存储来说很容易实现，但是对于分散式存储来说很难实现。原因是更新操作与区块链的不可变特征相冲突。但在上面提到的动态NFT等用例中，不可变存储从安全角度来看很重要，但它限制了可能应用的数量(如NFT的进化能力)。</p><p id="6671" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在DB3网络中，突变被定义为我们的核心概念。所有对数据修改的操作都被定义为变异。您可以使用变异来插入、更新和删除数据。例如，当您想要修改屋顶颜色元数据时，您可以轻松地完成数据更新。</p><pre class="ky kz la lb fd lv lw lx bn ly lz bi"><span id="0a80" class="ma ju hi lw b be mb mc l md me">&gt;put house roofcolor offwhite<br/>submit mutation to mempool done!<br/>&gt;get house roofcolor<br/>roof -&gt; offwhite</span></pre><p id="9af1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同时，mutation可以执行数据更新操作，另外三个:insert/update/delete以及这些操作返回的hash都会提交到块中。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/7ab35c16ae8a69de2ee2302b93bc326f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwnnu1lOM2RziZKYXHk_BQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">the operation is recorded into blocks, image from author</figcaption></figure><h2 id="605b" class="lh ju hi bd jv li lj lk jz ll lm ln kd jg lo lp kh jk lq lr kl jo ls lt kp lu bi translated">分析链上的元数据历史记录</h2><p id="0ecc" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">dNFT的每一次元数据更改都会像快照一样记录在链上。同时，因为我们优化了我们的存储引擎的效率，我们可以实现高性能的查询，不逊于web2数据库。因此，在未来，对dNFT的分析将非常容易阅读并显示更可信的元数据历史。</p><h2 id="0590" class="lh ju hi bd jv li lj lk jz ll lm ln kd jg lo lp kh jk lq lr kl jo ls lt kp lu bi translated">索赔元数据<strong class="ak">所有权</strong></h2><p id="c43e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">其次，dNFT的描述信息会以类似web2中“表”的概念存储。<strong class="ix hj">由于元数据定义了资产，保护元数据与保护所有权一样重要。</strong>此表的操作和修改需要获得用户的许可，完全由用户控制，保证了dNFT的所有权。集中式服务应该很少涉及元数据。</p><figure class="ky kz la lb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/2f903de363eef3f0a8eb42f912f759ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XP_KrrnA9kMOi0Bx3XdCkw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">image from author</figcaption></figure><p id="cc32" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的<a class="ae iu" href="https://github.com/dbpunk-labs/" rel="noopener ugc nofollow" target="_blank"> Github </a>:</p><ul class=""><li id="a58e" class="mh mi hi ix b iy iz jc jd jg mj jk mk jo ml js mm mn mo mp bi translated">浏览一些设计文档；</li><li id="25d5" class="mh mi hi ix b iy mq jc mr jg ms jk mt jo mu js mm mn mo mp bi translated">从<a class="ae iu" href="https://github.com/dbpunk-labs/db3/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22" rel="noopener ugc nofollow" target="_blank"> <em class="kw"> goodfirstissue </em> </a>开始编码；</li><li id="3d31" class="mh mi hi ix b iy mq jc mr jg ms jk mt jo mu js mm mn mo mp bi translated">根据<a class="ae iu" href="https://github.com/dbpunk-labs/db3/issues?q=is%3Aissue+is%3Aopen+label%3Adiscussion-required" rel="noopener ugc nofollow" target="_blank"> <em class="kw"> WIPissue </em> </a>与我们讨论。</li></ul></div></div>    
</body>
</html>
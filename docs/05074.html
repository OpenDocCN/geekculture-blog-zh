<html>
<head>
<title>SwiftUI App Chat — Episode II° —</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI应用聊天—第二集—</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swiftui-app-chat-episode-ii-2e8a6f188e8b?source=collection_archive---------30-----------------------#2021-07-08">https://medium.com/geekculture/swiftui-app-chat-episode-ii-2e8a6f188e8b?source=collection_archive---------30-----------------------#2021-07-08</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><p id="49f7" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在前一集，我们创建了应用程序的结构，但没有漂亮的外观和感觉，在这篇文章中，我们看到如何改善一点。</p><p id="7e4d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">首先，我记得项目的代码在这里:<a class="ae je" href="https://github.com/niqt/EEnigma" rel="noopener ugc nofollow" target="_blank">https://github.com/niqt/EEnigma</a></p><h1 id="6270" class="jf jg hj bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">联系人列表</h1><figure class="ke kf kg kh fe ki es et paragraph-image"><div class="es et kd"><img src="../Images/92adfe4b821ffa2acc6dd037520a22b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*FmMMXLutvKJWDGaf.png"/></div></figure><p id="1057" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">要更改导航栏，我们必须在ContentView中定义一个init函数:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="b50b" class="kq jg hj km b fj kr ks l kt ku">init() {<br/>        let coloredAppearance = UINavigationBarAppearance()<br/>        coloredAppearance.configureWithTransparentBackground()<br/>        coloredAppearance.backgroundColor = .clear<br/>        coloredAppearance.titleTextAttributes = [.foregroundColor: UIColor.white]<br/>        coloredAppearance.largeTitleTextAttributes = [.foregroundColor: UIColor.white]<br/>        <br/>        UINavigationBar.appearance().standardAppearance = coloredAppearance<br/>        UINavigationBar.appearance().compactAppearance = coloredAppearance<br/>        UINavigationBar.appearance().scrollEdgeAppearance = coloredAppearance<br/>        UINavigationBar.appearance().tintColor = UIColor.white<br/>        <br/>        UITabBar.appearance().tintColor = UIColor.white<br/>        UITabBar.appearance().barTintColor = UIColor.black<br/>    }</span></pre><p id="71bc" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">首先，创建一个<em class="kv">UINavigationBarAppearance</em>并清除任何默认选项，然后我们设置背景颜色和文本颜色。请注意，对于文本颜色，我们需要指定标题小或大时的颜色。</p><p id="4c1b" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我们为任何可能的情况设置了导航栏的外观。</p><p id="b13d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">最后两行是关于TabBar的设置。</p><p id="e333" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">你可以阅读https://nicoladefilippo.com/toolbar-and-customization/<a class="ae je" href="https://nicoladefilippo.com/toolbar-and-customization/" rel="noopener ugc nofollow" target="_blank">的帖子来了解更多关于定制的内容。</a></p><p id="59ad" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">为了完成联系人列表的定制，我们需要在contacts视图中进行一些更改:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="23ca" class="kq jg hj km b fj kr ks l kt ku">init() {<br/>        UITableView.appearance().backgroundColor = .none<br/>        UITableViewCell.appearance().backgroundColor = .none<br/>    }<br/>    <br/>    var body: some View {<br/>        List {<br/>            ForEach(contacts) { contact in<br/>                ZStack(alignment: .leading) {<br/>                    RowView(contact: contact)<br/>                    NavigationLink(destination: ChattingView()) {<br/>                        EmptyView()<br/>                    }.buttonStyle(PlainButtonStyle()).frame(width:0).opacity(0)<br/>                }<br/>            }.listRowBackground(Color.clear)<br/>        }.background(Color.black)<br/>        .ignoresSafeArea()<br/>    }<br/>}<br/><br/>struct RowView: View {<br/>    var contact: Contact<br/>    var body: some View {<br/>        HStack {<br/>            Image(systemName: "person")<br/>                .resizable()<br/>                .frame(width: 30, height: 30)<br/>                .foregroundColor(.white)<br/>            Text(contact.aliasName)<br/>                .foregroundColor(.white)<br/>        }<br/>    }<br/>}</span></pre><p id="520e" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在init函数中，我们移除了tableview和视图中单元格的背景。</p><p id="f9fe" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">注意如何使用<em class="kv">。listrow background(color . clear)</em>移除行的背景，以及我们如何用<em class="kv">为列表设置列表背景。背景(颜色.黑色)</em>。</p><p id="970d" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">奇怪的是这段代码:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="8717" class="kq jg hj km b fj kr ks l kt ku">ZStack(alignment: .leading) {</span><span id="15f7" class="kq jg hj km b fj kw ks l kt ku">RowView(contact: contact)</span><span id="2bca" class="kq jg hj km b fj kw ks l kt ku">NavigationLink(destination: ChattingView()) {</span><span id="60e7" class="kq jg hj km b fj kw ks l kt ku">EmptyView()</span><span id="a1d6" class="kq jg hj km b fj kw ks l kt ku">}.buttonStyle(PlainButtonStyle()).frame(width:0).opacity(0)</span><span id="4475" class="kq jg hj km b fj kw ks l kt ku">}</span></pre><p id="047f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">为什么我们需要一个ZStack来显示列表的行？</p><p id="8ba1" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在SwuiftUI中，我们没有一个简单的方法来移除<em class="kv">公开指示器</em>(行尾的&gt;)。为了隐藏这个指示器，我们用一个具有EmptyView(这样我们就可以看到RowView)和一个宽度为零的buttonStyle的NavigationLink来覆盖该行。</p><h1 id="801f" class="jf jg hj bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">聊天列表</h1><p id="2ce6" class="pw-post-body-paragraph ig ih hj ii b ij kx il im in ky ip iq ir kz it iu iv la ix iy iz lb jb jc jd hc bi translated">我们想要:</p><figure class="ke kf kg kh fe ki es et paragraph-image"><div class="es et kd"><img src="../Images/d40fa3e33cdc892b7116e8be6c2b9a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*d75G8rBC6csEEbAs.png"/></div></figure><p id="3001" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">首先，在init函数中删除背景:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="12e5" class="kq jg hj km b fj kr ks l kt ku">init() {<br/>        UITableView.appearance().backgroundColor = .none<br/>        UITableViewCell.appearance().backgroundColor = .none<br/>    }</span></pre><p id="465f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我们还必须更改列表，以添加背景并删除披露指标:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="2edb" class="kq jg hj km b fj kr ks l kt ku">var body: some View {<br/>        NavigationView {<br/>            VStack {<br/>                List {<br/>                    ForEach(chats) { chat in<br/>                        ZStack(alignment: .leading) {<br/>                            RowLastChat(chat: chat)<br/>                            NavigationLink(<br/>                                destination: ChattingView())<br/>                                {}.buttonStyle(PlainButtonStyle()).frame(width:0).opacity(0)<br/>                        }<br/>                    }.listRowBackground(Color.clear)<br/>                }.background(Color.black)<br/>            }.navigationBarTitle("Chats", displayMode: .inline)<br/>            .foregroundColor(.white)<br/>            .background(Color.black)<br/>            .ignoresSafeArea()<br/>        }<br/>    }</span></pre><p id="b1a4" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在这段代码中，我们为前面的视图编写了相同的内容。将来，我们会看到一些重构来避免“重复自己”。</p><h1 id="c539" class="jf jg hj bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">闲谈</h1><figure class="ke kf kg kh fe ki es et paragraph-image"><div class="es et kd"><img src="../Images/4742f8f89a6badfc6f3b17e18d25dd75.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*6em2PeU7u1zAB-Qu.png"/></div></figure><p id="e740" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">对于这个视图，我们有相同的代码(或者非常相似)。在init中:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="1e27" class="kq jg hj km b fj kr ks l kt ku">init() {<br/>        UITableView.appearance().backgroundColor = .none<br/>        UITableViewCell.appearance().backgroundColor = .none<br/>    }</span></pre><p id="2cce" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在正文中:</p><pre class="ke kf kg kh fe kl km kn ko aw kp bi"><span id="adea" class="kq jg hj km b fj kr ks l kt ku">var body: some View {<br/>        VStack(spacing: 0) {<br/>            // Chat<br/>            List {<br/>                ForEach(chats) { chat in<br/>                    if chat.name == "Bob" {<br/>                        UserRowView(chat: chat)<br/>                        <br/>                    } else {<br/>                        ChatRowView(chat: chat)<br/>                    }<br/>                }.listRowBackground(Color.clear)<br/>            }.background(Color.black)<br/>            .listStyle(SidebarListStyle())<br/>            .ignoresSafeArea()<br/>            .navigationBarTitle("Chatting", displayMode: .inline)<br/>            .onTapGesture {<br/>                self.endEditing()<br/>                <br/>            }<br/>            // Input<br/>            HStack() {<br/>                TextEditor(text: $writing)<br/>                    .frame(minHeight: 0, maxHeight: 50)<br/>                    .border(Color.gray)<br/>                <br/>                Button(action: {<br/>                    chats.append(Chat(name: "Bob", image:"", lastMessage: writing, timestamp: Date(), chatId: ""))<br/>                    writing = ""<br/>                    self.endEditing()<br/>                }, label: {<br/>                    Image(systemName: "paperplane")<br/>                })<br/>                <br/>            }.ignoresSafeArea(.keyboard, edges: .bottom)<br/>            .padding()<br/>            .background(Color.black)<br/>        }<br/>    }</span></pre><h1 id="d82c" class="jf jg hj bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">然后</h1><p id="6f58" class="pw-post-body-paragraph ig ih hj ii b ij kx il im in ky ip iq ir kz it iu iv la ix iy iz lb jb jc jd hc bi translated">在下一篇文章中，我们将开始集成图表应用程序的核心。敬请期待！</p><p id="7594" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><em class="kv">注意:英语不是我的母语，所以我对一些错误感到抱歉。如果你能纠正我，我将不胜感激。</em></p></div><div class="ab cl lc ld gq le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hc hd he hf hg"><p id="088c" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><em class="kv">原载于2021年7月8日https://nicoladefilippo.com</em><a class="ae je" href="https://nicoladefilippo.com/swiftui-app-chat-episode-ii/" rel="noopener ugc nofollow" target="_blank"><em class="kv"/></a><em class="kv">。</em></p></div></div>    
</body>
</html>
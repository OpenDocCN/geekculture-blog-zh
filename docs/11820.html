<html>
<head>
<title>GitOps with Argo CD: Managing Kubernetes Application using Git and Argo CD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GitOps with Argo CD:使用Git和Argo CD管理Kubernetes应用程序</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/gitops-with-argo-cd-managing-kubernetes-application-using-git-and-argo-cd-42ed6879ab1e?source=collection_archive---------0-----------------------#2022-04-11">https://medium.com/geekculture/gitops-with-argo-cd-managing-kubernetes-application-using-git-and-argo-cd-42ed6879ab1e?source=collection_archive---------0-----------------------#2022-04-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7b141dcec95883a0f4a9f2aef527aaa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NystAxizlxuIDHLh.png"/></div></div></figure><h1 id="d533" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是阿尔戈光盘</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/0177d75c5cc1f56b27c2b0fa8fa12e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*29x0jWcMCUSeOZGO.jpg"/></div></figure><p id="c554" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">Argo CD是一个工具，它将从您的git存储库中读取您的环境配置(编写为helm chart、kustomize文件、jsonnet或普通yaml文件),并将其应用到您的Kubernetes名称空间。Argo CD的一些特征是:声明性的和版本控制的应用程序部署。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="afae" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">为什么是Argo CD</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/6efc11ddd9abb7ac4c9c1112fe073d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*jqCRU33TnHVzB3f8.jpg"/></div></figure><p id="36ad" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">它使您的应用程序定义、配置和环境应该是声明性的和受版本控制的。应用程序部署和生命周期管理应该是自动化的、可审计的、易于理解的。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="11ad" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">没有Argo CD的挑战</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/0e18b6db45b24bae0b9c8d3290875ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0t04PO2uykxb1rjd.png"/></div></div></figure><ol class=""><li id="c684" class="lf lg hi jv b jw jx ka kb ke lh ki li km lj kq lk ll lm ln bi translated">在您尝试部署的每个地方安装和设置像Kubectl这样的工具。</li><li id="dd3e" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">配置对每个k8s集群的访问，以部署应用程序。</li><li id="b3e2" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">如果我们的集群在云上，则配置对云提供商的访问。这将带来更多的安全挑战。</li><li id="2f8c" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">我们不了解部署状态。</li></ol></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="0e6f" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">Argo光盘如何解决上述问题</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/6d4b6f85028e9d93d691eeb344b15cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CJzGjCl77rqu6Qpg.jpg"/></div></div></figure><p id="d71d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在Kubernetes集群中部署ArgoCD，而不是将应用程序更改或部署推送到集群，我们可以在argo CD代理的帮助下提取它。因此，同一个argo CD实例能够同步k8s集群的舰队。</p><p id="ca42" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们可以配置Argo CD rto来跟踪存储我们的kubernetes清单的GIT repositry的变化，如果有任何变化，就自动提取和部署它。这样我们就可以清楚地分离CI和CD流，并单独维护代码。</p><p id="ea58" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">如果k8s集群中发生了任何手动更改，Argo CD将自动恢复这些手动更改，并保证k8s在Git中的显示保持真实的单一来源。</p><p id="b5cf" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">Argo CD支持Kubernetes平原yaml文件，舵图表和kustomize文件。</p><p id="2dda" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">使用这种设置，集群灾难恢复非常容易，因为我们在单独的git存储库中管理所有部署代码，我们可以简单地将Argo CD指向git repo。Argo CD会将这些同步到集群。</p><p id="b017" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">对于特定的部署，我们不需要在kubernetes中创建集群角色和访问权限。相反，我们可以使用GIT合并策略将应用程序部署到带有Argo CD的集群中。</p><p id="ba71" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">您不需要向非人类用户授予外部集群访问权限。所以k8s之外没有集群凭证。</p><p id="09c2" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们可以使用带有customize的覆盖来首先测试dev env中的更改，然后在prod中应用它。(我们甚至可以使用分支策略，尽管它非常流行，但并不是最佳选择。)</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/0705c22643d23279c73ccc508797c0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2xfhBpg_xY2zV8ui.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Lamen Diagram</figcaption></figure><h1 id="9ab1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><p id="df3a" class="pw-post-body-paragraph jt ju hi jv b jw lz jy jz ka ma kc kd ke mb kg kh ki mc kk kl km md ko kp kq hb bi translated">在安装Argo CD之前，我们需要准备好以下环境。(我假设您已经有了这个设置)。</p><ol class=""><li id="3632" class="lf lg hi jv b jw jx ka kb ke lh ki li km lj kq lk ll lm ln bi translated">库伯内特星团。</li><li id="a4d8" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">kubectl包已安装。这是管理集群所必需的。</li><li id="6c46" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">Kubernetes集群访问(默认位置是~/。kube/config)。</li><li id="428b" class="lf lg hi jv b jw lo ka lp ke lq ki lr km ls kq lk ll lm ln bi translated">GitHub repositry。在我的案例中，我使用了这种回购。<a class="ae me" href="https://github.com/Sarvabhowma1995/argocd-demo" rel="noopener ugc nofollow" target="_blank"><strong class="jv hj"/>https://github.com/Sarvabhowma1995/argocd-demo</a></li></ol></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="0662" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">安装Argo光盘</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/c100d70a6770f6bfd5075a8a792da88a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6-meA6GBlhXMhIIA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Argo CD low level architeture</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/6dbf37ad8866848f2fd8eafc9c795d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_AxFLG-zR49OgIWbEoGVA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">High Level Architecture</figcaption></figure><p id="9251" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">Argo CD可以安装在kubernetes内部或外部，但在kubernetes上安装Argo CD是生产就绪。因此，我将它安装在kubernetes集群中。更多关于如何本地安装的信息，请<a class="ae me" href="https://argo-cd.readthedocs.io/en/stable/developer-guide/running-locally/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hj"> <em class="mh">点击这里</em> </strong> </a>。</p><p id="4f01" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj">注意:</strong>即使您在本地安装Argo CD，您仍然需要kubernetes集群来部署资源。</p><p id="9417" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在运行以下命令之前，请确保您拥有kubernetes集群访问权限，可以访问需要安装Argo CD的位置。在我的例子中，我将kubernetes集群作为minikube安装在windows中，并连接到它来执行任何操作。</p><blockquote class="mi mj mk"><p id="4110" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj"> $ </strong> kubectl创建名称空间argocd</p><p id="2b34" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj">$</strong>ku bectl apply-n argocd-f<a class="ae me" href="https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/argoproj/Argo-CD/stable/manifests/install . YAML</a></p></blockquote><p id="f56a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">下面是运行命令后的输出，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/405fa1b573db9e1db280aa8725e4d5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JReelLxremjvAa2hFfHi0g.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Command Output</figcaption></figure><p id="70e0" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">以下是Argo CD安装过程中创建的对象。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/8b2b9981fd3ab31b733a321405f426d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5py0snyrh0msP9XOKNBOQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Objects created for Argo CD</figcaption></figure><p id="d65d" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">一旦分离舱准备好，ArgoCD就会运行。但是ArgoCD API服务器将无法从集群外部访问。我们将使用port-forward向服务公开一个端口，并将其转发到localhost，或者将argocd-server服务类型更改为LoadBalancer(仅适用于云)或NodePort。</p><p id="21d7" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj">三种情况的步骤:</strong></p><p id="1bf5" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj"> A) </strong>对于<strong class="jv hj">端口转发</strong>运行下面的命令，然后用<a class="ae me" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> https://127.0.0.1:8080 </a>访问你的网页</p><blockquote class="mi mj mk"><p id="ddd1" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj"> $ </strong> kubectl端口转发SVC/argocd-server-n argocd 8080:443</p></blockquote><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/43c95a34472fed9d69a4943a6690275e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*jb3Zm8PS6L6xk1HcfEnQYQ.png"/></div></figure><p id="2aa8" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj"> B) </strong>为<strong class="jv hj">节点端口</strong>打补丁服务，运行以下命令。您可以使用具有相应节点端口端口号的任何集群节点公共IP访问webUI。</p><blockquote class="mi mj mk"><p id="0062" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj">$</strong>ku bectl patch SVC argocd-server-n argocd—type = ' JSON '-p '[{"op":"replace "，" path":"/spec/type "，" value":"NodePort"}，{ " op ":" replace "，" path":"/spec/ports/0/nodePort "，" value":30080}]'</p></blockquote><p id="ae46" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><strong class="jv hj"> C) </strong>要将服务修补为<strong class="jv hj">负载平衡器</strong>，请运行以下命令。您可以使用LB URL访问webUI。</p><blockquote class="mi mj mk"><p id="08b4" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj">$</strong>ku bectl patch SVC argocd-server-n argocd-p ' { " spec ":{ " type ":" load balancer " } } '</p></blockquote><p id="6b7a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在我们的例子中，为了方便起见，我使用端口转发。</p><p id="bc51" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">一旦你在UI中打开网页，它会询问用户名密码。<strong class="jv hj"> <em class="mh"> admin </em> </strong>是默认的用户名和密码我们需要检查<strong class="jv hj"><em class="mh">argocd-initial-admin-secret</em></strong>并解码值。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/a3ac9c059d915aadaf68cdd2666efa47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P8zQgMESsy5zrgg4-vGNmQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">View secret from secret</figcaption></figure><p id="1f31" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">下面是解码上述seret值的命令。</p><blockquote class="mi mj mk"><p id="f190" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj"> $ </strong>回显&lt;秘密值&gt; | base64 - decode</p></blockquote><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/0b4f46658a6a90ce6f73aae38dbb53bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*L_NoG9UFZRgc_sWcZ6MDQA.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx">Command to decode the value</figcaption></figure><p id="2350" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">登录后，您的初始页面如下所示，</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/a57b6f5a75be7ca4aecc39278fa6253d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wsuVXHH3H5lZPX1X4S372Q.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Inital ArgoCD page</figcaption></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="b3bb" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">将ArgoCD与Git存储库连接</h1><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/fd257a6d9176d10b3b4a93a6c17e8fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7SpHkfjbAlslEkmk"/></div></div></figure><p id="53e8" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们可以通过yaml文件或UI来定义这些设置。但是在我们的例子中，我遵循yaml文件，这样我们可以在源代码库中维护这个文件。</p><p id="2ece" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我在github中创建了一个<a class="ae me" href="https://github.com/Sarvabhowma1995/argocd-demo" rel="noopener ugc nofollow" target="_blank"><strong class="jv hj"><em class="mh">demo repository</em></strong></a><strong class="jv hj"><em class="mh"/></strong>。在我已经创建的develop文件夹中，存储了所有的开发环境清单文件，并且我已经在该目录中创建了nginx部署&amp;服务。你可以点击下面的链接查看代码。</p><blockquote class="mv"><p id="b850" class="mw mx hi bd my mz na nb nc nd ne kq dx translated"><a class="ae me" href="https://github.com/Sarvabhowma1995/argocd-demo" rel="noopener ugc nofollow" target="_blank">【https://github.com/Sarvabhowma1995/argocd-demo】<em class="nf"/></a></p></blockquote><p id="7240" class="pw-post-body-paragraph jt ju hi jv b jw ng jy jz ka nh kc kd ke ni kg kh ki nj kk kl km nk ko kp kq hb bi translated">现在，我正在创建application.yaml文件来存储argocd和github之间连接的配置细节。这个文件非常类似于kubernetes清单文件，但是有不同的选项。</p><p id="ba47" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在application.yaml清单文件中，我们可以在source和destination下提到所需的值。</p><p id="b4d0" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我已经清楚地解释了每一行，所以请按照下面的代码来理解它，你可以随时参考<a class="ae me" href="https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hj"> <em class="mh">官方文件</em> </strong> </a>。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="nl nm l"/></div></figure><p id="a1f0" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">一旦你创建了上面的文件，要应用它，运行下面的命令。以便从现在开始Argo CD将跟踪来自git的更改并部署它。</p><blockquote class="mi mj mk"><p id="e667" class="jt ju mh jv b jw jx jy jz ka kb kc kd ml kf kg kh mm kj kk kl mn kn ko kp kq hb bi translated"><strong class="jv hj">$</strong>ku bectl apply-f application . YAML</p></blockquote><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es nn"><img src="../Images/96c5c751b3de1b6a0abbe71a22d4e0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*7wb_7A9EmqPH8wA2ojgfFw.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx">applying application manifest to</figcaption></figure><p id="7e5c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">一旦应用了应用程序清单，您就可以从web UI检查该应用程序是否可用。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/191124b6a5bc1bc48976fc93ca507a0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSP2GQW9LnuBjMcb2EgFRA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Application details from Argo CD Web UI</figcaption></figure><p id="ec0a" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">您可以单击该应用程序来检查应用程序映射。您可以单击每个标题来查看摘要、日志、事件、参数和yaml配置。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es no"><img src="../Images/19d3a5561c7cc772c1c23ed6b3943ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyJOPSlCG15dB2vYpAetrA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Application mapping view</figcaption></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="a0d9" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">测试自动部署</h1><p id="5ae7" class="pw-post-body-paragraph jt ju hi jv b jw lz jy jz ka ma kc kd ke mb kg kh ki mc kk kl km md ko kp kq hb bi translated">要测试自动部署，您可以简单地从部署清单文件中更改image标记，并等待3秒钟来自动部署更改。你可以从UI上看到。</p><p id="f8d1" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在我的用例中，我已经给出了nginx的最新标签，现在我将把它改为nginx:1.20标签。</p><p id="645c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">提交后，现在你可以看到argoCD自动将更改后的图像标签部署到集群中。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/91c01163bd2da83d00cb2fb93cd4456e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__H9yRpspilzwfGdNxyBVQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Validatng the automatic deployments</figcaption></figure><p id="cc20" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">您甚至可以测试从集群中手动删除演示应用程序部署或服务，并检查argo CD如何创建应用程序。</p><p id="83e7" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我们还可以从CLI创建示例应用程序，因为我们需要安装Argo CD CLI并运行Argocd app create命令。欲了解更多信息，请<a class="ae me" href="https://argo-cd.readthedocs.io/en/stable/getting_started/#2-download-argo-cd-cli" rel="noopener ugc nofollow" target="_blank"> <strong class="jv hj"> <em class="mh">关注本文档。</em> </strong> </a></p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="7292" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">结论</h1><p id="3996" class="pw-post-body-paragraph jt ju hi jv b jw lz jy jz ka ma kc kd ke mb kg kh ki mc kk kl km md ko kp kq hb bi translated">现在您已经知道了，通过完整的设置，我们可以分离CI &amp; CD，并使用Argo CD自动将应用程序部署到集群中。</p><p id="cc74" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">我希望你们喜欢这个实践教程，并学到比你以前知道的更多的东西。如果你有任何关于这个博客的问题，请告诉我。</p><p id="bc32" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">下一篇博客再见。🤘</p></div></div>    
</body>
</html>
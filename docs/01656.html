<html>
<head>
<title>Power your Angular UI with OpenAPI/Swagger Docs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OpenAPI/Swagger文档增强您的Angular UI</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/power-your-angular-ui-with-openapi-docs-282aff5a9366?source=collection_archive---------6-----------------------#2021-04-19">https://medium.com/geekculture/power-your-angular-ui-with-openapi-docs-282aff5a9366?source=collection_archive---------6-----------------------#2021-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1081" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">生成API模型和端点，使应用程序在构建时安全并与后端兼容。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/b32c0df3579a6515049d5a423abbd57a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hk7S_8wILkDZ0qpOloTvEg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Ref: <a class="ae jn" href="https://images.app.goo.gl/BR74Z8VAmjV355XCA" rel="noopener ugc nofollow" target="_blank">https://images.app.goo.gl/BR74Z8VAmjV355XCA</a></figcaption></figure><p id="3215" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您是否遇到过这样的问题:某个属性或API端点发生了变化，而您在应用程序部署之前不会意识到这一点？如果有一种方法可以让你的用户界面通过后端DTO/端点安全地输入你的，这不是很方便吗？</p><p id="e1d4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我告诉你有一种方法，我们可以获取你的API的swagger/OpenAPI契约，然后自动生成模型和服务，你可以用它们来使你的API的UI类型安全。令人惊奇的是，所有这些都可以在构建时进行配置。</p><p id="2c19" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">介绍够了，让我们开始吧！！</p><h2 id="5ac9" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated"><strong class="ak">先决条件:</strong></h2><ol class=""><li id="5fdb" class="lf lg hi jq b jr lh ju li jx lj kb lk kf ll kj lm ln lo lp bi translated">棱角分明(4。x)或更新的项目。</li><li id="fd4c" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">Node 10.x或更高版本。</li></ol><p id="017f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这就是你所需要的。</p><h2 id="e0cb" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">1.第一步</h2><p id="da5f" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">首先让我们安装一个NPM包，它允许你读取一个配置JSON和你的合同来生成你的资源。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="b069" class="kk kl hi lz b fi md me l mf mg">npm i ng-openapi-gen-cli --save-dev<br/>or<br/>yarn add ng-openapi-gen-cli -D</span></pre><h2 id="0908" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">2.第二步</h2><p id="31a4" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">在项目根目录下创建一个名为generate-types的目录。你可以随意命名它，我建议把它从你的代码中分离出来，放在你的项目根目录中。以便在构建过程中使事情变得更容易。</p><p id="c41d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> * </strong>如果你正在使用monorepo结构，那么确保它在你的UI应用程序的根目录下。</p><h2 id="53ea" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">3.第三步</h2><p id="5b44" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">在generate-type目录下创建一个JSON文件'<strong class="jq hj"> test-config.json </strong>'。该文件将包含生成您的文件所需的所有配置。</p><p id="9978" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是它的外观示例:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="c29f" class="kk kl hi lz b fi md me l mf mg">{<br/>  "$schema": "../../../node_modules/ng-openapi-gen/ng-openapi-gen-schema.json",<br/>  "input": "&lt;uri-for-your-open-api-docs-contract&gt;",<br/>  "output": "apps/learn-nestjs-task-management/generate-typings/api",<br/>  "ignoreUnusedModels": false,<br/>  "module": "GeneratedApiModule",<br/>  "serviceSuffix": "ApiService",<br/>  "modelSuffix": "ApiModel",<br/>  "indexFile": true<br/>}</span></pre><p id="5a63" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我给你解释一下这个物体是做什么的</p><ol class=""><li id="da44" class="lf lg hi jq b jr js ju jv jx mh kb mi kf mj kj lm ln lo lp bi translated"><strong class="jq hj"> $schema: </strong>它引用ng-open-api-gen的父原理图，该原理图包含生成资源所需的所有细节。</li><li id="eb6f" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated"><strong class="jq hj">输入:</strong>这是我们添加openapi/swagger契约的uri的地方。它应该看起来像“&lt;域&gt; /api-docs”。</li><li id="4bfe" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated"><strong class="jq hj">输出:</strong>您想要生成文件的位置。所以在这个例子中，所有的文件都将在“generate-typing/API”目录中生成。我建议使用这种结构，因为它让你更容易在一个地方找到所有的模型。</li><li id="5e49" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated"><strong class="jq hj">模块:</strong>这允许你为所有生成的资源创建一个模块，使得在你的应用或模块中导入该模块变得容易。</li><li id="1760" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated"><strong class="jq hj"> serviceSuffix: </strong>默认生成所有不带后缀的服务。建议在它后面加上后缀，以便更容易区分UI服务和生成的API服务。</li><li id="11cc" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated"><strong class="jq hj">型号后缀:</strong>类似于<strong class="jq hj">服务后缀，但仅适用于型号。</strong></li><li id="025c" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">没有这个属性它也能工作。但是如果这个属性被设置为true，这将生成一个indexFile，它引用所有您生成的文件，并且可以添加到tsconfig.json中。</li></ol><h2 id="8243" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">4.第四步</h2><p id="7b22" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">既然我们已经得到了我们需要的一切。</p><p id="686e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在您的终端中运行此命令。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="c86a" class="kk kl hi lz b fi md me l mf mg">ng-openapi-gen -c apps/savings-presentation/generate-typings/test/test-config.json</span></pre><p id="66b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">瞧啊。！现在您可以看到在generate-typing/API目录中生成的所有文件。</p><h2 id="2ee7" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">5.第五步</h2><p id="9d2a" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">现在让我们将它连接到您的应用程序。</p><p id="78e9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您将看到一个生成的模块“GeneratedApiModule”。现在将它导入app.module.ts。</p><p id="1033" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong>生成的服务将拥有到每个控制器/资源的端点的路径，但是您仍然必须定义您的API的域。进行以下更改，您应该能够使用这些服务进行http呼叫。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="693c" class="kk kl hi lz b fi md me l mf mg">GeneratedApiModule.forRoot({<br/>  rootUrl: `${environment.apiServer.domain}/&lt;path&gt;`<br/>})</span></pre><p id="c3de" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们都准备好了。只需使用服务并调用必要的方法来无缝调用API，而不必担心UI会与后端不同步。</p><p id="c397" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">谢谢你，编码快乐！！</strong></p><p id="405f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">接下来:</strong></p><ol class=""><li id="d641" class="lf lg hi jq b jr js ju jv jx mh kb mi kf mj kj lm ln lo lp bi translated">如何将其扩展到多环境和Monorepo结构，并将其集成到angular build命令中。</li><li id="599e" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">如何使用生成的服务进行api调用。</li><li id="69b6" class="lf lg hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">将此整合到datorama/akita，使其在国家管理方面更加强大。</li></ol></div></div>    
</body>
</html>
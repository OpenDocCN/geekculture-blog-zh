<html>
<head>
<title>Weather Forecast using Deep Learning Model Prophet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习模型Prophet的天气预报</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/weather-forecast-using-deep-learning-model-prophet-72bc878be48b?source=collection_archive---------13-----------------------#2021-05-13">https://medium.com/geekculture/weather-forecast-using-deep-learning-model-prophet-72bc878be48b?source=collection_archive---------13-----------------------#2021-05-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="27d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">你有多少次试图准确预测销售额、天气或股票？很多时候，我们可能会找到一个好的神经模型，但我们无法调整它的超参数。深度学习模型PROPHET将在开发预测模型方面对初学者有用。我们开始吧！</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jm"><img src="../Images/ddb6013a9e551a104d3edb6972156d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*hA_V82IoUeGrfvYg1vnkwQ.png"/></div><figcaption class="ju jv et er es jw jx bd b be z dx">Prophet</figcaption></figure><p id="0563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是先知模型？</strong></p><p id="cec4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet正在评估用R和Python执行的方法。它是快速的，并给出完全计算机化的量表，可以由信息研究人员和检查人员手动调整。</p><p id="7134" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Prophet是一种基于加法模型预测时间序列数据的程序，其中非线性趋势符合每年、每周和每天的季节性，加上假日影响。这种方法在时间安排上效果最好，因为它有可靠的偶然影响和一些真实的信息。Prophet对模式中缺失的信息和运动非常敏感，通常能很好地处理异常情况。Prophet是由脸书核心数据科学小组提供的开源编程。它可以在CRAN和PyPI上下载。</p><p id="44db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">先知的优点:</strong></p><p id="dc57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.准确快速</p><ul class=""><li id="b8b8" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">在脸书，Prophet被广泛应用于为规划和目标设定创建可靠的预测。</li><li id="3932" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">他们发现，在大多数情况下，与其他方法相比，它的性能更好。</li></ul><p id="a1de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.全自动的</p><ul class=""><li id="0aeb" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">无需人工操作即可对杂乱的数据做出合理的预测。</li><li id="b1f4" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">Prophet对异常值、缺失数据和时间序列中的剧烈变化非常稳健。</li></ul><p id="2d3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.可调预测</p><ul class=""><li id="6208" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">Prophet程序为用户提供了许多调整预测的可能性。</li><li id="706f" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">您可以通过添加您的领域知识，使用人类可理解的参数来改进您的预测。</li></ul><p id="9f16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.有R或Python版本</p><ul class=""><li id="55c1" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">使用任何你觉得舒服的语言来获得预测。</li></ul><p id="93c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">公式</strong></p><p id="4c59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="km">先知方程是如何工作的？</em></p><p id="c504" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打破脸书开源时间序列预测程序背后的方程式。</p><p id="864e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该方法利用具有三个主要模型段的可分解时间安排模型:趋势、季节性和假期。</p><p id="b77f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">y(t) = g(t) + s(t) + h(t) + e(t)</p><p id="1433" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中:</p><ul class=""><li id="3ae7" class="jy jz hi ih b ii ij im in iq ka iu kb iy kc jc kd ke kf kg bi translated">g(t):趋势模拟非周期性变化，即随时间的增长</li><li id="0623" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">季节性呈现周期性变化，即每周、每月、每年</li><li id="bf3a" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">h(t):节假日的影响</li><li id="4416" class="jy jz hi ih b ii kh im ki iq kj iu kk iy kl jc kd ke kf kg bi translated">e(t):涵盖模型不适应的误差</li></ul><p id="53a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">理解代码:</strong></p><p id="945f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。安装软件包:</strong></p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="ae0c" class="ks kt hi ko b fi ku kv l kw kx">pip install chart_studio<br/>pip install fbprophet</span></pre><p id="259a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。导入库:</strong></p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="7fc3" class="ks kt hi ko b fi ku kv l kw kx">import pandas as pd<br/>import numpy as np<br/>import chart_studio.plotly as plotly<br/>import plotly.figure_factory as ff<br/>from plotly import graph_objs as go<br/>from fbprophet import Prophet<br/>from fbprophet.plot import plot_plotly</span></pre><p id="b794" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.正在加载数据集:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="04c6" class="ks kt hi ko b fi ku kv l kw kx">df = pd.read_csv(‘/content/weather_temperature_yilan.csv’)<br/>df.head()</span></pre><p id="1d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.绘制原始数据:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="1993" class="ks kt hi ko b fi ku kv l kw kx">fig = go.Figure()</span><span id="0cff" class="ks kt hi ko b fi ky kv l kw kx">fig.add_trace(go.Scatter(x=df.Date, y=df[‘Temperature’], name=”temperature”,line_color=’green’))</span><span id="caa8" class="ks kt hi ko b fi ky kv l kw kx">fig.layout.update(title_text=’Time Series data with Rangeslider’,xaxis_rangeslider_visible=True)</span><span id="684b" class="ks kt hi ko b fi ky kv l kw kx">fig</span></pre><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es kz"><img src="../Images/8c3c7691c686ebcbd2fc92d21b5d9f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*O3tQmYxg2wcZK3-D.PNG"/></div></figure><p id="b512" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.将数据帧分为X和y:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="da7b" class="ks kt hi ko b fi ku kv l kw kx">X = df[[‘Date’, ‘Temperature’]]<br/>y = df.iloc[:,1]</span></pre><p id="531f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.将数据加载到“ds”和“y”中:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="4a00" class="ks kt hi ko b fi ku kv l kw kx">train_df = pd.DataFrame()<br/>train_df[‘ds’] = pd.to_datetime(X[“Date”])<br/>train_df[‘y’]=y<br/>train_df.head(2)</span></pre><p id="1dd8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.应用和拟合Prophet模型:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="269e" class="ks kt hi ko b fi ku kv l kw kx">model = Prophet()<br/>model.fit(train_df)<br/>future = model.make_future_dataframe(periods=365)<br/>future.tail(2)</span></pre><p id="552b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.预测数据:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="9e47" class="ks kt hi ko b fi ku kv l kw kx">forecast = model.predict(future)<br/>fig1 = plot_plotly(model, forecast)<br/>fig1</span></pre><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es la"><img src="../Images/7fa6a6501cf5b9d68ebe969cf6ea5c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/0*yyoK-nm4SngMJO1O.PNG"/></div></figure><p id="ad95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9.组件式预测:</p><pre class="jn jo jp jq fd kn ko kp kq aw kr bi"><span id="44e2" class="ks kt hi ko b fi ku kv l kw kx">#plot component wise forecast<br/>fig2 = model.plot_components(forecast)</span></pre><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lb"><img src="../Images/800ddfba9ff36e9f98a19f193573c24c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*gX0ks0kz9JuWmyye.png"/></div></figure><p id="9837" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用几行代码，你就可以很好地预测，而且，我们预测了它每周、每月和每年的趋势。您可以从我的GitHub个人资料中访问代码:<a class="ae lc" href="https://github.com/muskaanpirani/Weather_Forecast.git" rel="noopener ugc nofollow" target="_blank"> <em class="km">天气_预报</em> </a></p><p id="1ccd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p><p id="afc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以通过<a class="ae lc" href="https://www.linkedin.com/in/muskaanpirani/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae lc" href="https://github.com/muskaanpirani" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae lc" href="https://muskaanpirani.medium.com/" rel="noopener"> Medium </a>联系我。</p></div></div>    
</body>
</html>
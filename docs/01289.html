<html>
<head>
<title>Web Components with React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有React挂钩的Web组件</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/web-components-with-react-hooks-f0e2a62de323?source=collection_archive---------23-----------------------#2021-04-04">https://medium.com/geekculture/web-components-with-react-hooks-f0e2a62de323?source=collection_archive---------23-----------------------#2021-04-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ab24e3b8d7a18c089ea6453ce5581197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYUkO3vHbdfe49nBnuAwog.jpeg"/></div></div></figure><h2 id="358b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">简介:</h2><p id="c8a5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">当创建一个面向未来的基于组件的设计系统时，Web组件非常有用，该系统可以跨多个产品进行互操作和共享。</p><p id="d137" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">不幸的是，React是少数几个不完全支持Web组件的现代库之一，尤其是在处理事件时。原因是React实现了自己的合成事件系统，它不能监听来自Web组件的DOM事件。</p><p id="0b26" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">好消息是，您不需要使用React从头开始重写所有的设计系统。有一个简单的解决方法，需要创建瘦包装器并订阅DOM事件。</p><p id="afab" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">在这个例子中，我使用<a class="ae ko" href="https://wiredjs.com/" rel="noopener ugc nofollow" target="_blank">连接的元素</a>使一个输入Web组件与React一起工作。有线元素是一组手绘的、粗略的常见UI元素。该库使用<a class="ae ko" href="https://lit-element.polymer-project.org/" rel="noopener ugc nofollow" target="_blank"> LitElement </a>来创建Web组件。</p><p id="18d3" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">此外，在本文中，我将专门解决通过React组件包装器捕获DOM事件的问题。如果您想查看所有关于React和Web组件支持的未决问题，请参考custom-elements-everywhere.com<a class="ae ko" href="https://custom-elements-everywhere.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="df1b" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">概述:</h2><ol class=""><li id="40cf" class="kp kq hi jq b jr js jv jw jb kr jf ks jj kt ki ku kv kw kx bi translated">创建React应用</li><li id="1b68" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">安装有线元件</li><li id="ea6a" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">导入有线输入元素</li><li id="23c1" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">创建组件包装</li><li id="2046" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki ku kv kw kx bi translated">测试输入“onChange”事件</li></ol><h2 id="9f3e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">1.创建React应用:</h2><p id="5158" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">创建一个新的<a class="ae ko" href="https://create-react-app.dev/docs/getting-started/" rel="noopener ugc nofollow" target="_blank"> React应用</a>。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="2df3" class="iq ir hi li b fi lm ln l lo lp">npx create-react-app react-webcomponent</span></pre><h2 id="3b4e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">2.安装有线元件:</h2><p id="d696" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">关于连线元素的完整文档可以在它们的主<a class="ae ko" href="https://github.com/rough-stuff/wired-elements" rel="noopener ugc nofollow" target="_blank">库</a>中找到</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="9b17" class="iq ir hi li b fi lm ln l lo lp">npm i wired-elements</span></pre><h2 id="2c2f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">3.导入有线输入元素:</h2><p id="bcab" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">在这一节中，我们将添加一个没有包装器的有线输入元素，并展示如何在React不检测DOM事件时不触发“onChange”事件。</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="cc3d" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">上面代码的快速总结:</p><ul class=""><li id="958e" class="kp kq hi jq b jr kj jv kk jb ls jf lt jj lu ki lv kv kw kx bi translated">重用App.js文件并清理未使用的代码</li><li id="c8ed" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">导入的“有线元素”</li><li id="d64a" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">将<wired-input>添加到模板中</wired-input></li><li id="2fd3" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">创建了一个句柄输入函数，用于在触发“onChange”时打印输入的值</li></ul><p id="53ba" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">不出所料，当输入时，控制台不打印任何内容:</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/6148529ba9f88f5a1fdd8dc6521881fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*Wz-3pvsI9NFIclKR.gif"/></div></figure><h2 id="7245" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">4.创建组件包装:</h2><p id="597f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">让我们添加一个新的react组件，并将其命名为“WiredInput.js”。它将订阅输入事件并从组件props中调用“onChange”函数</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="c577" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">下面是我们在上面的代码中所做的一些细节:</p><ul class=""><li id="0f80" class="kp kq hi jq b jr kj jv kk jb ls jf lt jj lu ki lv kv kw kx bi translated">在第5行，使用“createRef”创建了对<wired-input>元素的引用，并将其命名为“inputRef”</wired-input></li><li id="b69a" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">在第6行中，添加了一个“useEffect”函数，当DOM准备好的时候就会被触发(这样我们可以确保“inputRef”不为空)</li><li id="f5ce" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">第7行，订阅输入事件</li><li id="7a67" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">第8行，检查“onChange”是否未定义，然后调用函数并传递事件给它</li><li id="f005" class="kp kq hi jq b jr ky jv kz jb la jf lb jj lc ki lv kv kw kx bi translated">第13行，添加了带有“inputRef”的有线输入元素</li></ul><h2 id="f5c5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">5.测试输入“onChange”事件</h2><p id="f44f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki hb bi translated">现在我们已经准备好了包装组件，让我们把它付诸行动吧！</p><p id="7fe5" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">首先，让我们更新app.js以使用新组件:</p><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="3e90" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">下面是我们最终工作代码的演示:</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/c7bb129cf3c7fc5e05bde1f331cf2947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*yTAD5Eid3Mb8q057.gif"/></div></figure><p id="61af" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">您可以在这里访问<a class="ae ko" href="https://github.com/muhimasri/react-webcomponent-example" rel="noopener ugc nofollow" target="_blank">完整的存储库。我希望你喜欢从这篇文章中学习，如果你有任何问题，请在下面留下评论。</a></p></div><div class="ab cl lx ly gp lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hb hc hd he hf"><p id="4286" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated">更多相关文章，你可以<a class="ae ko" href="https://muhimasri.com/" rel="noopener ugc nofollow" target="_blank">访问我的网站</a>或<a class="ae ko" href="https://muhimasri.com/signup/" rel="noopener ugc nofollow" target="_blank">注册获取最新文章和更新</a>。再见😊</p><p id="9ff7" class="pw-post-body-paragraph jo jp hi jq b jr kj jt ju jv kk jx jy jb kl ka kb jf km kd ke jj kn kg kh ki hb bi translated"><em class="me">原载于2021年4月4日https://muhimasri.com</em><em class="me"/><a class="ae ko" href="https://muhimasri.com/blogs/web-components-with-react-hooks/" rel="noopener ugc nofollow" target="_blank"><em class="me">。</em></a></p></div></div>    
</body>
</html>
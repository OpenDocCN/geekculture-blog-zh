<html>
<head>
<title>Svelte Gotcha — Tailwind Inline Styles</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">苗条的Gotcha——顺风直列风格</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/svelte-gotcha-tailwind-inline-styles-a666f8278789?source=collection_archive---------35-----------------------#2021-09-27">https://medium.com/geekculture/svelte-gotcha-tailwind-inline-styles-a666f8278789?source=collection_archive---------35-----------------------#2021-09-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cf872dddcaa5a161a853b2d6d7112362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y05RwPy-5oj2SNf1.png"/></div></div></figure><p id="d990" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Svelte附带了一些小的调整和代码片段，使常见的UI行为对你我来说都很容易实现。其中一个行为是应用自定义css样式来强调一个DOM元素，例如这个按钮或链接是<em class="jo">“活动的”</em>。来自《苗条教程》本身<a class="ae jp" href="https://svelte.dev/tutorial/classes" rel="noopener ugc nofollow" target="_blank">https://svelte.dev/tutorial/classes</a></p><blockquote class="jq jr js"><p id="cbb4" class="iq ir jo is b it iu iv iw ix iy iz ja jt jc jd je ju jg jh ji jv jk jl jm jn hb bi translated"><em class="hi">这是UI开发中非常常见的模式，因此Svelte包含了一个特殊的指令来简化它</em></p></blockquote><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="1f6a" class="kf kg hi kb b fi kh ki l kj kk">&lt;script&gt;<br/>  let current = false;<br/>&lt;/script&gt;<br/>&lt;style&gt;<br/>  .active {<br/>    background-color: #ff3e00;<br/>    color: white;<br/>}<br/>&lt;/style&gt;<br/>&lt;button class:active="{current}" on:click="{() =&gt; current = true}"&gt;<br/>Promote<br/>&lt;/button&gt;</span></pre><p id="2adc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了逐步完成上述示例，我们有:</p><ol class=""><li id="fe47" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn kq kr ks kt bi translated">一个名为<code class="du ku kv kw kb b">current</code>的脚本变量，其值为<code class="du ku kv kw kb b">false</code></li><li id="f293" class="kl km hi is b it kx ix ky jb kz jf la jj lb jn kq kr ks kt bi translated">一个带有内嵌<code class="du ku kv kw kb b">on:click</code>处理程序的按钮，用于将<code class="du ku kv kw kb b">current</code>脚本值设置为等于<code class="du ku kv kw kb b">true</code></li><li id="8772" class="kl km hi is b it kx ix ky jb kz jf la jj lb jn kq kr ks kt bi translated">最后，一个内嵌的类选择器，它说，如果<code class="du ku kv kw kb b">current==true</code>，那么将<code class="du ku kv kw kb b">active</code>的css样式应用到这个按钮。</li></ol><p id="b518" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总而言之，这是一个很好的小指令，开箱即用。在上面的例子中，我们内联了<code class="du ku kv kw kb b">active</code>，但是你当然可以内联任何你有的样式。如果你像我一样使用顺风，你可以直接应用顺风风格，如下所示:</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="efef" class="kf kg hi kb b fi kh ki l kj kk">&lt;script&gt;<br/>  let current = false;<br/>&lt;/script&gt;<br/>&lt;style&gt;<br/>  // No need for an explicit component style. Instead apply<br/>  // the Tailwind styles directly as border and primary are <br/>  // globally available.<br/>&lt;/style&gt;<br/>&lt;button class:border-primary="{current}" on:click="{() =&gt; current = true}"&gt;Promote&lt;/button&gt;</span></pre><p id="78b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">同样，这一切都按预期工作。在本地以dev模式运行它将会得到您想要的结果。</p><h2 id="cad6" class="kf kg hi bd lc ld le lf lg lh li lj lk jb ll lm ln jf lo lp lq jj lr ls lt lu bi translated">但是为什么没有投入生产呢？</h2><p id="579d" class="pw-post-body-paragraph iq ir hi is b it lv iv iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn hb bi translated">然而，在生产构建和部署中，顺风<code class="du ku kv kw kb b">border-primary</code>风格<strong class="is hj"> <em class="jo">可能不适用？在进一步的检查中，打开您的开发工具并检查生产中的DOM元素，您可以交互地看到细长的指令<strong class="is hj"> <em class="jo">被正确地应用了</em> </strong>，但是仍然没有视觉上的变化生效？</em></strong></p><p id="a1fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是为什么这个问题如此棘手的原因！这个指令在99.99%的时候都是有效的，只要应用的CSS定义也应用在你的模板中的其他地方，那么它就是全局样式的一部分。这是怎么回事？</p><p id="506a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Svelte under the hood(这里用的是Svelte 3.0)使用<a class="ae jp" href="https://www.rollupjs.org/" rel="noopener ugc nofollow" target="_blank"> rollupjs </a>来编译你的应用js。如果您检查您的默认<code class="du ku kv kw kb b">rollup.config.js</code>内容，您应该在您的插件部分看到类似于</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="e030" class="kf kg hi kb b fi kh ki l kj kk">plugins: [<br/>  svelte({<br/>    // enable run-time checks when not in production<br/>    dev: !production,<br/>    preprocess: sveltePreprocess({ postcss: true }),<br/>    .....</span></pre><p id="fb06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，在构建时，rollup将对css样式进行预处理，根据需要缩小并删除未使用的样式。postcss处理的配置可以在<code class="du ku kv kw kb b">postcss.config.js</code>文件中找到。你的Tailwind插件部分的关键部分是在生产中，通过了<code class="du ku kv kw kb b">purgecss</code>选项，例如:</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="3315" class="kf kg hi kb b fi kh ki l kj kk">module.exports = {<br/>  plugins: [<br/>    require("tailwindcss"), ...(production ? [purgecss] : [])<br/>  ],<br/>};</span></pre><p id="1e81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ku kv kw kb b">@fullhuman/postcss-purgecss</code>包实际上很好地剥离了不需要的样式，并将你的css编译成尽可能小的文件。但是当然<code class="du ku kv kw kb b">@fullhuman/postcss-purgecss</code>是一个独立的包，不属于苗条生态系统的一部分。它不知道这个简单的内联样式指令，因此，没有基于确保内联样式在后期处理中不被剥离的规则。</p><h2 id="92da" class="kf kg hi bd lc ld le lf lg lh li lj lk jb ll lm ln jf lo lp lq jj lr ls lt lu bi translated">修复</h2><p id="5fa4" class="pw-post-body-paragraph iq ir hi is b it lv iv iw ix lw iz ja jb lx jd je jf ly jh ji jj lz jl jm jn hb bi translated">好的，所以我们想使用这个细长的内嵌风格指令，我们也想使用一个现有的顺风风格来工作。我们怎样才能既有蛋糕又能吃掉它呢？这其实很简单。我们只需要创建一个显式的组件样式，并使用Tailwind @apply指令。示例:</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="eb68" class="kf kg hi kb b fi kh ki l kj kk">&lt;script&gt;<br/>  let current = false;<br/>&lt;/script&gt;<br/>&lt;style&gt;<br/>  .active {<br/>    @apply border-primary;<br/>  } <br/>&lt;/style&gt;<br/>&lt;button class:active="{current}" on:click="{() =&gt; current = true}"&gt;   Promote&lt;/button&gt;</span></pre><p id="ea7a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过这种方式，样式将<strong class="is hj">永远不会</strong>通过构建过程被剥离，作为其苗条组件样式块的一部分。我们仍然可以对所有的顺风风格使用<code class="du ku kv kw kb b">@apply</code>,而不必制定定制的css规则。赢了。</p></div><div class="ab cl ma mb gp mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="hb hc hd he hf"><p id="cb1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">最初发表于</em><a class="ae jp" href="https://www.kylehq.com/2021/09/svelte-gotcha-tailwind-inline-styles/" rel="noopener ugc nofollow" target="_blank"><em class="jo">https://www.kylehq.com</em></a><em class="jo">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Grafana Dashboards for Windows Servers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于Windows服务器的Grafana仪表板</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/grafana-dashboards-for-windows-servers-80697d59d1dd?source=collection_archive---------4-----------------------#2021-04-17">https://medium.com/geekculture/grafana-dashboards-for-windows-servers-80697d59d1dd?source=collection_archive---------4-----------------------#2021-04-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="bd42" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解两个关键的服务器性能指标</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1269b644e7f57540a1194e7985ba01dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YZ9KNVbQ49brmdCF"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@ibrahimboran?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ibrahim Boran</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7d61" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Prometheus和Grafana正在成为监控linux服务器的事实上的标准。你会发现无数的指南，告诉你如何在10分钟内完成普罗米修斯和格拉夫纳的比赛。这包括开箱即用的漂亮的交互式仪表盘。</p><p id="9646" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是如何监控Windows服务器呢？如何使用Prometheus和Grafana设置窗口的指导空间要空得多。好消息是你仍然可以用Prometheus和Grafana监控你的windows服务器。坏消息是，现成可用的指标和Grafana仪表板的种类非常有限。</p><p id="b618" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是不要绝望。在这个操作指南中，我将向您介绍最流行的用于Windows服务器的Grafana仪表板。您将大致了解如何读取有关CPU和内存的仪表板数据。</p><h1 id="4731" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated"><strong class="ak">仪表盘</strong></h1><p id="64e5" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">关于Grafana的典型帖子关注于设置数据源、导入仪表板和调整窗格的“外观和感觉”。我将向您介绍如何从Grafana仪表盘中获益，而不是介绍技术设置部分。最后，理解仪表板告诉你的性能是最有价值的部分。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lh"><img src="../Images/000b156425e07fd6ef774559625cb355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddgBlyv7fblxxsyAIrZfgA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Grafana dashboard</figcaption></figure><p id="25dc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">用于Windows服务器的最受欢迎的Grafana仪表板被称为“Windows Node ”,可以从Grafana网站<a class="ae jn" href="https://grafana.com/grafana/dashboards/2129" rel="noopener ugc nofollow" target="_blank">这里</a>下载。这款仪表盘与WMI exporter 0.12兼容，你可以在这里下载<a class="ae jn" href="https://github.com/prometheus-community/windows_exporter/releases/tag/v0.12.0" rel="noopener ugc nofollow" target="_blank">，并按照Github页面上的</a><a class="ae jn" href="https://github.com/prometheus-community/windows_exporter/tree/v0.12.0" rel="noopener ugc nofollow" target="_blank">说明</a>进行安装。</p><p id="ae56" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">“windows节点”Grafana dashboard包含许多面板，显示Windows服务器的各种性能。CPU和内存是目前最重要的服务器资源。为了理解这些，我们需要更深入地了解在Windows中如何管理CPU和内存。</p><h2 id="9f87" class="li kl hi bd km lj lk ll kq lm ln lo ku jx lp lq kw kb lr ls ky kf lt lu la lv bi translated">中央处理器</h2><p id="4c6d" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">Grafana仪表板中的CPU面板如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lw"><img src="../Images/3355c11f6e6a2e72d6a179e89cf9f69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*56x0Ay54vjYPanThpHcXmw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">CPU Load panel</figcaption></figure><p id="42f5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这个面板显示了CPU在一段时间内所做的工作。</p><p id="9729" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在左侧，您可以看到顶部值为4的Y轴。在该特定示例中，被监控的服务器具有4核的单个处理器(例如，4个逻辑处理器)，因此Y轴的最大值是4。</p><p id="92b2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在面板的右侧，我们看到代表处理器5种不同活动的图例:<em class="lx"> dcp、空闲、中断、特权、用户</em>。</p><p id="3b57" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们仔细看看这个传说:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/3bbef0536eebd4d7be5da0500072c7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*yl4UGvBYF7j9DDgYr28LWQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">CPU Load panel legend</figcaption></figure><p id="3904" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这些活动的另一个名称是“处理器模式”。当我们说“处理器处于X模式”时，我们的意思是处理器正在做X类型的工作。</p><p id="13c7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们来看看这些模式的定义。</p><p id="0410" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lx">用户模式</em>代表为应用程序和不同子系统所做的工作。我们在服务器上运行的典型应用程序是在<em class="lx">用户模式</em>下执行的。如果您的应用程序是计算密集型的，您将会看到用户模式指标激增。</p><p id="19b7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lx">特权模式</em>是处理器为Windows操作系统做的工作。当调用一个Windows系统服务时，该服务通常会运行在<em class="lx">特权模式</em>下，以获得对系统私有数据的访问权。此类数据受到保护，不会被在<em class="lx">用户模式</em>下执行的线程访问。</p><p id="b920" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lx">中断模式</em>是Windows系统为处理硬件请求而做的一种工作。高水平的中断可能表明硬件或驱动程序有问题。</p><h2 id="a343" class="li kl hi bd km lj lk ll kq lm ln lo ku jx lp lq kw kb lr ls ky kf lt lu la lv bi translated">记忆</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/4f906965e920f8157bcc2b1003d633b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2j5WhTdamPQg-4VPFXA9Kg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Memory panel legend</figcaption></figure><p id="02d6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">仪表板中的内存窗格显示有关服务器内存的三个关键指标的信息:</p><ul class=""><li id="d9c7" class="ma mb hi jq b jr js ju jv jx mc kb md kf me kj mf mg mh mi bi translated">虚拟内存</li><li id="29c4" class="ma mb hi jq b jr mj ju mk jx ml kb mm kf mn kj mf mg mh mi bi translated">物理内存</li><li id="93e9" class="ma mb hi jq b jr mj ju mk jx ml kb mm kf mn kj mf mg mh mi bi translated">自由物理内存</li></ul><p id="1d4f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">物理内存是安装在服务器上的内存(RAM)。应用程序的进程不直接访问物理内存，只有操作系统才这样做。相反，这些进程使用由操作系统创建的虚拟内存。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/89eae6b9c769e0d3f2ad419959ce169a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6a_CQFH15GETpBvEkzn6Tw.png"/></div></div></figure><p id="d463" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为什么我们需要虚拟内存？进程有时需要比可用物理内存更多的内存。在这种情况下，操作系统会将进程顺序加载到物理内存中。它等待每个进程结束，然后加载下一个进程。这种切换对所有使用虚拟内存的进程重复进行。</p><p id="aa2e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为此，操作系统使用了一种叫做<em class="lx">分页</em>的技术。当服务器没有足够的物理内存用于所有进程时，物理内存中的部分信息会保存到一个名为P <em class="lx"> age File </em>的磁盘文件中。</p><h1 id="77ca" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">总结</h1><p id="3674" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">现在，您应该已经了解了如何阅读CPU和内存消耗图表。在评估服务器的性能瓶颈时，这些指标涵盖了您80%的需求(很好地说明了帕累托原则)。</p><p id="0d02" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你需要深入观察你的应用程序如何影响CPU和内存，看看<a class="ae jn" href="https://prometheus.io/docs/instrumenting/clientlibs/" rel="noopener ugc nofollow" target="_blank"> Prometheus客户端库</a>。您可以将这些库直接添加到您的应用程序中，以收集应用程序运行时指标。运行时度量通常有助于回答性能瓶颈调查中的“为什么”问题。</p></div></div>    
</body>
</html>
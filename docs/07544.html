<html>
<head>
<title>Build a Basic App in React, Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在React中构建一个基本的应用程序，第二部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/build-a-basic-app-in-react-part-ii-c70e10f7e850?source=collection_archive---------20-----------------------#2021-09-21">https://medium.com/geekculture/build-a-basic-app-in-react-part-ii-c70e10f7e850?source=collection_archive---------20-----------------------#2021-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a5b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候回顾一下React <strong class="ih hj"> state </strong>并将其整合到我们正在构建的待办事项应用中了。如果你还没有，一定要<a class="ae jd" rel="noopener" href="/@nataliebarba/build-a-basic-app-in-react-part-i-9c6c27dbfc41">看看这篇文章的第一部分</a>，它评论了我们开始构建这个应用时<strong class="ih hj">的组件和道具</strong>。</p><p id="d11d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在进入状态。</p><h1 id="5ff7" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">快速概述</strong></h1><p id="192b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">那么什么是国家呢？在React中，<strong class="ih hj">状态</strong>是随着用户与应用程序交互而变化的动态数据。状态<strong class="ih hj"> </strong>可以在组件的生命周期中改变，这一事实使得它与<strong class="ih hj">道具</strong>不同——道具依赖于父组件将静态信息传递给它们的子组件。</p><p id="745f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，为了在代码中处理状态，您必须导入React <strong class="ih hj"> useState钩子</strong>。什么是钩子？<a class="ae jd" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank"> React文档</a>描述得最好。它是“一个特殊的功能，可以让你‘挂钩’反应特征。”例如，useState是为React类组件构建的一个特性。我们正在使用功能组件构建我们的应用程序，这些组件不包含相同的功能，但我们可以通过挂钩导入我们需要的功能，如useState。要了解更多信息，请务必查看文档。</p><p id="5e33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实现useState如下所示:</p><blockquote class="kh ki kj"><p id="511f" class="if ig kk ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">从“react”导入React、{ use state }；</p><p id="1a1f" class="if ig kk ih b ii ij ik il im in io ip kl ir is it km iv iw ix kn iz ja jb jc hb bi translated">函数示例(){ <br/> //声明一个新的状态变量，我们就称之为“count”<br/>const[count，set count]= useState(0)；<br/>……<br/>}</p></blockquote><p id="f8d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在左边，我们有两个变量。首先是状态变量，其次是更新状态的setter函数。在右边，我们将状态变量设置为我们决定的初始值。所以对于上面的例子，我们最初将count设置为0。稍后，我们可以说setCount(5)将计数更新为5。我们将在代码中看到更多的例子。让我们开始吧。</p><h1 id="4560" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">目标</strong></h1><p id="7296" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们将为我们的待办事项应用添加两个关键功能:</p><ol class=""><li id="62b8" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">能够将任务标记为完成或“完成”，并将其从我们的任务列表中删除。</li><li id="0220" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">添加新任务的能力</li></ol><p id="bf4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过使用状态来实现这两个目标。</p><h1 id="82fc" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">规划国家居住地</strong></h1><p id="6190" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">当我们思考如何实现我们的目标时，我们应该问自己，我们需要操纵数据吗？如果有，哪些数据？</p><p id="4cd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无论我们想要删除一个现有的任务还是添加一个新的任务，我们都需要操作我们迭代的数组，以便在页面上呈现每个待办事项元素。</p><p id="98e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望在组件的生命周期内，根据用户的操作改变数据。听起来像州政府。这个国家应该生活在哪里？这四个问题帮助我们做出决定:</p><ul class=""><li id="fd25" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc lc ku kv kw bi translated">识别每一个基于该状态呈现某些内容的组件</li><li id="e142" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc lc ku kv kw bi translated">找到一个共同的所有者组件(一个单独的组件，组件层次结构中所有需要该状态的组件)</li><li id="db59" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc lc ku kv kw bi translated">要么是共同所有者，要么是更高层的另一个组件</li><li id="3ff1" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc lc ku kv kw bi translated">如果你找不到一个值得拥有的组件，就需要一个新的组件</li></ul><p id="b9cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TaskList.js和NewTaskForm.js都需要使用这个由用户操作更新的数组。虽然我们为NewTaskForm组件创建了一个文件，但是我们既没有构建它，也没有将它导入到任何地方，所以让我们花点时间来处理它。</p><h1 id="2909" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> NewTaskForm.js </strong></h1><p id="8872" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们可以通过为新任务添加一个输入区域并添加一个提交按钮来创建一个非常简单的表单，如下所示</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ld"><img src="../Images/5e881e29f94f418f9b28478a8c40f1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/0*dQDkaHdga6HXHoH1"/></div></figure><p id="b161" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们必须将它导入到我们的homebase，App.js中。</p><h1 id="172d" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> App.js </strong></h1><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ll"><img src="../Images/62a49a65b303596d8e2b949b465ad3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/0*0RZug2DUMtyWyWU4"/></div></figure><p id="c39a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道新的TaskForm不需要访问我们之前构建的数据todos，所以还不需要传入props。</p><h1 id="2961" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">规划状态续</strong></h1><p id="f665" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在我们已经设置好了所有的组件，我们可以返回并确定我们的状态将位于何处——我们将通过用户操作来操作的待办事项数组的状态。正如我们提到的，NewTaskForm.js和TaskList.js都需要访问这个数组，所以我们希望我们的状态位于它们共享的父组件App.js中。</p><h1 id="f933" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> App.js </strong></h1><p id="bd7c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">记住，如果我们想要使用状态，我们必须导入use state钩子。然后，让我们为我们一直提到的待办事项数组创建一个状态变量。我们将该数组的初始值设置为从todosData.js导入的数组。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lm"><img src="../Images/07d1fe9c75d9a39ee854bbcd65e4aae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/0*YpPzdklvBI0rs8wW"/></div></figure><p id="037e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们一次处理一个用户动作，从点击“Done”按钮开始。</p><p id="985f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道，当我们单击“Done”时，我们会想要从todoArray中删除一个元素。我们必须创建一个管理这个逻辑的函数，并且任何时候我们创建一个函数来管理一个状态的操作，我们都应该在与我们定义的状态相同的组件中这样做。</p><p id="f2bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建一个名为deleteItem的函数，它将itemToDelete作为参数。我们将创建原始todoArray的一个副本，减去我们希望使用filter方法删除的项目。我们可以假设没有两个待办事项会完全相同，并根据待办事项的文本描述进行过滤。最后，我们将使用setter函数将todoArray更新为更新后的数组。</p><p id="1dc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们不是将原始数据集todos向下传递到TaskList.js，而是要传递随用户操作更新的数组todoArray。我们还希望传递新定义的deleteItem函数，以便(最终)我们的事件处理函数可以调用它。我们更新的App.js应该如下:</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es ln"><img src="../Images/9e47922368c95fba03442e9da507fc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/0*BE3s0qMm79LRA4ys"/></div></figure><h1 id="3604" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> TaskList.js </strong></h1><p id="feb0" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在这里，我们需要相应地更新我们被破坏的道具。我们还必须更新我们正在映射的数组，以便为每个待办事项创建任务组件。我们在这里不会使用deleteItem函数，所以让我们也将它传递给我们的任务组件。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lo"><img src="../Images/b507945a2be515ae1456e7942314eaf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/0*-aP99-WSe8yOL8X5"/></div></figure><h1 id="5a9b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> Task.js </strong></h1><p id="993a" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">回到Task.js，我们要做的就是向按钮添加一个click事件侦听器，它将执行deleteItem函数。我们可以创建一个事件处理函数，如下调用该函数。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lp"><img src="../Images/1cef1523a88369a709b4c7de3dcc8d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/0*vQMdnUc_M6vBSruU"/></div></figure><p id="0464" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果你在浏览器中刷新你的应用程序，点击任何一个“完成”按钮，就可以摆脱任务了。</p><p id="998c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kk">*请注意，刷新后应用程序中的更改不会持续。为了使更改持久，必须有与服务器的通信，这不在本文中讨论。</em></p><h1 id="bcef" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> App.js </strong></h1><p id="7312" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">因为我们将向已经有一个状态的同一数组添加一个新任务，所以我们不需要创建一个新状态。类似于我们如何创建一个函数来处理删除任务，让我们创建一个用于添加任务的函数，回到我们的状态所在的App.js中。</p><p id="ee05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将遵循类似的步骤:创建一个新的数组，使用spread操作符创建原始数组的副本，然后在数组末尾添加新的元素。</p><p id="12e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当用户提交新任务时，我们需要调用这个函数，这将发生在NewTaskForm.js中，所以让我们把它作为props传递下去。</p><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lq"><img src="../Images/1954022eacb4828ccf683167295aff49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/0*X-fcPaWKHwnmWnU0"/></div></figure><h1 id="3441" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> NewTaskForm.js </strong></h1><p id="abff" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在直接进入提交活动逻辑之前，让我们把表单做成一个<a class="ae jd" href="https://reactjs.org/docs/uncontrolled-components.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">受控表单</strong> </a>。</p><p id="8add" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kk">“在受控组件中，表单数据由React组件处理。另一种选择是不受控制的组件，表单数据由DOM本身处理。</em></p><p id="72a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在导入useState钩子之后，我们可以通过为用户输入创建一个状态来做到这一点。因为todoArray是由to-do对象组成的，所以我们应该遵循这种格式，并用一个“text”键和一个空字符串作为它的值将我们的新状态初始化为一个对象。让我们定义我们的事件处理函数，在用户输入时更新这个状态。最后一步，让我们用这个新函数向输入文本添加一个onChange监听器。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lr"><img src="../Images/b51ebc6c88b20aa287f3d9af42797869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZCBGWT_72RwAu1XZ"/></div></div></figure><p id="b4fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以处理提交了。</p><p id="8073" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建将传递给提交事件侦听器的函数。默认情况下，表单提交会刷新我们的浏览器。我们不希望这样，所以我们将从防止这种默认行为开始。接下来，我们将使用我们在App.js中定义并作为props传递的函数，向todoArray添加我们的状态变量，该变量表示我们使用state基于用户输入创建和更新的对象。让我们将状态和表单重置为空值。最后，我们需要创建一个onSubmit事件监听器，使用我们新创建的函数，如下所示。</p><figure class="le lf lg lh fd li er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lw"><img src="../Images/14f24d69d12d209b8c6a133cfd4c2e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zi5l6GtRD1Jd4D07"/></div></div></figure><h1 id="6bbf" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">结论</strong></h1><p id="2c2d" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在，您应该能够在浏览器中打开它，并且能够:</p><ol class=""><li id="39ee" class="ko kp hi ih b ii ij im in iq kq iu kr iy ks jc kt ku kv kw bi translated">用按钮查看标题、表单和待办事项列表</li><li id="f89e" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">点击“完成”删除待办事项</li><li id="440b" class="ko kp hi ih b ii kx im ky iq kz iu la iy lb jc kt ku kv kw bi translated">使用表单添加新的待办事项</li></ol><figure class="le lf lg lh fd li er es paragraph-image"><div class="er es lx"><img src="../Images/ca9791b6cb66c85e86939cfab90d54a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*1NiDlINZjvEBSZXfPSOsTQ.png"/></div></figure><p id="deae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">构建交互式React应用程序的工作做得很好，感谢您的关注！</p></div></div>    
</body>
</html>
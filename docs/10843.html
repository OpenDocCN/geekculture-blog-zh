<html>
<head>
<title>Two Class Logistic Regression to build Click Prediction Model for Digital Ads</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立数字广告点击预测模型的两类逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/two-class-logistic-regression-to-build-click-prediction-model-for-digital-ads-e99cd79522e?source=collection_archive---------13-----------------------#2022-02-18">https://medium.com/geekculture/two-class-logistic-regression-to-build-click-prediction-model-for-digital-ads-e99cd79522e?source=collection_archive---------13-----------------------#2022-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="79a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数字广告领域，点击率是评估广告效果的最重要的指标之一。这是绝对必要的，并在# RTB #赞助和#搜索生态系统中广泛使用。</p><p id="be45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望预测在给定关于用户的特定信息的情况下，广告是否会被点击，为此，点击本质上是一个二元变量，并且只能有0或1作为值。我们将使用#Avazu提供的数据集，可以从下面的链接下载。</p><p id="f814" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.kaggle.com/c/avazu-ctr-prediction/data" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/avazu-ctr-prediction/data</a></p><p id="120e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，让我们从将数据集加载到令人敬畏的#AzureMLStudio开始，并对其进行可视化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/079965c66863517b40613f23b3c763a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3TC3xDff63kQDgSgBdauhw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">EDA to understand the Data</figcaption></figure><p id="7234" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">了解手头的数据和问题:</strong></p><p id="089f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，我们得到了一个有24列和超过100万行的数据集。让我们试着理解数据集中的变量。#Azure #MLStudio在处理大型数据集和可视化数据集方面非常高效，我们可以检查数据集的基本形状、大小和分布。</p><p id="34f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一列是id，表示独特的印象，第二列是“点击”，值为0和1，0表示<strong class="ih hj">不点击</strong>，反之亦然。我们手头有一个二进制分类问题，有许多算法可以为我们做到这一点。首先，让我们选择<strong class="ih hj">‘二级逻辑回归’</strong>。</p><p id="4f6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">逻辑回归</strong>是分类问题最常用的算法之一。线性回归以连续数值的形式给出输出，而逻辑回归通过使用<strong class="ih hj"> #sigmoid </strong>函数转换输出，并返回两个或更多不同类的概率，在这种情况下，只有两个类“Click”= 1和“NoClick”= 0。</p><p id="07ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Sigmoid函数</strong>:这一族函数在机器学习领域有着广泛的应用，也被称为<strong class="ih hj">逻辑函数。</strong>它具有有趣的性质，这使得它在分类问题中非常有用。它可以将任何实数值作为输入，并将其映射到0到1之间，并且具有“S”曲线形状。这方面有很多学术资源，更多可以在这里找到<a class="ae jd" href="https://en.wikipedia.org/wiki/Logistic_function" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ju"><img src="../Images/7b90c080b7c6caf49118b60bfc5c8440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*CxIV1jrjGPJY0KxC.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Logistic Function where L=1 , k = 1, X0 = 0</figcaption></figure><p id="635b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">逻辑回归与线性回归:</strong></p><p id="8a0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们试着通过考虑一个例子来理解它们之间的区别，假设我们想预测‘Virat Kohli’在下一场比赛中会得多少分。</p><ul class=""><li id="9370" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated"><strong class="ih hj">线性回归</strong>可以帮助我们预测维拉特在下一场比赛中的准确得分，并且会有一个连续的数值。</li></ul><div class="ke kf ez fb kg kh"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/heres-how-i-used-azure-ml-studio-to-build-a-regression-model-using-an-e-commerce-dataset-c8ad1b2807ba"><div class="ki ab dw"><div class="kj ab kk cl cj kl"><h2 class="bd hj fi z dy km ea eb kn ed ef hh bi translated">下面是我如何使用Azure ML studio通过电子商务数据集构建回归模型</h2><div class="ko l"><h3 class="bd b fi z dy km ea eb kn ed ef dx translated">在下面的例子中，我使用一个电子商务数据集来建立一个回归模型。这里我们使用Azure ML studio堆栈…</h3></div><div class="kp l"><p class="bd b fp z dy km ea eb kn ed ef dx translated">medium.com</p></div></div><div class="kq l"><div class="kr l ks kt ku kq kv jo kh"/></div></div></a></div><ul class=""><li id="41d9" class="jv jw hi ih b ii ij im in iq jx iu jy iy jz jc ka kb kc kd bi translated"><strong class="ih hj">逻辑回归</strong>可以帮助我们预测Virat是否会达到一个世纪，并且只有两个可能的值，即0和1。</li></ul><p id="c476" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归输出是一个连续的数值，而逻辑回归输出是一个离散的数字(只有特定的值表示特定的类或类别)</p><p id="30a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经熟悉了数据和将要使用的算法，让我们开始建模吧。</p><p id="9b27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可视化数据集后，我们将执行一些步骤检查，如声明预测变量、检查缺失值以及在训练和测试中拆分数据集。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kw"><img src="../Images/8b2baab6b52d899f528d7594303505ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQV324-li0VLMrY6pnfN2Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Setting Train size as 70 % and Test size as 30 %</figcaption></figure><p id="f501" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们从机器学习菜单中拖放“两类逻辑回归”,通过简单地执行我们工作流程中的所有步骤来训练我们的模型。可视化训练好的模型，我们得到以下输出。</p><div class="jf jg jh ji fd ab cb"><figure class="kx jj ky kz la lb lc paragraph-image"><img src="../Images/a0d1ff2d98b1ce0cc302bfabff935250.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*2F--nyytAV5epj0R05qwgw.png"/></figure><figure class="kx jj ld kz la lb lc paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/420d207db33c5c542697ca24d986e286.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*W3w-GpQdh1B7d_3U8j0erw.png"/></div></figure><figure class="kx jj le kz la lb lc paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/b2f85f002b046a2f9e17f774f651f55f.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*SAXg4BINvJNaR7mmoMM3mA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx lf di lg lh">Visualising trained model</figcaption></figure></div><p id="3208" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们可能注意到的，模型已经准备好了，我们需要做的就是对我们的模型进行评分和评估，以找出模型的性能。这可以通过从菜单中添加这些项目并简单地右键单击来完成，并将结果可视化如下。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c99cc8f3208e4c6c174e08007fbe916c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQgyZX4TXyWjX-oKcwoIsw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Output : Scored probabilities and Scored Labels on the Test data</figcaption></figure><p id="7920" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经完成了评分，让我们检查模型的准确性。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es li"><img src="../Images/bcdb44395055c014d8e5b2fb98a4766b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7bzKVtpUrzIVU651MwwmyQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Our objective is to minimize False Negatives and False Positives</figcaption></figure><p id="4ea3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以检查准确性、f1得分、精确度和召回率等指标。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lj"><img src="../Images/4034f254ff2af2a2a69e2f49dbd273d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmmx11mx3xvvCaQW8jOJnw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Visualizing AUC ROC &amp; The Complete Workflow</figcaption></figure><p id="decf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以移动阈值，在这种情况下，这是我们的模型超参数，我们可以改变阈值，以达到平衡，产生最少的假阳性和假阴性。阈值约为0.29时，我们得到的最佳模型的超精度约为81.5 %。考虑到我们手头的不平衡数据集，这是相当好的。</p></div></div>    
</body>
</html>
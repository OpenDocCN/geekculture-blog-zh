<html>
<head>
<title>Creating an Imbalanced Dataset With Oversampling Using tf.data.Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用tf.data.Dataset通过过采样创建不平衡数据集</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/creating-an-imbalanced-dataset-with-oversampling-using-tf-data-dataset-f63e959ba824?source=collection_archive---------13-----------------------#2021-04-20">https://medium.com/geekculture/creating-an-imbalanced-dataset-with-oversampling-using-tf-data-dataset-f63e959ba824?source=collection_archive---------13-----------------------#2021-04-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9798" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我总结了tensorflow的实现，用于1)创建不平衡数据集，2)使用<em class="jd"> tf.data.Dataset </em>对未充分表示的样本进行过采样。</p><p id="08b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章是针对谁的？你想要</p><ol class=""><li id="2b52" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">使用tf.data.Dataset类</li><li id="7643" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">创建不平衡的数据集</li><li id="1b26" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">想要对不平衡数据集中代表性不足的样本进行过采样</li><li id="8368" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">应用图像和批次级数据增强</li><li id="3f49" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">根据给定数据集创建分割(训练、验证)</li></ol></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="b1a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">工具和数据集规格:</p><ul class=""><li id="72e7" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jz jk jl jm bi translated">keras ( <em class="jd"> v2.4.3 </em></li><li id="e91e" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jz jk jl jm bi translated">tensorflow ( <em class="jd"> v2.2.0 </em>)后端</li><li id="0850" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jz jk jl jm bi translated">来自<em class="jd"> tf.data.Dataset </em>管道的<em class="jd"> cifar-10 </em>数据集</li></ul></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="d8d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">TL；下面的DR <br/> </strong>是满足这些需求的最简单的代码片段。您可以复制和试验，或者向下滚动来阅读每个代码块正在做什么的简介。</p><figure class="ka kb kc kd fd ke"><div class="bz dy l di"><div class="kf kg l"/></div><figcaption class="kh ki et er es kj kk bd b be z dx">Code snippet by the author</figcaption></figure><p id="0c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">简介</strong></p><ol class=""><li id="e68a" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><em class="jd"> allowed_id_list() </em>:随机选择不平衡类样本的“<em class="jd">不平衡_样本_大小</em>”(: =<em class="jd">筛选_标签</em></li><li id="3732" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><em class="jd"> _filter_list(): </em>只过滤出不平衡类允许的样本。</li><li id="9685" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">使用<em class="jd"> ds.take() </em>和<em class="jd"> ds.skip() </em>创建列车/val分割。</li><li id="c3b3" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><em class="jd"> oversample_classes() </em>，重复不平衡类的样本。当前的实现为来自少数类的样本返回“2”，为其余的样本返回“1”。更多可能性，请参考下文</li></ol><div class="kl km ez fb kn ko"><a href="https://github.com/tensorflow/tensorflow/issues/14451#issuecomment-343587112" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab dw"><div class="kq ab kr cl cj ks"><h2 class="bd hj fi z dy kt ea eb ku ed ef hh bi translated">数据集API问题#14451 tensorflow/tensorflow中的过采样功能</h2><div class="kv l"><h3 class="bd b fi z dy kt ea eb ku ed ef dx translated">你好，我想问一下目前数据集的API是否允许实现过采样算法？我处理…</h3></div><div class="kw l"><p class="bd b fp z dy kt ea eb ku ed ef dx translated">github.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="2d72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.<em class="jd"> map_fn() </em>和<em class="jd"> batch_map_fn() </em>可分别用于放大单幅图像和整批图像</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="89d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong></p><ol class=""><li id="70db" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">将数据分割成<em class="jd">验证</em>和<em class="jd">训练</em>数据集后，确保执行<em class="jd">过采样_类</em>映射。否则有数据泄露的可能。同样适用于<em class="jd"> ds.shuffle() </em>。</li><li id="b08f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">不在<em class="jd"> ds.shuffle() </em>中设置“<em class="jd">reshuffle _ each _ iteration = True</em>”会(在一定程度上)限制数据集在子集内的重排。</li></ol></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="681c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这涵盖了实现不平衡数据集或具有过采样类的数据集的基础知识。如果你觉得我错过了什么，请留下评论或分享。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="ea01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有兴趣进一步探索<em class="jd"> tf.data.Dataset </em>类，可以看看我下面这篇文章。</p><div class="kl km ez fb kn ko"><a href="https://anujarora04.medium.com/combining-tf-data-dataset-with-imagedatagenerator-for-image-pairs-698e2a2e71fd" rel="noopener follow" target="_blank"><div class="kp ab dw"><div class="kq ab kr cl cj ks"><h2 class="bd hj fi z dy kt ea eb ku ed ef hh bi translated">将tf.data.Dataset与ImageDataGenerator结合用于图像对</h2><div class="kv l"><h3 class="bd b fi z dy kt ea eb ku ed ef dx translated">在本文中，我将介绍如何在keras的ImageDataGenerator上实现tf.data.Dataset类来创建一个…</h3></div><div class="kw l"><p class="bd b fp z dy kt ea eb ku ed ef dx translated">anujarora04.medium.com</p></div></div></div></a></div></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="a6fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你觉得这些故事很有价值，并愿意支持我成为一名作家，请考虑<strong class="ih hj">关注我</strong>或<a class="ae le" href="https://anujarora04.medium.com/membership" rel="noopener">T3】注册T5】成为媒体会员。</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Combining Back-End and Front-End with NodeJs and ReactJs-Logout (Part 7)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将后端和前端与NodeJs和ReactJs-Logout结合起来(第7部分)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/combining-back-end-and-front-end-with-nodejs-and-reactjs-logout-part-7-5c851ed8b5ab?source=collection_archive---------13-----------------------#2021-05-10">https://medium.com/geekculture/combining-back-end-and-front-end-with-nodejs-and-reactjs-logout-part-7-5c851ed8b5ab?source=collection_archive---------13-----------------------#2021-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f4312bc6a1567be892cd2a98749d10eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4yhxYHYWM5AwBDgp.png"/></div></div></figure><p id="1f2d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我将解释如何在注销页面中组合NodeJs和ReacJs。这将是7。关于后端文章，如果您想阅读以前的文章，请访问:</p><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/signup-login-application-with-nodejs-express-and-mongodb-658498e580cf"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">用NodeJs、Express和MongoDB注册/登录应用程序(第1部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">在本文中，我将讲述如何用NodeJs和MongoDB创建一个注册项目。我们开始吧。</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kb l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/logout-with-nodejs-express-and-mongodb-9b73e8b01137"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">用NodeJs、Express和MongoDB注销(第2部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">在以前的文章中，我写过如何用NodeJs、Express和MongoDB创建注册和登录应用程序。的…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kg l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/email-verification-with-nodejs-part-3-e004787391e3"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">NodeJs电子邮件验证(第3部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">在这篇文章中，我写了如何在注册应用程序中验证电子邮件。为此，我用我的旧代码，邮递员…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kh l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/forgot-password-in-signup-application-with-nodejs-and-mongodb-part-4-51378dddd716"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">用NodeJs和MongoDB注册应用程序时忘记了密码(第4部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">在本文中，我们将继续注册应用程序。在这一部分，我会写忘记密码，发送电子邮件…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="ki l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/combining-back-end-and-front-end-with-nodejs-and-reactjs-signup-part-5-e9d0797aeedf"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">用NodeJs和ReactJs-SignUp组合后端和前端(第5部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">当我开始后端编码时，我的主要问题是结合后端和前端。在这篇文章中，我将写关于…</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kj l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp ez fb jq jr"><a rel="noopener follow" target="_blank" href="/geekculture/combining-back-end-and-front-end-with-nodejs-and-reactjs-login-part-6-1c8cb6bf4b91"><div class="js ab dw"><div class="jt ab ju cl cj jv"><h2 class="bd hj fi z dy jw ea eb jx ed ef hh bi translated">将后端和前端与NodeJs和ReactJs-Login结合起来(第6部分)</h2><div class="jy l"><h3 class="bd b fi z dy jw ea eb jx ed ef dx translated">在本文中，我将继续登录部分。对于以前的文章，你可以去个人资料。我们开始吧。</h3></div><div class="jz l"><p class="bd b fp z dy jw ea eb jx ed ef dx translated">medium.com</p></div></div><div class="ka l"><div class="kk l kc kd ke ka kf io jr"/></div></div></a></div><p id="784a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你都读完了，那就开始吧！</p><p id="5ed1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不编码前端部分，所以我只是给你一个简单的代码，你可以编码，如果你想。但首先，我们将从后端部分开始。实际上在我的其他文章中，我给了你一个注销代码，但是当我开始组合后端和前端时，我意识到我需要一个布尔变量(login)来理解登录和注销。所以我的代码是这样的:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="61a9" class="ku kv hi kq b fi kw kx l ky kz"><em class="la">exports</em>.logout = async (<em class="la">req</em>, <em class="la">res</em>, <em class="la">next</em>) =&gt; {</span><span id="12c2" class="ku kv hi kq b fi lb kx l ky kz"><em class="la">res</em>.cookie('token', 'none', {</span><span id="f047" class="ku kv hi kq b fi lb kx l ky kz">httpOnly: true,</span><span id="f9e1" class="ku kv hi kq b fi lb kx l ky kz">});</span><span id="527f" class="ku kv hi kq b fi lb kx l ky kz">user = await User.findOne({login: true}); // returns informations about login: true users</span><span id="961f" class="ku kv hi kq b fi lb kx l ky kz">user.login = false;</span><span id="f409" class="ku kv hi kq b fi lb kx l ky kz">user.save()</span><span id="a02c" class="ku kv hi kq b fi lb kx l ky kz"><em class="la">res</em>.status(200).json({</span><span id="e1e8" class="ku kv hi kq b fi lb kx l ky kz">success: true,<br/>data: {},</span><span id="a4b5" class="ku kv hi kq b fi lb kx l ky kz">});</span><span id="97f0" class="ku kv hi kq b fi lb kx l ky kz">};</span></pre><p id="6ff2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将它写入控制器文件夹的auth.js文件。我的意思是，它在controllers/auth.js文件中。在这个文件中，我在这里编写了注册、激活帐户、登录、注销、getMe、forgotPassword和resetPassword以及排序函数。我将在本教程中解释它们！</p><p id="9efb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后，我们将转到前端文件夹，创建名为Logout的函数，如下所示:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="6095" class="ku kv hi kq b fi kw kx l ky kz">export default function Logout() {<br/>}</span></pre><p id="d6af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个函数中，你知道，我们有回报。我们的前端部分在那里。我会把它像骷髅一样给你，你可以随意改变它:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="0574" class="ku kv hi kq b fi kw kx l ky kz">&lt;button <em class="la">className</em>="outbtn" <em class="la">onClick</em>={logout}&gt;</span><span id="5bf4" class="ku kv hi kq b fi lb kx l ky kz">&lt;a <em class="la">href</em>="/"&gt;</span><span id="3210" class="ku kv hi kq b fi lb kx l ky kz">{t('Popup.logout')}</span><span id="b037" class="ku kv hi kq b fi lb kx l ky kz">&lt;/a&gt;</span><span id="6eda" class="ku kv hi kq b fi lb kx l ky kz">&lt;/button&gt;</span><span id="6808" class="ku kv hi kq b fi lb kx l ky kz">&lt;button <em class="la">className</em>="exitButton"&gt;</span><span id="7e75" class="ku kv hi kq b fi lb kx l ky kz">&lt;<em class="la">Link</em> <em class="la">to</em>="/"&gt;</span><span id="308a" class="ku kv hi kq b fi lb kx l ky kz">&lt;span&gt;{t('Popup.exit')}&lt;/span&gt;</span><span id="c523" class="ku kv hi kq b fi lb kx l ky kz">&lt;/<em class="la">Link</em>&gt;</span><span id="a30a" class="ku kv hi kq b fi lb kx l ky kz">&lt;/button&gt;</span></pre><p id="4687" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在function中，我们将创建一个名为logout的异步函数。在注销中，我们将用let(我们可以更改它)创建一个变量，命名为result。最重要的是“拿来”。我们会像邮递员一样给它一个url、方法和头。方法是“获取”。如果我们让它那样，它会在结合时出现问题，但我会解释它。所以看起来会是这样的:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="5228" class="ku kv hi kq b fi kw kx l ky kz">let result = await fetch("http://localhost:5000/logout",</span><span id="88d1" class="ku kv hi kq b fi lb kx l ky kz">{</span><span id="d9dd" class="ku kv hi kq b fi lb kx l ky kz">method: "GET",</span><span id="8000" class="ku kv hi kq b fi lb kx l ky kz">headers: {</span><span id="9fb8" class="ku kv hi kq b fi lb kx l ky kz">"Authorization":"Baerer " + localStorage.getItem('user-info')</span><span id="d2b1" class="ku kv hi kq b fi lb kx l ky kz">}</span><span id="c0bc" class="ku kv hi kq b fi lb kx l ky kz">}).then(localStorage.removeItem("user-info")).then(history.push("/"))</span><span id="a9e6" class="ku kv hi kq b fi lb kx l ky kz">result = await result.json()</span></pre><p id="dc1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用console.log并在控制台上打印结果以供检查。因此，在这些之后，我们将返回部分，并使用我们在按钮中编写的函数。</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="cc60" class="ku kv hi kq b fi kw kx l ky kz"><em class="la">onClick</em>={logout}</span></pre><p id="a15b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">至此，我们的编码部分就结束了。现在我们将运行我们的后端:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="d533" class="ku kv hi kq b fi kw kx l ky kz">npm run dev</span></pre><p id="045a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">和前端:</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="d885" class="ku kv hi kq b fi kw kx l ky kz">npm start</span></pre><p id="df4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">后端启动localhost:5000，前端启动localhost:3000，这个重要。</p><p id="54e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在网上，我们必须登录。在这之后，我们将检查页面。在这里，你可以看到一个应用。</p><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/a7c0989e5fd38d3f985f1e9a6eca0983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVNCAX_yWmXXS0PxQ4KIvQ.png"/></div></div></figure><p id="95d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以看到用户信息。这些json数据，成功和令牌。为了注销，我们必须销毁它。您可以通过点击并删除或通过代码来销毁。在这个代码的</p><pre class="kl km kn ko fd kp kq kr ks aw kt bi"><span id="2e07" class="ku kv hi kq b fi kw kx l ky kz">.then(localStorage.removeItem("user-info"))</span></pre><p id="587e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">部分，我们在注销时删除了这些信息。</p><p id="9f53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以就这样吧，暂时没什么好解释的。在我的下一篇文章中，我会告诉你如何忘记和重置密码，这比那要难一点。</p><p id="d8e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>
<html>
<head>
<title>SpringBoot: API Authentication Using OAuth2 With Google</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SpringBoot:使用OAuth2和Google进行API认证</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/springboot-api-authentication-using-oauth2-with-google-655b8759f0ac?source=collection_archive---------0-----------------------#2022-01-15">https://medium.com/geekculture/springboot-api-authentication-using-oauth2-with-google-655b8759f0ac?source=collection_archive---------0-----------------------#2022-01-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c821" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们谈论设计和公开REST APIs时，防止对敏感数据的不必要的访问是至关重要的，所以在今天的文章中，我将给出一个实际的例子，说明如何利用Google的OAuth2支持来实现认证。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/e5f300d6a7d64a7ab5c03185c7c9bd97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FRZJ4I9ZPIzR9pVP"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matthew Henry</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="4c91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们开始之前，你可以在这里找到完整的<a class="ae jt" href="https://github.com/georgeberar/medium/tree/main/resource-server-oauth2-google" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a><strong class="ih hj">。</strong></p><p id="6b96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为补充说明，我为与谷歌云控制台步骤相关的gif尺寸较小(回购中的尺寸较大)而道歉，但这似乎是在浏览器和移动设备上实现相同结果的唯一方式(在我的iPhone上，Medium应用程序崩溃了)。</p><p id="c790" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好，我们开始吧！</p><h1 id="5cf5" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">背景</h1><p id="9f06" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">当谈到保护API时，我们主要讨论认证和授权，这两者通常是相辅相成的。虽然有多少系统就有多少专有方法，但它们在很大程度上是一些主要方法的变体，其中之一就是<a class="ae jt" href="https://oauth.net/2/" rel="noopener ugc nofollow" target="_blank"> OAuth2 </a>(或OAuth 2.0)。</p><p id="6023" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是OAuth2？</strong></p><p id="bfd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">长话短说，这是一种标准，旨在允许网站或应用程序代表用户访问其他web应用程序托管的资源。它提供同意的访问，并限制客户端应用程序可以代表用户对资源执行的操作，而不会共享用户的凭据。简化的OAuth2流程如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es le"><img src="../Images/4651f22028c17fce83a09d4bd30d6da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-iK6pQEqeLQDtKKjvINRA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">OAuth2 flow as pictured by <a class="ae jt" href="https://developer.okta.com/blog/2018/04/02/client-creds-with-spring-boot" rel="noopener ugc nofollow" target="_blank">Okta Developer Blog</a></figcaption></figure><blockquote class="lf lg lh"><p id="429e" class="if ig li ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">你可以查看<a class="ae jt" href="https://auth0.com/intro-to-iam/what-is-oauth-2/" rel="noopener ugc nofollow" target="_blank">这个链接</a>来了解更多关于OAuth2的信息。</p></blockquote><p id="fefd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目前，谷歌、脸书或Twitter等科技巨头正在提供授权服务器，你可以根据他们的用户数据库实现身份验证和与识别个人账户相关的一切，而无需自己存储和管理这些细节。</p><p id="5d1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能在某个时候见过这样的东西:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/494c560ffc98918dff7f100463de8f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*zBFCuSIcd7mRgNQ78Ap90w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Fiverr’s login pop-up</figcaption></figure><p id="f4ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是幕后发生了什么呢？</p><p id="3522" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，如果你使用Google登录，web应用程序会将你重定向到Google的登录页面，在那里你需要提供你的Google帐户凭证(如果你还没有登录的话)。如果凭据正确，您将被重定向回接收访问令牌的web应用程序。web应用程序将在每次请求时将这个访问令牌发送到其后端，后端将根据Google对其进行验证，以确保它没有被更改或过期。</p><h1 id="0aa8" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">问题是</h1><p id="bd7d" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">假设我们构建了一个web应用程序，用户可以通过上传收据的照片来跟踪他们每月的支出。我们希望允许我们的用户使用他们的Google帐户登录，我们希望确保我们的后端API能够通过验证每个请求上的访问令牌来处理身份验证。</p><p id="3e3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何构建我们的后端API来验证针对Google的令牌？</p><h1 id="039a" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">解决方案</h1><p id="5bd9" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这个解决方案意味着利用Google的OAuth2支持。如果您记得在OAuth2流程图中，我们有一个授权服务器和一个资源服务器。在我们的情况下，谷歌将是授权服务器，负责处理用户认证和生成访问令牌，我们的后端将是资源服务器，负责验证对谷歌的访问令牌，并允许我们的用户创建，阅读，更新或删除他们的每月收据。</p><h2 id="bf93" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">第一步。配置Google OAuth2</h2><p id="2553" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj"> 1.1创建新项目</strong></p><p id="c2e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<a class="ae jt" href="https://console.cloud.google.com/getting-started" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>中，我们创建了一个新项目:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/39ecea11319acfc790d2a91300efcca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*QywGRv34us24O-an"/></div></figure><p id="f324" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.2配置同意屏幕</strong></p><p id="c4dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们需要配置同意屏幕，从下拉列表中选择我们新创建的项目，然后单击<strong class="ih hj"> <em class="li"> OAuth同意屏幕。</em>T13】</strong></p><p id="38a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们为<strong class="ih hj">用户类型</strong>部分选择<strong class="ih hj">外部</strong>,因为我们希望使用不一定属于某个组织的Google帐户。</p><p id="490a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用程序信息部分并不真正相关，但你可以指定应用程序的名称，也许上传一个标志和其他细节。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/f973e13fe57af8dd52f9839d5fd97b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*QbJt6KsT_HGI98hc"/></div></figure><p id="cad5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.3设置范围</strong></p><p id="1f3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的用例，我们需要的唯一范围是:<code class="du mc md me mf b">openid</code>、<code class="du mc md me mf b">email</code>和<code class="du mc md me mf b">profile</code>。</p><p id="bf7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重要提示</strong>:我们添加了<code class="du mc md me mf b">openid</code>作为范围，因为我们想使用OAuth2上面的薄层。这一层称为OpenID Connect，它添加了当前登录者的登录和个人资料信息。因为我们仍在OAuth2上下文中，所以我不会深入讨论更多细节，但您可以在此处<a class="ae jt" href="https://openid.net/connect/#:~:text=OpenID%20Connect%201.0%20is%20a,interoperable%20and%20REST%2Dlike%20manner." rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a><strong class="ih hj"/>和<a class="ae jt" href="https://developer.okta.com/blog/2019/10/21/illustrated-guide-to-oauth-and-oidc" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">处</strong> </a> <strong class="ih hj">找到关于此主题的更多信息。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/4b3da3ab9f95aee9e805ffc9f92d58c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*UdhyS_R4z-I5Ulb7"/></div></figure><p id="8c54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.4设置测试用户</strong></p><p id="c179" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初，我们希望在处理真实客户之前，检查我们的后端是否能够与一组虚拟用户一起工作，因此我们需要添加所谓的<strong class="ih hj"> <em class="li">测试用户。</em> </strong></p><p id="42a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简单起见，我添加我的谷歌帐户主要用于开发目的，但你可以添加任何你想测试的谷歌帐户，当然，只要你知道证书。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/d0b10d62e995988a1bfef1a4e22fb7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*EcpKZNLfopnlT9DV"/></div></figure><p id="de00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.5创建OAuth客户端</strong></p><p id="6cb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建OAuth客户端，我们从左侧面板中选择<strong class="ih hj"> <em class="li">凭证</em> </strong>，并单击<strong class="ih hj"> <em class="li">创建凭证。</em> </strong></p><p id="4744" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li"> OAuth客户端ID </em> </strong>用作<strong class="ih hj"> <em class="li"> </em> </strong>凭证类型，<strong class="ih hj"> <em class="li"> Web应用</em> </strong>用作应用类型。</p><blockquote class="lf lg lh"><p id="1cd6" class="if ig li ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">注意:最后会显示一个包含客户端id和密码的弹出窗口。复制这些价值观，不要与他人分享。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/161a0209c740180da0700a089cbafadf.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*XpOeqh2d4PoTJ4cd"/></div></figure><p id="3be1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1.6邮递员做前端</strong></p><p id="ebab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们的重点是后端，完全忽略了前端部分，所以我们需要一种模拟Google登录并获得有效访问令牌的方法。为此，我们将使用<a class="ae jt" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>，并且我们需要对OAuth客户端做一些小的调整。</p><p id="3fff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从左侧面板中选择<strong class="ih hj"> <em class="li">凭证</em> </strong>，并从<strong class="ih hj"> <em class="li"> OAuth 2.0客户端id</em></strong>表中打开我们新创建的客户端。</p><p id="f132" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们添加<a class="ae jt" href="https://www.getpostman.com/oauth2/callback" rel="noopener ugc nofollow" target="_blank">https://www.getpostman.com/oauth2/callback</a>为<strong class="ih hj"> <em class="li">授权重定向URIs </em> </strong>并点击保存。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/a8057bbbc19732a356e585ae8cb95990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*gwS7vPZarG9306CCqQzzrg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Add correct authorized redirect URI for Postman callback</figcaption></figure><h2 id="130f" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">第二步。创建资源服务器</h2><p id="515c" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在这一步中，我们将后端配置为资源服务器。</p><p id="5fbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.1添加Maven依赖</strong></p><p id="bd33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一个Maven依赖项被添加到<strong class="ih hj"> pom.xml: </strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="b956" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.2配置应用程序属性</strong></p><p id="80c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的配置被添加到<code class="du mc md me mf b">resources</code>文件夹下的<strong class="ih hj"> application.yml </strong>文件中:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Configuring application properties</figcaption></figure><blockquote class="lf lg lh"><p id="e018" class="if ig li ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">您需要将<strong class="ih hj">&lt;YOUR _ CLIENT _ ID&gt;</strong>和<strong class="ih hj">&lt;YOUR _ CLIENT _ SECRET&gt;</strong>占位符替换为您自己的客户端ID和机密。</p></blockquote><p id="1f02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="li">如果您使用的是application.properties而不是YAML文件，这些属性应该是可用的。</em></p><p id="4721" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2.3配置弹簧安全</strong></p><p id="6178" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要做的最后一件事是配置Spring Security作为资源服务器:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Spring Security configuration</figcaption></figure><h2 id="6422" class="ln kc hi bd kd lo lp lq kh lr ls lt kl iq lu lv kp iu lw lx kt iy ly lz kx ma bi translated">第三步。测试</h2><p id="a044" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">为了能够从Postman生成访问令牌，我们需要配置它，以便与我们的OAuth客户端一起工作。</p><p id="5458" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li">打开邮递员</em> </strong> &gt; <strong class="ih hj"> <em class="li">新请求</em> </strong> &gt; <strong class="ih hj"> <em class="li">授权</em> </strong> &gt; <strong class="ih hj"> <em class="li">选择OAuth 2.0 </em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/b7c209e32d23ec76f6e49d2ae0377169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEMIlkCYxoJyiYrgXKvD2A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Configuring Postman</figcaption></figure><p id="2ba6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们把<a class="ae jt" href="https://www.getpostman.com/oauth2/callback" rel="noopener ugc nofollow" target="_blank">https://www.getpostman.com/oauth2/callback</a>作为<strong class="ih hj"> <em class="li">回调URL </em> </strong>以及我们正确的客户端id和秘密。</p><p id="3c92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击<strong class="ih hj"> <em class="li">获取新的访问令牌</em> </strong>按钮应该会打开一个弹出窗口，我们需要在这里为我们的一个测试用户提供凭证。如果凭据有效，我们应该会看到如下内容:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/92963ac6236282d5a7c6f432e48e77d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYSfjTC7-WuTgTJYXZLscg.png"/></div></div></figure><p id="fa45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="li"> id_token </em> </strong>的值要复制<strong class="ih hj"> <em class="li"> </em> </strong>因为这是我们需要的生成的访问令牌。</p><p id="a193" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们尝试在没有这个令牌的情况下对我们的一个后端端点执行一个请求，看看会发生什么:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ml"><img src="../Images/110c70f83aa49a127ef2a4ba38699fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*DtHLYZJ2ABHiI4l2Xrr2zg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Request without token</figcaption></figure><p id="4258" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，我们得到了预期的401，因为我们没有为令牌提供授权头。</p><p id="a9cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将令牌作为<code class="du mc md me mf b">Bearer Token</code>添加到我们的请求中，我们得到了预期的输出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/4dd56b891f05713467407768b969a925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VtntI3naw_pPROce3a96kw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Request with token as value for Authorization header</figcaption></figure><p id="1665" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！</p><h1 id="60a7" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="d859" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">请始终记住，这种方法可能适合也可能不适合您的项目环境或需求，我不能说没有其他方法可以做得不同或更好。我真的希望你喜欢它，并从中获得乐趣。</p><p id="96b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意安全，记住你可以在这里找到<a class="ae jt" href="https://github.com/georgeberar/medium/tree/main/resource-server-oauth2-google" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">代码</strong> </a>。</p></div></div>    
</body>
</html>
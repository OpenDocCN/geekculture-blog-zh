<html>
<head>
<title>Anomaly detection using Minimum Covariance Determinant (MCD)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用最小协方差行列式(MCD)的异常检测</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/anomaly-detection-using-minimum-covariance-determinant-mcd-41dc28ccc8a?source=collection_archive---------1-----------------------#2022-06-29">https://medium.com/geekculture/anomaly-detection-using-minimum-covariance-determinant-mcd-41dc28ccc8a?source=collection_archive---------1-----------------------#2022-06-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6826" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在处理数据的过程中，我们通常面临的任务是对这些数据建立模型以进行预测和数据分析。</p><p id="46bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可能需要分析来监控和响应过程中的某些变化。工厂里也有类似的任务来控制生产过程。此外，这种分析可能与监控数据中心等中的应用程序和基础架构的负载和状态相关。</p><p id="118d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据预测在多个领域都很有趣，例如预测股票市场的汇率或零售店的客流量和购买量。为了解决此类问题，需要创建某种数据模型，并使用它来预测或识别需要特别关注和决策的偏差。</p><p id="b7e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，数据中偏差的存在会导致不正确的数据模型。为了消除构建模型时的负面影响，根据合适的策略，寻找异常、将它们从训练样本中清除或替换它们正是所需要的。</p><p id="4b26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将回顾最小协方差行列式(MCD)异常搜索方法，并尝试对此方法给出直观的解释。</p><p id="a377" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最小协方差行列式(MCD)解释。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/7b1d04195f144a9e31cf32caf519be5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6X0KDuTwqMU4vkFEE0-o7g.png"/></div></div></figure><p id="4a01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们处理数据时，我们假设它是由一定的概率分布产生的。那么具有低概率密度的点可以被识别为异常。对于椭圆分布的数据(例如高斯分布)，这可以通过计算每个点到平均值的马氏距离来实现。异常将是距离最大为某一阈值的点。</p><p id="ebab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">马哈拉诺比斯距离是给定点和质心之间的距离除以椭球在给定点方向上的宽度。马氏距离需要分布参数(均值和协方差矩阵)。</p><p id="ad78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">中间大家应该都不陌生。协方差是两个随机变量相关性的度量。因此，向量的协方差矩阵是方阵，向量分量的方差位于方阵的对角线上，非对角线元素是分量之间的协方差。</p><p id="e029" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于在处理原始数据时，均值和协方差矩阵在我们的情况下是未知的，因此需要根据数据对它们进行估计。这就是问题出现的地方，因为数据中的异常会扭曲参数估计，使这些点看起来不那么异常。例如，远异常值会将样本均值拉向自身，并人为地放大样本协方差矩阵。如果我们预先知道哪些点是异常的，我们可以简单地将它们从参数估计中排除，但是这种信息通常是不可用的。</p><p id="24eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MCD是一种估计均值和协方差矩阵的方法，可以最大限度地减少异常的影响。这个想法是从被选择为没有异常的数据的子集来估计这些参数。</p><p id="d22d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，取一组给定大小的数据子样本，从中确定均值和协方差矩阵。然后存储协方差矩阵具有最小行列式的子集的估计。最小化行列式背后的思想是协方差矩阵的行列式测量分布有多宽。因此，MCD选择数据分布最密集的子集。这样做是为了排除可能与其余数据相距较远的异常。</p><p id="0cd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实施</strong></p><p id="3a95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，考虑具有以下结构的杂货店数据集:</p><ul class=""><li id="7e60" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">日期时间—记录观察结果的日期和时间</li><li id="58e2" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">rto—收入</li><li id="6e3f" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">支票——这一小时内在商店购买的数量</li><li id="bd8b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">n_sku —售出的sku数量</li><li id="01aa" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">cnt —售出的商品数量</li><li id="d25b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">cash num——商店中该小时营业的收银台数量</li></ul><p id="dae7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个方法的实现在PyOD库中，我们将使用这个库。</p><pre class="je jf jg jh fd kd ke kf kg aw kh bi"><span id="d68f" class="ki kj hi ke b fi kk kl l km kn">import pandas as pd<br/>import numpy as np<br/>from pyod.models.mcd import MCD</span><span id="a774" class="ki kj hi ke b fi ko kl l km kn">outliers_fraction = 0.05<br/>random_state = np.random.RandomState(42)<br/><br/>mcd_detector = MCD(contamination=outliers_fraction, random_state=random_state)</span><span id="a6a7" class="ki kj hi ke b fi ko kl l km kn">```</span><span id="2c4d" class="ki kj hi ke b fi ko kl l km kn">read Input data to df:DataFrame<br/>```</span><span id="e4b4" class="ki kj hi ke b fi ko kl l km kn">df = df.set_index('Datetime')<br/>df = df[columns].resample('D').sum()</span><span id="1323" class="ki kj hi ke b fi ko kl l km kn">X = df.values</span><span id="99f3" class="ki kj hi ke b fi ko kl l km kn">mcd_detector.fit(X)</span><span id="4864" class="ki kj hi ke b fi ko kl l km kn">pred = mcd_detector.predict(X)</span></pre><p id="51ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是上述数据的算法结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/5fbc3db0df3715e46c0dcec3c00a5a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CWSKe7QGhVs6ezPyWRJ1w.png"/></div></div></figure><p id="0731" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以看出，在商店增设收银台后的观察结果是异常的，因为其余指标保持在同一水平。因此，指标之间的关系发生了显著变化。根据这个情节，我们可以说，这家商店增加收银台并不影响销售，但可能会影响顾客的等待时间，遗憾的是我们没有这样的数据。</p><p id="6b60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p><p id="05fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在本文中，我们研究了如何使用MCD方法搜索异常，并尝试在实践中使用PyOD包中的实现。</p><p id="a726" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">链接</strong></p><p id="b0da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kq" href="https://wis.kuleuven.be/stat/robust/papers/2010/wire-mcd.pdf" rel="noopener ugc nofollow" target="_blank">https://wis . kule uven . be/stat/robust/papers/2010/wire-MCD . pdf</a></p><p id="a270" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kq" href="https://www.machinelearningplus.com/statistics/mahalanobis-distance/" rel="noopener ugc nofollow" target="_blank">https://www . machine learning plus . com/statistics/Mahalanobis-distance/</a></p><div class="kr ks ez fb kt ku"><a href="https://pyod.readthedocs.io/en/latest/pyod.models.html#pyod.models.mcd.MCD" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab dw"><div class="kw ab kx cl cj ky"><h2 class="bd hj fi z dy kz ea eb la ed ef hh bi translated">所有型号- pyod 1.0.2文档</h2><div class="lb l"><h3 class="bd b fi z dy kz ea eb la ed ef dx translated">基于角度的离群点检测器(ABOD)基于连通性的离群点因子(COF)算法模型组合的集合…</h3></div><div class="lc l"><p class="bd b fp z dy kz ea eb la ed ef dx translated">pyod.readthedocs.io</p></div></div></div></a></div><div class="kr ks ez fb kt ku"><a href="https://stats.stackexchange.com/questions/475636/intuitive-explanation-of-minimum-covariance-determinant-mcd" rel="noopener  ugc nofollow" target="_blank"><div class="kv ab dw"><div class="kw ab kx cl cj ky"><h2 class="bd hj fi z dy kz ea eb la ed ef hh bi translated">最小协方差行列式的直观解释</h2><div class="lb l"><h3 class="bd b fi z dy kz ea eb la ed ef dx translated">begingroup$检测异常的一种方法是假设常规(非异常)数据是由特定的…</h3></div><div class="lc l"><p class="bd b fp z dy kz ea eb la ed ef dx translated">stats.stackexchange.com</p></div></div><div class="ld l"><div class="le l lf lg lh ld li jn ku"/></div></div></a></div></div></div>    
</body>
</html>
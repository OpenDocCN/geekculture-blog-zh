<html>
<head>
<title>This bot can trade Bitcoin whenever Elon Musk tweets about it</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每当埃隆·马斯克在推特上发布比特币时，这个机器人就可以交易比特币</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/this-bot-can-trade-bitcoin-whenever-elon-musk-tweets-about-it-614b95633663?source=collection_archive---------19-----------------------#2021-06-25">https://medium.com/geekculture/this-bot-can-trade-bitcoin-whenever-elon-musk-tweets-about-it-614b95633663?source=collection_archive---------19-----------------------#2021-06-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a599" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用NodeJS的币安情感交易机器人</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/9db9cc81812d24f23d01795d02bf9f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OvHd4ONUtZLQFSMQ4kVwg.jpeg"/></div></div></figure><p id="23f6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">是啊！在这篇文章中，我们将构建一个可定制的交易机器人，<strong class="jl hj">,每当埃隆·马斯克发布推文时，它可以根据推文情绪在币安买卖</strong>比特币。</p><blockquote class="kf kg kh"><p id="105c" class="jj jk ki jl b jm jn ij jo jp jq im jr kj jt ju jv kk jx jy jz kl kb kc kd ke hb bi translated">问题:你能告诉我们这个机器人背后的动机吗？</p><p id="7298" class="jj jk ki jl b jm jn ij jo jp jq im jr kj jt ju jv kk jx jy jz kl kb kc kd ke hb bi translated">回答:当然，为什么不呢？！</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es km"><img src="../Images/d94df06adb0ef01cb8ea9e0683d2baa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzuNoMu78xT0KPavnOeH2A.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Source: <a class="ae kr" href="https://www.blockchainresearchlab.org/2021/02/08/the-musk-effect-how-elon-musks-tweets-affect-the-cryptocurrency-market/" rel="noopener ugc nofollow" target="_blank">Blockchain Research Lab</a></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es km"><img src="../Images/f2c498cd18bb738a65048f2c63387d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRAVJ61Wd9wJBhGDNkNe8w.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Source: <a class="ae kr" href="https://www.blockchainresearchlab.org/2021/02/08/the-musk-effect-how-elon-musks-tweets-affect-the-cryptocurrency-market/" rel="noopener ugc nofollow" target="_blank">Blockchain Research Lab</a></figcaption></figure><p id="7d97" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你能看到价格变动吗？他们称之为“麝香效应”。</p><blockquote class="kf kg kh"><p id="7fd2" class="jj jk ki jl b jm jn ij jo jp jq im jr kj jt ju jv kk jx jy jz kl kb kc kd ke hb bi translated"><strong class="jl hj">免责声明</strong>:它纯粹是为了好玩和<strong class="jl hj">教育</strong> <strong class="jl hj">目的</strong>而建造的。这篇文章不鼓励或批评任何人或事。目标只是演示交易机器人的技术植入。这不是财务建议或推荐。</p></blockquote><p id="2635" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在我们进入实现部分之前，让我们做好准备。</p><h1 id="a59d" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">📝先决条件:</h1><ul class=""><li id="efdf" class="lk ll hi jl b jm lm jp ln js lo jw lp ka lq ke lr ls lt lu bi translated">NodeJS:要运行这个bot，您需要在您的机器上安装NodeJS。如果你还没做，用这个<a class="ae kr" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank">链接</a>。</li><li id="7ce1" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated"><a class="ae kr" href="https://developer.twitter.com/en/apply/user.html" rel="noopener ugc nofollow" target="_blank"> Twitter开发人员帐户:</a>用于获取不记名令牌以向Twitter API发出有效请求。</li><li id="548a" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated"><a class="ae kr" href="https://testnet.binance.vision/" rel="noopener ugc nofollow" target="_blank">币安测试网按键</a>:在币安测试网交易所编程下单时需要这些按键。您可以通过GitHub帐户登录来获取。</li></ul><h1 id="08e1" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">🧘准备:</h1><p id="cb18" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js ma ju jv jw mb jy jz ka mc kc kd ke hb bi translated">让我们为这个bot创建一个新目录，并将当前目录切换到它。我要称它为<strong class="jl hj">“麝香机器人”</strong>。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="fb16" class="mi kt hi me b fi mj mk l ml mm">mkdir musk-bot &amp;&amp; cd musk-bot</span></pre><p id="aa15" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过运行<code class="du mn mo mp me b">npm init</code>初始化一个新项目。</p><p id="51f8" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">本项目中使用的依赖关系如下:</p><ul class=""><li id="100d" class="lk ll hi jl b jm jn jp jq js mq jw mr ka ms ke lr ls lt lu bi translated"><a class="ae kr" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj"> axios </strong> </a>:向Twitter API发出http请求</li><li id="525d" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated"><a class="ae kr" href="https://www.npmjs.com/package/dotenv" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj"> dotenv </strong> </a>:读取环境变量的值</li><li id="358d" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated"><a class="ae kr" href="https://www.npmjs.com/package/node-binance-api" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj">节点-币安-api </strong> </a>:在币安交易所(testnet)下单</li><li id="b826" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated"><a class="ae kr" href="https://www.npmjs.com/package/sentiment" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hj">情绪</strong> </a>:检索推文的情绪。</li></ul><p id="9cd5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们需要安装所需的依赖项。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="ece6" class="mi kt hi me b fi mj mk l ml mm">npm install axios dotenv node-binance-api sentiment --save </span></pre><p id="b68f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了增加bot的一致性，我决定将交易日志和最后处理的tweetId存储在文件系统中。因此，我们需要在项目目录中再创建两个文件。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="5a96" class="mi kt hi me b fi mj mk l ml mm">touch trade.logs tweetId.txt  </span></pre><p id="a42f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">太棒了。👏现在是实现的时候了。</p><h1 id="4d08" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">💡算法:</h1><p id="9b1f" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js ma ju jv jw mb jy jz ka mc kc kd ke hb bi translated">我们的机器人的工作方式非常简单明了。</p><ul class=""><li id="fb0c" class="lk ll hi jl b jm jn jp jq js mq jw mr ka ms ke lr ls lt lu bi translated">首先，它从最后处理的推文中获取多达10条推文。当我们第一次启动bot时，它从给定的twitter用户Id中获取最后10条tweets。</li><li id="7f92" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">我们将维护一个单词数组，用于检查哪些tweets需要处理。没有那个词的推文被忽略了。在我们的例子中，单词数组类似于<code class="du mn mo mp me b">['btc', 'bitcoin']</code>。tweet中可能有一些超链接包含数组中的单词，因此我们将使用Regex从tweet中删除超链接，然后再对照单词数组进行检查。</li><li id="002e" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">从推文中提取情感得分。如果中性或者它没有突破阈值，我们就忽略它。</li><li id="5338" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">如果推文打破了正/负阈值分数(可以在文件中定义，检查实现以了解更多细节)，我们将根据情绪发出买入/卖出订单。</li><li id="164c" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">然后我们将交易日志和<code class="du mn mo mp me b">lastProcessedTweetId</code>记录在一个文件中。</li><li id="6206" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">如果所有10条tweet不包含任何与word数组中的单词相关的tweet，那么我们只需将<code class="du mn mo mp me b">lastProcessedTweetId</code>更新为Twitter API返回的tweet数组中的最新tweet(即，<code class="du mn mo mp me b">lastProcessedTweetId = tweets[0].id</code>)并等待下一次迭代(滑动窗口技术)。</li></ul><h1 id="82c9" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">⌛️Implementation:</h1><p id="bc17" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js ma ju jv jw mb jy jz ka mc kc kd ke hb bi translated">在项目根目录下创建一个名为<code class="du mn mo mp me b">app.js</code>的新文件，并添加以下内容。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="f83c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在我们需要创建配置文件来定制这个机器人。创建一个名为<code class="du mn mo mp me b">config.js</code>的文件来存储这个机器人的基本配置。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="8060" class="mi kt hi me b fi mj mk l ml mm">module.exports = {</span><span id="993f" class="mi kt hi me b fi mv mk l ml mm">BASE: "BTC",</span><span id="0d4e" class="mi kt hi me b fi mv mk l ml mm">QUOTE: "USDT",</span><span id="7359" class="mi kt hi me b fi mv mk l ml mm">//buys BTC using 30% of USDT balance<br/>BUY_PERCENT: 30,</span><span id="e09b" class="mi kt hi me b fi mv mk l ml mm">//sells 35% of BTC <br/>SELL_PERCENT: 35,</span><span id="8d95" class="mi kt hi me b fi mv mk l ml mm">//bot checks for these words in the tweets<br/>shouldInclude: ["btc", "bitcoin"],</span><span id="1f64" class="mi kt hi me b fi mv mk l ml mm">//UserId of the twitter user. It can be obtained from this <a class="ae kr" href="https://developer.twitter.com/en/docs/twitter-api/users/lookup/api-reference/get-users-by-username-username" rel="noopener ugc nofollow" target="_blank">API</a><br/>twitterUserId: "elon_musk_id_goes_here",</span><span id="81bb" class="mi kt hi me b fi mv mk l ml mm">//Frequency to check for new tweets (in minutes)<br/>interval : 2</span><span id="3cde" class="mi kt hi me b fi mv mk l ml mm">};</span></pre><p id="0394" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如前所述，这个机器人是可定制的。它不仅限于交易比特币或对埃隆·马斯克的推文进行投票。您可以根据需要更改这些参数。</p><p id="c260" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在让我们创建另一个文件<code class="du mn mo mp me b">.env</code>来存储环境变量。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="07f1" class="mi kt hi me b fi mj mk l ml mm">BEARER_TOKEN = &lt;TWITTER_BEARER_TOKEN&gt;<br/>BINANCE_API_KEY= &lt;BINANCE_TESTNET_API_KEY&gt; <br/>BINANCE_SECRET= &lt;BINANCE_TESTNET_SECRET_KEY&gt;</span></pre><p id="4b08" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">快到了！我们需要创建一个助手函数来在币安测试网交易所下订单。在项目目录中创建一个名为<code class="du mn mo mp me b">helpers</code>的新文件夹，并将以下内容添加到一个新文件中:<code class="du mn mo mp me b">placeOrder.js</code></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="1bb1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">上述脚本将基于指定的选项工作。</p><ul class=""><li id="3a37" class="lk ll hi jl b jm jn jp jq js mq jw mr ka ms ke lr ls lt lu bi translated">如果传递给函数的动作是<code class="du mn mo mp me b">BUY</code>，那么脚本将从总USDT余额中计算出<code class="du mn mo mp me b">BUY_PERCENT</code>(在我们的例子中是30)，并在给定的市场(BTCUSDT)下一个<code class="du mn mo mp me b">MARKET BUY</code>订单。</li><li id="bb47" class="lk ll hi jl b jm lv jp lw js lx jw ly ka lz ke lr ls lt lu bi translated">如果行动是由于负面情绪引起的<code class="du mn mo mp me b">SELL</code>，那么剧本以市场价出售总持有量的大约<code class="du mn mo mp me b">SELL PERCENT</code> (35%)。</li></ul><h1 id="0e3d" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">😋现在是现场表演的时候了:</h1><p id="693d" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js ma ju jv jw mb jy jz ka mc kc kd ke hb bi translated">出于测试目的，我在<code class="du mn mo mp me b">config.js</code>文件中添加了我的Twitter用户Id，并通过运行<code class="du mn mo mp me b"><strong class="jl hj">node app</strong></code>命令启动了机器人。</p><p id="2cca" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">与此同时，我发布了一条正面的推文，声明<code class="du mn mo mp me b">bitcoin is great</code>。输出如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/7438bed066b06be4c80e693fc3cf6957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z0VemW7zWc2DyxKZ3rX9Jw.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Trading Bot Output 1</figcaption></figure><p id="334e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><code class="du mn mo mp me b">trades.log</code>文件插入了以下交易数据。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="12a5" class="mi kt hi me b fi mj mk l ml mm">25/06/2021, 00:06:02 - Bought 0.04739 BTC for 1656.069314602 USDT. OrderID : 5005343</span></pre><p id="bdb3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">酷✨之后，我发布了一些负面和中立的推文。结果很完美！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/c1d676e7dd5c95719f6ff6e754fa4ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ij0-RchvfC5nvVAB6Z5fA.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Trading Bot Output 2</figcaption></figure><p id="6f9f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以看到，我们的机器人忽略了带有<code class="du mn mo mp me b">neutral</code>情绪的推文，并对负面推文下了卖出订单。它像预期的那样工作。</p><p id="23dd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我还尝试使用埃隆·马斯克的账户，以确保机器人按照要求计算情绪。为此，我需要进行一些配置，从他的帐户中获取一些旧推文，并用我们的机器人处理它们。这是我们机器人的情感结果。</p><pre class="iy iz ja jb fd md me mf mg aw mh bi"><span id="5626" class="mi kt hi me b fi mj mk l ml mm">Results [<br/>    {<br/>        "text": "#Bitcoin 💔 ",<br/><strong class="me hj">        "sentiment": "NEGATIVE"</strong><br/>    }<br/>]</span><span id="b75c" class="mi kt hi me b fi mv mk l ml mm">...</span><span id="2092" class="mi kt hi me b fi mv mk l ml mm">Results [<br/>   {<br/>    text: '<a class="ae kr" href="http://twitter.com/Cointelegraph" rel="noopener ugc nofollow" target="_blank">@Cointelegraph</a> This is inaccurate. Tesla only sold ~10% of holdings to confirm BTC could be liquidated easily without moving market.\n' +<br/>      '\n' +<br/>      'When there’s confirmation of reasonable (~50%) clean energy usage by miners with positive future trend, Tesla will resume allowing Bitcoin transactions.',<br/><strong class="me hj">    sentiment: 'POSITIVE'</strong><br/>  }<br/>]</span><span id="dc6d" class="mi kt hi me b fi mv mk l ml mm">...</span></pre><p id="6cf2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">你可以看到我们的机器人正确地评估了情绪💥</p><blockquote class="kf kg kh"><p id="28e3" class="jj jk ki jl b jm jn ij jo jp jq im jr kj jt ju jv kk jx jy jz kl kb kc kd ke hb bi translated"><em class="hi">这个bot的源代码可以在GitHub </em>   <strong class="jl hj"> <em class="hi">这里找到</em><strong class="jl hj"/><a class="ae kr" href="https://github.com/PraneshASP/crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"><strong class="jl hj"><em class="hi">。</em> </strong></a></strong></p></blockquote><h1 id="ecab" class="ks kt hi bd ku kv kw kx ky kz la lb lc io ld ip le ir lf is lg iu lh iv li lj bi translated">👋结束注释:</h1><p id="78be" class="pw-post-body-paragraph jj jk hi jl b jm lm ij jo jp ln im jr js ma ju jv jw mb jy jz ka mc kc kd ke hb bi translated">是的，我同意这个机器人非常简单，一如既往，有很大的改进空间。但主要目标是展示我们如何利用Twitter API，并使用币安API下订单。这个机器人非常有趣，它帮助我们学习一些新的有趣的东西。您可以尝试更改配置文件，并尝试使用这个机器人。如果你发现任何问题或希望分享你的想法，请在评论中发表。</p><p id="4f03" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">编码快乐！🔥🔥</p></div></div>    
</body>
</html>
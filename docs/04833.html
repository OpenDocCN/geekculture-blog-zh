<html>
<head>
<title>Google Kubernetes Engine Part 1: Nodes, Pods, Controllers and Services (Road to Google Associate Cloud Engineer 2020 certification)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google Kubernetes引擎第1部分:节点、pod、控制器和服务(通往Google协理云工程师2020认证之路)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/google-kubernetes-engine-part-1-nodes-pods-controllers-and-services-road-to-google-associate-55c8fe46f301?source=collection_archive---------40-----------------------#2021-07-04">https://medium.com/geekculture/google-kubernetes-engine-part-1-nodes-pods-controllers-and-services-road-to-google-associate-55c8fe46f301?source=collection_archive---------40-----------------------#2021-07-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dedd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes是认证最重要的论据之一。Google Kubernetes引擎是运行Docker容器的集群管理器和协调器。它将容器调度到一个集群中，并根据使用配置文件(YAML格式)以声明方式定义的需求自动管理它们。</p><p id="5756" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes包括许多概念:</p><ul class=""><li id="afc8" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated"><a class="ae jd" href="http://kubernetes.io/docs/admin/node/" rel="noopener ugc nofollow" target="_blank">节点</a>:一个节点是一个Kubernetes集群中的工作机，在Google Kubernetes引擎中，这个机器总是一个<a class="ae jd" href="https://cloud.google.com/compute/docs/instances/" rel="noopener ugc nofollow" target="_blank">计算引擎实例</a>。</li><li id="bf9a" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">pod:pod是一组一个或多个容器、共享存储以及与这些容器相关的配置数据。在Kubernetes中运行的生产应用程序通常会在一个pod中包含多个相对紧密耦合的容器。</li><li id="a0ee" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><a class="ae jd" href="http://kubernetes.io/docs/user-guide/replication-controller/" rel="noopener ugc nofollow" target="_blank">复制控制器</a>:复制控制器工作以确保所请求数量的pod副本在给定时间总是可用并运行。复制控制器根据需要自动添加或移除单元，以保持所需的状态。</li><li id="0cdf" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated"><a class="ae jd" href="http://kubernetes.io/docs/user-guide/services/" rel="noopener ugc nofollow" target="_blank">服务</a>:服务定义了一组逻辑pod，以及使用IP地址和端口号对访问它们的方法。</li></ul><p id="69c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他必须熟知的概念:</p><ul class=""><li id="c4c9" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">使用<em class="js"> gcloud </em> CLI创建和管理集群</li><li id="810b" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">使用<em class="js"> kubectl </em> CLI管理pod和服务</li><li id="d09a" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">不同类型的服务</li><li id="b9e8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">水平Pod缩放</li><li id="1c56" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">挂起窗格的调试</li></ul><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/51ba673f68ef68ac9993ec3fd289d9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*qym77RjAbVPZnU3Dv2zTtQ.png"/></div></figure><h1 id="b7a6" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">节点</h1><p id="b9fe" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Kubernetes通过将容器放入Pods中在<em class="js">节点</em>上运行来运行您的工作负载。根据群集的不同，节点可以是虚拟机或物理机。每个节点由<a class="ae jd" href="https://kubernetes.io/docs/reference/glossary/?all=true#term-control-plane" rel="noopener ugc nofollow" target="_blank">控制平面</a>管理，并包含运行<a class="ae jd" href="https://kubernetes.io/docs/concepts/workloads/pods/" rel="noopener ugc nofollow" target="_blank">pod</a>所需的服务</p><p id="ab0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，一个群集中有几个节点；在学习或资源有限的环境中，您可能只有一个节点。</p><p id="26f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://kubernetes.io/docs/concepts/overview/working-with-objects/names#names" rel="noopener ugc nofollow" target="_blank">名称</a>标识一个节点。两个节点不能同时具有相同的名称。</p><h1 id="a950" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">分离舱</h1><p id="aaa8" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Kubernetes的核心是<a class="ae jd" href="http://kubernetes.io/docs/user-guide/pods/" rel="noopener ugc nofollow" target="_blank">舱</a>。</p><p id="5eb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pod表示并持有一个或多个容器的集合。通常，如果您有多个相互依赖的容器，那么您可以将这些容器打包到一个pod中。</p><p id="0e05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">豆荚也有<a class="ae jd" href="http://kubernetes.io/docs/user-guide/volumes/" rel="noopener ugc nofollow" target="_blank">卷</a>。卷是数据磁盘，只要pod存在，卷就存在，并且可以由pod中的容器使用。pod为其内容提供了一个共享的名称空间，这意味着我们的示例pod中的两个容器可以相互通信，并且它们还共享附加的卷。</p><p id="fcb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">pod还共享一个网络名称空间。这意味着每个pod有一个IP地址。</p><h1 id="15f3" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">控制器</h1><p id="d479" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">有不同类型的控制器</p><h2 id="63ab" class="le kc hi bd kd lf lg lh kh li lj lk kl iq ll lm kp iu ln lo kt iy lp lq kx lr bi translated">达蒙塞特</h2><p id="4502" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj"> DaemonSet </strong>确保所有(或一些)节点运行一个Pod的副本。随着节点添加到集群中，单元也会添加到其中。随着节点从集群中移除，这些pod将被垃圾收集。删除DaemonSet将清理它创建的pod。<br/>DaemonSet的一些典型用途包括:</p><ul class=""><li id="2291" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">在每个节点上运行集群存储守护程序</li><li id="2a76" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">在每个节点上运行日志收集守护程序</li><li id="001f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">在每个节点上运行节点监控守护程序</li></ul><h2 id="f4b7" class="le kc hi bd kd lf lg lh kh li lj lk kl iq ll lm kp iu ln lo kt iy lp lq kx lr bi translated">复制集</h2><p id="0fb4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">一个<strong class="ih hj">副本集的</strong>目的是在任何给定时间保持一组稳定的副本盒运行。因此，它通常用于保证指定数量的相同pod的可用性。<br/> ReplicaSet负责维护所需的pod数量，因此，删除它也会删除pod。</p><h2 id="dd4a" class="le kc hi bd kd lf lg lh kh li lj lk kl iq ll lm kp iu ln lo kt iy lp lq kx lr bi translated">状态集</h2><p id="b7c2" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj">状态集</strong>状态集对于需要以下一项或多项的应用程序很有价值</p><ul class=""><li id="bf17" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">稳定、唯一的网络标识符。</li><li id="7282" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">稳定持久的存储。</li><li id="7db3" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">有序、优雅的部署和扩展。</li><li id="4fe2" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">有序的自动滚动更新。</li></ul><p id="08eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与部署不同，StatefulSet为它们的每个pod维护一个粘性身份。这些pod是根据相同的规范创建的，但是不可互换:每个pod都有一个永久的标识符，它在任何重新调度中都维护这个标识符</p><h1 id="1388" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">服务</h1><p id="d396" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">豆荚并不意味着持久。它们可以因为许多原因而停止或启动，比如失败的活性或就绪检查，这导致了一个问题:如果您想要与一组pod通信，会发生什么？当他们重新启动时，他们可能会有一个不同的IP地址。</p><p id="678f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是服务发挥作用的地方。服务为pod提供稳定的端点。</p><p id="d78b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">服务使用标签来确定它们在什么样的pod上运行。如果包装有正确的标签，我们的服务人员会自动将它们取出并暴露出来。</p><p id="2d89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">服务提供给一组pod的访问级别取决于服务的类型。目前有三种类型:</p><ul class=""><li id="830d" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">ClusterIP(内部)—默认类型意味着此服务仅在群集内部可见，</li><li id="a90b" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">节点端口为集群中的每个节点提供一个外部可访问的IP</li><li id="3cdd" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">LoadBalancer添加了一个来自云提供商的负载平衡器，它将流量从服务转发到其中的节点。</li><li id="fcd9" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">入口服务会创建一个HTTPS负载平衡器，并根据指定的信息进行相应配置，以允许访问集群</li></ul><h1 id="763b" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">控制平面</h1><p id="be84" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">控制平面是Kubernetes组件，它管理集群中的工作节点和pod。</p><p id="4b24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在生产环境中，控制平面跨多台机器运行，一个群集跨多个节点运行，以提供容错能力。</p><p id="42ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">控制平面对集群做出决策(例如调度)并对集群事件做出响应(例如当需要创建新的Pod来满足扩展要求时)。</p></div></div>    
</body>
</html>
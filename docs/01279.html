<html>
<head>
<title>Stock Price Forecasting Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的股票价格预测</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/stock-price-forecasting-using-machine-learning-5d86867f325f?source=collection_archive---------13-----------------------#2021-04-04">https://medium.com/geekculture/stock-price-forecasting-using-machine-learning-5d86867f325f?source=collection_archive---------13-----------------------#2021-04-04</a></blockquote><div><div class="es gl gm gn go gp"/><div class="gq gr gs gt gu"><div class=""/><p id="725c" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">股票价格预测有助于确定股票在未来几天或几周内的走势，或者至少显示出趋势。股票价格取决于各种因素，仅举几个例子—</p><p id="2c65" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated"><strong class="hw gy">基本因素</strong>:收入、利润、市场份额、业务的潜在增长前景</p><p id="cda8" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated"><strong class="hw gy">外部因素</strong>:电晕、汇率、油价、金价、债券收益率、全球股市等流行病</p><p id="e626" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated"><strong class="hw gy"/>:价格动作、成交量、移动平均线、MACD(移动平均线收敛背离)、RSI(相对强度指数)、MFI(资金流动指数)、支点、衍生品到期日、期权未平仓合约、期货价格</p><p id="d37e" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">不管有没有这些因素，</p><ol class=""><li id="c443" class="is it gx hw b hx hy ib ic if iu ij iv in iw ir ix iy iz ja bi translated">股票价格不是随机的，它们确实遵循一些基于过去历史的趋势</li><li id="0e62" class="is it gx hw b hx jb ib jc if jd ij je in jf ir ix iy iz ja bi translated">人类的决策是情感和理性的结合，倾向于参考过去的数据</li><li id="45da" class="is it gx hw b hx jb ib jc if jd ij je in jf ir ix iy iz ja bi translated">市场永远是对的。他们只会惩罚错误的决定</li><li id="57c5" class="is it gx hw b hx jb ib jc if jd ij je in jf ir ix iy iz ja bi translated">贪婪、盲目跟注、高风险偏好、谨慎行事都可以根据时间来奖励或惩罚投资者。</li></ol><p id="fc0d" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">在本文中，我们将尝试来自脸书的先知</p><h1 id="15b0" class="jg jh gx bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd bi translated">先知</h1><p id="cd9f" class="pw-post-body-paragraph hu hv gx hw b hx ke hz ia ib kf id ie if kg ih ii ij kh il im in ki ip iq ir gq bi translated">我挑选了CDSL ( <a class="ae kj" href="https://www.cdslindia.com/#:~:text=CDSL%20%2D%20Central%20Depository%20Services%20(India)%20Limited" rel="noopener ugc nofollow" target="_blank">中央存管服务(印度)有限公司</a>)的股票进行分析。数据可以从<a class="ae kj" href="https://www.nseindia.com/get-quotes/equity?symbol=CDSL" rel="noopener ugc nofollow" target="_blank">https://www.nseindia.com/get-quotes/equity?symbol=CDSL</a>下载并点击历史数据。考虑到2020年3月的市场崩溃是一个黑天鹅事件，我选取了从2020年4月到2021年4月的一年数据。</p><blockquote class="kk kl km"><p id="5bbc" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">将熊猫导入为PD<br/>cdsl = PD . read _ CSV('/Users/ravindraprasad/01-Elicherla/01-data science/cdslapril . CSV ')</p></blockquote><p id="cda0" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">上面的代码是导入熊猫和下载数据。请在代码中使用适当的文件夹。</p><p id="c6e7" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">CDSL用标题显示了下面的数据。</p><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz kr"><img src="../Images/4d3e043c9a0b0cf3b7f9d87d3e152159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wszWL-K1TS8p9rmxggVXA.png"/></div></div></figure><p id="2025" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">列名有一个小问题。以免列下各列</p><blockquote class="kk kl km"><p id="8d19" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">列表(cdsl .列)</p></blockquote><p id="ba30" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">正如您在下面看到的，在列名的末尾有一个空格</p><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz ld"><img src="../Images/ae77b7702ce3dba0f0a2bd3bc4a315bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvNWYcnp260_amsrh1z3Eg.png"/></div></div></figure><p id="ca3b" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">我正在更改列名</p><blockquote class="kk kl km"><p id="ae2e" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">df = cdsl . rename(columns = { ' Date ':' Date '，' series ': 'series '，' OPEN ': 'Open '，' HIGH ': 'High '，' LOW ': 'Low '，' PREV。关闭“:”上一页。CLOSE '，' ltp ': 'ltp '，' close ': 'close '，' vwap ': 'vwap '，' 52W H ': '52W H '，' 52W L ': '52W L '，' VOLUME ': 'VOLUME '，'笔数': '笔数' }，inplace = False)</p></blockquote><p id="ffd1" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">现在，所有列的名称都改为相同的名称，但没有空格</p><p id="3b67" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">要使用prophet，日期是重要的变量。</p><blockquote class="kk kl km"><p id="310e" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">cdsl['日期']</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz le"><img src="../Images/7f26aa05e52abb06d84ece0a85bc3f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pmc8OH1ud6Q_sbm05tKcdQ.png"/></div></div></figure><p id="f7da" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">这看起来确实像一次正式的约会。但是当我们分类的时候，有一个挑战。如下图所示，排序不正确。这是因为不正确的日期格式。</p><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lf"><img src="../Images/63918e5a8052db23afb3bb83a2aef5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_-yjC10kpOKAx443ARfOQ.png"/></div></div></figure><p id="f25a" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">现在让我们改变日期格式。</p><blockquote class="kk kl km"><p id="ea63" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">df['Date'] = pd.to_datetime(df。Date，format = ' % d-% b-% Y ')<br/>df . sort _ values(by =[' Date ']，inplace=True，ascending=True) <br/> df</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lg"><img src="../Images/084f317f86922ea4aaefd92ed3f2c5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EgTd3XolUvG0KMl6CGCY8w.png"/></div></div></figure><p id="e6e1" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">现在日期整理出来了。让；使用matplotlib绘制数据</p><blockquote class="kk kl km"><p id="ce65" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">从matplotlib导入pyplot作为plt <br/>导入numpy作为NP<br/>x = df[' Date ']<br/>y = df[' LTP ']<br/>PLT . plot(x，y)</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lh"><img src="../Images/60372a8352a6b1f09276d4a4a1b82d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQJpiYuRLxTJz9hdB70ZKw.png"/></div></div></figure><p id="c817" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">现在是时候为预言者准备数据了。先知只需要两个变量。我们将使用日期和ltp(最后交易价格)</p><blockquote class="kk kl km"><p id="a766" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">dfdata = df[["Date "，" LTP "]]<br/>df data . rename(columns = { " Date ":" ds " }，inplace=True)<br/>df data . rename(columns = { " LTP ":" y " }，in place = True)</p></blockquote><p id="47d1" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">对于Prophet，需要调用两个变量，分别为“ds”和“y”，我们在上面进行了重命名。在进行预测之前，让我们快速浏览一下数据</p><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz li"><img src="../Images/bcf487a39d99b9c040f1781eb1dacbdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gK7ynry7ulOlV7Q_yFvKA.png"/></div></div></figure><p id="2a21" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">导入prophet并使用数据创建模型。</p><blockquote class="kk kl km"><p id="c7ff" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">从fbprophet导入Prophet<br/>m = Prophet()<br/>m . fit(df data)</p></blockquote><p id="8357" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">让我们预测未来300天。</p><blockquote class="kk kl km"><p id="7f52" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">future = m . make _ future _ data frame(periods = 300)<br/>future . tail()</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lj"><img src="../Images/fc6ba9c9b67b19786df9b0e272e42252.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNI4fGrfSvHp_23lCBbovg.png"/></div></div></figure><blockquote class="kk kl km"><p id="fafe" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">forecast = m . predict(future)<br/>df forecast = forecast[[" ds "，" yhat "，" yhat_lower "，" yhat _ upper "]]<br/>PD . set _ option(' display . max _ rows '，df forecast . shape[0]+1)<br/>df forecast</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lk"><img src="../Images/86b7914bfcf3e8e5ce6a6d49b5290d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ePVv_ZYxbq9KAwxG80ihg.png"/></div></div></figure><blockquote class="kk kl km"><p id="c077" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">图1 = m.plot(预测)</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz ll"><img src="../Images/05d43f52b25928768701911431cc8140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40XRnch3Z_C3mdkyzv69oA.png"/></div></div></figure><blockquote class="kk kl km"><p id="3c32" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">图2 = m.plot_components(预测)</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lm"><img src="../Images/036288f23d7f11a6985b57e3b2def9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AOpR4Fl60WHFN1O5a4LB1A.png"/></div></div></figure><p id="2283" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">让我们构建交互式图形。</p><blockquote class="kk kl km"><p id="02dc" class="hu hv kn hw b hx hy hz ia ib ic id ie ko ig ih ii kp ik il im kq io ip iq ir gq bi translated">from fbprophet . plot import plot _ plotly<br/>import plot ly . offline as py<br/>py . init _ notebook _ mode()<br/>fig = plot _ plot ly(m，forecast) #这将返回一个plot ly图形<br/> py.iplot(fig)</p></blockquote><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz ln"><img src="../Images/e0e7041cef09f51db97b75845d507eb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIH4noFllgW1iYWHJWXm7A.png"/></div></div></figure><p id="eb88" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated">该模型预测CDSL达到Rs。11月第1周1000，Rs下侧。Rs的859和更高侧。1164.让我们拭目以待吧！！！</p><figure class="ks kt ku kv ek kw dy dz paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="dy dz lo"><img src="../Images/26813c8831363b1cba472635fcbe64cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*969ivZH1cWaff4-aAKKhdg.png"/></div></div></figure><p id="c9d1" class="pw-post-body-paragraph hu hv gx hw b hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq ir gq bi translated"><em class="kn">免责声明:股票价格的变化取决于许多因素，而不仅仅是过去的数据。这篇文章不是投资建议，纯粹是为了教育目的。请向您的财务顾问咨询任何具体的投资建议。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>Modelling a modern day pandemic — Developing the SIR model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟现代疫情——发展SIR模型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/modelling-a-modern-day-pandemic-developing-the-sir-model-8d77599050ce?source=collection_archive---------46-----------------------#2021-06-28">https://medium.com/geekculture/modelling-a-modern-day-pandemic-developing-the-sir-model-8d77599050ce?source=collection_archive---------46-----------------------#2021-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b99b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上一篇文章中，我们讨论了为什么我们要对疾病进行建模，以及我们可以使用哪些技术。在这一课中，我们将会看到，如何发展一个微分方程系统的模型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/11a445e36ba3d17132c6302753119a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*y6m9ptvZiaTel1TYmaPWZQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Source: Author</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/04dbdce1de4825896e33202de0b2559b.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*nhuUl8Lp2Lubrd-8SproHg.png"/></div></figure><p id="8a69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们讨论了前一篇文章中使用的三个微分方程，所以给你一个简要的介绍。第一个表明易感图的梯度与个体的感染率成反比。第二个显示感染图的梯度等于人们被感染的速率减去人们从模型中被移除的速率。最后一张显示，去除图形的梯度与感染人数成正比。</p><h1 id="e4fe" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">构建模型</h1><p id="f3c0" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">Python是开发这个模型的理想语言选择，因为它有丰富的图形工具库和快速的开发时间。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="f80d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先要决定使用哪个绘图库，matplotlib是显而易见的选择，因为它易于使用。如果你没有安装matplotlib，你将不得不使用pip来安装它。</p><h1 id="957d" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Windows操作系统</h1><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="d505" class="lf jr hi lb b fi lg lh l li lj">py -m pip install matplotlib</span></pre><h1 id="8dea" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak"> Unix/OSX </strong></h1><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="2a83" class="lf jr hi lb b fi lg lh l li lj">python3 -m pip install matplotlib</span></pre><p id="83c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将matplotlib添加到python代码中时，我们需要指定要添加matplotlib的哪一部分，在本例中，我们要添加pyplot。我们还将把它安装为plt，以避免到处编写matplotlib.pyplot。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="c588" class="lf jr hi lb b fi lg lh l li lj">install matplotlib.pyplot as plt</span></pre><p id="7a8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的模型，我们还需要导入另外两个模块numpy和scipy。您可以使用pip来完成此操作。然后我们需要将它们添加到我们的python代码中。对于scipy，像matplotlib一样，我们需要指定我们想要的部分，我们想要可以在scipy的积分部分找到的微分方程解算器。所以现在代码应该是这样的</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="6b07" class="lf jr hi lb b fi lg lh l li lj">install matplotlib.pyplot as plt<br/>import numpy as np<br/>from scipy.integrate import odeint</span></pre></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="907b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的主函数中，我们希望获得以下值:总人口、开始感染、开始删除、被感染的概率、被删除的概率和模型运行时间。你可以用任何你想要的方式来做，我选择让用户输入它们</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="ab45" class="lf jr hi lb b fi lg lh l li lj">def main():<br/>    N = int(input("Total Population: ")) <br/>    I_0 = int(input("Total Number of Infected at time = 0: "))<br/>    R_0 = int(input("Total Number of Removed at time = 0: "))<br/>    S_0 = N - I_0 - R_0 #S_0 is starting susceptible<br/>    alpha = float(input("Chance of Infection: ")) <br/>    beta = float(input("Fraction of People who recover per day: "))<br/>    MaxTime = int(input("Time for which the model should run: "))<br/>    RunTime = np.linspace(0, MaxTime, MaxTime)</span></pre><p id="a1e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然手动求解微分方程系统是可能的，但是用python函数来解决这个问题会更快。这就是scipy的用武之地。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="128f" class="lf jr hi lb b fi lg lh l li lj">def Find_Deriv(y, RunTime, N, alpha, beta):<br/>    S, I, R = y<br/>    dsdt = -alpha * S * I/N<br/>    didt = (alpha * S * I/N) - (beta * I)<br/>    drdt = beta * I<br/>    return dsdt, didt, drdt</span></pre><p id="95b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个函数告诉模型在模型中给定点的微分方程是什么。我们现在必须给我们的主函数添加一些代码</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="887c" class="lf jr hi lb b fi lg lh l li lj">y_0 = S_0, I_0, R_0<br/>coord = odeint(Find_Deriv, y_0, RunTime, args = (N, alpha, beta))<br/>S, I, R = coord.T</span></pre><p id="0734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这3条线为每次计数生成3个图形的坐标。现在是简单的部分，绘制图表。</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="0b35" class="lf jr hi lb b fi lg lh l li lj">fig = plt.pyplot.figure(facecolor ='w')<br/>ax = fig.add_subplot(111, facecolor = '#dddddd', axisbelow = True)<br/>ax.plot(RunTime, S/1000, 'b', alpha = 0.5, lw = 2, label = "Susceptible")<br/>ax.plot(RunTime, I/1000, 'r', alpha = 0.5, lw = 2, label = "Infected")<br/>ax.plot(RunTime, R/1000, 'g', alpha = 0.5, lw = 2, label = "Removed")</span><span id="918a" class="lf jr hi lb b fi lk lh l li lj">ax.set_xlabel('Time/count')<br/>ax.set_ylabel('Number Of people / 1000')<br/>ax.yaxis.set_tick_params(length = 0)<br/>ax.xaxis.set_tick_params(length = 0)<br/>ax.grid(b=True, which = 'major', c= 'w', lw=2, ls='-')<br/>legend = ax.legend()<br/>legend.get_frame().set_alpha(0.5)<br/>for x in ('top', 'right', 'bottom', 'left'):<br/>    ax.spines[x].set_visible(False)</span><span id="05b4" class="lf jr hi lb b fi lk lh l li lj">plt.pyplot.show()</span></pre><p id="8d0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦将这个添加到主函数中，我们就有了模型。所以把它们放在一起，我们得到了SIR模型</p><pre class="je jf jg jh fd la lb lc ld aw le bi"><span id="31f3" class="lf jr hi lb b fi lg lh l li lj">import matplotlib.pyplot as plt<br/>import numpy as np<br/>from scipy.integrate import odeint</span><span id="e9b8" class="lf jr hi lb b fi lk lh l li lj">def Find_Deriv(y, RunTime, N, alpha, beta):<br/>    S, I, R = y<br/>    dsdt = -alpha * S * I/N<br/>    didt = (alpha * S * I/N) - (beta * I)<br/>    drdt = beta * I<br/>    return dsdt, didt, drdt</span><span id="ef4f" class="lf jr hi lb b fi lk lh l li lj">def main():<br/>    N = int(input("Total Population: ")) #N = TotalPopulation<br/>    I_0 = int(input("Total Number of Infected at time = 0: "))<br/>    R_0 = int(input("Total Number of Removed at time = 0: "))<br/>    S_0 = N - I_0 - R_0</span><span id="2818" class="lf jr hi lb b fi lk lh l li lj">    alpha = float(input("Chance of Infection: ")) #Chance of     Infection<br/>    beta = float(input("Fraction of People who recover per day: ")) #Fraction Of people who recover per count</span><span id="eeff" class="lf jr hi lb b fi lk lh l li lj">    MaxTime = int(input("Time for which the model should run: "))<br/>    RunTime = np.linspace(0, MaxTime, MaxTime)</span><span id="e81c" class="lf jr hi lb b fi lk lh l li lj">    y_0 = S_0, I_0, R_0<br/>    coord = odeint(Find_Deriv, y_0, RunTime, args = (N, alpha, beta))<br/>    S, I, R = coord.T</span><span id="52d3" class="lf jr hi lb b fi lk lh l li lj">    fig = plt.pyplot.figure(facecolor ='w')<br/>    ax = fig.add_subplot(111, facecolor = '#dddddd', axisbelow = True)<br/>    ax.plot(RunTime, S/1000, 'b', alpha = 0.5, lw = 2, label = "Susceptible")<br/>    ax.plot(RunTime, I/1000, 'r', alpha = 0.5, lw = 2, label = "Infected")<br/>    ax.plot(RunTime, R/1000, 'g', alpha = 0.5, lw = 2, label = "Removed")</span><span id="33af" class="lf jr hi lb b fi lk lh l li lj">    ax.set_xlabel('Time/count')<br/>    ax.set_ylabel('Number Of people / 1000')<br/>    ax.yaxis.set_tick_params(length = 0)<br/>    ax.xaxis.set_tick_params(length = 0)<br/>    ax.grid(b=True, which = 'major', c= 'w', lw=2, ls='-')<br/>    legend = ax.legend()<br/>    legend.get_frame().set_alpha(0.5)<br/>    for x in ('top', 'right', 'bottom', 'left'):<br/>        ax.spines[x].set_visible(False)</span><span id="742b" class="lf jr hi lb b fi lk lh l li lj">    plt.pyplot.show()</span><span id="d587" class="lf jr hi lb b fi lk lh l li lj">main()</span></pre><p id="8b67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您运行代码时，只要您没有犯任何错误，您将会得到一个类似这样的图形</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/c3cc6147741ebd2748e588aa69d70da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*VWYQuDSE4ESWp93uHRlbog.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Source: Author</figcaption></figure><p id="40c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本例中:</p><ul class=""><li id="0bd5" class="ll lm hi ih b ii ij im in iq ln iu lo iy lp jc lq lr ls lt bi translated">总人口= 500000</li><li id="77a4" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">开始感染= 1</li><li id="e211" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">移除起始= 0</li><li id="b0e0" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">感染几率= 0.08</li><li id="941f" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated">被移除的几率= 0.03</li></ul><p id="0bd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这篇文章对如何构建一个基本的微分方程模型有所启发。在接下来的两篇文章中，我们将着眼于基于代理的模型的开发。</p></div></div>    
</body>
</html>
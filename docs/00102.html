<html>
<head>
<title>How to use PDF.js and how to create a simple PDF viewer for your web in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用PDF.js以及如何用JavaScript为您的网站创建一个简单的PDF查看器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-use-pdf-js-and-how-to-create-a-simple-pdf-viewer-for-your-web-in-javascript-5cff608a3a10?source=collection_archive---------0-----------------------#2020-05-21">https://medium.com/geekculture/how-to-use-pdf-js-and-how-to-create-a-simple-pdf-viewer-for-your-web-in-javascript-5cff608a3a10?source=collection_archive---------0-----------------------#2020-05-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/a98421b08cab187e699a39f0eecc414c.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/0*LX_CKibd4UgKgZ3N"/></div></figure><div class=""/><p id="cb38" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我看到了这个库，它在PDF方面给了我很大的帮助，我可以用纯JavaScript可视化PDF在线更改页面。令人惊讶的是，我正在共享这个库和代码，为您的网站创建一个动态PDF可视化工具。</p><figure class="jk jl jm jn fd hk"><div class="bz dy l di"><div class="jo jp l"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Video example how to create a PDF viewer with PDF.js</figcaption></figure><p id="2129" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我制作了一个视频，如果你也想看的话📽📹📼它有你需要的一切，我会在最后分享代码，谢谢和享受。</p><p id="e7d0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先你需要创建route应用程序，我只有两个目录，一个用于代码，一个用于pdf。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es ju"><img src="../Images/6e3c38f23916353a0918b179b7ec67cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*nyh57gNsffPITU5wmM7TkQ.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Document to start</figcaption></figure><p id="6247" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后用两个按钮创建Index.html一个span和一个canvas每个人都有各自的id，这个库非常重要我也链接了我的app.js文件。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/49ee02165fb01b76d5d02c6977ac1710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wTlC2845fhjeaqrdt3nbw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Writing some basic structure</figcaption></figure><p id="928f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这是代码</p><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="b2d1" class="kf kg hp kb b fi kh ki l kj kk">&lt;!DOCTYPE <em class="kl">html</em>&gt;</span><span id="2d8a" class="kf kg hp kb b fi km ki l kj kk">&lt;html <em class="kl">lang</em>="en"&gt;</span><span id="42ff" class="kf kg hp kb b fi km ki l kj kk">&lt;head&gt;</span><span id="5bef" class="kf kg hp kb b fi km ki l kj kk">&lt;meta <em class="kl">charset</em>="UTF-8"&gt;</span><span id="5334" class="kf kg hp kb b fi km ki l kj kk">&lt;meta <em class="kl">name</em>="viewport" <em class="kl">content</em>="width=device-width, initial-scale=1.0"&gt;</span><span id="0300" class="kf kg hp kb b fi km ki l kj kk">&lt;title&gt;Document&lt;/title&gt;</span><span id="9980" class="kf kg hp kb b fi km ki l kj kk">&lt;style&gt;</span><span id="7c01" class="kf kg hp kb b fi km ki l kj kk">canvas{</span><span id="0a1b" class="kf kg hp kb b fi km ki l kj kk">border: 1px solid #000</span><span id="7893" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="9452" class="kf kg hp kb b fi km ki l kj kk">&lt;/style&gt;</span><span id="0043" class="kf kg hp kb b fi km ki l kj kk">&lt;/head&gt;</span><span id="92aa" class="kf kg hp kb b fi km ki l kj kk">&lt;body&gt;</span><span id="c828" class="kf kg hp kb b fi km ki l kj kk">&lt;button <em class="kl">id</em>="prev"&gt;Prev&lt;/button&gt;</span><span id="f6f1" class="kf kg hp kb b fi km ki l kj kk">&lt;button <em class="kl">id</em>="next"&gt;Next&lt;/button&gt;</span><span id="1044" class="kf kg hp kb b fi km ki l kj kk">&lt;span <em class="kl">id</em>="npages"&gt;not yet&lt;/span&gt;</span><span id="0d46" class="kf kg hp kb b fi km ki l kj kk">&lt;div&gt;</span><span id="8c9b" class="kf kg hp kb b fi km ki l kj kk">&lt;canvas <em class="kl">id</em>="cnv"&gt;&lt;/canvas&gt;</span><span id="ffb6" class="kf kg hp kb b fi km ki l kj kk">&lt;/div&gt;</span><span id="acd0" class="kf kg hp kb b fi km ki l kj kk">&lt;script <em class="kl">src</em>="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.4.456/pdf.min.js"&gt;&lt;/script&gt;</span><span id="01c4" class="kf kg hp kb b fi km ki l kj kk">&lt;script <em class="kl">src</em>="./app.js"&gt;&lt;/script&gt;</span><span id="c74e" class="kf kg hp kb b fi km ki l kj kk">&lt;/body&gt;</span><span id="ad08" class="kf kg hp kb b fi km ki l kj kk">&lt;/html&gt;</span></pre><p id="bb20" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们会看到这样的东西</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es kn"><img src="../Images/cbb216e36ef007ee61bfbf73eb855164.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*YNCgInM0QA1RowYQHs69VA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Example how will see the viewer</figcaption></figure><p id="aa80" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我可以从JavaScript开始，你需要使用load事件来启动我们的JavaScript和两个函数来启动我传递了我们的PDF文件的路径，使它有点动态</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ko"><img src="../Images/05d3c71f6e25e0df7e64e5c4ccfbc3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMBpgA4hvd9aNXhCT0AWBA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Example how we can start our function</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="322b" class="kf kg hp kb b fi kh ki l kj kk">const PDFStart = <em class="kl">nameRoute </em>=&gt; {</span><span id="c385" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="01d3" class="kf kg hp kb b fi km ki l kj kk">const startPdf = () =&gt; {</span><span id="0380" class="kf kg hp kb b fi km ki l kj kk">PDFStart('../media/r.pdf')</span><span id="1756" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="d624" class="kf kg hp kb b fi km ki l kj kk">window.addEventListener('load', startPdf);</span></pre><p id="eb7b" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">之后，我们需要对这个库很重要的变量，我们从loadingTask开始这个变量有关于PDF的所有信息，我们传递了名称Route我们的PDF文件的路径，pdfDoc画布和画布的上下文，比例和页数。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kp"><img src="../Images/74ab0d0e40fe0ac96c22e29ce597081e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q9kcUj14AcPGgZlv1VMSGQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">The most important variables for PDF.js</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="50ce" class="kf kg hp kb b fi kh ki l kj kk">let loadingTask = pdfjsLib.getDocument(<em class="kl">nameRoute</em>),</span><span id="8067" class="kf kg hp kb b fi km ki l kj kk">pdfDoc = null,</span><span id="0c81" class="kf kg hp kb b fi km ki l kj kk">canvas = document.querySelector('#cnv'),</span><span id="35dd" class="kf kg hp kb b fi km ki l kj kk">ctx = canvas.getContext('2d'),</span><span id="926b" class="kf kg hp kb b fi km ki l kj kk">scale = 1.5,</span><span id="c7a9" class="kf kg hp kb b fi km ki l kj kk">numPage = 1;</span></pre><p id="949f" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我创建了promise来获取PDF的信息(PDF.js与promises一起工作),并设置PDF的页数范围。我们将生成另一个名为GeneratePDF(numPage)的函数。我传递了numPage变量，该变量目前为1。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kq"><img src="../Images/f5f64e6e3261a0c995441698ba471efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3O0M-8_Z6pacfJFMSBOZkg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Example for the first page</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="a770" class="kf kg hp kb b fi kh ki l kj kk">loadingTask.promise.then(<em class="kl">pdfDoc_</em> =&gt; {</span><span id="4c42" class="kf kg hp kb b fi km ki l kj kk">pdfDoc = <em class="kl">pdfDoc_</em>;</span><span id="cf66" class="kf kg hp kb b fi km ki l kj kk">document.querySelector('#npages').innerHTML = pdfDoc.numPages;</span><span id="fa89" class="kf kg hp kb b fi km ki l kj kk">GeneratePDF(numPage)</span><span id="91de" class="kf kg hp kb b fi km ki l kj kk">});</span></pre><p id="7ab5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">GeneratePDF函数是关键，因为它会将PDF打印到画布上，我使用pdfDoc获得具有另一个承诺的页面，然后我们需要页面视口(宽度和高度),我设置画布大小和renderContext对象，我插入ctx和视口，接下来我使用renderContext内的信息渲染页面，并使用npages的范围更新被渲染的页面的编号。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kr"><img src="../Images/de8a9b897aa310de27a951f2e3f4e59f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgZL2uKXOtZxlYUzI8ZG7Q.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">creating the viewer with PDF.js</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="7cdd" class="kf kg hp kb b fi kh ki l kj kk">const GeneratePDF = <em class="kl">numPage</em> =&gt; {</span><span id="77a5" class="kf kg hp kb b fi km ki l kj kk">pdfDoc.getPage(<em class="kl">numPage</em>).then(<em class="kl">page</em> =&gt; {</span><span id="63e1" class="kf kg hp kb b fi km ki l kj kk">let viewport = <em class="kl">page</em>.getViewport({ scale: scale });</span><span id="9d38" class="kf kg hp kb b fi km ki l kj kk">canvas.height = viewport.height;</span><span id="ffaf" class="kf kg hp kb b fi km ki l kj kk">canvas.width = viewport.width;</span><span id="9629" class="kf kg hp kb b fi km ki l kj kk">let renderContext = {</span><span id="b05e" class="kf kg hp kb b fi km ki l kj kk">canvasContext : ctx,</span><span id="8f2f" class="kf kg hp kb b fi km ki l kj kk">viewport:  viewport</span><span id="730c" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="ab44" class="kf kg hp kb b fi km ki l kj kk"><em class="kl">page</em>.render(renderContext);</span><span id="a78d" class="kf kg hp kb b fi km ki l kj kk">})</span><span id="c744" class="kf kg hp kb b fi km ki l kj kk">document.querySelector('#npages').innerHTML = <em class="kl">numPage</em>;</span><span id="1c6b" class="kf kg hp kb b fi km ki l kj kk">}</span></pre><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ks"><img src="../Images/2f6344385d3f5114244e804bf5d893ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZBmFEOry7mgSHv91HiK1IQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Example how we see the PDF on the browser</figcaption></figure><p id="a095" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于按钮，我需要创建事件和函数，但逻辑并不复杂，下一个和上一个几乎相同，我用addEventListener和click事件调用</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kt"><img src="../Images/cd14efb4751e29a21acd455c5f0cd182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omVE26LzPUulutwl4YApRQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Example ho we use the buttons to create interactions with the viewer</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="1bd1" class="kf kg hp kb b fi kh ki l kj kk">document.querySelector('#prev').addEventListener('click', PrevPage)</span><span id="87d4" class="kf kg hp kb b fi km ki l kj kk">document.querySelector('#next').addEventListener('click', NextPage)</span></pre><p id="ada1" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">prev函数需要一个条件才能正常工作，如果页数等于1，则不返回任何其他内容。再次调用generate pdf(numPage ), numPage将减少1。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es ku"><img src="../Images/5542cd77f84a68b3790b629d9be18716.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*2F-Z_dcoNfCkWc35pyVJjg.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Creating the Previous button</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="15a5" class="kf kg hp kb b fi kh ki l kj kk">const PrevPage = () =&gt; {</span><span id="d804" class="kf kg hp kb b fi km ki l kj kk">if(numPage === 1){</span><span id="f994" class="kf kg hp kb b fi km ki l kj kk">return</span><span id="1f3a" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="7472" class="kf kg hp kb b fi km ki l kj kk">numPage--;</span><span id="32a6" class="kf kg hp kb b fi km ki l kj kk">GeneratePDF(numPage);</span><span id="2146" class="kf kg hp kb b fi km ki l kj kk">}</span></pre><p id="e7e5" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">下一个页面函数类似，但是如果numPage等于或大于pdfDoc.numPages返回nothing other numPage将增加1，并再次调用GeneratePDF(numPage)</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es kv"><img src="../Images/5cb621f337e7b2af48abeb814d1f14b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*vzvRHV0mO0Xi19wdwAPXCw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Creating the next button for PDF.js</figcaption></figure><pre class="jk jl jm jn fd ka kb kc kd aw ke bi"><span id="798b" class="kf kg hp kb b fi kh ki l kj kk">const NextPage = () =&gt; {</span><span id="81f1" class="kf kg hp kb b fi km ki l kj kk">if(numPage &gt;= pdfDoc.numPages){</span><span id="854a" class="kf kg hp kb b fi km ki l kj kk">return</span><span id="e30b" class="kf kg hp kb b fi km ki l kj kk">}</span><span id="6dbc" class="kf kg hp kb b fi km ki l kj kk">numPage++;</span><span id="1f24" class="kf kg hp kb b fi km ki l kj kk">GeneratePDF(numPage);</span><span id="6f7e" class="kf kg hp kb b fi km ki l kj kk">}</span></pre><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kw"><img src="../Images/52c41146278d3747e2c9b66a08f65cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B23AMBENzyVwbV6pUrsZZw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Changing pages with PDF.js</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kx"><img src="../Images/cd3fb4077474f9500eb96fe183126d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zquBPqFUSV8E3yIySHiEQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Changing pages with PDF.js</figcaption></figure><h1 id="173e" class="ky kg hp bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><p id="f34e" class="pw-post-body-paragraph im in hp io b ip lv ir is it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj hb bi translated">这是一个可视化PDF在线更改页面的很好的库，并且很容易学习，文档是直接的，然后你可以在你的项目中使用这个库。</p><h1 id="9645" class="ky kg hp bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">来源</h1><p id="a539" class="pw-post-body-paragraph im in hp io b ip lv ir is it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj hb bi translated"><a class="ae ma" href="https://mozilla.github.io/pdf.js/" rel="noopener ugc nofollow" target="_blank">https://mozilla.github.io/pdf.js/ </a> <br/> <a class="ae ma" href="https://cdnjs.com/libraries/pdf.js" rel="noopener ugc nofollow" target="_blank">https://cdnjs.com/libraries/pdf.js </a> <br/> <a class="ae ma" href="https://mozilla.github.io/pdf.js/examples/" rel="noopener ugc nofollow" target="_blank">https://mozilla.github.io/pdf.js/examples/ </a></p><h1 id="6748" class="ky kg hp bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">代码</h1><p id="ba81" class="pw-post-body-paragraph im in hp io b ip lv ir is it lw iv iw ix lx iz ja jb ly jd je jf lz jh ji jj hb bi translated"><a class="ae ma" href="https://github.com/rodrigofigueroa/pdfjsvizsaliserforweb" rel="noopener ugc nofollow" target="_blank">https://github.com/rodrigofigueroa/pdfjsvizsaliserforweb </a> <br/> <a class="ae ma" href="https://youtu.be/l0Z_nJ2KebU" rel="noopener ugc nofollow" target="_blank">https://youtu.be/l0Z_nJ2KebU </a></p></div></div>    
</body>
</html>
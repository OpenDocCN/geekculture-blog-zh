<html>
<head>
<title>Deploy a VPN server with Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Docker部署VPN服务器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/deploy-a-vpn-server-with-docker-9bd512f2be2b?source=collection_archive---------24-----------------------#2021-06-07">https://medium.com/geekculture/deploy-a-vpn-server-with-docker-9bd512f2be2b?source=collection_archive---------24-----------------------#2021-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8e04a3309eb92b4713a3ee6a6a98c6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iauu1wkJ4G1Fl-z1o4pYkg.png"/></div></div></figure><h1 id="ab2e" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">什么是VPN？</h1><p id="bd37" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">一个<strong class="jq hj">虚拟专用网</strong> ( <strong class="jq hj"> VPN </strong>)跨公共网络扩展了一个<a class="ae km" href="https://en.wikipedia.org/wiki/Private_network" rel="noopener ugc nofollow" target="_blank">专用网</a>，并使用户能够跨共享或公共网络发送和接收数据，就像他们的计算设备直接连接到专用网一样。因此，跨VPN在计算设备(例如，膝上型电脑、台式电脑、智能手机)上运行的应用可以受益于专用网络的功能、安全性和管理。加密是VPN连接的一个常见部分，尽管不是其固有部分。[1]</p><h1 id="9dc7" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">Docker是什么？</h1><p id="d9c5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">[2] Docker Engine是一种开源的容器化技术，用于构建和容器化您的应用程序。Docker引擎充当客户端-服务器应用程序，具有:</p><ul class=""><li id="417e" class="kn ko hi jq b jr kp jv kq jz kr kd ks kh kt kl ku kv kw kx bi translated">具有长期运行的守护进程的服务器<code class="du ky kz la lb b"><a class="ae km" href="https://docs.docker.com/engine/reference/commandline/dockerd/" rel="noopener ugc nofollow" target="_blank">dockerd</a></code>。</li><li id="dc3c" class="kn ko hi jq b jr lc jv ld jz le kd lf kh lg kl ku kv kw kx bi translated">API，它指定了程序可以用来与Docker守护进程对话并向其发出指令的接口。</li><li id="ded0" class="kn ko hi jq b jr lc jv ld jz le kd lf kh lg kl ku kv kw kx bi translated">命令行界面(CLI)客户端<code class="du ky kz la lb b"><a class="ae km" href="https://docs.docker.com/engine/reference/commandline/cli/" rel="noopener ugc nofollow" target="_blank">docker</a></code>。</li></ul><p id="2651" class="pw-post-body-paragraph jo jp hi jq b jr kp jt ju jv kq jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">本文介绍了如何在主机(虚拟或物理)上安装带有docker的VPN(虚拟专用网络)服务器。</p><h1 id="8926" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">要求</h1><p id="75aa" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在开始之前，你需要在你的主机上安装Docker。看看这篇<a class="ae km" href="https://blog.yassinemaachi.com/2019/12/install-docker-on-centos-or-ubuntu.html" rel="noopener ugc nofollow" target="_blank">文章</a>，看看如何安装Docker社区版。</p><h1 id="f8fc" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">安装</h1><p id="9f26" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">初始化$VPN_DATA容器卷名。<br/>$ VPN _ DATA = " homelab-VPN-DATA "<br/><br/>创建将由Openvpn容器挂载的卷，以保存服务器配置文件和证书。<br/>$ sudo docker volume create—name $ VPN _ DATA<br/><br/>运行服务器，使用您的服务器公共url生成一个认证机构，该认证机构将从WAN进行访问。<br/>$ sudo docker run-v $ VPN _ DATA:/etc/openvpn—log-driver = none—RM Kyle manna/openvpn ovpn _ gen config-u UDP://VPN . yassinemaachi . com<br/><br/>容器将提示输入密码短语，以保护新生成的证书颁发机构使用的私钥(例如:&gt;ca . key pass phrase:50m esecretc 0 de)。<br/>$ sudo docker run-v $ VPN _ DATA:/etc/openvpn—log-driver = none—RM-it Kyle manna/OpenVPN ovpn _ init PKI<br/><br/>使用容器的默认公开端口启动OpenVPN服务器进程，并挂载配置卷<br/>$ sudo docker run-v $ VPN _ DATA:/etc/OpenVPN—restart =除非停止—name = homelab-VPN-d-p 1194:1194/UDP</p><h1 id="eb37" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">创建新客户端</h1><p id="3b40" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">生成带有密码短语的客户端证书(容器将提示输入密码短语，该密码短语将用于从客户端连接到此vpn服务器)<br/>$ sudo docker run-v $ VPN _ DATA:/etc/openvpn—log-driver = none—RM-it Kyle manna/openvpn easy RSA build-client-full y machi<br/><br/>生成不带密码短语的客户端证书<br/>$ sudo docker run-v $ VPN _ DATA:/etc/openvpn—log-driver = none</p><h1 id="e4e1" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">测试连接</h1><p id="ae98" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">首先，确保您的防火墙(如果您的网络中有)授权端口1194使用udp协议。<br/>您可以使用安装在笔记本电脑或手机上的OpenVPN客户端连接到您的服务器。<br/>安装OpenVPN客户端后，您可以上传生成的客户端配置文件(ymaachi.ovpn):</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/9dcc57b00d9924d6895c8d2768cf15f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/0*Ub2riXKv8vKAGlMu.png"/></div></figure><p id="8617" class="pw-post-body-paragraph jo jp hi jq b jr kp jt ju jv kq jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">然后单击连接:</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/d3562960be89889584b6608bef252950.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/0*kP-W5zuCueZTsSXd.png"/></div></figure><p id="e64a" class="pw-post-body-paragraph jo jp hi jq b jr kp jt ju jv kq jx jy jz lh kb kc kd li kf kg kh lj kj kk kl hb bi translated">享受您的安全连接！<br/> <br/>链接:</p><ul class=""><li id="fc5f" class="kn ko hi jq b jr kp jv kq jz kr kd ks kh kt kl ku kv kw kx bi translated">[1]<a class="ae km" href="https://en.wikipedia.org/wiki/Virtual_private_network" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Virtual_private_network</a></li><li id="c358" class="kn ko hi jq b jr lc jv ld jz le kd lf kh lg kl ku kv kw kx bi translated">[2]<a class="ae km" href="https://docs.docker.com/install/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/install/</a></li></ul></div></div>    
</body>
</html>
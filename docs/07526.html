<html>
<head>
<title>Implementing a search bar for filtering the options in the select-dropdowns in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Angular中实现一个搜索栏来过滤下拉选择列表中的选项</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/implementing-a-search-bar-for-filtering-select-dropdowns-in-angular-63b1f2033737?source=collection_archive---------2-----------------------#2021-09-21">https://medium.com/geekculture/implementing-a-search-bar-for-filtering-select-dropdowns-in-angular-63b1f2033737?source=collection_archive---------2-----------------------#2021-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/bc59e37b1c7bcafc9a0d71cd7eb9e1a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNnzkTo3JMa9drO935AF4g.png"/></div></div></figure><p id="8274" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">在我的一个项目中，需要实现一个下拉列表来显示国家和他们各自的拨号代码，用户应该能够搜索它们。这是为了使手机号码的格式正确。</p><p id="0456" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不幸的是，我开始知道角状材料不提供这种功能。所以，我想如果我能有一个使用matAutoComplete的解决方法。我看过一些Github关于这个变通办法的评论，但是它们不够强大，而且有点复杂。</p><p id="fc1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个问题在很久以前就已经通过Github问题向angular material团队提出了。该团队表示，他们正在寻找解决方案，并将实施该方案，是的，他们可能有更重要的问题要解决。你可以在这里查看:【https://github.com/angular/material2/issues/5697<a class="ae jx" href="https://github.com/angular/material2/issues/5697" rel="noopener ugc nofollow" target="_blank"/></p><p id="64e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以像往常一样，我尝试搜索库来做这项工作，直到angular团队实现了这个特性，我找到了几个，但是它们要么太简单而不强大，要么太复杂而冗长而不方便。</p><p id="205f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就是这个时候我想到了尝试开发一个库来解决这个问题。我想让它简单易用，同时又应该功能强大，这就是MatSelectSearch的发展方向。所以这个问题终于有解决的办法了。</p><h1 id="4f0c" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">MatSelectSearch</h1><p id="ce08" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">npm链接:【https://www.npmjs.com/package/mat-select-search T4】</p><p id="7695" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">MatSelectSearch是一个Angular组件，提供搜索/过滤Angular素材库MatSelect选项的功能，该组件使用简单，比目前旨在解决该问题的任何其他库都更强大。搜索功能也得到了优化，也就是说MatSelectSearch能够比当前的库更快地搜索长列表。</p><h1 id="9777" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">怎么用？</h1><p id="7ef7" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">在您的项目中安装mat-select-search</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="1f98" class="lk jz hi lg b fi ll lm l ln lo">npm install mat-select-search</span></pre><p id="b583" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将mat-select-search导入app模块。如果使用了延迟加载，将其导入到需要库的特定模块中。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="3b66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将lib-mat-select-search组件放在mat-select的mat-option中。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="3a47" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要启用搜索，需要传递两个输入:</p><ul class=""><li id="39c6" class="lr ls hi is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz bi translated">[列表]</li><li id="1f68" class="lr ls hi is b it ma ix mb jb mc jf md jj me jn lw lx ly lz bi translated">[搜索属性]</li></ul><p id="c4d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">过滤mat-options后，触发了一个事件</p><ul class=""><li id="4265" class="lr ls hi is b it iu ix iy jb lt jf lu jj lv jn lw lx ly lz bi translated">(已过滤)</li></ul><h1 id="a393" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">[列表]</h1><p id="e686" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">通过[list]输入将要过滤的数组传递给lib-mat-select-search。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="05c1" class="lk jz hi lg b fi ll lm l ln lo">[list]="countries"</span></pre><h1 id="888d" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">[搜索属性]</h1><p id="73bb" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">将要搜索的属性传递给[searchProperties]输入。现在，mat-select-search提供了一个目前其他图书馆所没有的独特功能。</p><p id="9a4a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">mat-select-search支持多属性搜索。考虑这样一种情况，您有一个国家列表:</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="8ecf" class="lk jz hi lg b fi ll lm l ln lo">[<br/>  {<br/>    name: "India",<br/>    dialCode: "+91",<br/>    code: "IN"<br/>  },<br/>  {<br/>    name: "Indonesia",<br/>    dialCode: "+62",<br/>    code: "ID"<br/>  },<br/>..............and goes on</span></pre><p id="07b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，假设有一个用例，在这个用例中，不仅要根据姓名进行搜索，还要根据拨号代码和代码进行搜索。因此，即使用户键入国家的拨号代码或国家代码，搜索也应该发生。在mat-select-search中启用该属性没有额外的开销。</p><p id="b3c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">[searchProperties]接收字符串数组。字符串是搜索应该依据的属性。因此，如果仅通过姓名进行搜索，请提供:</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="e9cb" class="lk jz hi lg b fi ll lm l ln lo">[searchProperties]="['name']"</span></pre><p id="9276" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果要通过姓名、拨号代码和代码进行搜索，只需提供:</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="e95a" class="lk jz hi lg b fi ll lm l ln lo">[searchProperties]="['name', 'dialCode', 'code']"</span></pre><p id="9fb8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就这么简单。</p><p id="eb0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，属性提供的顺序有点重要。如果以上述方式提供属性，搜索词“India+91”仍将给出正确的结果，但不是“+91India”。如果您有任何重要的特定用例，请考虑订单。在大多数情况下，这并不重要。所以属性的顺序并不重要。</p><h1 id="c077" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">(已过滤)</h1><p id="6d27" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">(已过滤)是在过滤mat-options后触发的事件。将这个过滤后的数组存储到另一个变量中。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="b4d0" class="lk jz hi lg b fi ll lm l ln lo">//Storing the filtered array in filteredCountries<br/>(filtered)="filteredCountries = $event"</span></pre><p id="680c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">仅此而已。现在mat-select-search已经准备好了，您可以执行搜索了！！！</p><p id="475f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">[list]和[searchProperties]是搜索工作所需的输入。也有可选的输入，提供一些定制。</p></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><h1 id="43ec" class="jy jz hi bd ka kb mm kd ke kf mn kh ki kj mo kl km kn mp kp kq kr mq kt ku kv bi translated">[清除搜索输入]</h1><p id="47dc" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">[clearSearchInput]默认设置为false。当设置为true时，在mat-select关闭后搜索栏将被清除，这样当mat-select重新打开时，搜索栏将是空的。</p><h1 id="de42" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">[固定桌面]</h1><p id="54e6" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">[fixOnTop]默认情况下设置为false。当设置为true时，搜索栏的位置固定在顶部，并且不随mat-options一起滚动，因此即使在滚动时也是可见的。</p><p id="1f3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么，为什么不默认设置为true呢？。这是因为搜索栏永远不会失去焦点。因此，即使它向上滚动并且不可见，只要按下任何键，搜索栏就会出现，搜索就会发生。因此，没有必要在顶部固定它。特别是对于移动设备，最好是让它滚动，这样就节省了不需要的空间，并且会在它的位置显示一个mat-option。</p><p id="8394" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，如果用户喜欢滚动而不是打字，搜索栏纯粹是浪费空间。因此，默认情况下，[fixOnTop]被设置为false，如果有人希望它保持在顶部，这仍然是可能的，只需将[fixOnTop]设置为true。</p><h1 id="16a2" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">[hasSelectAll]</h1><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/ae228913248f82a234c0dbfa12084c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*uONNb0bKs3GtA1z-a59MIQ.png"/></div></figure><p id="b9f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">[hasSelectAll]默认设置为false。当设置为true时，它提供了在多选中选择所有mat选项的功能。</p><p id="8092" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，为“Select All”提供一个mat选项，并将其放在lib-mat-select-search的mat选项下面。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="513c" class="lk jz hi lg b fi ll lm l ln lo">&lt;mat-option&gt;Select All&lt;/mat-option&gt;</span></pre><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><h1 id="39a0" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">如何让MatSelectSearch和formArray一起工作？</h1><p id="fd06" class="pw-post-body-paragraph iq ir hi is b it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn hb bi translated">在使用formArray时，仅仅存储一个经过筛选的数组是不够的。每个表单都应该有一个经过筛选的数组。</p><p id="91dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设有多个表单，每个表单都有一个mat-select来选择国家。使用与上面相同的逻辑，无论用户最初与哪个mat-select交互，搜索都将完美地工作，但是当与另一个mat-select交互时，第一个mat-select的值将消失。这是因为变量“filteredCountries”由所有mat-select共享。</p><p id="b3f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，要解决所有这些问题，请将“filteredCountries”制作成一个二维数组，并将该数组存储在“filteredCountries”的相应索引中。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure></div><div class="ab cl mf mg gp mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="hb hc hd he hf"><p id="c5c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您喜欢这个组件，或者它对您解决问题有所帮助，请启动回购:<a class="ae jx" href="https://github.com/shafi-sahal/MatSelectSearch" rel="noopener ugc nofollow" target="_blank">https://github.com/shafi-sahal/MatSelectSearch</a>。</p><p id="baf4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">贡献、反馈和建议总是受欢迎的。</p><p id="7f86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以从这里下载这个库:【https://www.npmjs.com/package/mat-select-search T2】</p></div></div>    
</body>
</html>
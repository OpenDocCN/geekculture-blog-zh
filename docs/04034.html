<html>
<head>
<title>Build Simple Attendance App in Kotlin — Part 2— Navigate to Student Form</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Kotlin中构建简单的考勤应用程序—第2部分—导航到学生表单</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/build-simple-attendance-app-in-kotlin-part-2-navigate-to-student-form-a9f519a1098c?source=collection_archive---------21-----------------------#2021-06-20">https://medium.com/geekculture/build-simple-attendance-app-in-kotlin-part-2-navigate-to-student-form-a9f519a1098c?source=collection_archive---------21-----------------------#2021-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="033d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您将开始使用Jetpack导航组件创建导航图的旅程。</p><p id="f092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本章中，您将在导航组件的帮助下使用一个活动多片段架构。这使得处理屏幕过程更容易。</p><p id="4c67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不多谈了，我们开始吧！！</p><h1 id="cd64" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">章节:</h1><ul class=""><li id="bf6d" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated"><a class="ae km" rel="noopener" href="/geekculture/build-simple-attendance-app-in-kotlin-part-1-dashboard-layout-c111b84ea9cf">使用ConstraintLayout的简单仪表板</a></li><li id="9b49" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated">Jetpack导航-学生表单[你在这里]</li></ul><p id="548f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每一章，我将提供三个链接:</p><ul class=""><li id="4a59" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc ki kj kk kl bi translated">拉链。你可以下载。</li><li id="e105" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated">差异。您可以显示章节之间的差异。</li><li id="1b1e" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated">每个章节的标记存储库</li></ul><p id="e5e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae km" href="https://github.com/ihfazhillah/Simple-Attendance-Example/archive/refs/tags/part2.zip" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> zip </strong> </a>，<a class="ae km" href="https://github.com/ihfazhillah/Simple-Attendance-Example/compare/part1...part2" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> diff </strong> </a>，<a class="ae km" href="https://github.com/ihfazhillah/Simple-Attendance-Example/tree/part2" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> repo </strong> </a></p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><p id="cfe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先添加导航依赖项。打开应用程序级别的<code class="du lc ld le lf b">build.gradle</code>并添加</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="8e4d" class="lo je hi lf b fi lp lq l lr ls">implementation "androidx.navigation:navigation-fragment-ktx:$nav_version"<br/>implementation "androidx.navigation:navigation-ui-ktx:$nav_version"</span></pre><p id="2d20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你现在做<code class="du lc ld le lf b">sync</code>，你会得到一个错误。因为你没有在任何地方定义<code class="du lc ld le lf b">nav_version</code>变量。</p><p id="15eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要修复它，打开顶层的<code class="du lc ld le lf b">build.gradle</code>并添加它</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="e71a" class="lo je hi lf b fi lp lq l lr ls">ext.nav_version = "2.3.5"</span></pre><p id="a95b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du lc ld le lf b">buildscript</code>街区内。</p><p id="5619" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这种方法，如果您想要更新或降级整个导航库，您不需要在每个<code class="du lc ld le lf b">implementation</code>行进行更新。相反，只需更新项目的build.gradle中的<code class="du lc ld le lf b">ext.nav_version</code>值。</p><p id="4e1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请立即同步，因为您已经在<code class="du lc ld le lf b">build.gradle</code>文件中做了更改。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><p id="5f96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，打开<code class="du lc ld le lf b">activity_main.xml</code>文件，并添加以下内容</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="9d59" class="lo je hi lf b fi lp lq l lr ls">&lt;androidx.fragment.app.FragmentContainerView<br/>    android:layout_width="0dp"<br/>    android:layout_height="0dp"<br/>    app:layout_constraintTop_toTopOf="parent"<br/>    app:layout_constraintBottom_toBottomOf="parent"<br/>    app:layout_constraintStart_toStartOf="parent"<br/>    app:layout_constraintEnd_toEndOf="parent"<br/>    android:id="@+id/nav_host_fragment"<br/>    android:name="androidx.navigation.fragment.NavHostFragment"<br/>    app:defaultNavHost="true"<br/>    app:navGraph="@navigation/nav_graph"/&gt;</span></pre><p id="0ac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该视图将成为您的导航主机。导航主机是一个空容器，它将是你的屏幕进出的地方，这取决于你在哪里导航。这应该是<code class="du lc ld le lf b">NavHost</code>类的子类，默认实现是<code class="du lc ld le lf b">NavHostFragment</code>。你在你的<code class="du lc ld le lf b">FragmentContainerView</code>的<code class="du lc ld le lf b">android:name</code>标签中定义它</p><p id="246c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lc ld le lf b">app:defaultNavHost</code>将您的导航主机标记为默认导航主机，并处理后退按钮。如果有多个默认导航主机，则只能在一个布局中定义一个默认导航主机。</p><p id="42ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那<code class="du lc ld le lf b">navGraph</code>呢？它是一个XML文件，定义了你的屏幕和它们的动作。这个XML文件的根是<code class="du lc ld le lf b">navigation</code>。</p><p id="4f52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lc ld le lf b">Screens</code>要么是一个活动，要么是一个片段。或者，用谷歌术语来说，就是一个<code class="du lc ld le lf b">direction</code>。</p><p id="2826" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">而<code class="du lc ld le lf b">action</code>是从一个方向到另一个方向的路线。</p><p id="2380" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您打开可视化布局，您可以看到一个代表活动或片段的矩形。而<code class="du lc ld le lf b">action</code>是它们之间的连接路径。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="e6a6" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">定义导航图中的第一个屏幕</h2><p id="35e0" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">在上一步中，您将在<code class="du lc ld le lf b">app:navGraph</code>属性下面看到红色下划线。这是因为您的项目中没有该文件。创建它的简单方法是点击键盘上的<code class="du lc ld le lf b">CTRL+ALT+ENTER</code>。然后按照说明操作。</p><p id="f904" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Android Studio将打开根元素为<code class="du lc ld le lf b">navigation</code>的<code class="du lc ld le lf b">nav_graph.xml</code>文件。</p><p id="39e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将这段代码添加到<code class="du lc ld le lf b">navigation</code>标签中:</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="470d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将向导航图添加一个片段。如果你想添加一个活动，你应该使用<code class="du lc ld le lf b">activity</code>标签。您还可以看到一些属性:</p><ul class=""><li id="90bf" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc ki kj kk kl bi translated"><code class="du lc ld le lf b">android:id</code>导航图中该片段的标识符</li><li id="d50c" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><code class="du lc ld le lf b">android:name</code>实际片段包</li><li id="51cd" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><code class="du lc ld le lf b">android:label</code>用于标题</li><li id="cdb0" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><code class="du lc ld le lf b">tools:layout</code>显示导航图设计中的布局。</li></ul><p id="52b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，你的家园碎片在哪里？你问。请耐心等待，您将更新前面的活动，并将主活动实现移动到您的<code class="du lc ld le lf b">HomeFragment</code>中。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="c302" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">标记为起始目的地</h2><p id="9152" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">现在你的导航图没有开始屏幕。您可以将之前添加的第一个片段添加为起始目的地。</p><p id="689f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du lc ld le lf b">navigation</code>标签中，添加<code class="du lc ld le lf b">app:startDestination="@id/home_fragment"</code>属性。您的<code class="du lc ld le lf b">nav_graph.xml</code>文件将如下所示:</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="c23c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">看到了吗？起始目的地值是导航标签子项中第一个片段的id。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="188d" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">添加HomeFragment</h2><p id="951b" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">在我们开始移动<code class="du lc ld le lf b">MainActivity</code>实现之前，您将为<code class="du lc ld le lf b">HomeFragment</code>创建一个框架</p><p id="4587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<code class="du lc ld le lf b">layout</code>目录下创建<code class="du lc ld le lf b">fragment_home.xml</code>。以<code class="du lc ld le lf b">ConstraintLayout</code>为根元素使其为空即可。</p><p id="427d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加<code class="du lc ld le lf b">ui</code>包，并在其内部添加<code class="du lc ld le lf b">home</code>包。然后创建一个新的kotlin文件，并用以下内容填充它:</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="9685" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绑定初始化与您在活动中所做的略有不同，对吗？在片段中，您应该解除绑定，以确保应用程序不会产生内存泄漏。</p><p id="2d77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将<code class="du lc ld le lf b">private val _binding</code>定义为一个可空变量，并用空值初始化它。然后当片段的视图被破坏时，你应该再次使它为空。</p><p id="4564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使访问<code class="du lc ld le lf b">binding</code>更容易，并且您不应该检查绑定是否为空，您创建了另一个变量，并通过两次敲击<code class="du lc ld le lf b">!!</code>强制该绑定不为空。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="c9dc" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">让我们把仪表板搬进家里</h2><p id="ee97" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">将<code class="du lc ld le lf b">FragmentContainerView</code>下的所有视图移动到根标签内的<code class="du lc ld le lf b">fragment_home.xml</code>。</p><p id="b2e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您会注意到MainActivity现在有一条红色下划线。将所有侦听器移到HomeFragment的onViewCreated方法中，您的HomeFragment将如下所示</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="3915" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您运行您的应用程序，在您的设备上将不会注意到任何变化。因为你只能从活动进入片段。</p><p id="d321" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说，使用Jetpack导航的步骤是:</p><ol class=""><li id="690f" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc mm kj kk kl bi translated">值为<code class="du lc ld le lf b">android:name</code>的Add FragmentContainerView是<code class="du lc ld le lf b">NavHost</code>的子类。默认的是<code class="du lc ld le lf b">androidx.navigation.fragment.NavHostFragment</code></li></ol><p id="0c39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.确定<code class="du lc ld le lf b">app:navGraph</code></p><p id="9797" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.创建导航图文件</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="8af6" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">添加操作</h2><p id="2e28" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">菜单里面的学生按钮添加更多应该会打开一个新的屏幕。你要实现它。</p><figure class="lg lh li lj fd mj er es paragraph-image"><div class="er es mn"><img src="../Images/e96d787826e8d840f82794c51d964511.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*4-Vw5Md_8lGSW8wnXYnCvg.png"/></div><figcaption class="mq mr et er es ms mt bd b be z dx">StudentFormFragment</figcaption></figure><p id="03c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，在<strong class="ih hj"> ui.studentform </strong>目录中创建一个名为<strong class="ih hj"> StudentFormFragment </strong>的片段。另外，在布局目录中创建<code class="du lc ld le lf b">fragment_student_form.xml</code>。首先将其设为默认，不包含任何视图。</p><p id="9303" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将首先对屏幕特征执行<strong class="ih hj">更改。然后实现实际的表单。</strong></p><p id="fde3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，再次打开<strong class="ih hj"> nav_graph.xml </strong>并在home片段下添加新创建的片段。</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="b99d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在nav_graph的fragment标签中，您可以添加一个动作。正如我之前告诉你的，动作是连接屏幕的路径。源操作是您的操作的根。而目的地是你在行动中定义的。</p><p id="750a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，你想创建一个连接home和studentformfragment的动作。您应该在home片段中添加一个操作，并用studentformfragment id填充<code class="du lc ld le lf b">app:destination</code>。</p><p id="7525" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您仍然不确定如何实现它，请看下面最终的nav_graph.xml</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="2847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，我如何能使用它从家移动到新的片断？</p><p id="9531" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">轻松点。</p><p id="775f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开HomeFragment文件，在menu_student菜单监听器中，将Toast实现更改为<code class="du lc ld le lf b">findNavController().navigate(R.id.home_to_student_view)</code></p><p id="4f0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行它，你会看到变化。恭喜你。！</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="512d" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">实现表单布局</h2><p id="92da" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">让<code class="du lc ld le lf b">fragment_student_form.xml</code>看起来像这样</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="75ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它只是添加了2个编辑文本和按钮。我们在这里使用谷歌材料设计组件。</p><figure class="lg lh li lj fd mj er es paragraph-image"><div class="er es mu"><img src="../Images/0b2ac3f47d2acc79abd5457710f04b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*XfpEg-fwgkE6Lq_KmAJ0rg.png"/></div><figcaption class="mq mr et er es ms mt bd b be z dx">the values/strings.xml file</figcaption></figure><p id="a3a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你注意到android:text属性现在有了像<code class="du lc ld le lf b">@string/save</code>这样的值。这是最佳实践，不是将字符串硬编码到布局中，而是将它们提取到<code class="du lc ld le lf b">values/strings.xml</code>文件中。</p><p id="6690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当你的android:text属性仍然带红色下划线时，做一个<code class="du lc ld le lf b">ALT+SHIFT+ENTER</code>。它将创建一个映射到values/strings.xml文件的记录。</p><h2 id="5f2b" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">添加保存监听程序</h2><p id="5c9f" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">当点击save按钮时，您希望采取措施将记录保存到数据库，并将屏幕导航回主页。</p><p id="86fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，现在，你只能做第二部分。因为我们现在还没有建立数据库。</p><p id="fd78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以将侦听器添加到StudentFormFragment.kt中的onViewCreated方法中</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="d53a" class="lo je hi lf b fi lp lq l lr ls">binding.btnSave.setOnClickListener {</span><span id="2c0e" class="lo je hi lf b fi mv lq l lr ls">   Toast.makeText(context, "Student will be saved into database.", Toast.LENGTH_SHORT).show()</span><span id="12fa" class="lo je hi lf b fi mv lq l lr ls">   findNavController().navigateUp()<br/>}</span></pre><p id="4b2c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lc ld le lf b">navigateUp()</code>将导航到您定义的动作的父动作。在这种情况下，家庭片段。你可以再读一遍你的导航图来理解我所说的。</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="d83b" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">修正android的应用标题:标签</h2><p id="e2a5" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">您的应用程序现在可以顺利运行了。但是你注意到一件事。标题栏不符合您在导航图形文件中定义的<code class="du lc ld le lf b">android:label</code>。我们如何修复它？</p><p id="7c25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">打开<code class="du lc ld le lf b">MainActivity.kt</code>。您将使用导航控制器设置动作栏。</p><ol class=""><li id="2880" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc mm kj kk kl bi translated">获取导航片段</li><li id="4836" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc mm kj kk kl bi translated">获取navhost控制器</li><li id="4220" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc mm kj kk kl bi translated">用导航控制器设置动作栏</li><li id="c498" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc mm kj kk kl bi translated">覆盖onSupportNavigateUp并让navhostcontroller处理它</li></ol><p id="6fb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获得导航主机控制器，您可以</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="5623" class="lo je hi lf b fi lp lq l lr ls">val navFragment = supportFragmentManager.findFragmentById(R.id.nav_host_fragment) as NavHostFragment<br/>navHostController = navFragment.findNavController()</span></pre><p id="f4e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，要设置带有导航控制器的动作栏，您可以使用</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="e51f" class="lo je hi lf b fi lp lq l lr ls">setupActionBarWithNavController(navHostController)</span></pre><p id="ffe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要覆盖onSupportNavigateUp，您可以</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="77df" class="lo je hi lf b fi lp lq l lr ls">override fun onSupportNavigateUp() = navHostController.navigateUp()</span></pre><p id="9a49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，您的最终文件将如下所示</p><figure class="lg lh li lj fd mj"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="8219" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，您的仪表板屏幕的标题现在是<strong class="ih hj">主页</strong>，学生表单中的标题现在是<strong class="ih hj">学生表单</strong>。您会注意到，标题栏中的后退按钮现在出现了。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="b8e8" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">添加安全参数</h2><p id="2c5a" class="pw-post-body-paragraph if ig hi ih b ii kd ik il im ke io ip iq mg is it iu mh iw ix iy mi ja jb jc hb bi translated">android开发者文档强烈建议您使用安全的args Gradle插件在屏幕间导航。这将生成方向类，并严格要求您在某些屏幕上需要时传递参数。</p><p id="f348" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要进行添加，请遵循以下说明:</p><ol class=""><li id="25f3" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc mm kj kk kl bi translated">在顶级build.gradle文件中添加导航类路径</li><li id="0f9a" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc mm kj kk kl bi translated">在应用级build.gradle中应用插件</li></ol><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="aca4" class="lo je hi lf b fi lp lq l lr ls">classpath "androidx.navigation:navigation-safe-args-gradle-plugin:$nav_version"</span></pre><p id="d5e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将它添加到顶层build.gradle文件的<code class="du lc ld le lf b">dependencies</code>块中</p><p id="f0ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在应用程序级别，通过添加来应用插件</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="d2e7" class="lo je hi lf b fi lp lq l lr ls">id "androidx.navigation.safeargs.kotlin"</span></pre><p id="13a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在插件块中</p><p id="a29a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要忘记重新同步您的项目。</p><p id="532b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，你应该考虑这些事情:</p><ul class=""><li id="db3b" class="kb kc hi ih b ii ij im in iq ks iu kt iy ku jc ki kj kk kl bi translated">使用<strong class="ih hj">片段名称类+“方向”</strong>生成方向类</li><li id="1391" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated">每个方向的动作都是从每个动作的id开始的。例如，在home to student片段中，id是<strong class="ih hj"> home_to_student_view。然后，Gradle将把<strong class="ih hj"> homeToStudentView </strong>方法添加到类中</strong></li></ul><p id="d123" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，你明白了。Gradle将生成<strong class="ih hj">homefragmentdirections . hometostudentview()</strong>，您将使用它从主页导航到学生表单视图。</p><p id="62ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一件事。每当您更改nav_graph.xml文件时，不要忘记重新构建您的应用程序。你可以简单地按CTRL+F9来完成。这将确保生成的方向类。</p><p id="1042" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您可以将实现从</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="46a6" class="lo je hi lf b fi lp lq l lr ls">findNavController().navigate(R.id.home_to_student_view)</span></pre><p id="fa81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到</p><pre class="lg lh li lj fd lk lf ll lm aw ln bi"><span id="c605" class="lo je hi lf b fi lp lq l lr ls">val destination = HomeFragmentDirections.homeToStudentView()<br/>findNavController().navigate(destination)</span></pre></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><p id="701d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，你已经在这里学到了很多。您了解了Jetpack导航组件、Fragment和Safe Args Gradle插件。</p><p id="0843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一章中，您将学习如何使用Room将实际记录保存到数据库中，并使用RxJava集成您的应用程序，使应用程序更具吸引力。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h2 id="1d99" class="lo je hi bd jf lt lu lv jj lw lx ly jn iq lz ma jr iu mb mc jv iy md me jz mf bi translated">更多资源</h2><ul class=""><li id="d48f" class="kb kc hi ih b ii kd im ke iq kf iu kg iy kh jc ki kj kk kl bi translated"><a class="ae km" href="https://developer.android.com/guide/navigation/navigation-getting-started" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/guide/navigation/navigation-getting-started</a></li><li id="a0df" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><a class="ae km" href="https://developer.android.com/topic/libraries/view-binding#fragments" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/topic/libraries/view-binding # fragments</a></li><li id="f21b" class="kb kc hi ih b ii kn im ko iq kp iu kq iy kr jc ki kj kk kl bi translated"><a class="ae km" href="https://stackoverflow.com/a/67702986/8626538" rel="noopener ugc nofollow" target="_blank">navigateUp vs popBackStack</a></li></ul></div></div>    
</body>
</html>
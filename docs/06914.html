<html>
<head>
<title>Getting started with Spring Cloud Config</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Spring Cloud配置入门</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/getting-started-with-spring-cloud-config-24b31977bc8?source=collection_archive---------16-----------------------#2021-09-01">https://medium.com/geekculture/getting-started-with-spring-cloud-config-24b31977bc8?source=collection_archive---------16-----------------------#2021-09-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="2ae1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Spring Cloud Config无需重启和重新部署您的应用程序，如何反映与配置相关的更改</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/658bea141dacd26acafbf5ae73041fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*12QPr24e__x8FPwP"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@scottwebb?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Scott Webb</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4fe6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi kk translated">pring Cloud为开发人员提供了工具来快速构建分布式系统中的一些常见模式。分布式系统的协调导致样板模式，使用Spring Cloud开发人员可以快速运行实现这些模式的服务和应用程序。它们可以在任何分布式环境中很好地工作，包括开发人员的笔记本电脑、裸机数据中心和托管平台，如Cloud Foundry。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="deef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本文中，我想讨论Spring Cloud配置。现在，让我们看一个没有Spring Cloud配置的简单用例。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es la"><img src="../Images/13818d80a4a4cd224aedb15b656a05cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVVMojQn3D_drgoiWHr-LQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Problem Statement</figcaption></figure><p id="061f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">保险提供商是一个微服务，包含rest端点，即<em class="lb">/保险服务/获取计划</em>。还有许多微服务客户端，如保险客户端1、保险客户端2、保险客户端3，它们正在访问保险提供商，如上所示。所有客户端都提供相同的端点来访问保险提供商。假设保险提供商后来将其rest端点从<em class="lb">/保险服务/获取计划</em>更改为<em class="lb">/保险服务/获取更新计划</em>。因为所有客户端都与保险提供商紧密耦合，所以它们也需要重写它们的端点，并将它们更改为<em class="lb"> /getUpdatePlans </em>。</p><p id="e28a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，保险提供商的变化将直接影响从属客户。此外，如果客户端做了更改，那么他们需要重启并重新部署他们的服务器，这是一项庞大而繁琐的任务。因此，我们如何优化这一点，以及我们如何在保险提供商中全局声明端点，以便如果有任何更改，它们不会影响依赖的微服务。</p><p id="ac20" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，让我们来讨论什么是Spring Cloud Config，以及我们如何使用Spring Cloud Config来解决上述问题。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><h2 id="8f7d" class="lc ld hi bd le lf lg lh li lj lk ll lm jx ln lo lp kb lq lr ls kf lt lu lv lw bi translated"><strong class="ak">什么是春云配置？</strong></h2><p id="25fa" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">Spring Cloud Config为分布式系统中的外部化配置提供了服务器端和客户端支持。有了config-server，我们就有了一个中央位置来管理所有环境中应用程序的外部属性。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mc"><img src="../Images/4c9aa8f26270b45c1f4bc467177f823c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dc-EGEQQFidc5l5IYsaG4g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Problem solved with Config Server</figcaption></figure><p id="2edb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，保险提供者包含端点<em class="lb"> /getAllPlans </em>。所有客户端都通过配置服务器与保险提供商进行交互。这个配置服务器与GitHub存储库交互，存储库直接与保险提供商交互。因此，如果保险提供商更改了它的URL，那么保险提供商只需要在GitHub存储库中更新这些URL更改，这样所有依赖的客户端都可以从配置服务器获得更改后的URL。</p><p id="3992" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，客户不必担心这些变化。在配置服务器的帮助下，客户不再像以前那样与保险提供商紧密耦合。他们现在是松散耦合的。现在，我们将开发保险提供商、保险配置服务器和保险客户端。为了降低复杂性并让您更好地理解，我们在这里将只开发一个保险客户端作为微服务。</p><blockquote class="md me mf"><p id="62c0" class="jo jp lb jq b jr js ij jt ju jv im jw mg jy jz ka mh kc kd ke mi kg kh ki kj hb bi translated">注意:如果您愿意，那么您可以将所有三个客户端开发为微服务并测试解决方案。</p></blockquote></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="b338" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们使用Spring Initializr和Spring Web以及Spring Boot DevTools依赖项来创建保险提供商。现在，在保险提供商应用程序中创建一个rest端点。</p><p id="b14c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在insurance-provider中，创建一个get方法getPlans()，该方法将返回计划列表，如下所述。保险提供商将在端口8080上运行。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/19357fdb4fc0d7d8d233232d02d8b951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tOYmFRekwPNW27uGQaqvg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">InsuranceProviderApplication.java</figcaption></figure><p id="7edd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，使用Spring Initializr和Spring Web、Spring Boot开发工具、Spring Boot执行器和配置服务器依赖项创建insurance-config-server。我们添加了Spring Boot执行器，因为端点会重定向，因为我们不是从保险客户端直接调用保险提供者。我们将调用配置服务器，配置服务器将调用GitHub。因此，默认端点映射将由Spring Boot执行器完成。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/ac050ca2eee37e5cabeb87489d8cf656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urhrScH7pd7xS2Nr7U-CBg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">InsuranceConfigServerApplication.java</figcaption></figure><p id="6345" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在application.properties文件中，我们可以指向GitHub URL来获取链接。保险配置服务器应用程序将在端口8888上运行。</p><blockquote class="md me mf"><p id="ff84" class="jo jp lb jq b jr js ij jt ju jv im jw mg jy jz ka mh kc kd ke mi kg kh ki kj hb bi translated">注意:您需要特别提供git.default-label作为main，否则config server将无法找到存储库。Git最近将其主分支名称从master更改为main，但是在Spring Cloud配置中git.default-label仍然是master。因此，除非您将default-label指定为main，否则它将无法获取详细信息。</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/693afb47e81a97ef97a22f3f35ffd9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQm05o0v2XB9dOyId4DebQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">application.properties</figcaption></figure><p id="e189" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我已经创建了一个新的GitHub存储库insurance-config-server，并添加了包含URL的application.properties文件。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/3b7757d45a4dfe30fae0a696dc90f5c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*araiY338MzZF3-r0Mox25A.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">insurance-config-server GitHub repository</figcaption></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="60d2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，使用Spring Initializr和Spring Web、Spring Boot开发工具以及配置客户端依赖项来创建一个保险客户端。</p><p id="e183" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在insurance-client中，我们将使用RestTemplate消费保险提供者。从保险客户端，请求将被发送到保险配置服务器。在insurance-config-server中，application.properties文件将获取密钥<em class="lb">$ { insurance . provider . URL }</em>。基于该密钥，它将找到被映射的适当的端点URL。这将调用服务，然后我们将获得所需的响应。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/4570e3f59c26639103ee515a4a862f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FRCRMba1vBhX-2ZFGSAZw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">InsuranceClientApplication.java</figcaption></figure><p id="b54b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们需要在application.properties中添加以下属性，这意味着保险客户端将与保险配置服务器进行交互。保险客户端将在端口9090上运行。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mo"><img src="../Images/3001027ec5d51685a2320b3e6b5678aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*VLCBfLt4NWh-S_xEfbJvpQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">application.properties</figcaption></figure></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="28ff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们从保险配置服务器开始，然后是保险提供商，最后是保险客户。现在，您将看到在保险提供商的URL中所做的任何更改都将反映在保险客户中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mp"><img src="../Images/8f57527682890583fa1cc6ddf36df9ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*41r6bkJVZRFmrzds7W63qw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Postman</figcaption></figure><p id="0db1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您可以在下面的GitHub中找到完整的项目:</p><div class="mq mr ez fb ms mt"><a href="https://github.com/ela4490/spring-boot/tree/main/spring-boot-cloud/spring-cloud-config" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">主ela4490上的spring-boot/spring-boot-cloud/spring-cloud-config/spring-boot</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">这个资料库探索了Spring Boot的各种特色。-spring-boot/spring-boot-cloud/spring-cloud-config at main…</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">github.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh jh mt"/></div></div></a></div><div class="mq mr ez fb ms mt"><a href="https://github.com/ela4490/insurance-config-server" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">GitHub-ela 4490/insurance-Config-server:配置服务器</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">配置服务器。在GitHub上创建一个帐户，为ela 4490/insurance-config-server开发做出贡献。</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">github.com</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh jh mt"/></div></div></a></div></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="dbfc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是一个非常简单的例子来理解Spring Cloud配置的细微差别。希望这能帮助任何想了解更多关于Spring Cloud Config的人。我只是想分享一下我在春云学习期间的经历。请随时查看或纠正本文中提到的细节，这将有助于我为其他开发者创造更有价值的内容。我将在未来创作更多关于Spring Cloud及其示例应用程序特性的文章。敬请关注。快乐学习！:)</p><p id="fd41" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">参考:</p><div class="mq mr ez fb ms mt"><a href="https://cloud.spring.io/spring-cloud-config/reference/html/" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hj fi z dy my ea eb mz ed ef hh bi translated">春季云配置</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">这个快速入门使用Spring Cloud Config Server的服务器和客户机。首先，开始…</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">cloud.spring.io</p></div></div></div></a></div></div></div>    
</body>
</html>
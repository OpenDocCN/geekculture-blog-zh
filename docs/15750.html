<html>
<head>
<title>Classification in Machine Learning: A Guide for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的分类:初学者指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/classification-in-machine-learning-a-guide-for-beginners-fe586e299721?source=collection_archive---------5-----------------------#2022-11-18">https://medium.com/geekculture/classification-in-machine-learning-a-guide-for-beginners-fe586e299721?source=collection_archive---------5-----------------------#2022-11-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3227" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何使用真实数据集通过逻辑回归解决分类问题的分步指南。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/216df7e155797c1a4a77ae4ad3139ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*53I38gjv4DfIUeKK"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Austin Distel</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8f26" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">数据是当今的新石油。许多公司和政府现在正试图使用机器学习技术从大数据中提取信息。机器学习发展非常快，几乎每天都在这个领域开发新的工具和库。这些工具可以帮助您轻松实现机器学习项目。</p><p id="67e2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇文章中，我将谈论分类问题。以下是我将涉及的主题:</p><ul class=""><li id="24a4" class="kk kl hi jq b jr js ju jv jx km kb kn kf ko kj kp kq kr ks bi translated">什么是机器学习？</li><li id="857e" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">什么是逻辑回归算法？</li><li id="8d37" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">如何用logistic回归解决一个分类问题？</li><li id="0acd" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated">如何预测新数据？</li></ul><p id="2521" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们开始吧！</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="f97c" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">什么是机器学习？</h1><p id="5768" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">机器学习是人工智能的一个子领域，它为机器提供了自动学习和根据经验改进的能力，而无需显式编程。</p><p id="c9b7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">机器学习主要有三种类型:监督学习、非监督学习和强化学习。如果数据集有标注，可以使用监督学习算法。一旦数据集中没有标签，就可以使用无监督学习算法。在强化学习中，系统通过与环境交互来学习。</p><p id="c754" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们仔细看看监督学习。监督学习模型是机器学习中最常用的算法。监督学习分为回归和分类。很容易理解一个问题是回归还是分类。如果数据的标签是数值，那就是回归问题，否则就是分类问题。</p><p id="90f3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇文章中，我将用逻辑回归来解释分类问题。请注意，逻辑回归，尽管它的名字，是<strong class="jq hj">一个</strong>分类模型，而不是回归模型。为了展示如何解决分类问题，我将使用<a class="ae jn" href="https://www.kaggle.com/datasets/blastchar/telco-customer-churn" rel="noopener ugc nofollow" target="_blank">电信客户流失</a>数据集。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="c7ae" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">加载数据集</h1><p id="2445" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">首先，让我们用<code class="du mc md me mf b">read_csv</code>方法加载数据集，然后用<code class="du mc md me mf b">head</code>方法查看数据集的前五行。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="1c02" class="mk lg hi mf b be ml mm l mn mo">import pandas as pd<br/>df = pd.read_csv('WA_Fn-UseC_-Telco-Customer-Churn.csv')<br/>df.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mp"><img src="../Images/63680ec1db601c15d3b00c5e0cf898b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCPqagJ0kDpfIFEWVZQ3Sw.png"/></div></div></figure><p id="525a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该数据集包括一家虚构的电信公司的信息，该公司在第三季度向加利福尼亚州的7043名客户提供了家庭电话和互联网服务。它显示哪些客户已经离开、留下或注册了他们的服务。</p><p id="64f0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果一个公司能够预测客户是否会离开这项服务，它就会努力留住客户。最后一列“客户流失”表示客户是否取消了合同。如果客户取消了合同，则显示“是”，如果没有，则显示“否”。该变量是我们的目标变量。其他变量也称为特征。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="f360" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">了解数据集</h1><p id="e537" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">让我们来看看数据集的形状。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="7a09" class="mk lg hi mf b be ml mm l mn mo">df.shape<br/><br/>#Output <br/>(7043, 21)</span></pre><p id="7cfe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所见，数据集由7043行和21列组成。让我向您展示数据集中的列类型。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="dea5" class="mk lg hi mf b be ml mm l mn mo">df.dtypes<br/><br/>#Output:<br/>customerID           object<br/>gender               object<br/>SeniorCitizen         int64<br/>Partner              object<br/>Dependents           object<br/>tenure                int64<br/>PhoneService         object<br/>MultipleLines        object<br/>InternetService      object<br/>OnlineSecurity       object<br/>OnlineBackup         object<br/>DeviceProtection     object<br/>TechSupport          object<br/>StreamingTV          object<br/>StreamingMovies      object<br/>Contract             object<br/>PaperlessBilling     object<br/>PaymentMethod        object<br/>MonthlyCharges      float64<br/>TotalCharges         object<br/>Churn                object<br/>dtype: object</span></pre></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="7e1f" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">数据预处理</h1><p id="723d" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">数据预处理是机器学习中最重要的步骤之一。这一步是数据科学家花费最多时间的。项目的80%通常花在数据预处理上。</p><p id="393a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，Pandas会自动确定每个列的类型。但是，列的数据类型有时会被错误地确定。在建立模型之前，检查柱的类型是一项重要的任务。</p><p id="c98c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，<code class="du mc md me mf b">SeniorCitizen</code>列由0和1组成，该列的类型被指定为数字。您可以将此列转换为对象类型。但是，由于该列的值数量有限，因此不需要转换该列的类型。</p><p id="80bf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du mc md me mf b">TotalCharges</code>指付款总额。付款必须是一个数值。让我们用<code class="du mc md me mf b">to_numeric</code>方法将这个列转换成数字类型。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="336a" class="mk lg hi mf b be ml mm l mn mo">df.TotalCharges = pd.to_numeric(df.TotalCharges, errors='coerce')</span></pre><p id="019e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，我使用了<code class="du mc md me mf b">error="coerce"</code>参数将一个非数值转换为NaN。</p><h2 id="c295" class="mq lg hi bd lh mr ms mt ll mu mv mw lp jx mx my lr kb mz na lt kf nb nc lv nd bi translated">处理缺失数据</h2><p id="0506" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">让我们用<code class="du mc md me mf b">isnull().sum()</code>方法来看看数据集中缺失的数据。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="994c" class="mk lg hi mf b be ml mm l mn mo">df.isnull().sum()<br/><br/>#Output<br/>customerID           0<br/>gender               0<br/>SeniorCitizen        0<br/>Partner              0<br/>Dependents           0<br/>tenure               0<br/>PhoneService         0<br/>MultipleLines        0<br/>InternetService      0<br/>OnlineSecurity       0<br/>OnlineBackup         0<br/>DeviceProtection     0<br/>TechSupport          0<br/>StreamingTV          0<br/>StreamingMovies      0<br/>Contract             0<br/>PaperlessBilling     0<br/>PaymentMethod        0<br/>MonthlyCharges       0<br/>TotalCharges        11<br/>Churn                0<br/>dtype: int64</span></pre><p id="0521" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所见，<code class="du mc md me mf b">TotalCharges</code>列有缺失的数据。让我们用<code class="du mc md me mf b">fillna</code>方法将0赋给缺失值。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="1f05" class="mk lg hi mf b be ml mm l mn mo">df.TotalCharges = df.TotalCharges.fillna(0)</span></pre><p id="8036" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在数据集中，一些列名以小写字母开头。让我们将列名转换为小写，并在列名之间的空格处添加下划线。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="1292" class="mk lg hi mf b be ml mm l mn mo">df.columns = df.columns.str.lower().str.replace(' ', '_')</span></pre><p id="8e3f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，Object类型的一些列值包含空格，并且大小写不匹配。让我们规范这些价值观。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="253b" class="mk lg hi mf b be ml mm l mn mo">string_columns = list(df.dtypes[df.dtypes == 'object'].index)<br/>for col in string_columns:<br/>    df[col] = df[col].str.lower().str.replace(' ', '_')</span></pre><p id="b1d1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，让我们处理目标变量并将该列的值转换成数字。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="ca3a" class="mk lg hi mf b be ml mm l mn mo">df.churn = (df.churn == ‘yes’).astype(int)</span></pre><p id="f614" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们看看数据集的最终版本。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="5f1b" class="mk lg hi mf b be ml mm l mn mo">df.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ne"><img src="../Images/e4a43a7506e9e91e12a5b5fbe69b3dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*akaIHk8K-8NoMhCmsv-BtA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Dataset after data preprocessing</figcaption></figure><h2 id="0fba" class="mq lg hi bd lh mr ms mt ll mu mv mw lp jx mx my lr kb mz na lt kf nb nc lv nd bi translated">分割数据集</h2><p id="bedc" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">在机器学习中，数据集分为训练和测试。用训练数据建立模型，用测试数据评估模型。让我们用<code class="du mc md me mf b">train_test_split</code>方法分割数据集。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="ff45" class="mk lg hi mf b be ml mm l mn mo">from sklearn.model_selection import train_test_split<br/>df_train_full, df_test = train_test_split(df, test_size=0.2, random_state=42)</span></pre><p id="9316" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在机器学习中，验证数据用于衡量模型的性能。有了这些数据，您可以微调超参数以找到最佳模型。让我们用<code class="du mc md me mf b">train_test_split</code>方法创建验证数据。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="1725" class="mk lg hi mf b be ml mm l mn mo">df_train, df_val = train_test_split(df_train_full, test_size=0.25, random_state=11)</span></pre><p id="ede8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，让我们创建目标变量，并从定型集和验证集中删除目标列。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="73e3" class="mk lg hi mf b be ml mm l mn mo">y_train = df_train.churn.values<br/>y_val = df_val.churn.values<br/>del df_train['churn']<br/>del df_val['churn']</span></pre></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="15dd" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">特征工程</h1><p id="e631" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">机器学习算法喜欢处理数值。这个过程被称为一键编码。您可以使用Pandas中的<code class="du mc md me mf b">get_dummies</code>方法或Scikit-learn中的<code class="du mc md me mf b">OneHotEncoder</code>方法执行一键编码。</p><p id="dd72" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本教程中，我将使用<code class="du mc md me mf b">dictVectorizer</code>类进行一次性编码。要使用这种方法，让我们首先将数据转换成字典结构。首先，让我们为分类和数字列创建变量。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="5e4e" class="mk lg hi mf b be ml mm l mn mo">categorical = ['gender', 'seniorcitizen', 'partner', 'dependents', 'phoneservice', 'multiplelines', 'internetservice', 'onlinesecurity', 'onlinebackup', 'deviceprotection', 'techsupport', 'streamingtv ', 'streamingmovies', 'contract', 'paperlessbilling', 'paymentmethod']<br/>numerical = ['tenure', 'monthlycharges', 'totalcharges']</span></pre><p id="82b3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在让我们将训练集转换为字典。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="54bb" class="mk lg hi mf b be ml mm l mn mo">train_dict = df_train[categorical + numerical].to_dict(orient='records')</span></pre><p id="b4f4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们看看这个变量的第一行。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="c4fa" class="mk lg hi mf b be ml mm l mn mo">train_dict[:1]<br/><br/>#Output:<br/>[{'gender': 'male',<br/>  'seniorcitizen': 0,<br/>  'partner': 'no',<br/>  'dependents': 'no',<br/>  'phoneservice': 'yes',<br/>  'multiplelines': 'no',<br/>  'internetservice': 'no',<br/>  'onlinesecurity': 'no_internet_service',<br/>  'onlinebackup': 'no_internet_service',<br/>  'deviceprotection': 'no_internet_service',<br/>  'techsupport': 'no_internet_service',<br/>  'streamingtv': 'no_internet_service',<br/>  'streamingmovies': 'no_internet_service',<br/>  'contract': 'month-to-month',<br/>  'paperlessbilling': 'no',<br/>  'paymentmethod': 'mailed_check',<br/>  'tenure': 3,<br/>  'monthlycharges': 19.85,<br/>  'totalcharges': 64.55}]</span></pre><p id="6e69" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在让我们将分类值转换为一键编码。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="5e98" class="mk lg hi mf b be ml mm l mn mo">from sklearn.feature_extraction import DictVectorizer<br/>dv = DictVectorizer(sparse=False)<br/>dv.fit(train_dict)<br/>X_train = dv.transform(train_dict)<br/>X_train[0]<br/><br/>#Output:<br/>array([ 1.  ,  0.  ,  0.  ,  1.  ,  0.  ,  0.  ,  1.  ,  0.  ,  0.  ,<br/>        1.  ,  0.  ,  0.  ,  1.  , 19.85,  1.  ,  0.  ,  0.  ,  0.  ,<br/>        1.  ,  0.  ,  0.  ,  1.  ,  0.  ,  1.  ,  0.  ,  1.  ,  0.  ,<br/>        0.  ,  0.  ,  0.  ,  1.  ,  0.  ,  1.  ,  0.  ,  0.  ,  1.  ,<br/>        0.  ,  0.  ,  1.  ,  0.  ,  0.  ,  1.  ,  0.  ,  3.  , 64.55])</span></pre><p id="e711" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您还可以使用<code class="du mc md me mf b">get_feature_names_out()</code>方法查看列的值。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="a36e" class="mk lg hi mf b be ml mm l mn mo">dv.get_feature_names_out()<br/><br/>#Output:<br/>array(['contract=month-to-month', 'contract=one_year',<br/>       'contract=two_year', 'dependents=no', 'dependents=yes',<br/>       'deviceprotection=no', 'deviceprotection=no_internet_service',<br/>       'deviceprotection=yes', 'gender=female', 'gender=male',<br/>       'internetservice=dsl', 'internetservice=fiber_optic',<br/>       'internetservice=no', 'monthlycharges', 'multiplelines=no',<br/>       'multiplelines=no_phone_service', 'multiplelines=yes',<br/>       'onlinebackup=no', 'onlinebackup=no_internet_service',<br/>       'onlinebackup=yes', 'onlinesecurity=no',<br/>       'onlinesecurity=no_internet_service', 'onlinesecurity=yes',<br/>       'paperlessbilling=no', 'paperlessbilling=yes', 'partner=no',<br/>       'partner=yes', 'paymentmethod=bank_transfer_(automatic)',<br/>       'paymentmethod=credit_card_(automatic)',<br/>       'paymentmethod=electronic_check', 'paymentmethod=mailed_check',<br/>       'phoneservice=no', 'phoneservice=yes', 'seniorcitizen',<br/>       'streamingmovies=no', 'streamingmovies=no_internet_service',<br/>       'streamingmovies=yes', 'streamingtv=no',<br/>       'streamingtv=no_internet_service', 'streamingtv=yes',<br/>       'techsupport=no', 'techsupport=no_internet_service',<br/>       'techsupport=yes', 'tenure', 'totalcharges'], dtype=object)</span></pre></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="e289" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">逻辑回归</h1><p id="3e29" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">要解决分类问题，可以使用许多算法，如朴素贝叶斯、随机森林和人工神经网络。一般来说，首先从最简单的模型开始。如果你建立的模型性能不好，就尝试更复杂的模型。</p><p id="1fea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所知，当目标变量是数字时，会使用回归模型。逻辑回归是一个线性模型，但用于解决分类问题。这是因为sigmoid函数用于逻辑回归。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/9c195681a07ec1aa63aa080ea7131c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KymZ5TxxZQKJHqYVsI4Abg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Basic Sigmoid Function</figcaption></figure><p id="d4b7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">sigmoid函数映射0和1之间的任何值。所以逻辑回归的结果变成了概率。现在让我们用Scikit-learn构建一个逻辑回归模型。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="ae44" class="mk lg hi mf b be ml mm l mn mo">from sklearn.linear_model import LogisticRegression<br/>model = LogisticRegression(solver="liblinear", random_state=42)<br/>model.fit(X_train, y_train)</span></pre><p id="5b42" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里我使用了<code class="du mc md me mf b">solver="liblinear"</code>参数。它建议对小样本使用此参数。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="9a45" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">模型评估</h1><p id="2af4" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">我们将使用验证数据来了解模型的性能。让我们像之前处理训练数据一样预处理验证数据。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="0527" class="mk lg hi mf b be ml mm l mn mo">val_dict = df_val[categorical+numerical].to_dict(orient="records")<br/>X_val = dv.transform(val_dict)<br/>y_pred = model.predict_proba(X_val)<br/>y_pred[:5]<br/><br/>#Output:<br/>array([[0.83279817, 0.16720183],<br/>       [0.74686651, 0.25313349],<br/>       [0.5643406 , 0.4356594 ],<br/>       [0.43763388, 0.56236612],<br/>       [0.95025844, 0.04974156]])</span></pre><p id="8de2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如你所见，预测值在0和1之间。这些值是客户流失目标变量的概率。如果概率大于0.5，模型预测将为1，如果概率小于0.5，模型预测将为0。现在让我们来看看在验证和训练数据集上使用<code class="du mc md me mf b">score</code>方法的模型的性能。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="bb49" class="mk lg hi mf b be ml mm l mn mo">print("The performance of the model on the validation dataset: ",<br/>          model.score(X_val, y_val))<br/>print("The performance of the model on the training dataset: ",<br/>          model.score(X_train, y_train))<br/><br/>#Output:<br/>The performance of the model on the validation dataset:  0.8034066713981547<br/>The performance of the model on the training dataset:  0.8049704142011834</span></pre><p id="4dd6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所见，该模型在验证和训练数据集上的得分约为80%。为了避免模型中的过拟合和欠拟合问题，我们希望模型的精度分数接近1，并且彼此接近。我们建立的模型还不错。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="5f64" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">模型解释</h1><p id="d3ad" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">因此，我们为每个变量训练了一个偏差和一个系数。建立一个好的模型意味着找到最佳的系数组合。训练模型后，我们可以使用Scikit-learn中的方法查看这些系数，如下所示:</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="d716" class="mk lg hi mf b be ml mm l mn mo">print("Bias: ",model.intercept_[0])<br/>print(dict(zip(dv.get_feature_names_out(), model.coef_[0].round(3))))<br/><br/>#Output:<br/><br/><br/>Bias:  -0.14501424313805428<br/>{'contract=month-to-month': 0.63, 'contract=one_year': -0.16, <br/>'contract=two_year': -0.615, 'dependents=no': -0.054, <br/>'dependents=yes': -0.091, 'deviceprotection=no': 0.027, <br/>'deviceprotection=no_internet_service': -0.132, <br/>'deviceprotection=yes': -0.04, 'gender=female': 0.015, <br/>'gender=male': -0.16, 'internetservice=dsl': -0.327, <br/>'internetservice=fiber_optic': 0.314, 'internetservice=no': -0.132, <br/>'monthlycharges': 0.003, 'multiplelines=no': -0.225, <br/>'multiplelines=no_phone_service': 0.124, 'multiplelines=yes': -0.044, <br/>'onlinebackup=no': 0.076, 'onlinebackup=no_internet_service': -0.132, <br/>'onlinebackup=yes': -0.089, 'onlinesecurity=no': 0.205, <br/>'onlinesecurity=no_internet_service': -0.132, 'onlinesecurity=yes': -0.217, <br/>'paperlessbilling=no': -0.241, 'paperlessbilling=yes': 0.096, <br/>'partner=no': -0.076, 'partner=yes': -0.069, <br/>'paymentmethod=bank_transfer_(automatic)': -0.107, <br/>'paymentmethod=credit_card_(automatic)': -0.186, <br/>'paymentmethod=electronic_check': 0.211, <br/>'paymentmethod=mailed_check': -0.064, 'phoneservice=no': 0.124, <br/>'phoneservice=yes': -0.269, 'seniorcitizen': 0.163, <br/>'streamingmovies=no': -0.139, 'streamingmovies=no_internet_service': -0.132, <br/>'streamingmovies=yes': 0.126, 'streamingtv=no': -0.059, <br/>'streamingtv=no_internet_service': -0.132, 'streamingtv=yes': 0.046, <br/>'techsupport=no': 0.16, 'techsupport=no_internet_service': -0.132, <br/>'techsupport=yes': -0.173, 'tenure': -0.055, 'totalcharges': 0.0}</span></pre><p id="37c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里，系数是对数概率。一旦你把它们指数化，它们就变成了赔率，这样你就能更清楚地解释它们。负系数的几率为&lt; 1, meaning the odds of the event occurring are lower than the baseline; on the other hand, a positive coefficient has odds &gt; 1，意味着观察到事件相对于基线的几率增加。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="9f34" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">预测新数据</h1><p id="ce8b" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">建立模型后，您可以预测模型以前没有见过的新数据。为了做到这一点，我将采用客户的价值观如下:</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="72a8" class="mk lg hi mf b be ml mm l mn mo">customer = {<br/> 'customerid': '8879-zkjof',<br/> 'gender': 'male',<br/> 'seniorcitizen': 1,<br/> 'partner': 'no',<br/> 'dependents': 'no',<br/> 'tenure': 41,<br/> 'phoneservice': 'yes',<br/> 'multiplelines': 'no',<br/> 'internetservice': 'dsl',<br/> 'onlinesecurity': 'yes',<br/> 'onlinebackup': 'no',<br/> 'deviceprotection': 'yes',<br/> 'techsupport': 'yes',<br/> 'streamingtv': 'yes',<br/> 'streamingmovies': 'yes',<br/> 'contract': 'one_year',<br/> 'paperlessbilling': 'yes',<br/> 'paymentmethod': 'bank_transfer_(automatic)',<br/> 'monthlycharges': 79.85,<br/> 'totalcharges': 2990.75,<br/>}</span></pre><p id="9372" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">首先，让我们用<code class="du mc md me mf b">transform</code>方法预处理数据，然后用我们的模型预测这个数据的标签。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="4c30" class="mk lg hi mf b be ml mm l mn mo">x_new = dv.transform([customer])<br/>model.predict_proba(x_new)<br/><br/>#Output:<br/>array([[0.93840227, 0.06159773]])</span></pre><p id="2e0f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如您所见，模型发现该客户离开服务的概率为7%，而不离开服务的概率为93%。作为一个数据科学家，你可以告诉你工作的公司，这个客户不太可能退订，所以没有必要为这个客户申请促销。现在让我们再取一个客户数据，预测标签。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="88e8" class="mk lg hi mf b be ml mm l mn mo">customer2 = {<br/> 'gender': 'female',<br/> 'seniorcitizen': 1,<br/> 'partner': 'no',<br/> 'dependents': 'no',<br/> 'phoneservice': 'yes',<br/> 'multiplelines': 'yes',<br/> 'internetservice': 'fiber_optic',<br/> 'onlinesecurity': 'no',<br/> 'onlinebackup': 'no',<br/> 'deviceprotection': 'no',<br/> 'techsupport': 'no',<br/> 'streamingtv': 'yes',<br/> 'streamingmovies': 'no',<br/> 'contract': 'month-to-month',<br/> 'paperlessbilling': 'yes',<br/> 'paymentmethod': 'electronic_check',<br/> 'tenure': 1,<br/> 'monthlycharges': 85.7,<br/> 'totalcharges': 85.7<br/>}</span></pre><p id="89ff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，让我们根据我们的模型来预测数据的标签。</p><pre class="iy iz ja jb fd mg mf mh bn mi mj bi"><span id="9eed" class="mk lg hi mf b be ml mm l mn mo">X_new2= dv.transform([customer2])<br/>model.predict_proba(X_new2)<br/><br/>#Output:<br/>array([[0.19738604, 0.80261396]])</span></pre><p id="b1af" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">正如你所看到的，这个客户离开服务的概率是80 %,所以你可以建议公司对这个客户进行促销。</p></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><h1 id="a41d" class="lf lg hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">结论</h1><p id="20fc" class="pw-post-body-paragraph jo jp hi jq b jr lx ij jt ju ly im jw jx lz jz ka kb ma kd ke kf mb kh ki kj hb bi translated">机器学习中最常用的模型是监督学习模型。监督学习分为回归和分类。如果数据标签是分类的，您可以使用分类算法。</p><p id="0e1d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇文章中，我谈到了如何用逻辑回归解决一个分类问题。我们建立的模型预测客户是否会流失。这个模型可以帮助你预测客户是否会流失。</p><p id="8a97" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本文使用的笔记本可以在<a class="ae jn" href="https://www.kaggle.com/code/tirendazacademy/telco-customer-churn-eda-logistic-regression" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="fe6d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢阅读。我希望你喜欢这篇文章。别忘了在YouTube|<a class="ae jn" href="https://instagram.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">insta gram</a>|<a class="ae jn" href="https://twitter.com/TirendazAcademy" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae jn" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>上关注我们</p><div class="ng nh ez fb ni nj"><a rel="noopener follow" target="_blank" href="/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">成为机器学习专家的6个步骤</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">成为机器学习专家需要知道的一切。</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx jh nj"/></div></div></a></div><div class="ng nh ez fb ni nj"><a href="https://heartbeat.comet.ml/three-tree-based-machine-learning-models-b69504af12d6" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hj fi z dy no ea eb np ed ef hh bi translated">三种基于树的机器学习模型</h2><div class="nq l"><h3 class="bd b fi z dy no ea eb np ed ef dx translated">关于如何使用Scikit实现决策树、随机森林和XGBoost的指南-学习和优化超参数…</h3></div><div class="nr l"><p class="bd b fp z dy no ea eb np ed ef dx translated">heartbeat.comet.ml</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx jh nj"/></div></div></a></div><h1 id="62b9" class="lf lg hi bd lh li nz lk ll lm oa lo lp io ob ip lr ir oc is lt iu od iv lv lw bi translated">资源</h1><ul class=""><li id="506b" class="kk kl hi jq b jr lx ju ly jx oe kb of kf og kj kp kq kr ks bi translated"><a class="ae jn" href="https://www.manning.com/books/machine-learning-bookcamp" rel="noopener ugc nofollow" target="_blank">机器学习图书营</a></li><li id="2537" class="kk kl hi jq b jr kt ju ku jx kv kb kw kf kx kj kp kq kr ks bi translated"><a class="ae jn" href="https://www.packtpub.com/product/machine-learning-with-pytorch-and-scikit-learn/9781801819312" rel="noopener ugc nofollow" target="_blank">使用PyTorch和Scikit-Learn进行机器学习</a></li></ul><p id="6db1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>
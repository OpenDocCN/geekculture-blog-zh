<html>
<head>
<title>Different Ways To Handle Imbalanced Dataset In Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中处理不平衡数据集的不同方法</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/different-ways-to-handl-imbalanced-dataset-in-machine-learning-32c7bc350257?source=collection_archive---------9-----------------------#2021-07-25">https://medium.com/geekculture/different-ways-to-handl-imbalanced-dataset-in-machine-learning-32c7bc350257?source=collection_archive---------9-----------------------#2021-07-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/53b10f25ad79f8be7382c227339fe04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EEY2fv5yX8ejTX_6fpweQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">the picture was taken From the <a class="ae iu" href="https://malecodependence.com/2013/01/31/one-sided-relationships-part-2/" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="48c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我们将了解什么是不平衡数据集以及如何处理它。</p><p id="b04d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我们将了解什么是不平衡数据集。</p><p id="562f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们有一个糖尿病数据集，我们必须预测病人是否患有糖尿病。在这种情况下，我们的结果将是“是”或“否”。由于这是一个分类机器学习问题，我们将在数据集的目标或从属特征中看到两个类别“糖尿病”和“非糖尿病”。</p><p id="8933" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们有1000名患者的数据集，其中900名患者是健康的，没有糖尿病，100名患者患有糖尿病。这里可以清楚地看到，多数群体(即没有糖尿病的患者)比少数群体(即糖尿病患者)多9倍。这样一种类型的数据集，其中一个类比另一个类占多数，称为<strong class="ix hj">不平衡数据集。</strong></p><p id="e62a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最常见的不平衡数据集的例子是，</p><ol class=""><li id="05c1" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">信用卡欺诈检测</li><li id="20e4" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">垃圾邮件</li><li id="22c2" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">医疗保健数据集</li></ol><ul class=""><li id="a1ef" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js kh jz ka kb bi translated">糖尿病数据集</li><li id="18bb" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">心脏病数据集</li><li id="4377" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">癌症数据集</li><li id="9964" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">肝病数据集</li><li id="dd1e" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">乳腺癌数据集</li><li id="9b3a" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">中风预测数据集</li><li id="bd70" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js kh jz ka kb bi translated">慢性肾脏疾病数据集</li></ul><p id="a09e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还有更多…</p><p id="1554" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们有一个不平衡的数据集时，如果我们在不平衡的数据上建立一个机器学习模型，那么很有可能会得到错误的分类，即不正确的分类。机器学习模型会有偏差，并给出不准确的结果。</p><p id="0b8b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们看看如何处理不平衡的数据集。</p><p id="91ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi ki translated"><span class="l kj kk kl bm km kn ko kp kq di">R</span><strong class="ix hj">e抽样</strong>是处理不平衡数据集最流行的技术之一。重采样的主要目的是通过增加少数类的频率或减少多数类的频率来平衡数据集。</p><p id="36da" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看一些重采样技术，</p><ol class=""><li id="ff0f" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><strong class="ix hj">欠采样</strong></li></ol><p id="d33f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">欠采样用于通过随机消除多数类来减少多数类。这样做，直到多数类实例和少数类实例达到平衡。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/a0d15e33eac5cba0dff94ae2705c959b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfpeT17uWe3EHpQ71HR3iQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">the picture was taken From the <a class="ae iu" href="https://heartbeat.fritz.ai/resampling-to-properly-handle-imbalanced-datasets-in-machine-learning-64d82c16ceaa" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="0c8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看之前糖尿病患者的例子:</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/18710231e251713c2dfefe22537c0ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEn9_Fi3G0_NIj97SUXUEQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Original Dataset</figcaption></figure><p id="608e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为欠采样导入库<strong class="ix hj"> NearMiss </strong>，然后拟合独立特征X和从属特征y。</p><pre class="ks kt ku kv fd kx ky kz la aw lb bi"><span id="2c38" class="lc ld hi ky b fi le lf l lg lh">from imblearn.under_sampling import NearMiss</span><span id="e486" class="lc ld hi ky b fi li lf l lg lh">nm = NearMiss()</span><span id="8c8d" class="lc ld hi ky b fi li lf l lg lh">X_us, y_us = nm.fit_resample(X,y)</span></pre><p id="5e03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在欠采样之后，我们会得到，</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/e32147fabe027c8d51bf88fa6d9ee790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jS6BZbYHud2b6bLy1vqRfw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">After Under Sampling</figcaption></figure><p id="ec78" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">欠采样的主要缺点是，我们丢失了数据的信息。当我们有数百万条记录时，我们可以使用欠采样。</p><p id="eeb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 2。过采样</strong></p><p id="7c9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">过采样用于通过随机复制它们来增加少数类。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/f5825f19035f6ac6fcc6e61f3f0de9e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0tjLjEsXrYEeoide8d6Bw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">the picture was taken From the <a class="ae iu" href="https://heartbeat.fritz.ai/resampling-to-properly-handle-imbalanced-datasets-in-machine-learning-64d82c16ceaa" rel="noopener ugc nofollow" target="_blank">link</a></figcaption></figure><p id="c361" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们再来看看之前糖尿病患者的例子:</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/18710231e251713c2dfefe22537c0ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEn9_Fi3G0_NIj97SUXUEQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Original Dataset</figcaption></figure><p id="c4f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导入库<strong class="ix hj"> RandomOverSampler </strong>进行过采样，然后拟合独立特征X和从属特征y。</p><pre class="ks kt ku kv fd kx ky kz la aw lb bi"><span id="457b" class="lc ld hi ky b fi le lf l lg lh">from imblearn.over_sampling import RandomOverSampler</span><span id="3de6" class="lc ld hi ky b fi li lf l lg lh">ros = RandomOverSampler()</span><span id="53bf" class="lc ld hi ky b fi li lf l lg lh">X_os, y_os = ros.fit_resample(X,y)</span></pre><p id="e63f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">过采样后，我们会得到</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/44f81fbc42cca5418c13485cb894f375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GguX7mvvOtdg9FEM41X-ag.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">After Over sampling</figcaption></figure><p id="ae4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">过采样的主要缺点是，它会导致<strong class="ix hj">过拟合</strong>机器学习模型，因为我们正在随机复制少数类的记录。</p><p id="649b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 3。重击</strong></p><p id="d122" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> SMOTE </strong>是一种过采样技术，为少数类生成样本。这些不是现有少数民族类数据的复制品或复制。它为少数民族创造了新的点数。</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/18710231e251713c2dfefe22537c0ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEn9_Fi3G0_NIj97SUXUEQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Original Dataset</figcaption></figure><p id="4542" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">应用SMOTE，</p><pre class="ks kt ku kv fd kx ky kz la aw lb bi"><span id="2831" class="lc ld hi ky b fi le lf l lg lh">from imblearn.over_sampling import SMOTE</span><span id="85bc" class="lc ld hi ky b fi li lf l lg lh">smote = SMOTE()</span><span id="273c" class="lc ld hi ky b fi li lf l lg lh">X_smote, y_smote = smote.fit_resample(X,y)</span></pre><p id="8f0c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">击杀之后，我们会得到</p><figure class="ks kt ku kv fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/44f81fbc42cca5418c13485cb894f375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GguX7mvvOtdg9FEM41X-ag.png"/></div></div></figure><p id="27d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> 4。smetomek</strong></p><p id="346d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SMOTETomek是使用SMOTE和Tomek链接的过采样和欠采样的组合。</p><pre class="ks kt ku kv fd kx ky kz la aw lb bi"><span id="d3e1" class="lc ld hi ky b fi le lf l lg lh">from imblearn.combine import SMOTETomek</span><span id="10c6" class="lc ld hi ky b fi li lf l lg lh">smotetomek = SMOTETomek()</span><span id="c212" class="lc ld hi ky b fi li lf l lg lh">X_smotetomek, y_smotetomek = smotetomek.fit_resample(X,y)</span></pre><h2 id="50ca" class="lc ld hi bd ll lm ln lo lp lq lr ls lt jg lu lv lw jk lx ly lz jo ma mb mc md bi translated"><strong class="ak">资源</strong></h2><p id="88e2" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">有许多资源可以处理我们不平衡的数据集。这里有一些可以帮助你，</p><ul class=""><li id="9704" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js kh jz ka kb bi translated"><a class="ae iu" href="https://imbalanced-learn.org/stable/references/index.html" rel="noopener ugc nofollow" target="_blank">不平衡学习的官方文档</a></li></ul><h2 id="da74" class="lc ld hi bd ll lm ln lo lp lq lr ls lt jg lu lv lw jk lx ly lz jo ma mb mc md bi translated">结论</h2><p id="2a13" class="pw-post-body-paragraph iv iw hi ix b iy me ja jb jc mf je jf jg mg ji jj jk mh jm jn jo mi jq jr js hb bi translated">在本文中，我们看到了什么是不平衡数据集和不同的重采样技术，它们允许您更改我们的数据集平衡，以便我们的模型可以更有效地学习。</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><p id="00b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请随时留下您的评论、建议或任何错误。😊</p><p id="e62d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">帮我接通:</strong><a class="ae iu" href="https://www.linkedin.com/in/sagar-dhandare-a401271a3/" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">LinkedIn</strong></a><strong class="ix hj">|</strong><a class="ae iu" href="https://github.com/SagarDhandare" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">GitHub</strong></a><strong class="ix hj">|</strong><a class="ae iu" href="mailto:%20sagardhandare3@gmail.com" rel="noopener ugc nofollow" target="_blank"><strong class="ix hj">邮箱</strong> </a></p><p id="1e13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">快乐学习！！！❤🥀 </strong></p></div></div>    
</body>
</html>
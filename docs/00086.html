<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/geekculture/create-dynamic-word-documents-using-docx-js-file-saver-and-data-from-an-excel-or-json-dbd5e4ec823f?source=collection_archive---------0-----------------------#2020-04-22">https://medium.com/geekculture/create-dynamic-word-documents-using-docx-js-file-saver-and-data-from-an-excel-or-json-dbd5e4ec823f?source=collection_archive---------0-----------------------#2020-04-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/beeaa94a2ec6495f9f72a80a6b19eb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/1*6nhGYTC3JL0-gLk6pkjbPg.gif"/></div></figure><p id="7c18" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">使用DOCX Js、文件保存程序和EXCEL或JSON中的数据创建动态word文档</p></div><div class="ab cl im in gp io" role="separator"><span class="ip bw bk iq ir is"/><span class="ip bw bk iq ir is"/><span class="ip bw bk iq ir"/></div><div class="hb hc hd he hf"><p id="bb37" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">一切都是从我的一个小项目开始的，他们需要创建大量的测试文档(大约100个),他们需要相同的旧模板🤢每个文档都必须有一个Excel的信息，我对此非常不安，然后我搜索如何创建动态文档。</p><p id="e349" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">如果你想看这一切的视频，链接在这里</p><figure class="it iu iv iw fd hk"><div class="bz dy l di"><div class="ix iy l"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">Video with all the information in this article</figcaption></figure><p id="dd19" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后我发现了这个docx，我学了一点，然后我创建了我的第一个文档，我会告诉你如何…</p><h2 id="9c6a" class="jd je hp bd jf jg jh ji jj jk jl jm jn hz jo jp jq id jr js jt ih ju jv jw jx bi translated">嗨，我更新了这篇文章，如果你想看的话，我制作了一个新的视频</h2><div class="hh hi ez fb hj jy"><a rel="noopener follow" target="_blank" href="/@olivertate274/updated-how-to-create-multiple-documents-with-docx-js-with-json-data-in-javascript-b1924879b288"><div class="jz ab dw"><div class="ka ab kb cl cj kc"><h2 class="bd kd fi z dy ke ea eb kf ed ef kg bi translated">更新了如何使用JavaScript中的JSON数据用Docx.js创建多个文档</h2><div class="kh l"><h3 class="bd b fi z dy ke ea eb kf ed ef dx translated">我写了一个关于这个话题的帖子，但是这个话题有点过时了，在同一个视频里，人们有点…</h3></div><div class="ki l"><p class="bd b fp z dy ke ea eb kf ed ef dx translated">medium.com</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko hl jy"/></div></div></a></div><p id="79e2" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">新视频也在这里，非常感谢</p><figure class="it iu iv iw fd hk"><div class="bz dy l di"><div class="ix iy l"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">Video updated with all the information of DOCX</figcaption></figure><p id="01b6" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">首先，我们需要https://codesandbox.io/，因为它拥有我创造它所需要的一切</p><p id="acff" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后，您需要导入两个依赖项</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es kq"><img src="../Images/2166737e6d7d89862097834dc17274ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*3RH9xfjivpdIgLVQ7xs2SA.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">adding sandbox dependencies</figcaption></figure><p id="dc33" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后你需要导入模块</p><p id="f66c" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated"><strong class="hq kd">重要！docx的版本必须是4.7.1，因为它有我们现在需要的所有东西。</strong></p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="0025" class="jd je hp ks b fi kw kx l ky kz">import { Document, Packer, Paragrap } from "docx";</span><span id="32d3" class="jd je hp ks b fi la kx l ky kz">import { saveAs } from "file-saver";</span></pre><p id="c8ee" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">他们旁边的建筑</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es lb"><img src="../Images/6e08cdbad16185eabc48e5dfe63f2251.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*eq9GjVZv5NI8M4JvtV4_Gg.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">documents in Sandbox</figcaption></figure><p id="39a9" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">和index.html</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="ec11" class="jd je hp ks b fi kw kx l ky kz">&lt;!DOCTYPE html&gt;</span><span id="6a47" class="jd je hp ks b fi la kx l ky kz">&lt;html&gt;</span><span id="a1d4" class="jd je hp ks b fi la kx l ky kz">&lt;head&gt;</span><span id="b5ee" class="jd je hp ks b fi la kx l ky kz">&lt;title&gt;Parcel Sandbox&lt;/title&gt;</span><span id="90ed" class="jd je hp ks b fi la kx l ky kz">&lt;meta charset=”UTF-8" /&gt;</span><span id="1cca" class="jd je hp ks b fi la kx l ky kz">&lt;/head&gt;</span><span id="5046" class="jd je hp ks b fi la kx l ky kz">&lt;body&gt;</span><span id="cd7e" class="jd je hp ks b fi la kx l ky kz">&lt;div id=”app”&gt;&lt;/div&gt;</span><span id="44d1" class="jd je hp ks b fi la kx l ky kz">&lt;button id=”button-word”&gt;Word document in progress!!&lt;/button&gt;</span><span id="43e5" class="jd je hp ks b fi la kx l ky kz">&lt;script src=”src/index.js”&gt;&lt;/script&gt;</span><span id="0060" class="jd je hp ks b fi la kx l ky kz">&lt;/body&gt;</span><span id="7b43" class="jd je hp ks b fi la kx l ky kz">&lt;/html&gt;</span></pre><p id="cccb" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">如果你愿意，你只需要一个按钮来激活单词creation，我创建了一个事件(就是这个按钮),我们称这个事件为generateWordDocument</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="6700" class="jd je hp ks b fi kw kx l ky kz">document</span><span id="6696" class="jd je hp ks b fi la kx l ky kz">.getElementById("button-word")</span><span id="bbab" class="jd je hp ks b fi la kx l ky kz">.addEventListener("click", generateWordDocument, false);</span></pre><p id="69ee" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后，该函数创建我们需要的文档，我为文档创建了一个新的实例和一个段落，然后我将doc变量发送给一个名为saveDocumentToFile的新函数和我的文档的名称。</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="2192" class="jd je hp ks b fi kw kx l ky kz">function generateWordDocument() {</span><span id="60db" class="jd je hp ks b fi la kx l ky kz">//instance<br/>let doc = new Document();</span><span id="171c" class="jd je hp ks b fi la kx l ky kz">// create some paragraphs</span><span id="533a" class="jd je hp ks b fi la kx l ky kz">doc.createParagraph("This paragraph will be in my new document");</span><span id="06bd" class="jd je hp ks b fi la kx l ky kz">//and using this function we can save our file from the browser</span><span id="c6b9" class="jd je hp ks b fi la kx l ky kz">saveDocumentToFile(doc, `first.docx`);</span><span id="feec" class="jd je hp ks b fi la kx l ky kz">}</span></pre><p id="1703" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">之后，saveDocumentToFile函数帮助我们保存文件，接收带有段落和文件名的doc变量。我为Microsoft documents创建了一个Packer和mimeType的新实例，然后是包含文档实例和mimeType的b Blob，最后我们使用saveAs导出文件</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="80f1" class="jd je hp ks b fi kw kx l ky kz">function saveDocumentToFile(doc, fileName) {</span><span id="52aa" class="jd je hp ks b fi la kx l ky kz">const packer = new Packer();</span><span id="a6b6" class="jd je hp ks b fi la kx l ky kz">const mimeType =</span><span id="e698" class="jd je hp ks b fi la kx l ky kz">"application/vnd.openxmlformats-officedocument.wordprocessingml.document";</span><span id="6838" class="jd je hp ks b fi la kx l ky kz">packer.toBlob(doc).then(blob =&gt; {</span><span id="80ee" class="jd je hp ks b fi la kx l ky kz">const docblob = blob.slice(0, blob.size, mimeType);</span><span id="f46c" class="jd je hp ks b fi la kx l ky kz">saveAs(docblob, fileName);</span><span id="1c0a" class="jd je hp ks b fi la kx l ky kz">});</span><span id="cbaa" class="jd je hp ks b fi la kx l ky kz">}</span></pre><p id="bd1c" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后你就有了你的文件</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es lc"><img src="../Images/7725e5326b4c6ab76fc373550315fae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*BBiHkwPzZgtlEob9TO-rRw.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">First document with DOCX.js</figcaption></figure><figure class="it iu iv iw fd hk er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/f636839c74ddc5effd6f380bff67852d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hk3jicOTZY-bc2Igub-eVQ.png"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx">Example Visual document</figcaption></figure><p id="ea54" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">但是，如果我们需要，我不知道会发生什么，想象一下100个具有相同模板的文档，以及Excel或其他数据的数据，例如，我将使用这个小表，您可以使用大表。</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es li"><img src="../Images/13c3fb8c217bd333244e899a4af2af52.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*WEvz-YWPQmTH1ljrpXMUwg.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">Example information from Excel</figcaption></figure><p id="d954" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">你需要这个页面【https://www.convertcsv.com/csv-to-json.htm<br/>你可以上传你的csv或者插入数据</p><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es lj"><img src="../Images/7f0a09aeb807b44918ea927d70551a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNoSFWw1xup1NfQ0SzFXsQ.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">Example excel data became JSON data</figcaption></figure><p id="d397" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">然后生成JSON</p><figure class="it iu iv iw fd hk er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lk"><img src="../Images/cb580718365c2c5b899e3af520ae720c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvlJ-mWUnxMghtqtl_Ig8g.png"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx">JSON data</figcaption></figure><p id="e40b" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">对于json，我们需要创建一个变量，并将数据插入到该变量中</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="3194" class="jd je hp ks b fi kw kx l ky kz">const fakeDataExcel = [<br/>{</span><span id="6bf2" class="jd je hp ks b fi la kx l ky kz">"Id": 1,</span><span id="72ab" class="jd je hp ks b fi la kx l ky kz">"name": "Michael",</span><span id="1814" class="jd je hp ks b fi la kx l ky kz">"country": "England"</span><span id="0244" class="jd je hp ks b fi la kx l ky kz">},</span><span id="9eeb" class="jd je hp ks b fi la kx l ky kz">{</span><span id="a04a" class="jd je hp ks b fi la kx l ky kz">"Id": 2,</span><span id="5486" class="jd je hp ks b fi la kx l ky kz">"name": "Charles",</span><span id="2d30" class="jd je hp ks b fi la kx l ky kz">"country": "Canada"</span><span id="1d18" class="jd je hp ks b fi la kx l ky kz">}</span><span id="bfe5" class="jd je hp ks b fi la kx l ky kz">]</span></pre><p id="8e6a" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">我们需要创建一个for循环，在for循环中，我们可以插入一个带有setTimeout的自动调用函数。因为如果你试图运行大量的数据，这个过程太快了，一些文件会丢失，相信我，我试过了</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="f83c" class="jd je hp ks b fi kw kx l ky kz"><br/>for (let i = 0; i &lt; fakeDataExcel.length; i++) {</span><span id="10ed" class="jd je hp ks b fi la kx l ky kz">(function(i) {</span><span id="3f27" class="jd je hp ks b fi la kx l ky kz">window.setTimeout(function() {</span><span id="2d4f" class="jd je hp ks b fi la kx l ky kz">}, i * 2000);</span><span id="2666" class="jd je hp ks b fi la kx l ky kz">})(i);</span><span id="e55e" class="jd je hp ks b fi la kx l ky kz">}</span></pre><p id="9b13" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">你需要做的最后一部分是动态变量，最后的代码是这样的</p><pre class="it iu iv iw fd kr ks kt ku aw kv bi"><span id="4f7e" class="jd je hp ks b fi kw kx l ky kz">for (let i = 0; i &lt; fakeDataExcel.length; i++) {</span><span id="6445" class="jd je hp ks b fi la kx l ky kz">(function(i) {</span><span id="eae0" class="jd je hp ks b fi la kx l ky kz">window.setTimeout(function() {</span><span id="daa4" class="jd je hp ks b fi la kx l ky kz">let doc = new Document();</span><span id="b833" class="jd je hp ks b fi la kx l ky kz">doc.createParagraph(`Id: ${fakeDataExcel[i]['Id']}`);</span><span id="d34a" class="jd je hp ks b fi la kx l ky kz">doc.createParagraph(`Name: ${fakeDataExcel[i]['name']}`);</span><span id="972e" class="jd je hp ks b fi la kx l ky kz">doc.createParagraph(`Country:  ${fakeDataExcel[i]['country']}`);</span><span id="808e" class="jd je hp ks b fi la kx l ky kz">saveDocumentToFile(doc, `user${fakeDataExcel[i]['name']}-${fakeDataExcel[i]['Id']}.docx`);</span><span id="af51" class="jd je hp ks b fi la kx l ky kz">}, i * 2000);</span><span id="c3a3" class="jd je hp ks b fi la kx l ky kz">})(i);</span><span id="bbc9" class="jd je hp ks b fi la kx l ky kz">}</span></pre><figure class="it iu iv iw fd hk er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ll"><img src="../Images/fc2b330b25eddbfea27c08992cd06fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J9vRe29t315Tj78D6V2GaQ.png"/></div></div><figcaption class="iz ja et er es jb jc bd b be z dx">Example Creating dynamic documents</figcaption></figure><figure class="it iu iv iw fd hk er es paragraph-image"><div class="er es lm"><img src="../Images/fd35da124f1becbc65923289153e077f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*_LT-XaH9fH-EI7k_W8u6KA.png"/></div><figcaption class="iz ja et er es jb jc bd b be z dx">Creating our word documents with DOCX.js</figcaption></figure><div class="it iu iv iw fd ab cb"><figure class="ln hk lo lp lq lr ls paragraph-image"><img src="../Images/31e333a37d25497ff700a0f782b85c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*PS5k5JpiiVLA2OiOB4OjYw.png"/></figure><figure class="ln hk lt lp lq lr ls paragraph-image"><img src="../Images/a6d86029aa106c25e0b000fc8f1a90da.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*aqTNvrdaGSn5VONLWtvpAw.png"/><figcaption class="iz ja et er es jb jc bd b be z dx lu di lv lw">Text from Word document</figcaption></figure></div><h1 id="85fa" class="lx je hp bd jf ly lz ma jj mb mc md jn me mf mg jq mh mi mj jt mk ml mm jw mn bi translated">结论</h1><p id="ea48" class="pw-post-body-paragraph hn ho hp hq b hr mo ht hu hv mp hx hy hz mq ib ic id mr if ig ih ms ij ik il hb bi translated">如果你需要创建太多的文件和动态变量，这将有助于你，如果你想做得更好，样式也将有助于你一切都在这一部分，如果你需要帮助，我会尽力帮助你👍感谢你的阅读。</p><p id="c7f1" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">来源<br/><a class="ae kp" href="https://github.com/dolanmiu/docx/issues/211" rel="noopener ugc nofollow" target="_blank">https://github.com/dolanmiu/docx/issues/211</a><br/><a class="ae kp" href="https://github.com/dolanmiu/docx/wiki/Examples" rel="noopener ugc nofollow" target="_blank">https://github.com/dolanmiu/docx/wiki/Examples</a><br/><a class="ae kp" href="https://github.com/dolanmiu/docx/wiki/Styling-with-JS" rel="noopener ugc nofollow" target="_blank">https://github.com/dolanmiu/docx/wiki/Styling-with-JS</a><br/><a class="ae kp" href="https://www.iainfreestone.com/how-to-create-a-word-document-with-javascript/" rel="noopener ugc nofollow" target="_blank">https://www . iainfreestone . com/how-to-create-a-word-document-with-JavaScript/</a><br/><a class="ae kp" href="https://www.convertcsv.com/csv-to-json.htm" rel="noopener ugc nofollow" target="_blank">https://www.convertcsv.com/csv-to-json.htm</a></p><p id="cf6f" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated"><br/>完整代码:<a class="ae kp" href="https://codesandbox.io/s/competent-http-hqr6x?file=/src/index.js" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/competent-http-hqr6x?file =/src/index . js</a><br/><a class="ae kp" href="https://codesandbox.io/s/mystifying-mclaren-dls9n?file=/src/index.js" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/mystifying-mclaren-dls9n?file=/src/index.js </a></p><p id="5e50" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">视频【https://youtu.be/4sGg9rmn2EM】T22<br/>T23】</p><p id="a439" class="pw-post-body-paragraph hn ho hp hq b hr hs ht hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il hb bi translated">在推特上关注我@ shadow beat 274<br/><a class="ae kp" href="https://www.buymeacoffee.com/YdAe1D4" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/YdAe1D4</a><br/><a class="ae kp" href="https://github.com/rodrigofigueroa/docxjsexample" rel="noopener ugc nofollow" target="_blank">https://github.com/rodrigofigueroa/docxjsexample</a></p></div></div>    
</body>
</html>
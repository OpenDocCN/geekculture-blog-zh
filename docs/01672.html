<html>
<head>
<title>Music Genre Classification — Part 2: SVM, Convolutional Neural Network, Convolutional Recurrent Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">音乐流派分类第2部分:SVM、卷积神经网络、卷积递归神经网络</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/music-genre-classification-part-2-svm-convolutional-neural-network-convolutional-recurrent-846c80448192?source=collection_archive---------22-----------------------#2021-04-19">https://medium.com/geekculture/music-genre-classification-part-2-svm-convolutional-neural-network-convolutional-recurrent-846c80448192?source=collection_archive---------22-----------------------#2021-04-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="62f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为我上一篇文章的延续，在这篇文章中，我将深入构建我的音乐流派分类器的建模阶段。我将我的建模方法分为两个阶段。在第一阶段，我尝试了各种分类模型，如逻辑回归、KNN、随机森林、SVM、梯度推进和XGBoost。第二阶段，我实验了卷积神经网络、卷积递归神经网络等深度学习模型。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="2149" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我的建模过程的第一阶段，我将展示我所使用的一般框架，并强调一些值得一提的注意事项，而不是单独研究每个分类模型。</p><h1 id="1697" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">管道和网格搜索</h1><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kj"><img src="../Images/552c9351a6c9863a74a4d923541cca75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*n_CnBr5Bw8R8UdTLQG1HAg.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx"><a class="ae jd" href="https://www.gamasutra.com/blogs/RadekKoncewicz/20110705/89706/Super_Mario_Bros_3_Level_Design_Lessons_Part_3.php" rel="noopener ugc nofollow" target="_blank">https://www.gamasutra.com/blogs/RadekKoncewicz/20110705/89706/Super_Mario_Bros_3_Level_Design_Lessons_Part_3.php</a></figcaption></figure><p id="58be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一般的经验法则，当我建模时，我喜欢以可重复和可伸缩的方式设置我的模型。鉴于数据科学从来都不是线性的，而是迭代的，这一点尤为重要。这就是为什么以允许我改变或改变的方式建立我的模型是非常重要的。我确保我的模型保持灵活性的方法之一是建立一个管道。</p><p id="cc88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据scikit-learn <a class="ae jd" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>，“流水线的目的是组装几个步骤，这些步骤可以在设置不同参数的同时进行交叉验证”。</p><p id="27f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简单地说，pipeline允许您链接各种数据转换器，并绑定到您选择的估计器。例如，为了正确训练支持向量机分类器，我需要缩放我的数据，特别是考虑到SVM使用梯度下降来最小化其损失函数。为了结合缩放数据和训练SVM分类器的过程，我创建了一个管道，在其中指定数据转换器(StandScaler)和估计器(SVM)。这是一个用于演示目的的简单案例，但是您可以看到，如果在训练模型之前需要应用多个数据转换器，那么设置管道会有多么强大。</p><p id="475e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重要的是要注意到输入管道的顺序很重要。因为在这种情况下，我想首先缩放我的数据，然后训练我的模型，所以我将StandScaler作为我的第一个输入。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kv"><img src="../Images/f790d19c9d5f9c4cb388afd7478e8db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iVo42Pq5G6FftBY2BJ7jLg.png"/></div></div></figure><p id="6d00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置管道的另一个好处是，您可以对超参数进行网格搜索，以获得最佳性能！</p><p id="62c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个简单的GridSearch设置，用于演示目的。我喜欢GridSearch的地方在于，我不仅可以调优各种超参数，还可以同时交叉验证所有参数！</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es la"><img src="../Images/a5ac26f448a8aea996df9a7042e1f6f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHZY5cevRquzGEmQTC-iyA.png"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="219e" class="jl jm hi bd jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki bi translated"><strong class="ak">卷积神经网络</strong></h1><p id="6b70" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">使用我从音乐数据集中提取的Mel-spectrogram，这些数据是音乐所有核心元素(时间、频率和幅度)的可视化表示，我建立并训练了一个卷积神经网络。</p><p id="d6b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络是一种功能强大的模型，在处理空间和图像数据时表现非常出色。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ll"><img src="../Images/89dea5b6c24793f3b3861fc6ff699f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sajCPg4frDZc7lThGuph7Q.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Reshaping mel-spectrogram data to be compatible for convolutional layers</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lm"><img src="../Images/1a3ca176040e27de040788902452e5da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FcF9z1wjPkmlAdPW9k1DQ.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">CNN Topology</figcaption></figure><p id="5def" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">拓扑结构由卷积层组成，再加上MaxPooling2D，然后是一系列密集层和脱落层，以努力正则化并避免过度拟合。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="2210" class="jl jm hi bd jn jo lb jq jr js lc ju jv jw ld jy jz ka le kc kd ke lf kg kh ki bi translated">卷积递归神经网络</h1><p id="f97c" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">作为提高性能的最后尝试，我决定结合卷积层和递归层(GRU)。这项工作背后的基本原理是，音乐本质上是一段时间内的连续数据。由于GRU和LTSM等重现图层已被证明能够很好地处理顺序数据，因此我决定将这两个图层结合起来，测量性能的提升。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ln"><img src="../Images/325a29c8ce97f5269ce7d4992edb5b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0FONgi5z1sBGyAdVvqVP-A.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">CRNN Toplogy</figcaption></figure><p id="f879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本拓扑结构保持不变，但重要的是要记住将形状改回其原始形状，以便正确处理GRU。GRU之后，密集层和脱落层保持不变。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lo"><img src="../Images/9f82d848f1fe43240db343b15e9b53d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGD10BDCB_PIcMHGn_jHSw.png"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Performance based on accuracy</figcaption></figure><p id="0ec3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就整体性能而言，CRNN(有退出者)被证明是基于准确度得分的最佳性能模型。与训练数据符合率为98.6%，与测试数据符合率为86.7%。</p><p id="32c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">鉴于当前最先进的准确率分数徘徊在90–95%之间，我发现我的CRNN模型是有前途的，值得付出额外的努力来继续增强以获得更好的性能。</p></div></div>    
</body>
</html>
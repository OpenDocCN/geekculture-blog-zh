<html>
<head>
<title>Swift| Closures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift|关闭</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swift-closures-8019875af0a5?source=collection_archive---------6-----------------------#2022-02-07">https://medium.com/geekculture/swift-closures-8019875af0a5?source=collection_archive---------6-----------------------#2022-02-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d689" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">快速关闭指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f51431bf8fbe4267d0dd0cc30abe0663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5gYslgmETL_lIGT-.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@gamell?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Joan Gamell</a> on <a class="ae jn" href="https://unsplash.com/s/photos/functions?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e9df" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">闭包是赋给变量的函数。这些变量用于调用函数。让我们从一个简单的打印消息的例子开始。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="ce00" class="kp kq hi kl b fi kr ks l kt ku">let study = {<br/>    print("I am studying")<br/>}</span></pre><p id="6185" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">上面是一个没有参数的简单闭包。您可以通过调用study()来调用这个闭包。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="0ed1" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">什么是闭包，为什么在Swift中使用闭包？</h1><p id="b037" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">闭包主要用于存储函数。就像我之前提到的，闭包允许你将一些函数封装到一个变量中，并将它们存储在某个地方。闭包在第一次学习Swift时很难读懂，尤其是在接受和返回自己的参数时。但是如果你经常看到闭包，你会习惯的。</p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="900d" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">在闭包中调用参数</h1><p id="8507" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">在闭包中，参数列在花括号{}内。如果您想让闭包接受参数，就在大括号{}后面的括号()中添加它们。</p><p id="39fc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，您可以创建一个将年龄作为参数的闭包。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="85c0" class="kp kq hi kl b fi kr ks l kt ku">let person = { (age:Int) in <br/>     print("This person is (\(age)) years old" <br/>}</span></pre><p id="86f1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">用参数调用闭包看起来像下面这样</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="ffd7" class="kp kq hi kl b fi kr ks l kt ku">person(11)<br/>//output <br/>//"This person is 11 years old"</span></pre></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="a259" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">为什么闭包在花括号{ }里面？</h1><p id="8422" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">让我们看看函数和闭包之间的区别</p><p id="4fe9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">操作码</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="9663" class="kp kq hi kl b fi kr ks l kt ku">func pay(user:String, amount: Int){ <br/>    //code<br/>}</span></pre><p id="72b9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">关闭代码</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="0625" class="kp kq hi kl b fi kr ks l kt ku">let payment = { (user: String, amount: Int) in<br/>    // code<br/>}</span></pre><p id="783f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您可能已经注意到，参数已经被移到了花括号内。中的关键字<strong class="jq hj">标志着闭包主体的开始。参数和闭包体是同一个代码块的一部分，并且是变量，所以如果{}中有参数，它们表示闭包类型。在中查找关键字，以区分参数和正文。</strong></p></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="b35d" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">从闭包返回值。</h1><p id="48c1" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">闭包也可以返回值，类似于参数。return方法就写在。让我们来看一个例子，让事情更清楚。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="1f8b" class="kp kq hi kl b fi kr ks l kt ku">let eating = { (food:String) -&gt; String in <br/>    return "I am eating \(food)"<br/>}</span></pre><p id="9141" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因为我们希望闭包返回一个字符串，而不是直接输出消息，所以我们需要像下面这样声明返回类型-&gt;String。不要；忘记in关键字跟在返回类型后面。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="87c8" class="kp kq hi kl b fi kr ks l kt ku">let lunch = eating("pizza") <br/>print(lunch)</span><span id="c3f6" class="kp kq hi kl b fi ly ks l kt ku">//OUTPUT <br/>//"I am eating pizza"</span></pre><h1 id="3244" class="lc kq hi bd ld le lz lg lh li ma lk ll io mb ip ln ir mc is lp iu md iv lr ls bi translated">返回不带参数的值</h1><p id="694b" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">只需添加一个空参数，括号内没有值。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="cc62" class="kp kq hi kl b fi kr ks l kt ku">let eatPizza = {() -&gt; String in <br/>     return "I am eating pizza"<br/>}</span></pre></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="8233" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">将闭包传递给函数</h1><p id="41c7" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">闭包可以像其他数据类型一样使用，所以可以在函数中传递它们。</p><p id="199e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们从简单的开始</p><p id="ac9c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接受闭包的函数</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="7e86" class="kp kq hi kl b fi kr ks l kt ku">//Function that takes in Closure <br/>func getReady(action:() -&gt; Void) { <br/>    print("I wake up and wash my face") <br/>    action() <br/>    print("Ready!")<br/>}</span></pre><p id="a596" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">关闭:</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="c252" class="kp kq hi kl b fi kr ks l kt ku">let brushTeeth = {<br/>     print("I brush my teeth") <br/>}</span></pre><p id="04db" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">呼叫功能</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="fa31" class="kp kq hi kl b fi kr ks l kt ku">getReady(action: brushTeeth) <br/>//OUTPUT <br/>//"I wake up and wash my face"<br/>// "I brush my teeth" <br/>// "Ready!"</span></pre><h1 id="3c60" class="lc kq hi bd ld le lz lg lh li ma lk ll io mb ip ln ir mc is lp iu md iv lr ls bi translated">尾随闭包</h1><p id="6e22" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">让我们尝试一种不同的方法来调用上面的函数，不要将闭包保存在不同的变量中。在这个例子中，我们将把一个字符串作为闭包的参数。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="27c2" class="kp kq hi kl b fi kr ks l kt ku">func getReady(action:(String) -&gt; Void) {<br/>    print("I wake up and wash my face") <br/>    action("Brush my Teeth") <br/>    print("Ready!")<br/>}</span></pre><p id="e7f5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意我们是如何向闭包传递一个字符串的。正如参数中所示，这就是我们需要做的。我们现在将调用该函数，并告诉用户在调用该函数时闭包必须做什么。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="b3fb" class="kp kq hi kl b fi kr ks l kt ku">getReady{(thingTodo:String) in <br/>     print("I will \(thingTodo)")<br/>}OUTPUT <br/>// "I wake up and wash my face"<br/>// "I will Brush my Teeth"<br/>// "Ready!"</span></pre><p id="d574" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">进展顺利吗？？</p><p id="7c4d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们尝试一个更难的例子</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="f845" class="kp kq hi kl b fi kr ks l kt ku">func getDirections(to destination: String, then travel:(([String]) -&gt; Void){   print("Will be taking vehicle")   <br/>   let directions = [<br/>        "Go straight ahead",<br/>        "Turn left at the corner", <br/>        "When you see the school go straight ahead",<br/>        "Then you will arrive at \(destination)"]<br/>   travel(directions)<br/>}</span></pre><p id="617f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请记住，您需要在初始化方向列表后调用闭包，并将那个[String]作为闭包的参数调用。</p><p id="68ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们用结尾闭包来调用函数</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="cfc6" class="kp kq hi kl b fi kr ks l kt ku">getDirection(to:"HOSPITAL") { (path:[String]) in  <br/>    for i in path{<br/>        print(i) <br/>    }<br/>}<br/>//OUTPUT <br/>// "Driving with Vehicle"<br/>// "Go straight ahead"<br/>// "Turn left at the corner", <br/>// "When you see the school go straight ahead",<br/>// "Then you will arrive at HOSPITAL"</span></pre></div><div class="ab cl kv kw gp kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="hb hc hd he hf"><h1 id="0d2e" class="lc kq hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">返回值时使用闭包作为参数</h1><p id="dd60" class="pw-post-body-paragraph jo jp hi jq b jr lt ij jt ju lu im jw jx lv jz ka kb lw kd ke kf lx kh ki kj hb bi translated">Swift中的闭包可以带参数，也可以带返回值，您可以在函数中使用这些闭包。更好的是，这些函数还可以返回值。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="f69c" class="kp kq hi kl b fi kr ks l kt ku"><strong class="kl hj">func</strong> MorningRoutine(first:String , second:((String) -&gt; String)){<br/>     print("My Morning Routine")<br/>     print(first)<br/>     <strong class="kl hj">let</strong> secondThing = second("Brush my Teeth")<br/>     print(secondThing)<br/>     print("I am finished with my morning routine")}</span></pre><p id="f2cf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意我们是如何在参数中将一个字符串返回给闭包的？当我们在函数中调用闭包时，我们将把它的值保存到一个常量中，以后再调用它。</p><p id="afa2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们试着调用这个函数，看看闭包是什么样子的。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="2de5" class="kp kq hi kl b fi kr ks l kt ku">MorningRoutine(first:"Wake Up "){(doThis: String) -&gt; String <strong class="kl hj">in<br/>    return</strong> doThis<br/>}//OUTPUT //"My Morning Routine"//"Wake Up"//"Brush my Teeth"//"I am finished with my morning routine"</span></pre><h1 id="292d" class="lc kq hi bd ld le lz lg lh li ma lk ll io mb ip ln ir mc is lp iu md iv lr ls bi translated">具有两个返回值的闭包的函数</h1><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="c8bc" class="kp kq hi kl b fi kr ks l kt ku"><strong class="kl hj">func</strong> MorningRoutine(first:String , second:((String) -&gt; String)) -&gt; String {<br/>     print("My Morning Routine")<br/>     print(first)<br/>     <strong class="kl hj">let</strong> secondThing = second("Brush my Teeth")<br/>     print(secondThing)<br/>     print("I am finished with my morning routine") <br/>     <br/>     return("GO TO WORK NOW") }</span></pre><p id="503e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">返回函数</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="bf1f" class="kp kq hi kl b fi kr ks l kt ku">print(MorningRoutine(first:"Wake Up "){(doThis: String) -&gt; String <strong class="kl hj">in<br/>    return</strong> doThis<br/>})<br/>//OUTPUT<br/>//"My Morning Routine"<br/>//"Wake Up"<br/>//"Brush my Teeth"<br/>//"I am finished with my morning routine"<br/>//"GO TO WORK NOW"</span></pre><p id="2128" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">本节到此为止！闭包一开始可能很难理解，但是一旦你练习了，你就会掌握它的窍门了！如果你有任何问题，请发邮件到yu24c@mtholyoke.edu找我</p></div></div>    
</body>
</html>
<html>
<head>
<title>TypeScript Built-in Types. Part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript内置类型。第三部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/typescript-builtin-types-part-iii-e2b75107c482?source=collection_archive---------11-----------------------#2021-03-29">https://medium.com/geekculture/typescript-builtin-types-part-iii-e2b75107c482?source=collection_archive---------11-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="12ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你好。TypeScript内置类型三部曲的最后一集到了。但是首先让我解释一下这些文章是关于什么的，以及我为什么要写它们，迟做总比不做好。本系列的主要目的不仅仅是告诉您TypeScript特性以及如何使用它们。是关于了解黑暗面的力量！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/720b25ac5e9119df5bc6af3dd713fc0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAf_f-pc_XGUXRnuytnfrg.jpeg"/></div></div></figure><p id="d09f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开个玩笑，这是关于他们如何在引擎盖下工作的。这些知识为您提供了TypeScript语言的全貌，它是帮助您解决任何棘手任务的基础。当然，也要在面试中给你的潜在雇主留下深刻印象。如果你没有读过以前的文章，请先阅读，这是在进一步深入之前所必需的:</p><ul class=""><li id="7eeb" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536"> TypeScript内置类型。第一部分</a></li><li id="7ee1" class="jp jq hi ih b ii jz im ka iq kb iu kc iy kd jc ju jv jw jx bi translated"><a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"> TypeScript内置类型。第二部分</a></li></ul></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="813c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，歌词说够了。今天第一种是<code class="du kl km kn ko b">NonNullable&lt;T&gt;</code>。这个泛型类型从类型联合中移除了<code class="du kl km kn ko b">null</code>和<code class="du kl km kn ko b">undefined</code>类型，这是用条件类型实现的简单功能:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="fe4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我说过，这种类型很简单。不能说很常用，但是可以很有帮助。例如，如果我们需要禁止对象中的可空属性，我们可以这样写:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="0d17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，我们需要复习一下关于<code class="du kl km kn ko b">infer</code>关键字的知识。假设我们想从数组类型中提取条目类型</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="9c05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先我们需要检查的是<code class="du kl km kn ko b">T</code>数组，它可以用条件类型来执行:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="2349" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果<code class="du kl km kn ko b">T</code>不是数组，<code class="du kl km kn ko b">ArrayItem&lt;T&gt;</code>返回never。那么我们需要引入一种新的类型<code class="du kl km kn ko b">Item</code>:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="7fa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是我们在哪里可以定义<code class="du kl km kn ko b">Item</code>类型呢？如果我们把它定义为泛型类型参数<code class="du kl km kn ko b">ArrayItem&lt;T, Item&gt;</code>，那就没有任何意义了，因为我们不想把它传递给泛型，我们希望它作为结果接收。对于这种情况，TypeScript为我们提供了<code class="du kl km kn ko b">infer</code>关键字:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="628c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在检查<code class="du kl km kn ko b">T</code>是否扩展了<code class="du kl km kn ko b">Item</code>的<code class="du kl km kn ko b">Array</code>并返回<code class="du kl km kn ko b">Item</code>，TypeScript是否足够智能来确定<code class="du kl km kn ko b">Item</code>的类型。重要说明:<code class="du kl km kn ko b">infer</code>只能在条件类型表达式中使用</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="7c18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还记得JavaScript中的<code class="du kl km kn ko b">call</code>和<code class="du kl km kn ko b">apply</code>方法吗？它们之间有什么区别？</p><p id="915c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这两个函数方法允许我们在任何上下文中运行任何函数。对于<code class="du kl km kn ko b">apply</code>方法，参数应该作为数组传递，对于<code class="du kl km kn ko b">call</code>方法，参数应该一个接一个地传递。让我们看看它们在TypeScript中是如何工作的:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="41e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们定义了一些函数类型，并尝试在上面运行<code class="du kl km kn ko b">apply</code>和<code class="du kl km kn ko b">call</code>。正如您所看到的，TypeScript检查传递给我们函数的参数，并在传递不正确类型的参数时返回一个错误。</p><p id="df61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，TypeScript可以确定函数参数的类型，你想得到函数类型的参数类型，你可以用<code class="du kl km kn ko b">Parameters</code>来做:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="2487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先<code class="du kl km kn ko b">Parameters</code>检查<code class="du kl km kn ko b">T</code>是否是表达式<code class="du kl km kn ko b">T extends (...args: any) =&gt; any</code>的函数。之后是带有<code class="du kl km kn ko b">infer</code>的条件类型。请注意<code class="du kl km kn ko b">...args</code>被定义为rest参数，这意味着<code class="du kl km kn ko b">args</code>是一个数组。这就是为什么<code class="du kl km kn ko b">Parameters&lt;T&gt;</code>只返回数组类型，即使函数只接收一个参数。如果数组元素有不同的类型也没关系，就像这个例子<code class="du kl km kn ko b">[number, string]</code>。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="727d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果TypeScript能够检测函数的参数类型，也许它也能确定函数的结果类型？当然可以！</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="6c8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kl km kn ko b">ReturnType&lt;T&gt;</code>与<code class="du kl km kn ko b">Parameters&lt;T&gt;</code>非常相似，它也使用<code class="du kl km kn ko b">infer</code>但用于函数结果。您可能会注意到，如果<code class="du kl km kn ko b">T</code>没有扩展<code class="du kl km kn ko b">(...args: any) =&gt; R</code>，这个泛型将返回<code class="du kl km kn ko b">any</code>。老实说，我不确定它为什么这样做，可能是为了支持没有定义的JavaScript函数。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="f8cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的方法也适用于类构造函数。实际上，类构造是函数，为什么不呢。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="0df5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kl km kn ko b">ConstructorParameters&lt;T&gt;</code>与<code class="du kl km kn ko b">Parameters&lt;T&gt;</code>非常相似，唯一不同的是<code class="du kl km kn ko b">new</code>关键字，<code class="du kl km kn ko b">new (...args: any) =&gt; any</code>是类构造函数的定义。<code class="du kl km kn ko b">ConstructorParameters&lt;T&gt;</code>的结果总是像<code class="du kl km kn ko b">Parameters&lt;T&gt;</code>的结果一样是数组。不要忘记在类前添加<code class="du kl km kn ko b">typeof</code>关键字，否则TypeScript会尝试将泛型应用于类，而不是其构造函数。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="1f0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">猜猜下一个类型是什么？显然，它检测类构造函数的返回类型。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="8be9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kl km kn ko b">InstanceType&lt;T&gt;</code>很像<code class="du kl km kn ko b">ReturnType&lt;T&gt;</code>和<code class="du kl km kn ko b">ConstructorParameters&lt;T&gt;</code>。它执行与<code class="du kl km kn ko b">typeof</code>相反的转换。用关键字<code class="du kl km kn ko b">typeof</code>你可以将一个类表示为一个函数，用<code class="du kl km kn ko b">InstanceType&lt;T&gt;</code>你可以将一个函数表示为它的类。你可能会问“我能用它做什么？我已经知道了代码中的所有类型”。在上面的例子中<code class="du kl km kn ko b">InstanceType&lt;typeof A&gt;</code>只是<code class="du kl km kn ko b">A</code>，这种过度工程的目的是什么？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kr"><img src="../Images/38191a3ec192829e26460ac732e81a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8fq5uMLqL4jOqaWJIN2fA.png"/></div></div></figure><p id="d714" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kl km kn ko b">InstanceType&lt;T&gt;</code>对于操作类的函数很有用，例如依赖注入容器。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="3a9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这段代码中,<code class="du kl km kn ko b">resolve</code>方法接收class作为参数，并创建/返回该类的现有实例。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="81d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是包含函数和类实用程序类型的提醒表:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="6d54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很可能你在工作中不会用到这些类型。我对写这个话题持怀疑态度，因为它更多的是关于理论而不是实践。但是如果没有它，本系列文章将是片面的，正如我在本文开始时所说的，理解类型转换的TypeScript原则会给您提供关于这种语言的基础知识。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="c456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样，TypeScript内置类型系列的第三篇也是最后一篇文章。我希望这些文章能在您的TypeScript水域之旅中为您提供指导。欢迎在评论中提出任何问题！</p><p id="90b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下次见，servus！</p><ul class=""><li id="d4ad" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536"> TypeScript内置类型部分I. ( </a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Partial</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Required</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Readonly</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Pick</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536"> ) </a></li><li id="0413" class="jp jq hi ih b ii jz im ka iq kb iu kc iy kd jc ju jv jw jx bi translated">TypeScript内置类型第二部分。( <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Record</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Exclude</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Extract</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">，</a> <code class="du kl km kn ko b"><a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Omit</a></code> <a class="ae jy" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"> ) </a></li><li id="5c72" class="jp jq hi ih b ii jz im ka iq kb iu kc iy kd jc ju jv jw jx bi translated"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener"> TypeScript内置类型第三部分。(</a> <code class="du kl km kn ko b"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">NonNullable</a></code> <a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du kl km kn ko b"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">Parameters</a></code> <a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du kl km kn ko b"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">ReturnType</a></code> <a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du kl km kn ko b"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">ConstructorParameters</a></code> <a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du kl km kn ko b"><a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">InstanceType</a></code> <a class="ae jy" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener"> ) </a></li></ul></div></div>    
</body>
</html>
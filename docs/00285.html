<html>
<head>
<title>Simple Ways to Deal With Class Imbalance in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中处理类不平衡的简单方法</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-deal-with-class-imbalances-in-python-960908fe0425?source=collection_archive---------0-----------------------#2021-01-04">https://medium.com/geekculture/how-to-deal-with-class-imbalances-in-python-960908fe0425?source=collection_archive---------0-----------------------#2021-01-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/26301bc92c9dd395e7c0243d8340d047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1Nuq3-hZxjnHEd-B"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@officestock?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sebastian Herrmann</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f6fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">处理真实世界的数据可能会非常令人沮丧。它通常缺少数据点，一些值可能输入错误，一些数据类型可能表示不足。这些都会导致处理非常混乱的数据。在对真实世界的数据做分类问题时出现的一个这样的因素是“类别不平衡”。这篇文章将特别提出在我们的数据集中解决这个问题的方法。</p><p id="b498" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么什么是阶层失衡呢？类别不平衡是指一个类别与数据集中的其他类别数量不同。在运行分类模型时，这通常会成为一个大问题。例如，让我们想象有人在一个农场对动物进行了一次随机调查。在这次调查中，测量员数出了20头猪，21只山羊和3头牛。在这种情况下，奶牛是不平衡的一类。类别不平衡在数据集中经常发生，这可能是由于数据收集不良，没有足够的样本，甚至只是因为类别不丰富。当使用不平衡的数据训练分类模型时，它可以显著地扭曲模型，导致显著有偏差的模型。拥有合适的训练数据是开发稳健模型的关键。</p><p id="1045" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以做很多事情来解决数据集中类不平衡的问题。在这篇文章中，我们将涵盖3种不同的方法。</p><p id="5d40" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于本文中的示例，我们将使用我最近参与的一个项目的数据，该项目旨在查看水井是否正常工作。为简单起见，将使用的三个类别是0、1和2。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/32de4d09ca5009bc03baa667f4645e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z78l5dOWOSvhpqeCAu2g3g.png"/></div></div></figure><h1 id="4fab" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak"> 1。收集更多数据</strong></h1><p id="1c45" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">这似乎是常识，但是你可以尝试收集更多的数据。尽管这是解决问题最直接的方法，但它往往是最困难的。收集更多数据可能成本高昂，可能有时间限制，或者可能有其他因素限制数据收集。幸运的是，还有其他技术可以处理你所拥有的数据。</p><h1 id="6cd4" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">2.欠采样/过采样</h1><p id="df76" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">处理类别不平衡的另一个选择是对数据集中的数据进行欠采样/过采样。当有大量数据时，这通常是首选。</p><h2 id="ab44" class="lb jz hi bd ka lc ld le ke lf lg lh ki jg li lj km jk lk ll kq jo lm ln ku lo bi translated">欠采样</h2><p id="e6fd" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">欠采样是一种从多数类中移除样本的方法。这可以在替换或不替换的情况下随机完成。欠采样方法是开始解决类不平衡问题的一种非常快速和简单的方法。然而，这并不都是积极的，因为您最终会丢弃数据，所以数据集上有用的见解/信息可能会被丢弃。</p><p id="a55f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个使用imblearn实现欠采样的例子。如您所见，只有3行代码，类别0和类别2被欠采样以匹配类别1。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/cba1b5159bb7649b75a3bd68f4f0081a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fkhvrvDwzekgGDLGpNxiTw.png"/></div></div></figure><h2 id="acfe" class="lb jz hi bd ka lc ld le ke lf lg lh ki jg li lj km jk lk ll kq jo lm ln ku lo bi translated">过采样</h2><p id="1b04" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">过采样是解决类不平衡的另一种快速简单的方法。过采样是一种添加少数类副本的方法。这可以在更换或不更换的情况下随机进行。就像欠采样一样，这种方法也有一些潜在的缺点。因为数据只是被复制，所以被训练的模型有可能变得过拟合。</p><p id="969f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">过采样也可以通过使用imblearn来完成，实现起来和欠采样一样简单。这里有一个例子，我们复制类别2和1的条目，直到它们与类别0的条目数量相同。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/64b903e1d93c378067aa9d7490ecabf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZXHizH2T0i7hBwgzeVLvA.png"/></div></div></figure><h1 id="f881" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">3.通过SMOTE创建合成数据</h1><p id="1f9a" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">我们将在本文中讨论的最后一个选项是创建合成数据。这种技术类似于过采样。然而，这并不是复制精确的数据，而是基于现有的少数类创建新的数据。对我们来说幸运的是，已经有算法可以自动为我们做这些。一种这样的算法叫做SMOTE，代表<a class="ae iu" href="https://imbalanced-learn.org/stable/generated/imblearn.over_sampling.SMOTE.html" rel="noopener ugc nofollow" target="_blank">合成少数过采样技术</a>。SMOTE算法接受最接近的少数类数据条目，并基于这些条目创建新的组合。请记住，SMOTE不能很好地处理文本数据，因此如果有任何分类数据，应该将其更改为二进制或数字数据。下面是一个如何实现SMOTE的示例:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/8154eeb4d9a13734cfdafe1daa108d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UG1bpSZRFVk0uewxhgcNfQ.png"/></div></div></figure><p id="4d14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您在上面看到的，SMOTE还能够进行过采样，并将1类和2类数据提高到与类别0相同的数量。</p><h1 id="f1ce" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="7ea1" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">处理分类问题时，遇到不平衡数据集的可能性非常高。我希望上面谈到的三种方法(收集更多数据、欠采样/过采样和SMOTE)有助于深入了解如何解决阶层失衡问题。这些方法不是唯一可用的方法，但它们是最容易实现的一些方法。我强烈建议在研究其他方法之前尝试这些技术。</p></div></div>    
</body>
</html>
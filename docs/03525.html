<html>
<head>
<title>SALESFORCE API: Integration guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SALESFORCE API:集成指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/salesforce-api-integration-guide-d48133e414ee?source=collection_archive---------35-----------------------#2021-06-09">https://medium.com/geekculture/salesforce-api-integration-guide-d48133e414ee?source=collection_archive---------35-----------------------#2021-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4ef1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">了解如何以低代码连接和扩展您的Salesforce实例。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/728452e00d6390b7754cc037ecfc13bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*4oscfM-rV2ZK2JxxxHkWxA.png"/></div></figure><p id="f397" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Salesforce提供了一个<a class="ae jm" href="https://help.salesforce.com/articleView?id=sf.remoteaccess_oauth_web_server_flow.htm&amp;type=5" rel="noopener ugc nofollow" target="_blank"> REST API </a>，允许您集成第三方应用程序。本文展示了如何将Salesforce API与<a class="ae jm" href="https://linx.software" rel="noopener ugc nofollow" target="_blank"> Linx </a>集成，Linx是一个构建和托管API、自动化和集成的低代码开发平台。</p><p id="9e7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Linx为您提供了自动化任务和数据处理功能的能力，以与您的Salesforce实例集成，从而允许操作您的数据。您可以轻松扩展Salesforce的功能，并将Salesforce与其他第三方应用程序集成，如Xero、QuickBooks和其他系统API。这允许您将系统连接在一起，创建一个完全自动化的循环。</p><p id="db35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本指南将涵盖以下内容:</p><ul class=""><li id="8c1f" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><strong class="ih hj">sales force connected应用程序和OAuth 2.0身份验证的设置</strong></li><li id="aacb" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">验证并连接到Salesforce API </strong></li><li id="eb14" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">示例请求</strong></li><li id="4f5f" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">自定义功能示例</strong></li></ul><p id="28d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提示:</strong></p><p id="2deb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，建议您看一下下面的文章，以熟悉如何使用Linx中的API:</p><ul class=""><li id="b007" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><a class="ae jm" href="https://community.linx.software/community/t/consuming-rest-apis/482" rel="noopener ugc nofollow" target="_blank">使用REST API 1</a></li><li id="e7bf" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><a class="ae jm" href="https://community.linx.software/community/t/generic-oauth-2-0-authenticator/487" rel="noopener ugc nofollow" target="_blank">通用OAuth 2.0认证器</a></li></ul></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="cf59" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">资源</h1><p id="fd5f" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">我们构建了一个示例解决方案，以便更容易地使用Linx和Salesforce进行开发:</p><p id="04a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sales force template . lsoz(186.0 KB)</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="d7ee" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">1.注册您的Linx-Salesforce应用程序</h1><p id="1f15" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">为了与Salesforce API交互，您必须首先注册一个连接的应用程序。这将为您提供必要的授权细节，然后您可以使用这些细节来生成您的访问和刷新令牌。</p><ol class=""><li id="f347" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc ll jt ju jv bi translated">登录到<a class="ae jm" href="https://login.salesforce.com/" rel="noopener ugc nofollow" target="_blank"> Salesforce </a>前端。</li><li id="f533" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc ll jt ju jv bi translated">导航至应用管理器控制台(左侧菜单栏&gt;应用&gt;应用管理器)。</li><li id="ba7a" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc ll jt ju jv bi translated">点击屏幕左上角的<strong class="ih hj">新连接的应用</strong>。</li><li id="46f4" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc ll jt ju jv bi translated">完成<strong class="ih hj">基本信息</strong>如下:</li></ol><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lm"><img src="../Images/c283e19b00d17a9349cdbb1e75812c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/0*0IPRxIP-94B0vMFM.png"/></div></figure><p id="ba3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.选择<strong class="ih hj">启用OAuth设置</strong><strong class="ih hj"/>并完成如下部分:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/32dd420a66f24faf9b6e744169266238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*uVcdwEHFWxnX33k-.png"/></div></figure><p id="bd19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.对于<strong class="ih hj">回调URL </strong> /重定向URL，添加以下内容:</p><ul class=""><li id="d8d8" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><code class="du lo lp lq lr b"><a class="ae jm" href="http://localhost:8080/salesforce/oauth/token" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/salesforce/oauth/token</a></code></li></ul><p id="0f1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.通过单击按钮添加您选择的访问“范围”,出于本指南的目的，我们将授予:</p><ul class=""><li id="1d56" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><code class="du lo lp lq lr b">Full access (full)</code></li><li id="4cf5" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><code class="du lo lp lq lr b">Perform requests on your behalf at any time (refresh_token, offline_access)</code></li></ul><p id="9659" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>如果选择不同的范围，一定要适当更新<code class="du lo lp lq lr b">$.Settings.salesforce_app_scopes </code>值。关于访问范围的更多信息可以在<a class="ae jm" href="https://help.salesforce.com/articleView?id=remoteaccess_oauth_tokens_scopes.htm&amp;type=5" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这里</strong>找到。</a></p><p id="ae3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.点击<strong class="ih hj">保存</strong>。现在，您应该能够看到新创建的应用程序客户端标识符，如下所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/f4a346fff1b9e26fcb569a93c9df91e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*OkhDiOwJ-9oivuCD.png"/></div></figure><p id="77a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">9.点击<strong class="ih hj">点击显示消费者密码旁边的</strong>，生成并显示应用密码。复制并保存<strong class="ih hj">消费者密钥</strong>(客户端ID)以及<strong class="ih hj">消费者秘密</strong>(客户端秘密)，并将其保存在某处以备下一步使用。</p><h1 id="515e" class="ki kj hi bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf bi translated">2.配置Linx应用程序设置</h1><p id="7ce2" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">在Linx设计器中打开提供的示例解决方案，并更新<strong class="ih hj">。带有客户端标识符的Linx应用程序的设置</strong>如下:</p><ul class=""><li id="8eb6" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><strong class="ih hj">linx _ database _ conn _ string</strong>:用于存储和从数据库中检索认证令牌的连接字符串。点击阅读更多关于创建连接字符串<a class="ae jm" href="https://linx.software/docs/reference/plugins/database/common/connectioneditor/" rel="noopener ugc nofollow" target="_blank">的信息。</a></li><li id="b50e" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">sales force _ app _ Consumer _ Key</strong>:您连接的应用的<strong class="ih hj">消费者密钥</strong></li><li id="75b5" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">sales force _ app _ Consumer _ Secret</strong>:您连接的应用的<strong class="ih hj">消费者机密</strong></li><li id="2997" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">sales force _ API _ version</strong>:API的当前版本，在编写时是<code class="du lo lp lq lr b">v50.0</code>，可能会更改。最新的版本信息可以在这里找到<a class="ae jm" href="https://developer.salesforce.com/docs/atlas.en-us.chatterapi.meta/chatterapi/intro_working_with_chatter_connect.htm" rel="noopener ugc nofollow" target="_blank">1</a>。</li></ul><p id="cec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的Linx解决方案的<strong class="ih hj"> $。设置</strong> s应该如下图所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es lx"><img src="../Images/b709a944b2aeb5eab20d1948ba6ca01e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*N4_svvxZJzTrZiGE.png"/></div></div></figure><h1 id="7e8c" class="ki kj hi bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf bi translated">3.授权应用程序</h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mc"><img src="../Images/4f54bab34c3dd92647ab795ddac567e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:20/format:webp/0*T9b3Nzl3U8yLwg5r.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es md"><img src="../Images/0e7212aa2584ada864f1f48bedf03493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QxZIZIy0WC0fAnLn.gif"/></div></div></figure><ol class=""><li id="c681" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc ll jt ju jv bi translated">在Linx Designer中，<strong class="ih hj">debug</strong>the<a class="ae jm" href="https://linx.software/docs/reference/plugins/rest/content/resthost" rel="noopener ugc nofollow" target="_blank">RESTHostSVC</a>，一旦启动导航到以下URL或点击<a class="ae jm" href="http://localhost:8080/salesforce/oauth/authorize" rel="noopener ugc nofollow" target="_blank">此处</a>:</li></ol><ul class=""><li id="e885" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><code class="du lo lp lq lr b"><a class="ae jm" href="http://localhost:8080/salesforce/oauth/authorize" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/salesforce/oauth/authorize</a></code></li></ul><p id="28ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.登录Salesforce并授予对您注册的应用程序的访问权限。一旦您被授权访问，Salesforce授权服务器将使用<code class="du lo lp lq lr b">code</code>和<code class="du lo lp lq lr b">state</code>参数将用户代理重定向到回调URL。这将触发访问令牌生成，如果成功，生成的消息将显示在您的浏览器中，如下所示:</p><pre class="jf jg jh ji fd me lr mf mg aw mh bi"><span id="f2bc" class="mi kj hi lr b fi mj mk l ml mm">{<br/>  "date":"2021-01-05T13:33:29.36004+02:00",<br/>  "summary":"Linx application successfully authorized.",<br/>  "platform":"SALESFORCE",<br/>  "authorized_entity":"https://yu8.salesforce.com"<br/>}</span></pre><p id="1343" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这表明Linx成功地生成并存储了存储在数据库中的访问令牌。每次发出请求时，都会从数据库中检索该令牌信息。</p><h1 id="3e64" class="ki kj hi bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf bi translated">4.向Salesforce API发出请求</h1><p id="bb97" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">现在，Linx应用程序已被授予访问权限并生成了访问令牌，您现在能够对Salesforce实例中的对象发出CRUD请求。</p><p id="d303" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在Linx中发出HTTP请求，您必须使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/rest/content/callrestendpoint" rel="noopener ugc nofollow" target="_blank"> CallRESTEndpointFNC </a>。</p><p id="9333" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要针对Salesforce API端点发出请求，您必须使用您的Salesforce实例作为端点URL的前缀，如下所示，更多信息可在<a class="ae jm" href="https://developer.salesforce.com/docs/atlas.en-us.chatterapi.meta/chatterapi/intro_building_url.htm" rel="noopener ugc nofollow" target="_blank">此处</a>找到</p><pre class="jf jg jh ji fd me lr mf mg aw mh bi"><span id="dc87" class="mi kj hi lr b fi mj mk l ml mm">{instance url}/services/data/v{version number}/sobjects/Account</span></pre><p id="6863" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了验证请求，您必须在<code class="du lo lp lq lr b">Authorization</code>报头中包含<code class="du lo lp lq lr b">access token</code>，如下所示:</p><pre class="jf jg jh ji fd me lr mf mg aw mh bi"><span id="7722" class="mi kj hi lr b fi mj mk l ml mm">Authorization : "OAuth " + {access token}</span></pre></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="d735" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">样本模板</h1><p id="fe46" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated"><a class="ae jm" href="https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/resources_sobject_describe.htm" rel="noopener ugc nofollow" target="_blank"> Salesforce API参考文档</a>没有详细描述每个对象、端点或方法。</p><p id="60a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在Salesforce上使用<a class="ae jm" href="https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/resources_sobject_describe.htm" rel="noopener ugc nofollow" target="_blank"> sObjects </a>，您首先需要对返回对象结构的API发出请求。由此，您将能够创建适当的数据结构。</p><p id="0104" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以通过发出如下请求来返回对象的元数据:</p><pre class="jf jg jh ji fd me lr mf mg aw mh bi"><span id="a7e8" class="mi kj hi lr b fi mj mk l ml mm">{instance url}/v50.0/sobjects/{sObjectName}/describe/</span></pre><p id="cd8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将为您提供关于该对象的可能性的详细元数据。</p><h1 id="c19d" class="ki kj hi bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf bi translated">模板请求</h1><p id="b746" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">下面构建的自定义函数演示了创建发出单个请求的独立函数的最佳实践。每个函数都以结构化数据的形式返回请求-响应。</p><p id="d160" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出于演示的目的，我们将详细介绍“帐户”对象。</p><p id="2187" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在解决方案浏览器中可以找到以下自定义函数:<strong class="ih hj">【销售力量】&gt;【客户】&gt;【请求】</strong></p><p id="4db6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">遵循的最佳实践是为每种类型的调用创建一个包装函数，如下所示:</p><ul class=""><li id="f4c6" class="jn jo hi ih b ii ij im in iq jp iu jq iy jr jc js jt ju jv bi translated"><strong class="ih hj"> GetAccounts </strong>:从Salesforce检索所有现有帐户id，并返回对象列表作为结果。</li><li id="b1db" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj"> GetAccount </strong>:根据<code class="du lo lp lq lr b">Id</code>输入参数，检索特定账户的详细信息。这可用于检查修改历史，也可用于更新对象。</li><li id="1bc7" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj"> CreateAccount </strong>:根据作为输入参数传入的账户详细信息创建一个新账户。</li><li id="f2bd" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj"> UpdateAccount </strong>:根据输入参数传入的账户明细修改已有账户。</li><li id="1230" class="jn jo hi ih b ii jw im jx iq jy iu jz iy ka jc js jt ju jv bi translated"><strong class="ih hj">删除账户</strong>:删除现有账户。基于<code class="du lo lp lq lr b">Id</code>输入参数。</li></ul><p id="a64b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，您将能够互换使用这些功能来创建自定义逻辑，以在Salesforce上自动处理数据。</p><p id="53b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">典型结构:</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mn"><img src="../Images/625197b864b9a67b9354591f39d6bc6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Sh1eVVtDzSIfCU1O.png"/></div></div></figure><h1 id="f0ac" class="ki kj hi bd kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb lw ld le lf bi translated">模板功能</h1><p id="8110" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">下面的自定义函数是为了演示真实世界的功能而构建的。</p><p id="2dc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在解决方案资源管理器中可以找到以下自定义函数:<strong class="ih hj">【sales force】&gt;【Accounts】&gt;【custom functions】</strong></p><h2 id="8f88" class="mi kj hi bd kk mo mp mq ko mr ms mt ks iq mu mv kw iu mw mx la iy my mz le na bi translated">AddUpdateAccountsFromCSV</h2><p id="8d0f" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">这个自定义函数处理从本地CSV文件中检索的帐户实体的创建或修改。(<a class="ae jm" href="https://community.linx.software/community/uploads/short-url/f1HpQMNi8NivTryA8URXbWihkai.csv" rel="noopener ugc nofollow" target="_blank">mock _ customers . CSV</a>(11.8 KB)包含100个与“模拟”客户相关的记录，您可以在测试中使用它们。)</p><p id="5cf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.放置提供的。目录中的csv:</p><pre class="jf jg jh ji fd me lr mf mg aw mh bi"><span id="914d" class="mi kj hi lr b fi mj mk l ml mm">C:\Linx\Salesforce\Accounts\Upload\</span></pre><p id="d865" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.在Linx设计器中，<strong class="ih hj">调试</strong>中的<strong class="ih hj">AddUpdateAccountsFromCSV</strong>函数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ln"><img src="../Images/ea116722ee9b515968ae1b93a1c9f6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*bnt2AXEs7M_56DAE.png"/></div></figure><p id="e779" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个<a class="ae jm" href="https://linx.software/docs/reference/plugins/file/content/filelist" rel="noopener ugc nofollow" target="_blank"> FileListFNC </a>对本地目录进行扫描，过滤掉格式为<code class="du lo lp lq lr b">*customers*.csv</code>的文件。对于每个匹配过滤器的文件，返回完整的<code class="du lo lp lq lr b">FileName</code>属性。</p><p id="a9f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于获得的每个文件，<a class="ae jm" href="https://linx.software/docs/reference/plugins/file/content/textfileread" rel="noopener ugc nofollow" target="_blank"> TextFileReadFNC </a>然后解析文件并以结构化的格式逐一返回每一行。</p><p id="3d88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于返回的每一行,“Account”类型的实例被设置为从文件返回的详细信息。</p><p id="1b9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后在Salesforce上搜索与文件中的名称匹配的帐户。自定义函数<strong class="ih hj"> SearchObject </strong>接受当前行<code class="du lo lp lq lr b">name</code>细节的输入参数。</p><p id="012d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将返回任何匹配记录的<code class="du lo lp lq lr b">Id</code>。</p><p id="0b54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后使用一个<a class="ae jm" href="https://linx.software/docs/reference/plugins/linx/content/ifelse" rel="noopener ugc nofollow" target="_blank"> IfElseFNC </a>来检查是否返回了任何匹配的<code class="du lo lp lq lr b">Id</code>值。如果匹配的<code class="du lo lp lq lr b">Id</code>确实存在，则使用自定义函数<strong class="ih hj"> GetAccount </strong>检索与<code class="du lo lp lq lr b">Id</code>匹配的账户的具体细节。</p><p id="37cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/linx/content/ifelse" rel="noopener ugc nofollow" target="_blank"> IfElseFNC </a>将文件中的<code class="du lo lp lq lr b">last modified</code>字段与从Salesforce返回的<code class="du lo lp lq lr b">last modified</code>字段进行比较，从而完成检查。如果文件中的数据比Salesforce上的记录更新，则使用自定义函数<strong class="ih hj"> UpdateAccount </strong>更新帐户详细信息，传入之前设置的“帐户”类型。</p><p id="0c0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果Salesforce上不存在该帐户，则使用自定义函数<strong class="ih hj"> CreateAccount </strong>创建该帐户，并传入之前设置的“帐户”类型。然后返回新创建的<code class="du lo lp lq lr b">Id</code>。这个<code class="du lo lp lq lr b">Id</code>被添加到包含最近添加的账户的列表中。</p><p id="d0f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦特定文件完成读取，使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/file/content/filemove" rel="noopener ugc nofollow" target="_blank"> FileMoveFNC </a>将其移动到“备份”位置。</p><p id="6042" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后将<code class="du lo lp lq lr b">Accounts</code>列表循环并附加到一个本地CSV文件中，以便记录保存。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es nb"><img src="../Images/01f7a629e91494407ead44071e6f46b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AzZE-JF_8-rlCY6L.png"/></div></div></figure><h2 id="e36e" class="mi kj hi bd kk mo mp mq ko mr ms mt ks iq mu mv kw iu mw mx la iy my mz le na bi translated">WriteAccountsToCSV</h2><p id="a702" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">此功能将Salesforce中所有帐户的详细信息插入本地CSV文件。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es nc"><img src="../Images/ce9a17f6b0e4911709f7a45976dd5cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uKKHLd5_9ol3S10A.png"/></div></div></figure><p id="de9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，使用一个<a class="ae jm" href="https://linx.software/docs/reference/plugins/file/content/textfilewrite" rel="noopener ugc nofollow" target="_blank"> TextFileWriteFNC </a>来重置带有列标题的本地文件。</p><p id="8b1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后使用定制函数<strong class="ih hj"> GetAccounts </strong>检索所有现有的账户id。使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/linx/content/foreach" rel="noopener ugc nofollow" target="_blank"> ForEachFNC </a>对返回的帐户id列表执行循环。</p><p id="f7ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每个帐户，执行自定义函数<strong class="ih hj"> GetAccount </strong>，将当前循环的<code class="du lo lp lq lr b">Id</code>字段值作为输入参数传递。结果是返回特定帐户的详细信息。</p><p id="c201" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/file/content/textfilewrite" rel="noopener ugc nofollow" target="_blank"> TextFileWriteFNC </a>将返回账户的详细信息逐行写入CSV文件。</p><p id="92ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结果文件:</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es nd"><img src="../Images/dbc5529f23e610efab59ebf351a18c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/0*5OxNwB-098RAI1Mb.png"/></div></figure><h2 id="fa07" class="mi kj hi bd kk mo mp mq ko mr ms mt ks iq mu mv kw iu mw mx la iy my mz le na bi translated">删除所有帐户</h2><p id="9fc9" class="pw-post-body-paragraph if ig hi ih b ii lg ik il im lh io ip iq li is it iu lj iw ix iy lk ja jb jc hb bi translated">此自定义功能从Salesforce中删除所有现有帐户。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es ne"><img src="../Images/38eca44f54bab92badc953e5006063d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Wbh6jkqrbt4exCDA.png"/></div></div></figure><p id="68a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，使用定制函数<strong class="ih hj"> GetAccounts </strong>检索所有现有的帐户id。使用<a class="ae jm" href="https://linx.software/docs/reference/plugins/linx/content/foreach" rel="noopener ugc nofollow" target="_blank"> ForEachFNC </a>对返回的帐户id列表执行循环。</p><p id="bf6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于每个帐户，执行自定义函数<strong class="ih hj"> DeleteAccount </strong>，将当前循环的<code class="du lo lp lq lr b">Id</code>字段值作为输入参数传递。然后，该特定帐户将从您的Salesforce实例中删除。</p><p id="a6ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong>这将删除当前Salesforce上的所有帐户，请谨慎操作。</p></div></div>    
</body>
</html>
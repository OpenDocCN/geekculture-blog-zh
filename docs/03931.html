<html>
<head>
<title>Diving deep into Apache JMeter!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入阿帕奇JMeter！</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/diving-deep-into-apache-jmeter-2fd61d6970d2?source=collection_archive---------41-----------------------#2021-06-17">https://medium.com/geekculture/diving-deep-into-apache-jmeter-2fd61d6970d2?source=collection_archive---------41-----------------------#2021-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/de11ae0c7e62bb3c40e1a8d95c0cef6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gcYLBEJlDREbU3Tt"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@thkelley?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Thomas Kelley</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c5f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在开始之前，这篇博客的先决条件是了解Apache JMeter的基础知识和运行负载测试所需的基本组件。如果你是JMeter的新手，想了解一些基础知识以及如何在JMeter中运行你的第一个测试，请参考我的<a class="ae iu" href="https://anubhavkaro.medium.com/performance-testing-of-apis-using-apache-jmeter-e1c9fb0077cc" rel="noopener">博客</a>，它为这个博客设置了背景。</p><p id="2663" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们开始吧！🚀</p><h1 id="3f95" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">定时器</h1><p id="a1b9" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">嗯，如果你在JMeter中编写一个普通的测试，它看起来就像一个机器人在给定的时间段和条件下以一种均匀的方式发送多个请求。信不信由你，事情就是这样。如果我们想要复制现实生活中的场景，并在测试场景中引入一些随机性，该怎么办？这就是计时器的用武之地。<br/>计时器有助于在测试中引入随机性。它们帮助我们以任意的方式配置请求的拥塞，这样它就复制了现实生活中的场景。</p><blockquote class="kw kx ky"><p id="e0f7" class="iv iw kz ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">负载测试！测试自动化</p></blockquote><p id="df83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在测试自动化中，我们希望测试尽可能快地完成，而在负载测试中，我们让API承受一个负载，这个负载模拟了现实生活中人与API的交互。Jmeter中有各种类型的定时器，您可以通过右键点击测试计划，然后点击timers来查看它们。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/f7cb6f9f507aa798c99421e5112804be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sK2EnZPwa1ZKgo6zEszQqw.png"/></div></div></figure><p id="7b5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于我们这里的例子，我们将继续高斯随机定时器。<a class="ae iu" href="http://hyperphysics.phy-astr.gsu.edu/hbase/math/gaufcn.html" rel="noopener ugc nofollow" target="_blank">高斯</a>随机定时器将每个用户请求延迟<strong class="ix hj">随机</strong>时间量。当您尝试配置它时，我们需要配置两个字段，这有助于为测试引入随机性。</p><ol class=""><li id="3f2c" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js ln lo lp lq bi translated">偏差</li><li id="01e3" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">恒定延迟偏移</li></ol><figure class="le lf lg lh fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/26c505dca36cc932fc8ac3c278e84452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*7vA12SUYQbDOYVFsjnbDRQ.png"/></div></figure><p id="1b97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们将偏差设置为0.5秒，恒定延迟偏移设置为1秒。这实际上意味着，它会在循环的每一步之间引入随机性。在每个动作之后，用户(这里是我们的测试)会在执行下一个动作之前随机暂停0.5到1.5秒。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/6dd51bdbe5dee1df96ab804167e9efa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHmcaDociwR1uVGdH_TJ2Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Effect of adding a Gaussian Random Timer</figcaption></figure><h1 id="ed55" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">断言</h1><p id="ae1f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">顾名思义，如果您已经编写过任何单元测试，这一部分可能已经很清楚了。JMeter中的<strong class="ix hj"> <em class="kz">断言</em> </strong>用于验证发送给服务器的请求响应。断言是在运行时用请求的实际结果验证预期结果的过程。</p><p id="5612" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以在各种事物上添加断言:</p><ol class=""><li id="f16b" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js ln lo lp lq bi translated">站点或url中的文本</li><li id="a83c" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">响应代码</li><li id="15fb" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">头球</li><li id="8745" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">请求数据</li><li id="1e3d" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">重新寄送</li></ol><h2 id="1cfc" class="ly ju hi bd jv lz ma mb jz mc md me kd jg mf mg kh jk mh mi kl jo mj mk kp ml bi translated">如何添加断言？</h2><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/47e2cfd88d4ce7d6bb20576e075f3273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pEPNFKHdqTnadvfrx7i-Pw.png"/></div></div></figure><p id="b330" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">右键单击要添加断言的组件，对于我们的示例，我们将把它添加到HTTP请求中。在我们的例子中，我们将添加一个响应断言。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/89df49b81a87b4f5fd6bbee4e834974c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFvCp-AlZVnLhy7G5fDj2A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Response assertion to check if the status code returned is 200</figcaption></figure><p id="ac74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">响应断言允许您添加模式字符串，以便与服务器响应的各个字段进行比较。<br/>例如，你向网站<a class="ae iu" href="http://www.google.com/" rel="noopener ugc nofollow" target="_blank">http://www.google.com</a>发送一个用户请求，然后得到服务器响应。您可以使用响应断言来验证服务器响应<strong class="ix hj">是否包含</strong>预期的模式字符串(例如“OK”或200)。</p><h1 id="3322" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">HTTP管理器</h1><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/74e8c54c6511a247bffa61a362f4ceeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aedWJAirPvnqrOTv"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@richygreat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Richy Great</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e9c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为JMeter不是一个浏览器，HTTP协议有时可能很复杂，所以它利用HTTP管理器来获得一些关于HTTP相关问题的帮助。HTTP管理器允许管理和操作诸如缓存、cookies和头之类的东西。有时，如果不配置HTTP负载测试，很难运行它们。</p><p id="4e27" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">浏览器向服务器发送一个带有一些附加信息的HTTP请求头。需要这些附加信息来满足服务器响应特定请求的要求。每次浏览器向服务器发送请求时，都会附上带有接受语言、接受编码、用户代理、引用等信息的标题。<br/> JMeter提供了一个“HTTP Header Manager”元素来附加请求中的附加信息。</p><p id="759e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要添加一个HTTP管理器，右键单击测试计划并转到config elements:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/76fe86286ca263a3bccbd75d3ad5644c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLADTZE2iekl2q_kdF49VA.png"/></div></div></figure><p id="5717" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里有多种类型可供选择:</p><ol class=""><li id="7745" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js ln lo lp lq bi translated">HTTP缓存管理器:它帮助操作随请求发送的缓存，在测试期间保留或删除缓存。</li><li id="3de1" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">HTTP Cookie管理器:它帮助管理HTTP请求中使用的Cookie。它还有助于身份验证。</li><li id="72e5" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js ln lo lp lq bi translated">HTTP头管理器:它帮助管理出站HTTP请求的头。我们可以把它们储存起来以备后用。</li></ol><p id="25f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加这些有助于我们更好地管理HTTP请求。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/6e3373bcae0e68c9840519266ebcfd42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POt8WgI8HPyY1IBNH7bmHQ.png"/></div></div></figure><p id="8905" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里提到了HTTP头管理器的一些重要输入字段:</p><ul class=""><li id="d655" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">名称</em> </strong> <em class="kz"> : </em>提供元素名称</li><li id="2fd6" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">评论</em> </strong> <em class="kz"> : </em>提供任意评论(如果有)</li><li id="852b" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">存储在标题管理器中的标题:</em> </strong>将随请求一起传递的标题字段列表。</li></ul><p id="d944" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以在下面添加通用标题字段:</p><ul class=""><li id="de85" class="li lj hi ix b iy iz jc jd jg lk jk ll jo lm js mr lo lp lq bi translated"><strong class="ix hj"><em class="kz">Accept-Language:</em></strong>定义浏览器在响应中首选接收的页面语言。如en-GB、en-US；q=0.8，en；q=0.6</li><li id="f32c" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"><em class="kz">Accept-Encoding:</em></strong>Accept-Encoding头告诉服务器在向客户端发送响应之前应该选择哪种编码方式。例如gzip、deflate</li><li id="b09a" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">用户代理:</em> </strong>用户代理允许定义在浏览器中正确显示的客户端类型和接收页面版本。如Mozilla/5.0(Windows NT 6.1；WOW64) AppleWebKit/537.36 (KHTML，像壁虎一样)Chrome/56 . 0 . 2924 . 87 Safari/537.36</li><li id="484d" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz"> Referer: </em> </strong>表示从某个页面切换时，发送了特定的请求。例如，当你发送一个推荐网址给你的朋友注册时(比如优步)，他的注册会让你免费搭车。referrer URL包含您的代码，让您受益匪浅。</li><li id="97f1" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">内容类型:</em> </strong>显示内容的类型。例如application/JSON；字符集=UTF-8</li><li id="0b80" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">接受:</em> </strong>浏览器接受并显示无任何问题的响应类型。例如应用程序/JSON，文本/普通，*/*</li><li id="8783" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz">来源:</em> </strong>父URL</li><li id="d492" class="li lj hi ix b iy lr jc ls jg lt jk lu jo lv js mr lo lp lq bi translated"><strong class="ix hj"> <em class="kz"> &lt;安全检查&gt; : </em> </strong>该选项仅适用于安全通信。标签名可以是cfadmin、csrftoken、Authorization等。</li></ul></div><div class="ab cl ms mt gp mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="hb hc hd he hf"><p id="4359" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这对于那些想要定制和个性化他们的JMeter测试计划到下一个水平的人来说是很棒的。我将在下一篇文章中重点介绍Jmeter CLI。现在，让我们在这里结束它。如果您想提供反馈或有任何疑问，请通过推特联系我。和平👋</p></div></div>    
</body>
</html>
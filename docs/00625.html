<html>
<head>
<title>Authentication and Authorization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">认证和授权</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/authentication-and-authorization-a5a2eafdde16?source=collection_archive---------7-----------------------#2021-03-08">https://medium.com/geekculture/authentication-and-authorization-a5a2eafdde16?source=collection_archive---------7-----------------------#2021-03-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1c6f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">真实世界应用程序开发</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/2cd1bd7d5aeafc06b66b83968525cad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhdNVsZV5cPvrBKsE0OVvw.png"/></div></div></figure><p id="bd9a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">本主题旨在分享在您的应用中实现安全层的正确方法，无论是Web、移动还是后端服务。</p><p id="b89d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在构建应用程序时，常见的错误是由于它的实现而不是它的设计。尤其是在处理安全问题时。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kf"><img src="../Images/3b11857fb7e4e224df42c91764023713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMNPpMNvzcXgMzIKlhsl8w.png"/></div></div></figure><p id="d835" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">安全性</strong>是应用程序中最<strong class="jl hj"> <em class="kg">最重要的</em> </strong>部分之一，它经常被忽视，因为时间不够、疏忽、不是优先事项，或者因为技术设计仍在发展中。因此，它导致了一个意外的复杂性，如技术差距，安全漏洞和互联网上的身份被盗。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/982ad5d8beebb3f26a683f47159c5903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xEr6UB6RorRxT5ZbWUpOfg.png"/></div></div></figure><p id="59ad" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">作为我们团队价值观的一部分，保护我们构建的任何应用程序与其业务功能一样重要。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kh"><img src="../Images/a1f9bab7e4ea744ac70972b89fe95786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBZYHN-hBe6vRaozAuxxsA.png"/></div></div></figure><p id="bba7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">作为不重视应用程序安全性的代价的一个例子，Parler由于对其应用程序安全层过于天真而成为技术行业的中心。</p><p id="a85a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">最近在2021年1月发生了一起涉及帕勒的安全事故。上面写着他们的资源是被一个女程序员刮走的，这个女程序员的twitter处理程序是@donk_enby。她获得了价值80 TB的大量数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ki"><img src="../Images/b14aff8179e21df468107784f729b2f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*FmxD8QRzm21WtpvR5jSzXg.png"/></div></figure><p id="de60" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">她甚至把帕勒的档案情况描述为“一群人跑进一栋着火的大楼，试图尽可能多地拿走东西。”</p><p id="3a6a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">她描述了Parler的应用程序，其系统的主要缺陷是:</p><ul class=""><li id="ba07" class="kj kk hi jl b jm jn jp jq js kl jw km ka kn ke ko kp kq kr bi translated">薄弱的API安全层(身份验证和授权)</li><li id="4e7b" class="kj kk hi jl b jm ks jp kt js ku jw kv ka kw ke ko kp kq kr bi translated">数据库标识(ID)不是唯一生成的(UUID)</li><li id="636a" class="kj kk hi jl b jm ks jp kt js ku jw kv ka kw ke ko kp kq kr bi translated">没有数据库查询限制</li><li id="cadf" class="kj kk hi jl b jm ks jp kt js ku jw kv ka kw ke ko kp kq kr bi translated">原始资产(视频、图像)</li></ul><p id="ea5d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这导致投资回报和应用程序可信度的巨大损失，正如你可以想象的那样:数据的“神圣性”及其安全性应该是社交媒体的重中之重。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kx"><img src="../Images/fbdf07d6cd0d1dec14a15ee3d465f93d.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*8aLeOql1BjRgdEFb7SQpmQ.png"/></div></figure><p id="8c09" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因为我们已经知道了应用程序开发中缺乏安全性的代价和后果。现在的问题是，我们如何以及在哪里开始实现安全性？</p><p id="14ac" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们将讨论认证和授权，因为@donk_enby将这些层描述为她从Parler获取所描述的信息量的入口。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ky"><img src="../Images/40436fc92609f50b11910a92aec41519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9JOiXfqFpY91FEHediidZw.png"/></div></div></figure><p id="108d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">首先，我们需要了解身份验证和授权之间的区别，以及它们如何在您的应用程序中相互配合。</p><p id="c7a9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">从更高的角度来看，他们的目标是验证用户的身份，并限制用户在应用程序中可以访问的资源列表。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kz"><img src="../Images/89076eb646ca1d2c7cf72795728564c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XDrtFt_jMcp-K4v6T8Yx9A.png"/></div></div></figure><p id="4c98" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">一般来说，身份验证层是这样实现的:当客户端填充必填字段时，请求将传输到服务器或后端服务，然后后端对凭据进行身份验证，如果成功，它会将JWT格式的访问令牌返回给客户端。</p><p id="f255" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这是身份验证登录如何工作的基本原则。</p><p id="3baf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在现实世界中，仅仅保证身份验证层的安全是不够的。</p><p id="30fc" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们这样做的方式不同。虽然我们仍然使用第一张图中的相同原则，但是我们通过增加几个步骤来提升它。</p><p id="02bd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这个步骤称为挑战-响应认证。</p><p id="6056" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">质询-响应身份验证是一系列协议，其中一方提出质询，另一方必须提供有效答案才能通过身份验证。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es la"><img src="../Images/a5d6c2451006e6777b6247bb0dc4e301.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*edRRM7cDSrWE4-sHzx2mDw.png"/></div></figure><p id="9085" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们使用NONCE作为从后端发送到前端服务的质询响应。</p><p id="012d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">随机数或加密随机数是随时间变化的任意数量或比特的字符串，仅用于特定目的，以验证数据仅被使用一次。</p><p id="9e06" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在你的网络或手机到你的后端服务之间的网络流量中，密码不应该以简单的形式直接发送。</p><p id="4129" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">即使哈希密码仍然不够强大，仍然可以被中间人攻击渗透。</p><h1 id="706c" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">💡<strong class="ak">想法</strong></h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lt"><img src="../Images/33c02dd58b7b585d7f27a0150b306643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*jJLnYeywZkmNK1ZW9738IA.png"/></div></figure><p id="016b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在身份验证层，前端将向后端服务发送一个请求，在有效负载中包含一个公钥。</p><p id="778f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">后端将检查请求的来源，以确保它在预期的域中。然后生成加密随机数，并使用客户端给出的公钥对其进行哈希运算。</p><p id="d0b2" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">生成的随机数将是响应挑战。</p><p id="a8f9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">该质询将被发送回前端，并使用密钥进行解密以获得随机数。</p><p id="c174" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在密码将被散列使用NONCE作为一个盐。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lu"><img src="../Images/ab315338867fdcb2f2b87137e3ffabb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcPg_8Q5mesYyeqrITCcKw.png"/></div></div></figure><p id="0cca" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">SALTS用于保护您的密码，作为您的哈希函数的附加属性，以形成一组新的随机字符串。</p><p id="dac6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过使用这种方法，您可以防止实际的密码暴露给中间人攻击。</p><p id="4adf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，一旦用户登录，用户名和散列密码将被发送到后端服务。</p><p id="eeb4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，后端将使用随机数作为salt来验证哈希密码。</p><p id="88a1" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">验证后，后端将生成一个JWT，作为响应发送回前端。</p><p id="7539" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">有一些高级方法可以实现这一原则，它通常用于安全消息、身份验证和区块链。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lv"><img src="../Images/343b60f7e1fe515d2c4a0ab7042e63de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*errv7uFSrV__Wts2xjFzeQ.png"/></div></div></figure><p id="b951" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">拥有一个好的身份验证实现可以解决中间人攻击或来自应用程序的重放攻击的问题。</p><h1 id="35b3" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">动态密码|一次性PIN</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lw"><img src="../Images/d6658b0cb82b6515cd2180f43ce9469d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*abOZ1DySiHbE6dk_zKrDiQ.png"/></div></figure><p id="1faf" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">它还伴随着另一层安全措施，称为OTP服务或一次性PIN，通过向短信或电子邮件发送一个任意的唯一号码来确认用户身份的合法性，该号码仅在短时间内对一次登录会话有效。</p><p id="0076" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这解决了传统的基于密码的身份验证的问题。也就是说，当有人知道你的真实密码时，就没有办法阻止对你账户的访问。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lx"><img src="../Images/61a2addb743cb13532881f74964aef39.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*CY4ruvtLZ08Nz_0a_57TSg.png"/></div></figure><p id="3d31" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">OTP有多种实现方式，如通过SMS的OTP、第三方验证软件，如google验证器或Microsoft验证器</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ly"><img src="../Images/0fbd1083256a44ddb7c79750dba7e862.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*3lB2-vZRXS0HmwokjbduXA.png"/></div></figure><p id="6355" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">或者使用物理安全密钥。</p><h1 id="5253" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">替代方案</h1><p id="232e" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">但是我们不要忘记，如果时间真的是一种奢侈品，您也可以使用第三方身份提供商来满足这些复杂性，同时获得相同或更好的安全性。</p><h2 id="8109" class="me lc hi bd ld mf mg mh lh mi mj mk ll js ml mm ln jw mn mo lp ka mp mq lr mr bi translated">单点登录身份验证</h2><p id="02e6" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">另一个更简单的解决方案是使用第三方身份提供商，我们通常称之为SSO或单点登录身份认证。</p><p id="abcb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">其背后的实现更简单，因为您不需要开发，而是将身份服务集成到您的应用程序中。</p><p id="6b42" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">背后的想法是，</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ms"><img src="../Images/648e2408c0684bf961650c3dbabfe7e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJyqUnb81EFfO7MGIJKTfA.png"/></div></div></figure><p id="ca05" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">一旦您的应用程序已经集成了身份提供者，用户就不需要进行注册或登录，因为单点登录提供者使用的是一键式身份验证流程。</p><p id="2ec5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">一旦提供者成功地识别了用户，它就返回一个带有用户标识符的回调，作为对应用程序的响应。</p><p id="e649" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，应用程序可以使用这些信息记录到您的后端服务，作为您的资源服务的未来参考。</p><p id="19bd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">同样，您也可以根据提供的用户标识符来制定JWT响应。</p><p id="bba3" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">通过这种方式，认证实现更加易于管理。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mt"><img src="../Images/beac6d9416e8edb3a468ce833ea74f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*nLEV7-jcGHSNt6WVq-jygA.png"/></div></figure><h1 id="2d86" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">批准</h1><p id="9a8c" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">相比之下，授权负责限制应用程序将累积的特定级别的资源。这包括但不限于被另一个用户标记为私有的信息以及被删除或存档的项目，</p><p id="8114" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">此外，它还与认证层配对。它需要累积在用户被认证之后给出的短期访问令牌，以便访问资源。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mu"><img src="../Images/ecba6be3ffd7cfd03866b5eaf3e8b566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*m0QrYDOQCZ-cpVfIIyoAvg.png"/></div></figure><p id="62fe" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">它是一个持有签名的JWT声明的身份提供者，应用程序使用该声明进行身份确认。</p><p id="f714" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">JWT是一个开放标准(<a class="ae mv" href="https://tools.ietf.org/html/rfc7519" rel="noopener ugc nofollow" target="_blank"> RFC 7519 </a>)，其目的是保护JSON对象格式的服务间传输的信息。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kh"><img src="../Images/a55eee2450579d93db7f6de6fa6920c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5wL5vcaDIMIBgCbcJow4sQ.png"/></div></div></figure><p id="2c33" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">它由3部分组成，分别是报头、有效载荷和签名</p><p id="9053" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">报头</strong>或授权报头描述了用于生成令牌和类型的算法。</p><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="40af" class="me lc hi mx b fi nb nc l nd ne">{<br/>  "alg": "HS256",<br/>  "typ": "JWT"<br/>}</span></pre><p id="ca08" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对于本例，JWT令牌有一个包含HS256算法和JWT类型的授权头。</p><p id="7df6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">提示:如果可以的话，最好在你的系统上有一个可以改变每个用户算法的架构。另一方面，如果用户1使用HS256算法，则用户2不应与第一个用户相同。</p><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="dcab" class="me lc hi mx b fi nb nc l nd ne">{<br/>  "sub": "1234567890",<br/>  "name": "Jeffrey Forones",<br/>}</span></pre><p id="2dec" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">有效载荷</strong>是描述你的用户实体的声明或陈述</p><p id="4e0e" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">实际上，有效载荷应该是短暂的，特别是当它包含有用的信息时。在这种情况下，防止系统出现安全漏洞。</p><p id="53fd" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">此外，设置一个较短的到期时间至关重要。通常的做法是到期不应超过15分钟。</p><pre class="iy iz ja jb fd mw mx my mz aw na bi"><span id="f07e" class="me lc hi mx b fi nb nc l nd ne">HMACSHA256(<br/>  base64UrlEncode(header) + "." +<br/>  base64UrlEncode(payload),<br/>  secret)</span></pre><p id="b663" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">签名</strong>是编码报头、有效载荷和密钥的组合</p><p id="4cc4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">密钥是一个任意的数字或字符串，应该在加密通信中使用一次。在本例中，我们在JWT使用它。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/e9a335a4e7b1c717c056e5e6f0eb23d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mj9wqptWb6lq4RT86nWsDA.png"/></div></div></figure><p id="7fe7" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这是一个数字签名的JWT令牌的例子，每种颜色代表红色部分是报头，粉红色是有效载荷，蓝绿色是签名，用点(.) .</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ng"><img src="../Images/c874ed718e66273b54b675265828ff24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEs4nHvTOEMuZy-_2VqQPw.png"/></div></figure><h2 id="2c7d" class="me lc hi bd ld mf mg mh lh mi mj mk ll js ml mm ln jw mn mo lp ka mp mq lr mr bi translated">外卖</h2><p id="2cfb" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">身份验证是为了验证和生成短期访问令牌。</p><p id="4d00" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">授权是通过使用访问令牌来限制消费者的资源量并验证其访问权限。</p><h1 id="4fe4" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">传输中的数据</h1><p id="a134" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">现在，由于我们已经详细描述了每个组件，我们现在继续讨论如何相互关联。因此，他们应该如何连接每个服务是非常重要的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mu"><img src="../Images/7b4ad8a0fd1dc45e84339455790ea8a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*qRWNA69_-JUmy7R_Wb3xuA.png"/></div></figure><p id="7ea9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">超文本传输协议安全</p><p id="eddb" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我们从应该在HTTPS的传输协议开始，因为当信息从前端传输到后端服务时，HTTPS加密并保护信息。</p><p id="f5a4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">这可以防止中间人攻击在有效负载传输过程中读取请求的上下文。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/95f07184707b4182b1fe497d72c88d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*vjs1yjRytcBz3z5xmmL8kw.png"/></div></figure><p id="d599" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">数据包嗅探器就是一个例子，它可以让你看到网络上传输的所有东西。</p><h1 id="c7fc" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">数据验证</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ni"><img src="../Images/5899691665a04d8b62e3f36d86dbddc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*_GRfIfarrIFiWBvOnHQKpg.png"/></div></figure><p id="b3c5" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因为所有的东西都不是放在一起的，我们没有忘记2个实体的验证原则，它们是你的前端和后端API。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nj"><img src="../Images/fcbd008f9b77e49419638e4921e29d68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHyyTOuQRAPavg5rYdIXpA.png"/></div></div></figure><p id="89c9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在登录页面，一般来说，验证将始终是一个要求。电子邮件字段应该是正确的格式，密码应该隐藏，所有字段都是必填项，然后我们提交。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nk"><img src="../Images/d9d6fa61d4a87c0f82921888cae6c77d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*Ue0EeBclb9ZkWvGwUTChRQ.png"/></div></figure><p id="596f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但在后端，字段验证通常是假定的，因为前端已经验证了字段，然后后端服务将直接进行查询验证。不知道这些小事会给你的应用程序带来大的缺陷。</p><h1 id="1eaf" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">⚠️小心！</h1><p id="7ec4" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">有很多工具可以通过直接使用API请求信息来绕过前端。这将有助于你的后端开发独立于你的前端。</p><p id="e79b" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">其中一个是邮递员</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nl"><img src="../Images/99c4dad5f9d6ee20898b5c19608b85bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09iHtp6sDF4ITPE8mrPxNg.png"/></div></div></figure><p id="0772" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">Postman是创建后端服务的可靠工具，也是前端用于集成的良好文档工具。</p><p id="0265" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但是对于那些试图破坏你的应用程序的人来说，这也是至关重要的。</p><p id="3c75" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因此，两个服务都有必要验证必填字段以防止攻击。</p><p id="6388" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">前端应该处理字段验证。</p><p id="7154" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">后端应该处理从前端发送的属性验证。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nm"><img src="../Images/f95b9ee94a05ca126e9d0ffb120fc4e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*DGN7sOtq-uFcEqz78CchRA.png"/></div></figure><p id="403f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">前端和后端应该在字段和属性中进行相同的验证检查</p><p id="cb62" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后，后端可以在数据库查询下进行第二层验证，以识别用户身份。</p><p id="1717" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但是请注意，这个原则应该适用于所有的应用程序，而不仅仅是你的登录页面。</p><p id="ce90" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们总是在前端复制验证。正如我之前讨论过的。“每个服务不应该相互信任”</p><h1 id="3e86" class="lb lc hi bd ld le lf lg lh li lj lk ll io lm ip ln ir lo is lp iu lq iv lr ls bi translated">结论</h1><p id="96c0" class="pw-post-body-paragraph jj jk hi jl b jm lz ij jo jp ma im jr js mb ju jv jw mc jy jz ka md kc kd ke hb bi translated">作为本主题的总结，这里不提供任何编码。它不关心你将在你的网络、移动或后端服务中使用什么编程语言。</p><p id="1179" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">因为对我们来说，要理解现实世界的问题，更重要的是价值观和原则，这取决于我们成为更好的工程师的愿景。</p></div></div>    
</body>
</html>
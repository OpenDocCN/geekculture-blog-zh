<html>
<head>
<title>mapState, mapGetters, mapMutations and mapActions with Vue3/Vuex4 and <script setup=""/></title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Vue3/Vuex4和<script setup=""/>的mapState、mapGetters、mapMutations和mapActions</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/mapgetters-with-vue3-vuex4-and-script-setup-5827f83930b4?source=collection_archive---------0-----------------------#2021-08-04">https://medium.com/geekculture/mapgetters-with-vue3-vuex4-and-script-setup-5827f83930b4?source=collection_archive---------0-----------------------#2021-08-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0fca433649c0f256547e48bfa0b1ce85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQyyewnsip110-JnEUKE4g.png"/></div></div></figure><p id="ff1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">截至2022年，medium.com要求您拥有至少100名粉丝才有资格加入合作伙伴计划。在写这篇文章的时候，我有13个。所以如果你觉得这篇文章有帮助或者有趣，请考虑关注我。谢谢！</strong></p><p id="d13b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">有一种替代方法可能值得参考。尤其是如果你正在做一个新项目，现在可能有理由使用Vuex。</em><a class="ae jp" href="https://vuejsdevelopers.com/2020/10/05/composition-api-vuex/" rel="noopener ugc nofollow" target="_blank"><em class="jo">https://vuejsdevelopers . com/2020/10/05/composition-API-vuex/</em></a></p><p id="97ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我只是在检查Vue 3和这个新的语法和合成API等等时偶然发现了这个StackOverflow帖子,并准备添加一个Vuex商店。</p><p id="15f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">在Vue 2中… </strong></p><p id="06fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…用存储getters中的属性填充组件，如下所示:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="2224" class="jz ka hi jv b fi kb kc l kd ke">&lt;template&gt;<br/>  &lt;div&gt;<br/>    {{ count }}<br/>    {{ countIsOdd }}<br/>    {{ countIsEven }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="4092" class="jz ka hi jv b fi kf kc l kd ke">&lt;script&gt;<br/>import { mapGetters } from 'vuex'</span><span id="8bde" class="jz ka hi jv b fi kf kc l kd ke">export default {<br/>  computed: {<br/>    ...mapGetters(['count', 'countIsOdd', 'countIsEven'])<br/>  }<br/>}<br/>&lt;/script&gt;</span></pre><p id="ea85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">在Vue 3中… </strong></p><p id="0904" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…根据文档，它看起来像是<a class="ae jp" href="https://next.vuex.vuejs.org/guide/composition-api.html#accessing-state-and-getters" rel="noopener ugc nofollow" target="_blank">这个</a>，使用<code class="du kg kh ki jv b">&lt;script setup&gt;</code>语法，它看起来像这样:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="8d5c" class="jz ka hi jv b fi kb kc l kd ke">&lt;script setup&gt;<br/>import { computed } from 'vue'<br/>import { useStore } from 'vuex'<br/><br/>const store = useStore()</span><span id="432e" class="jz ka hi jv b fi kf kc l kd ke">const count = computed(() =&gt; store.getters.count)<br/>const countIsOdd = computed(() =&gt; store.getters.countIsOdd)<br/>const countIsEven = computed(() =&gt; store.getters.countIsEven)<br/>&lt;/script&gt;</span></pre><p id="9393" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这在我看来完全没问题，但是有人可能会说<code class="du kg kh ki jv b">computed(() =&gt; store.getters.</code>在每一行都重复，这看起来不太好。所以…</p><p id="ccd5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我做了什么……</strong></p><p id="01ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…我添加了一个名为<code class="du kg kh ki jv b">map-state.js</code>的文件:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="a800" class="jz ka hi jv b fi kb kc l kd ke">import { computed } from 'vue'<br/>import { useStore } from 'vuex'</span><span id="ecd2" class="jz ka hi jv b fi kf kc l kd ke">const mapGetters = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store.getters).map(<br/>      getter =&gt; [getter, computed(() =&gt; store.getters[getter])]<br/>    )<br/>  )<br/>}<br/><br/>export { mapGetters }</span></pre><p id="2a2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后组件看起来像这样:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="9152" class="jz ka hi jv b fi kb kc l kd ke">&lt;template&gt;<br/>  &lt;div&gt;<br/>    {{ count }}<br/>    {{ countIsOdd }}<br/>    {{ countIsEven }}<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="5f62" class="jz ka hi jv b fi kf kc l kd ke">&lt;script setup&gt;<br/>import { mapGetters } from '../map-state'</span><span id="0f6b" class="jz ka hi jv b fi kf kc l kd ke">const { count, countIsOdd, countIsEven } = mapGetters()<br/>&lt;/script&gt;</span></pre><p id="6319" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为我工作，我想分享这个。这同样适用于动作和突变，当然也适用于你的商店中的子模块。我只是还不需要它，所以没有实现它。</p><p id="38ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">嗯……好吧。写完5分钟后，我在<code class="du kg kh ki jv b">map-state.js</code>中添加了一个<code class="du kg kh ki jv b">mapMutations </code>功能。:D</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="9202" class="jz ka hi jv b fi kb kc l kd ke">const mapMutations = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store._mutations).map(<br/>      mutation =&gt; [mutation, value =&gt; store.commit(mutation, value)]<br/>    )<br/>  )<br/>}</span><span id="e7b7" class="jz ka hi jv b fi kf kc l kd ke">export { mapGetters, mapMutations }</span></pre><p id="cbeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在组件中:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="5ec8" class="jz ka hi jv b fi kb kc l kd ke">&lt;script setup&gt;<br/>import { mapGetters, mapMutations } from '../map-state'</span><span id="18aa" class="jz ka hi jv b fi kf kc l kd ke">const { sort } = mapGetters()<br/>const { toggleSort } = mapMutations()<br/>&lt;/script&gt;</span></pre><p id="b9c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不确定我是否忽略了一些不想要的副作用，但是现在，它做了我想要的。</p><h2 id="9afa" class="jz ka hi bd kj kk kl km kn ko kp kq kr jb ks kt ku jf kv kw kx jj ky kz la lb bi translated">我的最终结果:</h2><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="924d" class="jz ka hi jv b fi kb kc l kd ke">import { computed } from 'vue'<br/>import { useStore } from 'vuex'</span><span id="e631" class="jz ka hi jv b fi kf kc l kd ke">const mapState = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store.state).map(<br/>      key =&gt; [key, computed(() =&gt; store.state[key])]<br/>    )<br/>  )<br/>}</span><span id="3fe2" class="jz ka hi jv b fi kf kc l kd ke">const mapGetters = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store.getters).map(<br/>      getter =&gt; [getter, computed(() =&gt; store.getters[getter])]<br/>    )<br/>  )<br/>}</span><span id="516c" class="jz ka hi jv b fi kf kc l kd ke">const mapMutations = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store._mutations).map(<br/>      mutation =&gt; [mutation, value =&gt; store.commit(mutation, value)]<br/>    )<br/>  )<br/>}</span><span id="3267" class="jz ka hi jv b fi kf kc l kd ke">const mapActions = () =&gt; {<br/>  const store = useStore()<br/>  return Object.fromEntries(<br/>    Object.keys(store._actions).map(<br/>      action =&gt; [action, value =&gt; store.dispatch(action, value)]<br/>    )<br/>  )<br/>}</span><span id="9e05" class="jz ka hi jv b fi kf kc l kd ke">export { mapState, mapGetters, mapMutations, mapActions }</span></pre><p id="493a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">…在组件中:</p><pre class="jq jr js jt fd ju jv jw jx aw jy bi"><span id="2ade" class="jz ka hi jv b fi kb kc l kd ke">&lt;template&gt;<br/>  Count: {{ count }}<br/>  Odd: {{ counterIsOdd }}<br/>  Even: {{ counterIsEven }}<br/>  &lt;button <a class="ae jp" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="countUp"&gt;count up&lt;/button&gt;<br/>  &lt;button <a class="ae jp" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="countDown"&gt;count down&lt;/button&gt;<br/>  &lt;button <a class="ae jp" href="http://twitter.com/click" rel="noopener ugc nofollow" target="_blank">@click</a>="getRemoteCount('<a class="ae jp" href="https://api.countapi.xyz'" rel="noopener ugc nofollow" target="_blank">https://api.countapi.xyz'</a>)"&gt;<br/>    get remote count<br/>  &lt;/button&gt;<br/>&lt;/template&gt;</span><span id="edca" class="jz ka hi jv b fi kf kc l kd ke">&lt;script setup&gt;<br/>import { mapState, mapGetters, mapMutations, mapActions } from '../map-state'</span><span id="e7a5" class="jz ka hi jv b fi kf kc l kd ke">// computed properties<br/>const { count } = mapState()<br/>const { countIsOdd, countIsEvent } = mapGetters()</span><span id="0134" class="jz ka hi jv b fi kf kc l kd ke">// commit/dispatch functions<br/>const { countUp, countDown } = mapMutations()<br/>const { getRemoteCount } = mapActions()<br/>&lt;/script&gt;</span></pre><p id="4d73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">如果你打算成为中等会员，可以使用我的推荐页面支持我:</em><a class="ae jp" href="https://markus-kottlaender.medium.com/membership" rel="noopener"><em class="jo">https://markus-kottlaender.medium.com/membership</em></a></p></div></div>    
</body>
</html>
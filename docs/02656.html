<html>
<head>
<title>Image-Processing Libraries to Load Image Data in Machine Learning and Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在机器学习和深度学习中加载图像数据的图像处理库</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/image-processing-libraries-to-load-image-data-in-machine-learning-and-deep-learning-4c6ca538cc95?source=collection_archive---------20-----------------------#2021-05-23">https://medium.com/geekculture/image-processing-libraries-to-load-image-data-in-machine-learning-and-deep-learning-4c6ca538cc95?source=collection_archive---------20-----------------------#2021-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="54fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问候！😃</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/af840a775ec208d4a4106af5ba1607e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yULPLIwdGHAIIyG7dq5BKw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" href="https://www.medicalnewstoday.com/articles/325466" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="e3f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi ju translated">计算机视觉是人工智能中非常迷人的新兴领域之一。它就像人类的视觉一样，现在机器需要看到(图像)，理解数据(过程)，并解释结论。就像我们的视网膜和视神经足以完成理解视觉的任务一样，我们同样也在计算机视觉中运行某些算法和工具。</p><h1 id="35c4" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">动机</h1><p id="0e43" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">曾经对使用哪个图像处理库感到困惑吗？嗯，对我个人来说是的！在从事任何与计算机视觉相关的项目时，我个人会对选择哪个图像处理库来读取和操作我的图像数据集感到困惑。有各种各样的库和技术最适合特殊情况。例如，Mahotas是一个专门为生物信息学数据集设计的库。此外，有些最适合ML或DL的情况。</p><p id="4acd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，让我们探索我们的选择。</p><h1 id="9e95" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">现场研究</h1><h2 id="dff9" class="lg ke hi bd kf lh li lj kj lk ll lm kn iq ln lo kr iu lp lq kv iy lr ls kz lt bi translated">1.枕头(PIL)</h2><ul class=""><li id="41c5" class="lu lv hi ih b ii lb im lc iq lw iu lx iy ly jc lz ma mb mc bi translated">PIL (PythonImagingLibrary)是一个开源的python库，用于处理图像处理任务，如转换、增强、读取和显示，而枕头是一个分叉的库。</li><li id="f774" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">为了加载图像，使用图像模块的<strong class="ih hj"> open() </strong>，返回一个图像对象。这个对象有像素数据，这对处理图像很有用。因此，可以使用<strong class="ih hj"> fromarray() </strong>将image对象转换成一个数组，稍后再转换回一个对象，如图1所示。</li></ul><p id="4e1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文档:</strong><a class="ae jt" href="https://pillow.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://pillow.readthedocs.io/en/stable/</a><br/><strong class="ih hj">图像类型读取对象:</strong>图像类型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/3ed1351003410d9386168e2c04d027e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lM-hvHD6CmQ8jWSQDjlxJw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure1</figcaption></figure><h2 id="ac22" class="lg ke hi bd kf lh li lj kj lk ll lm kn iq ln lo kr iu lp lq kv iy lr ls kz lt bi translated">2.OpenCV</h2><ul class=""><li id="6352" class="lu lv hi ih b ii lb im lc iq lw iu lx iy ly jc lz ma mb mc bi translated">OpenCV(OpenSourceComputerVision)库是一个开源的计算机视觉和机器学习库</li><li id="b6cc" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它有广泛的优化算法，从最先进的算法到典型的图像处理</li><li id="22a4" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它是用C++编写的，充当C++、Matlab、Java和Python的通用接口。</li><li id="d507" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><strong class="ih hj"> OpenCV-Python </strong>是基于Python的OpenCV的包装器。在这里，cv2库的<strong class="ih hj"> imread() </strong>将图像文件作为数组读取，而<strong class="ih hj"> imshow() </strong>将图像显示在一个单独的窗口中，如图2所示。</li></ul><p id="ac92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文档</strong>:【https://opencv.org/】T21<br/>T24】图像读取对象类型: Numpy数组类型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/7fc77fd19a178b405c993274e9c21613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WR9AnLu2O3nQrbnP0618aw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 2</figcaption></figure><h2 id="53e5" class="lg ke hi bd kf lh li lj kj lk ll lm kn iq ln lo kr iu lp lq kv iy lr ls kz lt bi translated">3.sci kit-图像</h2><ul class=""><li id="699d" class="lu lv hi ih b ii lb im lc iq lw iu lx iy ly jc lz ma mb mc bi translated">Scikit-Image是一个基于python的开源图像处理库。</li><li id="005b" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它是用Cython编写的，cy thon是用C语言编写的Python的超集，以使它运行得更快。</li></ul><p id="945b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文档:</strong><a class="ae jt" href="https://scikit-image.org/docs/stable/auto_examples/" rel="noopener ugc nofollow" target="_blank"/><br/><strong class="ih hj">图片读取对象类型:</strong> Numpy数组类型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/751ed1df229cd31dcd8dbaacf9bdcf3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZblFywjLUFmytG4sHPJmQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 3</figcaption></figure><h2 id="428e" class="lg ke hi bd kf lh li lj kj lk ll lm kn iq ln lo kr iu lp lq kv iy lr ls kz lt bi translated">4.Matplotlib</h2><ul class=""><li id="0b67" class="lu lv hi ih b ii lb im lc iq lw iu lx iy ly jc lz ma mb mc bi translated">Matplotlib是一个基于python的可视化库，尤其适用于2d</li><li id="68c8" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它主要用于绘制散点图、条形图等</li><li id="7418" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它不是像上面的库那样专门为机器学习任务设计的，例如分割或对象检测，但是，它可以用于图像处理。</li><li id="19b2" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><em class="ml">CV上下文限制:</em>不支持所有文件格式。</li><li id="fdd4" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">matplotlib的image模块的<strong class="ih hj"> imread() </strong>读取图像并将其转换为NumPy数组，如图4所示。</li></ul><p id="9b73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文档:</strong><a class="ae jt" href="https://matplotlib.org/stable/tutorials/introductory/images.html" rel="noopener ugc nofollow" target="_blank">https://matplotlib . org/stable/tutorials/introductive/images . html</a><br/><strong class="ih hj">图片读取对象类型:</strong> Numpy数组类型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/7adc2398e4654b73d554685814291440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cR_9OEik-19CsqnapuW1WQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 4</figcaption></figure><h2 id="5d30" class="lg ke hi bd kf lh li lj kj lk ll lm kn iq ln lo kr iu lp lq kv iy lr ls kz lt bi translated">5.马霍塔斯</h2><ul class=""><li id="890e" class="lu lv hi ih b ii lb im lc iq lw iu lx iy ly jc lz ma mb mc bi translated">Mahotas是一个用C++实现的计算机视觉库</li><li id="1542" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">它是专门为生物图像信息学设计的，它使用NumPy阵列作为图像对象</li><li id="806a" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">mahotas <strong class="ih hj"> imread() </strong>函数用于加载图像，导入<strong class="ih hj"> pylab </strong>库用于显示图像对象，如图5所示</li></ul><p id="b5f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">文档:</strong><a class="ae jt" href="https://mahotas.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">https://mahotas.readthedocs.io/en/latest/#</a><br/><strong class="ih hj">图像读取对象类型:</strong> Numpy数组类型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/d5876d4b8273cf06dd5c18fbab37234a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGTwz5sS2rlQh0v7gM4Qeg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 5</figcaption></figure><p id="9eac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.<strong class="ih hj"> keras load_img函数</strong></p><ul class=""><li id="7f64" class="lu lv hi ih b ii ij im in iq mo iu mp iy mq jc lz ma mb mc bi translated">一个叫Keras的深度学习框架有一个函数叫load_img</li><li id="248e" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><strong class="ih hj"> load_img </strong>函数加载PIL格式的图像，如图6所示</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/74519be5dc703e02d6fd82067eaf6008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rh-OKbS0G76l2C43vmxjhA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 6</figcaption></figure><p id="9831" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，要准备任何深度学习计算机视觉模型，建议有一个庞大的数据集(至少超过500张图像)，否则传统的机器学习将足以完成任务。此外，当内存不足以加载、处理或训练庞大的数据集时，批处理的概念就出现了。与其一次加载所有图像，为什么不批量加载、扩充和处理呢？图像通过翻转、旋转、缩放或剪切来增加数据集的大小。所以，让我们来看看Keras如何能提供同样的帮助。</p><p id="4bbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.<strong class="ih hj"> Keras增强图像流</strong></p><ul class=""><li id="3860" class="lu lv hi ih b ii ij im in iq mo iu mp iy mq jc lz ma mb mc bi translated">Keras使用ImageDataGenerator类提供图像增强。这个类可以动态地批量增加你的图像，你可以把它保存在硬盘上或者直接传递给你的模型。</li><li id="b26c" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">在高总览中，<br/> 1。构造一个<strong class="ih hj"> ImageDataGenerator对象</strong>T3】2。为位于以下位置的图像数据集创建一个<strong class="ih hj">迭代器</strong>:<br/>2.1通过<em class="ml"> flow() </em> <br/>调用内存中的数据2.2通过<em class="ml">flow _ from _ directory()</em><br/>调用磁盘中的数据2.3通过<em class="ml"> flow_from_dataframe() </em>调用数据帧中的数据</li><li id="db3b" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">迭代器在每次迭代中返回一批扩充图像。这个迭代器可以进一步用于使用fit_generator()训练网络。</li><li id="88ad" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">让我们上场吧。<br/> <strong class="ih hj"> <em class="ml">步骤1: </em> </strong>构造一个<strong class="ih hj"> ImageDataGenerator对象</strong> <br/>用扩充参数实例化一个ImageDataGenerator对象</li></ul><pre class="je jf jg jh fd ms mt mu mv aw mw bi"><span id="75e8" class="lg ke hi mt b fi mx my l mz na">from keras.preprocessing.image import ImageDataGenerator<br/>img_gen = ImageDataGenerator(rotation_range=40, zoom_range=0.3, horizontal_flip = True, fill_mode='reflect')      </span></pre><p id="1196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ml">步骤2.1: </em> </strong>加载到内存中的数据调用通过<strong class="ih hj"> <em class="ml"> flow() <br/> </em> </strong>将一幅图像加载到内存中。一个生成器被创建，它将保存5个增强的图像到一个目录中。</p><pre class="je jf jg jh fd ms mt mu mv aw mw bi"><span id="3617" class="lg ke hi mt b fi mx my l mz na">from skimage import io<br/># load image in memory<br/>x = io.imread(join(path ,'data\\dogs.jpeg'))<br/>x = x.reshape((1,)+ x.shape) # iterator should have rank 4</span><span id="6d3b" class="lg ke hi mt b fi nb my l mz na"># iterator generates batches of randomly transformed images<br/>iterator = img_gen.flow(x, batch_size=4, save_to_dir = path_to_save ,save_prefix='pre', save_format='png')</span></pre><p id="5077" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ml">步骤2.2: </em> </strong>保存在磁盘中的数据称为via<em class="ml"/><strong class="ih hj"><em class="ml">flow _ from _ directory()<br/></em></strong>图像作为目录保存在磁盘中。假设有两类图片分别存储在“<em class="ml"> train </em>”和flow_from_directory()的子文件夹中，直接从目录中读取。</p><pre class="je jf jg jh fd ms mt mu mv aw mw bi"><span id="7522" class="lg ke hi mt b fi mx my l mz na"># directory where images stored on disk in respective subfolders<br/>folder = '/train'<br/># iterator generates batches of randomly transformed images<br/>iterator = img_gen.flow_from_directory(<br/>                   directory = folder, <br/>                   target_size = (100,100), <br/>                   batch_size=4, <br/>                   save_to_dir = path_to_save)<br/>x,y = iterator.next()<br/>print('Batch Image Shape:', x.shape)</span><span id="b27e" class="lg ke hi mt b fi nb my l mz na"># outputs <br/># Found 12 images belonging to 2 classes.<br/># Batch Image Shape (4, 256, 256, 3)</span></pre><p id="87de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ml">步骤2.3: </em> </strong>不在本博客范围内</p><p id="15c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你更好奇，那么应该访问<a class="ae jt" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank">这一页</a>。</p><p id="7b80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经包括了ML/DL中使用的最常见和最流行的库。然而，还有其他可用的库，如<strong class="ih hj"> SimpleITK、SimpleCV、Pgmagick、</strong>和<strong class="ih hj"> SciPy。</strong></p><p id="dcbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查我的<a class="ae jt" href="https://github.com/shachi01/machine-learning/blob/master/load_images_ml_dl.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>总结了这里演示的所有代码。</p></div><div class="ab cl nc nd gp ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="hb hc hd he hf"><p id="15aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这位作者的博客，请随意关注他，因为这位作者保证你会回来看更多有趣的人工智能相关的东西。<br/> 谢谢，<br/>学习愉快！😄</p><p id="b249" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ml">可以通过</em></strong><a class="ae jt" href="https://www.linkedin.com/in/kaul-shachi" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="ml">LinkedIn</em></strong></a><strong class="ih hj"><em class="ml">取得联系。</em>T74】</strong></p></div></div>    
</body>
</html>
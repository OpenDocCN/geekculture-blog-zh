<html>
<head>
<title>Debug your Laravel Sail Applications with xDebug</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用xDebug调试您的Laravel Sail应用程序</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/debug-your-laravel-sail-applications-with-xdebug-160ad70fcd41?source=collection_archive---------5-----------------------#2021-05-10">https://medium.com/geekculture/debug-your-laravel-sail-applications-with-xdebug-160ad70fcd41?source=collection_archive---------5-----------------------#2021-05-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="42f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Laravel在版本8中为docker环境引入了一个非常实用的包装器:Laravel Sail。我个人觉得它比Laravel Homestead更容易使用，Laravel Homestead的目的是在虚拟机中提供一个开发环境。尤其是在部署的时候。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/539e6b108547f8a5f3971b24c1b59c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWvGjq6ZtLX0vcGA_q3W8g.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@exdigy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Dominik Lückmann</a> on <a class="ae jt" href="https://unsplash.com/s/photos/docker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2db2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名低级软件开发人员，我已经习惯了调试器这种极其强大的工具。在我的代码中放置断点，并且能够在一步一步地检查代码的同时观察每个变量，这真是太好了。它有助于理解到底发生了什么，我认为这对初学者来说是不可忽视的。</p><p id="8ce9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不幸的是，Laravel Sail环境没有安装xDebug。这是一个在GitHub库上被粗略讨论的问题！我就不深入讨论了。我理解双方，我不知道如何解决。但是由于目前的结果是不将xDebug选项嵌入到Laravel Sail中，我将在这里展示如何非常容易地将xDebug添加到您的配置中。</p><h1 id="23e5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">发布Laravel Sail docker文件</h1><p id="d11e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我假设你已经在电脑上安装并运行了<em class="kx"> Docker桌面</em>。我还假设您已经创建了一个Laravel 8项目。如果没有，只需<a class="ae jt" href="https://laravel.com/docs/8.x/installation" rel="noopener ugc nofollow" target="_blank">跟随向导</a>即可。</p><p id="53b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您需要通过执行<code class="du ky kz la lb b">sail:publish</code>命令来发布Sail的docker文件:</p><pre class="je jf jg jh fd lc lb ld le aw lf bi"><span id="7d73" class="lg jv hi lb b fi lh li l lj lk">./vendor/bin/sail artisan sail:publish</span></pre><p id="0135" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个名为<em class="kx"> docker </em>的新目录应该出现在项目的根目录下。在里面你会发现两个名为<em class="kx"> 7.4 </em>和<em class="kx"> 8.0 </em>的目录。在这两个文件夹中，您都会找到一个<em class="kx"> Dockerfile </em>。睁开眼睛。</p><h1 id="ea65" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">编辑Dockerfile文件</h1><p id="8d4f" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将把xDebug作为一个选项添加到容器中。这样，如果您需要，它会出现在您的开发环境中，但不会出现在您的部署版本中。</p><p id="6856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是您的<em class="kx"> Dockerfile </em>编辑后的样子:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="a18d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第6行</strong> <br/>我们添加一个名为<em class="kx"> XDEBUG </em>的参数，可以在执行这个Dockerfile时提供。</p><p id="c9a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第33行到第35行</strong> <br/>我们根据XDEBUG参数的值，插入一个安装xDebug的条件。嵌件必须在这个位置制造。当我把运行指令切成两半时，要小心地完全按照我做的去做。</p><h1 id="c468" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">用xdebug初始化PHP</h1><p id="affe" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在这两个名为<em class="kx"> 7.4 </em>和<em class="kx"> 8.0 </em>的目录中，你会找到一个<em class="kx"> php.ini </em>文件。睁开眼睛。</p><p id="0b64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要配置xdebug。只需在php.ini文件中添加以下内容:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="21a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，端口9003是为xDebug客户端指定的。你可以选择另一个，但是这个很好。</p><p id="2261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您使用浏览器插件偶尔激活xDebug，可以省略第4行。</p><h1 id="7c63" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">通过docker-compose传播论点</h1><p id="c622" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了传递给<em class="kx">docker文件</em>，需要在<em class="kx"> docker-compose.yml </em>文件中设置<em class="kx"> XDEBUG </em>参数。该文件位于项目的根目录下。</p><p id="7159" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使它成为动态的，并允许XDEBUG根据它是在生产服务器上还是在开发环境中执行而被激活，xDebug参数将被赋予一个变量，我将把它命名为<em class="kx"> SAIL_XDEBUG </em>，但是您可以随意命名它。因此，找到docker-compose文件的laravel.test部分，并添加如下参数:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h1 id="7117" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">从env文件中激活xDebug</h1><p id="952b" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在，要在您的开发环境中激活xDebug，您只需要将<code class="du ky kz la lb b">SAIL_DEBUG=true</code>添加到<em class="kx">中。env </em>文件。每次你改变它，你将需要重建你的应用程序的docker映像。所以让我们开始吧。回到您的控制台，运行:</p><pre class="je jf jg jh fd lc lb ld le aw lf bi"><span id="fd64" class="lg jv hi lb b fi lh li l lj lk">./vendor/bin/sail build --no-cache</span></pre><p id="71c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这需要几分钟时间…</p><p id="d66c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要确保XDebug处于活动状态，请运行以下命令:</p><pre class="je jf jg jh fd lc lb ld le aw lf bi"><span id="329c" class="lg jv hi lb b fi lh li l lj lk">./vendor/bin/sail php -v</span></pre><p id="b770" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您应该看到PHP XDebug及其版本。</p><h1 id="c1a0" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">用VSCode开始调试</h1><p id="e5f5" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我将向您展示如何配置VSCode来开始调试，但是对于其他编辑器，配置应该是类似的。</p><h1 id="535f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">延伸部分的安装</h1><p id="40d2" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">要在VSCode中安装它，我们需要:</p><ul class=""><li id="8051" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">点击“扩展”图标(或Ctrl + Shift + X)，</li><li id="aab5" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">然后使用搜索字段查找扩展名(键入<em class="kx"> xdebug </em>)，</li><li id="d829" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">最后，安装它(点击绿色的“安装”按钮)。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/2587877719cc0cb223e8f6d8ed8542e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vva0MaK5sAdiE4nT.png"/></div></div></figure><p id="5d35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要工作，你需要在你的电脑上安装PHP。我们可以通过在控制台中键入<code class="du ky kz la lb b">php -version</code>命令来检查它是否已经安装。它应该输出当前安装的PHP版本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/1c2b3574218205c0c0687dc187e12725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JdzOF58u9toCyisV.png"/></div></div></figure><p id="350f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果没有，你可以下载最新版本(非线程安全的<a class="ae jt" href="http://windows.php.net/download" rel="noopener ugc nofollow" target="_blank">这个网站</a>)。</p><h1 id="9f1c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">监听器的配置</h1><p id="3396" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">如果我们需要监听Xdebug的许多实例，PHP调试扩展可以管理许多配置。我们将在这里为我们的容器创建唯一的一个。</p><p id="5a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们需要:</p><ul class=""><li id="e404" class="ln lo hi ih b ii ij im in iq lp iu lq iy lr jc ls lt lu lv bi translated">点击工具条上的“调试”图标(或者Ctrl + Shift + D)，</li><li id="1da5" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">然后点击左侧面板顶部下拉菜单旁边标题为“打开<em class="kx"> launch.json </em>”的齿轮图标。</li><li id="26be" class="ln lo hi ih b ii lw im lx iq ly iu lz iy ma jc ls lt lu lv bi translated">然后在建议的环境列表中点击PHP。一个名为<em class="kx">的隐藏文件夹。包含一个名为<em class="kx"> launch.json </em>的文件的vscode </em>被创建在我们的项目根文件夹中。</li></ul><p id="0240" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以很容易地推断出我们的扩展的配置与我们的项目相似，这很方便，因为我们的所有项目不一定都使用Docker，并且很可能有不同的配置。</p><p id="67da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的<em class="kx"> launch.json </em>文件中，我们注意到有2个配置可以删除(或者不删除，这无关紧要)。我们要创造一个新的:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ll lm l"/></div></figure><h1 id="6438" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">让我们调试一下</h1><p id="f0de" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">你起来了。试试看！</p><p id="af91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想了解更多关于这个配置的细节，可以看看我关于在Windows上使用VSCode、Xdebug和Docker进行调试的文章。</p></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><p id="1b3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望你喜欢这篇文章。</p><p id="aae1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谢谢你阅读我。祝您愉快！</p><p id="dbfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kx">原载于2021年5月3日https://www.naept.com</em><em class="kx"/><a class="ae jt" href="https://www.naept.com/blog/easily-debug-your-laravel-sail-applications-with-xdebug/" rel="noopener ugc nofollow" target="_blank"><em class="kx">。</em></a></p></div></div>    
</body>
</html>
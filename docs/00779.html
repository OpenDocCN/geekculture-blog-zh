<html>
<head>
<title>Data Cleaning: Hidden Aspect of Good Data Scientist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据清理:优秀数据科学家隐藏的一面</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/data-cleaning-hidden-aspect-of-good-data-scientist-13e03560f231?source=collection_archive---------39-----------------------#2021-03-12">https://medium.com/geekculture/data-cleaning-hidden-aspect-of-good-data-scientist-13e03560f231?source=collection_archive---------39-----------------------#2021-03-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5fc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本节将涵盖几乎所有的数据清理方法</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/28c5dfb8a1a2db43a93d2043315e1533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_Gt6XfeCbbBxvUlL.jpg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae jt" href="https://www.google.com/search?q=cleaning+full+size+image&amp;tbm=isch&amp;ved=2ahUKEwjdv9ayq6rvAhWSHCsKHWSsBKwQ2-cCegQIABAA&amp;oq=cleaning+full+size+image&amp;gs_lcp=CgNpbWcQAzoHCAAQsQMQQzoECAAQQzoCCAA6BggAEAUQHjoGCAAQCBAeOgQIABAYUIepBVj8xwVgrcwFaABwAHgAgAGxAogBhhqSAQcwLjcuOC4xmAEAoAEBqgELZ3dzLXdpei1pbWfAAQE&amp;sclient=img&amp;ei=oyZLYJ3iI5K5rAHk2JLgCg&amp;bih=625&amp;biw=1366#imgrc=kfEdbSCTR7XquM" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="b415" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在现实世界中，我们不会得到修改的数据，我们需要做的只是修改它本身，这里我们介绍数据清洗。一个好的数据科学家有很强的数据清理/数据修改能力。我将使用熊猫进行数据清理操作。在这篇博客中，我将为数据清理过程创建一个玩具数据集。让我们开始吧…..</p><p id="9edf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:-创建玩具数据集并导入必要的库</strong></p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="9a56" class="jz ka hi jv b fi kb kc l kd ke">import pandas as pd<br/>import numpy as np</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/89419bed045e6e77770a5eefbcad25eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zf9hmBL6ybnA7tBzoKnNBA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">code for toy dataframe</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/218ebec37b758b5f37c1b6135c5a8b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*TzToyAvl-qEiuT786EceMg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 1:-result</figcaption></figure><p id="f02e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤2:-对From_to列的操作</strong></p><p id="16bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kh ki kj jv b">From_to</code>列用下划线隔开，下划线前后的字符串分别定义出发地点和到达地点。</p><p id="0e38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们的主要任务是将到达和离开位置分成两个不同列的数据帧。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="9d55" class="jz ka hi jv b fi kb kc l kd ke">df1=df["From_To"].str.split("_",expand=True)<br/>df1</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kk"><img src="../Images/c20700ccfb10c683672abf327c89d075.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*IO8-odXppQTuF9poS0uYHQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 2</figcaption></figure><p id="0d28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里<code class="du kh ki kj jv b">expand=True</code>将拆分后的字符串展开成多列。但是在这里分割成多个列后，我们将得到列名为0，1，2…所以我们需要重命名这些列。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="b523" class="jz ka hi jv b fi kb kc l kd ke">df1=df1.rename(columns={0:"Departure",1:"Arrival"})<br/>df1</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kl"><img src="../Images/374ef4d8a7723be55b715d82e611bb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*T4XFBXGBUiHRosWluIcDTQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 3</figcaption></figure><p id="5055" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个问题，地点的名称没有以正确的格式书写。因此，在<code class="du kh ki kj jv b">capitalize()</code>的帮助下，我们将把它转换成合适的格式。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="e62c" class="jz ka hi jv b fi kb kc l kd ke">for i in df1.columns:<br/>    df1[i]=df1[i].str.capitalize()<br/>df1</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/be26a8ce0a904c8023eeeeb173eb038d.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*BV1cqwjSO5HguBmDacpnUQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 4</figcaption></figure><p id="7ada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在最后阶段，我们将从<code class="du kh ki kj jv b">df</code>中删除<code class="du kh ki kj jv b">From_To</code>列，并将<code class="du kh ki kj jv b">df1</code>与<code class="du kh ki kj jv b">df</code>连接起来。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="365f" class="jz ka hi jv b fi kb kc l kd ke">df=df.drop("From_To",axis=1)<br/>df=pd.concat([df,df1],axis=1)<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kn"><img src="../Images/d8a95824261bcc183b1be08cbd9f0e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*QNF3QNh-uHWMhy27t1FApg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 5</figcaption></figure><p id="a2ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:-对航班号列的操作</strong></p><p id="ea40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们将以10为增量填充Nan值，以便在给定数据集的行中给出有效的序列。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="36d3" class="jz ka hi jv b fi kb kc l kd ke">for i in range(len(df["FlightNumber"])):<br/>    if pd.isnull(df.loc[i,"FlightNumber"])==True:<br/>        df.loc[i,"FlightNumber"]=df.loc[i-1,"FlightNumber"]+10<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/6554de36bba42049259d472443d9bf5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*tnF2TDcu_a0M0UYR13MU4Q.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 6</figcaption></figure><p id="ef21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们能够以连续的方式填充所有的空值。</p><p id="080f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤四:-对最近延迟列的操作</strong></p><p id="d606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们的主要任务是将值列表转换成整数形式</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="faf7" class="jz ka hi jv b fi kb kc l kd ke">df2=pd.DataFrame(df["RecentDelays"].tolist())<br/>df2=df2.rename(columns={0:"Delay1",1:"Delay2",2:"Delay3"})<br/>df2 </span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kp"><img src="../Images/13e13bbff240ab1c040b3332af0d0d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*qJOeXkXtDZ95jQAdvYXUow.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 7</figcaption></figure><p id="8736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用先前的行和列值填充所有的空值。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="f709" class="jz ka hi jv b fi kb kc l kd ke">df2=df2.ffill(axis=0)  #filling the previous row value <br/>df2=df.ffill(axis=1)   #filling previous column values</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kq"><img src="../Images/f08a61e74af13c34ea040433a7833e5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*p017jzk_q8N2H-PcbJAK1g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">figure 8</figcaption></figure><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="b744" class="jz ka hi jv b fi kb kc l kd ke">#dropping raw values and updating modified value in df<br/>df=df.drop("RecentDelays",axis=1)<br/>df=pd.concat([df,df2],axis=1)<br/>df</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kr"><img src="../Images/4c53b1dd6680ea1c63b3c2a938d795d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*OKBmudWi6MvDqZjX5odl2w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 9</figcaption></figure><p id="87b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:-航线栏上的操作</strong></p><p id="9272" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们看到<strong class="ih hj">航空公司</strong>列，我们会发现每个数据中都有很多不需要的值，例如标点符号、前导/尾随空格、特殊符号，即:-(，)等。在这一列中，我们将删除除字母和数字值以外的所有值。</p><pre class="je jf jg jh fd ju jv jw jx aw jy bi"><span id="13ab" class="jz ka hi jv b fi kb kc l kd ke">import re<br/>def cleaned(x):<br/>    x=re.sub(r"[^a-zA-Z0-9]"," ",x)<br/>    x=x.strip()<br/>df["Airline"]=df["Airline"].apply(cleaned)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/cee1890e427d7faab41683685d7b9fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*oBj7lL1o3UTIe5-LkZ5DAg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 10</figcaption></figure><p id="7a9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论:- </strong></p><p id="13a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望你喜欢这个博客，如果你有任何建议，请在下面评论。<strong class="ih hj">不断学习不断探索…… </strong></p></div></div>    
</body>
</html>
<html>
<head>
<title>An Introduction to Football Player Dashboards Using Python and Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Matplotlib的足球运动员仪表盘介绍</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/an-introduction-to-football-player-dashboards-using-python-and-matplotlib-eb5328dfe85f?source=collection_archive---------1-----------------------#2021-05-07">https://medium.com/geekculture/an-introduction-to-football-player-dashboards-using-python-and-matplotlib-eb5328dfe85f?source=collection_archive---------1-----------------------#2021-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b67e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">今天，我们将深入探讨如何使用Python和一些内置库从头开始制作可视化仪表板。Python有一些最好的内置绘图库，主要是Matplotlib。虽然R中的ggplot和Tableau可以让您更快地绘制出现成的图形，但花一点时间，您就可以通过学习足够的基础知识，用Python制作出令人惊叹的可视化图形。事不宜迟，我们开始吧。</p><p id="d8e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将为<a class="ae jm" href="https://en.wikipedia.org/wiki/Erling_Haaland" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="jn">Erling Haaland</em></strong></a>和他的进球创建一个仪表板。我们将从<a class="ae jm" href="https://understat.com/player/8260" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">understand</strong></a><strong class="ih hj"/>和<a class="ae jm" href="https://fbref.com/en/comps/Big5/shooting/players/Big-5-European-Leagues-Stats" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Fbref </strong> </a>中抓取数据，然后使用这些数据在仪表板中绘制射门图和一个进球与预期进球散点图。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="f708" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要导入所有必要的库</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="b34f" class="ke kf hi ka b fi kg kh l ki kj">import requests<br/>from bs4 import BeautifulSoup as soup<br/>import json<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import matplotlib as mpl</span></pre><p id="c5eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将着手从理解中搜集数据。为此，我们需要请求，BeautifulSoup，JSON和pandas包。我不会深入到抓取的每一步，但我会附上一个满足这个需求的Youtube链接。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="251b" class="ke kf hi ka b fi kg kh l ki kj"># HAALAND'S PLAYER ID IN UNDERSTAT IS 8260<br/>url ='<a class="ae jm" href="https://understat.com/player/8260'" rel="noopener ugc nofollow" target="_blank">https://understat.com/player/8260'</a><br/>html = requests.get(url)<br/>parse_soup = soup(html.content,'lxml')</span><span id="9faf" class="ke kf hi ka b fi kk kh l ki kj">scripts = parse_soup.find_all('script')<br/>strings = scripts[3].string</span><span id="463f" class="ke kf hi ka b fi kk kh l ki kj">ind_start = strings.index("('")+2<br/>ind_end = strings.index("')")</span><span id="37e0" class="ke kf hi ka b fi kk kh l ki kj">json_data = strings[ind_start:ind_end]<br/>json_data = json_data.encode('utf8').decode('unicode_escape')</span><span id="7331" class="ke kf hi ka b fi kk kh l ki kj">data = json.loads(json_data)</span><span id="96b8" class="ke kf hi ka b fi kk kh l ki kj">x = []<br/>y = []<br/>xg = []<br/>result = []<br/>season = []</span><span id="d971" class="ke kf hi ka b fi kk kh l ki kj">for i,_ in enumerate(data):<br/>    for key in data[i]:<br/>        if key=='X':<br/>            x.append(data[i][key])<br/>        if key=='Y':<br/>            y.append(data[i][key])<br/>        if key=='xG':<br/>            xg.append(data[i][key])<br/>        if key=='result':<br/>            result.append(data[i][key])<br/>        if key=='season':<br/>            season.append(data[i][key])</span><span id="9c3d" class="ke kf hi ka b fi kk kh l ki kj">columns = ['X','Y','xG','Result','Season']<br/>df_understat = pd.DataFrame([x, y, xg, result, season], index=columns)<br/>df_understat = df_understat.T<br/>df_understat = df_understat.apply(pd.to_numeric,errors='ignore')</span></pre><p id="0d10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们能够创建一个包含拍摄位置、拍摄结果、xG(预期目标)和赛季的数据框。然而，快速浏览一下数据库就会发现，我们的x和y在0和1之间。</p><figure class="jv jw jx jy fd km er es paragraph-image"><div class="er es kl"><img src="../Images/3b893fc71e6535391f23566c35121f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*0Zr8-lefeng5unRsAWYdwg.png"/></div></figure><p id="f191" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决这个问题，我们将X和Y列缩放到100，因为我们稍后将使用的<strong class="ih hj"> Opta </strong>间距使用100 x 100间距。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="e284" class="ke kf hi ka b fi kg kh l ki kj">df_understat['X'] = df_understat['X'].apply(lambda x:x*100)<br/>df_understat['Y'] = df_understat['Y'].apply(lambda x:x*100)</span></pre><p id="9b09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恭喜你，我们已经刮到了理解网站。继续刮Fbref。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="9768" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用熊猫的read_html函数可以简单的刮出Fbref。但是，这将返回网页中所有表格的列表，我们只需要第一个表格，因此我们将使用索引。此外，需要清理数据，我已经使用自己为此创建的函数完成了这项工作。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="6139" class="ke kf hi ka b fi kg kh l ki kj">def readfromhtml(filepath):<br/>    df = pd.read_html(filepath)[0]<br/>    column_lst = list(df.columns)<br/>    for index in range(len(column_lst)):<br/>        column_lst[index] = column_lst[index][1]</span><span id="cc79" class="ke kf hi ka b fi kk kh l ki kj">df.columns = column_lst<br/>    df.drop(df[df['Player'] == 'Player'].index, inplace=True)<br/>    df = df.fillna('0')<br/>    df.set_index('Rk', drop=True, inplace=True)<br/>    try:<br/>        df['Comp'] = df['Comp'].apply(lambda x: ' '.join(x.split()[1:]))<br/>        df['Nation'] = df['Nation'].astype(str)<br/>        df['Nation'] = df['Nation'].apply(lambda x: x.split()[-1])<br/>    except:<br/>        print('Error in uploading file:' + filepath)<br/>    finally:<br/>        df = df.apply(pd.to_numeric, errors='ignore')<br/>        return df</span><span id="17cd" class="ke kf hi ka b fi kk kh l ki kj">df_fbref = readfromhtml('<a class="ae jm" href="https://fbref.com/en/comps/Big5/shooting/players/Big-5-European-Leagues-Stats'" rel="noopener ugc nofollow" target="_blank">https://fbref.com/en/comps/Big5/shooting/players/Big-5-European-Leagues-Stats'</a>)</span></pre><p id="8624" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看我们的数据框架</p><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kp"><img src="../Images/0bbaf83be61b170440a8a15dd4adbbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MefWDAh8JOJzmsWwBFsxdA.png"/></div></div></figure><p id="a472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了，我们的数据准备好了。现在，我们可以开始在仪表板上绘制这一部分了。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="a987" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将需要两个自定义软件包，可以在pip上找到— <a class="ae jm" href="https://mplsoccer.readthedocs.io/en/latest/gallery/index.html" rel="noopener ugc nofollow" target="_blank"> mplsoccer </a>和<a class="ae jm" href="https://pypi.org/project/highlight-text/#:~:text=the%20examples%20below.-,Use,the%20figure%20in%20figure%20coordinates" rel="noopener ugc nofollow" target="_blank"> highlight-text </a>。</p><p id="514c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您的环境中没有安装这些包，只需运行以下命令。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="1991" class="ke kf hi ka b fi kg kh l ki kj">pip install mplsoccer<br/>pip install highlight-text</span><span id="7d62" class="ke kf hi ka b fi kk kh l ki kj">from highlight_text import ax_text,fig_text<br/>import mplsoccer</span></pre><p id="5fc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不太喜欢Matplotlib提供的默认颜色和字体，所以我将使用不同的颜色和字体，并使用Matplotlib的rcParams进行更改。如果你不喜欢默认的颜色名称，可以随意查看这个<a class="ae jm" href="https://htmlcolorcodes.com/color-picker/" rel="noopener ugc nofollow" target="_blank">颜色网格</a>，它提供了不同颜色的十六进制代码。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="c920" class="ke kf hi ka b fi kg kh l ki kj">background = '#D6DBD9'<br/>text_color = 'black'<br/>mpl.rcParams['xtick.color']=text_color<br/>mpl.rcParams['ytick.color']=text_color<br/>mpl.rcParams['text.color']=text_color<br/>mpl.rcParams['font.family']='Candara'<br/>mpl.rcParams['legend.fontsize'] = 15</span></pre><p id="7807" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步:现在进入剧情本身。首先，我们将使用<a class="ae jm" href="https://matplotlib.org/stable/gallery/index.html" rel="noopener ugc nofollow" target="_blank"> mpl(Matplotlib) </a>的OOPs API。这给了我们更多的控制我们观想的各种元素。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="265f" class="ke kf hi ka b fi kg kh l ki kj"># SETTING UP THE AXES<br/>fig, ax = plt.subplots(figsize=(12,10))<br/>ax.axis('off')<br/>fig.set_facecolor(background)</span></pre><p id="0075" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这段代码执行后给我们一个十六进制颜色的普通背景#D6DBD9</p><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/74d276d485b0febe24c090dcf58c1aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7I91i2YmUF6Ee1jeoDfD3g.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 1-Initialising and background colour</figcaption></figure><p id="0dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第2步:</strong>我们现在将为19–20年的哈兰德Opta球场设置轴线。我们将首先初始化轴。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="08c0" class="ke kf hi ka b fi kg kh l ki kj">#SETTING UP THE MPL AXIS FOR THE FIRST SEASON</span><span id="20bf" class="ke kf hi ka b fi kk kh l ki kj">pitch =<br/>mplsoccer.VerticalPitch(half=True,pitch_type='opta', pitch_color='grass')<br/>ax_opta1 = fig.add_axes((0.1, 0.06, 0.4, 0.4))<br/>ax_opta1.patch.set_facecolor(background)<br/>pitch.draw(ax=ax_opta1)</span></pre><p id="2ae9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">fig的add_axes方法在fig区域中添加轴。列表中的前两个参数对应于轴的(0，0)位置，而后两个对应于长度和宽度。我们还将使用垂直间距，而不是默认的水平间距，并且只有一半。如需更多参考，请查看此<a class="ae jm" href="https://www.youtube.com/watch?v=2RhTuRWNqUc" rel="noopener ugc nofollow" target="_blank"> Youtube </a>链接。</p><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/3e51ad95095e3d98cae92bb533abbc7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2IhOxw4qPfnHQxWxG9nFzA.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 2-Drawing the pitch</figcaption></figure><p id="456a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:</strong>现在我们将绘制目标。我们在过滤了2019赛季的Understat数据帧以及那些导致进球的射门之后，使用了散点图函数。镜头的大小取决于特定镜头的xG。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="2f2b" class="ke kf hi ka b fi kg kh l ki kj">#NOW PLOTTING THE GOALS IN THE 2019-20 SEASON</span><span id="ef6e" class="ke kf hi ka b fi kk kh l ki kj">df_fil = df_understat.loc[df_understat['Season']==2019]</span><span id="7754" class="ke kf hi ka b fi kk kh l ki kj">pitch.scatter(df_fil[df_fil['Result']=='Goal']['X'],df_fil[df_fil['Result']=='Goal']['Y'], <br/>              s=np.sqrt(df_fil[df_fil['Result']=='Goal']['xG'])*100, marker='o', alpha=0.9,<br/>              edgecolor='black', facecolor='#6778d0', ax=ax_opta1, label='Goal')</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/ce01ffe1ba8573aa96987ab47b2dcb51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o41tzLqgjCyZDtIQ77zFBA.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 3-We obtain the shot zones which resulted in a goal.</figcaption></figure><p id="10da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4: </strong>既然我们已经绘制了进球的结果镜头，我们现在也将绘制其他镜头。我们将使用不同的颜色，并通过减少阿尔法使它们稍微透明一些。请记住将此代码放在前面的代码之前，以便首先绘制这些镜头。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="2551" class="ke kf hi ka b fi kg kh l ki kj">#PLOTTING OTHER SHOTS</span><span id="d5bd" class="ke kf hi ka b fi kk kh l ki kj">pitch.scatter(df_fil[df_fil['Result']!='Goal']['X'],df_fil[df_fil['Result']!='Goal']['Y'], <br/>              s=np.sqrt(df_fil[df_fil['Result']!='Goal']['xG'])*100, marker='o', alpha=0.6,<br/>              edgecolor='black', facecolor='grey', ax=ax_opta1)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/98d236d159610bbc1548edac7f7fce15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N4LIxuBQBUVJukaBfg9X2g.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 4-Plotting all shots of the 19–20 Season</figcaption></figure><p id="4601" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了，一个情节完成了。我们现在也将尝试给我们的照片添加图例和信息。</p><p id="1f07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第五步:</strong>添加标签。我们将为目标添加一个图例，使其更加清晰。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="f925" class="ke kf hi ka b fi kg kh l ki kj"># ADDING THE LEGEND<br/>ax_opta1.legend(loc='lower right').get_texts()[0].set_color("black")</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/3621ebb3afe925f429d4f0863095ce9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdLjk8UpRQwPIWqKOHZaXQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 5-Adding a legend</figcaption></figure><p id="b8f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第六步:</strong>现在我们要给这个图添加一些额外的信息，比如总射门数、进球数等。我们将使用axes对象的text方法。Y值可以在0到100之间波动，但是因为我们只使用上半部分，所以X值需要大于50。<br/>你可以通过改变文本方法的前两个参数来改变位置。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="ecd3" class="ke kf hi ka b fi kg kh l ki kj">ax_opta1.text(25,61,'GOALS : '+str(len(df_fil[df_fil['Result']=='Goal'])), weight='bold', size=15)<br/>ax_opta1.text(25,64,f"xG : {round(sum(df_fil['xG']),2)}", weight='bold', size=15)<br/>ax_opta1.text(25,58,'SHOTS : '+str(len(df_fil)), weight='bold', size=15)<br/>ax_opta1.text(85, 60, '2019-20', weight='bold', size=20)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/b732b86b83326a4c289fd85f85de4c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OagEhlgBVDtkuZ4UY-wRUg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 6-Adding additional information</figcaption></figure><p id="4b68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第7步:</strong>现在我们也将为20-21赛季重复上述步骤。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="0fa7" class="ke kf hi ka b fi kg kh l ki kj"># DOING THE SAME FOR THE 20-21 SEASON TOO<br/>ax_opta2 = fig.add_axes((0.50, 0.06, 0.4, 0.4))<br/>ax_opta2.patch.set_facecolor(background)<br/>pitch.draw(ax=ax_opta2)</span><span id="8476" class="ke kf hi ka b fi kk kh l ki kj">#PLOTTING OTHER SHOTS<br/>df_fil = df_understat.loc[df_understat['Season']==2020]</span><span id="270a" class="ke kf hi ka b fi kk kh l ki kj">pitch.scatter(df_fil[df_fil['Result']!='Goal']['X'],df_fil[df_fil['Result']!='Goal']['Y'], <br/>              s=np.sqrt(df_fil[df_fil['Result']!='Goal']['xG'])*100, marker='o', alpha=0.6,<br/>              edgecolor='black', facecolor='grey', ax=ax_opta2)</span><span id="1a91" class="ke kf hi ka b fi kk kh l ki kj">#NOW PLOTTING THE GOALS IN THE 2019-20 SEASON<br/>pitch.scatter(df_fil[df_fil['Result']=='Goal']['X'],df_fil[df_fil['Result']=='Goal']['Y'], <br/>              s=np.sqrt(df_fil[df_fil['Result']=='Goal']['xG'])*100, marker='o', alpha=0.9,<br/>              edgecolor='black', facecolor='#6778d0', ax=ax_opta2, label='Goal')</span><span id="4724" class="ke kf hi ka b fi kk kh l ki kj"># ADDING THE LEGEND<br/>ax_opta2.legend(loc='lower right').get_texts()[0].set_color("black")</span><span id="3840" class="ke kf hi ka b fi kk kh l ki kj">ax_opta2.text(25,61,'GOALS : '+str(len(df_fil[df_fil['Result']=='Goal'])), weight='bold', size=15)<br/>ax_opta2.text(25,64,f"xG : {round(sum(df_fil['xG']),2)}", weight='bold', size=15)<br/>ax_opta2.text(25,58,'SHOTS : '+str(len(df_fil)), weight='bold', size=15)<br/>ax_opta2.text(85, 60, '2020-21', weight='bold', size=20)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/098b9ba23eda8e63dfe2162bc8dda0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xz9E3zgbgMxJSnZhw8zw9Q.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 7-Repeating for 20–21 season</figcaption></figure><p id="f83f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第八步:</strong>我对坐标轴和图片边框的间隙不是很满意。因此，我更改了ax_opta1和ax_opta2的fig.add_axes参数，使其看起来更清晰一些。一点自我操纵导致了这一点。</p><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/0f589730e10030a518020ca0bfd45f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h5v0jd42QJuR75rRQx0GqQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 8</figcaption></figure><p id="dd81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，这个看起来好多了。继续看散点图。</p><p id="9bd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第9步:</strong>现在进入散点图。首先，我们像以前一样初始化轴。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="5567" class="ke kf hi ka b fi kg kh l ki kj"># NOW PLOTTING THE SCATTERPLOT<br/>ax_scatter = fig.add_axes([0.52,0.57,0.4,0.35])<br/>ax_scatter.patch.set_facecolor(background)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/05718213602dd6f33066e8b7f1d2290d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7fAvoCuIKvPfYIHmxwqHOQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 9-Adding axes for the scatterplot</figcaption></figure><p id="4eb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤10: </strong>我们现在绘制目标与预期目标图。我们的第一项工作是过滤Fbref数据帧，最少播放分钟数和某个位置。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="4e88" class="ke kf hi ka b fi kg kh l ki kj"># SETTING UP THE X AND Y OF THE SCATTERPLOT</span><span id="4e11" class="ke kf hi ka b fi kk kh l ki kj">no_90s = 10<br/>df_fil = df_fbref[df_fbref['90s']&gt;=no_90s]<br/>df_fil = df_fil[df_fil['Pos'].apply(lambda x: x in ['FW','MF,FW','FW,MF'])]</span><span id="9225" class="ke kf hi ka b fi kk kh l ki kj">x,y = (df_fil['xG']/df_fil['90s']).to_list(), (df_fil['Gls']/df_fil['90s']).to_list()</span><span id="e51d" class="ke kf hi ka b fi kk kh l ki kj">ax_scatter.scatter(x,y,alpha=0.3,c='#EF8804')</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/98d260a07639e15e567980d3750c9bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGLLFXotAStqRlCXQ37d1A.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 10-Plotting the scatterplot</figcaption></figure><p id="2c5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用十六进制代码#EF8804表示了前锋的颜色。以后请记住这一点。</p><p id="d486" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤11: </strong>我们现在过滤对应于Erling Haaland的数据。我们将在散点图上用不同的颜色和更深的不透明度来突出它。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="427d" class="ke kf hi ka b fi kg kh l ki kj"># NOW FILTERING ERLING HAALAND'S DATA</span><span id="0ea7" class="ke kf hi ka b fi kk kh l ki kj">df_player = df_fil[df_fil['Player']=='Erling Haaland']<br/>ax_scatter.scatter(df_player['xG']/df_player['90s'], df_player['Gls']/df_player['90s'], c='blue')</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/9fb4e3fe5b19873570dfb0fd0b581880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yvvyzL6-OEGie7hIcb5x1Q.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 11-Plotting Haaland’s data</figcaption></figure><p id="3338" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第12步:</strong>现在我们用网格线和x、y标签给这个散点图添加最后的修饰。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="64b1" class="ke kf hi ka b fi kg kh l ki kj"># ADDING FINISHING TOUCHES TO THE SCATTERPLOT</span><span id="ae93" class="ke kf hi ka b fi kk kh l ki kj">ax_scatter.grid(b = True, color ='grey',<br/>            linestyle ='-.', linewidth = 0.5,<br/>            alpha = 0.4)<br/>ax_scatter.set_xlabel('Expected Goals per 90', fontdict = {'fontsize':15, 'weight' : 'bold', 'color':text_color})<br/>ax_scatter.set_ylabel('Goals per 90', fontdict = dict(fontsize = 15, weight = 'bold',color=text_color))</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/b5b10c19871b8afee797567309ccb320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W0nCMVumwzQbSvm6lCmbOg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 12-Adding last touches to the scatterplot</figcaption></figure><p id="4767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第13步:</strong>我们差不多完成了，剩下的事情就是再美化一下，添加一些关于厄灵哈兰的信息。</p><p id="cc73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将从在左上角添加哈兰德的图像开始。我们通过使用add_axes来实现这一点，你猜对了。</p><p id="d47e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我有一个名为“haaland.png”的图片，保存在我执行这个操作的Python笔记本的同一个文件夹中。这是必要的，你这样做或给直接的位置，否则，图像将无法找到。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="a65d" class="ke kf hi ka b fi kg kh l ki kj">#ADDING HAALAND'S IMAGE<br/>ax_player = fig.add_axes([0,0.43,0.25,0.45])<br/>ax_player.axis('off')<br/>im = plt.imread('haaland.png')<br/>ax_player.imshow(im)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/0a6ad05451f659acad004c44ae4f4026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFXpbG7DQAZC3DGSKNQCOQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 13-Adding Haaland’s image</figcaption></figure><p id="825f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第14步:</strong>现在我们将向这个仪表板添加一些文本，比如职务、年龄和职位。</p><p id="4d71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们将使用高亮文本包。通过调用三角形&lt;&gt;括号，包含在这些括号中的任何文本都将被指定的颜色着色，有点像HTML的span标签。对于前锋的位置，我在散点图中取了一个十六进制代码。我们将在这里使用相同的颜色来表示向前。类似地，在猜想中，哈兰的名字将被涂成蓝色，在散点图中，蓝色对应于他。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="73bf" class="ke kf hi ka b fi kg kh l ki kj"># ADDING TITLES AND INFO</span><span id="ed47" class="ke kf hi ka b fi kk kh l ki kj">fig_text(0.1,0.94,"&lt;ERLING HAALAND's&gt; FINISHING",weight='heavy', size=25, highlight_textprops=[{'color':'blue'}])<br/>fig_text(0.25,0.85,'POSITION: &lt;FORWARD&gt;',weight='bold', size=20, highlight_textprops=[{'color':'#EF8804'}])<br/>fig_text(0.25,0.81,'AGE: &lt;20&gt;',weight='bold', size=20, highlight_textprops=[{'color':'red'}])</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/154bf7ba8e23c9486b1ac5b31fa23bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIowvsm8kmxfzu0rIZOwIw.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 14-Adding text</figcaption></figure><p id="86e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第十五步:</strong>就像我们之前添加哈兰德的形象一样，我们也将添加一个<a class="ae jm" href="https://en.wikipedia.org/wiki/Borussia_Dortmund" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="jn">多特蒙德</em> </strong> </a>徽章，让viz更有吸引力。与步骤13相同的程序。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="cd65" class="ke kf hi ka b fi kg kh l ki kj"># ADDING CLUB LOGO</span><span id="1e7d" class="ke kf hi ka b fi kk kh l ki kj">ax_team = fig.add_axes([0.27,0.55,0.15,0.15])<br/>ax_team.axis('off')<br/>im = plt.imread('bvb.png')<br/>ax_team.imshow(im)</span></pre><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/0e295ea8ca583d7f25ab384f6999e107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6PwJ88r1eTlPr2ZXxM3Jg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 15-Adding a BVB badge</figcaption></figure><p id="c61d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤16(可选):</strong>我们还可以通过向该仪表板添加页脚来结束。页脚可以包含关于创建者的信息以及数据源和其他信息。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="a894" class="ke kf hi ka b fi kg kh l ki kj"># ADDING A FOOTER</span><span id="bae8" class="ke kf hi ka b fi kk kh l ki kj">fig_text(0.05,0.03,'Made by Shreyas Khatri/@khatri_shreyas. Data from Fbref.com and Understat.com. Comparison with &lt;forwards&gt;'+<br/>        ' with more than '+str(no_90s)+' 90s('+str(no_90s*90)+' minutes).',<br/>        size=12, highlight_textprops=[{'color':'#EF8804'}], weight = 'bold')</span></pre><p id="ade9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们准备好了仪表板。</p><figure class="jv jw jx jy fd km er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/7f98405aeb775eb46a22d5fc90b88940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGHU0T2mlzwRmtZ5Wj_93g.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Step 16-It’s ready</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="a82a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这是一个关于如何为足球运动员制作仪表盘的好教程。我也试着加入了网络抓取，这样就可以在各个方面都有曝光率。如前所述，肯定有很多可定制性，但我希望这些基本步骤将大大有助于您在Matplotlib中的可视化技能。</p><h2 id="532a" class="ke kf hi bd kz la lb lc ld le lf lg lh iq li lj lk iu ll lm ln iy lo lp lq lr bi translated">资源</h2><p id="4727" class="pw-post-body-paragraph if ig hi ih b ii ls ik il im lt io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated"><em class="jn">它的项目文件夹在这个GITHUB存储库中。PYTHON笔记本和我用的两张图片一起呈现在这里:</em>【https://github.com/shreyas7kha/DataVizTutorial】T4</p></div></div>    
</body>
</html>
<html>
<head>
<title>Simple Linear Regression Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行简单的线性回归</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/simple-linear-regression-bd4348e1ee62?source=collection_archive---------0-----------------------#2021-10-23">https://medium.com/geekculture/simple-linear-regression-bd4348e1ee62?source=collection_archive---------0-----------------------#2021-10-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f5c58cc87eafb3a7f65085c3c1688ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YI6eHQkFH8I4LbOd"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@emilep?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Emile Perron</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2f59" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated"><em class="jt">先决条件</em></h1><ul class=""><li id="6976" class="ju jv hi jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">熟悉Anaconda环境</li><li id="9abb" class="ju jv hi jw b jx km jz kn kb ko kd kp kf kq kh ki kj kk kl bi translated">熟悉Python</li></ul><p id="325f" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">要获得实践经验，我建议跟随这篇文章:</p><p id="d06a" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">首先打开Anaconda Navigator，点击Jupyter笔记本的<em class="li">“发射”</em>按钮。它会在您的本地主机web浏览器上创建一个Jupyter笔记本。</p><p id="5ec8" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">创建笔记本后，导航到加载数据集的目录(<a class="ae iu" href="https://github.com/VIJAY-GADRE/1_Simple_Linear_Regression.git" rel="noopener ugc nofollow" target="_blank">链接到数据集</a>)。</p><p id="11b5" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">最后，单击右上角的“新建”按钮并选择Python，这将创建一个Python-Jupyter笔记本。</p><h1 id="07dd" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">1.导入相关库</h1><p id="3c41" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">我们可以使用Python函数<code class="du lm ln lo lp b">import()</code>导入一个库。</p><p id="d0a1" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">要使用StatsModels编写简单的线性回归模型，我们需要NumPy、pandas、matplotlib和statsmodels。</p><p id="dffd" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">以下是对以下库的快速概述:</p><ul class=""><li id="097c" class="ju jv hi jw b jx kt jz kw kb lq kd lr kf ls kh ki kj kk kl bi translated"><em class="li"> NumPy </em> —主要使用多维数组进行数学运算。</li><li id="9ba9" class="ju jv hi jw b jx km jz kn kb ko kd kp kf kq kh ki kj kk kl bi translated"><em class="li"> pandas </em> —用于数据操作和分析。</li><li id="ffed" class="ju jv hi jw b jx km jz kn kb ko kd kp kf kq kh ki kj kk kl bi translated"><em class="li"> matplotlib </em> —它是一个绘图库，是NumPy的一个组件</li><li id="398d" class="ju jv hi jw b jx km jz kn kb ko kd kp kf kq kh ki kj kk kl bi translated"><em class="li"> statsmodels </em> —用于探索数据、估计统计模型和执行统计测试。</li></ul><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/a1ade699cab1b0983ad65da9660b5d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*Mus_aipbY-9zrNKRKH3azw.png"/></div></figure><h1 id="7e8f" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">2.导入数据集</h1><p id="6469" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">导入库后，您可以使用pandas方法<code class="du lm ln lo lp b">read_csv()</code>(对于CSV文件)或<code class="du lm ln lo lp b">read_excel()</code>(对于excel文件)将数据导入/加载到笔记本中。</p><p id="ff75" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">它将导入数据，您可以使用存储导入数据的变量来验证它，在我们的例子中，它被称为<code class="du lm ln lo lp b">data</code>。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/66ce3ec65f99ae5f94ad65d3a2f433e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*4oi5chxeo19HOCsQfj9jdQ.png"/></div></figure><h1 id="f7a1" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">3.描述统计学</h1><p id="ba65" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">事先了解描述性统计是一个很好的做法，因为它有助于我们理解数据集(例如，是否存在任何异常值等)。)</p><p id="7a87" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">我们可以使用以下命令执行描述性统计:</p><pre class="lu lv lw lx fd lz lp ma mb aw mc bi"><span id="11aa" class="md iw hi lp b fi me mf l mg mh">dataframe.describe()</span></pre><p id="43d6" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">如果您想查看包含不同数据类型的所有列变量的描述性统计，只需包含<code class="du lm ln lo lp b">dataframe.describe(include=‘all’)</code></p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/2522e7171729a9db126594a8033d7730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*tOT0DzttiCrQHuoB9R314g.png"/></div></figure><p id="9571" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">幸运的是，在我们的案例中，数据中没有任何异常值。我们可以使用以下步骤来确定异常值:</p><ul class=""><li id="5165" class="ju jv hi jw b jx kt jz kw kb lq kd lr kf ls kh ki kj kk kl bi translated">寻找列变量的平均值</li><li id="2da3" class="ju jv hi jw b jx km jz kn kb ko kd kp kf kq kh ki kj kk kl bi translated">寻找最小、25%、50%、75%和最大行变量。</li></ul><p id="7598" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">25%、55%和75%分别表示25%的数据低于1772.00，55%的数据低于1864，75%的数据低于1934 SAT成绩。</p><ul class=""><li id="4be3" class="ju jv hi jw b jx kt jz kw kb lq kd lr kf ls kh ki kj kk kl bi translated">如果变量的最大值远离平均值，那么我们可以说异常值出现在该特定列中。</li></ul><p id="9431" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">SAT和GPA变量没有任何异常值，因为最大观察值位于平均值附近。如果SAT的最大观测值是40000.00，那么我们可以说存在异常值，我们必须移除该异常值。</p><h1 id="1ff7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">4.创建您的第一个线性回归</h1><h2 id="567e" class="md iw hi bd ix mj mk ml jb mm mn mo jf kb mp mq jj kd mr ms jn kf mt mu jr mv bi translated">声明因变量和自变量</h2><p id="cdce" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">要创建线性回归，您必须定义因变量(目标)和自变量(输入/特征)。</p><p id="b92d" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">我们必须根据SAT分数来预测GPA，所以我们的因变量是GPA，自变量是SAT。</p><p id="3437" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">要这样声明，我们可以使用以下命令:</p><pre class="lu lv lw lx fd lz lp ma mb aw mc bi"><span id="71e0" class="md iw hi lp b fi me mf l mg mh">dataframe[‘column_name’]</span></pre><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/3c607aa2440b4d8def273eadeb59e764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*z7vRitO1QXmbA7EsY76FPA.png"/></div></figure><h2 id="c62d" class="md iw hi bd ix mj mk ml jb mm mn mo jf kb mp mq jj kd mr ms jn kf mt mu jr mv bi translated">探索数据</h2><p id="e41d" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">我们可以使用以下公式绘制数据:</p><pre class="lu lv lw lx fd lz lp ma mb aw mc bi"><span id="eafa" class="md iw hi lp b fi me mf l mg mh">matplotlib.pyplot(independent variable, dependent variable) </span></pre><p id="bf4e" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">(pyplot参数—第一个参数是要绘制在x轴上的数据，第二个参数是要绘制在y轴上的数据)。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/cf3d694321a0f1cf244202732252498e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*teHWorfsdJN1D9Flp76ZOA.png"/></div></figure><p id="481c" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">我们可以看到，随着SAT成绩的提高，GPA成绩也在提高。因此，我们可以说这两个变量之间存在线性趋势。</p><h2 id="8048" class="md iw hi bd ix mj mk ml jb mm mn mo jf kb mp mq jj kd mr ms jn kf mt mu jr mv bi translated">线性回归</h2><p id="f548" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">现在让我们和我们最好的朋友<em class="li"> statsmodels </em>一起玩吧。</p><p id="044b" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">为了进行线性回归，我们应该总是加上偏差项或截距(b0)。我们可以使用以下方法来实现这一点:</p><pre class="lu lv lw lx fd lz lp ma mb aw mc bi"><span id="1439" class="md iw hi lp b fi me mf l mg mh"> statsmodels.add_constant(independent_variable)</span></pre><p id="4ca2" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">它会创建一个新的bias列，长度等于自变量，只包含1。</p><p id="2e04" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">让我们使用<em class="li">普通最小二乘(OLS) </em>模型拟合线性回归模型，以因变量和自变量作为自变量。</p><p id="8d40" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">最后，让我们打印汇总表:</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/eb7a7e44f592b59aca4b6262650c50c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3SXDWQfkCdY7QeIB48nlw.png"/></div></div></figure><p id="0924" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">它会创建3个表，我们最感兴趣的是包含系数、p值等的第二个表。</p><p id="6723" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">从汇总表中我们可以说截距(常数)系数为0.275，自变量系数为0.0017 <em class="li">(表示SAT每增加1个单位，GPA增加0.0017个单位)</em></p><p id="bf68" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">如果自变量/s的<em class="li"> p值</em>大于0.050，我们说该变量不显著，我们可能会丢弃该变量。在我们的例子中，SAT的p值是0.000，由于它小于0.050，我们可以说这个变量是显著的。【另外，如果我们从逻辑上考虑，SAT是预测GPA的一个重要变量】</p><p id="c1e6" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">最后，<em class="li"> R的平方</em>，R不过是模型的拟合优度。换句话说，我们的模型与观察结果吻合得有多好。r的范围在0和1之间。最佳R值没有明确的通用范围，但它取决于具体情况。</p><p id="b558" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated"><em class="li">另一方面，调整后的R </em>是R平方的<strong class="jw hj">修改版本，已经针对模型中预测器(输入)的数量进行了调整。当新的独立项对模型的改善程度超过偶然情况下的预期时，调整后的R平方增加。当预测者对模型的改进小于预期时，它会减少。</strong></p><h1 id="d056" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">5.绘制回归线</h1><p id="9033" class="pw-post-body-paragraph kr ks hi jw b jx jy ku kv jz ka kx ky kb lj la lb kd lk ld le kf ll lg lh kh hb bi translated">要在图上绘制回归线，只需定义线性回归方程，即y_hat = b0 + (b1*x1)</p><p id="0492" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">b0 =偏差变量的系数</p><p id="2eaf" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">b1 =输入/s变量的系数</p><p id="9522" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">最后，使用<code class="du lm ln lo lp b">matplotlib.pyplot()</code>绘制回归线，如下所示:</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/ed988456e14de7a9ea825508b24744d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*QgJOsTGoZ8ecMR699y9Fjw.png"/></div></figure><p id="f9bf" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated">就这样，我们到达了文章的结尾。感谢阅读。</p><p id="8951" class="pw-post-body-paragraph kr ks hi jw b jx kt ku kv jz kw kx ky kb kz la lb kd lc ld le kf lf lg lh kh hb bi translated"><em class="li">更多内容看</em><a class="ae iu" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="li">plain English . io</em></a></p></div></div>    
</body>
</html>
<html>
<head>
<title>A simple guide to creating a Bengali word cloud of any shape</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建任意形状的孟加拉文字云的简单指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/a-simple-guide-to-creating-a-bengali-word-cloud-of-any-shape-d118ec523e30?source=collection_archive---------38-----------------------#2021-06-07">https://medium.com/geekculture/a-simple-guide-to-creating-a-bengali-word-cloud-of-any-shape-d118ec523e30?source=collection_archive---------38-----------------------#2021-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8d0da7a01e417c617e7b2cb16f2a405e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*Xoii4t-s4BU1F4KK5CgyHw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Pikachu-shaped Bengali word cloud</figcaption></figure><p id="e7b6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">词云(也称为标签云或文本云)是直观解释文本数据以快速了解数据的最简单方法之一。词云是词频的图形表示，它对源文本中出现频率更高的词给予更大的重视[ <a class="ae js" href="https://www.betterevaluation.org/en/evaluation-options/wordcloud" rel="noopener ugc nofollow" target="_blank"> 1 </a> ]。每个单词的重要性通过它的大小和颜色表现出来。</p><p id="a0f8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">以自定义形状可视化单词云将使其更加引人注目，因此传达快速见解并以孟加拉语创建它与以其他语言创建它几乎是一样的。现在，让我们深入了解单词云的生成过程。</p><h1 id="308a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">装置</h1><p id="d06c" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">生成孟加拉文字云需要安装两个模块:</p><ol class=""><li id="3c9b" class="kw kx hi iw b ix iy jb jc jf ky jj kz jn la jr lb lc ld le bi translated"><a class="ae js" href="https://amueller.github.io/word_cloud/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">字云</strong> </a> <strong class="iw hj"> — </strong>用于生成字云。</li><li id="4287" class="kw kx hi iw b ix lf jb lg jf lh jj li jn lj jr lb lc ld le bi translated"><a class="ae js" href="https://bnlp.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj"> bnlp工具包</strong> </a> <strong class="iw hj"> — </strong>用于处理孟加拉文字。</li></ol><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="a771" class="lt ju hi lp b fi lu lv l lw lx">pip install wordcloud<br/>pip install bnlp_toolkit</span></pre><h1 id="9350" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">资料组</h1><p id="a1f8" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">我们将使用Kaggle的孟加拉新闻数据集[ <a class="ae js" href="https://www.kaggle.com/shakirulhasan/bangla-news-datasets-from-bdpratidin" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]进行演示。数据集可以在<a class="ae js" href="https://www.kaggle.com/shakirulhasan/bangla-news-datasets-from-bdpratidin" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">这里找到</strong> </a>。该数据集包含连续1000天的《孟加拉国报》的超过107k篇孟加拉语新闻文章。</p><h1 id="9019" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">导入必要的库</h1><p id="57c6" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">我们将从bnlp-toolkit以及其他库中导入孟加拉语停用词和标点符号。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="e6fe" class="lt ju hi lp b fi lu lv l lw lx">import numpy as np<br/>import pandas as pd</span><span id="f6a9" class="lt ju hi lp b fi ly lv l lw lx">import cv2<br/>import re</span><span id="cd89" class="lt ju hi lp b fi ly lv l lw lx">import matplotlib.pyplot as plt<br/>from wordcloud import WordCloud<br/>from bnlp.corpus import stopwords, punctuations</span></pre><h1 id="d6d4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">预处理文本数据</h1><p id="0dc0" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">新闻数据集下载解压后，会有一个名为<code class="du lz ma mb lp b">1000DaysNews.csv</code>的CSV文件。首先，读取CSV并检查数据。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="2cac" class="lt ju hi lp b fi lu lv l lw lx">df = pd.read_csv('1000DaysNews.csv')<br/>print(df.columns)<br/>print(df.shape)<br/>df.head()</span></pre><p id="d348" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据框包含“id”、“新闻id”、“标题”、“描述”、“类别”、“日期”、“文章”列，其形状为(107642，7)。现在我们已经对数据有了一些了解，我们可以前进到预处理步骤。</p><p id="e84a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了生成单词云，我们将在“描述”列上工作。首先，通过使用正则表达式删除标点符号和数字来清理文本。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="d72b" class="lt ju hi lp b fi lu lv l lw lx">def clean(text):</span><span id="9c5a" class="lt ju hi lp b fi ly lv l lw lx">    text = re.sub('[%s]' % re.escape(punctuations), '', text)<br/>    text = re.sub('\n', '', text)<br/>    text = re.sub('\w*\d\w*', '', text)<br/>    text = re.sub('\xa0', '', text)</span><span id="cf4d" class="lt ju hi lp b fi ly lv l lw lx">    return text</span><span id="d65a" class="lt ju hi lp b fi ly lv l lw lx">cleaned_text = df['description'].apply(lambda x: clean(str(x)))</span></pre><p id="d3c5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Word cloud将类似字符串或字节的对象作为<code class="du lz ma mb lp b">generate()</code>方法的参数。然而，<code class="du lz ma mb lp b">cleaned_text</code>是一个熊猫系列类型的物体。所以，我们必须将<code class="du lz ma mb lp b">cleaned_text</code>转换成<code class="du lz ma mb lp b">string</code>类型的对象。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="de49" class="lt ju hi lp b fi lu lv l lw lx">refined_sentence = " ".join(cleaned_text)</span></pre><h1 id="c53c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">准备图像遮罩</h1><p id="7e68" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">制作自定义形状的单词云需要一个白色背景和黑色前景对象的图像遮罩。在这里，我们将准备一个代码，使用任何透明的图像作为遮罩，以获得所需的形状的单词云。</p><div class="lk ll lm ln fd ab cb"><figure class="mc ij md me mf mg mh paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/dbebda9059a43e176f316b25f1f9dee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*xo_pQieR66muaIVBas06_A.png"/></div></figure><figure class="mc ij md me mf mg mh paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/0faf86829ead72a62734f2c1f64c0318.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*5l3gBESs-GVwPKDBBguArw.png"/></div></figure><figure class="mc ij md me mf mg mh paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/d9a792edaf13f7f46f5388f11a622664.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*bAw8gfBVBKhBfLy_bu9HTQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx mi di mj mk">Left: Transparent Pikachu image [<a class="ae js" href="https://www.vhv.rs/viewpic/hxxbxxR_pikachu-png-file-pokemon-the-highest-grossing-franchise/" rel="noopener ugc nofollow" target="_blank">3</a>] / Middle: Extracted from alpha channel / Right: Generated mask</figcaption></figure></div><p id="61bb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先，我们将提取透明图像(RGBA)的阿尔法通道，它会给我们一个背景是黑色和前景物体是白色的图像。之后，我们将使用<code class="du lz ma mb lp b">cv2.bitwise_not()</code>方法反转背景和前景色。现在，我们可以很容易地从透明图像中制作出蒙版。这个函数也适用于非透明图像。但是，在这种情况下，图像的背景必须是白色的，前景对象必须是黑色的。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="44a2" class="lt ju hi lp b fi lu lv l lw lx">def get_mask(img_path):</span><span id="f08b" class="lt ju hi lp b fi ly lv l lw lx">    img = cv2.imread(img_path, -1)<br/>    if img.shape[2] == 3:<br/>        return img<br/>    return cv2.bitwise_not(img[:, :, 3])</span></pre><h1 id="b76d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">词云生成</h1><p id="3b14" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">现在，我们已经准备好了掩码和文本数据，我们可以轻松地从中创建所需形状的单词云。首先，我们需要一个孟加拉字体来生成孟加拉语的单词云，因为单词云的默认字体是<strong class="iw hj"> <em class="ml"> Droid Sans Mono </em> </strong>字体，它不支持孟加拉语。孟加拉字体列表可以在<a class="ae js" href="https://www.omicronlab.com/bangla-fonts.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hj">这里</strong> </a>找到，我们将使用<strong class="iw hj"> <em class="ml"> Kalpurush </em> </strong>孟加拉字体生成单词云。其次，我们需要定义一个自定义的regexp，以便word cloud可以处理孟加拉语文本。</p><pre class="lk ll lm ln fd lo lp lq lr aw ls bi"><span id="94da" class="lt ju hi lp b fi lu lv l lw lx">mask = get_mask("pikachu.png")<br/>regex = r"[\u0980-\u09FF]+"</span><span id="ff5f" class="lt ju hi lp b fi ly lv l lw lx">wc = WordCloud(width=800, height=400,mode="RGBA",background_color=None,colormap="hsv",       mask=mask,stopwords = stopwords,<br/>font_path="kalpurush.ttf",regexp=regex).generate(refined_sentence)</span><span id="b5de" class="lt ju hi lp b fi ly lv l lw lx">plt.figure(figsize=(15, 7))<br/>plt.imshow(wc, interpolation='bilinear')<br/>plt.axis("off")<br/>plt.show()</span><span id="ae36" class="lt ju hi lp b fi ly lv l lw lx">result = wc.to_file("Bengali_word_cloud.png")</span></pre><p id="2c12" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们将传递我们创建的掩码、自定义的regexp、孟加拉字体路径和孟加拉停用词列表来创建一个单词云对象，然后调用<code class="du lz ma mb lp b">generate()</code>方法来生成一个自定义形状的孟加拉单词云。</p><p id="aa00" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由于孟加拉语处理资源匮乏，我希望这篇文章能有助于后续工作。</p><p id="752f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">代码链接-<a class="ae js" href="https://colab.research.google.com/drive/15h32YuSQ5YwVji8OynC9BvMaWGpsWyD2?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/drive/15h 32 yusq 5 ywvji 8 oync 9 bvmawgpswyd 2？usp =共享</a></p><h1 id="3d07" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><p id="8e8f" class="pw-post-body-paragraph iu iv hi iw b ix kr iz ja jb ks jd je jf kt jh ji jj ku jl jm jn kv jp jq jr hb bi translated">[1]Word Cloud-<a class="ae js" href="https://www.betterevaluation.org/en/evaluation-options/wordcloud" rel="noopener ugc nofollow" target="_blank">https://www . better evaluation . org/en/evaluation-options/Word Cloud</a></p><p id="8358" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">[2]孟加拉新闻数据集来自BD-practidin-<a class="ae js" href="https://www.kaggle.com/shakirulhasan/bangla-news-datasets-from-bdpratidin" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/shakirulhasan/Bangla-News-Datasets-from-bdpractidin</a></p><p id="89b2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">[3]皮卡丘透明图-<a class="ae js" href="https://www.vhv.rs/viewpic/hxxbxxR_pikachu-png-file-pokemon-the-highest-grossing-franchise/" rel="noopener ugc nofollow" target="_blank">https://www . vhv . RS/view pic/hxxbxxR _皮卡丘-png-file-pokemon-the-high-grossing-franchise/</a></p><p id="0e39" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">[4] Kalpurush孟加拉字体-<a class="ae js" href="https://www.omicronlab.com/download/fonts/kalpurush.ttf" rel="noopener ugc nofollow" target="_blank">https://www.omicronlab.com/download/fonts/kalpurush.ttf</a></p><p id="5a89" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">[5]标签云-【https://en.wikipedia.org/wiki/Tag_cloud T2】</p></div></div>    
</body>
</html>
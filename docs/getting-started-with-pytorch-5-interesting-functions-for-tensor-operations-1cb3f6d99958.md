# Pytorch 入门:张量运算的 5 个有趣函数

> 原文：<https://medium.com/geekculture/getting-started-with-pytorch-5-interesting-functions-for-tensor-operations-1cb3f6d99958?source=collection_archive---------45----------------------->

![](img/fc16b8232b6f558b37d89dcb1aff7263.png)

Pytorch 是由脸书人工智能研究实验室开发的开源机器学习库，用于深度学习、自然语言处理和计算机视觉等各种应用。

基于 PyTorch 的深度学习软件包括 Tesla Autopilot、优步的 Pyro、HuggingFace 的 Transformers、PyTorch Lightning 和 Catalyst。

PyTorch 有两个高级特性:

1.  张量计算(类似于 NumPy ),由图形处理单元(GPU)提供大量加速
2.  用于建立和训练深度神经网络的自动微分。

PyTorch Tensor 在概念上类似于 NumPy，但具有 GPU 功能来加速数值运算。此外，Pytorch 还提供了自动计算导数的附加功能，这是使用深度学习算法时必须具备的。

在这篇文章中，我们将研究 5 个简单的火炬。张量函数，它们的应用和它们的局限性。

*   **创作**:火炬。常态
*   **转换**:火炬。FROM_NUMPY
*   **劈**:火炬。使分离
*   **变径**:火炬。ARGMAX
*   **数学**:火炬。马特穆尔

在开始之前，让我们安装并导入 PyTorch。

# 1.火炬。常态

这个函数返回从独立的正态分布中抽取的随机数的张量，这些分布的平均值和标准偏差是给定的。

**参数:**

*   均值(张量/浮点):每个元素均值的张量/所有分布的均值
*   std(Tensor/float):每个元素标准偏差的张量/所有分布的标准偏差
*   大小(整数..):定义输出张量形状的整数序列。
*   发电机(火炬。发生器，可选)—用于采样的伪随机数发生器
*   out(张量，可选)-输出张量。

mean 和 std 的形状不需要匹配，但是每个张量的元素总数需要相同。

在上面使用参数均值的例子中，我们给出了一个预定义的张量，其均值将决定输出张量正态分布的均值。

使用参数 std，我们给出了一个预定义的张量，其标准偏差将遵循输出张量的正态分布。

创建了一个正态分布张量，其平均值与张量(100)相同。,110.)并且具有从张量(1，0，-0.1)导出的标准偏差

在上面的例子中，我们得到一个大小为 2 行 4 列的正态分布张量，平均值为 50，标准差为 5。

均值=0 的正态函数仅适用于大于 0.0 的标准差，因此它不会采用负标准差。

**总结**

torch 的正态函数可用于各种统计分析，其中需要正态分布张量来测试各种假设。

# 2.火炬。FROM_NUMPY

Torch.from_numpy 是用于将 numpy 数组转换为张量的函数。当使用机器或深度学习算法时，我们大多使用 Numpy 数组格式的数据，这就是为什么在使用真实数据集时，该函数非常重要。

要注意的是，由于返回的张量和 ndarray 共享相同的存储器，对张量的任何修改都将反映在 ndarray 中，反之亦然。返回的张量不可调整大小。

在上面的例子中，我们获取了一个 int64 数据类型的大小为(2，3)的数组，并使用 torch.from_numpy 函数将其更改为张量。

在上面的例子中，我们创建了两个 NumPy 数组，分别表示两种产品的价格和相应价格产生的销售额，然后将它们都转换成两个张量。

From_numpy 目前接受 dtypes 为 **numpy.float64、numpy.float32、numpy.float16、numpy.complex64、numpy.complex128、numpy.int64、numpy.int32、numpy.int16、numpy.int8、numpy.uint8 和 numpy.bool** 的 ndarray。因此，任何其他数据类型(如 string)都不可能被转换为 tensor，如上面的例子所示。

**总结**

在数据科学项目中，NumPy 数组是数据类型的首选，这个函数非常有用。

# 3.火炬。使分离

将张量分割成块，每个块是原始张量的一个视图。

**参数:**

*   张量(Tensor)-要分割的张量。
*   split _ size _ or _ sections(int)/(list(int))—单个块的大小或每个块的大小列表
*   dim(int)-沿其分割张量的维度。

如果 split_size_or_sections 是整数类型，那么张量将被分割成相等大小的块(如果可能的话),并且如果沿着给定维度 dim 的张量大小不能被 split_size 整除，则最后一个块将更小。

在上面的例子中，我们使用值为 2 的 split_size_or_section，即每个块的大小为 2，将我们的原始(5，2)张量分成 3 个大小为 2 的张量块，除了最后一个，由于缺少相等数量的元素，它只占用 1 个数组。

如果 split_size_or_sections 是一个列表，那么张量将根据 split_size_or_sections 拆分成 len(split_size_or_sections)个大小为 dim 的块。

在上面的例子中，我们将形状(3，4)的张量分成大小为 2 (len[1，2])的张量块，第一个块的大小为 1，第二个块的大小为 2。

上述示例给出了一个错误，因为我们试图将形状 3 行元素和 4 列元素的张量分别拆分为块大小为 1 和 3 的 2 个张量，这是不可能的，因为我们只有 3 个元素。

**总结**

当处理需要在张量的不同部分执行不同功能的函数和模块时，Torch.split 是一个非常有用的函数。

# 4.火炬。ARGMAX

返回输入张量中所有元素的最大值的索引。

**参数:**

*   输入(张量)-输入张量。
*   dim(int)-要减少的尺寸。如果没有，则返回展平输入的 argmax。
*   keep dim(bool)-输出张量是否保留 dim。如果 dim=None，则忽略。

在上面的例子中，我们创建了一个 shape (3，3)的随机张量，然后使用 armax()找到具有最大值的元素的索引值。

在上面的例子中，我们创建了一个 3d 张量，然后找到了张量中最大元素的索引以及每个维度/元素。

在上面的例子中，我们使用 torch 的 randn 函数创建了一个随机的 2 维张量，然后我们试图获得 3 维中最大元素的索引位置，这是不可能的，这就是为什么我们得到了“尺寸超出范围错误”

**总结**

argmax 函数是一个非常有用的函数，我们可以在处理大型张量数据，需要执行函数或者只需要元素最大值的索引位置时使用。

# 5 .火炬。马特穆尔

它的功能是执行 2 个张量相乘的数学运算，从而给出 2 个张量的矩阵乘积的输出。

**参数:**

*   输入(张量)-要相乘的第一个张量
*   other(Tensor)-要相乘的第二个张量。

在上述示例中，我们创建了 2 个 1 维张量，每个张量有 3 个元素/列，然后使用 matmul 函数计算其乘积，并将其存储在 1 维张量 t3 中。

在上面的例子中，我们创建了形状为[(3，2)]的 1 个张量矩阵 t1 和形状为[(2)]的另一个张量矩阵 t2，因此 t1 和 t2 的乘积产生了形状为[(3)]的第三个张量 t3。

在上面的例子中，我们得到了一个错误，因为我们试图用一个形状矩阵[(1，3)]乘以一个形状矩阵[(2，2)]，这是不可能的。

**总结**

根据张量的维数，我们可以在不同的用例中使用 matmul 函数，如下所示:

*   如果两个张量都是一维的，则返回点积(标量)。
*   如果两个参数都是二维的，则返回矩阵-矩阵乘积。
*   如果第一个参数是一维的，而第二个参数是二维的，则为了矩阵乘法的目的，会在它的维数前加上 1。矩阵相乘后，移除预先考虑的维度。
*   如果第一个参数是二维的，第二个参数是一维的，则返回矩阵矢量积。
*   如果两个参数都至少是一维的，并且至少有一个参数是 N 维的(其中 N > 2)，则返回成批矩阵乘法。如果第一个参数是一维的，则在它的维度前面加上 1，以便进行批量矩阵乘法，并在之后移除。如果第二个参数是一维的，则为了批量矩阵乘法的目的，会将 1 附加到它的维度上，并在之后移除。广播非矩阵(即批量)维度(因此必须是可广播的)。例如，如果输入是(j×1×n×n)张量，另一个是(k×n×n)张量，则 out 将是(j×k×n×n)张量。

# 结论

在这本笔记本中，我们看了 5 个有趣的随机选择的张量。可用于创建、转换、切片、归约和数学运算的 Torch 函数。每个函数都用工作和错误实例来说明。有关所有可用函数的完整列表，请参见 tensors 上的 PyTorch 官方文档。

Jupyter 笔记本链接:[https://jovian.ai/rupshakr/01-tensor-operations](https://jovian.ai/rupshakr/01-tensor-operations)

# 参考链接

提供你的参考资料和其他关于张量的有趣文章的链接

*   张量运算的官方文档:【https://pytorch.org/docs/stable/torch.html 
*   用 PyTorch 深度学习:Zero to GANs by jovian . ai:[https://jovian . ai/learn/deep-Learning-with-py torch-Zero to GANs](https://jovian.ai/learn/deep-learning-with-pytorch-zero-to-gans)
*   py torch:[https://en.wikipedia.org/wiki/PyTorch](https://jovian.ai/outlink?url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FPyTorch)
<html>
<head>
<title>Automating addition of authorization token in postman</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在postman中自动添加授权令牌</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/automating-addition-of-authorization-token-in-postman-7a3166337fb2?source=collection_archive---------17-----------------------#2021-05-27">https://medium.com/geekculture/automating-addition-of-authorization-token-in-postman-7a3166337fb2?source=collection_archive---------17-----------------------#2021-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c9fc9f4fc367d3e37b40ffd80762e858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qZ8oyBIIu1Qs--T05zgdg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Postman</figcaption></figure><p id="42c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我将展示如何设置postman集合，以便在向安全端点发出请求时自动包含授权令牌。</p><h1 id="e8f4" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">编辑收藏</h1><p id="712c" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">首先，我假设您已经创建了一个集合。我创建了一个叫做<em class="kv">的介质</em>。接下来，我们继续编辑这个集合。这会把我们带到邮差的这个地方。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/12e0957e9c8e4e0a262320f5c91c895d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uuRZJMOpr4M1pO2HeRPp9g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Collection details</figcaption></figure><p id="c9ad" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们从变量选项卡开始编辑。我们添加一个新的变量叫做<em class="kv">令牌。</em>我们计划在用户通过身份验证并收到回复令牌后，自动更新该变量。该值是随后将作为值在不记名令牌中传递的值。</p><p id="2066" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我们只将<em class="kv">的任意值</em>作为初始值</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/4dc0ae23abc05c00d1e3033fca97f7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RDwEajSeIpEAJP3SAhD1Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Adds new variable to collection</figcaption></figure><p id="9c69" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我们返回到授权选项卡，将类型更改为<em class="kv">不记名令牌。F </em>或令牌值，而不是简单地放置一个原始令牌，我们宁愿输入我们之前创建的集合变量。我们通过在<em class="kv">标记</em>的两边使用双花括号来做到这一点。这将使<em class="kv">不记名令牌</em>的值总是从我们创建的令牌变量中选取。</p><p id="35ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正如你所看到的，我们几乎完成了我们的实现，剩下的工作就是找到一种方法，一旦我们有了新的令牌，就更新令牌变量的值。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/ab01ee48480cb97c10f9f0b49f681753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZDzUqoU11Yht951rdryCQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Sets authorization type and its value</figcaption></figure><h1 id="15f5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">样本响应数据</h1><p id="afed" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">对于这个例子，我们有一个auth端点，它进行身份验证并返回带有这种格式数据的响应。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="c260" class="lg jt hi lc b fi lh li l lj lk">{</span><span id="97c5" class="lg jt hi lc b fi ll li l lj lk">"message": "User sucessfully login",</span><span id="abe8" class="lg jt hi lc b fi ll li l lj lk">"data": {</span><span id="9b8f" class="lg jt hi lc b fi ll li l lj lk">"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI4OThiN2UwNy01MmM3LTQ3ZWMtOTM5OS02NGNiMzE4MGExODEiLCJyb2xlIjoxLCJlbWFpbCI6ImNoaWJ1aWtlQHNwbGVldC5uZyIsImlhdCI6MTYyMjEyMDM3MiwiZXhwIjoxNjIyMTUwMzcyfQ.W8jMnWaOpNYJPWTU1je4h1br92XuCKSlYyrklHmzL5o"</span><span id="8e2c" class="lg jt hi lc b fi ll li l lj lk">},</span><span id="f6e1" class="lg jt hi lc b fi ll li l lj lk">"statusCode": 200</span><span id="1707" class="lg jt hi lc b fi ll li l lj lk">}</span></pre><p id="bba1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们需要将头中返回的对象中的这个令牌值传递给其他受保护并需要传递令牌的端点。</p><h1 id="81f4" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">在集合头中设置标记</h1><p id="f293" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">在<em class="kv"> Tests </em>选项卡中，我们将添加代码片段，使我们能够从响应中提取令牌并将其存储在集合令牌变量中。</p><p id="0f77" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为此，我们向端点发送一个带有我们的主体参数的post请求来验证我们。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/4b149b2439456b8f5730d76b7d379e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PWbGmWR8IPcXrPT4iUc1w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Adds code snippet to extract token</figcaption></figure><h1 id="ff2a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">试液</h1><p id="d208" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">一切就绪后，我们单击send按钮，这将返回数据对象和状态代码200。</p><p id="47a4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了检查我们的代码片段是否有效，我们返回到集合变量来查看token和wolla的当前值！集合变量标记已用返回的标记更新。</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/5120da1b23c3e510ff172d4eb8bece2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RpUkuiwoldl5itQDrmU57w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Token variable updated</figcaption></figure><h1 id="e600" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">测试安全路由</h1><p id="be8c" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">为了在其他受保护的端点中测试这一点，我们需要做最后一件事。</p><p id="d3f4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了让token有一个真实的来源，我们将Authorization中的类型设置为<strong class="iw hj"> Inherit auth from parent。</strong></p><p id="c512" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，每当发送请求时，该路由和该集合中的任何其他安全路由的报头中总是具有当前令牌。酷吧？耶！</p><figure class="kx ky kz la fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/019d48a4f609d052165eee93adaad9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Wrx4kRn3hPIe1FjaR4a3Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Set endpoint to use collection authorization</figcaption></figure><p id="f194" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这就是将我们的令牌自动添加到我们的头请求的全部内容。这不仅节省了我一些宝贵的时间，而且实施起来很有趣，也很有收获，哈哈。</p><p id="c7ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">玩得开心点！</p></div></div>    
</body>
</html>
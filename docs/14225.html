<html>
<head>
<title>Paypal Payment Gateway Integration With Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Paypal支付网关与Laravel的集成</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/paypal-payment-gateway-integration-with-laravel-ebebc7ccf470?source=collection_archive---------0-----------------------#2022-08-22">https://medium.com/geekculture/paypal-payment-gateway-integration-with-laravel-ebebc7ccf470?source=collection_archive---------0-----------------------#2022-08-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0f13960831c269cb526b16604abfbbdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JtOe9gHfsiP1ogKj4KmGg.png"/></div></div></figure><p id="35af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你好，朋友们，我祝你们身体健康，永远成功。这次我们将讨论如何连接Paypal和Laravel。这个教程对那些有销售网站的人来说非常有用。</p><p id="ad79" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Paypal是一种国际支付方式，适用于大多数支持在线转账的国家。Paypal提供了一种更快捷、更安全的转账方式。由于其受欢迎程度，大多数电子商务企业使用贝宝向客户收款。</p><p id="d57c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将把Paypal支付网关集成到一个Laravel应用程序中。这是一个电子商务网站，帮助使用Laravel框架作为后端技术。我们将从开始一步一步地经历它。</p><p id="f55a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请遵循以下步骤:</p><ol class=""><li id="c813" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">创建新项目</li><li id="6b89" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">使用Composer为Paypal支付网关安装软件包</li><li id="833c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建PayPal凭据。基金账户</li><li id="b6bf" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">配置包</li><li id="e23c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建路线</li><li id="d3cb" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建刀片文件以创建付款按钮</li><li id="2ace" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">运行应用程序</li></ol><p id="d012" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面我们只讨论教程。也可以在这里阅读其他教程:</p><p id="9662" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/en/error-handling-in-laravel/" rel="noopener ugc nofollow" target="_blank">Laravel中的错误处理</a></p><p id="f94b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/en/laravel-tutorial-laravel-eloquent-relationships/" rel="noopener ugc nofollow" target="_blank">拉勒维尔教程~拉勒维尔口才关系</a></p><p id="3403" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/en/creating-ratings-and-reviews-with-laravel/" rel="noopener ugc nofollow" target="_blank">用Laravel创建评分和评论</a></p><p id="85b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/en/creating-ratings-and-reviews-with-laravel/" rel="noopener ugc nofollow" target="_blank">使用Laravel创建评分和评论</a></p><h1 id="9b12" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">1.创建新项目</h1><p id="70f1" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">使用下面的命令创建一个新项目。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8be6" class="lp ke hi ll b fi lq lr l ls lt">composer create-project laravel/laravel paypal --prefer-dist</span></pre><p id="9c8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建新项目后，转到您的项目目录。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ad8a" class="lp ke hi ll b fi lq lr l ls lt">cd paypal</span></pre><h1 id="8cdb" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">2.使用Composer为Paypal支付网关安装软件包</h1><p id="d434" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">运行以下命令。</p><p id="5b28" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将为laravel 6，7，&amp; 8安装<a class="ae kc" href="https://srmklive.github.io/laravel-paypal/" rel="noopener ugc nofollow" target="_blank"> Laravel-Paypal </a></p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ce9d" class="lp ke hi ll b fi lq lr l ls lt">composer require srmklive/paypal:~3.0</span></pre><h1 id="4b26" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">3.创建PayPal凭据</h1><p id="99bf" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">安装paypal包后，我们需要paypal集成的client_id和secret_key，因此我们需要进入paypal开发者模式，并为其创建新的沙盒帐户。登录paypal后，您需要获得如下所示的客户端id和密钥。在获得客户端id和密钥之前，我们需要创建应用程序。所以，检查下面的截图，建立一个应用程序。登录到<a class="ae kc" href="https://www.paypal.com/signin?returnUri=https%3A%2F%2Fdeveloper.paypal.com%2Fdeveloper%2Fapplications" rel="noopener ugc nofollow" target="_blank">开发者仪表板。</a></p><p id="3de3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击创建应用程序。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/18f9d7c316cd06f084eea5d628d2098f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7ZGcg-bK_Q0ug28T"/></div></div></figure><p id="c11c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">填写创建的应用程序的名称。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/a55e2029624c4050fb88bb7f9cfde4d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QdHZbMTM4hnxHtkk"/></div></div></figure><p id="077d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您将获得将在应用程序中使用的客户端密钥和秘密密钥。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/cf24c35a6483d3c4b29c5913fa8acf75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s0MdGxcaTC4mo2ys"/></div></div></figure><h1 id="e49e" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">4.配置包</h1><p id="3341" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">包安装完成后，您打开项目并添加您在。环境文件。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e2ee" class="lp ke hi ll b fi lq lr l ls lt">PAYPAL_MODE=sandbox<br/>#Paypal sandbox credential<br/>PAYPAL_SANDBOX_CLIENT_ID=AXELAz06GFLR.............................QNu7zyjuYpFLu1g<br/>PAYPAL_SANDBOX_CLIENT_SECRET=EA9dinW1.............................PUzgVQCz7fK4tqe1-jLZCyHzZ0tDTRAx-6qJdIY933Q</span></pre><p id="4f98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想自定义软件包的默认配置选项，请运行下面的vendor:publish命令。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0673" class="lp ke hi ll b fi lq lr l ls lt">php artisan vendor:publish --provider "Srmklive\PayPal\Providers\PayPalServiceProvider"</span></pre><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/bd882921e3b59bc5c97129d1406250c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/0*78fimJBrscB_gjQx"/></div></figure><p id="ce15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将创建一个配置文件<strong class="is hj"> config/paypal.php </strong>，详细信息如下，您可以对其进行修改。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/56d5eb6eb958a6d9e3c7c6c0eb1f52a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KZjimfTUs0el7ZWL"/></div></div></figure><h1 id="bc38" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">5.创建路线</h1><p id="219e" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">现在我们需要创建一个应用程序路由，我们将在其上测试应用程序测试事务。打开route/web.php应用程序路由文件，并添加以下新路由。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="4da1" class="lp ke hi ll b fi lq lr l ls lt">&lt;?php</span><span id="0f88" class="lp ke hi ll b fi lz lr l ls lt">use Illuminate\Support\Facades\Route;<br/>use App\Http\Controllers\PayPalController;</span><span id="f54f" class="lp ke hi ll b fi lz lr l ls lt">Route::get('create-transaction', [PayPalController::<em class="ma">class</em>, 'createTransaction'])-&gt;name('createTransaction');<br/>Route::get('process-transaction', [PayPalController::<em class="ma">class</em>, 'processTransaction'])-&gt;name('processTransaction');<br/>Route::get('success-transaction', [PayPalController::<em class="ma">class</em>, 'successTransaction'])-&gt;name('successTransaction');<br/>Route::get('cancel-transaction', [PayPalController::<em class="ma">class</em>, 'cancelTransaction'])-&gt;name('cancelTransaction');</span></pre><ul class=""><li id="8453" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn mb ju jv jw bi translated">创建控制器</li></ul><p id="f5fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们创建一条路线之后，接下来我们使用php artisan创建一个控制器。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5e84" class="lp ke hi ll b fi lq lr l ls lt">php artisan make:controller PayPalController</span></pre><p id="04c3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在目录<code class="du mc md me ll b"><strong class="is hj">app/Http/Controllers/PayPalController.php</strong></code>中已经有了一个控制器。打开它并添加下面的代码。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0526" class="lp ke hi ll b fi lq lr l ls lt">&lt;?php</span><span id="ef52" class="lp ke hi ll b fi lz lr l ls lt">namespace App\Http\Controllers;</span><span id="36c0" class="lp ke hi ll b fi lz lr l ls lt">use Illuminate\Http\Request;<br/>use Srmklive\PayPal\Services\PayPal as PayPalClient;</span><span id="7b0a" class="lp ke hi ll b fi lz lr l ls lt">class PayPalController extends Controller<br/>{<br/>    /**<br/>     * create transaction.<br/>     *<br/>     * @return \Illuminate\Http\Response<br/>     */<br/>    public function createTransaction()<br/>    {<br/>        return view('transaction');<br/>    }</span><span id="e72e" class="lp ke hi ll b fi lz lr l ls lt">    /**<br/>     * process transaction.<br/>     *<br/>     * @return \Illuminate\Http\Response<br/>     */<br/>    public function processTransaction(Request $request)<br/>    {<br/>        $provider = new PayPalClient;<br/>        $provider-&gt;setApiCredentials(config('paypal'));<br/>        $paypalToken = $provider-&gt;getAccessToken();</span><span id="d326" class="lp ke hi ll b fi lz lr l ls lt">        $response = $provider-&gt;createOrder([<br/>            "intent" =&gt; "CAPTURE",<br/>            "application_context" =&gt; [<br/>                "return_url" =&gt; route('successTransaction'),<br/>                "cancel_url" =&gt; route('cancelTransaction'),<br/>            ],<br/>            "purchase_units" =&gt; [<br/>                0 =&gt; [<br/>                    "amount" =&gt; [<br/>                        "currency_code" =&gt; "USD",<br/>                        "value" =&gt; "1000.00"<br/>                    ]<br/>                ]<br/>            ]<br/>        ]);</span><span id="96df" class="lp ke hi ll b fi lz lr l ls lt">        if (isset($response['id']) &amp;&amp; $response['id'] != null) {</span><span id="403b" class="lp ke hi ll b fi lz lr l ls lt">            // redirect to approve href<br/>            foreach ($response['links'] as $links) {<br/>                if ($links['rel'] == 'approve') {<br/>                    return redirect()-&gt;away($links['href']);<br/>                }<br/>            }</span><span id="eaf6" class="lp ke hi ll b fi lz lr l ls lt">            return redirect()<br/>                -&gt;route('createTransaction')<br/>                -&gt;with('error', 'Something went wrong.');</span><span id="162a" class="lp ke hi ll b fi lz lr l ls lt">        } else {<br/>            return redirect()<br/>                -&gt;route('createTransaction')<br/>                -&gt;with('error', $response['message'] ?? 'Something went wrong.');<br/>        }<br/>    }</span><span id="cfa9" class="lp ke hi ll b fi lz lr l ls lt">    /**<br/>     * success transaction.<br/>     *<br/>     * @return \Illuminate\Http\Response<br/>     */<br/>    public function successTransaction(Request $request)<br/>    {<br/>        $provider = new PayPalClient;<br/>        $provider-&gt;setApiCredentials(config('paypal'));<br/>        $provider-&gt;getAccessToken();<br/>        $response = $provider-&gt;capturePaymentOrder($request['token']);</span><span id="8c63" class="lp ke hi ll b fi lz lr l ls lt">        if (isset($response['status']) &amp;&amp; $response['status'] == 'COMPLETED') {<br/>            return redirect()<br/>                -&gt;route('createTransaction')<br/>                -&gt;with('success', 'Transaction complete.');<br/>        } else {<br/>            return redirect()<br/>                -&gt;route('createTransaction')<br/>                -&gt;with('error', $response['message'] ?? 'Something went wrong.');<br/>        }<br/>    }</span><span id="006b" class="lp ke hi ll b fi lz lr l ls lt">    /**<br/>     * cancel transaction.<br/>     *<br/>     * @return \Illuminate\Http\Response<br/>     */<br/>    public function cancelTransaction(Request $request)<br/>    {<br/>        return redirect()<br/>            -&gt;route('createTransaction')<br/>            -&gt;with('error', $response['message'] ?? 'You have canceled the transaction.');<br/>    }<br/>}</span></pre><h1 id="f8f4" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">6.创建刀片文件以创建付款按钮</h1><p id="26c6" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">我们将创建一个视图来指导事务处理。创建刀片视图<strong class="is hj">resources/views/transaction . blade . PHP</strong>文件，并在其中添加以下代码。</p><h1 id="337b" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">7.运行应用程序</h1><p id="4934" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">Paypal整合完成。现在我们需要做一笔交易。使用下面的Artisan命令运行Laravel服务器。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8e68" class="lp ke hi ll b fi lq lr l ls lt">php artisan serve</span></pre><p id="e54f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用下面的网址打开它。要使用PayPal帐户支付，您需要创建一个帐户<a class="ae kc" href="https://developer.paypal.com/developer/accounts/" rel="noopener ugc nofollow" target="_blank">创建沙盒帐户</a>。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="af06" class="lp ke hi ll b fi lq lr l ls lt"><a class="ae kc" href="http://localhost:8000/create-transaction" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/create-transaction</a></span></pre><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/8a5199e6ffffca145b642a7aa8a4154f.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/0*W998jhKHvjoHN5nt"/></div></figure><p id="0cdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击支付，将显示支付表单。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/55c6c03cf92195b4f8e7952f503bb735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/0*L6IP9WoUaR_Axh0C"/></div></figure><p id="6738" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我提供的这个教程，希望是有用的。</p><p id="afbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢了。</p></div></div>    
</body>
</html>
<html>
<head>
<title>10 DataFrame Methods You Need to Know for Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学中你需要知道的10种数据框架方法</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/10-dataframe-methods-you-need-to-know-for-data-science-c8d91021636a?source=collection_archive---------11-----------------------#2021-10-04">https://medium.com/geekculture/10-dataframe-methods-you-need-to-know-for-data-science-c8d91021636a?source=collection_archive---------11-----------------------#2021-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0b74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">操作熊猫数据框架是许多数据项目的基础。我提供了您需要了解的10个最重要的数据框架方法和函数。跟着我解释它们，并为体育博彩模型准备一个NFL数据集！</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="a42b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">任何涉及大量数据的项目的基础都在准备阶段。清理、移动、验证和变形数据将为你以后的成功做好准备。下面列出的10种方法不是按等级排列的，而是按照我在这个特定用例中使用它们的顺序排列的。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/c5618d1b4e79f24ed191ac7fa2bc109c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwh4ElgPDfTIF0AfGxrdxQ.jpeg"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Can we accurately predict who will cover the spread?</figcaption></figure><p id="02aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我收集了10年的NFL比赛数据，最终目标是建立一个数据框架，准备创建一个模型来预测一支球队是否会覆盖价差。</p><p id="a85d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的起始数据中，每一行代表一个队和他们每场比赛各自的分数。为了获得模型的最佳数据，我们将为我们的数据创建几个新属性，然后将每条线上的主队和客场队集合在一起。我在谷歌上快速搜索了一下，收集了过去10年这种格式的excel文件。</p><p id="5d41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在下面看到的，我们有每场比赛的一些基本信息和一些关于赔率的统计数据。还不错。但是我们可以通过一些简单的函数让它变得更加有用。这是从工作目录中读取数据帧后，起始数据帧最初的样子:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ka"><img src="../Images/dd315fdc8027af6a7b2c4c78892a6c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WWcMazFOTB9cl7Q6Y57mlQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Initial NFL DataFrame</figcaption></figure><ol class=""><li id="9a96" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj"> where() </strong></li></ol><p id="69c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中()是一个numpy函数，它允许我们基于另一列中的参数在数据框中创建新列。由于我们数据的格式，我将使用where将跨页分隔到它自己的列中。在数据中，价差存储在主队的Close列中。它的工作方式类似于excel中的IF()语句。如果条件为真，则将第二个值传递给新列，如果条件为假，则将最终值放入新列。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kk"><img src="../Images/213269b593726d6383e0182c3f94cb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0s-nMoRF1Ed4EvzyqU7JoA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Creating a new Data Frame Column ‘Spread’ with only the spread values</figcaption></figure><p id="2fc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。gt()和lt() </strong></p><p id="2dd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大于和小于是非常有用的Pandas函数，用于将值与基线进行比较或创建供以后使用的指标。它根据比较结果返回一个布尔值。在这里，我创建了一个新的数据框列“Favorite_ML”。如果原始列“ML”小于0，则新创建的列将显示值True。热门将有负的货币线值，而冷门将有正的货币线值。使用lt()我们可以确定在每场比赛中哪一队更受青睐。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kl"><img src="../Images/cefb4d3d5a6985e7b14bb51e4c4d0373.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*AJv54kLzwzJxURH9kQCUaQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx">Creating a new Boolean column by using the less than function</figcaption></figure><p id="4e40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。diff() </strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es km"><img src="../Images/d431c611a6b38bfcc3d21a9fd78e48b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*B6RE0WCBMPYtCQNmW7lFDg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx">Creating a Win Margin column based on the ‘Final’ differences</figcaption></figure><p id="5327" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">diff()函数将从第1行减去第2行最后一列的值。我正在使用这个功能有效地获得每场比赛的胜率。它从客队得分中减去主队得分。这意味着每一个奇数行将有正确的胜利差额(正或负)，每一个偶数行将有两支参赛队的差额。</p><p id="e29a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过引用偶数索引列来过滤掉这些值，用这些值创建一个新的数据帧，然后将这些值移回我们的原始数据帧，放在一个新的和最终的winning margin列中，奇数索引列用零填充。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kn"><img src="../Images/df1f41e4632311edc188e6e1be4afc5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*bmWNfyAWLN_GnUpv3R-mMA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx">Filtering out the incorrect winning margin columns</figcaption></figure><p id="b50a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。drop() </strong></p><p id="d87f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建新的成功利润列(“W_M”)后，我们可以删除旧的。您可以一次指定多个列，但我们只是尝试删除“Win_Margin”。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ko"><img src="../Images/bf6db901b593fcd27e523eba0c2880a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*NWvtN3vQBgPKjGeBtLPKvQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx">Dropping the old Winning Margin column</figcaption></figure><p id="3e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">准备数据时进行清理对于消除数据中的噪声至关重要。这将使创建模型和使用数据集变得更加容易。这给我们带来了下一个功能:</p><p id="7468" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。替换()</strong></p><p id="eb41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用这个函数将球队名称标准化为相应的吉祥物，以提高我们的数据质量。一些团队在数据的每一年都有不同的排名。例如，纽约喷气机队有几年被列为“NYJets ”,另一年被列为“New York Jets”。正常化这将节省你的时间和困惑，因为你的进步。你可以在下面看到我为所有32个团队所做的:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kp"><img src="../Images/52f9ea3990300918d07c7bf5d81e65fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_DefFxcz1LD9xTCC16NMA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Cleaning the Team Names with replace()</figcaption></figure><p id="2919" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。drop_duplicates() </strong></p><p id="e4b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查我是否修改了所有的团队名称，我创建了一个只包含团队名称的新数据框架。然后，我删除了重复项，以检查两件事:1 .团队名称中有多少个唯一值，以及2。球队的名字和我预想的一样。NFL有32支球队，我们最终在df_names数据帧中有32个独特的球队名称。现在，我们可以返回到原始数据帧并继续。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kq"><img src="../Images/e9d027391ea3e79ad614a5c9fe503de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*tOZPIlV2OrhKHQCCeTQWVA.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx">Verifying that we have 32 unique team names</figcaption></figure><p id="286e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 7 &amp; 8。groupby()和get_group() </strong></p><p id="9479" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这些函数，我们将根据团队是在家(“H”)还是在外(“V”)来分割数据框。通过按主场或客场分隔数据帧，我们可以稍后合并我们新创建的主场和客场数据帧，以便在每场比赛中让两个队在同一行。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/0c803ce0eaeea7e0e7ed0d60bf77dd9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*P_wNEVVA4KU4st7Lxmwg6w.png"/></div></div></figure><p id="e13a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">产生的家庭数据帧:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ks"><img src="../Images/8ac92b6ebb9a54218f36d19815e44a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0vQFry6JfBySQdcyyAQMg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Home_df first five rows</figcaption></figure><p id="3f62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的客队数据框架:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ks"><img src="../Images/a915db98db7a52fc2f0aad0070cd71ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jfeCce-s4H7RlqJ9VTywug.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">Away_df first five rows:</figcaption></figure><p id="6a9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 9。merge() </strong></p><p id="2c61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在对上一步中的数据进行分组之前，我在数据帧中添加了一个“游戏ID”列。现在，在主客场数据帧上，我们将有一个键将它们合并在一起。</p><p id="0f22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于像这个用例这样的数据源和数据工程的结合，合并是非常有用的。Merge相当于SQL中的join。要连接的公共键包括日期、id和其他唯一标识符。一旦连接，我们将把合并数据集的结果称为“最终”。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kt"><img src="../Images/4fa411bc3997fed4588d2d23202f8e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArTTF4a_jIxIcjUIM-e29Q.png"/></div></div></figure><p id="b6d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 10。重命名()</strong></p><p id="40e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在复杂的工作之后，我们将通过清理属性名来结束。合并后，属性名称以“_x”或“_y”结尾，以区分来自何处。出于我们的目的，我们将x改为home，y改为away，以使数据帧更易于阅读。此外，我从合并中删除了一些冗余的列。你可以在同一个专栏中这样做，但是我把它分成了多行，以便于阅读。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ku"><img src="../Images/dcdc0cbecd8540dbd58d54d53b930899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Go_KNt5RDN5rMwIkD92jeg.png"/></div></div></figure><p id="1bc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最终数据帧！</strong></p><p id="0c33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">清除了难以阅读的属性名、不相关的列，并准备在许多不同的模型中使用！粘贴在下面的是最终数据帧的一个剪贴，给那些跟随的人！</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kv"><img src="../Images/aee45bbff23211495b61dfde586dbc94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gri2oq0nZs78r5UCFnb7pQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx">The Final cleaned DataFrame</figcaption></figure><p id="7c6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">后续步骤和跟进:</strong></p><p id="4c7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在清理和准备我们的数据之后，我们准备好进入下一个层次，创建一个模型。请继续关注我用这些数据预测NFL比赛的后续报道。</p><p id="a3e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！如有任何问题，请发微博给我@ZachEng1ish或发电子邮件给我zach.zlish@gmail.com！</p></div></div>    
</body>
</html>
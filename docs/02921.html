<html>
<head>
<title>Using Ensemble Methods To Predict Housing prices and Building Type</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用集合方法预测房价和建筑类型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-ensemble-methods-to-predict-housing-prices-and-building-type-8ad17e40503f?source=collection_archive---------47-----------------------#2021-05-27">https://medium.com/geekculture/using-ensemble-methods-to-predict-housing-prices-and-building-type-8ad17e40503f?source=collection_archive---------47-----------------------#2021-05-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9119" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Lambda学校第二单元组合项目</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0841bbc677986532f43faa464d0ec773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Psu7nDr2LvhWH4R6-Tqeg.jpeg"/></div></div></figure><h1 id="4480" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">预测房价和</strong>建筑类型</h1><p id="7f43" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">你有没有想过你的房子是否物有所值？你曾经尝试过预测当前或未来投资的住房市场吗？这是许多人试图做的事情，但很少有人成功。</p><p id="c56b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的四周里，我一直在研究机器学习。机器学习是一种自动建立分析模型的数据分析方法。它是人工智能的一个分支，基于这样一种想法，即系统可以从数据中学习，识别模式并在最少的人工干预下做出决策。我的计划是使用监督学习方法来预测房价和房屋类型。</p><p id="a8b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个月我深入研究了集成方法，这些技术创建多个模型，然后将它们组合起来以产生改进的结果。集成方法的一些例子是随机森林和梯度推进。现在是时候利用我的新知识，把我的计划付诸行动了！</p><h1 id="8c40" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据</h1><p id="6128" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我能够从Kaggle获得超过500万份俄罗斯房屋清单的数据。数据集的列中列出了日期、时间、纬度、经度、地区、建筑类型、对象类型、楼层、房间、面积、厨房面积和价格。这个大型数据集没有任何缺失值，但肯定有异常值。这些数据是从2018年至2021年俄罗斯的房地产搜索服务中解析出来的。俄罗斯房地产市场几年来一直处于增长阶段，这意味着你仍然可以找到价格非常有吸引力的房产，但未来增值的机会很大。下面是columns键。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/dbae8ab43b39e0cbf6365b9eacf40469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldAcIrp8DG1ijoiN4wjicw.png"/></div></div></figure><h1 id="def9" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据争论</h1><p id="af11" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在查看了我们的列和列键之后，是时候加载我们的数据了。数据加载后，我用pandas-profiling进行了一次自动化的探索性数据分析。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/cb0faf19aa767704e7240196f5754f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GJwJ7TYFe62oo1-jGn7Sw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/17c466aff45cf9dbe9bf9a5e9c1a3cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGwZzcZwimBgN7Ag53GuiQ.png"/></div></div></figure><p id="555a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">profile报告让我对我的数据以及需要对它做什么有了很好的了解。首先，对于超过5，000，000个观察值，数据修整是使用我的模型所必须的。接下来，我注意到我不需要时间列，因为日期列是我可以用于索引的。我还注意到我的数据集中有重复的数据要删除。知道需要做什么后，我开始写代码。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kv"><img src="../Images/993b854d9d3dc1b7ce71e5cda86ab43a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgtVdOoa6jkpVY8wjq9kcQ.png"/></div></div></figure><p id="162d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在解决了上述所有问题后，我的新数据集有704，495行和11列。现在是时候建立我们的模型和使用我们的数据了！</p><h1 id="6836" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">这是什么类型的问题？</h1><p id="b2d4" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">既然我们的数据已经准备好了，我们首先要问的是我们要解决什么样的问题，分类还是回归？房价是一个回归问题，意味着我们试图预测连续数量的产出。建筑类型是一个分类问题，这意味着我们试图预测离散类别标签0-5的输出，在我们的情况下，这是一个多类别分类问题。</p><h1 id="a96e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">建立基线</h1><p id="1f72" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在将数据帧分割成目标向量和特征矩阵之后，我们为每个问题建立基线。这条基线是我们用来比较模型的。在我们的建筑类型问题中，我们得到了基线的准确性分数。准确性是我们的模型预测正确的部分，这意味着我们想要尽可能高的准确性。另一方面，我们得到了价格预测问题的基线MAE。平均绝对误差(<strong class="ih hj"> MAE </strong>)是表达同一现象的成对观察值之间误差的度量，意味着我们希望MAE尽可能低。最后，我们将查看价格预测的R评估指标。R-squared是一种统计度量，表示回归模型中由自变量或变量解释的因变量方差的比例。这是一个0-1的指标，我们需要高分。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/b2e836bef2731a6bb86ebed35eb8055f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*BRTWDgPjoUEyNxYWM0liSw.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/c897c346adb833e1b538964bd28ec3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*_EqINM3faFpgbVPI_hmp7w.png"/></div></figure><h1 id="968d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">装袋和增压</h1><p id="6087" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">两种最流行的集合方法是打包和提升。在这个项目中，我将使用它们来为每个问题找到最佳模型。当目标是减少决策树分类器的方差时，使用Bagging。这里的目标是从随机选择的训练样本中创建几个数据子集。子集数据的每个集合被用来训练他们的决策树。结果，我们得到了不同模型的集合。使用来自不同树的所有预测的平均值，这比单个决策树分类器更健壮。随机森林就是一个装袋模型的例子。</p><p id="30fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">增强用于创建预测器的集合。在这种技术中，学习者是顺序学习的，早期的学习者将简单的模型与数据拟合，然后分析数据的错误。连续的树(随机样本)是合适的，并且在每一步，目标是从先前的树提高准确性。当一个输入被一个假设错误分类时，它的权重会增加，以便下一个假设更有可能将其正确分类。这个过程将弱学习者转换成表现更好的模型，并且通常是更准确的模型。XGBoost就是一个增强模型的例子。</p><h1 id="dcd9" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">制作模型</h1><p id="107d" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">对于价格预测的任务，我决定运行多个模型并比较它们的得分。我用了线性回归，岭回归，随机森林回归，xgb回归。运行我的模型后，我得到了下面的分数，显示了随机森林回归和xgb回归远远优于线性和岭回归方法。在这些模型中，我们还可以看到我们的MAE从原始基线得分显著下降。</p><div class="je jf jg jh fd ab cb"><figure class="ky ji kz la lb lc ld paragraph-image"><img src="../Images/168a491e84f7db70e449c6ef9b4dcdfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*BqJOW7M9LOG3ERFDvR4SqA.png"/></figure><figure class="ky ji le la lb lc ld paragraph-image"><img src="../Images/72c08ab3e77caf927033a952a88d1d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*WeynOcluU-wqwHQ6R_aYaw.png"/></figure></div><p id="f16b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我切换到我的另一个预测建筑类型的任务，运行我的随机森林分类器和XGBclassifier模型。</p><div class="je jf jg jh fd ab cb"><figure class="ky ji lf la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/1ac128d971f147374e02728377f95aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*61-MSXPFd1qs6Z74zKd2oA.png"/></div></figure><figure class="ky ji lg la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/6e82f0b252eb4424b1e1c405ba1f6c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*twrf11oJbBnpvxQsTEHfFg.png"/></div></figure></div><p id="4850" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，两个模型的准确度分数都显著高于我们的基线0.37。现在你可能认为随机森林模型是更好的选择，但是你错了。随机森林模型确实具有更高的验证精度，但是由于训练精度为0.99，我们可以看出该模型过度拟合了。过度拟合是指模型对训练数据建模得太好。当模型学习训练数据中的细节和噪声达到对新数据的模型性能产生负面影响的程度时，就会发生过度拟合。</p><h1 id="1b5b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">模型调整</strong></h1><p id="7686" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">针对每个问题建立并运行模型后，是时候选择最好的模型并对其进行调优了。调整是在不过度拟合或产生过高方差的情况下最大化模型性能的过程。这是通过选择适当的超参数并测试它们来实现的。对于我们的价格预测问题，我们看到随机森林和XGB模型效果最好，但随机森林过度拟合。我决定对XGB模型进行调优，以获得可能的最佳指标。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/b204dbb872f45ed3855e4e7df2ed38fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*rEY7poLKrpEXqGnGIE8PuA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/6288e5be1d0ab2e1cd97c54415e5032b.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*ftSnsS7c5ihKTtlVLRyIJw.png"/></div></figure><p id="6c1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行随机搜索cv后，我能够找到最佳的超参数来使用。在调整XGB模型超参数并运行它之后，与我们之前的分数和基线相比，我们获得了一些惊人的评估指标。</p><p id="38b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在回到我们的建筑类型问题。如前所述，随机森林模型过拟合，所以我决定为这个多类分类问题调整XGB模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/d3f439b06cb57ec4a0a8bba84c6f557c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1nSSg_2sBVC_SB5HQV_Gw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lk"><img src="../Images/939d9818062fd920fb2a0f439b63d2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*hHNwYW5-a_qVLpcGPBnZmw.png"/></div></figure><p id="9a5a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就像以前一样，我使用随机搜索cv来找到最佳超参数，并将它们插入我们的模型中。我们再次取得了迄今为止最好的成绩。</p><h1 id="6729" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">排列重要性</strong></h1><p id="214a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">现在我们已经针对每个问题调整并运行了模型，让我们看看每个模型的排列重要性。置换特征重要性被定义为当单个特征值被随机打乱时模型得分的减少。该过程打破了特征和目标之间的关系，因此模型分数的下降指示了模型对特征的依赖程度。左边是排列特征对我们的价格预测的重要性，右边是我们的建筑类型。</p><div class="je jf jg jh fd ab cb"><figure class="ky ji ll la lb lc ld paragraph-image"><img src="../Images/bdbcc5d93bcb49ff7a95664af2c1e5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*uPpWGdhFRW2pA0KMuw7_Eg.png"/></figure><figure class="ky ji lm la lb lc ld paragraph-image"><img src="../Images/8e9a0879e7cac374047d13482afb2e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*MA8K6k8Ste6cX44zMpB8_Q.png"/></figure></div><h1 id="cbce" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">最重要的功能</h1><p id="5418" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">下面是预测我们两个问题的最重要的特征列表。左边是我们的价格预测问题的最重要特征，右边是我们的建筑类型预测问题。</p><div class="je jf jg jh fd ab cb"><figure class="ky ji ln la lb lc ld paragraph-image"><img src="../Images/05904fba7fe96854262e48a1363a158c.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*IZIpeTWU-9tao-ArCfNxgg.png"/></figure><figure class="ky ji lo la lb lc ld paragraph-image"><img src="../Images/e92ba1d1cbd69a96c346e2f6e12efe77.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*b0XW51An2k_OGzgdL90tNg.png"/></figure></div><h1 id="6ad7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">分类报告</h1><p id="bf69" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">顾名思义，分类报告仅针对分类问题，以下是针对我们的建筑类型问题的报告。简单来说，0-5代表我们不同的建筑类型。精确度告诉我们有多少比例的肯定识别实际上是正确的。而回忆告诉我们正确识别实际阳性的比例。F1分数结合了精确度和召回率。相对于特定的正面类别，F1分数可以被解释为精确度和召回率的加权平均值，其中F1分数在1处达到其最佳值，在0处达到其最差值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/daa9a38ae3956d1aa70b53a67a26eac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*05mDQGn6mhhY3OKr3zYuCg.png"/></div></figure><h1 id="ecb1" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">混淆矩阵</h1><p id="f1a0" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">最后，我们来到了我们的最后一个度量——混淆矩阵。这是另一个矩阵，只处理分类问题，所以这代表了我们的建筑类型问题。在查看了这个混淆矩阵后，我们可以看到我们的模型在预测建筑类型方面表现良好，大多数建筑类型是1、2和3。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/8d6a9708574963decf5a21a6eb8f8f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*YycLGGxY4x2ngursRWIygw.png"/></div></figure><h1 id="d5ad" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="9c14" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">总之，过去的四周太棒了，我学到了很多关于机器学习和预测模型的知识。虽然最终产品可能看起来不错，但我在这个项目中遇到了很多小问题。这些问题帮助我学习并获得了对机器学习世界的宝贵见解。学习并拥有预测房价和建筑类型的能力是我拥有的最接近超能力的东西。这个项目除了让我对机器学习和人工智能感到兴奋之外，什么也没做。我希望把这种热情带到接下来的几个月，继续喂饱我的好奇心！</p></div></div>    
</body>
</html>
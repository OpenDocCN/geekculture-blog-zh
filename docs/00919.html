<html>
<head>
<title>Create Your Screenshots for the Stores With Python and PIL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和PIL创建你的商店截图</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-your-screenshots-for-the-stores-with-python-and-pil-c11e0dc8c07d?source=collection_archive---------13-----------------------#2021-03-19">https://medium.com/geekculture/create-your-screenshots-for-the-stores-with-python-and-pil-c11e0dc8c07d?source=collection_archive---------13-----------------------#2021-03-19</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><p id="ab5a" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我已经为play store和app store发布了移动应用。但是格式化商店的截图是一项漫长而无聊的任务。你需要裁剪你的截图，添加背景和一些文字来突出你的按键功能。你必须为每个不同的屏幕尺寸重复它。并对您的应用程序支持的所有语言重复此操作。</p><p id="105f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">因此，作为一名懒惰的开发人员，我编写了一个python脚本来自动执行这些任务，并生成准备上传到商店的图像。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="es et je"><img src="../Images/8c68be43f4cc4781ccb0ca8ffc2c14fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vic6cQBDFxcQ0LtR4y6IDg.png"/></div></div></figure><p id="9ce5" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">遵循本文需要的唯一包是<code class="dv jq jr js jt b">Pillow</code>或<code class="dv jq jr js jt b">PIL</code>。但是我建议不要用<code class="dv jq jr js jt b">PIL</code>，因为它没有保养。</p><p id="ce5f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">在本文的第一部分，我将使用一个iPhone模拟器的截图。并且将专注于为6.5英寸屏幕设备创建图像，所以我必须创建一个1284 x 2778的图像。</p><p id="e8a8" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">你可以在这里找到苹果询问的所有设备尺寸<a class="ae ju" href="https://help.apple.com/app-store-connect/#/devd274dd925" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="c605" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">打开并显示您的截图</h1><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="7e1c" class="kx jw hj jt b fj ky kz l la lb">from PIL import Image<br/><br/># Load your image<br/>screenshot = Image.open(PATH_TO_YOUR_IMAGE)<br/># Open a window to show it<br/>screenshot.show()</span><span id="db77" class="kx jw hj jt b fj lc kz l la lb"># You can get the size of you image with<br/>width, height = screenshot.size</span></pre><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ld"><img src="../Images/77a9fe8ce0bfbeb71380c2eca1eb4c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*m8_P4MDMLHfbgrPnJim6Kg.png"/></div><figcaption class="le lf eu es et lg lh bd b be z dy">The original screenshot</figcaption></figure><h1 id="7042" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">裁剪截图</h1><p id="7d53" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">首先，我们将删除模拟器的工具栏</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="3513" class="kx jw hj jt b fj ky kz l la lb"># The parameter is a tuple of fours numbers, defining the left, top, right, and bottom pixel coordinates. This box correspond to the image you want to keep<br/>screenshot = screenshot.crop((0, 110, width, height))</span></pre><p id="5e56" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我使用110作为顶部值，从顶部移除110个像素。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ld"><img src="../Images/d6c8ccdf49345d58dfa0343ee480fcfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*aELiPFbrSzhQGg3jEIs3QA.png"/></div><figcaption class="le lf eu es et lg lh bd b be z dy">Screenshot without the toolbar</figcaption></figure><h1 id="fd21" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">添加背景</h1><p id="2d8a" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">让我们创建一个背景，并添加粘贴我们的截图。你也可以加载你自己的图像或者创建一个渐变。</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="4d3d" class="kx jw hj jt b fj ky kz l la lb">store_width = 1284<br/>store_height = 2778<br/>width, height = screenshot.size<br/><br/># Create an image with the desired size for the store<br/>im = Image.new('RGBA', (store_width, store_height), color=(232, 106, 28))<br/><br/># Paste the screenshot on the background and center it<br/>im.paste(screenshot, (<br/>    int(store_width/2 - width/2),<br/>    int(store_height/2 - height/2)<br/>), screenshot)</span></pre><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ln"><img src="../Images/76fe39a71859178abe5cc065a2a14288.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*7iMb8AFLL1ABoTuR6pmWlg.png"/></div><figcaption class="le lf eu es et lg lh bd b be z dy">The screenshot on our wonderful orange background</figcaption></figure><p id="28d7" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">下面是制作垂直或水平渐变的代码:<a class="ae ju" href="https://stackoverflow.com/questions/32530345/pil-generating-vertical-gradient-image" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/32530345/pil-generating-vertical-gradient-image</a></p><p id="74d7" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">下面是一个如何制作对角线渐变的要领:<a class="ae ju" href="https://gist.github.com/weihanglo/1e754ec47fdd683a42fdf6a272904535" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Wei anglo/1e 754 EC 47 FDD 683 a 42 fdf 6a 272904535</a></p><h1 id="9f2e" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">调整图像大小</h1><p id="f438" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">我们的截图似乎有点小，所以我们会在粘贴到背景之前调整它的大小。</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="a85f" class="kx jw hj jt b fj ky kz l la lb">def resize(im, ratio):<br/>    w, h = im.size<br/>    w = int(w * ratio)<br/>    h = int(h * ratio)<br/>    im = im.resize((w, h), Image.ANTIALIAS)<br/>    return im</span><span id="9377" class="kx jw hj jt b fj lc kz l la lb">screenshot = resize(screenshot, ratio=1.4)</span></pre><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ln"><img src="../Images/8fc02376fc526b28a2138ee3efc098d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*zRUJtNpMDZuHc5n6dckJjw.png"/></div></figure><h1 id="caa0" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">添加标题</h1><p id="4ce8" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">这个方法创建了一个文本层，并将其添加到我们的商店图像中</p><p id="0316" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">你必须给出一个字体文件的路径。</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="6d7c" class="kx jw hj jt b fj ky kz l la lb">def add_text(im, text, font_path, font_size=120, text_color=(0, 0, 0)):<br/>    width, height = im.size<br/><br/>    txt_image = Image.new('RGBA', (width, height), (0, 0, 0, 0))<br/>    font = ImageFont.truetype(font_path, font_size)<br/>    draw = ImageDraw.Draw(txt_image)<br/>    w, h = draw.textsize(text, font=font)<br/><br/>    text_position = ((width-w)/2, 75)<br/>    draw.multiline_text(text_position, text, text_color, font=font, align="center")<br/><br/>    im = Image.composite(im, txt_image, ImageChops.invert(txt_image))<br/><br/>    return im</span><span id="4fc3" class="kx jw hj jt b fj lc kz l la lb">im = add_text(im, "My great caption", font_path=r'font/coolvetica condensed rg.ttf')</span></pre><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ln"><img src="../Images/0951bd1eb5b14168b4b9ef70eb086e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*OJni8IUNMjvk5KtgRqxj6Q.png"/></div></figure><h1 id="4cb6" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">每个截图的结构和循环</h1><p id="e32d" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">我把我的截图组织成这样:</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="285e" class="kx jw hj jt b fj ky kz l la lb">- English<br/>    - Android<br/>        - screenshot_1.png<br/>        - screenshot_2.png<br/>        - ...<br/>    - Ipad<br/>        - screenshot_1.png<br/>        - ...<br/>    - Iphone 5.5<br/>        - ...<br/>    - Iphone 6.5<br/>    - ...<br/><br/>- French<br/>    - ...<br/>- Spanish<br/>    - ...<br/>- ...</span></pre><p id="3089" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">所以我们可以用操作系统包遍历这些文件夹。</p><p id="ac07" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我做了两个小函数。<code class="dv jq jr js jt b">lisdir</code> <em class="lo"> </em>返回给定文件夹的所有文件和文件夹，隐藏的除外(比如mac。DS_Store)。一个<code class="dv jq jr js jt b">save_screenshot</code>方法将保存你的图像，并在需要时创建文件夹。</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="f332" class="kx jw hj jt b fj ky kz l la lb">import os<br/><br/><br/>def listdir(path):<br/>    return [f for f in os.listdir(path) if not f.startswith('.')]<br/><br/><br/>def save_screenshot(img, path, file_name):<br/>    # Create folders<br/>    try:<br/>        os.makedirs(path)<br/>    except:<br/>        pass<br/>    # Save image<br/>    img.save(f"{path}/{file_name}")<br/><br/><br/>PATH = r"PATH_TO_YOUR_SCREENSHOTS_FOLDER"</span><span id="92c1" class="kx jw hj jt b fj lc kz l la lb">languages_folders = listdir(PATH)<br/># For every langagues<br/>for languages_folder in languages_folders:<br/>    device_folders = listdir(f"{PATH}/{languages_folder}/")<br/><br/>    # For every devices folders<br/>    for device_folder in device_folders:<br/>        # Get list of all the screenshot in the folder<br/>        screens = listdir(f"{PATH}/{languages_folder}/{device_folder}")<br/><br/>        # For every screenshots<br/>        for screen in screens:<br/>            screenshot = Image.open(PATH)<br/><br/>            # Do our transformations on our screenshots<br/>            # You can also do some condition do some conditions,   depending on the screenshot to ajuste size, caption ...</span><span id="0ac6" class="kx jw hj jt b fj lc kz l la lb">            # Save the screenshot<br/>            save_screenshot(screenshot, PATH_OUTPUT_FOLDER, file_name=screen)</span></pre><h1 id="b8ce" class="jv jw hj bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">截屏格式包</h1><p id="4b01" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">我做了一个<a class="ae ju" href="https://pypi.org/project/ScreenshotFormat/" rel="noopener ugc nofollow" target="_blank">包</a>来包装我们在这里讨论的不同方法。并添加了一些其他工具和助手，如不同的梯度背景，帮助定位图像，添加文字与光晕，列出所有不同的屏幕截图所需的苹果大小…</p><p id="e53f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">它看起来是这样的:</p><pre class="jf jg jh ji fe kt jt ku kv aw kw bi"><span id="a1af" class="kx jw hj jt b fj ky kz l la lb">from ScreenshotFormat import ScreenshotFormat, StoreSizeName, BackgroundType, Position</span><span id="cee7" class="kx jw hj jt b fj lc kz l la lb">PATH_TO_YOUR_IMAGE = ""<br/>PATH_TO_YOUR_FONT = r""<br/>OUTPUT_PATH = r""</span><span id="e7de" class="kx jw hj jt b fj lc kz l la lb"># Instantiate the helper with our screenshot and the desired size for the store<br/>helper = ScreenshotFormat(screenshot_path=PATH_TO_YOUR_IMAGE, store_size_name=StoreSizeName.iphone_6_5)</span><span id="e487" class="kx jw hj jt b fj lc kz l la lb">helper.crop_screenshot(top=110)<br/>helper.resize_screenshot(zoom_ratio=1.3)<br/><br/># Create an image, it will have the size of on iphone 6.5<br/>background = helper.create_background(type_=BackgroundType.diagonal_gradient_right, color_palette=[<br/>    (255, 0, 0),<br/>    (255, 255, 0),<br/>    (255, 255, 255),<br/>])<br/><br/># Adding text<br/>text_position = (Position.center, 150)<br/>text = "My Caption"<br/>background = helper.add_text_with_halo(background,<br/>                                       text=text,<br/>                                       position=text_position,<br/>                                       color=(0, 0, 0),<br/>                                       halo_col=(255, 255, 255),<br/>                                       font_path=PATH_TO_YOUR_FONT,<br/>                                       font_size=120)<br/><br/># Adding screenshot on our background<br/>position = (Position.center, helper.store_height - helper.screenshot_height - 100)<br/>final_image = helper.apply_screenshot_on_background(background, position)<br/><br/># Save image<br/>ScreenshotFormat.save(img=final_image, path=OUTPUT_PATH, file_name="MyScreenshot.jpg")</span></pre><figure class="jf jg jh ji fe jj es et paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="es et lp"><img src="../Images/a93b973bb3d2f5553bbdf879f3d20cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*mBMR6XbftGOxZWOWDWmzxA.png"/></div></div></figure><h2 id="c45b" class="kx jw hj bd jx lq lr ls kb lt lu lv kf ir lw lx kj iv ly lz kn iz ma mb kr mc bi translated">小费</h2><p id="f6de" class="pw-post-body-paragraph ig ih hj ii b ij li il im in lj ip iq ir lk it iu iv ll ix iy iz lm jb jc jd hc bi translated">在截图名称的开头添加一个数字，它会自动对它们进行排序，并使上传到商店变得更加容易。</p><p id="776f" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">感谢阅读</p></div></div>    
</body>
</html>
<html>
<head>
<title>ETL on Google Cloud with Dataprep</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Dataprep在Google Cloud上进行ETL</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/etl-on-google-cloud-with-dataprep-ab3c4c2e2cd2?source=collection_archive---------16-----------------------#2021-07-05">https://medium.com/geekculture/etl-on-google-cloud-with-dataprep-ab3c4c2e2cd2?source=collection_archive---------16-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/192d6ffb92603223576dcf13359bd519.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/0*UFBl8qmTBU0oBHrI"/></div><figcaption class="hn ho et er es hp hq bd b be z dx">image source: Motionwares blog</figcaption></figure><div class=""/><p id="843c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">注意:假设读者对大数据和谷歌云平台，或者至少任何云平台是如何工作的有一个基本的了解。</em></p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="9146" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">什么是ETL？</h1><p id="5dba" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">ETL是指数据集成中的三个顺序步骤:<strong class="is hu">提取、</strong>转换、<strong class="is hu">加载</strong>。该过程用于混合来自不同来源的数据，如关系数据库、平面文件、web服务、RSS提要、XML、JSON和物联网设备。在这一系列动作的过程中，从一个或多个源中提取数据，将数据转换成适于分析的统一格式，并将数据加载到数据仓库或任何其他集成数据仓库中。</p><p id="b352" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ETL使企业能够从各种不同的来源收集大量的数据，并将它们集中在一个单一的集中系统中，并有效地将其转化为可操作的商业智能。</p><p id="5ae8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kz" href="https://en.wikipedia.org/wiki/Extract,_load,_transform" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">提取、加载、转换(ELT) </strong> </a>是ETL的替代方案，用于在转换阶段之前将数据以原始格式存储在数据湖中。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="74a3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">Google Cloud data prep</strong><br/>data prep由Trifacta设计，是一款完全托管的Google Cloud数据服务，用于探索、清理、结构化和丰富结构化和非结构化数据。</p><p id="e643" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Dataprep是高度可视化和交互式的。这允许用户通过将文件转换成表格和可视化表示来可视化地浏览数据。操纵数据变得更加容易，从而加快了整个过程。</p><p id="25a4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据提取和转换可以是一轮编码，但是这很费时并且容易出错。凭借其开发良好的UI，Dataprep建议进行数据转换，并创建一个更有效的工作流，而没有编写代码的麻烦。</p><p id="be91" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了运行我们的数据处理管道，我们将依赖<strong class="is hu">谷歌云数据流。</strong> Dataflow是一个完全托管的服务，用于在<a class="ae kz" href="https://en.wikipedia.org/wiki/Google_Cloud_Platform" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>生态系统内执行<a class="ae kz" href="https://en.wikipedia.org/wiki/Apache_Beam" rel="noopener ugc nofollow" target="_blank"> Apache Beam </a>管道。它无需服务器，经济高效，速度快，可以处理流和批处理作业。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="8661" class="jw jx ht bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">Dataprep ELT流水线架构</h1><p id="bf31" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">打开Google Cloud控制台并登录。<br/>您可以点击左上角的导航菜单，查看Google Cloud产品和服务列表。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/2d560b73fd04e246ea6c10db37bfdcc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5pjyeFOaP8VCVI5Ap8utkA.png"/></div></div></figure><p id="6c46" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是启用Dataprep API。在云控制台中，在顶部搜索栏中输入“Dataprep API ”,然后单击Dataprep API的结果。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es lj"><img src="../Images/642072f544f9d2398000e9d87f358214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*5VsweXJ-dWj7Ly23mTg27Q.png"/></div></figure><h1 id="d1a9" class="jw jx ht bd jy jz lk kb kc kd ll kf kg kh lm kj kk kl ln kn ko kp lo kr ks kt bi translated">第一步:提取过程</h1><p id="0990" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">在ETL过程的第一步中，结构化和非结构化数据被导入并整合到一个存储库中。数据可以从不同的来源提取，例如:</p><ol class=""><li id="e42f" class="lp lq ht is b it iu ix iy jb lr jf ls jj lt jn lu lv lw lx bi translated">内部环境。</li><li id="48a6" class="lp lq ht is b it ly ix lz jb ma jf mb jj mc jn lu lv lw lx bi translated">云存储。</li><li id="188f" class="lp lq ht is b it ly ix lz jb ma jf mb jj mc jn lu lv lw lx bi translated">数据仓库。</li><li id="6370" class="lp lq ht is b it ly ix lz jb ma jf mb jj mc jn lu lv lw lx bi translated">平面文件。</li><li id="debc" class="lp lq ht is b it ly ix lz jb ma jf mb jj mc jn lu lv lw lx bi translated">数据库。</li><li id="8406" class="lp lq ht is b it ly ix lz jb ma jf mb jj mc jn lu lv lw lx bi translated">应用程序</li></ol><figure class="lb lc ld le fd hk er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es md"><img src="../Images/4bd24e1fcd249cb35b93cff06df850ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vGe2jYFW8gXFku5A.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">image source: <a class="ae kz" href="https://cloud.google.com/dataprep" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/dataprep</a></figcaption></figure><p id="0b32" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击导航菜单，然后向下滚动到大数据，选择Dataprep。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/fbee73fc9a5f196a6d11f0d6b4865d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*gNWgo5h8dM6o03z3-kqsUw.png"/></div></figure><p id="bbc6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Dataprep主页上，单击Import Data开始摄取阶段。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/8007308388f2176b4642ad71952ba05d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*g1BR-E4YVNAZqIU9hDFQlw.png"/></div></figure><p id="65fb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以拖放或从本地存储库中选择一个文件，并从Google云存储中选择，直接从Google Sheets和/或BigQuery中选择。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/8e63befa4d6c0913a2c15780baeadf2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*FM1u2fZsoIPSQOV6JbqPFw.png"/></div></figure><p id="d4f4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过单击左下角的New按钮，还可以从其他来源访问数据集，如Microsoft SQL Server、Oracle database、IBM DB2、Cassandra和Salesforce等云应用程序。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/c37d5478e0533e62029738c314fc2b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*vHlzRRBpa8AXHd2vymiz_g.png"/></div></figure><p id="963d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者，您可以单击“创建流程”开始该过程。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es mf"><img src="../Images/013166d510f0d67577f53077ff0251b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*UQvEJS3Y1DqG2bebSrjdlQ.png"/></div></figure><p id="4ee7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在提取阶段添加来自不同来源的数据。选择您的数据后，点击<strong class="is hu">在新流程中使用</strong> …</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/2e3f29ff310adecc4bdf6df2bade4f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*7JKM5tIzlHXC6mvnMxJWlQ.png"/></div></figure><p id="6de4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您的数据集以表格和条形图的形式显示在Transformer网格中。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es mg"><img src="../Images/06165177457ba95437cfb936dc224629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*qmqoIL42SIGORB24Q6fJFA.png"/></div></figure><h1 id="b2de" class="jw jx ht bd jy jz lk kb kc kd ll kf kg kh lm kj kk kl ln kn ko kp lo kr ks kt bi translated">第二步:转变过程</h1><p id="e90e" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">转换通常被认为是ETL过程中最重要的部分。数据转换创建了不同数据集之间的兼容性，并增强了数据集的质量和完整性。</p><p id="c02c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Dataprep允许您使用点击交互来轻松清理数据。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es mh"><img src="../Images/2f9dc1ff1be9d10fcd1514d0acc26e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*JhlmIZhUCYvtzPCvUlTj2A.png"/></div></figure><p id="f05e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Transformer grid提供了关于数据集的可视信息，并建议在每次用户交互时进行转换。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="ab fe cl mi"><img src="../Images/afacdd4efb3ea21feaf81c2c1f6753e9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RHVND4jTmfHU9VrvKXqIBw.png"/></div></figure><p id="43f6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上图中，数据类型显示在左上角(ABC表示字符串格式)，列名为Index。每一列的右上角都有一个列菜单选项，这是启动转换过程的一个简单方法。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/add91eb544453c2ded7e3aeacf45cdbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*s2DOyqIWGtOjDOBHZP7leA.png"/></div></figure><p id="4159" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这些集合的下面是水平的数据质量条，它指示每一列中数据的<em class="jo">健康</em>状态:灰色点表示丢失的值，而红色表示不匹配的值。条形图聊天以竖条的形式显示数据，竖条的高度与其代表的值成比例。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/54585c783321ecb3e4b9b81170808932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_gGy2b4g_fqW-3g3a7fldQ.png"/></div></figure><p id="e9c6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们使用配方来转换数据集。配方是将所选数据集转换为新数据集的一系列步骤。这些步骤可能包括数学运算、标准化、重复数据删除、清理不匹配和缺失的数据、结构化、排序、合并数据集以及其他提高数据集质量的任务。菜谱使用了<a class="ae kz" href="https://docs.trifacta.com/display/DP/Wrangle+Language" rel="noopener ugc nofollow" target="_blank">的扯皮语言</a>。</p><p id="ad9f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以选择transformer网格顶部的一个图标来转换一个或多个列。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es mj"><img src="../Images/d30fbfafaf3983c3feeacc7ed9d42535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*-Oe77_Pzucxlt0TSRi7j7w.png"/></div></figure><p id="1ce0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以在右边的面板中查看所有的转换步骤。单击编辑配方以浏览和修改配方。</p><p id="8c65" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，所有步骤只对浏览器上显示的数据应用转换。所有转换都不会修改源数据。</p><p id="738b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您对转换感到满意，下一步就是通过使用数据流运行所有配方步骤并发布新的数据输出来生成结果。</p><p id="70bc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击右上角的<strong class="is hu">运行</strong>运行所有配方步骤。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/54585c783321ecb3e4b9b81170808932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_gGy2b4g_fqW-3g3a7fldQ.png"/></div></figure><p id="202b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择<strong class="is hu">数据流</strong>，点击<strong class="is hu">运行</strong>。</p><p id="8b84" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在作业工作区中查看当前作业的状态和进度。您将获得作业的概述、输出目标、配置文件和依赖关系图。您可以使用这些选项卡来了解更多关于已转换数据的信息。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/2b751f70a89c8d9ceffafad9f9569f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*UFVeWKVL4PMFyze5EJ2ClQ.png"/></div></figure><p id="5c33" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在输出目的地下载结果文件。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/8917699df1584b321b7fb46c88cb060a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*o4mBjQGRBmLbE0q73WAHiw.png"/></div></figure><p id="b089" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以单击profile选项卡来验证数据输出是否准确。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/348b2185b67444351b0992023aff059f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*nFY3_-93BiHhTPNzMBlBGw.png"/></div></figure><p id="41ff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您还可以通过点击右上角的<strong class="is hu">查看数据流作业</strong>来查看数据流上的作业图表和指标。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/bb2dd35374c23878c2d62930cb2fe15f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*wCTrTmmWaGhNUPLLxLbZXA.png"/></div></figure><h1 id="3292" class="jw jx ht bd jy jz lk kb kc kd ll kf kg kh lm kj kk kl ln kn ko kp lo kr ks kt bi translated">第三步:加载过程</h1><p id="19e3" class="pw-post-body-paragraph iq ir ht is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">ETL过程的最后一步是将转换后的数据加载到新的目的地。你可以把你的新数据加载到BigQuery，Google Cloud Storage，下载到一个本地主机或者任何其他的集成数据仓库。</p><p id="7a1f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">默认情况下，您的数据将在此位置发布。要添加新位置，可以使用添加发布操作并选择以不同的文件格式或BigQuery表发布。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/8917699df1584b321b7fb46c88cb060a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*o4mBjQGRBmLbE0q73WAHiw.png"/></div></figure><p id="878d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">默认情况下，结果以csv格式发布，尽管其他格式也可用。</p><figure class="lb lc ld le fd hk er es paragraph-image"><div class="er es me"><img src="../Images/348b2185b67444351b0992023aff059f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*nFY3_-93BiHhTPNzMBlBGw.png"/></div></figure><p id="287a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据可以一次全部加载(全加载)，也可以按预定的时间间隔加载(增量加载)。</p><p id="a04f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以计划定期运行数据准备作业，以保持数据最新。这可以通过在计划流程中添加计划来完成，并决定您希望作业刷新的频率。</p><p id="07dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有许多因素可以决定满载或递增负载的选择。无论是哪种情况，如果选择“满负荷”选项，建议您在非高峰时段运行作业，以获得更好的性能。增量加载可以在其他时间运行。</p><p id="09e7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望会有一个关于如何在数据流上安排作业的综合帖子。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Invisibility and more — openCV C++</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不可见性和更多——openCV c++</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/invisibility-and-more-opencv-c-a37580e66cdd?source=collection_archive---------57-----------------------#2021-09-13">https://medium.com/geekculture/invisibility-and-more-opencv-c-a37580e66cdd?source=collection_archive---------57-----------------------#2021-09-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="642f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谁不喜欢魔术？“霍华德，容我插一句。你真的想把时间花在魔术上吗？”谢尔登·库珀说。但在这里我用了一个更符合逻辑的技巧，谢尔顿应该能弄明白。</p><p id="45ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是让我也简单地介绍一下我的工作。首先我们需要一个视频源。正如我们所知，视频是一系列随时间移动的图像——因此有了电影。你也知道图像是由像素构成的。因此，如果我们像疯狂的猴子一样改变和篡改这些像素，我们就可以做出简单的把戏。</p><p id="55f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以像这样轻松地获取视频源！</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f184" class="jm jn hi ji b fi jo jp l jq jr">VideoCapture cap(0);</span></pre><p id="8101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如果你想在没有网络摄像头的情况下拍摄视频呢？天哪！你疯了吗？然后，让我们给你一个消息说“不，你不能这样做，因为你没有视频饲料！”</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f9da" class="jm jn hi ji b fi jo jp l jq jr">if(!cap.isOpened()){ <br/>cout &lt;&lt; “No you can’t do this because you don’t have a video feed” &lt;&lt; endl; <br/>return -1; }</span></pre><p id="4f0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后呢？是的。你需要声明你需要欺骗人们的图像，以及视频中的每个图像。让我们分别称它们为<em class="js">背景</em>和<em class="js">形象</em>。然后，我们需要获得我们从视频饲料捕捉，并把它作为基础层的背景。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="a2f7" class="jm jn hi ji b fi jo jp l jq jr">Mat img;<br/>Mat background;<br/>for (int i = 0; i &lt; 60; i++)<br/>{ <br/>cap &gt;&gt; background;<br/>}</span></pre><p id="1099" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了它们，让我们取另一个变量，把视频中的每一个图像分配到HSV中。HSV是色调-饱和度-值。</p><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es jt"><img src="../Images/09f6378c03ce050105b42d65c6f67ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BnOXMbOL9uxg6POI"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx">Photo by <a class="ae kf" href="https://unsplash.com/@ro_ka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Robert Katzki</a> on <a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="07cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里有一个这些颜色如何工作的解释。色调是你需要的可见光谱中的哪种颜色。饱和度就是你需要多少光彩(低饱和度是沉闷，高饱和度是壮观！)而价值基本上就是你需要什么样的色调——要么很暗，要么很亮。</p><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kg"><img src="../Images/b1c9e0ca5c856595bde101e03b96e7cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7dypklztQvtUAXBX9z2wg.png"/></div></div></figure><p id="1e60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们图像的红色、绿色和蓝色将如何转换成HSV。</p><p id="d2af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那我们需要面具。这些遮罩将帮助我们从转换为HSV的图像中提取我们需要的颜色，以使它们不可见。基本上，它所做的是获取我们要求的特定范围，并与我们达成协议，它将获取这些范围，并使用openCV的内置函数对其进行处理。</p><p id="0448" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要的颜色有上限和下限。例如，您可以将值放入一个数组中，查看HSV分布，如下图所示。圆圈内的颜色大部分位于所示的范围内。</p><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="er es kh"><img src="../Images/2e8dd61e7677a4c2745cd1fecd733f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bth-wwM3abfN-pBGilpHPg.png"/></div></div></figure><p id="c92b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们将变形两个面具，并创建一个内核。那么让我们，把掩码2作为输入，把掩码2作为输出，因为它不是或者正好相反。然后，我们将在帧的两个掩码之间放置一个AND运算符，并将其称为resolution1。然后将背景之间的AND运算符作为输入，称之为resolution2。这两个AND运算都是按位的。</p><p id="9634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将两个分辨率值作为输入数组，然后我们将添加的权重，并说明显示什么、隐藏什么以及最终输出是什么。这发生在openCV函数a <em class="js"> ddWeighted </em>内部</p><p id="5021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后就是显示视频馈送和发布窗口的问题了。维奥拉。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="77d0" class="jm jn hi ji b fi jo jp l jq jr">while (true)<br/>{<br/>Mat frame;<br/>cap &gt;&gt; frame;<br/>if (frame.empty())<br/>break;</span><span id="b9a9" class="jm jn hi ji b fi ki jp l jq jr">Mat hsv;<br/>cvtColor(frame, hsv, COLOR_RGB2HSV);</span><span id="c12b" class="jm jn hi ji b fi ki jp l jq jr">Mat mask1, mask2;</span><span id="8bb5" class="jm jn hi ji b fi ki jp l jq jr">inRange(hsv, Scalar(30, 120, 70), Scalar(50, 255, 255), mask1);<br/>inRange(hsv, Scalar(50, 120, 70), Scalar(75, 255, 255), mask2);</span><span id="6d03" class="jm jn hi ji b fi ki jp l jq jr">mask1 = mask1 + mask2;<br/>Mat kernel = Mat::ones(3, 3, CV_32F);</span><span id="ffb0" class="jm jn hi ji b fi ki jp l jq jr">morphologyEx(mask1, mask1, MORPH_OPEN, kernel);<br/>morphologyEx(mask1, mask1, MORPH_DILATE, kernel);</span><span id="fcb3" class="jm jn hi ji b fi ki jp l jq jr">bitwise_not(mask1, mask2);</span><span id="66d5" class="jm jn hi ji b fi ki jp l jq jr">Mat res1, res2, final_output;</span><span id="3764" class="jm jn hi ji b fi ki jp l jq jr">bitwise_and(frame, frame, res1, mask2);<br/>bitwise_and(background, background, res2, mask1);</span><span id="f562" class="jm jn hi ji b fi ki jp l jq jr">addWeighted(res1, 1, res2, 1, 0, final_output);<br/>imshow("Magic !!!", final_output);<br/>char c = (char)waitKey(20);</span><span id="b9d5" class="jm jn hi ji b fi ki jp l jq jr">if (c == 27)<br/>break;<br/>frame.release(), hsv.release(), mask1.release(), mask2.release(), res1.release(), res2.release(), final_output.release();<br/>}</span></pre><p id="cef9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我做了这个让绿色看不见。如果您需要使用其他颜色，请检查您的HSV图像，并根据需要选择下限和上限。</p><p id="126c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我把代码上传到github这里:<a class="ae kf" href="https://github.com/MadaraPremawardhana/Invisibility-Cloak-C-/commit/1ab72c2f5c92d03246c79c7eab9e3f377173252c" rel="noopener ugc nofollow" target="_blank">https://github . com/MadaraPremawardhana/Invisibility-coast-C-/commit/1 ab 72 C2 f 5c 92d 03246 C 79 C 7 ea B9 e 3f 377173252 C</a></p><p id="e210" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是最基本的。发疯吧！</p></div></div>    
</body>
</html>
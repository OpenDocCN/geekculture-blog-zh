<html>
<head>
<title>As cool as Iceberg</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像冰山一样冷静</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/as-cool-as-iceberg-bb7d93084c72?source=collection_archive---------7-----------------------#2021-10-10">https://medium.com/geekculture/as-cool-as-iceberg-bb7d93084c72?source=collection_archive---------7-----------------------#2021-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/651019965836c469c3ef4052aa6909b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q1nTAxJxCNJ9ZfC8pLkzXA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">source: <a class="ae iu" href="https://iceberg.apache.org/" rel="noopener ugc nofollow" target="_blank">https://iceberg.apache.org/</a></figcaption></figure><p id="566f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们一直面临着数据维护的挑战，以及为您的分析提供一站式解决方案的效率。</p><p id="98ea" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当谈到实现最佳存储性能时，我们总是倾向于考虑支持序列化或压缩的文件格式。</p><p id="92d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后是支持分析用例的基础设施。</p><p id="5c8a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我们很少谈论你的文件格式和计算之间的薄层。</p><p id="8ac3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你的计算像Spark，Hive或者Flink会直接和文件格式对话。</p><p id="bbb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后应用所有类型过滤器，如分区、谓词下推等。</p><p id="2b79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是，如果我们可以在您接触文件格式之前应用该规则，并根据您的查询忽略您不感兴趣的文件，会怎么样呢？</p><p id="e792" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输入Apache冰山a表格式。</strong></p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="cd7d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">表格格式适合哪里</h1><p id="bd6e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">Apache Iceberg是parquet或ORC等文件格式之上的一层，计算将在存储的文件格式之上使用这种表格格式。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/feb7107ab851eb3f9fce564bfee6c722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGxLttfrOTSvxsEkFJWU3g.png"/></div></div></figure><h1 id="9716" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">介绍</h1><p id="2065" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated"><strong class="ix hj"> Apache Iceberg是一种用于大型分析数据集的开放表格格式。</strong> Iceberg向Spark、Trino、PrestoDB、Flink和Hive等计算引擎添加了表格，这是一种高性能的表格格式，其工作方式类似于SQL表格。</p><p id="9365" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来源:https://iceberg.apache.org/<a class="ae iu" href="https://iceberg.apache.org/" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="297d" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">背景</h1><p id="9844" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">阿帕奇冰山是由网飞发明的，后来开源给阿帕奇基金会。</p><p id="7503" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它在2020年5月成为ASF高级项目。</p><p id="fe76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">冰山的主要用户是网飞和苹果。</p><h1 id="cf9d" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated"><strong class="ak">冰山的目标</strong></h1><p id="ff38" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">冰山试图回答我们在当前这一代数据中的许多痛点。</p><ol class=""><li id="70ff" class="ln lo hi ix b iy iz jc jd jg lp jk lq jo lr js ls lt lu lv bi translated"><strong class="ix hj">支持就地文件格式。我们如何在不改变管道或文件格式的情况下，从我已经拥有的数据中获得最佳性能？</strong></li><li id="71ab" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">图式进化</strong>。随着时间的变化，图式也会发生变化。我们如何能够在不影响下游应用程序的情况下支持模式随时间的演变。</li><li id="a502" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">big data中的原子操作</strong>。在大数据世界中，实现ACID合规性是一项艰巨的任务。</li><li id="a0ef" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">清除目录和文件列表</strong>。每个查询都需要一个基于页脚(拼花地板)的文件列表和丢弃。</li><li id="6034" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">随着时间的推移改变分区列</strong>，并且应该支持以前的和新的分区列。</li><li id="3752" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">读写隔离</strong>。</li><li id="b08c" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated">隐式分区我希望引擎能照顾好我的分区列。</li><li id="9ce9" class="ln lo hi ix b iy lw jc lx jg ly jk lz jo ma js ls lt lu lv bi translated"><strong class="ix hj">版本控制和时间旅行</strong>。</li></ol><p id="e771" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还有很多。</p><p id="ac72" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个地狱的要求。坦率地说，冰山回答了所有的问题。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/1cd7e20f5f3f19a7cbe0388ae6090a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hx2TFDD9MlwQ7Dx6"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@officestock?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sebastian Herrmann</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="bdd8" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">冰山答案</h1><h2 id="e73a" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated"><strong class="ak"> 1。支持就地文件格式</strong></h2><p id="ba56" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">正如我们已经讨论过的，Iceberg不是一种文件格式，而是一种表格格式。</p><p id="2ee8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你使用ORC、Avro或Parquet，使用Iceberg并不需要你改变文件格式。</p><p id="8906" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它与当前的文件格式集成得很好，并在这些文件格式的基础上增加了一层。</p><p id="ec75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，冰山是以这样一种方式构建的，它可以在当前的执行引擎上运行，如Hive、Spark或Presto。</p><h2 id="b8ab" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">2.模式演变</h2><p id="4187" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">Iceberg支持对列进行添加、删除、重命名、更新或重新排序。</p><p id="75d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">模式的发展或变化只会影响元数据。这意味着你不需要改变或重写整个数据了。</p><p id="8f77" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">注意</strong>映射键不支持添加或删除会改变等式的结构字段。</p><h2 id="4234" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">3.原子操作</h2><p id="82ad" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">所有写操作将始终独立工作，不会影响元数据中的当前读操作或当前模式。</p><p id="118c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">读者将永远无法读取部分提交的数据。</p><p id="3d24" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦操作完全成功，原子操作将被提交，并将对读者可见。</p><h2 id="8156" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated"><strong class="ak"> 4。清除目录和文件列表</strong></h2><p id="ebbc" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">传统的文件格式要求您在分区的情况下读取目录列表，列出分区内的所有文件，并根据页脚排除不在filter子句中的文件。</p><p id="8ff8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽管我们并不需要大部分的分区和分区中的字段，但我们最终还是列出了每个查询的每个时间。</p><p id="9d84" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是很多的清单。</p><p id="7b80" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Iceberg不需要文件列表。它维护清单中的数据。</p><p id="65f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将在架构中更多地讨论它。</p><h2 id="9355" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">5.改变分区列</h2><p id="8f02" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们多年前定义的架构将无法支持我未来的所有用例。</p><p id="d911" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">类似地，在对数据进行分区的情况下，随着时间的推移，基于我们定义的列的数据分布将需要改变。</p><p id="82b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，我们可能希望在不重写整个数据的情况下，按月更新分区列。</p><p id="cfd7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Iceberg支持同一模式下不同级别的分区。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/7c89e042933b69f3a729b90d9c5188df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bhfxXNvAe-JhCFYhQTGEg.png"/></div></div></figure><h2 id="eb3e" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">6.读写隔离</h2><p id="cc8f" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">Iceberg维护着随着时间推移而改变的文件快照。这将支持并行但独立地进行读取和写入。</p><p id="94d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">除非提交新的写入，否则该快照将不可读取。</p><p id="c39f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将确保您的数据和模式不会破坏或读取部分数据。</p><h2 id="e546" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">7.隐式分区</h2><p id="a09e" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">定义分区不应该是强制性的。因为m需求会随着时间而变化。在运行时了解分区将会成倍地提高查询性能。</p><p id="9351" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">冰山就是这么做的。将隐式地获取和读取分区列。</p><h2 id="d7b1" class="mc kb hi bd kc md me mf kg mg mh mi kk jg mj mk ko jk ml mm ks jo mn mo kw mp bi translated">8.时间旅行</h2><p id="e1e7" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">正如我们已经讨论过的，Iceberg支持版本控制。这使得时间旅行成为可能，如果你被要求按照你的要求回到以前的版本。</p><h1 id="9f4a" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">元数据架构</h1><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/326f47157c8f8a7cd6edc90d80bac9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNOgKBRaqXrXE1JAQnlKVA.png"/></div></div></figure><p id="4b35" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Iceberg将medata与数据文件并行存储。</p><p id="250a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">快照元数据文件:</strong>它存储表规范，如表模式、分区列和清单列表的路径。</p><p id="0832" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">清单列表:</strong>一个清单可以有多个清单。每个清单文件指向该文件的特定版本。这包含数据文件计数、分区列、数据的最小最大值等。</p><p id="3e55" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据文件:基本上是你的数据在你给定的文件格式，如parquet，orc或Avro。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h1 id="e1df" class="ka kb hi bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">演示时间</h1><p id="3c50" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">让我们创建一个虚拟表，写为iceberg并列出文件夹路径。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/5757671dff131584bbe4a16740f01113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oOQwAZucTi7u3KxfiAAoOw.png"/></div></div></figure><p id="e062" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到主表路径下有两个文件夹。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/352a47da81ab855309b47bf5d4432d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7l6HRLI3HmTFkUKoySDxLw.png"/></div></div></figure><p id="a335" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据文件夹包含了拼花地板中的实际文件。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/39b1f0efe2179dcfd0891c38f65b98a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ff4M9qV91IXA1sMvHSi94Q.png"/></div></div></figure><p id="cdc9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">元数据文件夹包含清单。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/d2a8f544a454889dd9e5ad86716ca04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jTJyGc3Hz-us417asUeHLQ.png"/></div></div></figure><p id="9944" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Avro文件包含4条记录。每个记录代表数据目录中的一个文件。</p><p id="ba88" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它包含路径、文件格式、记录数、块大小、分区列和更多信息。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/8fc317d675ece1d6018cde5f1811675c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBLc5VrW4y4G5bsZKRu5pA.png"/></div></div></figure><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/f70dfaab843413fba68719be0eedca95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*046CNZScq_M1O4I27YyXGA.png"/></div></div></figure><p id="67af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">元数据快照文件包含路径、清单和版本详细信息。</p><p id="483b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为只有一次写入，所以我们有一个快照记录。</p><p id="df80" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，metdata包含每一列的metdata以及文件的路径和版本细节。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/89c82a536d6ec8ec68ce2b45c2cde0b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eei4m1Eszbt9ULrvDQ56uQ.png"/></div></div></figure><p id="560c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们再次将相同的数据写入相同的iceberg路径时，我们可以看到它创建了一个新版本的文件，其中创建了一个新版本的json文件。</p><p id="d7db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它还为新写入的文件添加了一个新的avro文件。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/c5e864a73aee4b6f2790dc07d88720e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDNhjQVfY6FnW3T1l1lazw.png"/></div></div></figure><h1 id="0321" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">使用冰山时的一些提示</h1><p id="b567" class="pw-post-body-paragraph iv iw hi ix b iy ky ja jb jc kz je jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">快照数量不断增加:随着时间的推移，您会不断添加文件的新快照，这些快照会不断增长，甚至元数据文件也会如此。</p><p id="32c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">建议保留几个版本，并根据您的使用情况使用过期快照。</p><p id="3787" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">孤立数据元数据文件:这些是未提交的文件，可能在写入时失败。</p><p id="cf37" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以使用API RemoveOrphanFilesAction来删除它们。</p><h1 id="cbae" class="ka kb hi bd kc kd li kf kg kh lj kj kk kl lk kn ko kp ll kr ks kt lm kv kw kx bi translated">参考</h1><div class="mz na ez fb nb nc"><a href="https://iceberg.apache.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi translated">关于-阿帕奇冰山</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">Apache Iceberg是一种用于大型分析数据集的开放式表格格式。Iceberg为计算引擎添加了表格，包括…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">iceberg.apache.org</p></div></div><div class="nl l"><div class="nm l nn no np nl nq io nc"/></div></div></a></div><div class="mz na ez fb nb nc"><a href="https://github.com/apache/iceberg" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi translated">GitHub-Apache/Iceberg:Apache Iceberg</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">Apache Iceberg是一种新的表格格式，用于存储大型、移动缓慢的表格数据。它旨在改进…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">github.com</p></div></div><div class="nl l"><div class="nr l nn no np nl nq io nc"/></div></div></a></div><p id="2f74" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以在我的github链接中找到示例代码</p><div class="mz na ez fb nb nc"><a href="https://github.com/ajithshetty/IcebergDemo" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hj fi z dy nh ea eb ni ed ef hh bi translated">GitHub - ajithshetty/IcebergDemo</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">通过在GitHub上创建一个帐户来为ajithshetty/IcebergDemo开发做贡献。</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">github.com</p></div></div><div class="nl l"><div class="ns l nn no np nl nq io nc"/></div></div></a></div><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nt"><img src="../Images/3c34dcd5e5c5e324daf62cb7eb4e8b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gtkl6BcMx78jYBhK.png"/></div></div></figure><p id="0768" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">阿吉特·库玛尔·谢蒂</strong></p><p id="cfaa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">大数据工程师—大数据、分析、云和基础设施。</p><p id="2eeb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://ajithshetty28.medium.com/subscribe" rel="noopener">订阅</a> ✉️ || <a class="ae iu" href="https://ajithshetty28.medium.com/" rel="noopener">更多博客</a>📝|| <a class="ae iu" href="https://www.linkedin.com/in/ajshetty28" rel="noopener ugc nofollow" target="_blank">挂靠在</a>📊|| <a class="ae iu" href="https://ajithshetty.github.io/" rel="noopener ugc nofollow" target="_blank">个人资料页面</a>📚|| <a class="ae iu" href="https://github.com/ajithshetty/" rel="noopener ugc nofollow" target="_blank"> Git回购</a>👓</p><p id="d8d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">对获取全球大数据分析的每周更新感兴趣，请订阅我的:</strong> <a class="ae iu" href="https://justenoughdata.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">每周简讯</strong> </a></p></div></div>    
</body>
</html>
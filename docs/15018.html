<html>
<head>
<title>Part 14: Reviews of Categories SQL Question Asked by Yelp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第14部分:Yelp提出的SQL问题分类综述</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/part-14-reviews-of-categories-sql-question-asked-by-yelp-48ecd2ba4990?source=collection_archive---------6-----------------------#2022-10-08">https://medium.com/geekculture/part-14-reviews-of-categories-sql-question-asked-by-yelp-48ecd2ba4990?source=collection_archive---------6-----------------------#2022-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="48a4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">让我们解决基于产品的公司提出的SQL问题</h1><p id="b47c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是基于产品的公司在面试中提出的一系列SQL问题中的第14篇文章。对于本文，我使用StrataScratch平台来获取基于产品的公司中被问到的问题。</p><p id="650f" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">StataScratch是一个优秀的平台，适合任何希望开始学习数据科学并提高其SQL和Python技能的人。这个平台不仅提供编码题，还提供与数据科学相关的非编码题，比如统计、概率等等。我强烈建议你在StrataScratch网站上注册一个账户，在文章旁边练习这个问题。我将使用Postgres SQL数据库来解决这个问题。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/71456a6c58d0c80ceca1a5b605996eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ykKb1xNcvIPZa52h612hfg.jpeg"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Photo by <a class="ae kb" href="https://unsplash.com/@jjying?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">JJ Ying</a> on <a class="ae kb" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1aa4" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">以下是基于产品的公司提出的一系列Postgres SQL问题的链接:</p><p id="dcb9" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://agupta97.medium.com/list/postgres-interview-problems-asked-in-productbased-comapnies-c4020531504b" rel="noopener">https://agupta 97 . medium . com/list/postgres-interview-problems-asked-in-product-based-com apnies-c 4020531504 b</a></p><p id="1744" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">如果你从事数据科学工作或者想在数据科学领域开始职业生涯，SQL是最重要的技能之一。<br/>如果你熟悉SQL，你将有更好的机会通过数据科学面试或处理日常任务。本文将集中讨论一个问题以及如何解决它。如果你想提高你的SQL知识和经验，你必须阅读这篇文章。你提出想法和寻找解决方案的方法无疑会有所改进。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kx"><img src="../Images/a4fdbe299640afbfeae1f6bb04505d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o3Kt_98s93nOFPlc.jpeg"/></div></figure><p id="9636" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是<strong class="jf hj"> Yelp </strong>在一次采访中提出的中级问题。可以在这里  <strong class="jf hj">查看问题<a class="ae kb" href="https://platform.stratascratch.com/coding/10049-reviews-of-categories?code_type=1" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">。</strong>问题名称为<strong class="jf hj">评论类别。</strong>以下是问题的详细内容:</a></strong></p><h1 id="8123" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">类别审查</h1><p id="7b28" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">根据评论总数查找排名靠前的业务类别。输出类别以及评论总数。按总评论降序排序。</p><blockquote class="ky kz la"><p id="e8b0" class="jd je lb jf b jg kc ji jj jk kd jm jn lc ke jq jr ld kf ju jv le kg jy jz ka hb bi translated"><em class="hi">公司:</em><strong class="jf hj"><em class="hi">Yelp</em></strong><em class="hi">，难度:</em> <strong class="jf hj"> <em class="hi">中等</em> </strong> <em class="hi">，面试问题id:</em><strong class="jf hj"><em class="hi">10049</em></strong><em class="hi">，</em> <strong class="jf hj"> <em class="hi"> </em> </strong> <em class="hi">表格:</em> <strong class="jf hj"> <em class="hi"> yelp_business，</em> </strong></p><p id="f406" class="jd je lb jf b jg kc ji jj jk kd jm jn lc ke jq jr ld kf ju jv le kg jy jz ka hb bi translated"><em class="hi">表格_字段:</em></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lf"><img src="../Images/769eeddc6d121dc03cffb421b377d53c.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*1Nknypyz-9zwJNkoIP98tQ.jpeg"/></div></figure><p id="a773" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">yelp _ business表的几个字段预览:</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lg"><img src="../Images/88a9af0340e12de8220957dcb7701ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*rOr8JxKyK88kdLX1fhexBw.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">yelp_business table</figcaption></figure><p id="bd76" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">首先，让我们试图理解这个问题。如问题中所述，我们必须确定每个业务类别的审查总数。在categories字段中，您会得到多个值，用分号分隔，这意味着一个企业可以属于多个类别，因此将被视为不同类别的评论数总和。</p><p id="9d1d" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">进场:</strong></p><ol class=""><li id="973f" class="lh li hi jf b jg kc jk kd jo lj js lk jw ll ka lm ln lo lp bi translated">首先，<strong class="jf hj">我</strong>首先确定需要回答这个问题的字段。我们只需要两个字段review_counts和categories来输出结果。</li><li id="76ee" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">由于一个企业属于多个类别，我们需要为单个企业类别形成多个行。我们可以使用string_to_array()函数来实现这一点，该函数会将类别转换为一个由分号分隔的数组，然后我们将在string_to_array()之上使用unnest()来为数组中的每个值形成一行。</li></ol><pre class="ki kj kk kl fd lv lw lx ly aw lz bi"><span id="64d3" class="ma ig hi lw b fi mb mc l md me"><strong class="lw hj">select business_id, <br/>       unnest(string_to_array(categories, ';')) as category,<br/>       review_count  <br/>       from yelp_business;</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mf"><img src="../Images/b47021e01cb2a9247f757a709672c022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*x-h38T74b-2jjJIUBPfYPQ.jpeg"/></div></figure><p id="999f" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">3.现在，我们可以对上述步骤类别中形成的新列应用group by子句，对review_count求和，并按照review_count和的降序对记录进行排序。下面是最后一个查询:</p><pre class="ki kj kk kl fd lv lw lx ly aw lz bi"><span id="686a" class="ma ig hi lw b fi mb mc l md me"><strong class="lw hj">select  unnest(string_to_array(categories, ';')) as category,    sum(review_count)  <br/>from yelp_business <br/>group by category <br/>order by sum(review_count) desc;</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mg"><img src="../Images/2cd8dabd4484adc714e1bfcd23bc11b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*6rORud0g-30zhX07TtMcrw.jpeg"/></div></figure></div><div class="ab cl mh mi gp mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="hb hc hd he hf"><p id="9a89" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">感谢你看我的帖子，回复我；这对我意义重大。如果你喜欢它，竖起大拇指，点击“关注”在媒体上关注我，以便在我发布新内容时得到通知。</p></div></div>    
</body>
</html>
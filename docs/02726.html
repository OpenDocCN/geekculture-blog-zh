<html>
<head>
<title>Classification: K- Nearest Neighbors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类:K-最近邻</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/classification-k-nearest-neighbors-28f6622926c9?source=collection_archive---------41-----------------------#2021-05-24">https://medium.com/geekculture/classification-k-nearest-neighbors-28f6622926c9?source=collection_archive---------41-----------------------#2021-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6cee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用scikit-learn在Python中进行KNN分类</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/89e0e569bb8a3101758f7ec578fd929b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uQXH0W4tBXkvzgvE"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@greysonjoralemon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Greyson Joralemon</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="dd29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">K-最近邻方法是一种简单的分类算法，它通过查看网络中“K”个最近的数据点来预测数据点(比如x)的标签。</p><p id="ead1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，假设我们想要根据x的K个最近邻的颜色来预测x的颜色，其中K=3。换句话说，我们想通过观察3个最近的邻居(或数据点)的颜色来预测x的颜色。我们不知道X是什么颜色，但它的邻居a、b和c分别是绿色、蓝色和蓝色。基于这个观察，我们的K最近邻法或KNN法，会预测x的颜色是蓝色。如果我们要展开并查看5个最近的邻居(即K=5)，a、b、c、d和e，其中d和e都是绿色，那么我们的KNN分类器会将绿色分配给我们的数据点x</p><p id="35e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我将使用scikit-learn演示如何在Python中安装一个简单的KNN分类器。</p><h1 id="c8b1" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">数据</strong></h1><p id="4377" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们将使用sci-kit学习库中可用的<a class="ae jt" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank">虹膜</a>数据集。数据集由3种不同类型的鸢尾(Setosa、Versicolour和Virginica)花瓣和萼片长度和宽度组成。目标是在给定长度和宽度特征的情况下预测虹膜的类型。</p><h1 id="350a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">KNN</h1><p id="638e" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated"><strong class="ih hj"> 1。导入必要的模块:</strong></p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="43a1" class="lc jv hi ky b fi ld le l lf lg">from sklearn.datasets import load_iris<br/>from sklearn.neighbors import KNeighborsClassifier<br/>import pandas as pd</span></pre><p id="54bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。将数据作为Iris加载，然后将其转换成两个数据帧</strong></p><p id="f058" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虹膜数据集作为数组加载。我们将把它转换成两个独立的数据帧—一个用于目标，一个用于特征。分割目标和特征对于步骤5中的拟合更有意义。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="c054" class="lc jv hi ky b fi ld le l lf lg">Iris= load_iris()<br/>df=pd.DataFrame(iris['data'],columns=[iris['feature_names']])<br/>df2=pd.DataFrame(iris['target'])</span></pre><p id="0d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。探索虹膜数据</strong></p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="3e84" class="lc jv hi ky b fi ld le l lf lg">df.shape</span></pre><p id="79e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">(150,4)</p><p id="db02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据有150个观察值和4个特征。需要注意的是，要使KNN分类有效，数据集不能有任何缺失值。此外，这些特征必须是数值连续的变量。它们不能是绝对的。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="8d75" class="lc jv hi ky b fi ld le l lf lg">df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/0cd0f9bd31867fe45d4998f5369fa67c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*B61Gs17OR7ktPz1C1xUIoA.png"/></div></div></figure><p id="2c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面是我们数据集的前五行。</p><p id="0365" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。实例化KNN分类器</strong></p><p id="612e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用5个邻居作为我们的分类器。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="7271" class="lc jv hi ky b fi ld le l lf lg">knn=KNeighborsClassifier(n_neighbors=5)</span></pre><p id="3dcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。安装分类器</strong></p><p id="9797" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">knn.fit()参数基于两个输入运行模型-特征(X)和响应或目标(Y)。</p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="9bd2" class="lc jv hi ky b fi ld le l lf lg">X=df.values #features<br/>y=df2.values #response<br/>knn.fit(X,y)</span></pre><p id="0fbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。运行预测</strong></p><pre class="je jf jg jh fd kx ky kz la aw lb bi"><span id="5cbc" class="lc jv hi ky b fi ld le l lf lg">y_pred=knn.predict(X)<br/>y_pred</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/9ea53219912e550bdaadd34734226dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*MfBxsQWTJiGipKP9A1VjKQ.png"/></div></figure><p id="ea44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在上面的数据集中看到每个观测值的预测。请注意，0=setosa，1=versicolor，2= virginica。</p><h1 id="be5c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="9cd9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">我们使用一个基本的KNN分类器来预测我们观察的每个数据点的虹膜类型，给出它的特征和5个最近的邻居。接下来的步骤是通过将数据分成训练/测试集并获得每个集的准确度分数来测量模型准确度。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="1853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献</strong></p><div class="lq lr ez fb ls lt"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hj fi z dy ly ea eb lz ed ef hh bi translated">熊猫。数据框架- pandas 1.2.4文档</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">二维、大小可变、潜在异构的表格数据。数据结构还包含带标签的轴(行…</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">pandas.pydata.org</p></div></div></div></a></div></div></div>    
</body>
</html>
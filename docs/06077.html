<html>
<head>
<title>Private Routing on ReactJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应堆上的专用路由</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/private-routing-on-reactjs-30c006637188?source=collection_archive---------11-----------------------#2021-08-05">https://medium.com/geekculture/private-routing-on-reactjs-30c006637188?source=collection_archive---------11-----------------------#2021-08-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ce6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于那些开始创建web应用程序的人来说，最大的挑战之一总是在于:“<strong class="ih hj">我如何管理路由许可？”</strong></p><p id="0cf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们在ReactJS上工作时，我们可以看到有许多方法来平衡我们的路由结构，因此，许多开发人员会花一些时间考虑:<strong class="ih hj">“我应该使用哪种路由结构？”</strong>。</p><p id="4b51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对我来说，一个开发人员可以应用到他们项目中的最好的结构是这样一种结构，它让<strong class="ih hj">感到在</strong>上工作很舒服，并且便于<strong class="ih hj">扩展</strong>以及<strong class="ih hj">添加或删除路由许可</strong>。</p><p id="7f1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">符合所有这些考虑的一个是<strong class="ih hj">嵌套路由</strong>的概念，它基本上由de routes文件夹中的<strong class="ih hj">三个核心文件</strong>组成。</p><p id="5620" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要再说了，我们开始吧！</p><p id="1f3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们使用<em class="jd">yarn create react-app nested-routes创建我们的项目。</em>创建后，我们可以清理我们的文件夹结构，以便只保留我们将在此应用程序中使用的文件。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/7c196067cb3fd8069c12857d0ba66599.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*j7qYpI9eIrFy_FvusjfBog.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 1: Main folder structure.</figcaption></figure><p id="59da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">之后，我们可以开始下载将要使用的库:<strong class="ih hj"> react-router-dom </strong> —我们的路由库、<strong class="ih hj"> styled-components </strong> —我们的样式库和react-toastify —我们的警报库。</p><pre class="jf jg jh ji fd jq jr js jt aw ju bi"><span id="0aaf" class="jv jw hi jr b fi jx jy l jz ka">yarn add react-router-dom styled-components react-toastify</span></pre><p id="8fd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们创建项目的文件夹结构。为此，我们需要在<em class="jd"> src </em>中创建一个<em class="jd">组件</em>、<em class="jd">视图</em>和<em class="jd">路线</em>文件夹。</p><ul class=""><li id="10e5" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">视图:我们的页面将被存储在哪里</li><li id="aeed" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><em class="jd">组件</em>:我们可重复使用的组件将存放在那里</li><li id="2af4" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><em class="jd">路由</em>:我们的路由结构将被存储的地方</li></ul><p id="9935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们开始在视图中创建一个Home，在组件中创建一个Navbar和一个Footer。</p><p id="a29c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的家，我们将呈现一个简单的屏幕，上面有一些文本和我们的Navbar组件。</p><ul class=""><li id="fe92" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated"><strong class="ih hj">导航条</strong></li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kp"><img src="../Images/872438d86eade61e78704a6933c38e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*5MaW_pHrBGRWvf2YtVJ7EA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 3: Navbar/index.jsx</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kq"><img src="../Images/09a9eff95f577823a69beb03e009969a.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*sZ7QIHLJOySYERB2IqBc6g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 4: Navbar/styles.js</figcaption></figure><ul class=""><li id="7897" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">页脚</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kr"><img src="../Images/091640f203b901d27608b65fdef7b75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*-Pml5C1L7EstKVn8nkybgg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 5: Footer/index.jsx</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ks"><img src="../Images/8b2fd6c0a89058a1f8dce6ff08f9a926.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*2fHAedF3ie-ri63RYJ9flw.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 6: Footer/styles.js</figcaption></figure><ul class=""><li id="1569" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">主页</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kt"><img src="../Images/08a7b0735688cb56840fac07ce816a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*GJhM46me_yrMFVDYHp8j2g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 7: Home/index.jsx</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ku"><img src="../Images/179af9ed753ee7c64b221ebe5f6255de.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*nPjNLkDa10P3smUgcmhW-g.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 8: Home/styles.js</figcaption></figure><blockquote class="kz la lb"><p id="1a82" class="if ig jd ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">所有这些文件在这个<a class="ae lf" href="https://github.com/Galendii/nested-routes-guide" rel="noopener ugc nofollow" target="_blank">项目的回购</a>上都有，放心使用吧！</p></blockquote><p id="6cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始规划我们的项目吧！在我们的<em class="jd"> routes </em>文件夹中，我们将创建三个不同的文件:index.jsx、paths.js和types.js</p><ul class=""><li id="8d4a" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">index.jsx:这是路由的主要文件，在这里我们将使用我们的路径并验证它是否是一个私有路由。</li><li id="65ac" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">paths.js:这个文件将定义所有的路径名和/或参数。</li><li id="15c2" class="kb kc hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">types.js:这是所有路由验证都将在其中工作的文件。在这里，您可以定义应用程序中的所有访问级别。</li></ul><p id="126c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创造我们的道路！这里我们将需要创建一个对象，它包含我们希望它拥有的尽可能多的数组和访问级别。在这种情况下，我们将只使用两个级别:<strong class="ih hj"> admin </strong>和<strong class="ih hj"> public </strong>访问。当我们创建第一个屏幕时，让我们将此路由设置为公共路由，这样每个人都可以访问它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lg"><img src="../Images/bb21f06c9fa5cd148030069a771070ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*sWE8c0W9rMvt52FjMZ0rvQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 9: routes/paths.js</figcaption></figure><p id="368a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的index.jsx中，我们将创建一个带有交换机的路由器，以便我们能够基于绝对路径定义路径。然后，我们需要绘制<code class="du lh li lj jr b">paths.public</code>的地图，以便返回它的路线。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lk"><img src="../Images/de9f8c64e5152c7e51db755c73aaf012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*LN4EaEdGym6xn-rS0aZD2g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 10: routes/index.jsx</figcaption></figure><p id="edd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们创建管理员级别之前，让我们测试一下，看看是否一切都如我们所愿。为此，我们将需要编辑App.js(它在我们的<em class="jd"> src </em>文件夹之外)并返回我们的路线和全局样式(以便覆盖html默认配置)</p><ul class=""><li id="eee0" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">全局样式</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ll"><img src="../Images/6af9aef71656ec85ac6027cb55568d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*iNw7bcKeyjOWKHt6TbILXA.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 11: styles/global.js</figcaption></figure><ul class=""><li id="61a3" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">App.js</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lm"><img src="../Images/781987f0977cf9024902968b7970556a.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*r19D3bSY4Us1u2UnIo-3fg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 12: App.js</figcaption></figure><p id="9de0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果准确地遵循了过去的所有步骤，您将会看到以下内容:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es ln"><img src="../Images/d83f33aaa91711491715663b571f279a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QEQMix4k7zNjOU9adi0Pg.png"/></div></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 13: Website preview</figcaption></figure><p id="ab44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧！现在，我们已经完成了仅使用公共路由的嵌套路由概念。让我们来创建我们的管理员路线吧！为此，我们需要在routes文件夹中创建一个<em class="jd"> types.js </em>文件。在这个文件中，我们将创建一个特定类型的路由，它将首先验证用户是否有访问权限，如果没有，则重定向到主页(并显示一条消息以获得更好的体验)</p><p id="bec5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的types.js将存在于单个受保护的路由中(您可以根据需要创建多个路由)。这将是一个正常路由的扩展，但有一个验证器，它将决定是否呈现页面或重定向到主页。</p><blockquote class="kz la lb"><p id="cf70" class="if ig jd ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">本文的重点是展示一种创建路线的方法。使用本地存储来存储用户<strong class="ih hj">的访问级别是不安全的！</strong></p></blockquote><ul class=""><li id="f83c" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">管理路线</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lo"><img src="../Images/d2e7b5bb12d23941e15a3cd0f675a326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*LFEod1-_UIYHwNdvvTa23g.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 14: routes/types.js</figcaption></figure><p id="4e8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，我们现在使用的是由<code class="du lh li lj jr b">react-toastify</code>库带来的<code class="du lh li lj jr b">toast.error()</code>方法。为了使用它，我们必须改变我们的<em class="jd"> App.js </em>中的最后一件事，那就是包含<code class="du lh li lj jr b">&lt;ToastContainer/&gt;</code>和使用它所必需的CSS<code class="du lh li lj jr b">import "react-toastify/dist/ReactToastify.css<em class="jd">”</em></code></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lp"><img src="../Images/c52062d183050a1324ea2510607000b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*SEgiRuuhxkmkfs1nraLF8Q.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 15: App.js</figcaption></figure><p id="4fec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以填充我们的管理员路径。创建另一个视图，与主页非常相似，但是让我们将标题从“主页”改为“管理页面”。</p><p id="854f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在path.js中填充管理员的路径:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lq"><img src="../Images/4802bb8be4e02f52159c9026aec760f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*fzONLN2RU-7SPa3M5oBMdQ.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 16: routes/paths.js</figcaption></figure><p id="71fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果一切正常，当您试图访问<code class="du lh li lj jr b">/admin</code>路径时，您将立即被重定向到<code class="du lh li lj jr b">/home</code>路径。</p><p id="8151" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，让我们通过在Navbar上添加登录/注销功能来模拟一次登录，并在那里更改我们的路线。</p><p id="f8bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">登录/注销功能将尝试检索存储在名为“access”的localStorage上的项目，如果它存在，它将经历一个注销过程，如果不存在，它将向它添加一个“admin”值。</p><ul class=""><li id="b207" class="kb kc hi ih b ii ij im in iq kd iu ke iy kf jc kg kh ki kj bi translated">导航条</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lr"><img src="../Images/a7adc2de28fbfd707236efcbd8dc2965.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*vDJpvw4vvY4SMLkMlzx_6w.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 17: Navbar/index.js</figcaption></figure><p id="ca72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，您的项目结构应该看起来像下面的图像</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ls"><img src="../Images/83dfb4bf7614c1977759357f73895ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*13moBiJuafEZmUahHlfsFg.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">Image 18: Final project structure</figcaption></figure><p id="2c82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是了！您已经开发了一个完全可行的解决方案来保护您的路由(不依赖于访问级别的数量),并学习了嵌套路由结构的基础知识！</p><p id="ff51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对这个项目有更多的疑问，可以在这里访问<a class="ae lf" href="https://github.com/Galendii/nested-routes-guide" rel="noopener ugc nofollow" target="_blank">项目的回购，或者通过LinkedIn </a>联系我<a class="ae lf" href="https://www.linkedin.com/in/breno-zielinski-galendi-b6385b179/" rel="noopener ugc nofollow" target="_blank">！</a></p><p id="2d9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#永不停止学习</p></div></div>    
</body>
</html>
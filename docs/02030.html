<html>
<head>
<title>Exploratory Data Analysis using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pandas进行探索性数据分析</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/exploratory-data-analysis-using-pandas-6e7162d662f1?source=collection_archive---------8-----------------------#2021-05-02">https://medium.com/geekculture/exploratory-data-analysis-using-pandas-6e7162d662f1?source=collection_archive---------8-----------------------#2021-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="383b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">熊猫概述</h1><p id="b395" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Pandas 是使用最多的库之一，它为数据分析提供了各种选项。数据科学家主要处理表格格式的数据，或者我们可以称之为2D格式。大多数常见的数据源格式都是。csv，。xlsx、SQL表等。Pandas非常有助于加载这些格式的数据，并对它们进行分析和处理。类SQL查询可以用来分析和处理数据，因此它是数据科学家中的一个著名的库。Pandas还与matplotlib和seaborn等库一起用于数据可视化。</p><p id="9aa7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Pandas中使用的主要数据结构是数据帧。还有一种数据结构叫做Series。这两者的主要区别在于，series是一种类似1D数组的数据结构，而Data frame表示2D表格数据，这与包含列和行的SQL表相同。数据帧常用于表示来自各种来源的数据。</p><h1 id="0dbf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">导入所需的库</h1><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="90c2" class="kp ig hi kl b fi kq kr l ks kt">import pandas as pd<br/>import numpy as np</span><span id="138b" class="kp ig hi kl b fi ku kr l ks kt"><em class="kv">  </em><br/>import matplotlib.pyplot as plt<br/><em class="kv"># pip install seaborn </em><br/>import seaborn as sns<br/>  <br/>%config InlineBackend.figure_format = 'retina'</span></pre><h1 id="7e57" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">语法-从CSV加载数据</h1><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="028a" class="kp ig hi kl b fi kq kr l ks kt">df = pd.read_csv(‘weather.csv’)<br/>df.head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kw"><img src="../Images/504444f6d0c1f21c3a567c6cd8b922a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mtjY3QKwsb08YpMXoIne_w.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Output of the code</figcaption></figure><p id="1e59" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">得到数据的形状</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="7574" class="kp ig hi kl b fi kq kr l ks kt">print(df.shape)</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es li"><img src="../Images/bc66e718bc2935e1ada5438d21ace3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xW9XH2Y7HNXxSNSs2lKRAA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Shape of data</figcaption></figure><p id="480d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">从上面的输出中，我们可以看到数据集包含366行和22列</p><p id="1339" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">获取栏目列表</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="a5a4" class="kp ig hi kl b fi kq kr l ks kt">print(df.columns)</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lj"><img src="../Images/70cc2679ac5ccae02b44fd823ff4cfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4O-hiXL76p1opQSEJ-bxZw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Get all columns in the dataset</figcaption></figure><p id="1867" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以从上面的代码中得到列表中的所有列名。</p><p id="d9cc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">获取关于数据集的信息</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d5a3" class="kp ig hi kl b fi kq kr l ks kt">print(df.info())</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lk"><img src="../Images/017ea1981c26c44d4e7e12884bdd7fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWKHu9s2MvpXcIAtbAkTUw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Info of a dataset</figcaption></figure><p id="162c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以看到数据集的基本信息，如数据类型、每列的非空值计数、内存使用情况等。我们还可以看到12列是浮点类型，5列是整数类型，另外5列是对象类型。我们还可以看到列中缺少的值。总行数是366，但是对于列Sunshine，363个值不为空，这意味着3个值为空。</p><p id="c6d7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">更改列的数据类型</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="15ef" class="kp ig hi kl b fi kq kr l ks kt">df['MinTemp'] = df['MinTemp'].astype('int64')</span></pre><p id="095a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们将MinTemp列中的所有值转换为整数值。</p><p id="2b51" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">基本统计</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="9799" class="kp ig hi kl b fi kq kr l ks kt">df.describe()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ll"><img src="../Images/442531b67044f0c6d6463b9393ebddce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtO-uomuv5Lo2ZygCZJTZw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Basic Statistics using describe</figcaption></figure><p id="54eb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以用描述的方法得到每个数值列的基本统计特征。默认情况下，只有像integer和float这样的数字列可以进行统计分析。如果我们想分析非数字列，那么我们必须手动指定如下所示。使用所述方法可以容易地计算平均值、中值、标准偏差、范围、百分位数。</p><p id="2347" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">手动描述方法</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="40a1" class="kp ig hi kl b fi kq kr l ks kt">df.describe(include=['object', 'object'])</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lm"><img src="../Images/e0ff3a9712de454e9096aa6e30c53ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVZZqr0tXQk_X3lHWosWdg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Describe method Manual</figcaption></figure><p id="60ae" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">查找列中不同值的计数</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="0520" class="kp ig hi kl b fi kq kr l ks kt">df['WindDir9am'].value_counts()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ln"><img src="../Images/9311769e9372c9fb315b4f3127b66ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTpe_RcRCtY7znhSpN3t1g.png"/></div></div></figure><p id="4ebb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以在WindDir9am列中看到每个不同值的计数。此外，还会显示列名和数据类型。</p><p id="2bc6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">查找列中不同值的百分比</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="a8bf" class="kp ig hi kl b fi kq kr l ks kt">df['WindDir9am'].value_counts(normalize=True)</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lo"><img src="../Images/cd109986dd1b7c885789f135f0934a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItmvZWSNWmQ5vTs1nF62jQ.png"/></div></div></figure><p id="fdbb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">value_counts方法中的normalize= True选项计算每个值占总数据的百分比。</p><p id="6d4b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">按单列排序</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d228" class="kp ig hi kl b fi kq kr l ks kt">df.sort_values(by='<strong class="kl hj">Rainfall</strong>', ascending=False).head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lp"><img src="../Images/0af6f122ef37ce0e2a71ef085beac771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2PIAJWnKqaoaGyZrt-FdPQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Sorting by RainFall descending</figcaption></figure><p id="aff2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以看到数据帧是按降雨量降序排列的，因为升序提供了错误值。默认情况下，排序是升序的。</p><p id="2d78" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">按多列排序</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="0b01" class="kp ig hi kl b fi kq kr l ks kt">df.sort_values(by=['Rainfall','Sunshine'], ascending=[False,True]).head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lq"><img src="../Images/9b0acaa02fb52fdace160760f242fe11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*97JO_fUSGCIntxND6MVPdQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Sorting by multiple columns</figcaption></figure><p id="c56f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以看到数据框已经按两列排序，降雨量下降，日照上升。</p><p id="4ae9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">用于数据检索的数据帧索引</strong></p><p id="89ee" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">数据框索引可以通过多种方式完成:</p><ol class=""><li id="9eae" class="lr ls hi jf b jg kb jk kc jo lt js lu jw lv ka lw lx ly lz bi translated"><strong class="jf hj">数据帧['列名'] </strong></li></ol><p id="9f8e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">找出日照数据在数据集中的比例</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="fe7d" class="kp ig hi kl b fi kq kr l ks kt">df['Sunshine'].mean()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ma"><img src="../Images/953abdf6b24c4fcb0da46c9ee324fdea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dmYau1XhRF2D2kXkB_OQPQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Mean of one column data</figcaption></figure><p id="848f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">此外，我们可以在索引数据框时使用该条件，如下所示:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="3cd2" class="kp ig hi kl b fi kq kr l ks kt">df[df['Sunshine'] &gt; 5].mean()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mb"><img src="../Images/e372866923c5a1b18805b8be2d432799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nR13ffz_cBBI1CpGsj7MHw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Average of all numerical feature based on the condition supplied</figcaption></figure><p id="62b0" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在上面的截图中，我们可以看到所有特征的平均值是计算出来的，其对应的日照值大于5。</p><p id="5a43" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们还可以找到如下各自的特征:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="1fda" class="kp ig hi kl b fi kq kr l ks kt">df[df['Sunshine'] &gt; 5]['Humidity9am'].mean()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div class="er es mc"><img src="../Images/d79740128df1d74e431c95403baae31d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*YFLH9nSzyau4QIzJFyF-Uw.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Single Column mean</figcaption></figure><p id="890b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这表示上午9点日照大于5时湿度的平均值。</p><p id="66f5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们也可以用同样的方法计算许多聚合函数，如max、min、count、sum等。</p><p id="f366" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> 2。DataFrame.loc或Dataframe.iloc </strong></p><p id="0b64" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">第一种情况:获取从0到3索引的行的值(4行),以及从MinTemp到Evaporation的列的值(这也是包含的)</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="43e7" class="kp ig hi kl b fi kq kr l ks kt">df.loc[0:3, 'MinTemp':'Evaporation']</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es md"><img src="../Images/bac19fff57ffbc0bda3a9da55392afdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hu8lbrLqCvytYsR5IWLHBA.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: DataFrame Indexing using loc</figcaption></figure><p id="2312" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">第二种情况:获取前四列中前四行的值。在这种情况下，最大值不包含类似于python中使用的切片。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="7851" class="kp ig hi kl b fi kq kr l ks kt">df.iloc[0:4, 0:4]</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es me"><img src="../Images/8639213f2ff0a645744e19bf9ae4590b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMKxxfcJng0ox73PtryiqQ.png"/></div></div></figure><p id="410d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">注意:只有列的最后一个索引是排他的，而行的最后一个索引是包含的。</p><p id="d41d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">如果我们想获得数据集中的第一行或最后一行，我们可以简单地在代码行下面使用:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="8426" class="kp ig hi kl b fi kq kr l ks kt">df[:1]<br/>df[-1:]</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mf"><img src="../Images/eeeeb0651af3a47a32fc0346cf3751d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1KBrKWJDANqsd3T9N3gSrw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Get first and the last row in a dataset</figcaption></figure><p id="7c32" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">应用功能</strong></p><p id="cb33" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">apply function可用于将函数应用于单元格、列或行。</p><p id="ef0f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">为了计算4个数值列的最大值，我们首先过滤数据集，然后使用如下应用:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="57c5" class="kp ig hi kl b fi kq kr l ks kt">filtered_df=df.iloc[0:365, 0:4]<br/>filtered_df.apply(np.max)</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mg"><img src="../Images/24212129e32406f2c4fcf2ede798f7e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mBodMIEz-KWxEdKof53Lg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Max value in 4 columns</figcaption></figure><p id="30d9" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">应用函数过滤行</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c828" class="kp ig hi kl b fi kq kr l ks kt">df[df['WindGustDir'].apply(lambda windgustdir: windgustdir == 'NW',1)].head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mh"><img src="../Images/78ea6464ce18d69dc67474bed500cac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LapAVO3poJZy5EEsqcMVfw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Filter Dataset using apply</figcaption></figure><p id="3160" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们使用了apply函数和lambda函数来过滤整个数据集，以获得在WindGustDir中具有NW值的数据</p><p id="8af5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">替换列中的值</strong></p><p id="9b54" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">要替换数据集中任何列的值，我们可以从python中的map函数获得帮助，如下所示:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="15bf" class="kp ig hi kl b fi kq kr l ks kt">d = {'No' : False, 'Yes' : True}<br/>df['RainToday'] = df['RainToday'].map(d)<br/>df.head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mi"><img src="../Images/226d584e153c8026359db77b39bb444c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUYvU0V33n4MDADd5t9xjQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Replace the value in a column</figcaption></figure><p id="9aa8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在上面的转换中，我们将“今天下雨”列中的值从“是/否”替换为“真/假”。</p><p id="c8b8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">替换该值的另一种方法是使用replace函数</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="e51d" class="kp ig hi kl b fi kq kr l ks kt">d = {'No' : False, 'Yes' : True}<br/>df = df.replace({'RainTomorrow': d})<br/>df.head()</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mj"><img src="../Images/40bae590890896b38b1f8faa9c3f7bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O95PROC3vNCmbxVYJhevNw.png"/></div></div></figure><p id="df7f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们已经将RainTomorrow列中的值从是/否替换为真/假。</p><p id="34ac" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">分组</strong></p><p id="594c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">一般表示=<strong class="jf hj">df . group by(by = grouping _ columns)[columns _ to _ show]。函数()</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d183" class="kp ig hi kl b fi kq kr l ks kt">columns_to_show=df.iloc[:,0:6].columns<br/>df.groupby(['WindGustDir'])[columns_to_show].describe(percentiles=[])</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mk"><img src="../Images/c93993228213241b4a1943086b25b3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhg8CUx69k6EaybBwA2UQQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Group By WindGustDir and Percentiles calculations</figcaption></figure><p id="5d48" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在上面的输出中，我们得到了按WindGustDir列分组后的所有基本聚合函数。我们可以看到WindGustDir列中每个不同值的平均值、计数、标准偏差等。</p><p id="c0a1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">汇总数据的列联表</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="1c5e" class="kp ig hi kl b fi kq kr l ks kt">pd.crosstab(df['RainToday'], df['RainTomorrow'])</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es ml"><img src="../Images/0fb68d6d76845ad7effa9e4fbcb7e235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-CdHWEpaDrfhu0EQlKF1A.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Contingency Table on two columns</figcaption></figure><p id="b824" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">使用crosstab，我们可以看到两列数据的漂亮呈现。在堆叠的标题中，我们可以看到RainTomorrow和RainToday都为False的行数是255。</p><p id="7ac5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们还可以在下面的同一个函数中使用normalize=True来查看发生率:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="8dc8" class="kp ig hi kl b fi kq kr l ks kt">pd.crosstab(df['RainToday'], df['RainTomorrow'],normalize=True)</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mm"><img src="../Images/fbebd8669cfeb582ea9d94baacb5c723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yo5d5POMsNQqDxYj0MNnHQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Contingency Table with Normalize True</figcaption></figure><p id="d8f8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">透视表</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="3cbe" class="kp ig hi kl b fi kq kr l ks kt">df.pivot_table(['MinTemp', 'MaxTemp', 'Rainfall', 'Evaporation', 'Sunshine'],<br/>               ['WindGustDir'], aggfunc='mean')</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mn"><img src="../Images/eece2c1046096ada69b273d1cf6f2553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uf99EuJxBR8DKn-I-M9ZKw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Pivot Tables with Mean</figcaption></figure><p id="f944" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">数据帧转换</strong></p><p id="dc8f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">基于两列计算新值，最后将该值添加到新列中</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="91e1" class="kp ig hi kl b fi kq kr l ks kt">total_pressure = df['Pressure9am'] + df['Pressure3pm']<br/>df.insert(loc=len(df.columns), column='Total Pressure', value=total_pressure)</span><span id="7419" class="kp ig hi kl b fi ku kr l ks kt">df.head()</span></pre><p id="5527" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">使用上面的代码，我们在数据集的最后添加了一个新的计算列。</p><p id="4010" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">loc参数是要在其后插入新列的列数，因此我们将该值指定为列的长度，以便在最后一列中添加一个新列。</p><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mo"><img src="../Images/5d9e98bc3e7c4ae07324dce4bdc7ec3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SW_nRKrqpcNA30qxHCVxvg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: Adding new column after transformation</figcaption></figure><p id="a43c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">简单的方法:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d9ff" class="kp ig hi kl b fi kq kr l ks kt">df['Total Pressure']=df['Pressure9am'] + df['Pressure3pm']</span></pre><p id="c4ed" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">降柱</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="e5f0" class="kp ig hi kl b fi kq kr l ks kt">df.drop(['Total Pressure'], axis=1, inplace=True)</span></pre><p id="dfd2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">当inplace为True时，原始数据集发生变化，axis=1表示我们正在删除该列。</p><p id="891d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">样本数据可视化:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c6bd" class="kp ig hi kl b fi kq kr l ks kt">sns.countplot(x='RainToday', hue='RainTomorrow', data=df);</span></pre><figure class="kg kh ki kj fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mp"><img src="../Images/a93369aafd57d87805031e85e588d652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCRsRPyukbnvP1X7kgv_3g.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Fig: CountPlot of Two columns</figcaption></figure><p id="5882" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这是我们前面讨论的列联表的可视化表示。</p><p id="0b05" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们可以很容易地观察到，如果今天下雨是假的，那么明天下雨的次数就会很高。</p><p id="b3d7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">由于pandas是数据工程方面的一个丰富的库，所以有很多东西可以探索，但是Pandas上面讨论的部分使用频率很高。</p><p id="933f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在接下来的文章中，将尝试包含基于项目的演示。</p><p id="5603" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">完整的Jupyter笔记本和数据可以在下面的链接中找到:</p><p id="4200" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">【https://github.com/prbndulal/Learning T4】</p></div></div>    
</body>
</html>
<html>
<head>
<title>Multiple Selections and Sharing Collection View Items Using UIActivityController</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用UIActivityController进行多重选择和共享集合视图项目</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/multiple-selection-and-sharing-collection-view-items-using-uiactivitycontroller-swift-5-90eec483407a?source=collection_archive---------0-----------------------#2021-02-09">https://medium.com/geekculture/multiple-selection-and-sharing-collection-view-items-using-uiactivitycontroller-swift-5-90eec483407a?source=collection_archive---------0-----------------------#2021-02-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/77ce83732ab798b42990daa44ea3e8d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eQYjqTNCAhWtIMIz"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@benwhitephotography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ben White</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b399" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">今天，我们将实现UIActivityController，以共享我们在上一个教程中已经创建的城市应用程序的图像。如果您还没有查看，您可以在下面的链接中找到它:</p><p id="f930" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" rel="noopener" href="/swlh/making-a-simple-photo-gallery-using-collectionviews-swift-5-7fae34a4eebf">使用UICollectionView (Swift 5)制作简单的照片库</a></p><p id="6cf6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，您需要下载以下相关应用程序才能继续学习本教程:</p><p id="d44d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://github.com/yasarkorkmaz/Cities.git" rel="noopener ugc nofollow" target="_blank">城市app </a></p><p id="3fff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你已经完成下载，让我们开始吧！</p><p id="7845" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请记住，当你与你的朋友分享图片时，你是在选择多张图片并一次全部发送，而不是大多数时候一张一张地发送。默认情况下，城市应用程序允许用户选择单个项目。我们要做的第一件事就是多选。</p><p id="68e2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从在<em class="jt">city collection view controller</em>的导航栏中添加<strong class="ix hj"> <em class="jt"> Share </em> </strong>按钮开始。然后进入<em class="jt"> Main.storyboard </em>，从<em class="jt">对象库</em>中拖动<em class="jt">栏按钮项</em>放入导航栏中。将<em class="jt"> </em>标题设置为<strong class="ix hj"> <em class="jt">份额。</em> </strong></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/d4223c11b8fe34a8a9b2c6f9707da394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwgSVxHhgEPBaeZVyJn7ug.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Adding a bar button item to the navigation bar.</figcaption></figure><p id="ee1d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在<em class="jt">city collection view controller</em>中插入<strong class="ix hj"> <em class="jt"> Share </em> </strong>按钮的出口变量和动作方法:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="e778" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用<em class="jt"> shareBtnTapped </em>方法连接<strong class="ix hj"> <em class="jt"> Share </em> </strong>按钮。此外，将其与<em class="jt"> shareBtn </em> outlet相关联。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/d8d59108710ff4803309deafe5b38078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TaYCaG1L6gdd25vdV8oCIQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Connecting the action button to the action method.</figcaption></figure><p id="6cc3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了支持多选模式，我们将向<em class="jt">city collection view controller</em>添加两个变量。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="39fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们如何拍摄细胞的快照？因为集合视图单元格是UIView类的子类，所以我们将创建一个扩展来增强单元格的快照功能。在项目导航器中，右键单击并创建一个名为<em class="jt">扩展</em>的新组。然后右击<em class="jt">扩展名</em>文件夹，创建一个swift文件。将其命名为<em class="jt">快照</em>。将下面的代码添加到这个新的<em class="jt"> Snapshot.swift </em>文件中。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="ab7e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们拍摄视图快照的方式。让我们继续开发<em class="jt">共享</em>功能。更新<em class="jt">citycollectionview controller</em>中的以下方法，如下所示。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="77ed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们进行多重选择时，最好能准确地了解哪些图像被选中了。为此，我们需要突出显示选定的图像。编辑<em class="jt">cellforrowitmat</em>方法，如下所示；</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="5a4e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">天蓝色</em>是背景图片。在下面的链接中下载它，并添加到项目导航器中的<em class="jt">资产</em>。</p><p id="a2a5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://drive.google.com/file/d/11Rtl8K4ZWBvpFIyth4X3Ue22fGaw03eJ/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">天蓝_背景</a></p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/55a866e8db2e452a21286d42ebf564bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*AVtdwx0iIuCZf_Eu8sEyXQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Selected cell is highlighted with blue colour.</figcaption></figure><p id="0754" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如我们需要选择的方法一样，我们也需要取消选择的方法。当一个项目被取消选择时，它应该从<em class="jt"> selectedImages </em>数组中删除。将下面的代码添加到<em class="jt">city collection view controller</em>中:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="97b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还没有对<em class="jt"> shareBtnTapped </em>按钮做任何事情。我们将实现<em class="jt">共享</em>按钮的方法。一旦用户点击<em class="jt">共享</em>按钮，它就会工作。用以下代码更新方法:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="52a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">编码部分差不多做好了，但是如果运行app，就会面临错误。因为，每一次你点击一张图片，这个片段就会被触发。我们不想在多重选择中触发序列。我们只想在单选模式下触发segue。</p><p id="5015" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，更改<em class="jt"> didSelectItemAt </em>函数，如下所示:</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="9242" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">仅此而已！运行应用程序并尝试共享。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/df5a0a97747e2cfe9f1b11c2362a313c.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*9qlzu7cR0mLM9OMmiNWSRg.png"/></div></figure><p id="98d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以从下面的链接下载完整的版本。</p><p id="1432" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://github.com/yasarkorkmaz/Cities_Share.git" rel="noopener ugc nofollow" target="_blank"> Github链接。</a></p></div></div>    
</body>
</html>
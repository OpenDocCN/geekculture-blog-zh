<html>
<head>
<title>Tutorial: build a i18n app with Vue3, Vuex4 and the composition API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教程:用Vue3、Vuex4和组合API构建一个i18n应用程序</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/tutorial-build-a-i18n-app-with-vue3-vuex4-and-the-composition-api-42edc8afa320?source=collection_archive---------16-----------------------#2021-08-25">https://medium.com/geekculture/tutorial-build-a-i18n-app-with-vue3-vuex4-and-the-composition-api-42edc8afa320?source=collection_archive---------16-----------------------#2021-08-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5c647ea00a0de019be92bfed5572b454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmJrOkqOcO32k-g0Jh432A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">the finished app</figcaption></figure><p id="80e3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当你为国际人群构建一个web应用程序时，你必须处理好应用程序的国际化问题。如果你的圈子里只有懂英语的人，那你就没问题。</p><p id="86e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是也许你想用你的用户的母语来称呼他们。如果是这样的话，你需要在你的网络应用中安装语言检测和语言切换器。</p><p id="be59" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">今天我将向你展示如何用Vue3、Vuex和新的组合API 从URL和语言切换器组件构建语言检测。</p><h1 id="6b2f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">这个计划</h1><p id="579b" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">我想创建一个应用程序，有这样的鼻涕虫<a class="ae kv" href="https://www.website.com/de" rel="noopener ugc nofollow" target="_blank">https://www.website.com/de</a>，<a class="ae kv" href="https://www.website.com/de" rel="noopener ugc nofollow" target="_blank">https://www.website.com/</a>恩，<a class="ae kv" href="https://www.website.com/de" rel="noopener ugc nofollow" target="_blank">https://www.website.com/</a>es。</p><p id="6902" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，我想根据用户正在访问的slug向用户显示一条问候消息。访问/de的用户将看到德语消息，/en英语消息，/es西班牙语消息。</p><p id="3867" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">我知道使用</strong><a class="ae kv" href="https://kazupon.github.io/vue-i18n/" rel="noopener ugc nofollow" target="_blank">https://kazupon.github.io/vue-i18n/</a>可以更简单地实现语言检测和国际化。但是在本教程中，我们将只研究蛞蝓。</p><h1 id="eaaf" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">先决条件</h1><p id="2645" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">对于这个项目，我们将使用Vite。如果你不熟悉Vite，你可以在这里查看<a class="ae kv" href="https://vitejs.dev/" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="be91" class="kw jt hi bd ju kx ky kz jy la lb lc kc jf ld le kg jj lf lg kk jn lh li ko lj bi translated">创建您的项目</h2><p id="ce7d" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">只需运行<code class="du lk ll lm ln b">yarn create vite</code>或<code class="du lk ll lm ln b">npm init vite@latest</code>并选择<strong class="iw hj"> vue </strong>。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/ad30f2e5a50d728d909744db079fcbb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5OZWV5otkiZVgHUQIZhCkg.png"/></div></div></figure><h2 id="ae8a" class="kw jt hi bd ju kx ky kz jy la lb lc kc jf ld le kg jj lf lg kk jn lh li ko lj bi translated">编码</h2><p id="76ae" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">首先我们要把<code class="du lk ll lm ln b">App.vue</code>所有我们不需要的东西都搬走。到现在为止，您的<code class="du lk ll lm ln b">App.vue</code>文件应该是这样的:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><h2 id="748e" class="kw jt hi bd ju kx ky kz jy la lb lc kc jf ld le kg jj lf lg kk jn lh li ko lj bi translated">添加Vuex</h2><p id="d5a3" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">现在我们要将Vuex添加到我们的项目中。Vuex是Vue.js应用程序的状态管理模式+库。我们希望全局设置活动语言，以便在每个页面和组件上都可用。如果你对Vuex，尤其是Vuex4一无所知，你可以在这里阅读全部内容:<a class="ae kv" href="https://next.vuex.vuejs.org/" rel="noopener ugc nofollow" target="_blank">https://next.vuex.vuejs.org/</a>。</p><p id="84d0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">要将Vuex添加到你的Vue3项目中，只需运行<code class="du lk ll lm ln b">yarn add --dev vuex@next</code>。</p><p id="ea6a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，创建一个<code class="du lk ll lm ln b">store</code>文件夹，并在该文件夹中使用以下代码创建<code class="du lk ll lm ln b">index.js</code>:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="d406" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如你所见，我们现在将英语设置为默认语言。</p><p id="a925" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们的<code class="du lk ll lm ln b">main.js</code>中，我们需要告诉我们的应用程序，我们想要使用我们刚刚创建的商店。</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="f23b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Inside <code class="du lk ll lm ln b">App.vue</code>我们想利用我们的商店。<strong class="iw hj">提醒:我们正在使用组合API。所以我们在&lt;脚本&gt;标签中创建的每个变量在&lt;模板&gt;中都自动可用。</strong></p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="e293" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这给了我们商店的<code class="du lk ll lm ln b">activeLanguage</code>。如你所见，我将它声明为一个计算属性。这意味着<code class="du lk ll lm ln b">activeLanguage</code>在存储更新时会改变它的值。</p><p id="2e22" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这就是我们接下来要做的。我们需要一些方法来更新商店中的<code class="du lk ll lm ln b">activeLanguage</code>值(` index.js `)。</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="b6cc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如您所见，我们有一个调用突变的操作，然后它更新了<code class="du lk ll lm ln b">activeLanguage</code>的值。当这种情况发生时，<code class="du lk ll lm ln b">App.vue</code>中<code class="du lk ll lm ln b">activeLanguage</code>的值也会更新。</p><h2 id="5796" class="kw jt hi bd ju kx ky kz jy la lb lc kc jf ld le kg jj lf lg kk jn lh li ko lj bi translated">带来翻译</h2><p id="eb18" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">接下来，我们将创建一个<code class="du lk ll lm ln b">translations.json</code>文件，在这里我们可以放入我们的翻译字符串。我想现在我们只是给用户打个招呼。所以现在应该这样做:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="a57f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当用户访问我们的网站时，我们希望向他们显示这个字符串。</p><p id="4089" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们需要在<code class="du lk ll lm ln b">App.vue</code>中导入我们的翻译，然后创建一个方法来返回正确的翻译。我们是这样做的:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="afbc" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们从<code class="du lk ll lm ln b">translations.json</code>中导入了<code class="du lk ll lm ln b">TRANSLATIONS</code>，这只是我们的翻译对象。这个对象有3种语言:de、en和es作为键，每种语言都有一个问候语翻译字符串作为值。</p><p id="e99c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如您所见，<code class="du lk ll lm ln b">translateString()</code>将我们想要翻译的字符串作为参数。那么我们只是返回我们想要翻译的字符串。</p><h2 id="5e32" class="kw jt hi bd ju kx ky kz jy la lb lc kc jf ld le kg jj lf lg kk jn lh li ko lj bi translated">语言切换器组件</h2><p id="3f5b" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">最后但同样重要的是，我们将创建一个组件来切换语言，而无需在地址栏中手动更改slugs。</p><p id="70a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以让我们在<code class="du lk ll lm ln b">components</code>目录中创建一个名为<code class="du lk ll lm ln b">LanguageSwitcher.vue</code>的组件。这个组件看起来是这样的:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="5e33" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在我们的组件中，我们只有一个包含我们想要显示的3种语言的数组和一个改变<code class="du lk ll lm ln b">activeLanguage</code>的方法。此方法将操作分派到activeLanguage发生更改的存储区。</p><p id="25f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">最后，我们只需要在<code class="du lk ll lm ln b">App.vue</code>中导入新创建的组件，并将其放入模板中。</p><p id="73db" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这是我们完成的<code class="du lk ll lm ln b">App.vue</code>的样子:</p><figure class="lp lq lr ls fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><h1 id="b189" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">完成的应用程序</h1><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/349f66b7aa8e42a0683bc96f2162688c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*PZffr-PyfaVSeZzzlDi9bA.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Here is our finished project</figcaption></figure><p id="14ab" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我希望你跟得开心。如果你对我们在这里做的任何事情有疑问，或者你只是想说声嗨，请在评论中提出来。</p><p id="01a0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，你可以在推特上向我问好！</p><p id="3143" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以在这里找到这个项目<a class="ae kv" href="https://github.com/Ic3m4n34/language-switcher-vite-vue3" rel="noopener ugc nofollow" target="_blank">的所有代码</a>。</p></div></div>    
</body>
</html>
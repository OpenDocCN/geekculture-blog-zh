<html>
<head>
<title>AB Testing: Splitting the Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AB测试:拆分数据</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/ab-testing-splitting-the-data-cd510059b3d3?source=collection_archive---------8-----------------------#2022-06-17">https://medium.com/geekculture/ab-testing-splitting-the-data-cd510059b3d3?source=collection_archive---------8-----------------------#2022-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/b758a71407a2c0e74d03252214601ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDG_bSmSWizkNPcexi3IQA.jpeg"/></div></div></figure><div class=""/><h1 id="a375" class="iq ir ht bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">问题？我可以AB测试，但是我需要先拆分我的数据！</h1><p id="0285" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">AB测试可能是数据驱动商业决策的最具标志性和最直观的用途之一。有大量的资源可以学习如何进行AB测试，通常是使用预先标记的“A”和“B”数据。但是，当我想在现实生活中实现AB测试时，我碰壁了:</p><p id="467c" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们如何决定哪些用户在浏览网站时显示“A”版本或“B”版本？</p><p id="2726" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们如何以随机的方式分割用户？</p><p id="d93d" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们如何分割用户，以便在他们每次登录时显示相同版本的AB测试？</p><p id="b57f" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如何分割用户，使我们能够执行ABC测试，并继续测试新版本？</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="daa2" class="iq ir ht bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">解决办法？桶和散列！</h1><p id="ce53" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">不是实体的，而是数字的。让我们想一想，如果我们有两组客户，我们可以很容易地将他们对半分。我们可以简单地将这些桶标记为A和B，但是我们也可以创建更多的桶，允许我们以不同的比例划分，将C添加到测试中，或者甚至非常容易地执行新的测试。通过将客户分成24个桶，我们可以将他们分成2组、3组、4组等。</p><p id="eb8b" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们也可以保留一些桶来观察复合测试的长期效果。</p><p id="9117" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们正在寻找一种方法，将我们的用户唯一标识符(用户id)从字符串转换为1到24(或0到23)之间的整数。</p><p id="dd37" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果用户id已经是一个整数，那么使用模数运算(以24为基数)将用户“映射”到24个不同的组就很简单了。假设用户id是随机的，那么结果也将是随机的。这也将确保用户每次访问网站时总是被分配到相同的存储桶。</p><p id="8e1d" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">将字符串转换为整数的一种方法是使用哈希。在相当高的层面上，散列是…函数。他们接受输入并把它们映射到另一个维度。它们也是确定性的，所以它们将保持我们的结果一致。对于我们正在做的事情的所有意图和目的，它们也是“随机的”(在结果散列中不应该有一个模式)。这是一个好消息，即使原始用户id中有某种模式！</p><p id="68e2" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在python中，用户可以获取他们的用户id字符串，然后:</p><ol class=""><li id="91dd" class="ld le ht jq b jr km jv kn jz lf kd lg kh lh kl li lj lk ll bi translated">用utf-8编码，</li><li id="e82c" class="ld le ht jq b jr lm jv ln jz lo kd lp kh lq kl li lj lk ll bi translated">对结果使用散列函数(例如Sha1)，</li><li id="4166" class="ld le ht jq b jr lm jv ln jz lo kd lp kh lq kl li lj lk ll bi translated">然后，将编码的数据表示成字节(例如使用。hexdigest())，</li><li id="bd12" class="ld le ht jq b jr lm jv ln jz lo kd lp kh lq kl li lj lk ll bi translated">将字节表示转换为整数表示(使用int())，</li><li id="f796" class="ld le ht jq b jr lm jv ln jz lo kd lp kh lq kl li lj lk ll bi translated">最后，使用模数运算将整数映射到24个桶中的一个(或者任意多个)(使用%)。</li></ol><p id="b92a" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">它看起来像这样(使用sha1散列函数):</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="f0d6" class="ma ir ht lw b fi mb mc l md me">int(hashlib.sha1(user_id.encode("utf-8")).hexdigest(), 16) % 24</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="9698" class="iq ir ht bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">最后的话</h1><p id="2e1e" class="pw-post-body-paragraph jo jp ht jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">就是这样！现在，每个用户将由一个从0到23的随机整数来表示。人们可以很容易地构建桶和条件语句的列表，以向每个客户显示期望的输出。</p><p id="1d3b" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这些也是快速计算的，因此它们允许在运行中分割用户，同时一致地向相同的用户显示相同的版本。</p><p id="6069" class="pw-post-body-paragraph jo jp ht jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">享受你的AB测试！</p></div></div>    
</body>
</html>
# 微服务架构的最佳实践

> 原文：<https://medium.com/geekculture/best-practices-for-microservices-architecture-9cd896fb41b5?source=collection_archive---------5----------------------->

![](img/6bf9deb871abe0a459b0bd544f055e57.png)

Photo by [Leon](https://unsplash.com/@myleon?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

在我之前的文章: [***微服务介绍***](/geekculture/introduction-to-microservices-9dcaafa5d882) **，**中我已经讨论过关于微服务架构，它的特点，以及它的优缺点。如果你是微服务的新手，我强烈推荐你去读一读那篇文章，除非你对基本的微服务知识很熟悉。因此，在本文中，我将讨论构建成功的微服务应用程序的最佳实践。

# 领域驱动设计

当你必须开发一个微服务应用程序时，你必须面对的第一个挑战是，将一个大的、复杂的应用程序分割成小的、自治的、可独立部署的服务。如果没有以适当的方式拆分，它就不是一个松散耦合的微服务。因此，它将具有整体建筑的所有缺点。幸运的是，有一个很好的解决方案叫做领域驱动设计。这有助于您的软件团队和架构师理解不同的业务领域，因此他们可以基于这些业务领域设计微服务。因此，在开发微服务应用之前，有一个全新的领域驱动设计是非常重要的。

# 防止硬编码值

在微服务架构中，有一个缺点，即它具有分布式系统的所有相关复杂性。因此，假设在您的微服务应用程序中，有两个名为“A”和“B”的服务。以防万一，如果服务“A”想要调用服务“B”，A 应该有 B 的地址。该地址可能是主机名、URL 或 IP 地址。但问题是，一些开发人员习惯于硬编码这个地址。这并没有错，直到您的网络团队决定更改地址。因此，开发人员需要更改服务“A”中硬编码地址，并再次部署它。所以，在微服务应用中，代码应该总是动态的。在这种情况下，您可以使用服务发现工具来发现其他服务。

# 记录

无论是开发整体应用程序还是微服务应用程序，日志记录都是您必须做的事情。但问题是，当谈到微服务时，我们花了很多时间来考虑业务边界和分割应用程序逻辑的最佳方式，而我们忘记了考虑日志。因此，缺少日志不是一个好习惯，如果您有不必要的日志，情况也是如此。

## 相关 ID

通常在微服务中，发现问题并记录下来比 monolithic 要复杂一点，因为它有多个服务。例如，假设有 3 个服务，分别命名为“A”、“B”和“C”。现在，您正在记录每个服务的访问和错误日志。假设如果您在服务 B 中发现一个错误，那么知道该错误是由来自服务 A 的请求还是发送到服务 c 的请求引起的可能会很有用。但是，如果您有一个关联请求 ID，那么您只需要在日志中查找该 ID。您将从服务中获得所有日志，这些服务是系统主请求的一部分。此外，您可以知道主请求在哪个服务中花费的时间最多，以及一个服务是否多次调用其他服务。

所以，关键是不要到处记录，只记录你开始这个过程的地方。但是，请确保记录堆栈跟踪以了解问题实际发生在哪里，否则您会感到困惑，并且在搜索问题发生的位置时会很困难。

# 版本化微服务

无论您开发的是微服务还是整体应用程序，都有两种标准的版本控制技术，它们在软件社区中很流行:语义版本控制和日历版本控制。然而，当涉及到微服务架构时，版本控制非常有用，因为开发人员需要针对单个服务进行更新，而不是整个应用程序。

## 1)语义版本化

语义版本化是一种技术，它使用三个非负整数值来标识版本类型。在这种技术中，版本格式表示为**“主要.次要.补丁”.**

当您在一个有许多模块(服务)的项目上工作，并且每个模块都相互依赖于另一个模块时，语义版本化是一个理想的实践。因此，语义版本化被认为是最适合微服务的版本化技术。

## 2)日历版本控制

日历版本化有点类似于前面讨论的技术，语义版本化。但是，这种方法使用日历日期而不是非负整数。在日历版本控制中，并不严格要求特定的日期格式，但必须明确指出年、月和日。

当应用程序定期进行更新时，日历版本控制被认为是一个很好的实践，因为它可以帮助开发人员通过搜索发布日期找到以前或现有的版本。

> 如果你想了解更多关于微服务版本化技术的细节，可以关注这个链接= >[https://searchapparchitecture . techtarget . com/tip/Get-to-know-4-microservice-versioning-techniques](https://searchapparchitecture.techtarget.com/tip/Get-to-know-4-microservices-versioning-techniques)

# 处理认证和授权

当您在微服务应用中实现这些机制时，您必须确保遵循全局身份验证和授权策略。在这种策略中，有一个专用微服务来处理认证和授权过程。因此，每个业务服务都必须在处理请求之前对其进行身份验证，方法是将请求下行传输到身份验证服务。

# 管理依赖关系

在微服务架构中，管理依赖关系不同于单一应用程序，因为每个服务都独立运行。但是，一个服务可能需要访问另一个服务。例如，假设有两个名为“A”和“B”的服务。所以，当你想部署 A 时，如果它也要求部署 B 服务，就意味着你违反了微服务架构。因此，请确保小心管理依赖关系。

# 容错

当您开发微服务应用程序时，很有可能会出现更多的故障。因此，您需要适当地管理它们。大多数情况下，如果您的微服务依赖于另一个系统来提供响应，并且如果它需要更多的时间来响应，将会影响您的应用程序的整体性能。幸运的是，我们可以通过使用断路器使外部调用超时并返回默认响应或错误来避免这种情况。这将阻止失败的服务，因此，微服务将无任何故障地工作。

# 文件

尽管大多数开发人员不喜欢听到这个词，但文档是任何软件开发中必不可少的一部分。因此，您需要适当地记录您的工作，否则其他人将无法清楚地了解这些服务。然而，有一个叫做 **Swagger** 的工具，可以帮助你实时生成文档。所以，你可以用专业术语写文档，Swagger 会把它们转换成合适的、有吸引力的文档。

所以，这是我的文章的结尾，我希望你喜欢它。快乐编码👨‍💻。

# 参考

[](https://www.bmc.com/blogs/microservices-best-practices/) [## 构建微服务架构的 15 个最佳实践

### 微服务是一种演进的架构模式，它将应用程序的设计和开发作为一种…

www.bmc.com](https://www.bmc.com/blogs/microservices-best-practices/) [](https://www.capitalone.com/tech/software-engineering/10-microservices-best-practices/) [## 最佳架构设计的 10 项微服务最佳实践| Capital One

### 1.单一责任原则就像代码一样，一个类应该只有一个改变的理由…

www.capitalone.com](https://www.capitalone.com/tech/software-engineering/10-microservices-best-practices/) [](https://dzone.com/articles/microservices-logging-best-practices) [## 微服务日志记录最佳实践- DZone 微服务

### 微服务架构是一种应用程序结构，它促进了松散耦合系统的使用，使您能够…

dzone.com](https://dzone.com/articles/microservices-logging-best-practices)
<html>
<head>
<title>How to Create an SSH Tarpit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个SSH Tarpit</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-create-an-ssh-tarpit-f3b48af1b60c?source=collection_archive---------8-----------------------#2021-05-22">https://medium.com/geekculture/how-to-create-an-ssh-tarpit-f3b48af1b60c?source=collection_archive---------8-----------------------#2021-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f31237ea9b0e651ae0f444f502b0d884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X99WlACwU3ssAyxW.png"/></div></div></figure><h1 id="42e3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">为什么有一个宋承宪沥青坑？</h1><p id="7031" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如果你有任何使用SSH(安全套接字外壳)连接访问的服务器，你会很熟悉它是如何被我的黑客用来访问你的服务器的。但是，通过查看您的服务器验证日志，您还会注意到如下所示的内容:</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/4694085ff3903d1369a98b0a2b69e7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EwNSvClCQVqXKmWs.png"/></div></div></figure><p id="c827" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">你会注意到，机器人已经数千次试图用一些默认凭证登录到你的服务器，这种方法本质上被称为“暴力”技术。现在，如果您已经为您的服务器设置了一个不安全的密码并启用了密码验证，并且使用了SSH的默认端口，那么您很有可能拥有一个受损的服务器。如果您遵循一些标准的最佳实践来设置您的Linux服务器，这些攻击可能看起来是无害的。</p><p id="ba34" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">在本帖中，我们将用一种扭曲的方式来保护我们的服务器。我们将让黑客们尝尝他们自己的药。😉</p><p id="4462" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">为了执行我们的技巧，我们将利用所显示的“横幅”,以及对显示其内容的时间长度没有真正限制的事实。此外，我们知道任何服务器的SSH默认端口通常是22。现在，我们将使用这个概念来迫使黑客阅读一个非常长的横幅，这个横幅基本上永远不会结束，我们称之为<strong class="jq hj"> endlessh (endless SSH) </strong>或<strong class="jq hj"> SSH tarpit </strong>。通过这种方法，您不仅保护了您的服务器，而且还浪费了黑客的宝贵时间，否则这些时间可能会被用来危害其他服务器。</p><h1 id="0e5d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">如何创建一个SSH Tarpit？</h1><p id="3c97" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们将通过名为<code class="du kx ky kz la b">endlessh</code>的<a class="ae kw" href="https://github.com/skeeto" rel="noopener ugc nofollow" target="_blank"> skeeto </a>为此使用一个git存储库。登录到您的服务器并克隆存储库</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="a547" class="lf ir hi la b fi lg lh l li lj">git clone <a class="ae kw" href="https://github.com/skeeto/endlessh.git" rel="noopener ugc nofollow" target="_blank">https://github.com/skeeto/endlessh.git</a></span></pre><p id="d95a" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，转到目录并编译目录</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="53b0" class="lf ir hi la b fi lg lh l li lj">cd endlessh<br/>make</span></pre><p id="5164" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">如果你使用的是基于Debain的操作系统，你可能会在编译程序时出错。您将需要安装<code class="du kx ky kz la b">libc6-dev</code>库，这可以使用<code class="du kx ky kz la b">apt</code>包管理器来完成</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="48a1" class="lf ir hi la b fi lg lh l li lj">sudo apt-get install libc6-dev</span></pre><p id="3a8b" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">然后，我们会将二进制文件移动到您的<code class="du kx ky kz la b">path</code>文件夹中</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="a05b" class="lf ir hi la b fi lg lh l li lj">sudo mv endlessh /usr/local/bin/</span></pre><p id="3a78" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，让我们来验证一下</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="efbd" class="lf ir hi la b fi lg lh l li lj">which endlessh<br/># it should print the path like /usr/local/bin/endlessh</span></pre><p id="10a6" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，我们需要妖魔化它，为此我们将复制<code class="du kx ky kz la b">systemd</code>服务文件</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="1fc9" class="lf ir hi la b fi lg lh l li lj">sudo cp util/endlessh.service /etc/systemd/system/</span></pre><p id="d2d7" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，我们将启用<code class="du kx ky kz la b">systemd</code>服务</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="3de9" class="lf ir hi la b fi lg lh l li lj">sudo systemctl enable endlessh</span></pre><p id="16cd" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，我们要做的最后一件事是创建配置文件，首先创建文件夹，然后在其中创建配置文件，我们将以编辑模式打开它</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="5359" class="lf ir hi la b fi lg lh l li lj">mkdir -p /etc/endlessh<br/>sudo nano /etc/endlessh/config</span></pre><p id="aca4" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">配置文件的内容如下:</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="81e1" class="lf ir hi la b fi lg lh l li lj">PORT 22 # this is becasue endlessh runs by default on port 2222</span></pre><p id="05d6" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，我们完成了设置，让我们启动服务</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="2863" class="lf ir hi la b fi lg lh l li lj">sudo systemctl start endlessh</span></pre><p id="c7b7" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">同样，让我们验证它是否真的在运行</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="a1ac" class="lf ir hi la b fi lg lh l li lj">netstat -tulpn | grep enlessh</span></pre><p id="f5c4" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">一旦确认服务正在运行，就大功告成了。很简单，不是吗？</p><h1 id="3893" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">嘲笑黑客</h1><p id="d052" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们现在将在另一个终端窗口上模拟一个黑客试图通过SSH进入服务器</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="b825" class="lf ir hi la b fi lg lh l li lj">ssh root@&lt;server-address&gt; -p 22</span></pre><p id="9267" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在，你将什么也看不见。为了实际了解幕后发生了什么，我们将使用verbose选项进行SSH</p><pre class="kn ko kp kq fd lb la lc ld aw le bi"><span id="572a" class="lf ir hi la b fi lg lh l li lj">ssh -vvv root@&lt;server-address&gt; -p</span></pre><p id="18f2" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">你会注意到用户会在横幅中不断得到胡言乱语，每一行都要花将近30秒才显示出来。由于横幅通常不被视为可以明确执行超时的任何东西，黑客将使用的脚本将永远停留在这个阶段，否则谁会。任务已完成👍。</p><p id="5a8d" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">你成功地浪费了一个黑客的时间和精力。你是坏蛋。😎</p><p id="8bbb" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">现在出去浪费一些人的时间和精力，让世界变得更安全，一次一个服务器。</p><p id="320f" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz kt kb kc kd ku kf kg kh kv kj kk kl hb bi translated">在<a class="ae kw" href="https://www.grizzlybit.dev" rel="noopener ugc nofollow" target="_blank"> Grizzlybit </a>阅读更多信息🐻。</p></div></div>    
</body>
</html>
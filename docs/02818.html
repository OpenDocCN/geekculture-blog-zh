<html>
<head>
<title>How to handle JSON/form data from the body of the URL in node.JS and express.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理节点中URL主体的JSON/form数据。JS和express。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-handle-json-form-data-from-the-body-of-the-url-in-node-js-and-express-4193837c39c7?source=collection_archive---------5-----------------------#2021-05-26">https://medium.com/geekculture/how-to-handle-json-form-data-from-the-body-of-the-url-in-node-js-and-express-4193837c39c7?source=collection_archive---------5-----------------------#2021-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="4bd7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">1)使用“节点”处理请求对象主体内的数据。JS ":———</h1><ul class=""><li id="ddd7" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">首先，我们必须使用node创建一个服务器。JS。点击此链接:- " <a class="ae jv" rel="noopener" href="/geekculture/how-to-create-a-basic-server-using-node-js-b696ce54c90a"> <strong class="jf hj"> <em class="jw">了解如何使用node创建服务器。JS </em> </strong> </a>”。</li><li id="6d24" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">一旦创建了服务器，现在我们必须创建一个名为"<strong class="jf hj"> data </strong>的新变量来存储来自<strong class="jf hj">请求</strong>对象的<strong class="jf hj">主体</strong>的输入数据。</li><li id="f1e7" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">我们知道request也是一个eventEmitter，所以我们可以使用它的req.on()方法。</li><li id="5f2c" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">req.on()也有两个方法1) <strong class="jf hj">数据</strong> 2) <strong class="jf hj">结束。</strong></li></ul><p id="76b8" class="pw-post-body-paragraph kc kd hi jf b jg ke kf kg ji kh ki kj jk kk kl km jm kn ko kp jo kq kr ks jq hb bi translated"><strong class="jf hj">1)</strong>当数据开始以小块的形式传入时，将调用“data”，并重复执行，直到数据停止传入。</p><p id="82c5" class="pw-post-body-paragraph kc kd hi jf b jg ke kf kg ji kh ki kj jk kk kl km jm kn ko kp jo kq kr ks jq hb bi translated"><strong class="jf hj">2)“end”</strong>将在数据停止到来时被调用。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es kt"><img src="../Images/a203e01eb47e67207b0bfb925f15cd98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*jBGIjfMOkLLfvdUtlgUnBw.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx">creating req.on methods.</figcaption></figure><ul class=""><li id="30f3" class="jd je hi jf b jg ke ji kh jk lf jm lg jo lh jq jr js jt ju bi translated">在“<strong class="jf hj">数据</strong>方法中，我们必须将它存储在数据变量中以备后用。</li></ul><h2 id="4a29" class="li ig hi bd ih lj lk ll il lm ln lo ip jk lp lq it jm lr ls ix jo lt lu jb lv bi translated">情况URL主体中的传入数据是JSON格式的。</h2><ul class=""><li id="f287" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">现在，我们必须处理"<strong class="jf hj">POST</strong>" request on route "<strong class="jf hj">/json</strong>"，它们在格式JSON的主体中有传入的数据。</li><li id="c34d" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">我们可以编写如下图所示的条件:-</li></ul><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lw"><img src="../Images/f99664bfb4a3c6b6e1c7e7ea8e20ff91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ET5HNNBTvLiIgOEpOkmclg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx">handling POST request for JSON data format.</figcaption></figure><ul class=""><li id="8ad0" class="jd je hi jf b jg ke ji kh jk lf jm lg jo lh jq jr js jt ju bi translated">这里我们知道<strong class="jf hj"> res.end() </strong>只接受<strong class="jf hj">字符串数据</strong>或<strong class="jf hj">缓冲区数据</strong>，传入的数据是格式字符串，这就是为什么我们可以将它直接传递给res.end()。</li></ul><h2 id="3252" class="li ig hi bd ih lj lk ll il lm ln lo ip jk lp lq it jm lr ls ix jo lt lu jb lv bi translated">情况URL主体中的传入数据是“form/urlencoded”格式。</h2><ul class=""><li id="831e" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">现在，我们必须处理"<strong class="jf hj">POST</strong>" request on route "<strong class="jf hj">/form</strong>"它在格式urlencoded/form的主体中有传入数据。</li><li id="a16c" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">我们可以编写如下图所示的条件:-</li></ul><figure class="ku kv kw kx fd ky er es paragraph-image"><div class="er es mb"><img src="../Images/4136db7aebebfdc54d0af6527e04cc48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*SEaORbjSu800ONgE8Sbv5w.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx">handling POST request for form/urlencoded data</figcaption></figure><ul class=""><li id="8692" class="jd je hi jf b jg ke ji kh jk lf jm lg jo lh jq jr js jt ju bi translated">这里，传入的数据是"<strong class="jf hj">urlencoded/form</strong>data "格式，所以首先我们必须使用<strong class="jf hj"> fs模块</strong>及其"<strong class="jf hj"> fs.parse()" </strong>方法将其转换为对象形式。</li><li id="89bb" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">解析之后，它被存储在变量“<strong class="jf hj"> dataObj </strong>中。</li><li id="86cd" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在，我们可以对"<strong class="jf hj"> dataObj" </strong>对象中的数据做任何事情。</li><li id="258b" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">如果我们必须将其作为响应发送，那么我们必须使用对象上的<strong class="jf hj"> "JSON.stringify()" </strong>方法将其转换为stringified格式。</li><li id="a6a5" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在，我们可以将这些数据传递给"<strong class="jf hj"> res.end() </strong>"方法。</li></ul></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><h1 id="e7d7" class="if ig hi bd ih ii mj ik il im mk io ip iq ml is it iu mm iw ix iy mn ja jb jc bi translated">2)使用“expressJS”处理请求对象主体内部的数据</h1><ul class=""><li id="d75e" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">首先，我们必须使用express创建一个服务器。我的博客链接是:- " <a class="ae jv" rel="noopener" href="/geekculture/express-server-using-npm-and-handling-routes-524d7a6205a7"> <strong class="jf hj"> <em class="jw">点击这里学习如何使用express </em> </strong> </a>创建服务器。</li><li id="43b9" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在，我们必须安装npm包“morgan”来记录关于请求的信息。命令:- " <strong class="jf hj"> <em class="jw"> npm我摩根--保存</em> </strong>"。</li><li id="26da" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在，我们可以使用morgan作为第一个中间件，它将在每次发出请求时执行。</li><li id="d553" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在，要在URL的主体中添加数据，需要将其转换为对象，还需要添加到“<strong class="jf hj">req . body”</strong>中。</li><li id="73d6" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">Express允许我们使用以下方法完成上述所有步骤</li></ul><p id="58ab" class="pw-post-body-paragraph kc kd hi jf b jg ke kf kg ji kh ki kj jk kk kl km jm kn ko kp jo kq kr ks jq hb bi translated">I)<strong class="jf hj"><em class="jw">app . use(express . JSON())</em></strong>。</p><p id="0027" class="pw-post-body-paragraph kc kd hi jf b jg ke kf kg ji kh ki kj jk kk kl km jm kn ko kp jo kq kr ks jq hb bi translated">ii)<strong class="jf hj"><em class="jw">app . use(express . urlencoded())</em></strong>。</p><ul class=""><li id="ae10" class="jd je hi jf b jg ke ji kh jk lf jm lg jo lh jq jr js jt ju bi translated">上面提到的代码会将URL正文中的数据转换为对象格式，并将其添加到“<strong class="jf hj"> req.body </strong>”中。</li><li id="43a9" class="jd je hi jf b jg jx ji jy jk jz jm ka jo kb jq jr js jt ju bi translated">现在我们可以在路由中间件中使用“<strong class="jf hj"> req.body </strong>”来访问对象。</li></ul><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mo"><img src="../Images/0846888e48367003fa1015e63949e18e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7x4T25R3Eu0yoFab_nQG2A.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx">handling JSON/form-data inside body or URL using express in node.js</figcaption></figure></div></div>    
</body>
</html>
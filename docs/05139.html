<html>
<head>
<title>RequestAnimationFrame in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的RequestAnimationFrame</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/requestanimationframe-in-javascript-82a913cf8c46?source=collection_archive---------0-----------------------#2021-07-12">https://medium.com/geekculture/requestanimationframe-in-javascript-82a913cf8c46?source=collection_archive---------0-----------------------#2021-07-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/e568b54e6b9547c476f7be6844ecb21c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VYcZCiOWTO5wJ_UoaploEQ.png"/></div></div></figure><div class=""/><p id="7973" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用本地的requestAnimationFrame方法，我们可以让我们的浏览器永远快速地重复某件事情。它调用自己来绘制下一帧。</p><p id="1975" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">📝注意:如果你想在下一次重画时制作另一帧的动画，你的回调函数必须再次调用<strong class="is hu"> requestAnimationFrame() </strong>。requestAnimationFrame()是1个镜头。</p><p id="5065" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> requestAnimationFrame </strong>接受一个参数，只有回调。</p><p id="8e62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">语法:</strong></p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9b04" class="jx jy ht jt b fi jz ka l kb kc">window.requestAnimationFrame(callback);</span></pre><p id="9836" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">回调</strong>:在下一次重画时更新动画时调用的函数。</p><p id="9a3d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">带有<strong class="is hu"> requestAnimationFrame </strong>的动画是非阻塞的，这意味着如果您对<strong class="is hu"> requestAnimationFrame </strong>进行后续调用，所产生的动画将同时发生。</p><p id="d58f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目标是<strong class="is hu">每秒60帧(fps) </strong>以出现平滑的动画。</p><p id="112f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以我们确实喜欢这个👇</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="895a" class="jx jy ht jt b fi jz ka l kb kc">setInterval(() =&gt; {<br/>  // animation code<br/>}, 1000/60);</span></pre><p id="f83b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是现在我们有了<strong class="is hu"> requestAnimationFrame </strong>，更加优秀和优化:</p><ul class=""><li id="14af" class="kd ke ht is b it iu ix iy jb kf jf kg jj kh jn ki kj kk kl bi translated">动画将如此顺利，因为它的优化</li><li id="8c3f" class="kd ke ht is b it km ix kn jb ko jf kp jj kq jn ki kj kk kl bi translated">非活动标签中的动画将停止，让CPU冷却</li></ul><p id="6cc7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看如何使用requestAnimationFrame创建上面的代码片段</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1258" class="jx jy ht jt b fi jz ka l kb kc">function smoothAnimation() {<br/>    // animtion<br/>    requestAnimationFrame(smoothAnimation)<br/>}<br/>requestAnimationFrame(smoothAnimation)</span></pre><h1 id="495b" class="kr jy ht bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">你如何开始和停止动画⏲️</h1><p id="3af8" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn hb bi translated"><strong class="is hu"> requestAnimationFrame </strong>返回一个可以用来取消它的ID。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="175e" class="jx jy ht jt b fi jz ka l kb kc">let reqAnimationId;<br/>function smoothAnimation() {<br/>    // animtion<br/>    reqAnimationId = requestAnimationFrame(smoothAnimation)<br/>}</span><span id="c0cd" class="jx jy ht jt b fi lt ka l kb kc">// to start<br/>function start() {<br/>    reqAnimationId = requestAnimationFrame(smoothAnimation)<br/>}</span><span id="0459" class="jx jy ht jt b fi lt ka l kb kc">// to end<br/>function end() {<br/>     cancelAnimationFrame(reqAnimationId)<br/>}<br/>console.log("reqAnimationId", reqAnimationId)</span></pre><p id="916b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击<strong class="is hu">打开</strong>查看更多详情:</p><figure class="jo jp jq jr fd hk"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h1 id="bec3" class="kr jy ht bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">参考🧐</h1><ul class=""><li id="83df" class="kd ke ht is b it lo ix lp jb lw jf lx jj ly jn ki kj kk kl bi translated"><a class="ae lz" href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame" rel="noopener ugc nofollow" target="_blank">request animation frame的MDN文档</a></li><li id="294e" class="kd ke ht is b it km ix kn jb ko jf kp jj kq jn ki kj kk kl bi translated"><a class="ae lz" href="https://www.paulirish.com/2011/requestanimationframe-for-smart-animating/" rel="noopener ugc nofollow" target="_blank">保罗·爱尔兰请求动画帧</a></li></ul><h1 id="e786" class="kr jy ht bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">总结#</h1><p id="6ac4" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn hb bi translated">如果您在浏览器上制作任何动画，并希望对其进行优化，那么我们强烈建议您使用requestAnimationFrame web API。</p><p id="ede8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢你阅读❤️的文章，希望你喜欢这篇文章。</p><p id="88c6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">🌟<a class="ae lz" href="https://twitter.com/suprabhasupi" rel="noopener ugc nofollow" target="_blank">推特</a>👩🏻‍💻suprabha.me🌟<a class="ae lz" href="https://www.instagram.com/suprabhasupi/" rel="noopener ugc nofollow" target="_blank"> Instagram </a></p></div></div>    
</body>
</html>
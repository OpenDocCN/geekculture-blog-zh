<html>
<head>
<title>How to Plot Model Loss During Training in TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在TensorFlow中绘制训练期间的模型损失</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-plot-model-loss-while-training-in-tensorflow-9fa1a1875a5?source=collection_archive---------0-----------------------#2021-04-13">https://medium.com/geekculture/how-to-plot-model-loss-while-training-in-tensorflow-9fa1a1875a5?source=collection_archive---------0-----------------------#2021-04-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3250" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何通过策划模型学习来加强模型训练。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/34dfaa3fa5b1efaf9486e7b2b0d82ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K0-B_U6NnOT4KrCJlpRVHg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image By Author (Logos by Keras and Tensorflow)</figcaption></figure><p id="bab4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果你正在训练20个纪元，Keras进度条看起来不错，但是<strong class="jp hj">没有人想在他们的日志</strong>中无限滚动300个纪元进度条(我觉得这很恶心)。这使得很难了解训练的进展，这只是<strong class="jp hj">不好的练习</strong>(至少如果你是在Jupyter笔记本上训练的话)。</p><p id="4a0c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">另一种方法是绘制一个简单的图，在训练和测试损失的情况下，每一个时期或每n步更新一次。这是一个极其简单的实现，而且更加有用和有洞察力。</p><p id="b0c7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">所以让我们开始吧。</p><h1 id="d370" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">Keras回调是如何工作的</h1><p id="edb6" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">Keras回调是一个具有不同函数的类，这些函数在训练期间的不同时间执行[1]:</p><ul class=""><li id="73b6" class="lg lh hi jp b jq jr jt ju jw li ka lj ke lk ki ll lm ln lo bi translated">当<code class="du lp lq lr ls b"><strong class="jp hj">fit</strong></code> / <code class="du lp lq lr ls b"><strong class="jp hj">evaluate</strong></code> / <code class="du lp lq lr ls b"><strong class="jp hj">predict</strong></code>开始&amp;结束时</li><li id="5e81" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">当每个时期开始和结束时</li><li id="881a" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">当每个训练批次开始和结束时</li><li id="0716" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">当每个评估(测试)批次开始和结束时</li><li id="32b6" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">当每个推理(预测)批次开始和结束时</li></ul><p id="3829" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们将重点关注历元函数，因为我们将在每个历元结束时更新绘图。在这些功能中，你可以做任何你想做的事情，所以你可以让你的想象力自由驰骋。但是现在让我们专注于这个应用程序。</p><h1 id="d60b" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">我们的定制回拨</h1><p id="6767" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">每个函数接收参数<em class="ly"> logs，</em>，它是一个字典，包含每个度量名称(精度、损失等)的对应历元值:</p><pre class="iy iz ja jb fd lz ls ma mb aw mc bi"><span id="7aaf" class="md kk hi ls b fi me mf l mg mh">logs == {<br/>  'accuracy' : 0.98,<br/>  'loss': 0.1<br/>}</span></pre><p id="a5d9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了绘制训练进度，我们需要存储这些数据，并在每个新的时期更新这些数据。我们将创建一个字典来存储指标。每个键对应一个指标，并有一个列表作为其值。</p><h1 id="48a6" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">火车上开始</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="151c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当训练开始时，我们将初始化所有的值。对于每个时期，我们将更新度量字典并更新绘图。</p><h1 id="ba60" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">在纪元结束时</h1><p id="932e" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">首先，我们将新的日志值存储到我们的数据结构中:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="f610" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，我们为每个指标创建一个图表，其中将包括培训和验证指标。在这里，我们清除前一个时期的输出，生成一个带有子图的图形，并为每个指标绘制图形，然后检查是否有等效的验证指标:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mi mj l"/></div></figure><h1 id="3b5e" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">运行我们的回拨</h1><p id="dd1a" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">您可以使用任何其他回调的任何详细级别运行此回调。当我们实现它时，它将清除输出，并更新绘图，所以没有必要删除日志。你甚至可以保留进度条来获得更多的交互性。</p><p id="721a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为此，您只需在回调列表中包含我们实现的函数:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="3fa8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，当您调用fit()时，您将获得这些实时更新的漂亮图形:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/cfbde8356e79d8e02ba4104785164df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*o6K46mRI8-a6GCVihLlcMQ.gif"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image by Author</figcaption></figure><h1 id="4ee5" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">总结</h1><p id="910e" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">现在，您可以以更清晰、更直观的方式现场展示您的训练。像这样对你的工作流程做一些小小的改变，为我节省了很多时间，也提高了我对工作方式的整体满意度。</p><p id="6575" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这只是我的实现，你还可以用回调做很多其他有用的事情，所以试试吧，创造一些美丽的东西！</p><p id="66e4" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是完整的实现:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mi mj l"/></div></figure></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><p id="2042" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">参考资料:</p><p id="36ef" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">[1] <a class="ae ms" href="https://www.tensorflow.org/guide/keras/custom_callback" rel="noopener ugc nofollow" target="_blank">张量流文档</a></p><div class="mt mu ez fb mv mw"><a href="https://betterprogramming.pub/4-keras-callbacks-that-will-change-the-way-you-train-ml-models-a0df2592d36b" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab dw"><div class="my ab mz cl cj na"><h2 class="bd hj fi z dy nb ea eb nc ed ef hh bi translated">4个Keras回调将改变你训练ML模型的方式</h2><div class="nd l"><h3 class="bd b fi z dy nb ea eb nc ed ef dx translated">添加模型检查点、CSV记录器等等</h3></div><div class="ne l"><p class="bd b fp z dy nb ea eb nc ed ef dx translated">better编程. pub</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk jh mw"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Installing Python 3.x dev environment on MacOS the right way and automating new project setup using Automator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以正确的方式在MacOS上安装Python 3.x开发环境，并使用Automator自动设置新项目</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/installing-python-3-x-development-environment-on-macos-a64c0141b20c?source=collection_archive---------2-----------------------#2021-06-21">https://medium.com/geekculture/installing-python-3-x-development-environment-on-macos-a64c0141b20c?source=collection_archive---------2-----------------------#2021-06-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/87c1e41526091088e04fc1686479dee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEe4Lulr-B6fprsOD5g8Iw.jpeg"/></div></div></figure><p id="ea13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我最近购买了一台Macbook Air，自从第一台MacBook Air问世以来，我一直将MacOS系统作为我的个人电脑。然而，我一直在工作中使用Windows Thinkpad进行开发，多年来，Windows已经为开发社区制作了一些优秀的版本。PowerShell、WSL2和最近发布的包管理器。</p><p id="1e27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我仍然对苹果产品和设计着迷，并且总是在Mac开发环境下执行我的个人项目。我发现有几个步骤可以有效地将我的python开发建立在MacOS上，现在归结为肌肉内存。在本帖中，我们将了解:</p><ol class=""><li id="373b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">升级到Python 3+</li><li id="783c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">Python虚拟环境</li><li id="f21f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">[可选] Over engineer Mac的automator使用VScode</li></ol><h1 id="8cac" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">升级到Python 3+(正确的方式)</h1><p id="5f30" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">MacOS自带python版本。您可以通过在终端中执行以下命令来检查您当前安装的python版本</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="1d96" class="lo kd hi lk b fi lp lq l lr ls">python --version</span></pre><h2 id="373a" class="lo kd hi bd ke lt lu lv ki lw lx ly km jb lz ma kq jf mb mc ku jj md me ky mf bi translated">步骤1: GCC安装</h2><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/e12b7e1306ff2474c4d9d661b4a30b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*CEAi84MXUcyFG_iiTl22Ig.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx">Xcode app in Mac App store</figcaption></figure><p id="e9f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Python安装将需要GCC安装。在Mac上正确安装GCC最简单的方法是从app store安装<a class="ae ml" href="https://apps.apple.com/in/app/xcode/id497799835?mt=12" rel="noopener ugc nofollow" target="_blank"> Xcode </a></p><p id="070e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您已经安装了Xcode，那么您可以跳过这一步</p><p id="b1c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您执行Xcode的全新安装，您还需要通过在“终端”中执行以下命令来添加命令行工具</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="3030" class="lo kd hi lk b fi lp lq l lr ls">$ xcode-select --install</span></pre><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/83f2c4dbb96aff970803d3ceac91ebe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*SXNrvxw8W2xdqGEhB5R14w.png"/></div></figure><h2 id="ad08" class="lo kd hi bd ke lt lu lv ki lw lx ly km jb lz ma kq jf mb mc ku jj md me ky mf bi translated">第二步:安装自制软件</h2><p id="2b2c" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">与linux不同，MacOS中缺少包管理器。“家酿安装了你需要的苹果(或你的Linux系统)没有的<a class="ae ml" href="https://formulae.brew.sh/formula/" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"/></a>。”</p><p id="56c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了<a class="ae ml" href="https://brew.sh/#install" rel="noopener ugc nofollow" target="_blank">安装家酿</a>，打开<code class="du mn mo mp lk b">Terminal</code>或者你喜欢的OS X终端模拟器并运行</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="0a6a" class="lo kd hi lk b fi lp lq l lr ls">$ /bin/bash -c "$(curl -fsSL <a class="ae ml" href="https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh</a>)"</span></pre><p id="0df2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦安装了Homebrew，在PATH环境变量的顶部插入Homebrew目录</p><p id="0f7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以通过在~/的底部添加下面一行来做到这一点。配置文件</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="9c5e" class="lo kd hi lk b fi lp lq l lr ls">export PATH="/usr/local/opt/python/libexec/bin:$PATH"</span></pre><p id="3077" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者，您也可以在/etc/paths文件的顶部添加以下内容</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="8643" class="lo kd hi lk b fi lp lq l lr ls">/usr/local/opt/python/libexec/bin</span></pre><h2 id="2f40" class="lo kd hi bd ke lt lu lv ki lw lx ly km jb lz ma kq jf mb mc ku jj md me ky mf bi translated">步骤3:安装Python 3</h2><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="1e8d" class="lo kd hi lk b fi lp lq l lr ls">$ brew install python</span></pre><p id="62f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这需要一两分钟。现在，您可以通过使用“python3”和“pip3”来访问python版本3+和pip</p><h1 id="33fb" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">Python虚拟环境</h1><h2 id="21cf" class="lo kd hi bd ke lt lu lv ki lw lx ly km jb lz ma kq jf mb mc ku jj md me ky mf bi translated">什么是虚拟环境</h2><p id="64fa" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">就其核心而言，python虚拟环境的主要目的是为Python项目创建一个隔离的环境。这意味着每个项目都可以有自己的依赖项，而不管其他项目有什么依赖项</p><h2 id="6c11" class="lo kd hi bd ke lt lu lv ki lw lx ly km jb lz ma kq jf mb mc ku jj md me ky mf bi translated">安装和创建虚拟环境</h2><p id="07e7" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">首先，如果你没有使用Python 3，你需要安装带有<code class="du mn mo mp lk b">pi</code>的<code class="du mn mo mp lk b">virtualenv</code>工具</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="96fe" class="lo kd hi lk b fi lp lq l lr ls">$ pip3 install virtualenv</span></pre><p id="8fc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以选择创建一个新目录，将所有虚拟环境放在一个整洁的地方</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="b9b2" class="lo kd hi lk b fi lp lq l lr ls">$ mkdir python-virtual-environments &amp;&amp; cd python-virtual-environments</span></pre><p id="6707" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在目录中创建新的虚拟环境</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="6818" class="lo kd hi lk b fi lp lq l lr ls">$ python3 -m venv project_env</span></pre><p id="dc09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要激活上面设置的project_env虚拟环境，我们必须从我们新创建的virtaul_env的bin文件夹中获取激活脚本</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="557e" class="lo kd hi lk b fi lp lq l lr ls">$ <!-- -->source project_env/bin/activate<br/>(project_env) $</span></pre><p id="fd15" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，您的提示现在是以您的环境名称为前缀的(在我们的例子中是<code class="du mn mo mp lk b">project_env</code>)。这表明<code class="du mn mo mp lk b">env</code>当前是活动的，这意味着<code class="du mn mo mp lk b">python</code>可执行文件将只使用这个环境的包和设置</p><p id="c98f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要停止使用虚拟环境，您需要做的就是执行deactivate，然后您将退出虚拟环境</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="d459" class="lo kd hi lk b fi lp lq l lr ls">(project_env) $ deactivate<br/>$</span></pre><h1 id="810f" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">改造Mac的automator以使用VScode</h1><p id="885e" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">这个步骤是可选，且在大多数情况下是不需要的。我使用VS代码作为我选择的代码编辑器。每当我创建一个新的python项目时，我必须在VS代码中设置python解释器。我为工作和个人项目制作了许多小的python代码库，并且喜欢在设置VS代码时节省这些额外的时间。</p><p id="3ab1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了解决这个“不是问题”的问题，我使用Mac的Automator工具来创建服务。本服务的目标是</p><ol class=""><li id="729c" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">使用我在finder中选择的文件夹，在以“_env”为后缀的文件夹中创建一个新的虚拟环境</li><li id="a5ee" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">为VS代码创建settings.json文件</li><li id="7b5a" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">更新settings.json以指向我的脚本已经创建的虚拟环境</li><li id="c352" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建main.py文件</li></ol><p id="e8a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为上述任务创建一个自动脚本，使我的工作流程像创建一个文件夹并右键单击该文件夹来选择我的自动脚本一样简单。然后跳转到VS代码，用已经配置好的python解释器和干净的main.py文件来开始我的工作。这一切不知为什么让我真的很开心:)</p><p id="2842" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要复制工作流程</p><ol class=""><li id="ec6f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">启动自动机</li><li id="6c0a" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建新文档</li><li id="7f3a" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">创建新的快速动作</li></ol><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/9044d29f67b9db90efd448e91628aa8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*8D7iEVZ16ZaomX3gWSZ7WQ.png"/></div></figure><p id="34d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.添加动作…</p><ul class=""><li id="b028" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn mr ju jv jw bi translated">工作流从<strong class="is hj">查找器</strong>接收当前<strong class="is hj">文件和文件夹</strong>。</li><li id="5620" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mr ju jv jw bi translated">向工作流添加新的运行Shell脚本操作。(将屏幕截图中突出显示的“运行Shell脚本”对象拖到右侧的空窗口中)</li></ul><p id="206c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.配置工作流</p><ul class=""><li id="d44a" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn mr ju jv jw bi translated">将传递输入设置为<strong class="is hj">作为参数</strong></li><li id="808f" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn mr ju jv jw bi translated">将以下内容粘贴到输入框中:</li></ul><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="0424" class="lo kd hi lk b fi lp lq l lr ls">for f in "$@"<br/>do<br/> parent="$(dirname "$f")"<br/> folder="$(basename "$f")"<br/> cd /$parent/$folder<br/> python3 -m venv "${folder}_env"<br/> mkdir $parent/$folder/.vscode<br/> cat &gt; .vscode/settings.json &lt;&lt;EOF<br/> {<br/>     "python.pythonPath": "$parent/$folder/${folder}_env/bin/python3"<br/> }<br/>EOF<br/>touch $parent/$folder/main.py<br/> cat &gt; $parent/$folder/main.py &lt;&lt;EOF<br/>#!/usr/bin/env python</span><span id="dd03" class="lo kd hi lk b fi ms lq l lr ls">def main():<br/>    print("Hello World")<br/></span><span id="1a20" class="lo kd hi lk b fi ms lq l lr ls">if __name__ == "__main__":<br/>    main()</span><span id="41e6" class="lo kd hi lk b fi ms lq l lr ls">EOF<br/>done</span></pre><p id="426e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.使用类似于<strong class="is hj">的名称保存动作，在VS代码中创建Python项目</strong></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/5e6ed15bd47593859e597a73330da6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*OcS-VN3PNqTsQ3kTIUdntQ.gif"/></div></figure><p id="86e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">就是这样。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to Write Callbacks in Node JS Airtable Lookup for Beginners Easy Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node JS Airtable Lookup中编写回调，初学者简易指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-write-callbacks-in-node-js-airtable-lookup-for-beginners-guide-ada552b1d2c9?source=collection_archive---------16-----------------------#2021-05-08">https://medium.com/geekculture/how-to-write-callbacks-in-node-js-airtable-lookup-for-beginners-guide-ada552b1d2c9?source=collection_archive---------16-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4007" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我最近开始学习Node.js，我对网上学习回调的所谓“基本”指南的难度和技术性感到失望。</p><ul class=""><li id="863f" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><a class="ae jm" href="https://javascriptissexy.com/understand-javascript-callback-functions-and-use-them/" rel="noopener ugc nofollow" target="_blank">https://JavaScript sexy . com/understand-JavaScript-callback-functions-and-use-them/</a></li><li id="ac58" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated"><a class="ae jm" href="https://stackoverflow.com/questions/3458553/javascript-passing-parameters-to-a-callback-function" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/3458553/JavaScript-将参数传递给回调函数</a></li><li id="efeb" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated">【https://zellwk.com/blog/nested-callbacks/ T4】</li><li id="cff6" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated"><a class="ae jm" href="https://www.jstips.co/en/javascript/passing-arguments-to-callback-functions/" rel="noopener ugc nofollow" target="_blank">https://www . jstips . co/en/JavaScript/passing-arguments-to-callback-functions/</a></li><li id="6e96" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated"><a class="ae jm" href="https://www.pluralsight.com/guides/javascript-callbacks-variable-scope-problem" rel="noopener ugc nofollow" target="_blank">https://www . plural sight . com/guides/JavaScript-callbacks-variable-scope-problem</a></li><li id="4567" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc ji jj jk jl bi translated"><a class="ae jm" rel="noopener" href="/@fotios.floros/explaining-javascript-callbacks-3d5a9ad52819">https://medium . com/@ foti OS . floros/explaining-JavaScript-callbacks-3d 5a 9 ad 52819</a></li></ul><p id="88a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像setTimeout，Promises，foo，“承诺在现实生活中是一样的”所有这些其他的语言对于初学者来说是非常混乱的。</p><p id="9722" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以让我从基础开始。</p><h1 id="acac" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">为什么我们需要复试？</h1><p id="cdca" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">如果你像我一样，你习惯于编写<em class="kv">同步</em>代码，这意味着如果你想让函数2从函数1获取数据，你应该首先编写函数1，让它计算一个变量，然后函数2将使用该变量运行。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2f77" class="lf jt hi lb b fi lg lh l li lj">Synchronous code: </span><span id="7bee" class="lf jt hi lb b fi lk lh l li lj">const airtable = require('airtable');</span><span id="f737" class="lf jt hi lb b fi lk lh l li lj">//Lookup the courses you're enrolled in based on your name<br/>function fetchCoursesByName(name) {</span><span id="0f67" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>return coursesArr;</span><span id="78af" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="992b" class="lf jt hi lb b fi lk lh l li lj">//returns an array of your schedule on a day<br/>function fetchScheduleByDay(courses, day) {</span><span id="f83c" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>return scheduleArr;</span><span id="3b50" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="2a5f" class="lf jt hi lb b fi lk lh l li lj">testFetchScheduleByDay() {</span><span id="c187" class="lf jt hi lb b fi lk lh l li lj"> var name = "Bob";<br/> var day = "Wednesday";<br/> var courses = fetchCoursesByName(name);<br/> var schedule = fetchScheduleByDay(courses, day);<br/> console.log("Your schedule on " + day + " is" + schedule);</span><span id="cafd" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="6dbd" class="lf jt hi lb b fi lk lh l li lj">testFetchScheduleByDay();</span></pre><p id="f2aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">以上代码在Node.js </strong>上不起作用。原因是，如果您正在调用数据库或外部资源，那么在您尝试按天 (fetchScheduleByDay)查找您的课程表之前，获取您的课程列表(fetchCoursesByName) <em class="kv">的调用可能不会完成。事实上，因为节点JS基本上向下读取，并且在移动到下一行之前不等待一个函数完成，所以这将总是返回:</em></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7190" class="lf jt hi lb b fi lg lh l li lj">Your schedule on Wednesday is undefined</span></pre><p id="9f38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想得到一天的时间表，那就没什么用了。</p><h1 id="b6b5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">让我们以一个数据库为例</h1><p id="2d57" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">假设我们想从两个表中查找数据。第一个是学生注册的课程名称列表。</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ll"><img src="../Images/d232bc9ed2bcb20452aed1dc6e7243ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKVWAAHQK1_EWCbO_GqzDQ.png"/></div></div></figure><p id="d896" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第二个表格列出了一周内的授课内容和时间。</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lt"><img src="../Images/1ab9501158344aa9cb293e8ab4a99c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OH96U8zVC0fvPWmOLkhuZA.png"/></div></div></figure><p id="8db2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码的目标是输入姓名和日期，例如“Bob”，“星期三”，并让它返回Bob在星期三的日程安排。让我们假设编写的代码也对讲座进行了排序，这样它们就有了正确的时间顺序。</p><p id="13d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入:</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lu"><img src="../Images/ddd2ab878dd7a764d39d73d9678a8801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSIGV1bb7IqCCon2-DPS4Q.png"/></div></div></figure><p id="3b18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div class="er es lv"><img src="../Images/97ef60bdb48fd9a0a6564a5b1774f2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*rHa2HeOGS_xsa5sm-P5fXw.png"/></div></figure><p id="3691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样一个程序的目的是，如果你是一个健忘的学生，你不记得你那天的课，你可以给一个托管这个代码的服务发消息，它会回复你一天的时间表。类似的东西可以扩展到任何需要查找给定输入数据的地方。</p><p id="03e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你已经知道我们想用Node.js做什么了，让我们来谈谈回调。</p><h1 id="0d03" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">下面是如何为Node.js编写这个代码</h1><p id="5d7a" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">要将本文开头的代码转换成异步代码，必须在所有函数中添加callback这个词。</p><p id="2ca7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在互联网上有各种各样令人困惑的东西，关于如何写这段代码，所以我会尽量让它变得简单。</p><p id="ef75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一次拿一块。要使一个函数“回调友好”,你需要做两件事。</p><ol class=""><li id="522d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc lw jj jk jl bi translated">首先，在函数中添加一个名为“callback”的参数。</li><li id="911e" class="jd je hi ih b ii jn im jo iq jp iu jq iy jr jc lw jj jk jl bi translated">然后，将您的返回声明从“return coursesArr”更改为“callback(coursesArr)”。</li></ol><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7d6e" class="lf jt hi lb b fi lg lh l li lj">Asynchronous code:</span><span id="47e2" class="lf jt hi lb b fi lk lh l li lj">const airtable = require('airtable');</span><span id="d574" class="lf jt hi lb b fi lk lh l li lj">//Lookup the courses your enrolled in based on your name<br/>function fetchCoursesByName(name, callback) {</span><span id="b022" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here <br/>callback(coursesArr);</span><span id="e9da" class="lf jt hi lb b fi lk lh l li lj">}</span></pre><p id="f349" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你在那个返回语句中告诉Node.js做的事情是，一旦函数fetchCoursesByName准备好了，就返回它，并使用它最终计算的值。</p><p id="da9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们调用外部数据库，所以我们需要对第二个函数做同样的事情，</p><p id="2b2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><fetchschedulebyday/></p><p id="f086" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将添加单词callback作为参数，并将函数中的单词return替换为单词callback。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="afaf" class="lf jt hi lb b fi lg lh l li lj">asynchronous code </span><span id="5826" class="lf jt hi lb b fi lk lh l li lj">//returns array of your schedule on a Day<br/>function fetchScheduleByDay(courses, day, callback) {</span><span id="3600" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here</span><span id="a280" class="lf jt hi lb b fi lk lh l li lj">callback(scheduleArr);</span><span id="b2bb" class="lf jt hi lb b fi lk lh l li lj">}</span></pre><p id="226c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面，大家可以对比对比一下区别。</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lx"><img src="../Images/5474f23cf152571f3b502593d213dc5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s-R1_Uzeiv4Y48iY-6kC0A.png"/></div></div></figure><p id="fee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们所做的只是添加单词“callback”作为附加参数，并将单词callback替换为单词“return”。</p><p id="e979" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们必须编写实际运行这些函数的代码。我们想首先获取学生的名字，然后返回他们的课程列表。然后，我们希望根据他们指定的日期查找他们的课程列表。</p><p id="00ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们必须编写实际运行这些函数的cod。我们希望首先获取学生的姓名，然后返回他们的课程列表。然后，我们希望根据他们指定的日期来查看他们的日程安排。我们什么都不需要他们的专业(top function)，但是我把它包含在顶部，以依次显示三个函数的回调。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="5c50" class="lf jt hi lb b fi lg lh l li lj">function testCode(name, day) <br/>{</span><span id="b2af" class="lf jt hi lb b fi lk lh l li lj"><strong class="lb hj">fetchMajorbyName</strong>(name, (major) =&gt; {<br/>  console.log('Your major is ' + major);<br/>  <strong class="lb hj">fetchCoursesByName</strong>(name, (courses) =&gt; {<br/>    console.log('Your courses are ' + courses);<br/>    <strong class="lb hj">fetchScheduleByDay</strong>(courses, day, (schedule) =&gt; {<br/>       console.log('Your schedule is ' + schedule);<br/>       <strong class="lb hj">return schedule</strong>;<br/>    });<br/>  });<br/>});</span></pre><p id="40ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这段代码是可行的。这是告诉Node一次执行一个函数，在完成前一个函数之前不要执行下一个函数。这样你就可以先运行你的函数，然后是第二个，最后是第三个。</p><p id="cc08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的语法是，无论你放在括号里的是什么，都是你想要返回的东西的名字。所以你是说当你调用fetchCoursesByName函数时，返回变量“courses”作为输出。</p><p id="be5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以很容易地给括号中的这些东西命名。下面的代码运行相同:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4bba" class="lf jt hi lb b fi lg lh l li lj">function testCode(name, day)<br/>{</span><span id="7e72" class="lf jt hi lb b fi lk lh l li lj">fetchMajorbyName(name, (major) =&gt; {<br/>  console.log('Your name is ' + name);<br/>  fetchCoursesByName(name, (uggabugga) =&gt; {<br/>    console.log('Your courses are ' + uggabugga);<br/>    fetchScheduleByDay(uggabugga, day, (schedule) =&gt; {<br/>       console.log('Your schedule is ' + schedule);<br/>       return schedule;<br/>    });<br/>  });<br/>});</span></pre><p id="c8d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的参数uggabugga将返回fetchCoursesByName输出的任何内容。我们知道fetchCoursesByName将为学生输出课程列表，所以这就是uggabugga中的值。基本上，无论你写什么作为最后一个参数，都是要被向前传递的。</p><p id="48e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以为你完事了？我也这么认为。这应该可以在您的计算机上本地运行。</p><p id="8b09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如果我们想从外部调用这个函数，从另一个服务，我们想从另一个函数调用它，我们就有麻烦了，它会返回未定义的。我不知道为什么，但我认为这是因为它会在等待所有回调函数返回之前，遍历你的嵌套函数。所以你必须指示你的另一个函数等待，直到你得到所有的数据，然后再继续。为了做到这一点，我们需要做两件事。<strong class="ih hj">首先</strong>，我们需要重做我们的testCode函数，使其成为一个回调函数。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="3e00" class="lf jt hi lb b fi lg lh l li lj">function testCode(name, day, callback)<br/>{</span><span id="52ba" class="lf jt hi lb b fi lk lh l li lj">fetchNamebyId(id, (name) =&gt; {<br/>  console.log('Your name is ' + name);<br/>  fetchCoursesByName(name, (uggabugga) =&gt; {<br/>    console.log('Your courses are ' + uggabugga);<br/>    fetchScheduleByDay(uggabugga, day, (schedule) =&gt; {<br/>       console.log('Your schedule is ' + schedule);<br/>       callback(schedule);<br/>    });<br/>  });<br/>});</span></pre><p id="0652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在这里所做的只是将参数“callback”添加到顶部，并使用“callback(schedule)”而不是return语句返回fetchSchedulebyDay中的数据。</p><p id="7764" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然testCode是一个回调函数，我们可以从另一个函数调用它，它将返回正确的信息。第二件要做的事情是<strong class="ih hj">编写调用它的函数作为承诺</strong>，这样它会等到testCode完成后再继续前进。</p><p id="d7ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我正在使用的工具说执行程序的函数必须被称为“main ”,并且只能接受一个名为“params”的东西。这些就是我将要面对的限制。现在我添加这最后一段代码，以便调用上面的testCode，并确保它返回正确的结果。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="2f47" class="lf jt hi lb b fi lg lh l li lj">function main(params) {<br/>  return new Promise((resolve, reject) =&gt; {<br/>    params.name = "Bob"<br/>    params.day = "Wednesday";<br/>    testCode(params.name, params.day, (schedule)=&gt; {<br/>      resolve(schedule);<br/>    });<br/>  }).then((data)=&gt;{<br/>    console.log("The promise has been resolved");<br/>    return data;<br/>  });<br/>}</span></pre><p id="8823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会看到上面这个符号是不同的，我们要用一个叫做承诺的东西，它与回调有关。我不知道它们之间的确切关系，但是上面的代码基本上会等到testCode运行并返回时间表，然后再进入“Then”部分。</p><p id="9ff7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[需要找出如何添加错误以显示“拒绝”部分]</p><p id="da87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的语法是，我从承诺的第一部分返回的东西被写成resolve(schedule)。我认为这意味着resolve也是回调，但我可能错了。无论如何，你要用resolve(schedule)这个词来把事情从承诺的第一部分退掉。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="0593" class="lf jt hi lb b fi lg lh l li lj">testCode(name,params.day,(schedule)=&gt;{<br/>      resolve(schedule);<br/>    });</span></pre><p id="2239" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转移到“然后”的部分是你最终想要返回的东西。这里的语法基本上是你从括号中的第一部分得到的，你返回它。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ebc0" class="lf jt hi lb b fi lg lh l li lj">}).then((data)=&gt;{<br/>    console.log("The promise has been resolved");<br/>    return data;<br/>  });</span></pre><p id="3804" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你也可以把它作为一个JSON对象返回，这是我必须为我正在使用的程序做的。因此，为了以json的形式返回函数，只需将上面的“返回数据”改为</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="102e" class="lf jt hi lb b fi lg lh l li lj">}).then((data)=&gt;{<br/>    console.log("The promise has been resolved");<br/>    return {result:data};<br/>  });</span></pre><p id="c8be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将返回一个带有一个名称-值对的JSON，其中“result”是名称，“data”是值。这将返回到你的程序中:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="7963" class="lf jt hi lb b fi lg lh l li lj">{"result" : ["Art History 9:00 - 9:50", "Calculus 11:00 - 11:50", "Sociology 1:00 - 1:50"]}</span></pre><p id="0bd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你可以调用你的main(params)函数，你可以在任何一天传递它。它可能是({"day":"Monday"})或({"day":"Thursday"})，并且将运行相同的代码</p><p id="cf05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以传递两个主要参数，它会做同样的事情。({"day":"Tuesday "，" name":"Lisa"})它将返回Lisa Monroe的星期二日程安排。</p><p id="d57b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还没有把Github和所有这些代码放在一起，但是我很快就会了。希望有所帮助！</p><p id="385f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢Jordan Soltman 在互联网和数小时数天的搜索都未能弄清楚这一点的情况下，他给了我宝贵的建议，向我解释了回电的基本知识。</p><figure class="kw kx ky kz fd lm er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ly"><img src="../Images/4a67a6cf669dfc7545c2eb1bfc9eb336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NRYhiJ-SqDX_OPM00sQkug.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx">This should work locally on your computer</figcaption></figure></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><h1 id="28d0" class="js jt hi bd ju jv mk jx jy jz ml kb kc kd mm kf kg kh mn kj kk kl mo kn ko kp bi translated">常见问题解答</h1><p id="4648" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated"><strong class="ih hj">如果我的函数最初没有任何参数呢？</strong></p><p id="97b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有一个不带任何参数的函数，你可以通过添加一个参数来使用相同的语法。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="df02" class="lf jt hi lb b fi lg lh l li lj">synchronous version </span><span id="bc2d" class="lf jt hi lb b fi lk lh l li lj">fetchAllCourses() {</span><span id="1cc0" class="lf jt hi lb b fi lk lh l li lj">//code that returns a list of all courses at the University</span><span id="f44a" class="lf jt hi lb b fi lk lh l li lj">return listofCourses;</span><span id="647b" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="8703" class="lf jt hi lb b fi lk lh l li lj">asynchronous version </span><span id="e9d7" class="lf jt hi lb b fi lk lh l li lj">fetchAllCourses(callback) {</span><span id="3ed7" class="lf jt hi lb b fi lk lh l li lj">//code that returns a list of all courses at the University</span><span id="1605" class="lf jt hi lb b fi lk lh l li lj">callback(listofCourses);</span><span id="9804" class="lf jt hi lb b fi lk lh l li lj">}</span></pre><p id="220a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上使用单词“callback”代替return，并确保将其作为参数添加。</p><p id="e536" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么时候需要让函数回调友好？</strong></p><p id="3295" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不太确定答案，但我认为答案是在您调用外部服务的任何时候，即使是非常快速的调用，因为会有一些未知的处理时间。</p><p id="838d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何知道一个函数是否正在使用回调？</p><p id="6df6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我寻找一种奇怪的符号，它使用一个括号，后跟一个花括号和一个分号。如果我在某个地方看到了，我就知道这部分代码是在调用外部的东西，因此我需要让我的函数“回调友好”。</p><p id="c6cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">)}；</strong></p><p id="9a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为什么我需要使用承诺？</strong></p><p id="acb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你从一个外部服务调用运行你的代码的函数，比如AWS Lambda或者IBM Cloud函数，你需要告诉你的程序在返回之前等待数据。你不能只调用运行代码的函数。你需要通过一个承诺来调用你的函数，函数必须做成回调，所以一切都知道要等有数据了再返回。本文前面的代码演示了Promise部分，并将textCode转换为回调。</p></div><div class="ab cl md me gp mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="hb hc hd he hf"><h2 id="a331" class="lf jt hi bd ju mp mq mr jy ms mt mu kc iq mv mw kg iu mx my kk iy mz na ko nb bi translated"><strong class="ak">沙盒区</strong></h2><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="0518" class="lf jt hi lb b fi lg lh l li lj">Asynchronous code:</span><span id="0a1b" class="lf jt hi lb b fi lk lh l li lj">const airtable = require('airtable');</span><span id="b164" class="lf jt hi lb b fi lk lh l li lj">//Lookup the courses your enrolled in based on your name<br/>function fetchCoursesByName(name, callback) {</span><span id="276a" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>callback(coursesArr);</span><span id="5b62" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="a802" class="lf jt hi lb b fi lk lh l li lj">//returns array of your schedule on a day<br/>function fetchScheduleByDay(courses, day, callback) {</span><span id="12c6" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>callback(scheduleArr);</span><span id="a315" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="7c26" class="lf jt hi lb b fi lk lh l li lj">function testFetchScheduleByDay() {<br/> <br/> var name = "Bob";<br/> var day = "Wednesday";<br/> fetchCoursesByName(name, (courses) =&gt; {<br/>   console.log('Your courses are ' + courses);<br/>   fetchScheduleByDay(courses, day, (schedule) =&gt; {<br/>      console.log('Your schedule is ' + schedule);<br/>      return schedule;<br/>   });<br/> });</span><span id="317e" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="bf0d" class="lf jt hi lb b fi lk lh l li lj">testFetchScheduleByDay();</span></pre><p id="26ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是一切。用Promise和testCode作为回调:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="d137" class="lf jt hi lb b fi lg lh l li lj">Asynchronous code:</span><span id="3cdd" class="lf jt hi lb b fi lk lh l li lj">const airtable = require('airtable');</span><span id="5782" class="lf jt hi lb b fi lk lh l li lj">//Lookup the courses your enrolled in based on your name<br/>function fetchCoursesByName(name, callback) {</span><span id="13ca" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>callback(coursesArr);</span><span id="1cba" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="515a" class="lf jt hi lb b fi lk lh l li lj">//returns array of your schedule on a day<br/>function fetchScheduleByDay(courses, day, callback) {</span><span id="93cc" class="lf jt hi lb b fi lk lh l li lj">//show the code that operates here<br/>callback(scheduleArr);</span><span id="8297" class="lf jt hi lb b fi lk lh l li lj">}</span><span id="9ea0" class="lf jt hi lb b fi lk lh l li lj">function testCode(name, day, callback)<br/>{</span><span id="93f0" class="lf jt hi lb b fi lk lh l li lj"> fetchMajorbyName(name, (major) =&gt; {<br/>   console.log('Your name is ' + name);<br/>   fetchCoursesByName(name, (uggabugga) =&gt; {<br/>     console.log('Your courses are ' + uggabugga);<br/>     fetchScheduleByDay(uggabugga, day, (schedule) =&gt; {<br/>        console.log('Your schedule is ' + schedule);<br/>        callback(schedule);<br/>     });<br/>   });<br/> });<br/>}</span><span id="b777" class="lf jt hi lb b fi lk lh l li lj"><br/>function main(params) {<br/>  return new Promise((resolve, reject) =&gt; {<br/>    params.name = "Bob"<br/>    params.day = "Wednesday";<br/>    testCode(params.name, params.day, (schedule)=&gt; {<br/>      resolve(schedule);<br/>    });<br/>  }).then((data)=&gt;{<br/>    console.log("The promise has been resolved");<br/>    return data;<br/>  });<br/>}</span></pre></div></div>    
</body>
</html>
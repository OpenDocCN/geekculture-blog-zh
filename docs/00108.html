<html>
<head>
<title>Updated How to create multiple Documents with Docx.js with JSON data in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更新了如何使用JavaScript中的JSON数据用Docx.js创建多个文档</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/updated-how-to-create-multiple-documents-with-docx-js-with-json-data-in-javascript-b1924879b288?source=collection_archive---------0-----------------------#2020-06-04">https://medium.com/geekculture/updated-how-to-create-multiple-documents-with-docx-js-with-json-data-in-javascript-b1924879b288?source=collection_archive---------0-----------------------#2020-06-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/beeaa94a2ec6495f9f72a80a6b19eb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/1*6nhGYTC3JL0-gLk6pkjbPg.gif"/></div></figure><div class=""/><p id="8644" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我创建了一个关于这个主题的帖子，但这个主题有点过时了，在同一个视频中，人们有点困惑，因为沙盒的代码对他们不起作用，对我来说，我也对codesanbox有点不安，但最终我更新了帖子，更新了代码和视频。</p><figure class="jk jl jm jn fd hk"><div class="bz dy l di"><div class="jo jp l"/></div></figure><p id="ea27" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你想看的话，这是视频</p><h1 id="cb72" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">HTML5结构和CSS3</h1><p id="e189" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">在这种情况下，我只使用了HTML5上的一个按钮和一点Css3来创建一个带有他的id的简单按钮</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/e572ab3a9513524816b45a16c87ec071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Bk2Aihqv2Gvg6Xca5K1Vw.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Creating local html document</figcaption></figure><p id="92ae" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">它看起来像这样</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es lc"><img src="../Images/de2709fbf27a3bd858afedd3dede59c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*SOb9KHzplnDA4Ug2xfdRag.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Creating Button to create Dynamic Documents</figcaption></figure><h1 id="258d" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">图书馆</h1><p id="5376" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">我们需要这些库File-saver和docx.js在我们的index.html中插入的最终版本</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ld"><img src="../Images/2bff6b9c15e57b52d3d96757a2589b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GEp5fg8IolZeppOeBJLYgg.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example Importing libraries</figcaption></figure><pre class="jk jl jm jn fd le lf lg lh aw li bi"><span id="4b2f" class="lj jr hp lf b fi lk ll l lm ln">&lt;!-- Libraries --&gt;</span><span id="5d4a" class="lj jr hp lf b fi lo ll l lm ln">&lt;script <em class="lp">src</em>="https://unpkg.com/docx@5.0.2/build/index.js"&gt;&lt;/script&gt;</span><span id="71ee" class="lj jr hp lf b fi lo ll l lm ln">&lt;script <em class="lp">src</em>="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"&gt;&lt;/script&gt;</span><span id="8ea7" class="lj jr hp lf b fi lo ll l lm ln">&lt;!-- Libraries --&gt;</span></pre><h1 id="bf0e" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">JavaScript的结构</h1><p id="dccf" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">在我们的app.js中，首先我们需要获得按钮的id，然后我们添加一个事件侦听器，在这种情况下是一个click事件，最后我们传递了另一个名为startPDF()的函数</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lq"><img src="../Images/5f691964c19c616a4fa64b8a946f652c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ui0CFN7dKL5pcCRq8_iF2g.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example Importing libraries</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lr"><img src="../Images/a480f0192ac36218eb31c7f449119d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d4bhwSZbCFhCkGkF5NgnyQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Creating the start function</figcaption></figure><p id="cbc2" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们需要在插入doc实例时创建一个变量</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es ls"><img src="../Images/ce859828a75c72b897e4cd9afad518d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*gh7YoGF-qhjS8tt9HqcMVg.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Example create new object of docx</figcaption></figure><p id="67c6" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，在变量doc中，我们需要像这样添加节、段落和文本，在这种情况下，doc保存我们在其中插入的所有段落和文本，这是文档带给我们的新版本和结构，它需要子代来换行段落，并且在段落内部另一个子代来换行文本，等等</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lt"><img src="../Images/85cbd5e2258f7499f5d673a839231f1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3i5dFLR415sA9i46QGUcWA.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example how we need to use this structure to create Documents</figcaption></figure><p id="c92d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，我们需要导出我们的文档，我们需要使用Packer类来等待创建blob的承诺，然后将这个blob添加到saveAs()函数中，它只接收两个参数blob和文档的名称，在本例中为hi.docx。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lu"><img src="../Images/4dcc6b547b579eeff3c99274e5344dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywgN1w-O-ue-SILVv_RGrg.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example using Blob to create the document and export the document with saveAs</figcaption></figure><p id="96cf" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后点击按钮，我们得到了第一份文件</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es lv"><img src="../Images/01f5064adbc822334982c828a8fef262.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*o8MaJf-T2ssuMa1L4hXYxQ.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Example The document is created</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lw"><img src="../Images/4845c64233652efcd9884e93ed7a3e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fxy3_CSF43mdCWM5RPsdtw.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Inside the document</figcaption></figure><p id="b0f3" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，我们需要来自excel的信息来创建动态文档，在这种情况下，我们将使用来自Excel的信息并粘贴该页面中的信息<a class="ae lx" href="https://www.convertcsv.com/csv-to-json.htm" rel="noopener ugc nofollow" target="_blank">https://www.convertcsv.com/csv-to-json.htm</a>来创建JSON数据，我们将它称为FakeDataJson</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ly"><img src="../Images/52d2d7f2d648f0ffcadbf90313c4b58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PprTuAKzsPuMXqUK1Q8-XQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Excel data</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es lz"><img src="../Images/84b94a4372adf266fa44d33663b1497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*bOCLyYYrpJ-mBfuz6hlkiA.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Example Transforming data from Excel to Json</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es ma"><img src="../Images/deb7ba956cdcce9ee4ab68a621e1bee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*fKqmR66BKrbOoEyY_lWNtw.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Example JSON Data</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div class="er es mb"><img src="../Images/6b7d74f3cc11d8d04db3c808a4dc79db.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*PMR4QEGVQK6NlS6vvshZ6w.png"/></div><figcaption class="ky kz et er es la lb bd b be z dx">Create a variable with all the JSON data</figcaption></figure><p id="c749" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后我们创建一个for循环，在其中添加一个auto invoke函数，在auto invoke函数中添加一个setTimeout，然后添加DOCX数据，因为如果不想丢失数据，我们需要稍微延迟for循环，以创建正确时间来生成每个文档，当我尝试这样做时，没有延迟，文档的创建非常快，当循环最终结束时，我得到了4个10个文档。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mc"><img src="../Images/3ffd02f167613477749cc2b158519589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTnmtNF3dsz897XKkcdZGQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example Create the dynamic document with autoinvoke function</figcaption></figure><p id="e1b0" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">但是我们需要创建一个接收三个参数的函数，第一个是doc，第二个是DOCX，第三个是我们文档的名称</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es md"><img src="../Images/b26bb4ecad335261b2be897259ba5b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3pXY2QXS2x8fDVO28cxQCQ.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Passing more parameter to create word documents</figcaption></figure><p id="5a1d" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，我们添加了更多的段落，并用I和国家、年龄、姓名等完全动态地设置数据变量。</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es me"><img src="../Images/0287002250b4ae2df7445f79b8c55e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EAUP50M3yxZaBPCtGXw5cw.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example adding more variables</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mf"><img src="../Images/097c012d7520f7fac1847006bb9275ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Kfu9BM9eIRAX69ffRLK7Q.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example adding more variables</figcaption></figure><p id="107a" class="pw-post-body-paragraph im in hp io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">是的，我们得到了我们的文件</p><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mg"><img src="../Images/efd73fa3dd13dc8fbb74458bfd2adb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tqgL-GqS_R4Jn2jXuOl5kA.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example Creating Dynamic documents</figcaption></figure><figure class="jk jl jm jn fd hk er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mh"><img src="../Images/cf14605b09f76cdfe1d2290776cbe7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3C8OzeSq1EDhPXLdjcdI9w.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx">Example inside every document</figcaption></figure><h1 id="8a51" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="541c" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">这是我的旧帖子的更新版本:<a class="ae lx" rel="noopener" href="/@olivertate274/create-dynamic-word-documents-using-docx-js-file-saver-and-data-from-an-excel-or-json-dbd5e4ec823f">使用DOCX Js、文件保存器和来自EXCEL或JSON的数据创建动态word文档</a>这是一个创建多个文档的伟大工具，结构比过去的版本更好。</p><h1 id="0f9b" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">来源</h1><p id="122a" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated">【https://medium . com/@ Oliver tate 274/create-dynamic-word-documents-using-docx-js-file-saver-and-data-from-an-excel-or-JSON-DBD 5 E4 EC 823 f<br/>T5】https://docx.js.org/#/<br/><a class="ae lx" href="https://youtu.be/71d7Uo5lsQg" rel="noopener ugc nofollow" target="_blank">https://youtu.be/71d7Uo5lsQg</a><br/><a class="ae lx" href="https://www.convertcsv.com/csv-to-json.htm" rel="noopener ugc nofollow" target="_blank">https://www.convertcsv.com/csv-to-json.htm</a></p><h1 id="b8ff" class="jq jr hp bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">完全码</h1><p id="62cb" class="pw-post-body-paragraph im in hp io b ip ko ir is it kp iv iw ix kq iz ja jb kr jd je jf ks jh ji jj hb bi translated"><a class="ae lx" href="https://github.com/rodrigofigueroa/docxjsexample" rel="noopener ugc nofollow" target="_blank">https://github.com/rodrigofigueroa/docxjsexample</a></p></div></div>    
</body>
</html>
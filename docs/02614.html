<html>
<head>
<title>Apache Superset: Export Data to Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache超集:将数据导出到Excel</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/apache-superset-export-data-to-excel-38b8170a30ee?source=collection_archive---------5-----------------------#2021-05-22">https://medium.com/geekculture/apache-superset-export-data-to-excel-38b8170a30ee?source=collection_archive---------5-----------------------#2021-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/de7973f2576c8bcc5f6a616e7c546175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2hppN_okQH8ujQI-ZzNdng.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Apache Superset 1.1.0 with ‘Export to XLSX’ functionality enabled</figcaption></figure><p id="5b88" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Apache Superset是一个现代的BI工具，它通过结合来自通过SQLAlchemy连接的各种数据库的仪表板上的信息，帮助您轻松创建丰富的图表和强大的仪表板。从不同来源收集到一个图表中的数据，可以直接从超集导出到一个逗号分隔文件(CSV)。该CSV文件可以通过许多电子表格软件打开，包括业界领先的Microsoft Excel。但是至少有一个问题可能会使您希望修补超集安装，以便能够将图表中的数据导出为XLSX格式。这个问题就是Microsoft Excel自动识别日期值。</p><p id="4819" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">假设您有一个从超集导出到CSV文件的简单表格。以下是它的内容:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c460" class="kb kc hi jx b fi kd ke l kf kg">Name,Building,Street,ID<br/>Liubov,23/1,Pretty St.,01-04<br/>Mike,17,New St.,16-7</span></pre><p id="1402" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面是您可能认为它在电子表格中的样子:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="914c" class="kb kc hi jx b fi kd ke l kf kg">┌────────┬──────────┬────────────┬───────┐<br/>│  Name  │ Building │   Street   │  ID   │<br/>├────────┼──────────┼────────────┼───────┤<br/>│ Liubov │ 23/1     │ Pretty St. │ 01-04 │<br/>│ Mike   │ 17       │ New St.    │ 16-7  │<br/>└────────┴──────────┴────────────┴───────┘</span></pre><p id="f9b4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果您尝试将这个CSV文件导入Excel，您会感到惊讶。如果没有额外的用户操作，要正确找到表的初始视图并不容易。默认情况下，您的表可能如下所示:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="fea0" class="kb kc hi jx b fi kd ke l kf kg">┌────────┬──────────┬────────────┬────────┐<br/>│  Name  │ Building │   Street   │   ID   │<br/>├────────┼──────────┼────────────┼────────┤<br/>│ Liubov │ <strong class="jx hj">23-Jan</strong>   │ Pretty St. │ <strong class="jx hj">01-Apr</strong> │<br/>│ Mike   │ 17       │ New St.    │ <strong class="jx hj">16-Jul</strong> │<br/>└────────┴──────────┴────────────┴────────┘</span></pre><p id="1669" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如您所见，Excel正试图根据您系统的区域设置将一些数字解释为可能的日期。这个问题会导致人们根据他们在表格中看到的数据做出错误的决定。</p><figure class="js jt ju jv fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/34b1aebd620034a2dd7fcffcb8e31aef.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*4jiPA_7i9YNvC_PbBWg0XQ.png"/></div></figure><p id="1829" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有几种方法可以解决这个问题。您可以教您的用户使用附加操作打开CSV文件:选择“导入”菜单项、将表格拆分成列、设置每列的数据类型等等。这可能会阻止Excel将数字自动解释为日期并使用用户选择的数据类型。另一个解决方案是切换到不同的电子表格软件，例如只使用Office，它会在打开时询问如何解释CSV文件中的数据。但是我发现所有的选项都不够好，因为它们会导致额外的用户咨询费用或贵公司支持的软件列表的变化(可能还有额外的许可费用)。因此，我走了一条不同的路。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="f871" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我的解决方案是通过添加一个新的按钮将数据导出到XLSX文件来修补官方的Apache超集包，XLSX文件可以通过Excel打开，同时不会丢失数据，也不会有额外的用户操作。XLSX是一种比CSV更加可定制的格式。我们不仅可以在其中保存值，还可以保存数据类型。</p><p id="1228" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我使用docker，因此我准备了一个新的docker文件来构建一个中间容器，用于在超集的界面中使用一个附加按钮来生成节点资产，并将这些资产和正确的后端Python文件复制到一个新的映像中。您可以在这个库中找到构建您自己的映像所需的所有文件，并以与使用官方超集映像相同的方式运行它。我不确定Superset将来会如何发展。我已经决定将补丁锁定到文件夹结构和docker文件中的版本。如果您发现这个解决方案在不做任何更改的情况下适用于另一个版本，或者您有时间编辑代码以适用于另一个版本，请在存储库中创建一个新的pull请求，以帮助其他人获得一个将数据从Apache超集导出到XLSX文件的有效解决方案。</p><blockquote class="kq kr ks"><p id="b3f3" class="iu iv kt iw b ix iy iz ja jb jc jd je ku jg jh ji kv jk jl jm kw jo jp jq jr hb bi translated">Upd 1/23/22:自定义版本支持1.3.2和1.4.0版本以及之前的1.1.0版本。另外，GitHub repo中包含了<strong class="iw hj"> run_locally </strong>实用程序，以简化本地运行的过程。</p><p id="a5ff" class="iu iv kt iw b ix iy iz ja jb jc jd je ku jg jh ji kv jk jl jm kw jo jp jq jr hb bi translated">Upd 2/11/22:自定义版本支持1.4.1版以及1.1.0、1.3.2、1.4.0版。<strong class="iw hj"> run_locally </strong>实用程序的默认超集版本现在是1.4.1。</p></blockquote></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><p id="f834" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我希望你喜欢阅读这篇文章。请在<a class="ae kp" rel="noopener" href="/@agordienko">中</a>、<a class="ae kp" href="https://github.com/aleksandrgordienko" rel="noopener ugc nofollow" target="_blank"> GitHub </a>、<a class="ae kp" href="https://twitter.com/data_diving" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae kp" href="https://www.linkedin.com/in/aleksandrgordienko/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p><p id="9430" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请阅读前一篇文章中<a class="ae kp" rel="noopener" href="/geekculture/run-apache-superset-locally-in-10-minutes-30bc70ed808c">关于在Docker容器中运行超集的附加信息。另外，在这里查看关于向您的超集安装添加自定义安全管理器的文章</a><a class="ae kp" rel="noopener" href="/geekculture/custom-security-manager-for-apache-superset-c91f413a8be7">。</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Onboarding New Peer In Running Organization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">运营组织中的新同事入职</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/onboarding-new-peer-in-running-organization-6d378264b31e?source=collection_archive---------11-----------------------#2022-06-17">https://medium.com/geekculture/onboarding-new-peer-in-running-organization-6d378264b31e?source=collection_archive---------11-----------------------#2022-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/2cfeeb0dc36790ce76a9e1ffb3186ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ct_H7XYmPIC1xqgy3X4KsQ.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">HLF Image</figcaption></figure><h1 id="df39" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">介绍</h1><p id="8721" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">在本文中，我将演示如何在Hyperledger fabric network中向现有的运行组织添加新的对等方。</p><h1 id="594e" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">观众</h1><p id="28ed" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">Hyperledger结构操作员，管理员。这是一篇实用实践文章，旨在为管理组织添加新同事。对于初学者，我想建议你，请通过一些Hyperledger织物的基本概念。请访问<a class="ae ky" rel="noopener" href="/geekculture/hyperledger-fabric-blockchain-setup-from-scratch-21890e26aac7">我以前的文章</a>，建立一个HLF网络。</p><blockquote class="kz la lb"><p id="cf0c" class="ka kb lc kc b kd ld kf kg kh le kj kk lf lg kn ko lh li kr ks lj lk kv kw kx hb bi translated"><em class="hi">注意:这篇文章不推荐给HLF初学者。</em></p></blockquote><h1 id="84ee" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">先决条件</h1><ol class=""><li id="b855" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lq lr ls lt bi translated">对<strong class="kc hj"> Hyperledger Fabric区块链</strong>的基本了解。</li><li id="2c98" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">基本了解HLF CA，CouchDB。</li><li id="06b0" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">基本的外壳命令、外壳脚本等。</li></ol><h1 id="8f79" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">系统需求</h1><ol class=""><li id="f13d" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lq lr ls lt bi translated">Docker —版本17.06.2</li><li id="63dd" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">Docker Compose —版本1.28.5或更高版本</li><li id="f5f9" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">Golang —版本1.14</li><li id="2139" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">Nodejs —版本8</li><li id="faef" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lq lr ls lt bi translated">Python 2.7</li></ol><h1 id="7a7f" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">网络安装程序</h1><ul class=""><li id="ece7" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">具有org1和org2的HLF网络，每个都有2个对等体。</li><li id="b8d6" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lz lr ls lt bi translated">订购者群集(3个订购服务节点)RAFT作为一致算法(订购者、订购者2、订购者3)</li><li id="99c1" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lz lr ls lt bi translated">组织1、组织2和订购者的CA</li><li id="ba11" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lz lr ls lt bi translated"><strong class="kc hj"> CouchDB </strong>作为世界状态<strong class="kc hj"> </strong>数据库。</li><li id="3e0b" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lz lr ls lt bi translated">面料最新版本<strong class="kc hj"> 2.3 </strong></li></ul><h1 id="9d4d" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结构区块链设置</h1><p id="3aa7" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">修改hyperledger结构网络非常复杂。如果结构网络已经在运行，则可以跳过这一步。</p><ul class=""><li id="9bc3" class="ll lm hi kc b kd ld kh le kl ma kp mb kt mc kx lz lr ls lt bi translated">让我们克隆回购。</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="d274" class="mi jd hi me b fi mj mk l ml mm"><strong class="me hj">git clone </strong><a class="ae ky" href="https://github.com/cmjagtap/Hyperledger-Fabric" rel="noopener ugc nofollow" target="_blank"><strong class="me hj">https://github.com/cmjagtap/Hyperledger-Fabric</strong></a></span></pre><ul class=""><li id="a41a" class="ll lm hi kc b kd ld kh le kl ma kp mb kt mc kx lz lr ls lt bi translated">执行以下命令。</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="d19c" class="mi jd hi me b fi mj mk l ml mm"><strong class="me hj">export PATH=${PWD}/bin:$PATH<br/>sudo service docker start<br/> cd org1<br/>./1_enrollOrg1AdminAndUsers.sh<br/>./2_generateMSPOrg1.sh<em class="lc"> <br/> <br/> </em>cd ../org2<br/></strong>./<strong class="me hj">1_enrollOrg2AdminAndUsers.sh<br/></strong>./<strong class="me hj">2_generateMSPOrg2.sh <br/> <br/> cd ../orderer<br/></strong>./<strong class="me hj">1_enrollAdminAndMSP.sh<br/>./2_artifact.sh<br/> <br/> cd ../org1</strong><br/>.<strong class="me hj">/3_createChannel.sh<br/> <br/> cd ../org2</strong><br/>.<strong class="me hj">/3_joinChannel.sh</strong></span></pre><p id="e22e" class="pw-post-body-paragraph ka kb hi kc b kd ld kf kg kh le kj kk kl lg kn ko kp li kr ks kt lk kv kw kx hb bi translated">Hyperledger fabric区块链2.3已准备就绪。</p><h1 id="c883" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">对等2到组织1的入职</h1><p id="671c" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">我将添加新对等体分为以下五个步骤。让我们深入了解每一步。</p><h2 id="f11d" class="mi jd hi bd je mn mo mp ji mq mr ms jm kl mt mu jq kp mv mw ju kt mx my jy mz bi translated">1)为此对等方生成加密证书。</h2><ul class=""><li id="8be0" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">首先，我们需要将对等体注册到org1 CA。我已经创建了一个shell脚本<strong class="kc hj">registerenrollnewpeer . sh</strong>执行这个shell脚本来注册peer2并生成它的MSP和TLS证书。</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es na"><img src="../Images/9c16556f2e91fd3425319aadea0b964b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57KHrkhwcPgU9ElCDExMEg.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">Register and enroll new peer</figcaption></figure><h2 id="6cf7" class="mi jd hi bd je mn mo mp ji mq mr ms jm kl mt mu jq kp mv mw ju kt mx my jy mz bi translated">2)为新对等体创建docker-compose文件。</h2><ul class=""><li id="9af8" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">现在，我们必须为对等体创建一个docker-compose文件。</li><li id="e4e4" class="ll lm hi kc b kd lu kh lv kl lw kp lx kt ly kx lz lr ls lt bi translated">我已经在<strong class="kc hj"> org1/addPeer </strong>目录下创建了<strong class="kc hj"> new-peer.yaml </strong>文件</li></ul><h2 id="3d31" class="mi jd hi bd je mn mo mp ji mq mr ms jm kl mt mu jq kp mv mw ju kt mx my jy mz bi translated">3)新对等体的部署</h2><ul class=""><li id="5149" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">使用以下命令启动peer2</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="589a" class="mi jd hi me b fi mj mk l ml mm">docker-compose -f new-peer.yaml up -d</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es na"><img src="../Images/bb999476423840107888dc5c653a7c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3Qs3yuuvb_OIlgmckTapg.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">New Peer and CouchDB container</figcaption></figure><h2 id="8b41" class="mi jd hi bd je mn mo mp ji mq mr ms jm kl mt mu jq kp mv mw ju kt mx my jy mz bi translated">4)加入信道中的新对等体</h2><ul class=""><li id="f9d5" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">让我们按如下方式导出peer2环境变量。</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="06f4" class="mi jd hi me b fi mj mk l ml mm">export CORE_PEER_TLS_ENABLED=true</span><span id="5fd6" class="mi jd hi me b fi nb mk l ml mm">export ORDERER_CA=${PWD}/../../orderer/crypto-config-ca/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem</span><span id="094b" class="mi jd hi me b fi nb mk l ml mm">export PEER2_ORG1_CA=${PWD}/crypto-config-ca/peerOrganizations/org1.example.com/peers/peer2.org1.example.com/tls/ca.crt</span><span id="1594" class="mi jd hi me b fi nb mk l ml mm">export FABRIC_CFG_PATH=${PWD}/../../config</span><span id="e20d" class="mi jd hi me b fi nb mk l ml mm">export CORE_PEER_LOCALMSPID="Org1MSP"</span><span id="b8a3" class="mi jd hi me b fi nb mk l ml mm">export CORE_PEER_TLS_ROOTCERT_FILE=$PEER2_ORG1_CA</span><span id="ecb0" class="mi jd hi me b fi nb mk l ml mm">export CORE_PEER_MSPCONFIGPATH=${PWD}/../../org1/crypto-config-ca/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp</span><span id="5d73" class="mi jd hi me b fi nb mk l ml mm">export CORE_PEER_ADDRESS=localhost:6051  </span></pre><blockquote class="kz la lb"><p id="cee1" class="ka kb lc kc b kd ld kf kg kh le kj kk lf lg kn ko lh li kr ks lj lk kv kw kx hb bi translated">上述<em class="hi"> CORE_PEER_ADDRESS </em>指向peer2</p></blockquote><ul class=""><li id="003e" class="ll lm hi kc b kd ld kh le kl ma kp mb kt mc kx lz lr ls lt bi translated">使用下面的命令加入频道</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="03c5" class="mi jd hi me b fi mj mk l ml mm">peer channel join -n ../mychannel.block</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es na"><img src="../Images/d06b8127903fe745354dca053ea17884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uj7fqK_Ocp1MseVaYj9iRg.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">Join Channel</figcaption></figure><ul class=""><li id="5ef4" class="ll lm hi kc b kd ld kh le kl ma kp mb kt mc kx lz lr ls lt bi translated">成功加入后，您可以验证新对等方的日志。它将尝试从其他对等方或订购服务获取最新的块，如下所示。</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es na"><img src="../Images/d9a1e6ef6f3d8e7b6a3533cebdb2c1ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Aa2y4Bk8wf0hW1fHs97kg.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">Peer2 Logs</figcaption></figure><h2 id="5e46" class="mi jd hi bd je mn mo mp ji mq mr ms jm kl mt mu jq kp mv mw ju kt mx my jy mz bi translated">5)新对等体的操作</h2><ul class=""><li id="382b" class="ll lm hi kc b kd ke kh ki kl ln kp lo kt lp kx lz lr ls lt bi translated">您可以使用下面的命令来验证对等通道</li></ul><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="3ab4" class="mi jd hi me b fi mj mk l ml mm">peer channel list </span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es nc"><img src="../Images/dafda9e7590fc90fa78977057150b1fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v99MroFPP0mm3nL1cwnMcg.png"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">Peer Channel List</figcaption></figure><ul class=""><li id="f744" class="ll lm hi kc b kd ld kh le kl ma kp mb kt mc kx lz lr ls lt bi translated">现在您可以安装链码并使用这个新的对等体。</li></ul><h1 id="0882" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">打扫</h1><p id="afc7" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">执行以下脚本来清理所有docker容器和加密材料。</p><pre class="in io ip iq fd md me mf mg aw mh bi"><span id="6fe3" class="mi jd hi me b fi mj mk l ml mm">.<strong class="me hj">/clean.sh</strong></span></pre><h1 id="d3af" class="jc jd hi bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">摘要</h1><p id="9172" class="pw-post-body-paragraph ka kb hi kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx hb bi translated">我们已经看到，如何在hyperledger fabric区块链网络中添加新的对等体来运行组织。</p></div></div>    
</body>
</html>
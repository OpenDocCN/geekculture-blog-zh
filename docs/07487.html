<html>
<head>
<title>Setting up Phaser 3 with Webpack and NodeJS — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Webpack和NodeJS设置Phaser 3—第一部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/setting-up-phaser-3-with-webpack-and-nodejs-part-i-d25365563f74?source=collection_archive---------2-----------------------#2021-09-20">https://medium.com/geekculture/setting-up-phaser-3-with-webpack-and-nodejs-part-i-d25365563f74?source=collection_archive---------2-----------------------#2021-09-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9429" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi jd translated">haser 3对于JavaScript开发者来说是一个迷人的游戏开发框架。随着脸书即时游戏通过插件提供的支持和在线游戏的增长趋势，人们可以放心地打赌，它将在未来几年获得更多的牵引力。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/4a667758b35eb147053cc193d10ffe7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H-lz0vzrg0Id1TnX"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">Photo by <a class="ae kc" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4c75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一名JavaScript开发人员(是的，罪名成立！)，几个月前决定尝试一下游戏开发。老实说，几乎每个软件开发人员一生中至少有一次梦想写自己的游戏。因此，在本文中，我们将介绍如何使用Webpack和NodeJS来设置Phaser 3框架。</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><blockquote class="kk kl km"><p id="74bb" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">亲提示:</strong></p><p id="9ad6" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">我已经创建了一个名为<a class="ae kc" href="https://www.npmjs.com/package/@cdebadri/phasercli" rel="noopener ugc nofollow" target="_blank"> @cdebadri/phasercli </a>(类似create-react-app)的npm包，用它可以很容易地用webpack配置phaser游戏，只需一个命令。如果你想要一个可扩展的工具和一个一站式的解决方案来用webpack配置phaser游戏，而不需要写样板代码，请使用这个。现在我们继续这篇文章。</p></blockquote></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><p id="7c58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们打开一个终端，写下:</p><pre class="jn jo jp jq fd kr ks kt ku aw kv bi"><span id="32b8" class="kw kx hi ks b fi ky kz l la lb">mkdir -p phasergame &amp;&amp; cd phasergame<br/>npm init -y</span></pre><p id="f73c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将在当前工作目录下创建一个名为<code class="du lc ld le ks b">phasergame</code>的目录，并在其中创建一个<code class="du lc ld le ks b">package.json</code>，表明该文件夹现在是一个NodeJS项目。现在我们可以开始安装依赖项了。</p><pre class="jn jo jp jq fd kr ks kt ku aw kv bi"><span id="53bb" class="kw kx hi ks b fi ky kz l la lb">npm i phaser --save<br/>npm i webpack webpack-cli css-loader babel-loader @babel/core @babel/preset-env style-loader html-webpack-plugin copy-webpack-plugin webpack-dev-server --save-dev</span></pre><p id="731b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们刚刚安装的依赖项的一些要点:</p><ul class=""><li id="de65" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><code class="du lc ld le ks b">phaser</code>:游戏框架和引擎。</li><li id="8d0e" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">webpack</code>:捆绑者。它将有一个配置文件，指示webpack应该如何捆绑html、css、js和资产(图像、字体等)。)在一起。</li><li id="d032" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">webpack-cli</code> : Webpack有自己的CLI，也需要安装，这样Webpack才能在隔离的环境中处理文件。</li><li id="384c" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">css-loader</code>:这将拉所有的css文件并转换成字符串。</li><li id="6420" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">style-loader</code>:这将获取字符串并将其包含在相关的html页面的style标签下。</li><li id="a7c7" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">babel-loader</code>:这将获取源代码中所有的ES6+特性(比如类)并将其转换成ES5特性，所有浏览器都支持。</li><li id="d48a" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">@babel/core</code>和<code class="du lc ld le ks b">@babel/preset-env</code>:这些是智能预设，在传输文件时使用最新的ES5 JavaScript特性。它还添加了聚合填充，以防浏览器环境不支持它。</li><li id="c955" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">html-webpack-plugin</code>:它将从一个模板文件中创建一个index.html。模板可以是一个ejs文件，甚至是一个html文件。它还会动态添加捆绑的js文件。</li><li id="84fc" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">它将复制所有的静态资产，如图片、字体等，并把它放在提供静态内容的dist文件夹中。</li><li id="bfad" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">webpack-dev-server</code> : Webpack提供了一个dev服务器，用于在保存时热重装UI。这不是强制性的，但它很好，因为人们在设计游戏时不必考虑服务器端代码。</li></ul><p id="f0af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们打开<code class="du lc ld le ks b">src</code>文件夹，添加一些代码。在<code class="du lc ld le ks b">src</code>中，我们将创建一个<code class="du lc ld le ks b">scenes</code>文件夹</p><p id="f0a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是目录结构的样子:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lt"><img src="../Images/20c16f1828187e05792e34489e9524fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*bESDqcSLsrVxriupt7_hzA.jpeg"/></div></figure><p id="9568" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些关于重要子目录和文件的提示:</p><ul class=""><li id="13a7" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><code class="du lc ld le ks b">src</code>:这将保存源代码。</li><li id="dbc8" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">static</code>:这是提供静态文件的目录。</li><li id="c706" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">webpack.config.dev</code>和<code class="du lc ld le ks b">webpack.config</code>:这是分别用于开发和生产的webpack配置文件。对于开发来说，建议以某种方式配置捆绑输出，以便更容易跟踪特定模块的错误，而在生产中，我们希望缩小捆绑包，以便最小化捆绑包的大小。</li></ul><p id="5d7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将继续为我们的游戏添加一些源代码。让我们在<code class="du lc ld le ks b">src</code>中创建一个<code class="du lc ld le ks b">scenes</code>文件夹，并在<code class="du lc ld le ks b">scenes</code>下添加一个名为<code class="du lc ld le ks b">PlayScene.js</code>的文件。这里有一些<code class="du lc ld le ks b">PlayScene.js</code>的代码:</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="308d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我只是在游戏窗口的中央放了一张图片。我在与<code class="du lc ld le ks b">src</code>文件夹相邻的<code class="du lc ld le ks b">static</code>文件夹中有一个<code class="du lc ld le ks b">star.png</code>图像。</p><p id="9f91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来我们将添加<code class="du lc ld le ks b">index.js</code>，它将创建游戏环境。</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="lu lv l"/></div><figcaption class="jy jz et er es ka kb bd b be z dx">index.js</figcaption></figure><p id="3650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还将添加一个<code class="du lc ld le ks b">index.html</code>，它将作为<code class="du lc ld le ks b">HtmlWebpackPlugin</code>的模板:</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="lu lv l"/></div><figcaption class="jy jz et er es ka kb bd b be z dx">Sample index.html</figcaption></figure><p id="bb7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们开始添加webpack配置:</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="lu lv l"/></div><figcaption class="jy jz et er es ka kb bd b be z dx">A webpack development config</figcaption></figure><p id="35d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，生成的文件将被放在项目根目录下的<code class="du lc ld le ks b">build</code>文件夹中。整个配置是一个对象，不同的键具有以下意义:</p><ul class=""><li id="dbdb" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated"><code class="du lc ld le ks b">mode</code> —这告诉我们应该在哪个环境中使用这个配置。</li><li id="249a" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">output</code> —它告诉我们生成文件的位置。<code class="du lc ld le ks b">path</code>和<code class="du lc ld le ks b">filename</code>将列出生成文件的目的地和名称。<code class="du lc ld le ks b">clean</code>选项将在每次新构建完成时清理输出目录。</li><li id="e27e" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">module</code> —这是告诉webpack如何处理源文件的部分。<code class="du lc ld le ks b">babel-loader</code>应该使用<code class="du lc ld le ks b">@babel/preset-env</code>预置来<strong class="ih hj">转换</strong>代码(获取所有ES6+特性并将其转换成易于理解的ES5特性)。接下来，我们用<code class="du lc ld le ks b">css-loader</code>和<code class="du lc ld le ks b">style-loader</code>来加载css文件，最后我们对资产文件进行配置。</li><li id="f31e" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">devtool</code> —该选项告诉webpack如何生成源地图。有多种选项，如<code class="du lc ld le ks b">eval</code>、<code class="du lc ld le ks b">eval-cheap-source-map</code>等。人们可以从这个<a class="ae kc" href="https://webpack.js.org/configuration/devtool/" rel="noopener ugc nofollow" target="_blank">链接</a>中浏览所有链接，然后选择最适合的链接。</li><li id="ac2d" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">plugins</code> —接下来是插件。<code class="du lc ld le ks b">HtmlWebpackPlugin</code>应该使用模板文件构建<code class="du lc ld le ks b">index.html</code>,并通过webpack插入生成的<code class="du lc ld le ks b">main.js</code>。<code class="du lc ld le ks b">CopyWebpackPlugin</code>应该将字体和图像等静态文件复制到<code class="du lc ld le ks b">build</code>文件夹。</li><li id="6ee9" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated"><code class="du lc ld le ks b">devServer</code>——很多时候，在开发游戏时，我们不想考虑后台进程，如在数据库中更新高分或在数据库中存储玩家分数，而只关注游戏性。这里，<code class="du lc ld le ks b">webpack-dev-server</code>来拯救我们了。它提供了一个现成的服务器，只需对<code class="du lc ld le ks b">port</code>、<code class="du lc ld le ks b">contentBase</code>(应该提供内容的文件夹)、<code class="du lc ld le ks b">hot</code>(如果要热重装代码)等进行很少的配置就可以使用。</li></ul><p id="6652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦开发配置就绪，让我们更新我们的<code class="du lc ld le ks b">package.json</code>,让webpack获取这个配置文件来生成构建。</p><pre class="jn jo jp jq fd kr ks kt ku aw kv bi"><span id="918c" class="kw kx hi ks b fi ky kz l la lb">"scripts": {<br/>  "start": "npx webpack serve --config ./webpack.config.dev.js"<br/>}</span></pre><p id="6fdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du lc ld le ks b">npx webpack serve</code>命令将使用我们刚才编码的<code class="du lc ld le ks b">./webpack.config.dev.js</code>启动<code class="du lc ld le ks b">webpack-dev-server</code>。</p><p id="2f2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们打开一个终端，转到我们的项目目录并键入:</p><pre class="jn jo jp jq fd kr ks kt ku aw kv bi"><span id="1a22" class="kw kx hi ks b fi ky kz l la lb">npm start</span></pre><p id="9927" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们会在屏幕上看到webpack日志，在日志的底部，应该有一个“编译成功”。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lw"><img src="../Images/35e0238a25c7d3e61b7c0438f3244e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*f38yS6oFLxXEvqyXdBUnDA.jpeg"/></div><figcaption class="jy jz et er es ka kb bd b be z dx">Webpack build successfull</figcaption></figure><p id="fdf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们在<code class="du lc ld le ks b">localhost:3000</code>打开浏览器，我们会看到一个黑色的屏幕，我们的星星在屏幕中央。</p><p id="5c9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在下一篇文章中讨论生产webpack配置。更多敬请关注！</p></div></div>    
</body>
</html>
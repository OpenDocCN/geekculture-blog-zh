<html>
<head>
<title>Create Jasper Reports and deploy as a JAR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建Jasper报告并作为JAR部署</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-jasper-reports-and-deploy-as-a-jar-ab391799602e?source=collection_archive---------5-----------------------#2021-07-14">https://medium.com/geekculture/create-jasper-reports-and-deploy-as-a-jar-ab391799602e?source=collection_archive---------5-----------------------#2021-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/314a7ffa5243c55f12bed5b321ac95d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*YgKpsS343GzVNDT4e0ml8Q.png"/></div></figure><p id="6a82" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Jasper reports是一个开源的报告框架，帮助构建从简单到复杂的报告，提供各种格式，如PDF、Excel、CVS和TXT文件。这是一个Java库，可以在任何类型的Java应用程序中使用，您可以使用Jasper Studio或支持Jasper reports构建的工作室来构建它们。通过使用这些工具，构建报告变得很容易，因为它提供了拖放支持。在本文中，我们将探讨如何在报表和子报表中传递参数、字段，以及如何在使用jasper报表时创建可部署的JAR文件。</p><p id="3337" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">奇异值的行为类似于键值对，可以在报表和子报表中作为参数传递。另一方面，字段的行为类似于也可以传递给子报表的元素列表。</p><p id="53a4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在让我们进入代码，为了确保Jasper文件在JAR上工作，它必须被作为一个资源作为流，它被设置为输入流。流形式的资源获取文件位置的类路径，并在创建JAR后将信息保存在文件所在的位置。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="d1cf" class="jt ju hi jp b fi jv jw l jx jy">ClassLoader classLoader = Constants.class.getClassLoader();</span><span id="04a2" class="jt ju hi jp b fi jz jw l jx jy">InputStream in = classLoader.getResourceAsStream<br/>               ("Folder" + File.<em class="ka">separator </em>+ filename + ".jrxml");<br/><br/>JasperReport jasperReport = JasperCompileManager.<em class="ka">compileReport</em>(in);</span></pre><p id="66fa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如你在代码<em class="ka">文件中看到的，使用了分隔符</em>。如果部署在Windows或Linux上，它有助于根据环境设置反斜杠和斜杠，确保文件可以在任一环境中找到。</p><p id="bd82" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了传递参数，使用映射对象，如下所述:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="2e6b" class="jt ju hi jp b fi jv jw l jx jy">Map&lt;String, Object&gt; parameters = new HashMap&lt;&gt;();<br/>JasperReport jasperSubReport = <em class="ka">loadReport</em>("fileName.jasper");<br/>parameters.put("key", "value");<br/>parameters.put("key", "value");<br/>parameters.put("SUBREPORT_INPUT_STREAM", jasperSubReport);</span></pre><p id="2cd3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在jasper文件中，需要进行以下更改:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0ab8" class="jt ju hi jp b fi jv jw l jx jy">&lt;parameter name="SUBREPORT_INPUT_STREAM" class="java.lang.Object" isForPrompting="false"/&gt;</span><span id="56d8" class="jt ju hi jp b fi jz jw l jx jy">&lt;subreport&gt;<br/>  &lt;reportElement x="25" y="0" width="170" height="30" uuid="a0373767-848a-44ea-b6eb-80128fa60453"/&gt;<br/>   &lt;dataSourceExpression&gt;<br/>&lt;![CDATA<br/>[new net.sf.jasperreports.engine.data.JRBeanCollectionDataSource<br/>($F{outputs})]]&gt;<br/>&lt;/dataSourceExpression&gt;<br/>   &lt;subreportExpression class="java.io.InputStream"&gt;&lt;![CDATA[$P{SUBREPORT_INPUT_STREAM}]]&gt;&lt;/subreportExpression&gt;<br/>&lt;/subreport&gt;</span></pre><p id="caaf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要传递Jasper列表对象中的字段，按如下方式传递:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="06e3" class="jt ju hi jp b fi jv jw l jx jy">JRBeanCollectionDataSource dataSource = <br/>new JRBeanCollectionDataSource(list);</span></pre><p id="0aed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在设置jasper文件中的所有参数，如下所示:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="481a" class="jt ju hi jp b fi jv jw l jx jy">JasperPrint jasperPrint = JasperFillManager.<em class="ka">fillReport<br/>                         </em>(jasperReport, parameters, dataSource);</span></pre><p id="1944" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，为了导出文件，使用了以下代码:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="9016" class="jt ju hi jp b fi jv jw l jx jy">JRXlsExporter jrXlsExporter = new JRXlsExporter();<br/>jrXlsExporter.setExporterInput(new SimpleExporterInput(jasperPrint));<br/>jrXlsExporter.setExporterOutput(new SimpleOutputStreamExporterOutput(file+ {{format}})); // e.g# .xls <br/>jrXlsExporter.exportReport();</span></pre><p id="6b57" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的指南总结了如何设置JAR上可部署的Jasper报告的导出。使用Java通过Jasper中的参数和字段传递数据，并通过主报表将数据传递给子报表。</p></div></div>    
</body>
</html>
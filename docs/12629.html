<html>
<head>
<title>Setup OpenCV-DNN module with CUDA backend support (For Linux)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CUDA后端支持设置OpenCV-DNN模块(适用于Linux)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/setup-opencv-dnn-module-with-cuda-backend-support-for-linux-1677c627f3bd?source=collection_archive---------0-----------------------#2022-05-24">https://medium.com/geekculture/setup-opencv-dnn-module-with-cuda-backend-support-for-linux-1677c627f3bd?source=collection_archive---------0-----------------------#2022-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9a9adfde7199682fda23f381320ea36e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UpZzicg05zAiWSwwTys1Xw.png"/></div></div></figure><h1 id="2155" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">在本教程中，我们将使用CUDA后端支持从源代码构建OpenCV(OpenCV-DNN-CUDA模块)。</h1><p id="0d79" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><strong class="jq hj">重要提示:</strong>OpenCV-DNN模块只支持推理，所以尽管你可以从中获得更快的推理，但训练将与我们在没有CUDA后端支持的情况下设置的OpenCV相同。</p><h1 id="9e46" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">步伐</h1><p id="73c9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">1.安装CUDA &amp; cuDNN。</p><p id="03ff" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">2.如果尚未安装，请安装必要的Ubuntu软件包。</p><p id="0e51" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">3.下载并解压缩opencv &amp; opencv_contrib</p><p id="a7d7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">4.设置python环境</p><p id="2aae" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">5.使用CMake命令配置OpenCV库</p><p id="1401" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">6.为你的NVidia GPU从源代码构建OpenCV。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="3a39" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">我在YouTube上的视频！</h1><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lh li l"/></div></figure></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="7f8c" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">我们开始吧！</h1><h2 id="606b" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">步骤1)安装CUDA和cuDNN</h2><p id="1281" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">为您的系统下载并安装CUDA及其相应的cuDNN归档文件。去https://developer.nvidia.com/cuda-downloads的<a class="ae lx" href="https://developer.nvidia.com/cuda-downloads" rel="noopener ugc nofollow" target="_blank">下载最新的CUDA工具包。您也可以从以前的CUDA版本的</a><a class="ae lx" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank">档案中下载以前的版本</a>,或者从上面给出的cuda-downloads链接的参考资料部分下载。接下来，下载并复制cuDNN文件夹及其内容到我们安装CUDA的地方。你可以从https://developer.nvidia.com/cudnn<a class="ae lx" href="https://developer.nvidia.com/cudnn" rel="noopener ugc nofollow" target="_blank">下载cuDNN的最新版本。你也可以从https://developer.nvidia.com/rdp/cudnn-archive的cudnn档案下载以前的版本。</a></p><p id="38da" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，您需要在bashrc脚本中添加这些文件的路径。</p><p id="01e5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">之后，重新启动您的系统，并通过键入以下两个命令在终端中验证您的CUDA安装:</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="35d8" class="lj ir hi lz b fi md me l mf mg"><strong class="lz hj">nvidia-smi</strong></span><span id="c2ce" class="lj ir hi lz b fi mh me l mf mg"><strong class="lz hj">nvcc -V</strong></span></pre><p id="9b3a" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">关注</strong> <a class="ae lx" href="https://techzizou.com/?p=424" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">本博客</strong> </a> <strong class="jq hj">学习如何在Linux上安装和设置CUDA和CUDNN。</strong></p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="d8f3" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">步骤2)安装必要的Ubuntu软件包，如果还没有安装的话。</h2><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="87b5" class="lj ir hi lz b fi md me l mf mg">sudo apt-get update<br/>sudo apt-get upgrade<br/>sudo apt-get install build-essential cmake unzip pkg-config<br/>sudo apt-get install libjpeg-dev libpng-dev libtiff-dev<br/>sudo apt-get install libavcodec-dev libavformat-dev libswscale-dev<br/>sudo apt-get install libv4l-dev libxvidcore-dev libx264-dev<br/>sudo apt-get install libgtk-3-dev<br/>sudo apt-get install libblas-dev liblapack-dev gfortran<br/>sudo apt-get install python3-dev</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="9d79" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">步骤3)下载并解压缩opencv &amp; opencv_contrib</h2><p id="a4b9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">导航到主文件夹，下载OpenCV归档文件，将其解压缩，并将文件夹重命名为<em class="mi"> opencv </em>。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="a631" class="lj ir hi lz b fi md me l mf mg">cd ~<br/>wget -O opencv-4.5.5.zip <a class="ae lx" href="https://github.com/opencv/opencv/archive/4.5.5.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/opencv/opencv/archive/4.5.5.zip</a><br/>unzip -q opencv-4.5.5.zip<br/>mv opencv-4.5.5 opencv<br/>rm -f opencv-4.5.5.zip</span></pre><p id="3223" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，下载opencv_contrib文件，解压并重命名为<em class="mi"> opencv_contrib </em>。</p><p id="6ec7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">注意</strong>:确保下载的opencv_contrib版本与之前下载的opencv档案完全相同。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="bbd6" class="lj ir hi lz b fi md me l mf mg">wget -O opencv_contrib-4.5.5.zip <a class="ae lx" href="https://github.com/opencv/opencv_contrib/archive/4.5.5.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/opencv/opencv_contrib/archive/4.5.5.zip</a><br/>unzip -q opencv_contrib-4.5.5.zip<br/>mv opencv_contrib-4.5.5 opencv_contrib<br/>rm -f opencv_contrib-4.5.5.zip</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="05aa" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">步骤4)设置python环境</h2><p id="2f22" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如果您的系统上还没有virtualenv和virtualenvwrapper，请安装它们。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="8200" class="lj ir hi lz b fi md me l mf mg">sudo pip install virtualenv virtualenvwrapper</span></pre><p id="58b4" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">使用<code class="du mj mk ml lz b">nano</code>打开bashrc脚本文件。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="753b" class="lj ir hi lz b fi md me l mf mg">nano ~/.bashrc</span></pre><p id="2d94" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">输入以下导出路径，在底部设置virtualenvwrapper的路径并保存文件。(按<code class="du mj mk ml lz b">ctrl+x</code>、<code class="du mj mk ml lz b">y</code>和<code class="du mj mk ml lz b">Enter</code>保存文件)</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="04b7" class="lj ir hi lz b fi md me l mf mg">export WORKON_HOME=$HOME/.virtualenvs<br/>export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python3<br/>source /usr/local/bin/virtualenvwrapper.sh</span></pre><p id="0552" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">运行source来断言bashrc脚本在系统中的更改。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="a506" class="lj ir hi lz b fi md me l mf mg">source ~/.bashrc</span></pre><p id="438f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在终端中创建虚拟环境。我们将在虚拟环境中安装OpenCV-DNN-CUDA模块，而不是我们的基础环境。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="2225" class="lj ir hi lz b fi md me l mf mg">mkvirtualenv opencv_dnn_cuda -p python3</span></pre><p id="9e03" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">安装NumPy包。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="5502" class="lj ir hi lz b fi md me l mf mg">pip install numpy</span></pre><p id="e9a1" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">通过输入以下命令激活虚拟环境:</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="66cc" class="lj ir hi lz b fi md me l mf mg">workon opencv_dnn_cuda</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="048b" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">步骤5)使用cmake命令配置OpenCV以安装一些库</h2><p id="c7c2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">导航到我们在步骤3中创建的<em class="mi"> opencv </em>文件夹。在其中创建另一个名为<em class="mi"> build </em>的文件夹，并在其中导航。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="c5b0" class="lj ir hi lz b fi md me l mf mg">cd ~/opencv<br/>mkdir build<br/>cd build</span></pre><p id="636f" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">运行CMake命令来配置OpenCV的设置，您希望使用您选择的自定义库和函数从源代码构建OpenCV。</p><p id="3e42" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">将下面命令中的CUDA_ARCH_BIN参数更改为您的GPU的计算能力。在这里找到你的GPU的cc<a class="ae lx" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank"/>。此外，如果使用不同的名称，请更改PYTHON_EXECUTABLE参数中的虚拟环境名称，否则保持不变。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="ec5f" class="lj ir hi lz b fi md me l mf mg">cmake -D CMAKE_BUILD_TYPE=RELEASE \<br/>	-D CMAKE_INSTALL_PREFIX=/usr/local \<br/>	-D INSTALL_PYTHON_EXAMPLES=ON \<br/>	-D INSTALL_C_EXAMPLES=OFF \<br/>	-D OPENCV_ENABLE_NONFREE=ON \<br/>	-D WITH_CUDA=ON \<br/>	-D WITH_CUDNN=ON \<br/>	-D OPENCV_DNN_CUDA=ON \<br/>	-D ENABLE_FAST_MATH=1 \<br/>	-D CUDA_FAST_MATH=1 \<br/>	-D CUDA_ARCH_BIN=6.1 \<br/>	-D WITH_CUBLAS=1 \<br/>	-D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib/modules \<br/>	-D HAVE_opencv_python3=ON \<br/>	-D PYTHON_EXECUTABLE=~/.virtualenvs/opencv_dnn_cuda/bin/python \<br/>	-D BUILD_EXAMPLES=ON ..</span></pre><p id="88e8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在上面的CMake命令中，我们正在编译OpenCV，同时启用了CUDA和cuDNN支持(分别使用_CUDA和_CUDNN)。我们还启用了OPENCV_DNN_CUDA参数来构建具有CUDA后端支持的DNN模块。出于优化目的，我们还设置了ENABLE_FAST_MATH、CUDA_FAST_MATH和WITH_CUBLAS。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="bac4" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">第6步)最后，从源代码中构建OpenCV-DNN模块，为您的特定NVidia GPU提供CUDA后端支持</h1><p id="d32d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">运行make命令，用上面配置的设置构建OpenCV。(在终端中运行<code class="du mj mk ml lz b">nproc</code>，打印您的处理器号。在j8中用下面的8代替。)</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="6d83" class="lj ir hi lz b fi md me l mf mg">make -j8</span></pre><p id="16e9" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这将使用CUDA后端从源代码构建OpenCV-DNN模块。这个过程可能需要一个小时左右。</p><p id="79e3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，一旦在上面的make命令中完成了OpenCV的构建，就在您的系统上安装OpenCV。运行以下命令:</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="06f7" class="lj ir hi lz b fi md me l mf mg">sudo make install<br/>sudo ldconfig</span></pre><p id="7499" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，最后一步是在新安装的OpenCV库和我们的python虚拟环境之间创建一个符号链接。为此，您需要OpenCV绑定的安装路径。您可以通过CMake命令步骤输出<strong class="jq hj">中安装路径配置来确定路径。</strong></p><p id="cccd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在我的例子中，安装路径是<strong class="jq hj"><em class="mi">lib/python 3.6/site-packages/cv2/python-3.6</em></strong>，这意味着我的OpenCV绑定在<strong class="jq hj"><em class="mi">/usr/local/lib/python 3.6/site-packages/cv2/python-3.6</em></strong>中。检查你的”。所以“文件是。</p><p id="99dc" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">您可以通过列出其内容来确认上面的路径。运行下面的<code class="du mj mk ml lz b">ls</code>命令:</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="5c18" class="lj ir hi lz b fi md me l mf mg">ls -l /usr/local/lib/python3.6/site-packages/cv2/python-3.6<br/>total 10104<br/>-rw-r--r-- 1 root staff 10345488 Mar 23 07:06 cv2.cpython-36m-x86_64-linux-gnu.so</span></pre><p id="cbb5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">您将看到类似上面的输出，确认cv2绑定在这里。我有Python 3.6和解释文件名的64位架构。根据您的Python和系统架构，您的可能会有所不同。</p><p id="7279" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，导航到虚拟环境“site-packages”文件夹，最后使用<code class="du mj mk ml lz b">ln -s</code>命令为我们在上面找到的cv2绑定创建一个链接。这将在当前工作目录中创建一个cv2.so <a class="ae lx" href="https://devdojo.com/devdojo/what-is-a-symlink" rel="noopener ugc nofollow" target="_blank">符号链接</a>，该目录是我们虚拟环境中的站点包文件夹。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="8cb6" class="lj ir hi lz b fi md me l mf mg">cd ~/.virtualenvs/opencv_dnn_cuda/lib/python3.6/site-packages/<br/>ln -s /usr/local/lib/python3.6/site-packages/cv2/python-3.6/cv2.cpython-36m-x86_64-linux-gnu.so cv2.so</span></pre><p id="70d7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">注意:请确保仔细检查所有内容，因为即使路径不正确，该命令也会无声地失败，这意味着您不会收到警告或错误消息，并且输出也不会工作。所以要注意这一步。</p><p id="52dc" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">就是这样！我们已经在CUDA后端支持下成功构建了OpenCV-DNN模块。</p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><p id="c646" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">检查cv2是否安装正确。</p><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="a499" class="lj ir hi lz b fi md me l mf mg">workon opencv_dnn_cuda<br/>python</span><span id="d1d1" class="lj ir hi lz b fi mh me l mf mg">Python 3.6.9 (default, July 02 2019, 17:25:39)<br/>[GCC 6.3.0 20170516] on linux<br/>Type "help", "copyright", "credits" or "license" for more information.<br/>&gt;&gt;&gt; import cv2<br/>&gt;&gt;&gt; cv2.__version__<br/>'4.5.5'<br/>&gt;&gt;&gt;</span></pre></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="761f" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">使用下面的test_DNN_CV.py脚本检查OpenCV是否正确安装了CUDA后端支持。下面下载。</h1><pre class="ld le lf lg fd ly lz ma mb aw mc bi"><span id="2519" class="lj ir hi lz b fi md me l mf mg">import numpy as np<br/>import cv2 as cv<br/>import time</span><span id="1781" class="lj ir hi lz b fi mh me l mf mg">npTmp = np.random.random((1024, 1024)).astype(np.float32)</span><span id="f5d4" class="lj ir hi lz b fi mh me l mf mg">npMat1 = np.stack([npTmp,npTmp],axis=2)<br/>npMat2 = npMat1</span><span id="cfca" class="lj ir hi lz b fi mh me l mf mg">cuMat1 = cv.cuda_GpuMat()<br/>cuMat2 = cv.cuda_GpuMat()<br/>cuMat1.upload(npMat1)<br/>cuMat2.upload(npMat2)</span><span id="d5cc" class="lj ir hi lz b fi mh me l mf mg">start_time = time.time()<br/>cv.cuda.gemm(cuMat1, cuMat2,1,None,0,None,1)</span><span id="8512" class="lj ir hi lz b fi mh me l mf mg">print("CUDA using GPU --- %s seconds ---" % (time.time() - start_time))</span><span id="c9cf" class="lj ir hi lz b fi mh me l mf mg">start_time = time.time()<br/>cv.gemm(npMat1,npMat2,1,None,0,None,1)</span><span id="0924" class="lj ir hi lz b fi mh me l mf mg">print("CPU --- %s seconds ---" % (time.time() - start_time))</span></pre><h2 id="0228" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">下载下面的脚本来测试OpenCV-DNN。</h2><p id="c3d7" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated"><a class="ae lx" href="https://techzizou.com/setup-opencv-dnn-cuda-module-for-linux/#test_dnn_cv" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">下载测试_DNN_CV.py </strong> </a></p></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h1 id="b541" class="iq ir hi bd is it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn bi translated">下一个教程:</h1><h2 id="b0eb" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">在Linux上使用OpenCV-DNN模块运行YOLOv4推理</h2><div class="mm mn ez fb mo mp"><a href="https://techzizou007.medium.com/yolov4-inference-using-opencv-dnn-cuda-on-linux-904c16d2aea7" rel="noopener follow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">Linux下基于OpenCV-DNN-CUDA的YOLOv4推理</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">在Linux上使用OpenCV-DNN-CUDA模块运行YOLOv4推理。</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">techzizou007.medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd io mp"/></div></div></a></div></div><div class="ab cl kr ks gp kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="hb hc hd he hf"><h2 id="5e54" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">别忘了留下👏</h2><h2 id="c756" class="lj ir hi bd is lk ll lm iw ln lo lp ja jz lq lr je kd ls lt ji kh lu lv jm lw bi translated">祝您愉快！！！✌</h2><h1 id="363d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">♕·特奇佐·♕</h1></div></div>    
</body>
</html>
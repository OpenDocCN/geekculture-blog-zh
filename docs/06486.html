<html>
<head>
<title>Encrypt and Decrypt in NodeJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在NodeJS中加密和解密</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/encrypt-and-decrypt-in-nodejs-11c5d9cb81f?source=collection_archive---------13-----------------------#2021-08-21">https://medium.com/geekculture/encrypt-and-decrypt-in-nodejs-11c5d9cb81f?source=collection_archive---------13-----------------------#2021-08-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="bc98" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何加密文本</h1><p id="07c9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">创建一个名为<strong class="jf hj"> encdec.js </strong>的文件并粘贴:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="865b" class="kk ig hi kg b fi kl km l kn ko">const crypto = require("crypto")</span><span id="0155" class="kk ig hi kg b fi kp km l kn ko">const encrypt = (plainText, password) =&gt; {<br/>  try {<br/>    const iv = crypto.randomBytes(16);<br/>    const key = crypto.createHash('sha256').update(password).digest('base64').substr(0, 32);<br/>    const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);</span><span id="518d" class="kk ig hi kg b fi kp km l kn ko">    let encrypted = cipher.update(plainText);<br/>    encrypted = Buffer.concat([encrypted, cipher.final()])<br/>    return iv.toString('hex') + ':' + encrypted.toString('hex');</span><span id="0be6" class="kk ig hi kg b fi kp km l kn ko">  } catch (error) {<br/>    console.log(error);<br/>  }<br/>}</span></pre><p id="ea78" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">让我们来测试一下:</p><p id="9f62" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">追加这些行:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="8a41" class="kk ig hi kg b fi kl km l kn ko">const encrypt = (plainText, password) =&gt; {<br/>  ...<br/>}</span><span id="313b" class="kk ig hi kg b fi kp km l kn ko">const text = "Hello World"<br/>const pass = "secret1234"</span><span id="c1a3" class="kk ig hi kg b fi kp km l kn ko">const encText = encrypt(text, pass)<br/>console.log('encrypted text', encText);</span></pre><p id="923a" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">然后运行:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="b548" class="kk ig hi kg b fi kl km l kn ko">node encdec.js</span><span id="140b" class="kk ig hi kg b fi kp km l kn ko"># Output:<br/>encrypted text af9efafd353a5a7e27f31262dac12d6b:eb1dd75ea6c84e25300d5a244138ab3c</span></pre><h1 id="277f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何解密加密的文本</h1><p id="7706" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">添加解密功能:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="4e09" class="kk ig hi kg b fi kl km l kn ko">const decrypt = (encryptedText, password) =&gt; {<br/>  try {<br/>    const textParts = encryptedText.split(':');<br/>    const iv = Buffer.from(textParts.shift(), 'hex');</span><span id="951a" class="kk ig hi kg b fi kp km l kn ko">    const encryptedData = Buffer.from(textParts.join(':'), 'hex');<br/>    const key = crypto.createHash('sha256').update(password).digest('base64').substr(0, 32);<br/>    const decipher = crypto.createDecipheriv('aes-256-cbc', key, iv);<br/>    <br/>    const decrypted = decipher.update(encryptedData);<br/>    const decryptedText = Buffer.concat([decrypted, decipher.final()]);<br/>    return decryptedText.toString();<br/>  } catch (error) {<br/>    console.log(error)<br/>  }<br/>}</span></pre><p id="78e9" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">还有一个测试:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="a73c" class="kk ig hi kg b fi kl km l kn ko">const text = "Hello World"<br/>const pass = "secret1234"</span><span id="d469" class="kk ig hi kg b fi kp km l kn ko">const encText = encrypt(text, pass)<br/>console.log('encrypted text', encText);</span><span id="2d8e" class="kk ig hi kg b fi kp km l kn ko">const decText = decrypt(encText, pass)<br/>console.log('decrypted text', decText);</span></pre><p id="2bc0" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">然后运行:</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="4192" class="kk ig hi kg b fi kl km l kn ko">node encdec.js</span><span id="0bba" class="kk ig hi kg b fi kp km l kn ko"># Output<br/>encrypted text 71596b9f5a99532f438fc5669b845680:248f6cb24a4ebeb174bbb73953115fd5<br/>decrypted text Hello World</span></pre><p id="7289" class="pw-post-body-paragraph jd je hi jf b jg kq ji jj jk kr jm jn jo ks jq jr js kt ju jv jw ku jy jz ka hb bi translated">来源:<a class="ae kv" href="https://gist.github.com/vlucas/2bd40f62d20c1d49237a109d491974eb" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/vlu cas/2 BD 40 f 62d 20 C1 d 49237 a 109d 491974 EB</a></p></div></div>    
</body>
</html>
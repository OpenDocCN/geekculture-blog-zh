<html>
<head>
<title>Type Hints Annotations in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的类型提示注释</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/type-hints-annotations-in-python-6777c328196c?source=collection_archive---------11-----------------------#2022-04-02">https://medium.com/geekculture/type-hints-annotations-in-python-6777c328196c?source=collection_archive---------11-----------------------#2022-04-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/e9b75989f22c6c8a9a2ff5f7b8a25568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*TZwhYOQwwqUz-NqH58cS4A.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx">Photo by <a class="ae iq" href="https://unsplash.com/@amitrai10?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Amit Rai</a> on <a class="ae iq" href="https://unsplash.com/s/photos/egrets-nest?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cd8b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我在Python中遇到过一些函数，这些函数具有传递给函数的参数的内联注释以及带注释的返回类型。它看起来与我在研究生院的正式方法课上学到的Dafny和Lustre语言非常相似。有点惊讶于自己的Python中存在这样的功能，也以为它应该被更多的使用！使代码更具可读性和可理解性，如果代码没有docstring，还可以节省大量代码的时间。这个开始至少是一年前写的，所以把它从我的优先队列中去掉。🦾</p><p id="dcb0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，我们通过查看一些常见且有用的类型和示例来深入研究python中的类型提示注释。让我们来看看一些常见的注释:</p><p id="ac70" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><code class="du jq jr js jt b">typing</code>模块支持类型提示。最常见的支持包括<code class="du jq jr js jt b">Any</code>、<code class="du jq jr js jt b">Union</code>、<code class="du jq jr js jt b">Callable</code>、<code class="du jq jr js jt b">TypeVar</code>。</p><p id="6ad8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">下面是一个被注释的简单方法。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/f603fd5558fd4c32e495809bfafd833f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PapGgYoHMMGnLVWs_fvOpA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx">Method annotation</figcaption></figure><p id="f01b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">正如我们所看到的，我们在冒号后标注参数，返回类型由向前的箭头指示。</p><p id="9bf4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在让我们检查类型别名:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="im in et er es io ip bd b be z dx">type alias example</figcaption></figure><p id="1398" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这里我们使用<code class="du jq jr js jt b">Matrix</code>作为更复杂类型签名的别名，如示例<code class="du jq jr js jt b">list[list[int]]</code>所示。</p><p id="478e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在我们来看<code class="du jq jr js jt b">NewType</code>型。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="0beb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">运行该文件时，输出是:</p><pre class="ju jv jw jx fd kf jt kg kh aw ki bi"><span id="4adb" class="kj kk hi jt b fi kl km l kn ko">Natural Flowers: Calla Lily, Hibiscus<br/>Hybrid Flowers: Stargazer, Hardy Hibiscus</span></pre><p id="2727" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们使用<code class="du jq jr js jt b">NewType</code>通过从原始类型<code class="du jq jr js jt b">str</code>派生出子类来创建我们的定制类型<code class="du jq jr js jt b">Flower</code>。我们能够对新类型进行字符串操作。我们能够进一步子类化<code class="du jq jr js jt b">Flower</code>类型并创建类型<code class="du jq jr js jt b">HybridFlower</code>。</p><p id="ff21" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">让我们来看看这些新类型的实际应用方法:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="76fd" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">运行该文件时，我们得到:</p><pre class="ju jv jw jx fd kf jt kg kh aw ki bi"><span id="6e41" class="kj kk hi jt b fi kl km l kn ko">Calla lily</span></pre><p id="a87d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然而，我们不能在类中子类化<code class="du jq jr js jt b">NewType</code>。例如:</p><pre class="ju jv jw jx fd kf jt kg kh aw ki bi"><span id="9e8b" class="kj kk hi jt b fi kl km l kn ko">class FlowerInventory(Flower):<br/>    pass</span></pre><p id="2c6a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">给出<code class="du jq jr js jt b">TypeError</code>。</p><p id="b1b3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们来看看<code class="du jq jr js jt b">Callable</code>型。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="1d84" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在这里，<code class="du jq jr js jt b">Callable</code>就是<code class="du jq jr js jt b">get_next_10_items</code>的方法。我们看到<code class="du jq jr js jt b">Callable</code>有一个<code class="du jq jr js jt b">Callable[[arg1_type, arg2_type], return_type]</code>的语法。我们也可以像<code class="du jq jr js jt b">Callable[[...], return_type]</code>一样用文字省略号代替调用签名。甚至返回类型可以是省略号。</p><p id="0bb0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在让我们来看看<code class="du jq jr js jt b">Generics</code>。由于保存在容器中的对象不能以通用的方式进行静态推理，<code class="du jq jr js jt b">collections.abc</code>模块被扩展以支持容器中的元素类型。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="b478" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">看到第7行的函数签名，我们知道<code class="du jq jr js jt b">bouquets</code>是<code class="du jq jr js jt b">Flower</code>对象类型的集合，<code class="du jq jr js jt b">address</code>是<code class="du jq jr js jt b">Flower</code>对象类型和字符串的映射。泛型也可以通过使用称为<code class="du jq jr js jt b">TypeVar</code>的可用工厂类型来参数化。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="f6e3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">看，我们可以用任何类型的对象集合创建一个函数，并得到最后一项。</p><p id="5ee8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在我们来看<code class="du jq jr js jt b">Any</code>。静态类型检查器会将每种类型视为与<code class="du jq jr js jt b">Any</code>兼容，将<code class="du jq jr js jt b">Any</code>视为与每种类型兼容。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="a910" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">看，我们能够将变量<code class="du jq jr js jt b">a</code>的原始类型<code class="du jq jr js jt b">Any</code>改为字符串和列表。我们甚至可以用<code class="du jq jr js jt b">a</code>的值来指定<code class="du jq jr js jt b">int</code>的类型！如果没有提到返回类型，函数的返回类型是隐式的<code class="du jq jr js jt b">Any</code>。</p><p id="8896" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在我们来看<code class="du jq jr js jt b">Union</code>。<code class="du jq jr js jt b">Union[X, Y]</code>相当于<code class="du jq jr js jt b">X | Y</code>，表示<code class="du jq jr js jt b">X</code>或<code class="du jq jr js jt b">Y</code>。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="c171" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">看返回类型是<code class="du jq jr js jt b">Rock</code>、<code class="du jq jr js jt b">Paper</code>中的<code class="du jq jr js jt b">Union</code>还是<code class="du jq jr js jt b">Scissor</code>类型。</p><p id="2261" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们来看看<code class="du jq jr js jt b">Optional</code>型。<code class="du jq jr js jt b">Optional[X]</code>就是<code class="du jq jr js jt b">X | None</code>的意思。请注意，这与默认值不同。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="jy jz l"/></div></figure><p id="0e27" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">看，当调用方法<code class="du jq jr js jt b">own_pet</code>时，我们可以传递<code class="du jq jr js jt b">Cat</code>实例或<code class="du jq jr js jt b">None</code>对象！我们还通过使用<code class="du jq jr js jt b">Optional</code>类型来处理返回类型！</p><p id="df16" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">文章到此为止！祝贺完成。</p><p id="ae29" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">总之，Python支持类型提示。</p><p id="c90e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我希望这篇文章能让你对Python中的注释有更深入的了解，并可能在你的代码库中更频繁地使用它们？！</p><p id="34a4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在我的下一篇文章中再见。🦔</p><p id="6f43" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">灵感:</strong></p><ul class=""><li id="3849" class="kp kq hi it b iu iv iy iz jc kr jg ks jk kt jo ku kv kw kx bi translated"><a class="ae iq" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">打字模块</a></li></ul></div><div class="ab cl ky kz gp la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="hb hc hd he hf"><p id="9032" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在<a class="ae iq" href="https://www.patreon.com/dkhambu" rel="noopener ugc nofollow" target="_blank"> Patreon </a>上支持我！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Create BigQuery Table using Pandas Dataframe from Google Compute Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从谷歌计算引擎使用熊猫数据框架创建大查询表</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-bigquery-table-using-pandas-dataframe-from-google-compute-engine-6f06669a5dd1?source=collection_archive---------3-----------------------#2021-12-22">https://medium.com/geekculture/create-bigquery-table-using-pandas-dataframe-from-google-compute-engine-6f06669a5dd1?source=collection_archive---------3-----------------------#2021-12-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3887b3fd15393ecf9ec1df9983c95cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nN6WjJXHPZ4iVAKo"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@tofi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tobias Fischer</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3cbf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您通过VM实例在Google Compute Engine (GCE)中工作，您可以从pandas dataframe创建BigQuery表。dataframe的每一列将在BigQuery表中创建一个单独的字段。</p><p id="7c0e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在下面，我描述了你如何做到这一点。</p><p id="1e26" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤1:更改GCP虚拟机实例上的API访问范围</strong></p><p id="2c97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将VM实例中的访问范围从<code class="du jt ju jv jw b">Allow default access</code>更改为<code class="du jt ju jv jw b">Allow full access to all Cloud APIs</code>,以授予VM实例在BigQuery API上写入的权限。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div class="er es jx"><img src="../Images/0a1e411077884b9a7d8753079441803a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*qEmOODIUydwbXcpGauPHHA.png"/></div></figure><p id="0670" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤2:安装依赖关系</strong></p><p id="6728" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用<a class="ae iu" href="https://pandas-gbq.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> pandas_gbq </a>模块从我们的pandas数据帧创建bigquery表。因此，首先，在您的虚拟环境中安装该模块。</p><pre class="jy jz ka kb fd kc jw kd ke aw kf bi"><span id="9171" class="kg kh hi jw b fi ki kj l kk kl"># using pip<br/>$ pip install pandas-gbq -U</span><span id="b2aa" class="kg kh hi jw b fi km kj l kk kl"># using conda<br/>$ conda install pandas-gbq --channel conda-forge</span></pre><p id="9f76" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">第三步:在BigQuery主页中创建数据集</strong></p><p id="a52f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到您的BigQuery控制台，您可以使用以下URL转到您的BigQuery控制台页面。</p><pre class="jy jz ka kb fd kc jw kd ke aw kf bi"><span id="79e6" class="kg kh hi jw b fi ki kj l kk kl"><a class="ae iu" href="https://console.cloud.google.com/bigquery?project=" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/bigquery?project=</a>your-project-name</span><span id="22ee" class="kg kh hi jw b fi km kj l kk kl"># replace your-project-name with the project name that you're <br/># working on GCP. </span></pre><p id="ab27" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果没有，在bigquery页面上创建一个新的数据集。假设我们创建了一个名为<code class="du jt ju jv jw b">finance-dept</code>的数据集。现在，我们想为我们的员工信息创建一个表，假设表名为<code class="du jt ju jv jw b">emp_info</code>。</p><p id="5f3f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">步骤4:使用Pandas Dataframe创建BigQuery表的代码</strong></p><p id="4c98" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建bigquery表的代码:</p><figure class="jy jz ka kb fd ij"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="d2ff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的代码中，</p><p id="c338" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们的例子中，<code class="du jt ju jv jw b">dataset_tablename</code>应该是<code class="du jt ju jv jw b">finance-dept.emp_info</code>。<code class="du jt ju jv jw b">gcp_project_name</code>是你的GCP <code class="du jt ju jv jw b">Project ID</code>。这将根据每个列的数据类型为您的表自动创建一个模式。您不需要手动创建它。</p><p id="efb4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有3种不同的方法可用于<code class="du jt ju jv jw b">if_exists</code>参数。请在其文档页面上查看每种方法的详细信息。</p><div class="kp kq ez fb kr ks"><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_gbq.html" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">熊猫。DataFrame.to_gbq - pandas 1.3.4文档</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">将DataFrame写入Google BigQuery表。这个函数需要pandas-gbq包。请参阅如何…</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">pandas.pydata.org</p></div></div></div></a></div><p id="9594" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，通过访问以下URL，您可以在左侧面板中找到由上述代码创建的表:</p><pre class="jy jz ka kb fd kc jw kd ke aw kf bi"><span id="6f76" class="kg kh hi jw b fi ki kj l kk kl"><a class="ae iu" href="https://console.cloud.google.com/bigquery?project=gaishoku-bi-trend-project" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/bigquery?project=</a>&lt;PROJECT-ID&gt;</span></pre><p id="c0d4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用您的GCP项目ID替换<code class="du jt ju jv jw b">&lt;PROJECT_ID&gt;</code>。</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><p id="d887" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢你可以在LinkedIn上联系我。</p><div class="kp kq ez fb kr ks"><a href="https://www.linkedin.com/in/sksoumik/" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">Sadman Kabir Soumik -人工智能工程师- Venturas Ltd | LinkedIn</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">查看Sadman Kabir Soumik在全球最大的职业社区LinkedIn上的个人资料。萨德曼·卡比尔有两份工作…</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">www.linkedin.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln io ks"/></div></div></a></div></div></div>    
</body>
</html>
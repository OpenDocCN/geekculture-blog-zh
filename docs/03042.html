<html>
<head>
<title>Improve the Item-Item Collaborative Filtering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">改进项目-项目协同过滤</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/improve-the-item-item-collaborative-filtering-bf74e18fd7d1?source=collection_archive---------27-----------------------#2021-05-30">https://medium.com/geekculture/improve-the-item-item-collaborative-filtering-bf74e18fd7d1?source=collection_archive---------27-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/aa08fc948e787cf387cb876fda782d3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JidRWjUbd-BM2Pv6"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Photo by <a class="ae hv" href="https://unsplash.com/@goian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ian Schneider</a> on <a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="56b0" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">基于项目的模型在推荐系统中得到了广泛的实现，但是仅仅实现基于项目的模型是不够的。通常，我们需要在模型上进行更多的探索，并结合一些<strong class="ix hz">特征工程技术</strong>和<strong class="ix hz">用户行为分析</strong>。在这个例子中，我们将继续上一篇文章，探索更多基于项目的模型扩展。</p><p id="910f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Github链接:<a class="ae hv" href="https://github.com/chiang9/Recommendation_system_pyspark/blob/main/Item_based_cf/Extensions_of_Item-based_model.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Chiang 9/re commendation _ system _ py spark/blob/main/Item _ based _ cf/Extensions _ of _ Item-based _ model . ipynb</a></p><p id="ea3b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请查看之前的帖子，</p><div class="hh hi ez fb hj jt"><a rel="noopener follow" target="_blank" href="/geekculture/overview-of-item-item-collaborative-filtering-recommendation-system-64ee15b24bb8"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hz fi z dy jy ea eb jz ed ef hx bi translated">项目-项目协同过滤推荐系统综述</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">协同过滤广泛应用于推荐系统的构建。基于内存的方法主要有两种…</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="kd l ke kf kg kc kh hp jt"/></div></div></a></div><h1 id="dda6" class="ki kj hy bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">概述</h1><p id="add2" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">我们将使用以下公式进行预测</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div class="er es ll"><img src="../Images/61878f710a8851f060e40eb463daec24.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/1*z2eA4tLnJ3qIJI4SevuVqA.gif"/></div></figure><p id="d512" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个例子中，我们将介绍3种方法来改进基于项目的推荐系统。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="47a5" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated">方法</h1><h2 id="07fa" class="mc kj hy bd kk md me mf ko mg mh mi ks jg mj mk kw jk ml mm la jo mn mo le mp bi translated">1.前n个类似项目</h2><p id="208b" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在最初的版本中，我们采用所有共同评价的用户-项目评价对来进行预测。为了改进我们的模型，我们可以只取前n个相似的项目来进行预测。</p><p id="3fc3" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种方法的思想是消除低相似性等级项目对预测的影响。</p><h2 id="444e" class="mc kj hy bd kk md me mf ko mg mh mi ks jg mj mk kw jk ml mm la jo mn mo le mp bi translated">2.案例放大</h2><p id="74fc" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">为了增加高相似性项目影响的权重，我们可以使用下面的等式来放大权重，使得</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div class="er es mq"><img src="../Images/58bad27362a1359356f53b67380eca3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/1*U_s_iBpvl1GvIyDJxmdCAw.gif"/></div></figure><p id="cfc8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中p大于1。</p><p id="ee81" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在基于项目的模型中，权重是项目-项目对之间的相似性。我们将能够增强高相似性影响并惩罚低相似性项目。</p><h2 id="f8ee" class="mc kj hy bd kk md me mf ko mg mh mi ks jg mj mk kw jk ml mm la jo mn mo le mp bi translated">3.默认投票</h2><p id="f6b3" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">默认投票有很多方法。在本例中，我们将更改评分少于n的项目的权重。我们将需要从数据方面进行更多的探索，以确定n值。</p></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="718c" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated">我们开始吧</h1><p id="207b" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">首先，我们从上一篇文章中提取代码，并创建<strong class="ix hz"> compute_rmse </strong>函数来简化我们的模型评估。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><pre class="lm ln lo lp fd mt mu mv mw aw mx bi"><span id="575b" class="mc kj hy mu b fi my mz l na nb">1.0452369678411928</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="6b11" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated">1.前n个类似项目</h1><p id="823f" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated"><strong class="ix hz"> compute_prediction_v1 </strong>只考虑<em class="nc"> top_n </em>相似项，进行预测。</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nd"><img src="../Images/d68e1be781adff6ac8a82595fc6b5bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWivBYJhuSFhlIo8LkEcjw.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">top_n similar items image by author</figcaption></figure><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="5c49" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们可以通过更改参数<strong class="ix hz"> top_n </strong>来调整模型。在我们的数据集中，17似乎返回最佳RMSE。然而，在这个例子中，我们没有采用<strong class="ix hz">交叉验证</strong>。实际上，在训练超参数时，<strong class="ix hz">交叉验证</strong>是必不可少的。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ne"><img src="../Images/726178151df80c3dc84c3ad584f760cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vlgrg9sfqpTw0jbyfi3aFA.png"/></div></div></figure><pre class="lm ln lo lp fd mt mu mv mw aw mx bi"><span id="ead6" class="mc kj hy mu b fi my mz l na nb">**************** <br/>best model: <br/>top_n = 17 <br/>rmse = 1.0253540271872705 <br/>****************</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="d706" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated">2.案例放大</h1><p id="d5ea" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在这种方法中，我们在方法1的基础上进一步增强了模型。<strong class="ix hz"> compute_prediction_v2 </strong>取参数，<em class="nc"> top_n </em>和<em class="nc"> amp </em>，其中<em class="nc"> amp </em>指公式中的数字<em class="nc"> n </em>。</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div class="er es mq"><img src="../Images/58bad27362a1359356f53b67380eca3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/1*U_s_iBpvl1GvIyDJxmdCAw.gif"/></div></figure><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="5cdd" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们调整模型并在图表中可视化。正如我们从图表中看到的，如果我们接受所有数据，3.0效果最好，如果我们更改<em class="nc"> top_n </em>值，它可能会有所不同。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nf"><img src="../Images/7a07b41a5ccea0d27c1a66123cf6d85a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzhqsz6Hkq6nWHiUnrCY9g.png"/></div></div></figure><pre class="lm ln lo lp fd mt mu mv mw aw mx bi"><span id="dd5b" class="mc kj hy mu b fi my mz l na nb">****************<br/>best model:<br/>amp = 3.0<br/>rmse = 1.0273477985136776<br/>****************</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="104f" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated">3.默认投票</h1><p id="9412" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在本例中，我们将更改获得n个以上评分的项目的权重。因为我们正在编辑权重，所以我们可以简单地改变相似性矩阵。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><h2 id="d5f5" class="mc kj hy bd kk md me mf ko mg mh mi ks jg mj mk kw jk ml mm la jo mn mo le mp bi translated">数据集探索</h2><p id="9ae2" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在我们开始定义超参数之前，我们应该看一下数据集。正如我们从下图中看到的，大多数商品的评分都低于100分。</p><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ng"><img src="../Images/035b50331f4d875c98db2fbbf3541215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyWKrrv29WaZhVRsBQZMog.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">number of rating per item received</figcaption></figure><p id="91f1" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将<em class="nc">阈值</em>定义为100。</p><figure class="lm ln lo lp fd hk"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="lm ln lo lp fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nh"><img src="../Images/55cf3a3dd2782b386de9440ba6d1d25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNWm-mFHFPcRdtbUKspOBQ.png"/></div></div></figure><pre class="lm ln lo lp fd mt mu mv mw aw mx bi"><span id="59de" class="mc kj hy mu b fi my mz l na nb">****************<br/>best model:<br/>amp = 0.4<br/>rmse = 1.0388958637215613<br/>****************</span></pre></div><div class="ab cl lq lr gp ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="hb hc hd he hf"><h1 id="6b0f" class="ki kj hy bd kk kl lx kn ko kp ly kr ks kt lz kv kw kx ma kz la lb mb ld le lf bi translated"><strong class="ak">结论</strong></h1><p id="347b" class="pw-post-body-paragraph iv iw hy ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">有很多方法可以扩展基于记忆的模型。在这里，我们只演示3种方法来提高模型的准确性。为了获得更好的模型，我们可以将上述方法和其他模型结合起来，构建一个混合推荐系统。</p></div></div>    
</body>
</html>
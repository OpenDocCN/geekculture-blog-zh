<html>
<head>
<title>React Custom Hook — useFetch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应自定义挂钩—使用Fetch</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/react-custom-hook-usefetch-87ea1d41d1ce?source=collection_archive---------9-----------------------#2021-07-02">https://medium.com/geekculture/react-custom-hook-usefetch-87ea1d41d1ce?source=collection_archive---------9-----------------------#2021-07-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/faf673a0372ebde9f04484ac266d773f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KPXoGprItb5qeuZ9J2AehQ.png"/></div></div></figure><h1 id="b57d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">为什么使用Fetch？</h1><p id="2ad3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">当用户访问某个页面时，获取数据是很常见的。当获取数据时，我们也使用公共逻辑。</p><p id="9e25" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">还有大量的样板文件/逻辑塞满了我们的组件，而且不是很枯燥(不要重复)。</p><p id="f545" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这些都是制作定制挂钩的好理由。我们可以将样板文件/逻辑外包到一个单独文件中。该文件将保存函数(hook ),该函数将返回我们需要在组件中使用的内容。</p><h1 id="4bd9" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">老办法</h1><p id="1abf" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在这个例子中，我将使用<code class="du kr ks kt ku b">useState</code>钩子来跟踪加载状态、任何错误和数据。我将使用<code class="du kr ks kt ku b">useEffect</code>钩子来运行所有的代码。最后，我使用axios获取数据，并使用cancel令牌取消任何我们不再需要的未完成请求。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/4372ff089ceb14398860295789e051a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyxylG-kYAIQt7t_mkNEXQ.png"/></div></div></figure><p id="0d5b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">代码太多了。让我们移动它的大部分。</p><h1 id="1503" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">新的方式</h1><p id="31f3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们将创建另一个名为<code class="du kr ks kt ku b">useFetch.js</code>的文件。您希望自定义钩子的名称以“use”开头，以便React知道像对待钩子一样对待它。</p><p id="8cdf" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">让我们复制导入语句、所有3个使用状态和useEffect函数。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/e3ca6198c11709797132d21ebb0ec4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rse4maY2WOAK7pX8MSX3YQ.png"/></div></div></figure><p id="dbfb" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">你可能已经注意到了一些变化。首先，这个函数(也就是我们的钩子)被命名为useFetch。它接收一个参数，这个参数是我们想要从中获取数据的url。</p><p id="b41b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们还把<code class="du kr ks kt ku b">setQuote</code>改成了<code class="du kr ks kt ku b">setData</code>，让它更加通用。请注意，我们还会检查多个响应，以使其更加灵活。</p><p id="ad7c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">最后，我们的useFetch函数(hook)返回我们的数据、加载和任何错误。</p><blockquote class="lb lc ld"><p id="14b3" class="jo jp le jq b jr km jt ju jv kn jx jy lf ko kb kc lg kp kf kg lh kq kj kk kl hb bi translated">我把它们放在一个对象中，这样我们就可以在访问组件中的那些对象时使用对象<em class="hi">析构。这样，当我们析构它们时，顺序就无关紧要了，如果我们愿意，我们可以重命名它们。接下来我会展示给你看。</em></p></blockquote><h1 id="fb85" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">在我们的组件中使用useFetch</h1><p id="6fdc" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">因此，回到我们的应用程序组件，我们将从<code class="du kr ks kt ku b">useFetch.js</code>导入我们的useFetch钩子，并传入我们想要从中获取数据的url。我们将使用对象析构来访问我们需要的东西。最后，我们将数据重命名为quote。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/5e0da51fdce918be84e80ee2355c8d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smydtXSwW3_ieGzAUgXSEA.png"/></div></div></figure><p id="84e9" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">Muuuuuch清洁器😎。</p><h1 id="e903" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="03d8" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">自定义钩子对于清理代码非常有用。你可以在你的自定义钩子中使用React钩子(毕竟它们都是函数！👍).你可以封装很多重复的逻辑，然后从自定义钩子返回你需要的东西。</p><p id="55d2" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果你想看的话，我有一个YouTube视频。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="8c54" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果你喜欢了解类似的话题，请随时查看我的<a class="ae ll" href="https://www.youtube.com/channel/UCD0JOhEl8HvPowpg8Ri3CvA" rel="noopener ugc nofollow" target="_blank"> YouTube </a>或<a class="ae ll" href="https://www.instagram.com/techcheck__/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>。</p><p id="8ca7" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">希望这能帮助到一些人，感谢你的阅读！</p><p id="e0ac" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">安德鲁</p></div></div>    
</body>
</html>
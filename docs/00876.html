<html>
<head>
<title>How to Predict Customer Churn Rate With Classification Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用分类算法预测客户流失率</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-predict-customer-churn-rate-with-classification-algorithm-e0dd1b8d0d1c?source=collection_archive---------14-----------------------#2021-03-16">https://medium.com/geekculture/how-to-predict-customer-churn-rate-with-classification-algorithm-e0dd1b8d0d1c?source=collection_archive---------14-----------------------#2021-03-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/4fef10055d09f6a5b2f6f16c0a53380d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TZBs5kp-7zNwk5jlBoVGg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx"><a class="ae hv" href="https://unsplash.com/photos/mTehrY1mH-s" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="af9d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为什么我的客户在不断变化？您的客户服务团队正在积累支持票，IT部门正在修复漏洞并连夜发货，营销部门推出每周促销活动，希望让您的客户购买。相反，你的网站得到了一些访问，然而，客户不断下降。</p><p id="7b8b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">你不是唯一一个。研究表明，超过95%的客户默默地退出了产品，没有留下任何线索或反馈，说明他们为什么退出。</p><p id="c4cd" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">流失率，有时也称为损耗率，是在给定时间内停止使用某项服务的客户的百分比。它通常用于衡量拥有合同客户群的企业，尤其是基于订户的服务模式。<a class="ae hv" href="https://www.statista.com/statistics/816735/customer-churn-rate-by-industry-us/" rel="noopener ugc nofollow" target="_blank"> Statista </a></p><h1 id="fdd1" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">在这篇文章中，你将了解到预测客户流失所需的一切，通过SPARK分类算法建立机器学习模型，根据流失规则预测客户流失。</h1><h1 id="4902" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">如何衡量客户流失？</h1><p id="c226" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">流失率向您显示在特定时间段内，现有客户停止使用您的服务或产品的百分比。</p><p id="a7c4" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">要确定已产生收入的百分比，请在月初将你所有的月经常性收入(MRR)除以你当月损失的月经常性收入，减去任何升级或来自现有客户的额外收入。</p><p id="217b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">例如，如果一家连锁餐馆在月初有500名顾客，而在月末只有450名顾客，那么它的顾客流失率将是10%。</p><p id="b9c6" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">但这只是衡量客户流失的第一步，它依赖于你的致命判断来识别流失的客户。</p><p id="a11a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你想根据RFM模型的结果来预测未来谁会流失呢？传统的过程是痛苦的，它是这样的:</p><p id="9434" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您需要选择一个想要从中提取信息的数据源，比如一个Microsoft SQL Server——您必须确定要从该数据源中提取哪些表。然后，您必须确定客户流失规则。作为一个被搅动的顾客，你会考虑什么？现在您已经有了数据源和客户数据，您必须合并这两个数据，这样您就可以在一个全新的表中生成一个客户流失列。然后，你必须根据这些数据进行训练、测试和预测。然后添加一个运行所有前面元素的模型。最后，您需要将模型的输出发送到CSV表或业务应用程序中。</p><p id="4e66" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这个过程可能需要几个月的时间，如果它真的投入生产的话。</p><p id="40c2" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Gartner进行的一项研究发现，由于流程和/或应用过程中的困难，47%的公司难以将项目投入生产。</p><p id="0ff1" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">工作流程看起来像这样。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/61ce3509c6974e35b7d5d01dec8cb5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*goTCG36DxdthCm-9"/></div></div></figure><p id="802d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">最简单的方法之一是使用Datagran，通过构建数据工作流，或者我们通常所说的管道。借助Datagran，您可以将整个公司的数据集中在一个工作空间中，处理其中的信息，以便您可以挑选您想要使用的数据，基于这些数据进行培训、测试和预测，添加Spark算法(例如，预测流失)，并通过Slack、RestAPI、Workbook等业务应用程序将结果发送到生产部门，以便您可以与利益相关方共享。此外，管道是按频率运行的，所以你不必每次都要建立模型来寻找活跃的客户。</p><h1 id="da46" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">基于RFM分析的数据挖掘如何预测客户流失</h1><p id="2c88" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">Datagran将您的数据库和数据仓库连接起来，处理所有类型的数据比手动处理更好。它可以识别你最忠诚、最谦虚和最挑剔的客户，找到他们的联系信息，将结果发送到Slack频道或任何其他可用的应用程序，如RestAPI、Salesforce、Webhook、<a class="ae hv" href="https://www.datagran.io/your-ml-in-production-in-seconds" rel="noopener ugc nofollow" target="_blank">和更多</a>，并将他们转化为你的最佳客户。在我们开始之前，有几件事需要强调:</p><ul class=""><li id="0074" class="li lj hy je b jf jg jj jk jn lk jr ll jv lm jz ln lo lp lq bi translated">你必须有充足的客户信息。</li><li id="f24d" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq bi translated">明确客户流失规则——你必须问你的企业如何计算客户流失？如果这是不确定的，那么你可以从RFM模型中提取它，通过使用它的结果，将提供正在冬眠、冬眠+即将入睡的客户群。</li><li id="59ad" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq bi translated">然后，您将连接客户数据并添加一个客户流失列来应用客户流失规则。</li><li id="6530" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq bi translated">然后你就把训练/测试/预测分开。为了预测客户流失，我们更倾向于预测新客户或最后四分之一的客户。</li><li id="9a09" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz ln lo lp lq bi translated">最后，您将构建一个分类模型。</li></ul><ol class=""><li id="1a1d" class="li lj hy je b jf jg jj jk jn lk jr ll jv lm jz lw lo lp lq bi translated"><strong class="je hz">第一步是</strong> <a class="ae hv" href="https://www.youtube.com/watch?v=p4G6UfukDwM" rel="noopener ugc nofollow" target="_blank"> <strong class="je hz">把你的数据源连接到Datagran </strong> </a> <strong class="je hz">。</strong></li></ol><p id="f38f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果您还没有，请注册一个Datagran帐户。然后选择您的工作区(或者创建一个新的工作区)，添加一个项目，转到Integrations，并单击Add Integrations从可用列表中连接您需要的任何数据源。</p><p id="08f3" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Datagran新手？<a class="ae hv" href="https://www.datagran.io/your-ml-in-production-in-seconds" rel="noopener ugc nofollow" target="_blank">观看视频</a>了解更多关于集成以及如何设置集成的信息。</p><p id="187e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果您还没有连接数据源，请单击加号添加一个集成，并选择您希望集成的那个。Datagran将要求您选择想要从数据中提取的信息流。</p><p id="d649" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">信息流是从商店收集的数据类型，因此在这种情况下，您需要确保选择与客户相关的信息流。例如，你想从顾客、发票、购买频率等方面获取信息。然后会询问您希望它多久从您的数据源提取一次数据—选择“每天”作为您的频率。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/d80e1eca314dc5afc93273ae5158e946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gTdgmDOngP9mkD5t"/></div></div></figure><p id="0851" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hz"> 2。创建一个机器学习数据工作流程(管道),并确定如何根据RFM模型的结果来衡量客户流失</strong></p><p id="0808" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在Datagran已经有了您的数据，是时候将它转换成一个ML工作流了，在这个工作流中，您将使用Spark分类算法来测量客户流失。要做到这一点，您需要建立一个新的管道——或者自动化的工作流——并添加您想要从中提取信息的数据源。在本例中，我们使用的是Microsoft SQL server。</p><p id="de8d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在这个用例中，您将从RFM模型中提取客户流失规则。要了解如何建立一个RFM模型<a class="ae hv" href="https://blog.datagran.io/posts/rfm-analysis-build-an-ml-model-and-learn-more-about-your-customers-with-rfm-analysis-and-segmentation" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><p id="f5d4" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从右侧边栏拖动Microsoft SQL server数据，然后拖放一个自定义SQL操作符，通过选择将从数据集中提取的特定变量来确定如何测量客户流失。单击编辑按钮，选择源，复制并粘贴下面的示例查询。在本教程中，您将确定具有以下特征的客户:</p><ol class=""><li id="1a13" class="li lj hy je b jf jg jj jk jn lk jr ll jv lm jz lw lo lp lq bi translated">花费不到320美元</li><li id="f270" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz lw lo lp lq bi translated">购买次数不到2次。</li><li id="4b44" class="li lj hy je b jf lr jj ls jn lt jr lu jv lv jz lw lo lp lq bi translated">已经超过185天没有购物。</li></ol><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/a3eb53f7c955ddc60e02d52e637ceac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6M9CEMOiw2NeTD-X"/></div></div></figure><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/34cdd9e2fa16ecb4c77d440c3868ffcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8ZUDzDK01EmgLCF_"/></div></div></figure><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/769a4b82ef57a6a0e89de13a9fa8f25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cNBmDWTfaoDsyb4M"/></div></div></figure><p id="0f1e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从<br/>基数中选择<br/> *、<br/> IF <br/>(金额_花费&lt; = 319000 <br/>和天数_休假&gt; = 185 <br/>和发票&lt; = 2、<br/> 1、<br/> 0)作为流失<br/></p><p id="b0c3" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hz"> 3。运行查询并保存该表。</strong></p><p id="21bd" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在回到管道，按下play按钮，通过将鼠标悬停在它上面来运行SQL操作符。然后，添加第二个SQL操作符，它将提取您的客户信息。重复相同的过程，但这次复制并粘贴下面的查询。通过运行查询并按play运行元素来完成，如步骤2所示。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/c35f4cd4bdc9e604c9fe1ab2bb83fed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QmLv5QOy_vfmK_ff"/></div></div></figure><p id="79a0" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">选择<br/>不同的制作。CheckID，<br/>制作方法。<br/>剧组(Clientes。InvoiceNumber AS INT64)作为InvoiceNumber，<br/> Clientes。从<br/>客户处提取<br/>年<br/>的业务日期。BusinessDate)作为年度发票，<br/>从<br/>客户中提取(月份<br/>)。BusinessDate)作为MonthInvoice，<br/>从<br/>客户中提取(第<br/>天)。BusinessDate)作为DayInvoice，<br/>客户。PrimaryPhoneNumber，<br/>客户。电子邮件地址，<br/>客户。地址行1，<br/>客户。MainPaymentDescription，<br/> IF <br/>(客户。MainPaymentDescription = ' post mates '<br/>或客户。MainPaymentDescription = ' UbearEats '，<br/> 0，<br/> IF <br/> (Clientes。MainPaymentDescription = ' Cash '<br/>1，<br/> IF <br/> (Clientes。MainPaymentDescription = ' master card '<br/>或客户。MainPaymentDescription = ' Visa '<br/>或客户。MainPaymentDescription = 'Amer。' Exp '<br/>或委托人。主顾。MainPaymentDescription = 'Credit '，<br/> 2，<br/> 3)))作为PaymentDescription_ID，<br/> IF <br/> (Clientes。MainPaymentDescription = ' post mates '<br/>或客户。MainPaymentDescription = ' UbearEats '<br/>1)作为CompraMedioDigital，<br/>if null(DATETIME _ DIFF(DATETIME(Clients。ClosedTime)，<br/> DATETIME(客户端。SentToKitchenTime)，<br/>分钟)，<br/> 263)作为交货时间，<br/>客户。<br/> IFNULL城市(CAST(Items。FKStoreId为INT64)，<br/> 0)为FKStoreId，<br/>项。Item，<br/> IFNULL(强制转换(Items。FKItemId为INT64)，<br/> 0)为FKItemId，<br/> Clientes。小计，<br/>制作方法。Promo，<br/> IF <br/>(演员表(制作。Promo AS FLOAT64) &gt; 0，<br/> 1，<br/> 0) AS TieneDescuento，<br/> Facturas。TotalSale，<br/>物品。价格，<br/>物品。<br/>储存，施放(物品。Value AS float 64)AS Value<br/>FROM<br/>` adataunickpf _ _ adataunick _ dbo _ view _ PFC _ Clients ` AS Clients<br/>JOIN(<br/>SELECT<br/>DISTINCT DOB，<br/>checknum，<br/> CheckID，<br/> IdStore，<br/> Promo，<br/>sale total<br/>FROM<br/>` adataunickpf _ _ adataunick _ dbo _ view _ PFCIdStore =客户端。IdStore <br/>和Facturas。CheckID = Clientes。订单号<br/>和制作方法。DOB =客户。business date<br/>JOIN(<br/>SELECT<br/>DISTINCT FKStoreId，<br/> DateOfBusiness，<br/> CheckNumber，<br/> Value，<br/> Store，<br/> Price，<br/> Item，<br/>FKItemId<br/>FROM<br/>` adataunickpf _ _ adataunick _ dbo _ view _ fac _ Items `)作为<br/>项目上的项目<br/>。FKStoreId =发票。IdTienda <br/>和物品。营业日期=发票。DOB <br/>和物品。支票号码=发票。铸造时的检验号<br/>(Valor AS float 64)&gt;= 2000</p><p id="da8b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hz"> 4。现在，您将合并步骤2和步骤3的SQL操作符，以便开始训练您的ML模型。</strong></p><p id="9e21" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为此，拖放第三个SQL操作符，将其连接到包含销售信息的第一个操作符和包含客户信息的第二个操作符。为此，请将下面的查询复制并粘贴到SQL画布中。运行查询，保存结果，并在元素上按play来运行操作符。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/e4a18ced1868d22b903ceb846031e2d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QFXDtuYnlSHsL8DU"/></div></div></figure><p id="a152" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以<br/>为基数(<br/>SELECT<br/>primary phone number、<br/> YearInvoice、<br/> MonthInvoice、<br/> DayInvoice、<br/> FKStoreId、<br/> FKItemId、<br/> PaymentDescription_ID、<br/> DigitalChannel、<br/> DeliveryTime、<br/> WithPromo、<br/>Valor<br/>FROM<br/>` operator _ 5f 9c 298 e 7d 5325 F3 733 e 320 _ _)PrimaryPhoneNumber =规则。身份证明</p><p id="b1be" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="je hz"> 5。训练你的ML模型</strong></p><p id="c29a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这将让机器确切地知道它需要处理的信息。要了解更多关于运营商的信息，<a class="ae hv" href="https://www.youtube.com/watch?v=-5Kj6RX67YU" rel="noopener ugc nofollow" target="_blank">请观看此视频</a>。</p><p id="d136" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">提示:我们建议将80%的数据集用于训练，20%的数据集用于测试。</p><p id="715d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">要训练模型，您需要一组数据来训练算法(训练数据集)。如果您想要评估模型，您需要一组测试数据(测试数据集)，尽管这不是强制性的。最后，目标是模型的输出(100%的数据集)，即您希望Datagran预测的值。为此，需要有一个用于预测的数据集(预测数据集)。</p><p id="d84f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将鼠标悬停在将被命名为Train的第一个操作符元素上，然后按下edit按钮。将弹出SQL查询编辑器页面，您可以在其中选择要从数据中提取的列。复制并粘贴下面的查询示例，替换每个变量以应用于您的表的变量，或者按右上角的显示编辑器按钮来选择列，而不必添加代码。然后，运行运算符。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/dd5a6aaa220180c20105397a9eafa6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*allnqH0VoPQ__Yag"/></div></div></figure><p id="9043" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">SELECT <br/> YearInvoice，<br/> MonthInvoice，<br/> DayInvoice，<br/> FKStoreId，<br/> FKItemId，<br/> PaymentDescription_ID，<br/> DigitalChannel，<br/> DeliveryTime，<br/> WithPromo，<br/> Value，<br/>churn<br/>FROM<br/>` operator _ 5 F9 C2 a 097d 5325 F3 f 733 e323 _ _ SQL _ output`【T57</p><p id="2d34" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">其次，测试数据集:</p><p id="8f02" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将第二个SQL操作符拖放到画布中。单击Edit按钮，并将第二个SQL元素命名为Test。将虚拟查询复制并粘贴到SQL画布中。同样，这只是一个示例，您必须用自己的列变量替换查询的列变量。</p><p id="43b1" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">选择<br/> YearInvoice，<br/> MonthInvoice，<br/> DayInvoice，<br/> FKStoreId，<br/> FKItemId，<br/> PaymentDescription_ID，<br/> DigitalChannel，<br/> DeliveryTime，<br/> WithPromo，<br/> Value，<br/>churn<br/>FROM<br/>` operator _ 5 F9 C2 a 097d 5325 F3 f 73333</p><p id="5a28" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第三步是运行你的预测:</p><p id="124c" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在这种情况下，您不希望从未来提取的信息中进行预测，而是从您当前拥有的客户记录信息中预测数据告诉您什么。该SQL将使用100%的数据运行。通过这个查询，您将发现，根据历史数据，您的客户将来最有可能做什么。</p><p id="01ea" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将第三个SQL操作符拖放到画布中。按下编辑按钮，并将其命名为预测。复制并粘贴下面的虚拟查询，并用您自己的列变量替换。</p><p id="a36a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">选择<br/> 2020年发票，<br/> 11月语音，<br/> 01日发票，<br/> 1 FKStoreId，<br/> 200447 FKItemId，<br/> 0 PaymentDescription_ID，<br/> 0 DigitalChannel，<br/> 120发货时间，<br/> 0 WithPromo，<br/> 41900 Value <br/> UNION ALL <br/>选择<br/> 2020年发票，<br/> 11</p><p id="cfcb" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">运行SQL运算符:</p><p id="9b39" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">要激活所有三个SQL元素，必须按下播放按钮。只需将鼠标悬停在每个元素上即可找到它。</p><p id="7238" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">6。连接火花分类算法求流失率</p><p id="6c3a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将Spark分类操作符拖放到画布中。将所有操作员连接到它，通过将鼠标悬停在Spark元素上并按下编辑按钮来打开它的设置。从每个下拉菜单中选择选项，完成后保存它们。回到画布a，通过将鼠标悬停在Spark分类元素上并按下play按钮来运行该元素。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/c3e53fe85d4241c63e9e8c19d56a45bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oaCpahd51st3NJlY"/></div></div></figure><p id="1629" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">7。将ML模型结果发送给生产</p><p id="820d" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">拖放和行动，如松弛发送流失结果到松弛渠道。将Spark分类元素连接到新操作，然后按下edit按钮。登录到您的Slack帐户，选择您想要将结果发送给的渠道和用户。然后，选择要发送的表和列以及消息的描述。您可以保存并测试它，或者简单地保存它。完成后，返回到管道画布并按+号，然后选择Play运行管道。这将开始每天运行您的工作流，从您的数据源提取信息，训练，测试和预测，以及应用Spark分类算法，并确定每天的流失。您的Slack频道将每天自动接收模型结果，以供进一步分析。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es ly"><img src="../Images/0e5ffc024a0ed7f7d91287c912240184.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/0*HjEBKzjUA6D-VpVW"/></div></figure><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/7d8fc2c73f61de092222e4fb80949ac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WNAzK0AUqBVkEDWX"/></div></div></figure><p id="cd4a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">由于其易于使用的管道工具，Datagran可以让您轻松地使用机器学习模型测量客户流失。将模型的结果即时发送到我们任何可用的业务应用程序，以前所未有的方式根据结果采取行动。构建ML模型来预测客户流失提供了正确的工具来留住客户，甚至在他们离开之前，让您的企业在竞争中领先。<a class="ae hv" href="https://www.notion.so/Datagran-Documentation-bd0f3437b00a49ca816f43cffb9d22c8" rel="noopener ugc nofollow" target="_blank">了解更多关于我们管道的信息</a>，构建更先进的模型来解决从运营到消费者问题的各种业务问题。</p></div></div>    
</body>
</html>
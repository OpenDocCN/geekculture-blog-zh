<html>
<head>
<title>Untold practices to write better React components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">编写更好的React组件的无数实践</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/untold-practices-to-write-better-react-components-5593122802ec?source=collection_archive---------0-----------------------#2021-08-29">https://medium.com/geekculture/untold-practices-to-write-better-react-components-5593122802ec?source=collection_archive---------0-----------------------#2021-08-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">React是一个声明式的基于组件的库，它只处理一件事，那就是UI。React进化了很多。React中的每一个新功能都让之前流行的功能黯然失色。功能组件比基于类的组件更受欢迎和鼓励。鼓励使用反应上下文来代替状态管理的冗余。无论如何，在这个故事中，我们将看到一些不为人知的实践，它们将减少React组件中的混乱。</p><h2 id="4675" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">旗帜</h2><p id="8196" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我们经常在<code class="du kd ke kf kg b">isLoading</code>、<code class="du kd ke kf kg b">isSuccess</code>或<code class="du kd ke kf kg b">hasError</code>等组件中使用标志。来处理一些功能。那么他们有什么问题呢？让我们看一个例子:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/a038b8372c1dd79b7b30a7dbbf2eb515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJ5AOoXmjG2sBX1jq2VocQ.png"/></div></div></figure><p id="b87f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你看出什么不对了吗？是的，一个API调用管理多个标志。这是一个非常简单的例子，有一个API调用，所有三个标志在每次效果时都被重置。但是有了这三个标志，我可能不得不在现实世界的场景中处理一些选项，比如这些选项可能不会一起改变或者可能不会一起重置。因此，在这种情况下，您必须使用这些标志的组合来了解组件的当前状态或完成某些功能。这将使我们的代码更加混乱。</p><pre class="ki kj kk kl fd kt kg ku kv aw kw bi"><span id="7b42" class="jd je hi kg b fi kx ky l kz la">//when its not loading and is success<br/>if (!isLoading &amp;&amp; isSuccess) {}</span><span id="b5d4" class="jd je hi kg b fi lb ky l kz la">//when its not loading and has error<br/>if (!isLoading &amp;&amp; hasError) {}</span></pre><p id="524a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们从另一个角度来看待它们。在某个时间点，组件只有一种状态。不是<code class="du kd ke kf kg b">loading</code>就是<code class="du kd ke kf kg b">success</code>或者<code class="du kd ke kf kg b">error</code></p><p id="eddf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看一个更好的版本:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lc"><img src="../Images/fb401f4ebec1a42a59a7fe8d80bc3488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BigHYirFF5rf_dgku1eVMw.png"/></div></div></figure><p id="ccb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">多个标志的管理被简化为一个标志<code class="du kd ke kf kg b">status</code>,代码变得更加清晰易读。而在现实世界中，你不必担心检查多个标志来确定组件的最终状态或实现某些功能。</p><h2 id="7588" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">使用效果</h2><p id="4824" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我们在函数组件中使用<code class="du kd ke kf kg b">useEffect</code>钩子来处理副作用。理想情况下，一个组件应该只做一件事。但现实世界并不是理想世界。让我们看一个例子:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ld"><img src="../Images/55c74074fc2f62384115e559553eb9ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*G-ZFlZfdZN_y8bYJoDZsOw.png"/></div></figure><p id="e33d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我试图从现实世界的场景中捕捉一些复杂性:p。正如您所看到的问题，在一个<code class="du kd ke kf kg b">useEffect</code>调用中做了多件事情。虽然它是可读的，但更难理解和管理。我没有提到依赖项，但是你可以猜到，在依赖项数组中提到所有可能的依赖项会变得很糟糕。在现实世界中，随着时间的推移，随着越来越多的需求出现，情况会变得更加混乱。理想情况下，最好的方法是单个组件只做一件事。所以在理想情况下，我们只有一个有用的东西，在一个组件中。所以我们怎样才能让它更容易管理，更容易理解。让我们来看看更好的版本:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es le"><img src="../Images/8d84013dd6ec7d81d08f71c9953f0860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*gZmoo-PbCsGeKCXIAAwYQg.png"/></div></figure><p id="a811" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，你猜对了。<code class="du kd ke kf kg b">useEffect</code>中的单一责任原则。如果你不能让组件只做一件事，至少让<code class="du kd ke kf kg b">useEffect</code>只做一件事。对于每一个新的副作用，使用新的<code class="du kd ke kf kg b">useEffect</code>。在上面的例子中，虽然组件有更多的代码行，但我一眼就能看出这个<code class="du kd ke kf kg b">useEffect</code>只做一件事，只有<code class="du kd ke kf kg b">blah</code>和<code class="du kd ke kf kg b">blah</code>是它的依赖。如果在某个时间点，你想在你的组件中删除/添加一个新的效果，只需删除/添加它的<code class="du kd ke kf kg b">useEffect</code>就可以了，不会牵连到其他的。</p><h2 id="0be8" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">何时使用独立组件或挂钩</h2><p id="8b44" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">如果一个组件在做不止一件事，那么是时候把它分开了。如果一个东西在不止一个地方被使用，那么是时候把它拿出来，使它成为一个独立的实体。如果那个东西涉及到UI，就做一个单独的组件，如果只是逻辑/副作用，就做一个单独的钩子。</p></div><div class="ab cl lf lg gp lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="hb hc hd he hf"><p id="fb59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已。这几点是我从自己的经历中学到的观点。如果你有问题/异议/更好的练习，请告诉我，我将非常乐意与你一起攀登顶峰。</p></div></div>    
</body>
</html>
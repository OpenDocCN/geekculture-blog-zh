<html>
<head>
<title>Phylogenetic Trees: Implement in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">系统进化树:用Python实现</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/phylogenetic-trees-implement-in-python-3f9df96c0c32?source=collection_archive---------1-----------------------#2021-05-05">https://medium.com/geekculture/phylogenetic-trees-implement-in-python-3f9df96c0c32?source=collection_archive---------1-----------------------#2021-05-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c9ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">读者你好！本文将带您通过一个简单的例子，逐步实现python中的进化树。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="64c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">进化树的系统发生树显示了被认为具有共同祖先的各种生物物种或其他实体之间的进化关系。</p><p id="4b41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有三种方法来构建这样的树:距离矩阵、最大简约和最大似然。在本文中，我们将使用距离矩阵法。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="184c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在开始编写代码之前，让我们导入一些本实验需要的库。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="69a2" class="jt ju hi jp b fi jv jw l jx jy"># Importing necessary libraries from BioPython<br/>from Bio import Phylo, AlignIO<br/>from Bio.Phylo.TreeConstruction import DistanceCalculator, DistanceTreeConstructor</span></pre><p id="9cff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它有一个扩展名为的输入文件。phy文件文件的第一行包含物种的数量(n)和每个物种基因的长度(m)。</p><p id="7fc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:5 100，这意味着该文件有5个基因长度为100的生物体。</p><p id="0f7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来的“n”行描述了生物体的名称，然后是每个生物体的DNA。</p><p id="19b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如:</p><p id="6345" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人类_黑猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩猩</p><p id="b0e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将使用AlignIO读取文件。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="caf5" class="jt ju hi jp b fi jv jw l jx jy"># Read the sequences and align<br/>align = AlignIO.read('msa.phy','phylip')<br/>print(align)</span></pre><p id="d290" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在打印align时，您将得到如下输出:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1ccf" class="jt ju hi jp b fi jv jw l jx jy">Alignment with 6 rows and 3331 columns<br/>CATGCTACTCCACACACCAAGCTATCTAGCCTCCCCAATCCAAA...ATA homo_sapie<br/>CATACTACTCCACACACCAAACTACCTAGCCTCCCCAATCCAAA...ATA chimpanzee<br/>CATGCTACTCCACACACCAAGCTACCTAGTCTCCCCAATCCAAA...ACA bonobo<br/>CATACTACTCCACACACCAAATCATCTAGCCTCCCCAGTCCAGA...ACA gorilla<br/>CATACCACTCCACACCCTATACCATCCAACTTCCCCTATCCGAA...ACA orangutan</span></pre><p id="9b3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们使用距离计算器计算距离矩阵。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="fed1" class="jt ju hi jp b fi jv jw l jx jy"># Calculate the distance matrix<br/>calculator = DistanceCalculator('identity')<br/>distMatrix = calculator.get_distance(align)<br/>print(distMatrix)</span></pre><p id="c350" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得如下距离矩阵:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1d88" class="jt ju hi jp b fi jv jw l jx jy">homo_sapie 0<br/>chimpanzee 0.22695887120984692 0<br/>bonobo 0.22095466826778742 0.09696787751425995 0<br/>gorilla 0.2668868207745422 0.25788051636145304 0.24977484238967274 0<br/>orangutan 0.31732212548784144 0.32182527769438607 0.3161212848994296 0.322425697988592 0<br/>           homo_sapie chimpanzee bonobo gorilla orangutan</span></pre><p id="423a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们用UGMA和NJ算法构建了系统进化树。</p><p id="25ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于UPGMA和NJ算法的一些要点:</p><ul class=""><li id="b706" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">UPGMA(带算术平均值的未加权分组方法)是一种从最相似的事物开始的顺序聚类算法。这种平均链接聚类方法中的距离是作为算术平均值计算的。UPGMA生成一棵有根的树。它假设所有生物的进化速度是一样的。</li><li id="c477" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">NJ(邻居加入)也考虑到了到其他叶子的平均距离。它生成一棵无根树，并且在实践中运行得相当好。</li></ul><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="b27a" class="jt ju hi jp b fi jv jw l jx jy"># Create a DistanceTreeConstructor object<br/>constructor = DistanceTreeConstructor()</span><span id="cfac" class="jt ju hi jp b fi kn jw l jx jy"># Construct the phlyogenetic tree using UPGMA algorithm<br/>UGMATree = constructor.upgma(distMatrix)</span><span id="8ac8" class="jt ju hi jp b fi kn jw l jx jy"># Construct the phlyogenetic tree using NJ algorithm<br/>NJTree = constructor.nj(distMatrix)</span></pre><p id="e250" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用Phylo.draw()在新窗口中绘制树，也可以使用Phylo.draw_ascii()函数在终端上绘制树。为了测试这两个功能，我们将在窗口中绘制UPGMA树，在终端上绘制NJ树。</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0a23" class="jt ju hi jp b fi jv jw l jx jy"># Draw the phlyogenetic tree<br/>Phylo.draw(UPGMATree)</span><span id="e9f1" class="jt ju hi jp b fi kn jw l jx jy"># Draw the phlyogenetic tree using terminal<br/>Phylo.draw_ascii(NJTree)</span></pre><p id="3011" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您最终的系统发生树输出将如下所示:</p><figure class="jk jl jm jn fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ko"><img src="../Images/8dcedf91a6f2314d6f497c15ff9c5cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gfbt2XllchBozg54Z0JgYA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">UPGMATree</figcaption></figure><figure class="jk jl jm jn fd kp er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es la"><img src="../Images/67bdba0a95a5ef5fead3b60571589af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PJpunf034m9LnUL9XjhpA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">NJTree</figcaption></figure><p id="4a20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在https://github.com/risg99/Phylogenetic-trees-python的<a class="ae lb" href="https://github.com/risg99/Phylogenetic-trees-python" rel="noopener ugc nofollow" target="_blank">找到完整的代码和输出</a></p><p id="64c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lc">感谢阅读！！！</em></p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="b323" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阅读本文中使用的理论和库的一些附加链接，您可以随意浏览以下内容:</p><ol class=""><li id="bb11" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ld kf kg kh bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Phylogenetic_tree" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Phylogenetic_tree</a></li><li id="d460" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ld kf kg kh bi translated"><a class="ae lb" href="https://biopython.org/wiki/Phylo" rel="noopener ugc nofollow" target="_blank">https://biopython.org/wiki/Phylo</a></li></ol></div></div>    
</body>
</html>
<html>
<head>
<title>Robot Operating System: Requirements for Autonomous Navigation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器人操作系统:自主导航的要求</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/robot-operating-system-requirements-for-autonomous-navigation-eb04e00fe73?source=collection_archive---------8-----------------------#2022-01-24">https://medium.com/geekculture/robot-operating-system-requirements-for-autonomous-navigation-eb04e00fe73?source=collection_archive---------8-----------------------#2022-01-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1dd217759860cdadc073b7201fb7115e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEeF0_ldPaEhpXYItXoeyA.png"/></div></div></figure><p id="d60f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了在ROS中构建一个自导航机器人，我们需要理解不同方面的基础知识。机器人本身需要以能够实现其姿态变换的方式建模。此外，机器人需要倾听并对<code class="du jo jp jq jr b">Twist</code>数据做出反应。最后，它需要以里程计消息的形式持续发布位置传感器数据。</p><p id="c770" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文将分别讨论这三个方面。它解释了基本概念，并列出了实现所需行为的可用ROS包。</p><p id="b749" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">本文原载于我的博客</em><a class="ae jt" href="https://admantium.com/blog/ros11_requirements_autonomous_navigation/" rel="noopener ugc nofollow" target="_blank"><em class="js">admantium.com</em></a>。</p><h1 id="4803" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">ROS导航要点</h1><p id="0466" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">根据<a class="ae jt" href="https://wiki.ros.org/navigation" rel="noopener ugc nofollow" target="_blank"> ROS导航文档页面</a>，您的机器人需要满足以下假设和要求:</p><ul class=""><li id="c0cf" class="kx ky hi is b it iu ix iy jb kz jf la jj lb jn lc ld le lf bi translated">它的底座大致呈正方形</li><li id="a4aa" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated">它使用差动驱动或者是完整的轮式驱动</li><li id="f70d" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated">它监听<code class="du jo jp jq jr b">Twist</code>消息命令，并将x速度、y速度和θ速度转化为具体和正确的运动</li><li id="d0e9" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated">它以<code class="du jo jp jq jr b">LaserScan</code>或<code class="du jo jp jq jr b">PointCloud</code>的形式接收关于其外部环境的传感器数据。</li></ul><p id="0fd3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">考虑到这几点，最后一点是一个相当激烈的限制:其他传感器如立体摄像机，声纳和红外不能开箱即用。相反，它们的本地数据格式需要被翻译成相应的主题。</p><p id="7758" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了进一步理解这些需求的含义，下面两个部分分别讨论了ROS导航栈所需的数据和组件。</p><h1 id="06ea" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据要求</h1><h1 id="58b5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">里程计数据</h1><p id="acc5" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">转换数据表示两个坐标参考之间的静态关系。当机器人移动时，其<em class="js">里程表数据</em>代表其速度的动态变化。在ROS中，机器人需要发布变换数据和里程计数据。抽象地说，里程计数据是通过转换数据过滤的。</p><p id="97d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">里程计数据作为<code class="du jo jp jq jr b">Odometry</code>发布，由以下部分组成:</p><pre class="ll lm ln lo fd lp jr lq lr aw ls bi"><span id="821e" class="lt jv hi jr b fi lu lv l lw lx"># This represents an estimate of a position and velocity in free space.  <br/># The pose in this message should be specified in the coordinate frame given by header.frame_id.<br/># The twist in this message should be specified in the coordinate frame given by the child_frame_id<br/>Header header<br/>string child_frame_id<br/>geometry_msgs/PoseWithCovariance pose<br/>geometry_msgs/TwistWithCovariance twist</span></pre><p id="2aeb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">来源:</em><a class="ae jt" href="http://docs.ros.org/en/noetic/api/nav_msgs/html/msg/Odometry.html" rel="noopener ugc nofollow" target="_blank"><em class="js">http://docs . ROS . org/en/no etic/API/nav _ msgs/html/msg/odometry . html</em></a></p><h1 id="405e" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">传感器数据</h1><p id="684b" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">导航所需的最终数据类型是<code class="du jo jp jq jr b">LaserScan</code>或<code class="du jo jp jq jr b">PointCloud</code>形式的传感器数据。该数据用于测量机器人的周围环境。</p><p id="c497" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们分别调查每一个。</p><h2 id="ddc8" class="lt jv hi bd jw ly lz ma ka mb mc md ke jb me mf ki jf mg mh km jj mi mj kq mk bi translated">激光扫描数据</h2><p id="4142" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">激光扫描代表在水平面上获得的2D数据。数据点是在特定的角度、各个点之间的特定距离以及特定的时间戳中获取的。所有这些都包含在<a class="ae jt" href="http://docs.ros.org/en/noetic/api/sensor_msgs/html/msg/LaserScan.html" rel="noopener ugc nofollow" target="_blank">激光扫描信息类型</a>中。</p><pre class="ll lm ln lo fd lp jr lq lr aw ls bi"><span id="a910" class="lt jv hi jr b fi lu lv l lw lx">Header header            # timestamp in the header is the acquisition time of <br/>                         # the first ray in the scan.<br/>                         #<br/>                         # in frame frame_id, angles are measured around <br/>                         # the positive Z axis (counterclockwise, if Z is up)<br/>                         # with zero angle being forward along the x axis</span><span id="0d3d" class="lt jv hi jr b fi ml lv l lw lx">float32 angle_min        # start angle of the scan [rad]<br/>float32 angle_max        # end angle of the scan [rad]<br/>float32 angle_increment  # angular distance between measurements [rad]</span><span id="7c09" class="lt jv hi jr b fi ml lv l lw lx">float32 time_increment   # time between measurements [seconds] - if your scanner<br/>                         # is moving, this will be used in interpolating position<br/>                         # of 3d points<br/>float32 scan_time        # time between scans [seconds]</span><span id="5382" class="lt jv hi jr b fi ml lv l lw lx">float32 range_min        # minimum range value [m]<br/>float32 range_max        # maximum range value [m]</span><span id="44a0" class="lt jv hi jr b fi ml lv l lw lx">float32[] ranges         # range data [m] (Note: values &lt; range_min or &gt; range_max should be discarded)<br/>float32[] intensities    # intensity data [device-specific units].  If your<br/>                         # device does not provide intensities, please leave<br/>                         # the array empty.</span></pre><p id="a163" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">来源:</em><a class="ae jt" href="http://docs.ros.org/en/noetic/api/sensor_msgs/html/msg/LaserScan.html" rel="noopener ugc nofollow" target="_blank"><em class="js">http://docs . ROS . org/en/no etic/API/sensor _ msgs/html/msg/laserscan . html</em></a></p><p id="e323" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">激光扫描的典型来源是<a class="ae jt" href="https://en.wikipedia.org/wiki/Lidar" rel="noopener ugc nofollow" target="_blank">激光雷达</a>，这是一种在平面区域连续移动激光并检测物体距离的技术。</p><h2 id="b7b8" class="lt jv hi bd jw ly lz ma ka mb mc md ke jb me mf ki jf mg mh km jj mi mj kq mk bi translated">点云数据</h2><p id="64fe" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">点云是其周围环境的三维表示。它由具有x，y，z数据的单个点组成。结合所有这些点给出了周围环境的3D深度图。下面是<a class="ae jt" href="http://docs.ros.org/en/noetic/api/sensor_msgs/html/msg/PointCloud.html" rel="noopener ugc nofollow" target="_blank">点云数据格式</a>的内容。</p><pre class="ll lm ln lo fd lp jr lq lr aw ls bi"><span id="342b" class="lt jv hi jr b fi lu lv l lw lx"># Time of sensor data acquisition, coordinate frame ID.<br/>Header header</span><span id="4a89" class="lt jv hi jr b fi ml lv l lw lx"># Array of 3d points. Each Point32 should be interpreted as a 3d point<br/># in the frame given in the header.<br/>geometry_msgs/Point32[] points</span><span id="731c" class="lt jv hi jr b fi ml lv l lw lx"># Each channel should have the same number of elements as points array,<br/># and the data in each channel should correspond 1:1 with each point.<br/># Channel names in common practice are listed in ChannelFloat32.msg.<br/>ChannelFloat32[] channels</span></pre><p id="b249" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">来源:</em><a class="ae jt" href="http://docs.ros.org/en/noetic/api/sensor_msgs/html/msg/PointCloud.html" rel="noopener ugc nofollow" target="_blank"><em class="js">http://docs . ROS . org/en/no etic/API/sensor _ msgs/html/msg/point cloud . html</em></a></p><p id="7b22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点云数据可以从3D激光雷达扫描中获得，如本文<a class="ae jt" rel="noopener" href="/@amritgupta1999/merging-data-from-multiple-lidar-s-in-ros-e890fb60cbbf">中的文章</a>所述，或者从<a class="ae jt" href="https://en.wikipedia.org/wiki/Range_imaging" rel="noopener ugc nofollow" target="_blank"> RGB-D </a>相机中获得，这些相机结合了特殊的相机镜头和结构光、飞行时间或干涉测量法来测量距离。</p><h1 id="fe8f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">转换数据</h1><p id="ed9e" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">表示机器人或传感器的空间关系的数据需要被翻译，以便表示实际的数据。在抽象的层面上，移动机器人由不同的结构组件组成，例如它的中心、轮子、安装在顶部的传感器等等。这些组件中的每一个都有一个基点，即x、y、z形式的绝对坐标参考。现在，假设一个传感器安装在机器人的顶部。该传感器对其周围环境进行激光扫描。这些测量是从传感器的基点开始的。但是为了采取行动，我们需要<em class="js">转换</em>传感器数据来匹配机器人的中心基点。为此，ROS使用了一个<em class="js">变换树</em>，一种确定从机器人中心基点到其他组件基点的偏移的表示。例如，平移<code class="du jo jp jq jr b">x=1.0, y=0.0, z=5.0</code>意味着传感器安装在前方1.0厘米处，中心基点上方5.0凸轮处。如果你有一个完整的机器人模型，那么这些关系是由ROS自动计算的。</p><p id="ea49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就完成了数据要求。现在，让我们考虑单独的导航栈组件。</p><h1 id="b094" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导航堆栈组件</h1><p id="8ccf" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">在ROS导航堆栈中，利用变换、里程计和传感器数据来确定机器人的位置，并在给定目标的情况下，确定移动到哪里。为了实现这一点，需要ROS导航栈的不同软件组件。</p><p id="814e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们看一下<a class="ae jt" href="https://wiki.ros.org/navigation/Tutorials/RobotSetup" rel="noopener ugc nofollow" target="_blank">官方文档</a>提供的概述。下面将讨论每个组件。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/c56f2a367e7f56ec498da4479ec8189e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7n6mkKAxncDH8Qjk.png"/></div></div></figure><p id="303b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="js">来源:</em><a class="ae jt" href="https://wiki.ros.org/navigation/Tutorials/RobotSetup?action=AttachFile&amp;do=get&amp;target=overview_tf.png" rel="noopener ugc nofollow" target="_blank"><em class="js">https://wiki.ros.org/navigation/Tutorials/RobotSetup?action = attach file&amp;do = get&amp;target = overview _ TF . png</em>T12】</a></p><h1 id="745b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导航规划器</h1><p id="c9be" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">计划者节点负责计算给定目标的所有可能的遍历选项。他们将创建成本图来表示采取某条路径或一系列步骤的努力。有两个策划者。全球规划者是制定长期规划的高级组件。它的配置选项包括检测障碍物的距离将存储在成本图中，从机器人到障碍物的空间是否应该保持空闲，以及机器人的基本足迹或半径。本地规划者评估机器人需要采取的下一步，并且需要配置机器人的基本运动能力、最小/最大速度和加速度。</p><h1 id="f963" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">基本控制器</h1><p id="8d57" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">当规划器决定走哪条路时，它将向<code class="du jo jp jq jr b">cmd_vel</code>主题发送<code class="du jo jp jq jr b">Twist</code>消息。然后，机器人的基本控制器需要监听这些消息并应用移动命令。</p><h1 id="0274" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">地图服务器</h1><p id="9f4e" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">地图服务器是用于创建环境表示的可选组件。可以记录并保存地图，然后在机器人下次运行时使用，甚至可以导出到另一个机器人。</p><h1 id="5c8c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导航算法</h1><p id="b13e" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">解释完数据要求并列出导航栈的par后，我们现在可以选择一个合适的算法。</p><p id="0ae7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ROS导航基于SLAM，这是一种提供同步定位和地图绘制的方法。这意味着机器人可以在移动的同时制作地图，并同时使用该地图来定位其位置。正如本文开头所解释的，导航堆栈需要激光扫描或点云数据的可用性。因此，支持的导航算法建立在这些格式之上。</p><p id="e5e0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于RSO1，存在两种SLAM算法。库<a class="ae jt" href="http://wiki.ros.org/rtabmap_ros" rel="noopener ugc nofollow" target="_blank"> rtabmap_ros </a>是一个最新的基于RGB-D的算法，具有良好的文档记录和丰富的示例文档。RTAB代表实时基于外观的映射，可用于生成3D点云数据和2D占用网格。在<a class="ae jt" href="http://wiki.ros.org/rtabmap_ros/Tutorials/HandHeldMapping" rel="noopener ugc nofollow" target="_blank">手持绘图教程</a>中可以找到针对各种设备的通用教程。库<a class="ae jt" href="http://wiki.ros.org/orb_slam2_ros" rel="noopener ugc nofollow" target="_blank"> orb_slam2 </a>使用来自单目、立体和RGB-D相机的简单图像数据来创建地图。但是，它最多只支持ROS1发行版melodic。</p><p id="2762" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于ROS2，有几种选择:</p><ul class=""><li id="3344" class="kx ky hi is b it iu ix iy jb kz jf la jj lb jn lc ld le lf bi translated"><a class="ae jt" href="https://github.com/Project-MANAS/slam_gmapping" rel="noopener ugc nofollow" target="_blank"> SLAM Gmapping </a> : ROS2核心SLAM包，需要一个<code class="du jo jp jq jr b">sensor_msg/laser_scan</code>主题才能工作。</li><li id="2d65" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated"><a class="ae jt" href="https://github.com/ros2/cartographer" rel="noopener ugc nofollow" target="_blank">制图员</a>:利用一组可变传感器同时进行2D/3D Slam</li><li id="aabd" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated"><a class="ae jt" href="https://github.com/berndpfrommer/basalt_ros2" rel="noopener ugc nofollow" target="_blank">玄武岩ROS2 </a>:玄武岩是一个大学研究项目，旨在结合图像和IMU数据进行精确定位</li><li id="cff7" class="kx ky hi is b it lg ix lh jb li jf lj jj lk jn lc ld le lf bi translated"><a class="ae jt" href="https://github.com/rsasaki0109/lidarslam_ros2" rel="noopener ugc nofollow" target="_blank">激光雷达slam ROS2 </a>:使用激光雷达扫描和<a class="ae jt" href="https://en.wikipedia.org/wiki/OpenMP" rel="noopener ugc nofollow" target="_blank">OpenMP</a>——用于精确定位</li></ul><h1 id="5a63" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="3cf3" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">本文研究了用于实现机器人自主导航的ROS导航栈。首先，我们了解了机器人需要满足的基本要求:a)它大致呈方形，b)它使用差动或完整驱动，c)它提供激光扫描或点云数据。其次，我们了解了转换、里程计和传感器数据。第三，我们看到了导航堆栈的不同组件以及如何处理数据。本质上，导航基于SLAM，即同步定位和地图绘制，这是当前的技术标准。SLAM使机器人能够在任何环境中移动，在移动的同时形成地图，并获得在该地图中导航的能力。</p></div></div>    
</body>
</html>
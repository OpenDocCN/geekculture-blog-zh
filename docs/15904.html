<html>
<head>
<title>SQL Interview Question5:Finding brands with increasing prices of laptops every year— Use Case of Lead() Window Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL面试问题5:寻找笔记本电脑价格逐年上涨的品牌Lead()窗口函数的使用案例</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/sql-interview-question5-finding-brands-with-increasing-prices-of-laptops-every-year-use-case-of-a2b46b9c7692?source=collection_archive---------8-----------------------#2022-11-29">https://medium.com/geekculture/sql-interview-question5-finding-brands-with-increasing-prices-of-laptops-every-year-use-case-of-a2b46b9c7692?source=collection_archive---------8-----------------------#2022-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="42ea" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">SQL面试问题系列中的第5名</h2><div class=""/><div class=""><h2 id="d7d9" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">最常见的SQL面试查询和概念#SQL #RDBMS</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/fa451d765f8858fa62fe4185f02d6cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBjl3WUOHtV87sLVj3kavA.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Photo by <a class="ae jw" href="https://unsplash.com/@casparrubin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="ae jw" href="https://unsplash.com/s/photos/sql?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d85c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">大家好！！</p><p id="f9c6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这是SQL面试问题系列中的下一个面试问题。</p><blockquote class="kt ku kv"><p id="8b80" class="jx jy kw jz b ka kb is kc kd ke iv kf kx kh ki kj ky kl km kn kz kp kq kr ks hb bi translated"><strong class="jz hs">问题陈述:今天的问题陈述是找出这些年来价格不断上涨的笔记本电脑品牌。</strong></p></blockquote><p id="4017" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs">数据:</strong>我们有一个名为<strong class="jz hs"> <em class="kw">笔记本电脑</em> </strong>的表，有3列年份、品牌和价格，总共16条记录。数据是连续4年的，有4个不同的品牌和他们的价格。见下图选择*查询查看其详细信息:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es la"><img src="../Images/12824d417471d9dc74d633ea927d345d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9E2ewp63aH2GOEcRzC2ivg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure><p id="c4bd" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在，既然问题是找到明年的价格上涨。我们应该使用<strong class="jz hs"> <em class="kw"> lag() </em> </strong>或<strong class="jz hs"> <em class="kw"> lead() </em> </strong>窗口函数，这样我们就可以访问当前行的前一行或后一行的数据。让我们继续使用<strong class="jz hs"> <em class="kw"> lead() </em> </strong>函数来访问当前行中后续行的数据。<strong class="jz hs">的语法为<em class="kw"/></strong>的功能是:</p><pre class="jh ji jj jk fd lb lc ld bn le lf bi"><span id="ca3d" class="lg lh hi lc b be li lj l lk ll">Lead( expression, offset, default) Over(PARTITION BY ……… ORDER BY......)<br/><br/>Expression: Value which we want to return<br/>Offset: The number of rows next from current row, which we want to access. By default, it is 1.<br/>dafault: When succeeding row is not defined, specified deafult will be returned. If not mentioned, NULL will be returned for the last row, since they don't have any succeeding rows.</span></pre><p id="71f7" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">使用lead()函数创建一个新列<em class="kw"> next_price，</em></p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lm"><img src="../Images/01accee054429fd622f32bb127d1f064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EyWMFoS7euTUYooXQ91ilg.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure><p id="eae4" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这里发生了三件事:</p><ol class=""><li id="5afe" class="ln lo hi jz b ka kb kd ke kg lp kk lq ko lr ks ls lt lu lv bi translated"><strong class="jz hs"> <em class="kw"> partition by </em> </strong>子句将首先按每个品牌对数据进行分区。</li><li id="c179" class="ln lo hi jz b ka lw kd lx kg ly kk lz ko ma ks ls lt lu lv bi translated"><strong class="jz hs"> <em class="kw"> Order by </em> </strong>将按日期升序排列数据。</li><li id="4822" class="ln lo hi jz b ka lw kd lx kg ly kk lz ko ma ks ls lt lu lv bi translated"><strong class="jz hs"> <em class="kw">【价格】</em> </strong>然后将填充当前行中下一行的数据。</li></ol><p id="8d55" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">因为对于所有品牌，2021年的数据没有后续行，所以<em class="kw"> next_price </em>将作为NULL返回，因为默认值中没有提到任何内容。</p><p id="5e4d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">假设每个品牌明年的价格(2022年)都将高于2021年的价格。让我们在其中加1，并把它作为默认值，</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mb"><img src="../Images/c68558e1e028dc4f9ccf7ef89d03c830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pV4RSlJlHA0FYnmWWJ9rBA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure><p id="6d00" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">下一步是使用带有 子句的<strong class="jz hs"> <em class="kw">将它放在CTE，并获取<strong class="jz hs"><em class="kw">price _ increase</em></strong>列中每条记录的价格差。</em></strong></p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mc"><img src="../Images/f69f1376f00d7eb891512ae9dbb23495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*evik-7xFY99_P4XK527ZVQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure><p id="8cea" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">主要任务是只获取那些价格一直上涨的品牌。为了前任。对于宏碁品牌，价格从2018年到2019年下降，然后上升，因此我们需要忽略该品牌，而对于惠普，价格在4年内一直上升，因此惠普应该在产量方面有所增长。</p><p id="1a4d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这里的逻辑是，我们可以创建一个0，1的标志，将0分配给价格下降的记录，而将1分配给价格上升的记录。让我们使用<strong class="jz hs"> <em class="kw"> case </em> </strong>语句来实现这一点，</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es md"><img src="../Images/ec0c81520b5b8bed34d4d6e96d1ec381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7r53cS2qXmJO_bWSPvoMA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure><p id="31c1" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在，要删除这些品牌(注意:我们必须忽略具有单个0标志的整个品牌)，请将条件放在<strong class="jz hs"> <em class="kw"> where </em> </strong>子句中，</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es me"><img src="../Images/61318ef0a7a7c2df0c6c41286e43f608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYvGOFT3K3bmWvXQmCVQnw.png"/></div></div></figure><p id="bddb" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们这里只剩下2个品牌，8个记录。要看这些品牌，</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mf"><img src="../Images/4d07d62d0963b8f4b52370a30f4c0b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iVtX90rPxb3INWzN5tdJA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Credits: By Author</figcaption></figure></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><p id="e865" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">所以这都是关于使用lead()函数来查看每年笔记本电脑价格的增长。</p><p id="8780" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">你可以在我的GitHub页面链接上找到这些问题。</p><div class="mn mo ez fb mp mq"><a href="https://github.com/sdeeksha07/SQL-LEAD-AND-LAG-FUNCTION-USE-CASES/tree/main" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hs fi z dy mv ea eb mw ed ef hr bi translated">GitHub-sdeeksha 07/SQL-领先和滞后-功能-用例</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">github.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne jq mq"/></div></div></a></div><p id="da43" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">希望对你有所帮助。</p><p id="1d9c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如有任何疑问，请通过LinkedIn、Twitter或电子邮件联系我。</p><p id="4b19" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs"> <em class="kw">邮箱:sdeevi07@gmail.com</em></strong></p><p id="fbf0" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">【https://twitter.com/sdeeksha07】<em class="kw">碎碎念:</em><a class="ae jw" href="https://twitter.com/sdeeksha07" rel="noopener ugc nofollow" target="_blank"><strong class="jz hs"><em class="kw"/></strong></a></p><p id="aae2" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs"> <em class="kw">领英:</em></strong><a class="ae jw" href="https://www.linkedin.com/in/sdeeksha07/" rel="noopener ugc nofollow" target="_blank"><strong class="jz hs"><em class="kw">https://www.linkedin.com/in/sdeeksha07/</em></strong></a></p><p id="f710" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs">坚持学习，坚持练习！！</strong></p></div></div>    
</body>
</html>
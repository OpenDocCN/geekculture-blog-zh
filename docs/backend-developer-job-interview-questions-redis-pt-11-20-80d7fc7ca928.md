# 后端开发人员工作面试问题— Redis (Pt。11–20)

> 原文：<https://medium.com/geekculture/backend-developer-job-interview-questions-redis-pt-11-20-80d7fc7ca928?source=collection_archive---------9----------------------->

![](img/081ad2b30a0acb48669797810a84a1a7.png)

## 11.Redis 提供了两种持久性机制。它们是什么？

**1)RDB(Redis Database)** RDB 是 Redis Database 文件的简称。Redis 以指定的时间间隔提供其数据集的快照。

**优点:**
——RDB 是 Redis 数据的一种紧凑的单文件时间点表示，这使得它非常适合备份。我们可以在一段时间内定期对它们进行存档。这使得我们可以轻松地存储不同版本的数据集
——RDB 有利于灾难恢复。
-与 AOF 相比，RDB 允许更快地重启大数据集。
- RDB 使用子进程进行数据持久化，这不会影响父进程正在进行的操作。

**缺点:**
- RDB 文件在时间点之间保存数据。如果 Redis 在持久性时间点之间关闭，将会丢失最新数据。因此，RDB 更适合对数据精度要求不是很高的场景。

**2) AOF(仅附加文件)** AOF 文件记录所有写操作，重启时重新加载到服务器。

**优点:**
——我们可以有不同的 fsync 策略:完全没有 fsync，每秒 fsync，或者每次查询都有 fsync。它确保了数据的准确性，因为对数据集的每次写入操作都会被记录下来。
-停电时不会出现寻道和腐败问题。即使日志由于某种原因以一个写了一半的命令结束，我们也可以使用 redis-check-aof 工具来修复它。
- Redis 可以在 AOF 变大的时候自动在后台重写。在重写的时候，Redis 会把新的尽可能的精简。新生成的操作仍然追加到旧文件中，一旦第二个文件准备好了，Redis 就会切换这两个文件并开始追加到新文件中。

**缺点:**
——AOF 的文件大小比 RDB 相同数据集的文件大小要大。
-数据集越大，AOF 的启动时间越长。

官方不建议仅使用 AOF，我们应该使用 RDB 文件或两者的组合来确保数据安全/

## 12.描述 Redis 适合使用的一些场景。

**1)发布&订阅**
使用 Redis 的发布&订阅，我们可以在社交网络中使用它，建立一个聊天系统。
**2)会话缓存**
Redis 提供持久性，以便可以检索会话数据，例如，在丢失用户购物车信息的情况下。
**3)整页缓存**
由于磁盘的持久性，加载一整页的速度会明显降低。
**4)队列**
Redis 提供了可以用于消息队列的列表和设置操作。有一些开源项目可以用来实现 Redis 队列。芹菜就是一个例子，它使用 Redis 作为经纪人。
**5)排行榜/计数器**
Redis 有递增和递减操作。集合和有序集合也允许更容易的操作。

## 13.如何在集群中实现会话共享存储？

一个群集包含多个服务器实例。实例之间的会话信息可能不一致。例如，当用户登录时，会话信息存储在实例 a 上。如果浏览其他页面，而实例 B 开始处理，则先前的登录会话不会广播给 B，用户将再次被要求提供登录信息。我们可以用 3 种方法来解决这个问题:
**1)粘性会话**
每次都将同一个用户的所有请求转发到同一个服务器——将用户绑定到服务器。
**2)服务器会话复制**
每当一个会话发生变化，就广播到集群中的所有服务器。
**3)会话持久化**
在数据库中持久化会话

## 14.如何使用 Redis 作为异步队列？

我们通常使用列表结构作为队列，用 *rpush* 产生消息，用 *lpop* 消费消息。当没有消息可供使用时，我们可以使用 *blpop* 命令，这样客户端连接将被阻塞，直到新消息被推送到列表中。

## 15.你了解 Redis 的同步机制吗？

Redis 采用主从同步和主从同步。在第一次同步期间，主节点执行 *bgsave* 并记录对存储缓冲器的后续修改操作。完成后，RDB 文件将同步到复制节点。复制节点接受完成后，RDB 映像将加载到内存中。通知主节点将该期间的操作记录同步到复制节点进行回放，同步过程完成。

## 16.Redis 集群是如何复制的？

异步复制。

## 17.你对 Redis 交易有什么理解？

Redis 事务是 Redis 命令的集合。转换是原子性的，也就是说，要么执行一个事务中的所有命令，要么不执行任何命令。

## 18.Redis 回收流程是如何工作的？

当客户端执行新命令并添加新数据时，Redis 会检查新添加的数据是否超过最大内存。如果是，根据预设的回收策略，Redis 将回收低于最大内存的内存，并执行新命令。这 7 个策略是:
1) **volatile-lru** :从设置了“过期”字段的所有密钥中驱逐最近最少使用的密钥
2) **volatile-ttl** :从设置了“过期”字段的所有密钥中驱逐最短生存时间的密钥。
3) **volatile-random** :随机驱逐设置了“expire”字段的密钥
4) **volatile-lfu** :驱逐设置了“expire”字段的所有密钥中最少使用的密钥
5) **allkeys-lru** :驱逐所有密钥中最近最少使用的密钥
6) **allkeys-random** :随机驱逐所有密钥中最少使用的密钥
**allkeys-lfu** :驱逐所有键中最不常用的键
8) **不驱逐**:当尝试插入更多数据时，如果达到内存限制，则返回错误

## 19.MySQL 有 2000w 数据，Redis 只有 20w 数据。如何保证 Redis 中的数据都是热点数据？

当数据集增加到一定规模时，我们将使用消除策略。[参考第 18 部分的 8 个策略]

## 20.Redis 中的流水线是什么？

多个命令将同时发送到 serve0，减少 IO 之间的时间间隔。这些命令通常是相互独立的。

我希望这篇文章对你有所帮助。如果你像我一样渴望学习一些与技术相关的东西或定期反思工作和生活，请关注我的频道，了解我日常工作和生活中的最新灵感。

演职员表:
[https://zhuanlan.zhihu.com/p/276371544](https://zhuanlan.zhihu.com/p/276371544)
[https://www.fullstack.cafe/blog/redis-interview-questions](https://www.fullstack.cafe/blog/redis-interview-questions)
[https://redis.io/topics/persistence](https://redis.io/topics/persistence)
[https://docs . redis . com/latest/RS/administrating/database-operations/eviction-policy/](https://docs.redis.com/latest/rs/administering/database-operations/eviction-policy/)
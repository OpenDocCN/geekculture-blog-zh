<html>
<head>
<title>Location Marking with Folium in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python中的叶子进行位置标记</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/location-marking-with-folium-in-python-329d0c11fa8b?source=collection_archive---------9-----------------------#2021-09-09">https://medium.com/geekculture/location-marking-with-folium-in-python-329d0c11fa8b?source=collection_archive---------9-----------------------#2021-09-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/249351dac794c15a207f12e6a89f5348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n4-9kwws_v0Bw7DU"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@timowielink?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Timo Wielink</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f4a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您是否曾经需要在地图上添加标记来可视化一些数据？别再担心那个了。事实证明，使用flour库用Python在地图上添加位置标记是相当容易的。关于叶库的官方文档可以在这里找到<a class="ae iu" href="https://python-visualization.github.io/folium/index.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c3d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于本教程，我将假设您已经安装了Python。所以你需要做的第一件事就是安装叶库。您可以通过执行以下命令来实现这一点:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="103f" class="kc kd hi jy b fi ke kf l kg kh">pip install folium</span></pre><p id="1229" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">差不多就是这样。您已经准备好可视化地图上的标记。所以接下来要做的事情显然是将叶子导入到我们的代码中。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="962b" class="kc kd hi jy b fi ke kf l kg kh">import folium</span></pre><p id="eeb1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以要开始使用这个库，你需要创建一个叶子地图对象。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="b6ea" class="kc kd hi jy b fi ke kf l kg kh">folium_map = folium.Map()</span></pre><p id="cba6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来要做的是获得你想要在地图上显示的坐标。出于论证原则的目的，我选择了意大利的几个热门景点，罗马。坐标如下:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="20e7" class="kc kd hi jy b fi ke kf l kg kh"># Latitude, Longitude<br/>LOCATION_DATA = [<br/>    ("41.90093256", "12.48331626"),<br/>    ("41.89018285", "12.49235900"),<br/>    ("41.89868519", "12.47684474"),<br/>    ("41.89454167", "12.48303163"),<br/>    ("41.90226256", "12.45739340"),<br/>    ("41.90269661", "12.46635787"),<br/>    ("41.91071023", "12.47635640"),<br/>    ("41.90266442", "12.49624457")<br/>]</span></pre><p id="4b97" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来要做的是在地图上用这些位置添加标记。最简单的方法是循环遍历<code class="du ki kj kk jy b">LOCATION_DATA</code>列表并将它们添加到follow _ map对象中。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6f56" class="kc kd hi jy b fi ke kf l kg kh">for cords in LOCATION_DATA:<br/>    folium.Marker(location=[cords[0], cords[1]]).add_to(folium_map)</span></pre><p id="71b3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后一步是将这些信息保存到html文件中，该文件可以通过浏览器打开。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="f15e" class="kc kd hi jy b fi ke kf l kg kh">folium_map.save("FoliumMap.html")</span></pre><p id="b138" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果您将所有内容正确地组合在一起，您的输出应该是“FoliumMap.html”文件。当然，如果您打开这个文件，您会看到与下面提供的视图类似的视图。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/1f81aa69f625bc616f38defbc71c8fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J_hlEXUWHZOlWqdAduM1vw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image 1 — View after opening “FoliumMap.html” file in your browser (image by Author)</figcaption></figure><p id="9486" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当然，您可以缩放视图，但一般来说，您希望从一开始就以缩放方式查看视图。实际上，你可以在创建叶子地图对象时这样做。为此，您需要提供<code class="du ki kj kk jy b">location</code>和<code class="du ki kj kk jy b">zoom_start</code>参数。在这种情况下，我从<code class="du ki kj kk jy b">LOCATION_DATA</code>列表和<code class="du ki kj kk jy b">zoom_start=14</code>中选择位置作为第一个点，因为这在我的笔记本电脑屏幕上提供了一个很好的视图。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="ffb1" class="kc kd hi jy b fi ke kf l kg kh">folium_map = folium.Map(location=[LOCATION_DATA[0][0], LOCATION_DATA[0][1]], zoom_start=14)</span></pre><p id="286e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们现在运行相同的代码，输出将如下所示:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/7c7cd51906b9c04dcb8aeedbb7a804c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFoSmWaFs2hBDd2vZMVKCQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image 2 — View after opening “FoliumMap.html” file in your browser when providing initial location and zoom_start parameter (image by Author)</figcaption></figure><p id="3f17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你知道你的标记应该在地图上的什么地方，这个方法就足够好了。但是，最好放大到标记自动出现的位置。</p><h1 id="d6a7" class="kn kd hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">自动变焦</strong></h1><p id="487e" class="pw-post-body-paragraph iv iw hi ix b iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo lo jq jr js hb bi translated">事实证明，叶有一个方法，可以帮助自动放大我们的标记所在的区域。那种方法叫做<code class="du ki kj kk jy b">fit_bounds</code>。你可以在这里阅读更多相关信息<a class="ae iu" href="https://python-visualization.github.io/folium/modules.html#folium.folium.Map.fit_bounds" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="994f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据文档，我们需要以经纬度点列表的形式提供西南和东北角。在我们的格式中有了<code class="du ki kj kk jy b">LOCATION_DATA</code>，我们可以很容易地得到这些点:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="d909" class="kc kd hi jy b fi ke kf l kg kh">south_west_corner = min(LOCATION_DATA)<br/>north_east_corner = max(LOCATION_DATA)</span></pre><p id="d8ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">剩下的唯一一件事就是在我们的<code class="du ki kj kk jy b">folium_map</code>对象上调用<code class="du ki kj kk jy b">fit_bounds</code>方法:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="030a" class="kc kd hi jy b fi ke kf l kg kh">folium_map.fit_bounds([south_west_corner, north_east_corner])</span></pre><p id="a0ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这给了我们如下所示的结果:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/646296a5455a7e9f73f220a5b57f7612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TfmJEbCdeSB8VcTpRUq2nA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image 3 — View after opening “FoliumMap.html” file in your browser after applying fit_bounds method (image by Author)</figcaption></figure><h1 id="faa5" class="kn kd hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">给标记添加弹出菜单</strong></h1><p id="0079" class="pw-post-body-paragraph iv iw hi ix b iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo lo jq jr js hb bi translated">当然，在地图上放置一堆标记可能对您有意义，但对其他人没有意义，所以这就是为什么我们应该在标记中添加一些信息——比如纬度、经度和位置名称。为此，我将添加一个新的名单，根据坐标命名的位置。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="31c2" class="kc kd hi jy b fi ke kf l kg kh">LOCATION_NAMES = [<br/>    "Trevi Fountain",<br/>    "Colosseum",<br/>    "Pantheon",<br/>    "Piazza Venezia",<br/>    "St. Peter’s Square",<br/>    "Mausoleum of Hadrian",<br/>    "Piazza del Popolo",<br/>    "Fountain of the Naiads"<br/>]</span></pre><p id="678a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在唯一要做的就是将这些信息添加到我们的标记中:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="fb9d" class="kc kd hi jy b fi ke kf l kg kh">for cords, name in zip(LOCATION_DATA, LOCATION_NAMES):<br/>    folium.Marker(location=[cords[0], cords[1]],<br/>                  popup=f"Lattitude:&lt;br&gt;{cords[0]}&lt;br&gt;"<br/>                        f"Longitude:&lt;br&gt;{cords[1]}&lt;br&gt;"<br/>                        f"Name:&lt;br&gt;{name}"<br/>                  ).add_to(folium_map)</span></pre><p id="f018" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，您可以点击标记并查看更多信息</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/25812f25c9b15d1b3aec91db937b6ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXdayQyX_GhhZYftOnuo9g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image 4 — View after opening “FoliumMap.html” file in your browser after adding popup information to markers (image by Author)</figcaption></figure><p id="48af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里需要注意的一点是，弹出窗口中的文本必须是html格式。此外，您可能会注意到文本在弹出窗口中显示得不太好。可以通过使用定制的弹出窗口来解决这个问题，但是我将把它留到下一次讨论。如果你想自己搜索如何做到这一点，你应该寻找<code class="du ki kj kk jy b">folium.Popup</code>类。相关文档可以在<a class="ae iu" href="https://python-visualization.github.io/folium/modules.html?highlight=folium%20popup#folium.map.Popup" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="6cb4" class="kn kd hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated"><strong class="ak">结论</strong></h1><p id="37e0" class="pw-post-body-paragraph iv iw hi ix b iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo lo jq jr js hb bi translated">如您所见，使用叶库非常容易，您可以立即在地图上可视化数据。当然，这只是显示了你可以用叶子做什么的基础</p><p id="c4aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经上传了最终的代码版本到我的github库:<a class="ae iu" href="https://github.com/vycart/folium_markers" rel="noopener ugc nofollow" target="_blank">https://github.com/vycart/folium_markers</a></p><p id="ec9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有任何问题，我很乐意回答。</p></div></div>    
</body>
</html>
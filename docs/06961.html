<html>
<head>
<title>The Story of a Backend: Paving the Paths</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">后端的故事:铺平道路</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/the-story-of-a-backend-paving-the-paths-7d22d2a6022c?source=collection_archive---------25-----------------------#2021-09-02">https://medium.com/geekculture/the-story-of-a-backend-paving-the-paths-7d22d2a6022c?source=collection_archive---------25-----------------------#2021-09-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b19db078ed2efb1a48475f5075d92443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u6ukSzVfwUC8XAmv"/></div></div></figure><p id="1776" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，欢迎来到这个奇妙旅程的下一部分，我们将深入了解后端开发过程。到目前为止，我们已经讨论了设置一个节点项目，并开始与数据库(对我们来说将是一个sql数据库)对话。等待..你读过前两部分吗？没有吗？这里是到<a class="ae jo" rel="noopener" href="/geekculture/the-story-of-a-backend-the-beginning-e51a31ea83d5">第一部分(开始)</a>和<a class="ae jo" rel="noopener" href="/geekculture/the-story-of-a-backend-the-database-decisions-39f197f65d4">第二部分(关于数据库的讨论)</a>的链接。</p><p id="f943" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哦，林克斯提醒了我..今天的目标是制造端点，并进行一系列的路由，以引导我们的请求通过路径的丛林，得到他们想要的东西。对于所有的路由和应用程序创建，我们将使用一个非常流行的web框架nodeJS——Express(我们在第1部分中安装了它😬).在我们进入一堆很酷的代码之前，让我们先谈谈express，理解实际发生了什么，以及为什么我要做我正在做的事情..我们走吧！</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="4ae8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">中间件</strong></p><p id="349e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">xpress是一个令人惊叹的框架，它没有太多自己的功能，应用程序可以被认为是一系列的函数调用。中间件是我们为实现某种功能而运行的功能。为了在应用中使用一个函数，我们使用use()方法(会出现很多次)。</p><p id="c81b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在express中使用了三种中间件..</p><ul class=""><li id="0a3c" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated">&gt;应用中间件:使用app.use()或app将应用级中间件添加到应用中。REST_VERB()。其中REST_VERB可以是get、post、put等。下面是一个相同的例子..</li></ul><pre class="kf kg kh ki fd kj kk kl km aw kn bi"><span id="d15a" class="ko kp hi kk b fi kq kr l ks kt">Note: If the current middleware function does not end the request-response cycle, it must call <!-- -->next()<!-- --> to pass control to the next middleware function. Otherwise, the request will be left hanging.</span></pre><p id="9491" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设app是一个express实例，</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/051398ed9dd5f827e7b0a8bee7d6e792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fIBlFye7W0BfBiNj2kpGgw.png"/></div></div></figure><figure class="kf kg kh ki fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/7eb47582b45ecd05cb901c106255fd14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRlPdg-Q8inyU-mZYjTy2Q.png"/></div></div></figure><p id="b775" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这只是一个在控制台上显示当前时间的函数示例。我们从express导入express函数。我们实例化一个express应用程序，并将中间件添加到应用程序中。请注意，在运行中间件时缺少任何特定的路径。</p><p id="edb6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们想把它附加到一个路径上，代码应该是这样的</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/a669e2d8c1472358b20be010a18ef8f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*rLjyO9YRmZlhSvjU7V7LKQ.png"/></div></figure><ul class=""><li id="f424" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated">&gt;路由中间件:在某条路由上增加一个路由中间件。对于我们的目的来说，这是最常见的中间件。我们使用express router为应用程序创建路由，并在路由器上附加一个中间件。这种中间件的一个例子如下</li></ul><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es kx"><img src="../Images/aeb52720d11b479ade71cce6428c6f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*6UDtrvP40gEhljKGuZUCEg.png"/></div></figure><ul class=""><li id="fdbf" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated">&gt;第三方中间件:这为应用程序提供了一些额外的功能，但也让我们免去了从头创建所有代码和考虑所有处理的痛苦..我们将使用这种中间件的一些例子是..</li></ul><ol class=""><li id="6859" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn ky kc kd ke bi translated">摩根—用于伐木</li><li id="9226" class="jw jx hi is b it kz ix la jb lb jf lc jj ld jn ky kc kd ke bi translated">头盔-头盔通过设置各种HTTP头来帮助您保护您的Express应用程序。<em class="le">这不是银弹</em>，但能有所帮助。(用于生产环境)</li><li id="a2bb" class="jw jx hi is b it kz ix la jb lb jf lc jj ld jn ky kc kd ke bi translated">cookie-parser——解析<code class="du lf lg lh kk b">Cookie</code>头，并用一个以cookie名称为关键字的对象填充<code class="du lf lg lh kk b">req.cookies</code></li></ol><p id="db7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">添加第三方中间件的示例如下</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es li"><img src="../Images/e811899229b4f6ab87805cb686031aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*0gqGbXCibHfthYjf1AxMHg.png"/></div></figure><ul class=""><li id="025e" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated">&gt;错误处理中间件——以与其他中间件功能相同的方式定义错误处理中间件功能，除了使用四个参数而不是三个，特别是使用签名<code class="du lf lg lh kk b">(err, req, res, next)</code></li></ul><figure class="kf kg kh ki fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/91d719cbb4dfe6beb9602903998c5f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*Ke-I-uJmOf1wqUQJkk88BA.png"/></div></div></figure><ul class=""><li id="2018" class="jw jx hi is b it iu ix iy jb jy jf jz jj ka jn kb kc kd ke bi translated">&gt;内置中间件—以前包含在Express中的中间件功能现在位于单独的模块中。下面是这种中间件的例子</li><li id="19d4" class="jw jx hi is b it kz ix la jb lb jf lc jj ld jn kb kc kd ke bi translated">express.static:服务于静态资产，比如HTML文件、图像等等。</li><li id="d32a" class="jw jx hi is b it kz ix la jb lb jf lc jj ld jn kb kc kd ke bi translated">json:用JSON有效负载解析传入的请求。(适用于express 4.16.0以上版本)</li><li id="7c04" class="jw jx hi is b it kz ix la jb lb jf lc jj ld jn kb kc kd ke bi translated">express.urlencoded:用URL编码的有效负载解析传入的请求。(适用于express 4.26.0以上版本)</li></ul><p id="0b2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是一个添加内置中间件的例子</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/de82e6803dba271cb85a0f40b6807d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*F-3d91ksc_LyucHd0ApxAQ.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx">this is snippet from another app I was working on(but the sensitive data is well hidden😬)</figcaption></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="d086" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，这是出的方式，让我们谈谈如何设置我们一些路由使用快速路由器。</p><p id="3ed2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">能够创建这样的路由器的有趣之处在于，我们可以创建一个路由器，将中间件添加到路由中，并将路由器传递给应用程序，并且我们保持模块化..</p><p id="69da" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们创建文件夹routes来存储路由器并从那里导出它们。</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/d34fcc5e999a817fe068d1743faf839a.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*PVHvDfkkBdtt2VxS8fZK0Q.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx">the routes folder structure</figcaption></figure><p id="5f3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是一个示例路由文件代码</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/e845c2879bd68140a52907d22fbf3736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lea2YgfTcBNyK92-T5GwLw.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx">myRouter.ts file content</figcaption></figure><p id="5730" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有路线都被提取到indedx.ts文件中，应用程序可以从该文件中访问所有路线</p><figure class="kf kg kh ki fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/1475a05747fd8fe44588f3f99a75f08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pc3m6SWvpSwY7HLyEBKQLQ.png"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx">index.ts file content</figcaption></figure><p id="cde3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，现在我们已经了解了如何从节点应用程序开始，我们已经谈了一些关于数据库以及如何将nodeJS连接到SQL数据库的内容，如果我成功地做了一个很好的演示，我们也知道如何将中间件添加到应用程序中，并在express中获得路由。</p><p id="7839" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一篇博客中，我们将用创建基于nodeJS的服务器将应用程序连接到数据库的详细信息来总结这个故事。</p><p id="201f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">直到那时..玩得开心，保重和超！</p></div></div>    
</body>
</html>
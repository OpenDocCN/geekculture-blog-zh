<html>
<head>
<title>Hyperparameter tuning in Random Forest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林中超参数调整</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/random-forest-algorithm-has-proven-to-be-one-of-the-most-sought-after-algorithm-in-the-field-of-295da606bf9?source=collection_archive---------1-----------------------#2021-09-11">https://medium.com/geekculture/random-forest-algorithm-has-proven-to-be-one-of-the-most-sought-after-algorithm-in-the-field-of-295da606bf9?source=collection_archive---------1-----------------------#2021-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d11e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林算法已被证明是机器学习领域中最受欢迎的算法之一。这主要是因为它广泛地解决了由其父算法决策树引起的问题，即过度拟合。决策树被指责为具有低偏差和高方差，因为它们评估树中的每个节点，并且通常以遵循相同的模式而不是概括学习而告终。</p><p id="02c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一方面，随机森林通过称为引导的过程随机选择数据集的行和要素来解决这个问题。这种随机化仅允许少数样本和特征出现在一个树中，但确保所有样本和特征都在其他树中被考虑，因此消除了过度拟合的可能性。在考虑不同的特征和样本创建多个树之后，在分类变量的情况下，算法的输出由接收最多投票的字段决定，而对于数值变量，所有可能输出的平均值被认为是最终预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1438fb935bfaaa4b5baa32f9990f147b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUBKhwIKQ-p75EL4gUiVSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Pictorial Representation of Random Forest with Bootstrapping</figcaption></figure><p id="d059" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整也是随机森林算法中可用的主要特性，它允许我们微调参数以优化算法的性能。</p><p id="2700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将重点关注随机森林在回归数据集上的实现，然后讨论如何微调超参数以优化模型性能。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/7afc19f5c53c56d0c01bac0ba66d4b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v3M714MTJlebtwI2j9xVbQ.png"/></div></div></figure><p id="3159" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经从Kaggle下载了上面的数据集，并导入了所有必要的库和数据集。为了对数据集有所了解，使用了df.head()命令。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/0a536acf1510403f737ce9049008f585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0RGFkZHIEl_a0FdcSgpzQ.png"/></div></div></figure><p id="2979" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">已经对数据集执行了所有可能的转换，现在数据为机器学习算法做好了准备。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/ac485f8ac473d21c2e45d3e6f1f9e722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DL6e5QKnKE7mzBT5nOt1aQ.png"/></div></div></figure><p id="f001" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林模型是用sckitlearn库的Random Forest类中可用的所有超参数的默认值创建的。随机森林的第一棵决策树是用命令模型绘制的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/41f4a0015745434c3dc6180e07fb1be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFzrTricy9UkVmQFbsDY0g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">The base model accuracy of the test dataset is 90.54%</figcaption></figure><p id="6e05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本模型精度为90.54%，这是一个很好的开始数字，但是训练精度为98.5%，我们可以得出该模型过度拟合的结论。但是，如果我们使用不同的超参数值来微调模型，我们可以进一步优化模型，使其具有更好的准确性，并且还可以在更大程度上消除过拟合。</p><p id="b205" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先让我们理解sckitlearn为随机森林提供的不同超参数。</p><p id="621e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(我)。n_estimators : </strong>这表示要在随机森林模型中创建的决策树的数量。通常，树的数量越多，模型的性能越好。但是大量的树会降低计算速度，因此有必要找到一个最佳值。</p><p id="9c2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(二)。max_depth: </strong>这表示我们的树可以分裂的最大范围。如果该值高于最佳值，模型将会过拟合。但是深度太浅会妨碍训练过程。因此，它建议找到一个最佳点，以确保良好的准确性。</p><p id="acfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(三)。min_samples_split: </strong>这表示从父节点分离后，节点中存在的最小样本。如果不满足这个条件，那么在父节点上不会发生分割。</p><p id="5db3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(四)。max_samples: </strong>这表示在引导过程中，从父数据集中考虑的最大样本数，以生成决策树。</p><p id="ab6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(五)。max_features: </strong>这表示自举时要考虑的最大特性数。</p><p id="2c2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">(六)。自举</strong> =真或假。bootstrap的默认值为True，但要禁用bootstrap，我们可以将其指定为False，整个数据集将被考虑用于决策树的形成。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/623656e08eb713045c0fe5debcee029e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgFZB1ilot9iqpZLHJIz5Q.png"/></div></div></figure><p id="a73b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建这些辅助函数是为了找到所有超参数的最佳值，这将提高模型的准确性。经过分析，我获得了超参数的最佳值，如下图所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jy"><img src="../Images/22425c51b92d66bb551bc7677a084d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCEF4Q8AWQeQ-fOgWCH4TA.png"/></div></div></figure><p id="c9d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在用超参数的最佳值创建模型之后，已经观察到模型的精确度增加了0.9%。甚至训练准确率降低到了95.7%，说明过拟合也被照顾到了。</p><p id="8f37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林是首选，因为与决策树相比，它们提供了优化、灵活性和可靠性。在优化模型时，我们的工作是研究并找出所有超参数的最佳点，以提高算法的整体性能。</p></div></div>    
</body>
</html>
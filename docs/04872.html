<html>
<head>
<title>How to create a custom ESLint configuration and shareable plugin? PART-1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建自定义的ESLint配置和可共享插件？第一部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-create-a-custom-eslint-configuration-and-shareable-plugin-part-1-78732dcafe81?source=collection_archive---------23-----------------------#2021-07-05">https://medium.com/geekculture/how-to-create-a-custom-eslint-configuration-and-shareable-plugin-part-1-78732dcafe81?source=collection_archive---------23-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="f4ed" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我关于媒介的第一篇文章。建议、欣赏、批评都是受欢迎的，因为这是我们学习的方式。😇</p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/01a3469bf7508100eacbf6a72e78279d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uh0S0aBfcOIUGibJHnm0eg.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image Source: <a class="ae jx" href="https://timesofindia.indiatimes.com/" rel="noopener ugc nofollow" target="_blank">https://timesofindia.indiatimes.com/</a></figcaption></figure><p id="ab0f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">开发人员确实会编写大量的代码，如果代码以一种良好的方式进行格式化，那么管理大型代码就变得更加容易。格式良好的代码易于阅读、维护和调试。我们使用插件来简化我们的格式化工作。其中一个插件是ESLint，它可以帮助Javascript开发者轻松格式化代码。</p><p id="a936" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">ESLint附带了许多内置配置，可以轻松使用。有时候我们可能需要有自己的自定义规则。在本文中，我将帮助您理解我们如何编写定制的ESLint规则/配置。</p><p id="d6aa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">让我们考虑一个规则，在这个规则中，我们限制在Javascript文件(或React组件)中使用颜色文字，我们将这个规则命名为:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="965e" class="kg kh hi kc b fi ki kj l kk kl">no-color-literals</span></pre><p id="7496" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">我们添加了这条规则，以避免在React应用程序的组件级样式中编写颜色属性。因此，我们将考虑为扩展名为<strong class="il hj">的文件添加规则。js </strong>和<strong class="il hj">。jsx </strong></p><blockquote class="if ig ih"><p id="2eaf" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated"><strong class="il hj">这是第1部分，我们将创建自定义的ESLint配置。请继续关注第2部分，在那里我们将看到如何使这个配置成为一个可共享的ESLint插件并跨JS项目安装。</strong></p><p id="a65e" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">参见此处的<a class="ae jx" rel="noopener" href="/@ndm0501/how-to-create-a-custom-eslint-configuration-and-shareable-plugin-part-2-22d4b03d218">第2部分。</a></p></blockquote><h1 id="41b2" class="km kh hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">第一步:</h1><h2 id="b3c6" class="kg kh hi bd kn lj lk ll kr lm ln lo kv jy lp lq kz jz lr ls ld ka lt lu lh lv bi translated">使用抽象语法树</h2><p id="3ea7" class="pw-post-body-paragraph ii ij hi il b im lw io ip iq lx is it jy ly iw ix jz lz ja jb ka ma je jf jg hb bi translated">在我们编写自定义的ESLint规则之前，我们必须了解我们的代码是如何构造的。为此，我们将借助<a class="ae jx" href="https://astexplorer.net/" rel="noopener ugc nofollow" target="_blank">作为探索者</a>。AST Explorer帮助我们分析代码的结构。我们将粘贴一个包含样式对象的小代码片段，它将覆盖<em class="ik"> React的JSX </em>语法以及<em class="ik"> VanillaJS </em>文件。</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="8e1d" class="kg kh hi kc b fi ki kj l kk kl">const pageStyles = {<br/>  textColor: {<br/>    color:'#123',<br/>  },<br/>};</span><span id="091f" class="kg kh hi kc b fi mb kj l kk kl">const MyComp = ({})=&gt;{<br/>  return (<br/>    &lt;div<br/>      style={{background:'black'}}<br/>    &gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span></pre><p id="9f2b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">上面的代码有两部分，一部分包含一个style对象<strong class="il hj"> pageStyles </strong>对象，该对象包含另一个对象，<strong class="il hj"> <em class="ik"> textColor </em> </strong>包含键值对。</p><p id="69b2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">下一部分是一个简单的React组件，有一个内联样式对象，同样包含键值对。</p><p id="7dca" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">键是一个<strong class="il hj"> <em class="ik"> Javascript风格的属性</em> </strong>，值是一个<strong class="il hj"> <em class="ik">十六进制颜色代码/颜色值</em> </strong>。</p><p id="0d0f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">让我们将上面的代码片段粘贴到浏览器中，并检查我们的代码是如何构建的。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mc"><img src="../Images/ab55758675ec4b24b1046f0d93c01862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5NWomKXAFcURpk55-bSaFQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 1: Style property node in AST</figcaption></figure><p id="c2eb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">注意这里，在右边，蓝色的文本，属性，标识符，文字都是节点。</p><p id="c7cf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">将鼠标悬停在<strong class="il hj"> <em class="ik">属性</em> </strong>节点上(在右侧)高亮显示<strong class="il hj">颜色:' #123' </strong>。这里，<strong class="il hj">颜色</strong>是一个<strong class="il hj"> <em class="ik">标识符</em> </strong>，<strong class="il hj"> '#123' </strong>是一个<strong class="il hj"> <em class="ik">文字。</em> </strong></p><p id="503d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">这对于内联样式对象也是一样的。查看下图:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es md"><img src="../Images/dca24a84e00a991d6b94e0e64d056a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m3SyeZ8ZRv9iCWtGfhocTA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 2: Style property node in AST</figcaption></figure><p id="3556" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">我们以后会需要这些细节。现在让我们设置我们的环境来编写和测试配置。 </p><h1 id="3b3f" class="km kh hi bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">第二步:</h1><h2 id="d989" class="kg kh hi bd kn lj lk ll kr lm ln lo kv jy lp lq kz jz lr ls ld ka lt lu lh lv bi translated">设置环境以编写和测试配置</h2><ol class=""><li id="02d8" class="me mf hi il b im lw iq lx jy mg jz mh ka mi jg mj mk ml mm bi translated">创建一个文件夹<code class="du mn mo mp kc b">eslint-custom-config</code>，用你喜欢的代码编辑器打开。</li><li id="ff98" class="me mf hi il b im mq iq mr jy ms jz mt ka mu jg mj mk ml mm bi translated">在<code class="du mn mo mp kc b">eslint-custom-config</code>文件夹中，运行<br/> <code class="du mn mo mp kc b">npm init -y</code>命令创建一个<code class="du mn mo mp kc b">package.json</code>文件</li><li id="bf03" class="me mf hi il b im mq iq mr jy ms jz mt ka mu jg mj mk ml mm bi translated">使用命令<code class="du mn mo mp kc b">npm i eslint</code> <br/>在本地安装ESLint。此外，您可以使用<code class="du mn mo mp kc b">npm i -g eslint</code>在全局安装ESLint</li><li id="430d" class="me mf hi il b im mq iq mr jy ms jz mt ka mu jg mj mk ml mm bi translated">在同一个文件夹中，创建一个名为<code class="du mn mo mp kc b">.eslintrc.js</code>的文件，并粘贴以下配置:</li></ol><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="7fe1" class="kg kh hi kc b fi ki kj l kk kl">module.exports = {<br/>  'env': {<br/>    'browser': true,<br/>    'commonjs': true,<br/>    'es2021': true<br/>  },<br/>  'extends': 'eslint:recommended',<br/>  'parserOptions': {<br/>    'ecmaVersion': 12<br/>  },<br/>  'rules': {<br/>    'indent': ['error', 4],<br/>    'linebreak-style': ['error','unix'],<br/>    'quotes': ['error','single'],<br/>    'semi': ['error','always']<br/>  }<br/>};</span></pre><p id="5254" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">5.要创建一个ESLint手动规则，创建一个文件夹<code class="du mn mo mp kc b">rules</code>，并在<code class="du mn mo mp kc b">rules</code>文件夹中创建一个名为<code class="du mn mo mp kc b">no-color-literals.js</code> <br/> 6的文件。让我们创建另一个文件夹<code class="du mn mo mp kc b">src</code>，它将保存我们需要测试的文件。<br/> 7。在<code class="du mn mo mp kc b">src</code>文件夹下创建一个文件<code class="du mn mo mp kc b">test.js</code>，粘贴以下内容:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="c0bb" class="kg kh hi kc b fi ki kj l kk kl">const pageStyles = {<br/>  textColor: {<br/>    color: '#333'<br/>  }<br/>};<br/>console.log(pageStyles);</span></pre><p id="e85f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">到目前为止，我们的文件夹结构应该是这样的:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mv"><img src="../Images/dde2b0af6f50af46cc0087bb54f474b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQGkJd1Sro2mIGLKn0UiBQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 3: Folder structure</figcaption></figure><p id="dbf8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">8.要运行lint检查，让我们设置脚本。导航到<code class="du mn mo mp kc b">package.json</code>并在脚本下添加<code class="du mn mo mp kc b">"lint":"node_modules/.bin/eslint src --ruledir rules"</code>。<code class="du mn mo mp kc b">package.json</code>应该是这样的:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mw"><img src="../Images/ccf8012429ed8b0d680a0075da0a2edb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CppnzWsb9ZBQxnfS8BL5mA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 4: package.json</figcaption></figure><p id="f49e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><em class="ik">这将使用</em> <code class="du mn mo mp kc b"><em class="ik">no-color-literals</em></code> <em class="ik">规则检查</em> <code class="du mn mo mp kc b"><em class="ik">src</em></code> <em class="ik">文件夹中文件的林挺错误。</em></p><p id="8ce8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">9.在<code class="du mn mo mp kc b">no-color-literals.js</code>文件中，粘贴以下代码:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="2bfb" class="kg kh hi kc b fi ki kj l kk kl">module.exports = {<br/>  create(context){<br/>    return {<br/>     // our logic goes here<br/>      <br/>      Property(node){  <br/>        /* node refers to the Property node from Abstract Syntax        Tree that we saw on ASTExplorer.<br/>        node.key refers to Identifier and node.value refers to Literals<br/>        */</span><span id="2c39" class="kg kh hi kc b fi mb kj l kk kl">        if(!node){ // if node doesn't exist, no need to check<br/>          return;<br/>        }        <br/>       <br/>        if(<br/>          node.key.name == 'color' &amp;&amp;    node.value.value.toString().includes('#')<br/>          ){</span><span id="10bb" class="kg kh hi kc b fi mb kj l kk kl">/* if key is 'color' and value specified includes '#', report the error */<br/>          <br/>            context.report({<br/>              node: node.value,<br/>              data: {<br/>                name: node.value.value<br/>              },<br/>              message: "Unexpected: '{{name}}'. Color literals are not allowed",</span><span id="3b8c" class="kg kh hi kc b fi mb kj l kk kl">           });<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="4123" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">context.report</code>方法接受一个属性很少的对象，并在lint规则失败时报告错误。</p><p id="d724" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">node</code>是发生lint错误的确切节点(位置)。</p><p id="7993" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">data</code>用来传递一些数据。这里，我们有name属性，它保存了<code class="du mn mo mp kc b">color</code>属性的值</p><p id="07d7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">message</code>用于传递一些信息，以便开发者确切地知道应该做什么。</p><p id="6816" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">我们已经成功地创建了配置来检查color属性是否将任何十六进制颜色代码作为颜色文字。我们稍后将修改我们的逻辑以涵盖更多的场景，但是首先，让我们在我们的<code class="du mn mo mp kc b">.eslintrc.js</code>文件中实现这个规则。</p><p id="a973" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">12.现在我们已经创建了我们的定制配置，让我们用ESLint配置文件插入它。在<code class="du mn mo mp kc b">.eslintrc.js</code>文件中，在<code class="du mn mo mp kc b">rules</code>下添加我们的自定义规则为<code class="du mn mo mp kc b">"no-color-literals": "error"</code>，如下图:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mx"><img src="../Images/1012fb86ac27a85d28f88417342a5e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JMWieWxZOB1CRLqmI2OdUQ.jpeg"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 5: .eslintrc.js</figcaption></figure><p id="e45b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">11.测试时间:</p><p id="3c1e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">在根目录中运行命令<code class="du mn mo mp kc b">npm run lint</code>，您应该会在终端中看到错误。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es my"><img src="../Images/704bc0e5022ab0f2ee35253a6c042654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QarKYlhlxzatDItameGrUg.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 6: Trial 1</figcaption></figure><p id="e232" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">到目前为止，我们已经限制了颜色属性的十六进制颜色代码的使用。我们写的逻辑很粗糙，需要提炼。</p><h2 id="56d2" class="kg kh hi bd kn lj lk ll kr lm ln lo kv jy lp lq kz jz lr ls ld ka lt lu lh lv bi translated">步骤3: <br/>修改我们的逻辑，在所有接受颜色(例如:边框、背景、颜色等)的Javascript样式属性中，限制所有颜色文字(十六进制、rgb、hsl、白色、黑色等)的使用</h2><ol class=""><li id="6814" class="me mf hi il b im lw iq lx jy mg jz mh ka mi jg mj mk ml mm bi translated">收集所有样式属性:</li></ol><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="8995" class="kg kh hi kc b fi ki kj l kk kl">const PROPERTIES = ['background', 'backgroundColor', 'border', 'borderColor', 'borderBottom', 'borderBottomColor', 'borderLeft', 'borderLeftColor', 'borderRightColor', 'borderRight', 'borderTop', 'borderTopColor', 'color' ];</span></pre><p id="9a7b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">2.收集所有可能的颜色文字:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="e255" class="kg kh hi kc b fi ki kj l kk kl">const COLORS = ['black', 'silver', 'gray', 'white', 'maroon', 'red', 'purple', 'fuchsia', 'green', 'lime', 'olive', 'aqua', 'teal', 'blue', 'navy', 'yellow', 'orange', 'aliceblue', 'antiquewhite', 'aquamarine', 'azure', 'beige', 'bisque', 'blanchedalmond', 'blueviolet', 'brown', 'burlywood', 'cadetblue', 'chartreuse', 'chocolate', 'coral', 'cornflowerblue', 'cornsilk', 'crimson', 'cyan', 'darkblue', 'darkcyan', 'darkgoldenrod', 'darkgray', 'darkgreen', 'darkgrey', 'darkkhaki', 'darkmagenta', 'darkolivegreen', 'darkorange', 'darkorchid', 'darkred', 'darksalmon', 'darkseagreen', 'darkslateblue', 'darkslategray', 'darkslategrey', 'darkturquoise', 'darkviolet', 'deeppink', 'deepskyblue', 'dimgray', 'dimgrey', 'dodgerblue', 'firebrick', 'floralwhite', 'forestgreen', 'gainsboro', 'ghostwhite', 'gold', 'goldenrod', 'greenyellow', 'grey', 'honeydew', 'hotpink', 'indianred', 'indigo', 'ivory', 'khaki', 'lavender', 'lavenderblush', 'lawngreen', 'lemonchiffon', 'lightblue', 'lightcoral', 'lightcyan', 'lightgoldenrodyellow', 'lightgray', 'lightgreen', 'lightgrey', 'lightpink', 'lightsalmon', 'lightseagreen', 'lightskyblue', 'lightslategray', 'lightslategrey', 'lightsteelblue', 'lightyellow', 'limegreen', 'linen', 'magenta', 'mediumaquamarine', 'mediumblue', 'mediumorchid', 'mediumpurple', 'mediumseagreen', 'mediumslateblue', 'mediumspringgreen', 'mediumturquoise', 'mediumvioletred', 'midnightblue', 'mintcream', 'mistyrose', 'moccasin', 'navajowhite', 'oldlace', 'olivedrab', 'orangered', 'orchid', 'palegoldenrod', 'palegreen', 'paleturquoise', 'palevioletred', 'papayawhip', 'peachpuff', 'peru', 'pink', 'plum', 'powderblue', 'rosybrown', 'royalblue', 'saddlebrown','salmon', 'sandybrown', 'seagreen', 'seashell', 'sienna', 'skyblue', 'slateblue', 'slategray', 'slategrey', 'snow', 'springgreen', 'steelblue', 'tan', 'thistle', 'tomato', 'turquoise', 'violet','wheat', 'whitesmoke', 'yellowgreen', 'rebeccapurple','#', 'rgb', 'rgba', 'hsl', 'hsla'<br/>]</span></pre><p id="fb1b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">3.创建实用程序方法来检查:</p><p id="b38f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">a.如果使用的属性位于属性数组中。</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="557c" class="kg kh hi kc b fi ki kj l kk kl">function checkProperties(propertyName) {<br/>  if (propertyName) {<br/>    return PROPERTIES.some((property) =&gt; property === propertyName);<br/>  }<br/>  return false;<br/>}</span></pre><p id="be22" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">b.如果该值是十六进制代码(包含#)，或者是rgb、rgba、hsl、hsla或任何其他颜色值。</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="4a8a" class="kg kh hi kc b fi ki kj l kk kl">function checkValues(value) {<br/>  if (value) {<br/>    return COLORS.some((colorFormat) =&gt;  value.toString().includes(colorFormat));<br/>  }<br/>  return false;<br/>}</span></pre><p id="5faa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">4.重写我们的逻辑:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="e7d1" class="kg kh hi kc b fi ki kj l kk kl">Property(node) {<br/>  if (!node || !node.key || !node.value) {<br/>    return;<br/>  }</span><span id="7f5b" class="kg kh hi kc b fi mb kj l kk kl">  const colorPropertyMatched = checkProperties(node.key.name);<br/>  const valueHasColorLiterals = checkValues(node.value.value);<br/>  <br/>  if (colorPropertyMatched &amp;&amp; valueHasColorLiterals) {<br/>    context.report({<br/>      node: node.value,<br/>      message: "Unexpected: '{{name}}'. Color literals are not allowed",<br/>      data: {<br/>        name: node.value.value<br/>      }<br/>    });<br/>  }<br/>}</span></pre><p id="7e52" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">colorPropertyMatched</code>:当属性数组中存在样式属性时，它将保存值<code class="du mn mo mp kc b">true</code></p><p id="f249" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">valueHasColorLiterals</code>:当指定给style对象的值是COLORS数组中提到的一种时，它将保存值<code class="du mn mo mp kc b">true</code></p><p id="4c07" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">在<code class="du mn mo mp kc b">colorPropertyMatched</code>和<code class="du mn mo mp kc b">valueHasColorLiterals</code>都为真的情况下，我们有一个属性节点，将key作为Javascript样式属性，其值包含颜色文字。在这种情况下，ESLint会用我们已经添加的消息向我们报告错误。</p><p id="56fd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">到目前为止，<code class="du mn mo mp kc b">no-color-lierals.js</code>文件应该是这样的:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es my"><img src="../Images/26d09c1ad53d9ae60f0b313d2871ca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-q_aJxdgsSV-3BRYPwuWJA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 7: a. no-color-literals.js</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mz"><img src="../Images/d63705537c3cb02a30db8b270619a14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQjVUg8BznT7MFCMb7c_3w.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 8: b. no-color-literals.js</figcaption></figure><p id="6fa7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">让我们修改<code class="du mn mo mp kc b">test.js</code>文件中的样式对象来测试更多的场景:</p><pre class="ji jj jk jl fd kb kc kd ke aw kf bi"><span id="ab13" class="kg kh hi kc b fi ki kj l kk kl">const pageStyles = {<br/>  textColor: {<br/>    color: '#333',<br/>    background:'white',<br/>    borderTop:'1px solid rgb(255, 0, 0)',<br/>    borderBottom:'1px solid hsl(0, 100%, 50%)',<br/>  }<br/>};<br/>console.log(pageStyles);</span></pre><p id="3cc4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">现在运行命令<code class="du mn mo mp kc b">npm run lint</code>来看看<em class="ik">的魔力！</em></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es na"><img src="../Images/7584c1e58a0de14b22b820641958a723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_rMo5s4wolSpGKg2mgqfw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Image 9: Trial 2</figcaption></figure><p id="542e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">瞧！我们已经成功地添加了lint规则来限制Javascript样式属性中的颜色。这将<strong class="il hj">而非</strong>影响您的<code class="du mn mo mp kc b">css</code>或<code class="du mn mo mp kc b">scss</code>文件。</p><h2 id="0e98" class="kg kh hi bd kn lj lk ll kr lm ln lo kv jy lp lq kz jz lr ls ld ka lt lu lh lv bi translated">最后一步(可选)</h2><p id="9e6a" class="pw-post-body-paragraph ii ij hi il b im lw io ip iq lx is it jy ly iw ix jz lz ja jb ka ma je jf jg hb bi translated">要为扩展名为<code class="du mn mo mp kc b">jsx</code>的文件添加这条规则，我们需要在<code class="du mn mo mp kc b">pacakge.json</code>文件中稍微调整一下我们的<code class="du mn mo mp kc b">lint</code>脚本。</p><p id="5f6b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><code class="du mn mo mp kc b">"lint": "node_modules/.bin/eslint src --rulesdir rules --ext js,jsx"</code></p><p id="b080" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated">现在我们可以添加一个具有内联样式的虚拟React组件，并测试lint规则。</p><p id="fa95" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jy iv iw ix jz iz ja jb ka jd je jf jg hb bi translated"><a class="ae jx" rel="noopener" href="/@ndm0501/how-to-create-a-custom-eslint-configuration-and-shareable-plugin-part-2-22d4b03d218">如何创建自定义ESLint配置和可共享插件？第二部分</a></p></div></div>    
</body>
</html>
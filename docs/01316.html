<html>
<head>
<title>Reading and Writing JSON in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript读写JSON</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/reading-and-writing-json-in-javascript-56ce6c3ab1e3?source=collection_archive---------23-----------------------#2021-04-05">https://medium.com/geekculture/reading-and-writing-json-in-javascript-56ce6c3ab1e3?source=collection_archive---------23-----------------------#2021-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4b03" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">2021年4月5日</h2></div><p id="5ee2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作者托马斯</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/45a8b511a0c04ef50dbc0fc9a493c494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Ff6lwebSt9XgFlxVuhraw.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx">Photo by <a class="ae kj" href="https://unsplash.com/@pankajpatel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae kj" href="https://unsplash.com/s/photos/json?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4e16" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">文件IO似乎是一个主题，我通常最终会搜索以找到正确的答案。这是我最后一次遇到一个方便的方法，我告诉自己，我会为这个话题做出贡献，而不是仅仅消耗它。我最近需要读写JSON文件，这是我最终喜欢的编码。因为这是处理这个操作的一种更干净的方式，所以我想跟踪它。下面是一个用Javascript将对象写成JSON文件的示例脚本。</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="7aa6" class="kp kq hi kl b fi kr ks l kt ku">const fs = require('fs');<br/>const path = require('path');<br/><br/>const testObject = {<br/>  hello: 'world',<br/>  myArray: [<br/>    'entry1',<br/>    'entry2',<br/>    'entry3',<br/>  ],<br/>  myNestedObject: {<br/>    nestedHello: 'nestedWorld',<br/>  },<br/>};<br/><br/>const testJsonString = JSON.stringify(testObject, null, 2);<br/><br/>const filePath = path.join(process.cwd(), 'test.json');<br/><br/>fs.writeFile(filePath, testJsonString, (err) =&gt; {<br/>  if (err) {<br/>    console.error(err);<br/>  } else {<br/>    console.log('File written successfully');<br/>  }<br/>});</span></pre><p id="0dbd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您不在乎输出是否美观，可以将<code class="du kv kw kx kl b">JSON.stringify(testObject, null, 2)</code>部分简化为<code class="du kv kw kx kl b">JSON.stringify(testObject)</code>。下面是一个将JSON读入对象的示例脚本。</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="1320" class="kp kq hi kl b fi kr ks l kt ku">const fs = require('fs');<br/>const path = require('path');<br/><br/>const filePath = path.join(process.cwd(), 'test.json');<br/><br/>fs.readFile(filePath, 'utf8', (err, contents) =&gt; {<br/>  if (err) {<br/>    console.error(err);<br/>    return;<br/>  }<br/><br/>  try {<br/>    const jsonString = JSON.parse(contents);<br/>    console.log(jsonString);<br/>  } catch (jsonError) {<br/>    console.error('Error parsing JSON');<br/>  }<br/>});</span></pre><p id="5081" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">JSON在这个脚本中被解析和打印，如果您在读文件的脚本之前运行写文件的脚本，那么您将看到一个对象，其内容与读脚本中打印的写脚本的内容相同。注意传递到<code class="du kv kw kx kl b">readFile</code>调用中的<code class="du kv kw kx kl b">'utf8'</code>参数。这个参数不是必需的，但是我想在这里包含它，只是为了指出文件可以用不同的方式编码。这就是我们如何告诉Node预期的编码类型。如果需要，可以将类似的参数传入<code class="du kv kw kx kl b">writeFile</code>。</p><h1 id="7abc" class="ky kq hi bd kz la lb lc ld le lf lg lh io li ip lj ir lk is ll iu lm iv ln lo bi translated">同步文件IO</h1><p id="7704" class="pw-post-body-paragraph ix iy hi iz b ja lp ij jc jd lq im jf jg lr ji jj jk ls jm jn jo lt jq jr js hb bi translated">在Node中同步读写文件，需要使用<code class="du kv kw kx kl b">writeFileSync</code>和<code class="du kv kw kx kl b">readFileSync</code>。这些函数的<code class="du kv kw kx kl b">*Sync</code>版本不是提供回调，而是仅在完成时返回。这会影响性能，因为文件IO不一定便宜。以下是同步写入版本中的示例脚本。</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="17bd" class="kp kq hi kl b fi kr ks l kt ku">const fs = require('fs');<br/>const path = require('path');<br/><br/>const testObject = {<br/>  hello: 'world',<br/>  myArray: [<br/>    'entry1',<br/>    'entry2',<br/>    'entry3',<br/>  ],<br/>  myNestedObject: {<br/>    nestedHello: 'nestedWorld',<br/>  },<br/>};<br/><br/>const testJsonString = JSON.stringify(testObject, null, 2);<br/><br/>const filePath = path.join(process.cwd(), 'test.json');<br/><br/>try {<br/>  fs.writeFileSync(filePath, testJsonString);<br/>} catch (err) {<br/>  console.error(err);<br/>}</span></pre><p id="711e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是同步读取版本中的示例脚本。</p><pre class="ju jv jw jx fd kk kl km kn aw ko bi"><span id="62f9" class="kp kq hi kl b fi kr ks l kt ku">const fs = require('fs');<br/>const path = require('path');<br/><br/>const filePath = path.join(process.cwd(), 'test.json');<br/><br/>try {<br/>  const contents = fs.readFileSync(filePath, 'utf8');<br/>  const jsonString = JSON.parse(contents);<br/>  console.log(jsonString);<br/>} catch (err) {<br/>  console.error(err);<br/>}</span></pre></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><p id="5ac6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mb">原载于2021年4月5日</em><a class="ae kj" href="https://thomasstep.dev/blog/reading-and-writing-json-in-javascript" rel="noopener ugc nofollow" target="_blank"><em class="mb">https://thomasstep . dev</em></a><em class="mb">。</em></p></div></div>    
</body>
</html>
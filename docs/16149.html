<html>
<head>
<title>Angular:Making Conditionally Binding Multiple Properties to the ngModel possible</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:使得有条件地将多个属性绑定到ngModel成为可能</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/angular-making-conditionally-binding-multiple-properties-to-the-ngmodel-possible-27b6e00dba32?source=collection_archive---------6-----------------------#2022-12-13">https://medium.com/geekculture/angular-making-conditionally-binding-multiple-properties-to-the-ngmodel-possible-27b6e00dba32?source=collection_archive---------6-----------------------#2022-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9f8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您想要重用一个html元素时，您是否遇到过这种情况，您觉得这个元素重复了多次，但是要绑定到该元素的<strong class="ih hj"> ngModel </strong>的<strong class="ih hj">属性</strong>在不同的地方是不同的？</p><p id="136c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我试图用<strong class="ih hj">三元运算符</strong>来解决这个问题，但结果出乎意料。</p><p id="5439" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我用这个简单的例子向您展示问题和解决方案。</p><p id="32ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你有一个水果和颜色的列表显示在一个下拉列表中。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="871b" class="jm jn hi ji b be jo jp l jq jr">colors = [‘Violet’, ‘Indigo’, ‘Blue’, ‘Green’];<br/>fruits = [‘Apple’, ‘Mango’, ‘Orange’, ‘Banana’];</span></pre><p id="76d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您分别使用2个属性/模型<strong class="ih hj">水果选择</strong>和<strong class="ih hj">颜色选择</strong>来跟踪选择的水果和颜色。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="914d" class="jm jn hi ji b be jo jp l jq jr">fruitSelected: string = ‘’;<br/>colorSelected: string = ‘’;</span></pre><p id="aab5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在模板中，为了在两个场景中重用下拉菜单，您已经将<select>添加到一个引用<strong class="ih hj">下拉菜单</strong>的<strong class="ih hj"> &lt; ng模板&gt; </strong>中。</select></p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="1801" class="jm jn hi ji b be jo jp l jq jr">&lt;ng-template #dropdown let-list="list" let-type="type"&gt;<br/>  <br/>&lt;label&gt;{{ type === 'fruit' ? 'Fruits' : 'Colours' }}:&lt;/label&gt;<br/>  <br/>&lt;select<br/>    [(ngModel)]="type === 'fruit' ? fruitSelected : colorSelected"<br/>    (change)="change($event)"<br/>  &gt;<br/>    &lt;option value=""&gt;&lt;/option&gt;<br/>    &lt;option *ngFor="let item of list" [value]="item"&gt;{{ item }}&lt;/option&gt;<br/>  &lt;/select&gt;<br/><br/>  &lt;p&gt;Model Value: {{ type === 'fruit' ? fruitSelected : colorSelected }}&lt;/p&gt;<br/><br/>&lt;/ng-template&gt;</span></pre><p id="8714" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">水果</strong>和<strong class="ih hj">颜色</strong>数组属性将被传递给变量<strong class="ih hj">列表</strong>。</p><p id="16f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量<strong class="ih hj">类型</strong>将包含一个字符串<strong class="ih hj">“水果”或【颜色】</strong>来标识下拉菜单是显示<strong class="ih hj">水果</strong>还是<strong class="ih hj">颜色</strong>。</p><p id="9533" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，在变量类型包含“水果”的情况下，属性<strong class="ih hj"> fruitSelected </strong>已被赋值给[(ngModel)]。Else属性<strong class="ih hj"> colorSelected </strong>被赋值给[(ngModel)]。</p><p id="6a45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还向<select>元素添加了一个变更事件。事件处理程序change()将记录<select>元素值的变化。</select></select></p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="7565" class="jm jn hi ji b be jo jp l jq jr"> change(evt) {<br/>    console.log('Change event triggered');<br/>    console.log('Value of Element:', evt.target.value);<br/><br/>    console.log('fruitSelected property during change event:', this.fruitSelected);<br/>    console.log('colorSelected property during change event:', this.colorSelected);<br/>  <br/>  }</span></pre><p id="9aaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还打印属性<strong class="ih hj"> fruitSelected </strong>或<strong class="ih hj"> colorSelected的值的任何变化。</strong></p><p id="88cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们使用<strong class="ih hj"> ngTemplateOutlet </strong>和<strong class="ih hj">ngTemplateOutletContext</strong>来显示颜色和水果的列表。</p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="fdfb" class="jm jn hi ji b be jo jp l jq jr">&lt;ng-container [ngTemplateOutlet]=”dropdown” <br/>[ngTemplateOutletContext]=”{ list: colors,type: ‘color’}”&gt;&lt;/ng-container&gt;<br/><br/>&lt;ng-container [ngTemplateOutlet]=”dropdown” [ngTemplateOutletContext]=”{<br/>list: fruits,type: ‘fruit’}”&gt;&lt;/ng-container&gt;</span></pre><p id="c856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初，应用程序如下所示，因为属性<strong class="ih hj"> fruitSelected </strong>和<strong class="ih hj"> colorSelected </strong>都被初始化为空字符串。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es js"><img src="../Images/e706cb1b8c4c46a4ec17837c80216aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0bD_1TMB8HEKz8oH2sc0yQ.png"/></div></div></figure><p id="d234" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我把颜色改成“靛蓝”。属性<strong class="ih hj"> colorSelected </strong>已从空字符串更新为“Indigo”。</p><p id="f7c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以在控制台中看到，<strong class="ih hj"> change事件已经触发了</strong>，并且&lt; select &gt;元素的值以及属性<strong class="ih hj"> colorSelected </strong>的更新值已经被记录。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ka"><img src="../Images/0d47437d76ac869fe3908497f93fbd54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BElG_FU7RV4VhHoEb5B4cg.png"/></div></div></figure><p id="e989" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">清空控制台。现在让我们把水果换成“香蕉”。</p><p id="2e0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">属性<strong class="ih hj"> fruitSelected </strong>在模板和控制台中都没有更新。它仍然是一个空字符串。但是请注意，<strong class="ih hj">变化事件</strong>已经触发，并且“香蕉”已经被记录为控制台中&lt;选择&gt;T5】元素的<strong class="ih hj">值。</strong></p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es kb"><img src="../Images/d61ff0cba82f253c4605b22a7407c7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhZklPJNM2OfooaqAQz-oA.png"/></div></div></figure><p id="1d5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们由此推断出什么？&lt;选择&gt;标签的<strong class="ih hj">值已更改为“Banana ”,但此更改尚未在<strong class="ih hj">结果选择</strong>属性中更新，即模型尚未更新。</strong></p><p id="15f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这意味着使用三元运算符方法时，<strong class="ih hj">双向数据绑定不能像预期的那样工作。</strong></p><p id="f7cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何让这个工作？</p><p id="394c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将如下所示更新<select>元素。</select></p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="1ad3" class="jm jn hi ji b be jo jp l jq jr">&lt;select<br/>[ngModel]=”type === ‘fruit’ ? fruitSelected : colorSelected”<br/>(ngModelChange)=”updateModel($event, type)”<br/>(change)=”change($event)”<br/>&gt;</span></pre><p id="123f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> [(ngModel)] </strong>已更改为<strong class="ih hj">【ng model】</strong>，即<strong class="ih hj">简单属性绑定。</strong></p><p id="b3f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> (ngModelChange) </strong>事件已添加到&lt;选择&gt;元素中。</p><p id="580d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事件处理程序<strong class="ih hj"> updateModel() </strong>将属性<strong class="ih hj"> fruitSelected </strong>和<strong class="ih hj"> colorSelected </strong>的值更新为&lt; select &gt;元素的<strong class="ih hj">值。<strong class="ih hj"> updateHandler() </strong>将&lt; select &gt;元素的值和类型变量作为参数。</strong></p><pre class="jd je jf jg fd jh ji jj bn jk jl bi"><span id="fa9f" class="jm jn hi ji b be jo jp l jq jr">updateModel(value, type) {<br/>   console.log('fruitSelected property value Before:', this.fruitSelected);<br/>   console.log('colorSelected property value Before:', this.colorSelected);<br/>   console.log('ngModelChange event triggered');<br/>   type === 'fruit' ? this.fruitSelected = value:this.colorSelected = value;<br/>  }</span></pre><p id="2b9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们继续之前，我们需要了解<strong class="ih hj"> (ngModelChange) </strong>和<strong class="ih hj"> (change) </strong>事件之间的区别。</p><ol class=""><li id="e141" class="kc kd hi ih b ii ij im in iq ke iu kf iy kg jc kh ki kj kk bi translated">每次<select>元素值改变时，触发(ngModelChange)事件。<strong class="ih hj"> </strong>在ngModel 即<strong class="ih hj"> fruitSelected </strong>或<strong class="ih hj"> colorSelected </strong>绑定的属性的<strong class="ih hj">值发生变化之前触发。在这个阶段，您可以对模型的值进行更改。</strong></select></li><li id="4019" class="kc kd hi ih b ii kl im km iq kn iu ko iy kp jc kh ki kj kk bi translated">仅当<strong class="ih hj"> &lt;选择&gt;元素模糊</strong>且绑定到ngModel 的属性的<strong class="ih hj">值(即<strong class="ih hj">结果选择</strong>或<strong class="ih hj">颜色选择</strong>发生变化)后，才会触发(change)事件。在这个阶段，您可以使用模型的更新值来执行一些操作。</strong></li></ol><p id="4937" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们现在重试我们的实验。</p><ol class=""><li id="a147" class="kc kd hi ih b ii ij im in iq ke iu kf iy kg jc kh ki kj kk bi translated">将颜色的值更改为“绿色”。型号<strong class="ih hj">颜色选择</strong>已更新为“绿色”。</li></ol><figure class="jd je jf jg fd jt er es paragraph-image"><div class="er es kq"><img src="../Images/0f6b7175795db11d79688a1ab2f53cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*-2g-ipLMUzet4bDndvwRAA.png"/></div></figure><p id="f288" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们从控制台做出以下推论。</p><p id="47aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在(ngModelChange)事件处理程序<strong class="ih hj"> updateModel() </strong>中，模型<strong class="ih hj"> fruitSelected </strong>和<strong class="ih hj"> colorSelected </strong>的初始值是一个<strong class="ih hj">空字符串，即它们没有更新。</strong>这些模型的值被<strong class="ih hj">手动更新为方法内&lt; select &gt;元素的值。</strong></p><p id="90a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj"> (change) </strong>事件处理程序<strong class="ih hj"> change() </strong>内部，模型的值已经有了它们的更新值。</p><p id="f3d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.清空控制台。将水果的值改为“橙色”。您可以观察到模板和控制台中的模型<strong class="ih hj"> fruitSelected </strong>已经更新为“橙色”。</p><figure class="jd je jf jg fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es kr"><img src="../Images/23bd74ebe130c49e50f552ce8fe89b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5zdYcXB5t3uAkEZ1Nlrcg.png"/></div></div></figure><p id="c03c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当<strong class="ih hj"> (ngModelChange) </strong>事件处理程序<strong class="ih hj"> updateModel() </strong>被触发时，可以看到<strong class="ih hj"> fruitSelected </strong>的值仍然是一个空字符串。之后，它以同样的方法更新为&lt;选择&gt;元素的值，即“橙色”。</p><p id="2ebf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在您可以轻松地将多个属性有条件地绑定到<strong class="ih hj"> ngModel </strong>上。</p><p id="e7ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以查看下面的完整工作示例。</p><div class="ks kt ez fb ku kv"><a href="https://stackblitz.com/edit/angular-3sphpr?file=src/app/app.component.html" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hj fi z dy la ea eb lb ed ef hh bi translated">角形(叉形)堆叠</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">一个基于rxjs，tslib，core-js，zone.js，@angular/core，@angular/forms，@angular/common的angular-cli项目…</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">stackblitz.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj jy kv"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Monitor Docker Containers on Linux Server With Zabbix-agent2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Zabbix-agent2监控Linux服务器上的Docker容器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/monitor-docker-containers-on-linux-server-with-zabbix-agent2-2a4e7708dbb7?source=collection_archive---------3-----------------------#2021-03-13">https://medium.com/geekculture/monitor-docker-containers-on-linux-server-with-zabbix-agent2-2a4e7708dbb7?source=collection_archive---------3-----------------------#2021-03-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="d115" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="0231" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在这篇博文中，我想展示如何通过监控软件Zabbix来监控docker容器。</p><p id="bdeb" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Zabbix会发现可用的容器，因此新的容器会自动添加到监控中。</p><h1 id="46b4" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">先决条件</h1><p id="c63a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">需要Zabbix-agent的版本2 。如果不知道如何安装，可以看看<a class="ae kg" href="https://caelis.medium.com/how-to-install-zabbix-agent2-on-linux-c603023207d2" rel="noopener">我上一篇博文</a>。</p><h1 id="1b4a" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">将docker组添加到Zabbix用户</h1><p id="ac88" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">zabbix代理在名为“Zabbix”的用户下运行。默认情况下,“zabbix”不允许执行docker命令。但是有必要检查单个码头集装箱的健康状况。</p><p id="5d19" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">要解决这个问题，您必须将组“docker”添加到用户“zabbix”中。在linux中，您可以使用以下命令来实现:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1a99" class="kq ig hi km b fi kr ks l kt ku">usermod -a -G docker zabbix</span></pre><h1 id="2bef" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">重新启动zabbix代理</h1><p id="5fe5" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">接下来，您必须重启zabbix代理，以便应用新的组权限:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b326" class="kq ig hi km b fi kr ks l kt ku">systemctl restart zabbix-agent2</span></pre><h1 id="50ab" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">将docker模板添加到主机</h1><p id="0aa8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在Zabbix UI中，您现在必须配置主机并将“模板应用Docker”添加到活动模板中。</p><p id="10b3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">导航到主机:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es kv"><img src="../Images/6d49a71f5e881d7201eedd8a19ada00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*paaoUejzlO44F7ZDBtnL9Q.png"/></div></figure><p id="af58" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">选择主机:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es kz"><img src="../Images/f13900f914d9d4add04765da13ba31a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*nfBCVaw2bk16LQXSuPtWzA.png"/></div></figure><p id="9b29" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">转到“模板”选项卡，点击选择:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es la"><img src="../Images/ec6d0a54cb65f3138147269330a1752a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Wyr88GnxLI1W4Mr3TXF9Q.png"/></div></div></figure><p id="3fca" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">单击选择:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es lf"><img src="../Images/f3237dbb3bf832f2a047625274efa7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*N2QtyItXJo_5OYr38Ns79A.png"/></div></figure><p id="b430" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">选择模板:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es lf"><img src="../Images/7dd68873cb60d5c0b1ce654139ff91d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*-kpV4iq1jd5dE3Kb1lOXEw.png"/></div></figure><p id="9eba" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">勾选“模板应用Docker”并点击“选择”:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es lf"><img src="../Images/118bcf91ffe75346b6e875c749522627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*x6vB7g3boHWAe0sLEbVB6g.png"/></div></figure><p id="f6ee" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">现在点击“更新”:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es lg"><img src="../Images/929e29e3159908b7ff80af13808b8bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*AOM7-dBnnkXhg-UdRx6UAA.png"/></div></figure><p id="33ae" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">几分钟后，您应该会在最新的数据视图中看到docker项目:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lh"><img src="../Images/9d68fcaf9c0463c7da9bcca2f22b9766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYzJKNwi4PTP464ee6XB3g.png"/></div></div></figure><p id="a6b8" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">每个正在运行的docker容器也有一个部分:</p><figure class="kh ki kj kk fd kw er es paragraph-image"><div class="er es li"><img src="../Images/79353ea996649804b6aa026ca811640b.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*zSolAHQ865HFe2CxAr2x-Q.png"/></div></figure><figure class="kh ki kj kk fd kw er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lj"><img src="../Images/ecc89770a850cdc4d27314e402f5c27e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QI295_YEl0VXGycO"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Photo by <a class="ae kg" href="https://unsplash.com/@lukechesser?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Luke Chesser</a> on <a class="ae kg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div>    
</body>
</html>
<html>
<head>
<title>Node JS Environment Variables — Setting Node app for multiple environments.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node JS环境变量—为多个环境设置Node app。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/node-js-environment-variables-setting-node-app-for-multiple-environments-51351b51c7cd?source=collection_archive---------0-----------------------#2021-08-22">https://medium.com/geekculture/node-js-environment-variables-setting-node-app-for-multiple-environments-51351b51c7cd?source=collection_archive---------0-----------------------#2021-08-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/de1892efcb9b8f6fe9cdcdc28b14b906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R71X-lNbM_ninpiw_KYiIQ.jpeg"/></div></div></figure><p id="bac5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">环境变量是Nodejs最重要的核心概念之一，因为它们允许我们为多个环境配置应用程序，并允许应用程序在每个环境(如开发、测试、试运行、生产)中表现不同。它通常用于配置我们的应用程序应该连接到不同环境模式的端口、数据库连接、主机，或者可以用于您认为应该根据您运行应用程序的环境模式而更改的代码的任何部分。将环境变量配置到一个单独的文件中，而不是在我们的node js代码中，这使我们能够运行应用程序并将其指向不同的环境，而无需重新构建或更改代码。</p><p id="5cbe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个博客中，我们将看到如何设置自定义。使用<strong class="is hj"> dotenv </strong>库的不同环境的节点应用程序的env文件</p><h1 id="ea7b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">入门指南</h1><p id="676c" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">让我们先从创建一个节点应用程序开始</p><h1 id="2715" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">设置我们的节点应用程序⚙</h1><p id="527e" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">要创建一个节点应用程序，用<strong class="is hj"> npm init </strong>命令创建package.json文件</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="c0df" class="la jp hi kw b fi lb lc l ld le">npm init</span></pre><p id="d3ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用Express包安装Express.js</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="dfe1" class="la jp hi kw b fi lb lc l ld le">npm express --save</span></pre><h1 id="2db2" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">使用dotenv包为多种环境设置我们的节点应用程序</h1><p id="1a48" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">让我们首先使用下面的命令在我们的应用程序中安装dotenv包</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="810f" class="la jp hi kw b fi lb lc l ld le">npm i dotenv --save</span></pre><p id="3e1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lf">现在我们已经完成了应用程序所需的所有库的安装，让我们继续创建节点应用程序，并使用dotenv库为多种环境配置应用程序。</em> </strong></p><p id="618c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">多环境节点app设置步骤:</strong></p><p id="e3c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1️⃣创造了两个。<strong class="is hj"> env </strong>文件<strong class="is hj"> development.env </strong>和<strong class="is hj"> production.env </strong></p><p id="fa57" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2️⃣创建一个<strong class="is hj"> config </strong>文件来从<strong class="is hj">读取</strong>和<strong class="is hj">设置</strong>环境。我们在第一步中创建的env文件</p><p id="c6f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3️⃣创建一个<strong class="is hj"> server.js </strong>文件作为我们的nodeapp的启动文件</p><p id="03cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4️⃣在<strong class="is hj"> package.json </strong>中为多个环境设置<strong class="is hj"> npm run </strong> <strong class="is hj">脚本</strong>。</p><h1 id="ff2b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">🔸创造。环境文件</strong></h1><p id="897a" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">让我们创建两个新文件<strong class="is hj"> development.env </strong>和<strong class="is hj"> production.env </strong>，每个环境一个，其中将包含NODE_ENV变量、我们希望应用程序运行的主机和端口:</p><p id="6190" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> development.env </strong></p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="f103" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> production.env </strong></p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h1 id="bc4f" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">🔸创建配置文件</h1><p id="543f" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">配置文件将使用<strong class="is hj"> dotenv </strong>库，这将允许我们加载所需的。env文件通过<strong class="is hj"> config() </strong>方法和<strong class="is hj"> path </strong>对象实现。读取文件后，我们将变量的值设置为。env文件并导出它们，以便在<strong class="is hj"> server.js </strong>文件中进一步使用它们</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h1 id="36e5" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">🔸创建一个<strong class="ak"> server.js </strong>文件</h1><p id="7e5b" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">既然我们有不同的。env和config准备就绪，我们现在将在<strong class="is hj"> server.js </strong>文件中创建我们的应用程序的起点，server.js文件将导入config.js文件并基于此配置运行我们的应用程序。</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><h1 id="3c44" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">🔸设置npm运行命令:</strong></h1><p id="5c26" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们将修改<strong class="is hj"> package.json </strong>文件以添加两个新任务，对于每个环境，我们将设置我们希望我们的应用程序运行的NODE_ENV，并为我们的应用程序指定启动文件，即server.js</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="lg lh l"/></div></figure><p id="83c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们以两种不同的模式(开发和生产)运行我们的应用程序，看看我们的应用程序如何选择我们为这些模式设置的配置。</p><p id="236e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要在开发模式下运行应用程序，请使用以下命令:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="9226" class="la jp hi kw b fi lb lc l ld le">npm run dev</span></pre><p id="23e3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lf">这里发生了什么？:</em> </strong> <em class="lf">当我们运行</em> <strong class="is hj"> npm命令运行dev </strong> <em class="lf">，</em> <strong class="is hj"> NODE_ENV </strong> <em class="lf">被设置为</em><strong class="is hj">development</strong><em class="lf">from</em><strong class="is hj"><em class="lf"/>package。json </strong> <em class="lf">脚本段，在config.js文件中，</em><strong class="is hj">dotenv . config</strong><em class="lf">函数读取</em><strong class="is hj">development . env</strong><em class="lf">文件并设置</em> <strong class="is hj">环境变量</strong> <em class="lf">如</em><strong class="is hj">development . env</strong><em class="lf">文件、</em> <strong class="is hj"> server.js </strong> <em class="lf">文件中所指定的这些设置值</em></p><p id="fefa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您将看到我们的应用程序选择了我们在<strong class="is hj"> development.env </strong>文件中设置的配置，即<strong class="is hj"> PORT : 3000 </strong>和<strong class="is hj"> HOST : localhost </strong></p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es li"><img src="../Images/bcc5da655e1e00a98d53a51473384fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*PLvmG6b821zO4pJNLSXb6g.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx">app running in development mode</figcaption></figure><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/4591d4cde800f9dc1ab64142f14ba705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*l_jz7Elvh13dMED3hywQiA.png"/></div></figure><p id="57ab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要在生产模式下运行应用程序，请运行命令</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="984d" class="la jp hi kw b fi lb lc l ld le">npm run prod</span></pre><p id="a581" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您将看到我们的应用程序选择了我们在<strong class="is hj"> production.env </strong>文件中设置的配置，即<strong class="is hj">端口:8000 </strong>和<strong class="is hj">主机:127.0.0.1 </strong></p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/eaf9a869d3d03e29b7a553a9d5f7d5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*jTshu_o2v7SmCY0E7KnePg.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx">app running in production mode</figcaption></figure><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/044041ee082d329625574c14e004bb7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ay2z_OZ6jgPCB02UrRODlA.png"/></div></div></figure><h1 id="2166" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="bfbd" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">为我们的节点应用程序配置不同的环境模式使我们能够为每种模式指定不同的配置，并允许我们运行我们的应用程序，而无需重新构建我们的应用程序或更改我们的代码。</p><p id="6be8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在这里访问该项目:<a class="ae lq" href="https://github.com/RaheelShaikh/node_env.git" rel="noopener ugc nofollow" target="_blank">https://github.com/RaheelShaikh/node_env.git</a></p><p id="bd18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lf">如果你觉得这篇文章很有帮助，请鼓掌👏并与您的朋友分享🤘</em> </strong></p></div></div>    
</body>
</html>
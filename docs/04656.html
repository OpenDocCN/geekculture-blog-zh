<html>
<head>
<title>RBAC to Manage Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RBAC将管理Kubernetes</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/rbac-to-manage-kubernetes-5417d6658329?source=collection_archive---------66-----------------------#2021-06-30">https://medium.com/geekculture/rbac-to-manage-kubernetes-5417d6658329?source=collection_archive---------66-----------------------#2021-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">撰写人—<a class="ae jd" href="https://www.linkedin.com/in/ran-dvir-86b808121/" rel="noopener ugc nofollow" target="_blank">Ran Dvir</a>devo PS Engineer @<a class="ae jd" href="http://www.cloudride.co.il/" rel="noopener ugc nofollow" target="_blank">Cloudride</a></p><p id="08cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RBAC是基于角色的访问控制的缩写。您可以使用这种方法将用户和应用程序限制在系统或网络的特定区域。使用基于角色的访问控制时，可以根据用户的角色来限制对重要资源的访问。</p><p id="91fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于角色的访问控制(RBAC)对网络资源的访问控制由组织内各个用户的角色决定。例如，单个用户的访问权限是指他或她执行指定任务的能力，如创建、读取或编辑文件。</p><p id="56bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这种方法，IT管理员可以创建更细粒度的安全控制，但他们必须遵循特定的流程，以免无意中创建一个麻烦的系统。</p><p id="d55d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了正确实施Kubernetes RBAC项目，建议采用以下方法:</p><ul class=""><li id="778a" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">实施最小特权原则:默认情况下，RBAC禁用所有访问。管理员在更精细的级别上确定用户权限。确保您仅将必需品授予用户；授予额外的权限会带来安全风险并增加攻击面。</li><li id="2d0a" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">不断调整您的RBAC战略:RBAC规则和角色不是自治的——IT团队不能简单地将RBAC政策置之不理。以缓慢的速度验证RBAC是最好的方法。如果不能达到满意的状态，分阶段实施RBAC。</li><li id="264d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">创建更少的角色并重用现有的角色。不应该通过定制Kubernetes角色来满足<a class="ae jd" href="https://technologyadvice.com/blog/information-technology/role-based-access-vs-user-based-access/#:~:text=Users%20are%20still%20given%20a,%2Dusers%2C%20users%2C%20etc." rel="noopener ugc nofollow" target="_blank">个人用户的需求</a>，从而破坏RBAC权限的目的。在RBAC，角色而不是用户被用作决定因素。相同的权限应该分配给用户组，角色应该是可重用的。它简化了现有角色的角色分配，提高了角色分配流程的效率。</li></ul><h1 id="bd0f" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">RBAC的认证和授权</h1><h1 id="39e1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">证明</h1><figure class="kr ks kt ku fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kq"><img src="../Images/4a6a4c239a6d3fab0d2be793fbeb08f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cxSgjkkmn0NgSiJH"/></div></div></figure><p id="ca11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建立TLS连接后，将进行身份验证。这是第一步。接下来，API服务器被集群创建脚本或集群管理员配置为运行一个或多个认证器模块。密码、普通令牌和客户端证书都包含在身份验证模块中。</p><h1 id="40a2" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">Kubernetes的用户</h1><p id="471b" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">Kubernetes集群中的用户通常分为两类:Kubernetes管理的服务帐户和普通用户。</p><h1 id="7f78" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">批准</h1><p id="39f5" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">在验证请求来自选定的用户之后，应该对请求进行授权。该请求必须指明用户名、请求的操作以及受请求影响的对象。如果策略授权用户执行所请求的操作，则请求被批准。</p><h1 id="1f7b" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">准入控制</h1><p id="5495" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">用于修改或拒绝接纳请求的模块被称为接纳控制模块。除了授权模块可用的所有属性之外，准入控制器模块还可以访问正在创建或修改的对象的内容。与认证和授权模块不同，准入控制器模块会立即拒绝请求。</p><h1 id="86f0" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">在RBAC的角色</h1><p id="cf21" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">您在Kubernetes RBAC的角色决定了您将访问、管理和更改哪些资源。Kubernetes RBAC模型由三个主要组件组成:主题、角色和角色绑定:</p><h1 id="c9d2" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">角色和集群角色</h1><p id="b386" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">这组权限定义了如何访问权限。角色管理命名空间级别的权限，而集群角色管理集群级别或集群内所有命名空间的权限。</p><h1 id="f07a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">RoleBinding和ClusterRoleBinding。</h1><p id="80cc" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">主题根据它们的组和服务帐户列出，并概述了它们的相关角色。有三种类型的角色绑定:roles、ClusterRoles和ClusterRoleBindings。RoleBindings绑定角色；ClusterRoles <a class="ae jd" href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/#:~:text=ClusterRoles%20have%20several%20uses.,be%20granted%20across%20all%20namespaces" rel="noopener ugc nofollow" target="_blank">管理命名空间资源上的权限</a>，ClusterRoleBindings将ClusterRoles绑定到命名空间。</p><h1 id="c396" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">学科</h1><p id="f8ba" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">传统上，RBAC规则中的主体是用户、组或服务帐户。</p><h1 id="22e0" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">聚集的集群角色</h1><p id="9cf0" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">组合几个集群角色是可能的。具有聚集规则的ClusterRole对象由在集群控制平面内运行的控制器监控。该对象的rules字段提供了一个标签选择器，控制器可以使用它来组合其他ClusterRole对象。</p><h1 id="e8b1" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">提及主题</h1><p id="4bde" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">主题和角色由RoleBindings或ClusterRoleBindings绑定。组、用户和服务帐户都是有效的主题。</p><p id="a0cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Kubernetes中的用户名表示为字符串。它可以是诸如“Ruth”的普通名称，诸如“kelly@example.com”的电子邮件名称；或者代表用户ID的一串数字。作为一名集群管理员，您可以配置身份验证模块以生成所需格式的用户名。</p><h1 id="7db5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">角色绑定和默认角色</h1><p id="5145" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">默认情况下，API服务器通常会创建<a class="ae jd" rel="noopener" href="/avmconsulting-blog/rbac-service-type-in-kubernetes-eadf754af42f">集群角色绑定和集群角色对象</a>。控制平面直接管理许多这样的资源，因为它们是以system:为前缀的。</p><h1 id="8476" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">自动对账</h1><p id="0c29" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">每次API服务器启动时，缺少的权限和缺少的主题都会添加到默认的集群角色中。随着Kubernetes版本中主题和权限的改变，它允许集群修复意外的修改。</p><p id="3964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，RBAC授权人启用自动对帐。默认群集角色或角色绑定可以设置为false，从而阻止内部协调。重要的是要记住，当缺少主题和默认权限时，集群可能会变得不可用。</p><h1 id="1f06" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">最后</h1><p id="a66c" class="pw-post-body-paragraph if ig hi ih b ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc hb bi translated">Kubernetes在组织间的实施达到了历史最高水平。它是任务关键型的，需要严格的安全性和合规性规则和措施。通过根据用户在组织中的角色定义允许每个用户执行的操作类型，可以确保正确管理集群。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><p id="fbbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lo">最初发表于</em><a class="ae jd" href="http://www.cloudride.co.il" rel="noopener ugc nofollow" target="_blank"><em class="lo">【https://www.cloudride.co.il】</em></a><em class="lo">。</em></p></div></div>    
</body>
</html>
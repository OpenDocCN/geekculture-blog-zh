<html>
<head>
<title>Create bot for your Discord Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为你的不和谐服务器创建机器人</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-bot-for-your-discord-server-59989b39f6fa?source=collection_archive---------35-----------------------#2021-05-26">https://medium.com/geekculture/create-bot-for-your-discord-server-59989b39f6fa?source=collection_archive---------35-----------------------#2021-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8665" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们将为你的discord服务器创建一个可以执行各种命令的机器人。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/15ea1d968e2ef3f778aff18b7ee27d63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0q4YrfG8DKU4Dbuj.png"/></div></div></figure><h2 id="c1dd" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">本教程我们需要的是</h2><ul class=""><li id="c4b4" class="kk kl hi ih b ii km im kn iq ko iu kp iy kq jc kr ks kt ku bi translated">NodeJs和NPM已安装</li><li id="e4d3" class="kk kl hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">不和谐. js</li><li id="1b02" class="kk kl hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">dotenv</li></ul><h2 id="f497" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">设置项目</h2><p id="3d92" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">创建一个名为<code class="du ld le lf lg b">discord_bot</code>的文件夹，并使用<code class="du ld le lf lg b">npm init -y</code>命令初始化该文件夹中的一个节点项目。现在让我们通过输入这个命令<code class="du ld le lf lg b">npm i discord.js dotenv</code>来安装一些软件包。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/8297b92a4c72b80394355427812145cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*FbPr330iUGMrdiIV.png"/></div></figure><p id="443c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建一个名为<code class="du ld le lf lg b">.env</code>的文件。这个文件将包含我们的环境变量，比如机器人的<code class="du ld le lf lg b">TOKEN</code>和<code class="du ld le lf lg b">PREFIX</code>。</p><p id="837e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们为我们的不和谐机器人得到我们的令牌。去<a class="ae li" href="https://discord.com/developers/applications" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Discord开发者门户</strong> </a>如果你还没有注册的话就去注册吧。现在打开应用程序选项卡，点击<code class="du ld le lf lg b">New Application</code>。键入一个名称，然后按<code class="du ld le lf lg b">Create</code>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lj"><img src="../Images/dc8e1dbcf91c9e157891de5a96ed04c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7PECHtLXa0G1F0kX.png"/></div></div></figure><p id="78df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在您已经创建了一个应用程序，通过键入name并给它一个个人资料图片来设置它。</p><p id="f9a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<code class="du ld le lf lg b">Bot</code>选项卡，复制令牌。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/36414bf783a6348c2d875df15d25caa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SPWaeuYE2WSFp5Yx.png"/></div></div></figure><p id="dec9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将其粘贴到您的<code class="du ld le lf lg b">.env</code>文件中。您的文件应该如下所示</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="72e3" class="jp jq hi lg b fi lp lq l lr ls">TOKEN=PASTE YOUR TOKEN HERE<br/>PREFIX=!</span></pre><p id="7258" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过转到<code class="du ld le lf lg b">OAuth2</code>选项卡并赋予它<code class="du ld le lf lg b">bot</code>的范围和<code class="du ld le lf lg b">Administrator</code>的权限来邀请我们的机器人加入我们的服务器，复制url并将其粘贴到您的浏览器中，现在选择您的服务器并按<code class="du ld le lf lg b">Continue</code>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/30c98e5932de3d692df6c40b408d6d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ubxRG45mh0CDzK2k.png"/></div></div></figure><p id="d1aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们开始创建我们的不和谐机器人。</p><h2 id="f484" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">登录我们的机器人</h2><p id="ceaf" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">在你的项目中创建<code class="du ld le lf lg b">index.js</code>文件并开始输入你的代码。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="9458" class="jp jq hi lg b fi lp lq l lr ls">require("dotenv").config(); // Telling Nodejs, We are using dotenv to get environment variables<br/>const discord = require("discord.js"); // Importing discord.js library<br/>const client = new discord.Client(); // Creating a client for our bot<br/>const fs = require("fs"); // We are gonna need filesystem module for later.</span><span id="e147" class="jp jq hi lg b fi lu lq l lr ls">// Your CODE WILL GO HERE</span><span id="3048" class="jp jq hi lg b fi lu lq l lr ls">client.login(process.env.TOKEN); // Login into your discord bot you created by this method and passing it the token</span></pre><p id="d21c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来听一下<code class="du ld le lf lg b">ready</code>事件(当我们的bot准备好使用时它会触发)。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="5eb8" class="jp jq hi lg b fi lp lq l lr ls">require("dotenv").config(); // Telling Nodejs, We are using dotenv to get environment variables<br/>const discord = require("discord.js"); // Importing discord.js library<br/>const client = new discord.Client(); // Creating a client for our bot<br/>const fs = require("fs"); // We are gonna need filesystem module for later.</span><span id="7792" class="jp jq hi lg b fi lu lq l lr ls">client.on('ready', () =&gt; {<br/>    console.log("Hello World!");<br/>});</span><span id="6511" class="jp jq hi lg b fi lu lq l lr ls">client.login(process.env.TOKEN); // Login into your discord bot you created by this method and passing it the token</span></pre><p id="a756" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果你在powershell中输入<code class="du ld le lf lg b">nodemon index</code>来运行你的机器人。您将看到<code class="du ld le lf lg b">Hello World!</code>登录到您的终端。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lv"><img src="../Images/485bfc0f1a660de9b3dcec226d71c8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/0*soJlOftV2qfTMIeY.png"/></div></figure><h2 id="3535" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">创建命令</h2><p id="a277" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">要创建命令，在项目中创建名为<code class="du ld le lf lg b">commands</code>的目录。让我们为我们的机器人创建一个基本命令<code class="du ld le lf lg b">ping</code>。在我们的<code class="du ld le lf lg b">commands</code>目录下创建名为<code class="du ld le lf lg b">ping</code>的文件。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="ea32" class="jp jq hi lg b fi lp lq l lr ls">// Importing Message data type from `discord.js`<br/>const { Message } = require("discord.js");</span><span id="a1c4" class="jp jq hi lg b fi lu lq l lr ls">/* <br/>    Exporting a object with name, description and execute properties.<br/>    1. name - this will be the name of the commands and used to call the commands<br/>    2. description - This will be helpful for getting help message.<br/>    3. execute - This will contain the function of the command. message and args will be passed to it.<br/>*/<br/>module.exports = {<br/>    name: "ping",<br/>    description: "Gets the ping of the Bot.",<br/>    execute: (message, args) =&gt; {<br/>        // Creating a new message<br/>        const msg = new Message();<br/>        // Setting content of the message to 'Pong!'<br/>        msg.content = "Pong!";<br/>        // Sending the message to the current channel<br/>        message.channel.send(msg);<br/>    }<br/>}</span></pre><p id="6008" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以根据需要添加更多命令，就像这样。</p><h2 id="86bb" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">执行命令</h2><p id="4081" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">我们将监听服务器任何通道上的消息，并看到该消息是从我们在<code class="du ld le lf lg b">.env</code>文件中使用的<code class="du ld le lf lg b">PREFIX</code>开始的。为此，我们将侦听<code class="du ld le lf lg b">message</code>事件(每当有新消息时，该事件就会触发)。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="2911" class="jp jq hi lg b fi lp lq l lr ls">require("dotenv").config(); // Telling Nodejs, We are using dotenv to get environment variables<br/>const discord = require("discord.js"); // Importing discord.js library<br/>const client = new discord.Client(); // Creating a client for our bot<br/>const fs = require("fs"); // We are gonna need filesystem module for later.</span><span id="0faf" class="jp jq hi lg b fi lu lq l lr ls">client.on('ready', () =&gt; {<br/>    console.log("Hello World!");<br/>});</span><span id="4b45" class="jp jq hi lg b fi lu lq l lr ls">client.on("message", (message) =&gt; {<br/>    // If message doesn't start with our prefix and author of that message is a bot, we are gonna break the execution any further<br/>	if (!message.content.startsWith(process.env.PREFIX) || message.author.bot)<br/>		return; <br/>		<br/>    // Removing prefix, Getting command and arguments <br/>	const args = message.content.slice(process.env.PREFIX.length).split(/ +/); <br/>	const command = args.shift().toLowerCase(); // Getting command name.</span><span id="57f3" class="jp jq hi lg b fi lu lq l lr ls">});</span><span id="a1e6" class="jp jq hi lg b fi lu lq l lr ls">client.login(process.env.TOKEN); // Login into your discord bot you created by this method and passing it the token</span></pre><p id="c835" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了用消息调用的命令和参数。我们可以创建命令。为此，首先我们要对我们的<code class="du ld le lf lg b">ready</code>事件监听器做一些更改。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="5e62" class="jp jq hi lg b fi lp lq l lr ls">client.on("ready", () =&gt; {<br/>	console.log("Hello World!");<br/>	// Creating new Collection Datatype from discord.js(You can learn about it from the documentation of discord.js)<br/>	client.commands = new discord.Collection(); </span><span id="166f" class="jp jq hi lg b fi lu lq l lr ls">    // Getting all file names with extension of `.js` in the `commands` directory<br/>	const commandFiles = fs<br/>		.readdirSync("./commands/")<br/>		.filter((file) =&gt; file.endsWith(".js")); <br/>		<br/>    // Looping through the file and getting all the commands from it and setting it by name and command.<br/>	for (const file of commandFiles) {<br/>		const command = require(`./commands/${file}`);<br/>		client.commands.set(command.name, command);<br/>	}<br/>});</span></pre><p id="a09d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在改变我们的<code class="du ld le lf lg b">message</code>事件来执行命令。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="587d" class="jp jq hi lg b fi lp lq l lr ls">client.on("message", (message) =&gt; {<br/>	if (!message.content.startsWith(process.env.PREFIX) || message.author.bot)<br/>		return;</span><span id="bb4c" class="jp jq hi lg b fi lu lq l lr ls">	const args = message.content.slice(process.env.PREFIX.length).split(/ +/);<br/>	const command = args.shift().toLowerCase();</span><span id="3d99" class="jp jq hi lg b fi lu lq l lr ls">    // Checking if command exist it, if it does, calling execute function. Else sending error message to the channel where the command was called from.<br/>	if (client.commands.has(command)) {<br/>		client.commands.get(command).execute(message, args);<br/>	} else {<br/>		message.channel.send(<br/>			`No command named **${command}** is found. Type **help** for all commands.`<br/>		);<br/>	}<br/>});</span></pre><p id="2853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您向服务器发送消息，将导致命令被执行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/ac2b59b78a93a03be7b67cb22802ec50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6hDT62BkmXzJJH2C.png"/></div></div></figure><h2 id="a920" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">创建帮助命令</h2><p id="9c99" class="pw-post-body-paragraph if ig hi ih b ii km ik il im kn io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">要创建帮助命令，在<code class="du ld le lf lg b">commands</code>目录中创建一个名为<code class="du ld le lf lg b">help.js</code>的文件。</p><pre class="je jf jg jh fd ll lg lm ln aw lo bi"><span id="18b6" class="jp jq hi lg b fi lp lq l lr ls">// Importing Message embed data type<br/>const { MessageEmbed } = require("discord.js");<br/>// Importing Filesystem module<br/>const fs = require("fs");<br/><br/>module.exports = {<br/>	name: "help",<br/>	description: "Help command gives you the information about the commands",<br/>	execute: function (message, args) {<br/>	    // Instantiating new MessageEmbed<br/>		const embed = new MessageEmbed();<br/>		// Setting title and description of the embed<br/>		embed.setTitle("Help");<br/>		embed.setDescription("Type help &lt;command&gt; to get help for the command");<br/><br/>        // If no command specified after !help then execute this.<br/>		if (args.length &lt; 1) {<br/>		    // Reading all the commands<br/>			const commandFiles = fs<br/>				.readdirSync("./commands/")<br/>				.filter((file) =&gt; file.endsWith(".js"));<br/><br/>			for (const file of commandFiles) {<br/>				const command = require(`./${file}`);<br/>                // Adding to the embed command name and its description<br/>				embed.addField(command.name, command.description, true);<br/>			}<br/>		} else {<br/>			const command = require(`./${args[0]}.js`);<br/>			if (!command) {<br/>				return message.channel.send("No command found");<br/>			}<br/><br/>			embed.addField(command.name, command.description, true);<br/>		}<br/>		// Sending the embed to the channel.<br/>		message.channel.send(embed);<br/>	},<br/>};</span></pre><p id="3773" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果你输入<code class="du ld le lf lg b">!help</code>或<code class="du ld le lf lg b">!help command</code>，它将被执行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/157c0883768b80040901bfdb04c353d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y-nnhC4ViRLNt2dX.png"/></div></div></figure><p id="83a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要全天候运行这个机器人，你需要把它托管在一个托管提供商上，比如<code class="du ld le lf lg b">Heroku</code>、<code class="du ld le lf lg b">Digital Ocean</code>或<code class="du ld le lf lg b">Google Cloud</code>。</p><p id="4539" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">项目链接在我的网站上。</p><p id="15e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的社交网站上关注我。</p></div></div>    
</body>
</html>
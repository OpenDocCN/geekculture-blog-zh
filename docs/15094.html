<html>
<head>
<title>Part 16: Highest Salary In Department Asked by Twitter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第16部分:Twitter询问的部门最高工资</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/part-16-highest-salary-in-department-asked-by-twitter-7a8ccfb19b1f?source=collection_archive---------14-----------------------#2022-10-12">https://medium.com/geekculture/part-16-highest-salary-in-department-asked-by-twitter-7a8ccfb19b1f?source=collection_archive---------14-----------------------#2022-10-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="4c58" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">让我们解决基于产品的公司提出的SQL问题</h1><p id="bd18" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是基于产品的公司在面试中提出的一系列SQL问题中的第16篇文章。对于本文，我使用StrataScratch平台来获取基于产品的公司中被问到的问题。</p><p id="36c4" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">StataScratch是一个优秀的平台，适合任何希望开始学习数据科学并提高其SQL和Python技能的人。这个平台不仅提供编码题，还提供与数据科学相关的非编码题，比如统计、概率等等。我强烈建议你在StrataScratch网站上注册一个账户，在文章旁边练习这个问题。我将使用Postgres SQL数据库来解决这个问题。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es kh"><img src="../Images/33a9e578e274817bd86bb3fb20c2fdf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*b9EBiYZAGZUK_Aph.jpeg"/></div></figure><p id="38aa" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">以下是基于产品的公司提出的一系列Postgres SQL问题的链接:</p><div class="kp kq ez fb kr"><div role="button" tabindex="0" class="ab bv ff cb dy ks kt bn ku kn kv"><div class="kw l"><div class="ab q"><div class="l di"><img alt="R. Gupta" class="l de bw kx ky du" src="../Images/70207ad0decf9fadb709608abf121645.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*VKG7ua5JklBVaWVvc2cB8Q.jpeg"/><div class="dr bw l kx ky ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://agupta97.medium.com/?source=post_page-----7a8ccfb19b1f--------------------------------" rel="noopener follow" target="_top">古普塔</a></p></div></div><div class="lb lc fg l"><h2 class="bd hj sm me dy sn ea eb so ed ef hh bi translated">面试问题</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi sp au sq sr ss ph st an fx fy su sv sw gb gc gd de bk ge" href="https://agupta97.medium.com/list/stratascratch-postgres-interview-problems-c4020531504b?source=post_page-----7a8ccfb19b1f--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="sx l dw"><span class="bd b fp z dx">18 stories</span></div></div></div><div class="lo dh lp dy ab lq dw di"><div class="di lg bv lh li"><div class="dh l"><img alt="" class="dh" src="../Images/e566d22f927cc4d9b2e12e2bb52bc915.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*SLyuftfrcBDQAkH1eKD9Xg.jpeg"/></div></div><div class="di lg bv lj lk ll"><div class="dh l"><img alt="" class="dh" src="../Images/1352126327d45095086041e8e64954b6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*wZyz0GXAws3cQNKwhQpXHw.jpeg"/></div></div><div class="di bv lm ln ll"><div class="dh l"><img alt="" class="dh" src="../Images/1352126327d45095086041e8e64954b6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*wZyz0GXAws3cQNKwhQpXHw.jpeg"/></div></div></div></div></div><p id="2706" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">如果你从事数据科学工作或者想在数据科学领域开始职业生涯，SQL是最重要的技能之一。<br/>如果你熟悉SQL，你将有更好的机会通过数据科学面试或处理日常任务。本文将集中讨论一个问题以及如何解决它。如果你想提高你的SQL知识和经验，你必须阅读这篇文章。你提出想法和寻找解决方案的方法无疑会有所改进。</p><p id="6904" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是<strong class="jf hj"> Twitter </strong>在其一次采访中提出的中级问题。可以在这里查看问题<a class="ae kb" href="https://platform.stratascratch.com/coding/9897-highest-salary-in-department?code_type=1" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">。</strong> </a>问题名称为<strong class="jf hj">部门最高工资</strong>。<strong class="jf hj"> </strong>下面是问题的细节:</p><h1 id="228c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">部门最高工资</h1><p id="a309" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">找出每个部门工资最高的员工。输出部门名称、雇员的名字以及相应的薪水。</p><blockquote class="lv lw lx"><p id="4f70" class="jd je ly jf b jg kc ji jj jk kd jm jn lz ke jq jr ma kf ju jv mb kg jy jz ka hb bi translated"><em class="hi">公司:</em> <strong class="jf hj"> <em class="hi">推特</em> </strong> <em class="hi">，难度:</em> <strong class="jf hj"> <em class="hi">中等</em> </strong> <em class="hi">，面试问题id:</em><strong class="jf hj"><em class="hi">9897</em></strong><em class="hi">，</em> <strong class="jf hj"> <em class="hi"> </em> </strong> <em class="hi">表格:</em> <strong class="jf hj"> <em class="hi">员工，</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mc"><img src="../Images/82c09b3d15fbc488495c873a783bec0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*dcPxITrlX4eJQo1qsnZMfQ.jpeg"/></div></figure><p id="06b4" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">员工表预览:</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es md"><img src="../Images/050acb37104671badf6fdd5c31808b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*NAE1r_0WV3pkPSx1w1eWLA.jpeg"/></div></figure><p id="0c08" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">首先，让我们试着理解这个问题。如问题中所述，我们需要返回部门中收入最高的雇员的名字、部门和薪水字段。</p><p id="3329" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">方法1:使用distinct on() </strong></p><ol class=""><li id="c947" class="me mf hi jf b jg kc jk kd jo mg js mh jw mi ka mj mk ml mm bi translated">我们可以按部门升序和工资降序对数据进行排序。</li></ol><pre class="ki kj kk kl fd mn mo mp mq aw lu bi"><span id="3ded" class="mr ig hi mo b fi ms mt l mu mv"><strong class="mo hj">select first_name, department, salary <br/>       from employee <br/>       order by department, salary desc ;</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mw"><img src="../Images/66350e7c233284f4b714745194932c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*yLjFUXIzuEFO9Kfaxs5saw.jpeg"/></div></figure><p id="a744" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">2.观察前面的输出。如果我们可以从每个部门组成的组中选择第一行，我们将获得该部门中工资最高的员工的记录。这可以使用distinct on(col_name)来完成。<strong class="jf hj"> distinct on(col_name) </strong>为基于col_name形成的每个组给出第一行。应该出现在第一行中的内容是使用order by子句确定的，因为我们希望为每个部门选择最高的选项，因此，我们按照薪金的降序对行进行了排序。</p><pre class="ki kj kk kl fd mn mo mp mq aw lu bi"><span id="a8b9" class="mr ig hi mo b fi ms mt l mu mv"><strong class="mo hj">select distinct on(department) <br/>        department,first_name, salary <br/>        from employee <br/>        order by department, salary desc ;</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mx"><img src="../Images/3e24a374201fb750e25ecaf721cd2012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*BrJvEGToJtYHbmEperPJpg.jpeg"/></div></figure><p id="4aa3" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">方法2:使用子查询</strong></p><ol class=""><li id="cb53" class="me mf hi jf b jg kc jk kd jo mg js mh jw mi ka mj mk ml mm bi translated">我们可以首先使用group by找出部门最高工资。</li></ol><pre class="ki kj kk kl fd mn mo mp mq aw lu bi"><span id="8157" class="mr ig hi mo b fi ms mt l mu mv"><strong class="mo hj">select department, max(salary) <br/>       from employee <br/>       group by department;</strong></span></pre><p id="587b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">2.然后使用该查询作为子查询来选择那些部门和薪金与子查询结果匹配的记录。</p><pre class="ki kj kk kl fd mn mo mp mq aw lu bi"><span id="49c2" class="mr ig hi mo b fi ms mt l mu mv"><strong class="mo hj">select department, first_name, salary <br/>       from employee <br/>       where (department, salary) in <br/>           (<br/>            select department, max(salary) <br/>            from employee <br/>            group by department<br/>            );</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><div class="er es my"><img src="../Images/8309de4c09033e75400d3e8032d98acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*R69vh5eIIN_KDWIqrDud_g.jpeg"/></div></div></figure></div><div class="ab cl nd ne gp nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="hb hc hd he hf"><p id="44b7" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">你花时间阅读我的帖子并回复我，这对我意义重大。竖起大拇指，如果你喜欢，点击“关注”。在媒体上关注我，以便在我发布新内容时接收通知。</p></div></div>    
</body>
</html>
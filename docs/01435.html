<html>
<head>
<title>Generating Map tiles at Different Zoom Levels Using Gdal2tiles in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的Gdal2tiles生成不同缩放级别的地图切片</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/generating-map-tiles-at-different-zoom-levels-using-gdal2tiles-in-python-af905eecf954?source=collection_archive---------0-----------------------#2021-04-10">https://medium.com/geekculture/generating-map-tiles-at-different-zoom-levels-using-gdal2tiles-in-python-af905eecf954?source=collection_archive---------0-----------------------#2021-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/77077bb7b39771d54e5f881272e32b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rihQtPxfaAbM-KcR2i8BAA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Satellite image of New York City captured by the <a class="ae iu" href="https://www.planet.com/" rel="noopener ugc nofollow" target="_blank">PlanetScope</a> satellite</figcaption></figure><p id="be22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">近年来，我们看到由卫星和航空图像组成的地理空间数据的使用大幅增长。这种增长不仅导致卫星和航空图像成为大数据革命的一部分，还为企业提供了新的探索途径。早些时候，政府和大公司是唯一能够获得用于军事和国防目的的高质量卫星图像的机构。今天，任何人只要有一台电脑和互联网连接就可以获得卫星图像，因为获取卫星图像的价格已经大幅下降。这为数据科学家和机器学习工程师从事不同项目提供了各种机会。</p><p id="f53a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来自卫星的图像只能达到它们的空间分辨率。像素越小，图像越清晰。因此，高分辨率图像的空间分辨率值非常低。像WorldView-3和SkySat这样的商业卫星的空间分辨率分别接近31厘米/像素和50厘米/像素。</p><p id="157a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">高分辨率栅格数据有两个主要问题。</p><ul class=""><li id="ce31" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">如果要显示这样高分辨率的栅格数据，就需要很大的内存。</li><li id="ee4d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">如果我们把它放到互联网上，可能会有带宽问题。</li></ul><p id="eb06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了解决这些问题，最好平铺高分辨率图像，<a class="ae iu" href="https://gdal.org/programs/gdal2tiles.html" rel="noopener ugc nofollow" target="_blank"><em class="kh">gdal 2 tiles</em></a><em class="kh"/>可以帮助我们。</p><h1 id="30fd" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">数据</h1><p id="e749" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">为了向您展示一个使用<em class="kh"> gdal2tiles </em>库的示例，我们将使用一个来自<a class="ae iu" href="https://openmaptiles.org/" rel="noopener ugc nofollow" target="_blank"> OpenMapTiles </a>的地理参考图像样本，它位于<em class="kh">中。tif </em>文件格式。来自OpenMapTiles的图像的空间分辨率为<em class="kh"> 20m/px </em>。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/52dbc83042bc2fcccede099db247527b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8IM4n6ckMliQp2Eg_GzdEw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Sample geo-referenced image from OpenMapTiles</figcaption></figure><h1 id="9e62" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">安装和使用</h1><p id="94a6" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">在安装<em class="kh"> gdal2tiles </em>库之前，确保python和gdal已经安装在您的机器上。<em class="kh">GDAL 2文件需要一些GDAL依赖项。因此，最好同时安装python和GDAL。如果你需要帮助安装它们，你可以遵循克里斯托夫·里克的逐步指导。</em></p><p id="ad05" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在您的机器上打开一个终端，运行下面的命令来安装<em class="kh"> gdal2tiles </em> python库。</p><pre class="lm ln lo lp fd ls lt lu lv aw lw bi"><span id="cf0f" class="lx kj hi lt b fi ly lz l ma mb">$ pip install gdal2tiles</span></pre><p id="d8f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以通过在终端中编写以下命令来查看不同的可用选项。</p><pre class="lm ln lo lp fd ls lt lu lv aw lw bi"><span id="70ef" class="lx kj hi lt b fi ly lz l ma mb">$ gdal2tiles.py -help</span></pre><p id="5b38" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上述命令的输出如下所示:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/b9b21f65f80e7b038857de36c39327f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwYXP8M7W5IUntTq-Oj5YQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">List of options available for <em class="md">gdal2tiles</em></figcaption></figure><p id="dd63" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">运行以下命令获取源图像的地理空间信息。在我们的例子中，样本图像有一个文件名<em class="kh"> sample.tif. </em></p><pre class="lm ln lo lp fd ls lt lu lv aw lw bi"><span id="3f9a" class="lx kj hi lt b fi ly lz l ma mb">$ gdalinfo sample.tif</span></pre><p id="31aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您应该得到如下所示的输出:</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/35c32c312983242385c0f466b7d434c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpEtc-DsWTio4h5SIbpNHw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">gdalinfo command output</figcaption></figure><p id="e37d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出为我们提供了图像的重要地理空间信息，如投影或srs值(EPSG:4326) <em class="kh">、</em>边界框坐标(左上、左下、右上、右下)、基准等。当使用<em class="kh"> gdal2tiles </em>库时，我们需要这些信息中的投影代码。</p><p id="29d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用<em class="kh"> gdal2tiles </em>库<em class="kh"> </em>编写一个小的python脚本，使用上面的一些选项来生成图块。</p><pre class="lm ln lo lp fd ls lt lu lv aw lw bi"><span id="90f0" class="lx kj hi lt b fi ly lz l ma mb">import gdal2tiles</span><span id="9390" class="lx kj hi lt b fi mf lz l ma mb">source_path = "Enter Source Path here"<br/>destination_path = "Enter Source Path here"<br/></span><span id="40d1" class="lx kj hi lt b fi mf lz l ma mb"><strong class="lt hj">def create_tiles(source_path, destination_path):</strong></span><span id="132f" class="lx kj hi lt b fi mf lz l ma mb">"""</span><span id="41e8" class="lx kj hi lt b fi mf lz l ma mb">Method to generate tiles at different zoom levels using gdal2tiles library.</span><span id="2150" class="lx kj hi lt b fi mf lz l ma mb">Args:</span><span id="2705" class="lx kj hi lt b fi mf lz l ma mb">source_path : path for the source file which needs to be tiled</span><span id="e1c6" class="lx kj hi lt b fi mf lz l ma mb">destination_path : path for the output directory where the tiles will be generated</span><span id="44df" class="lx kj hi lt b fi mf lz l ma mb">"""</span><span id="b6be" class="lx kj hi lt b fi mf lz l ma mb">    options = {'zoom': 16,</span><span id="5ed2" class="lx kj hi lt b fi mf lz l ma mb">        'nb_processes': 4,</span><span id="2bc7" class="lx kj hi lt b fi mf lz l ma mb">        'tile_size': 256,</span><span id="620e" class="lx kj hi lt b fi mf lz l ma mb">        'srs':'EPSG:4326'</span><span id="0d88" class="lx kj hi lt b fi mf lz l ma mb">        }<br/>    <strong class="lt hj">gdal2tiles.generate_tiles(source_path, destination_path,<br/>     **options)</strong></span><span id="5c72" class="lx kj hi lt b fi mf lz l ma mb">create_tiles(source_path, destination_path)</span></pre><p id="ab24" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您所看到的，上面选项列表中的一些选项已经在选项字典中使用。对于上述方法，我们尝试生成缩放级别为<em class="kh"> 16的图块，</em>生成图块的图块大小为<em class="kh"> 256，</em>使用的进程数为<em class="kh"> 4 </em>，srs(投影)值为<em class="kh"> EPSG:4326。</em>可根据您的要求修改选项。</p><p id="5e50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用以下命令运行上述脚本。根据您的python文件的名称替换"<em class="kh"> gdal2tiles_test" </em>。</p><pre class="lm ln lo lp fd ls lt lu lv aw lw bi"><span id="8059" class="lx kj hi lt b fi ly lz l ma mb">$ python3 gdal2tiles_test.py</span></pre><p id="5677" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是运行上述命令后的示例(4个平铺)输出。这是如何在缩放级别16下生成拼贴以形成样本图像的一部分的逐步显示。</p><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/ab144172b4665712be4db03c1ee4452e.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*En-gKvHubLVwkQfdPWOsVA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">1</figcaption></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/c15e06baf502d37b51488a5cdec074a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*_TwEU9suITcA291BZo_NyQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">2</figcaption></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/867d9266d05a2a530b06e58a79454943.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*u9BdS3_zMnx9eanQA4eVvw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">3</figcaption></figure><figure class="lm ln lo lp fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/c7102a73cc161717c58801292d75582b.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*b3HHvHIp3kUtOgxDcTEnFw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">4</figcaption></figure><h1 id="90e2" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">结论</h1><p id="9c9c" class="pw-post-body-paragraph iv iw hi ix b iy lg ja jb jc lh je jf jg li ji jj jk lj jm jn jo lk jq jr js hb bi translated">这篇文章提供了为什么需要gdal2tiles以及如何使用它在python中生成不同缩放级别的切片的基本知识。您也可以使用Adobe Photoshop或GIMP之类的工具手动完成这项工作，但这很容易出错，而且很繁琐。将影像叠加到地图上或托管/提供地图时，切片生成是必不可少的。</p></div></div>    
</body>
</html>
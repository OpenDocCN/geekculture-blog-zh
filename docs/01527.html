<html>
<head>
<title>Notifications in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android中的通知</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/notifications-in-android-6b2d195d35b1?source=collection_archive---------1-----------------------#2021-04-14">https://medium.com/geekculture/notifications-in-android-6b2d195d35b1?source=collection_archive---------1-----------------------#2021-04-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6d464be4a5fac2945fea85dc8490e82f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/0*POC1yIBMKNcOQdBg.jpg"/></div><figcaption class="im in et er es io ip bd b be z dx"><a class="ae iq" href="https://ifunny.co/picture/tinder-yesterday-10-22-am-who-are-all-these-new-Wbsry7hr6?s=cl" rel="noopener ugc nofollow" target="_blank">https://ifunny.co/picture/tinder-yesterday-10-22-am-who-are-all-these-new-Wbsry7hr6?s=cl</a></figcaption></figure><p id="56cf" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">通知是我们在应用程序外部向用户显示的显示消息。它有助于提醒基于时间的事情或与其他人交流。用户可以通过点击通知来打开应用程序，或者只在那里提供操作。</p><p id="563e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">就像在WhatsApp中，如果用户点击通知，我们会收到消息通知，我们会打开一个聊天窗口，或者我们可以简单地在通知中键入我们的消息。然后发送出去。</p><h1 id="5e4b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">设备上的外观</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kn"><img src="../Images/ce1e22c52703e79eb1ef862524d6053c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQKW8_3xKGIAdiaK6F7scw.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx">Notification icons appear on left side of status bar</figcaption></figure><div class="ko kp kq kr fd ab cb"><figure class="kw ij kx ky kz la lb paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/9ac5a75a20a23aa0f63e72606b756c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gMe-UPgyVtUqYKo5Nxsh-w.jpeg"/></div></figure><figure class="kw ij kx ky kz la lb paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/db2fc5df1b963177b269da881484e047.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*tGLvmStaO_J5-m-49BRdYw.jpeg"/></div></figure><figure class="kw ij kx ky kz la lb paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/d54bd1b76515fd5b57f543eb345a39a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*jaV8QV19GnlQ7mnUX-x7zw.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx lc di ld le">Reminder for sleep time in HealthifyMe app</figcaption></figure></div><p id="6139" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">用户可以在最上面的抽屉中看到通知。通知卡包含图标、标题、消息、大图标和操作按钮。</p><p id="5856" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">用户可以向下拖动通知来查看扩展视图。</p><p id="edd9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">通知在通知抽屉中保持可见，直到被应用程序或用户取消。</p><p id="fafc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">通知将在锁定屏幕上可见，直到用户从设置中隐藏它。</p><div class="ko kp kq kr fd ab cb"><figure class="kw ij lf ky kz la lb paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/f698fb6ea3a800388660057ae7b51f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1494/format:webp/1*pg5PSpElRq3j6F4eKjqEPg.jpeg"/></div></figure><figure class="kw ij lg ky kz la lb paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><img src="../Images/02d722278c6952452751d69cce0394c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*sYtZ62LnbT7r4zPVTQRfHw.jpeg"/></div><figcaption class="im in et er es io ip bd b be z dx lh di li le">Gmail small and expanded notification view</figcaption></figure></div><p id="e171" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">正如你从上面的截图中看到的，左边是一个电子邮件通知的小视图，当用户拖动它时，我们可以看到一个扩展的视图。我们这里有两个动作按钮存档和回复。点击这些按钮，用户将进入一个集成屏幕。在本文的下一部分，我们将看到如何实现这一点。</p><h1 id="8e28" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">创建通知</h1><p id="bdce" class="pw-post-body-paragraph ir is hi it b iu lj iw ix iy lk ja jb jc ll je jf jg lm ji jj jk ln jm jn jo hb bi translated">我们将从基础开始，然后转向扩展、行动和it优先级。基本通知包含图标、标题和消息，然后单击。</p><p id="c9d5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">设置通知内容:</strong></p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lo"><img src="../Images/ae2478fd3615e960b12bdf691dc329af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HUEWSYjjJllE9j9E.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx"><a class="ae iq" href="https://developer.android.com/images/ui/notifications/notification-callouts_2x.png" rel="noopener ugc nofollow" target="_blank">https://developer.android.com/images/ui/notifications/notification-callouts_2x.png</a></figcaption></figure><ol class=""><li id="12f9" class="lp lq hi it b iu iv iy iz jc lr jg ls jk lt jo lu lv lw lx bi translated"><strong class="it hj">小图标</strong>:从上面的截图来看，小图标会被<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.Builder#setSmallIcon(int)" rel="noopener ugc nofollow" target="_blank">setSmallIcon()</a></code>设置。</li><li id="d391" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo lu lv lw lx bi translated"><strong class="it hj"> App名称</strong>:由系统提供。</li><li id="88a1" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo lu lv lw lx bi translated"><strong class="it hj">时间戳</strong>:这是系统提供的，但是你可以用<code class="du ly lz ma mb b">setWhen()</code>覆盖它或者用<code class="du ly lz ma mb b">setShowWhen(false)</code>隐藏它。</li><li id="3a92" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo lu lv lw lx bi translated"><strong class="it hj">大图标</strong>:这是可选的(通常只用于联系人照片；不要用于你的应用图标)并用<code class="du ly lz ma mb b">setLargeIcon()</code>设置。</li><li id="22fe" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo lu lv lw lx bi translated"><strong class="it hj">标题</strong>:可选，用<code class="du ly lz ma mb b">setContentTitle()</code>设置。</li><li id="4c1b" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo lu lv lw lx bi translated"><strong class="it hj">文本</strong>:可选，用<code class="du ly lz ma mb b">setContentText()</code>设置。</li></ol><p id="675e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">您需要使用一个<code class="du ly lz ma mb b">NotificationCompat.Builder</code>对象来设置通知的内容和通道。</p><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="ea45" class="ml jq hi mb b fi mm mn l mo mp">val builder = NotificationCompat.Builder(context, NotificationUtils.<em class="mq">CHANNEL_OTHERS</em>)<br/>builder.setContentTitle(title)<br/>    .setContentText(message)<br/>    .setSmallIcon(icon)<br/>    .setWhen(notificationTimeInMillis)<br/>    .setColor(ContextCompat.getColor(context, R.color.<em class="mq">brand_nutrition_track</em>))<br/>    .setStyle(NotificationCompat.BigTextStyle().bigText(message))<br/>    .setDeleteIntent(dismissIntent)</span></pre><p id="e779" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">注意<code class="du ly lz ma mb b">NotificationCompat.Builder</code>构造函数要求您提供一个通道ID。这是与Android 8.0 (API级别26)和更高版本兼容所必需的，但被旧版本忽略。</p><p id="05f2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">默认情况下，通知文本在一行中。<strong class="it hj">如果您的内容很大，无法在一行中显示，您可以通过添加样式来添加扩展视图</strong>:</p><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="41ad" class="ml jq hi mb b fi mm mn l mo mp">setStyle(NotificationCompat.BigTextStyle().bigText(message)</span></pre><p id="939b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">创建频道</strong></p><p id="fdd1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在Android 8.0和更高版本上发送通知之前，您必须通过将<code class="du ly lz ma mb b">NotificationChannel</code>的实例传递给<code class="du ly lz ma mb b">createNotificationChannel()</code>来向系统注册您的应用程序的通知通道。所以下面的代码被<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/android/os/Build.VERSION#SDK_INT" rel="noopener ugc nofollow" target="_blank">SDK_INT</a></code>版本上的一个条件阻塞了:</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="96da" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因为在android 8.0或更高版本上需要设置一个通知通道来发送通知，所以这应该在应用程序启动时或者至少在创建通知构建器之前进行。</p><p id="1dda" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">带频道的用户控制应用程序通知。我们可以进入应用程序设置-&gt;通知，你会看到一个这样的窗口。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/1c5e68a09243d6d179c9a5ca1a006cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*0j7r4Ub-Ucllnfd7w-mWuQ.jpeg"/></div></figure><p id="82e9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">上面你可以看到HealthifyMe应用中的频道列表。如果我们不想要特定的通道通知，只需禁用它。</p><p id="954f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">锁屏可视性</strong></p><p id="0857" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">从上面的代码片段可以看出，我们正在设置<strong class="it hj">锁屏可见性。</strong>用于安全目的，比如用户不想在设备锁定时显示通知，或者只想显示有限的内容。</p><p id="af27" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">使用<code class="du ly lz ma mb b"> <strong class="it hj">setVisibility()</strong></code>方法:</p><ul class=""><li id="d745" class="lp lq hi it b iu iv iy iz jc lr jg ls jk lt jo mu lv lw lx bi translated"><code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat#VISIBILITY_PUBLIC" rel="noopener ugc nofollow" target="_blank">VISIBILITY_PUBLIC</a></code>显示通知的全部内容。</li><li id="69eb" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo mu lv lw lx bi translated"><code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat#VISIBILITY_SECRET" rel="noopener ugc nofollow" target="_blank">VISIBILITY_SECRET</a></code>在锁定屏幕上不显示该通知的任何部分。</li><li id="30a6" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo mu lv lw lx bi translated"><code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat#VISIBILITY_PRIVATE" rel="noopener ugc nofollow" target="_blank">VISIBILITY_PRIVATE</a></code>显示基本信息，如通知的图标和内容标题，但隐藏通知的全部内容。</li></ul><p id="aef4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">设置通知优先级</strong></p><p id="7ee4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">通知优先级定义了当用户在做其他事情时，一个通道如何中断用户来显示通知。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/8e239b0738470fe77960b7ccda701cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/0*YqWnuLs2A_91DS9G.jpg"/></div><figcaption class="im in et er es io ip bd b be z dx"><a class="ae iq" href="https://ifunny.co/picture/me-knock-knock-my-dad-is-it-the-interrupting-cow-Xsgbeaca6?s=cl" rel="noopener ugc nofollow" target="_blank">https://ifunny.co/picture/me-knock-knock-my-dad-is-it-the-interrupting-cow-Xsgbeaca6?s=cl</a></figcaption></figure><p id="7a38" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">您指定的重要性级别将是频道的默认值。用户可以在Android设置中更改频道的重要性级别。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mw"><img src="../Images/eb3d443b2be6e5997fcf1fb77bf205d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjJoUyqTAlhUS_zPxmVuGg.png"/></div></div></figure><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="db8b" class="ml jq hi mb b fi mm mn l mo mp">setPriority(NotificationCompat.PRIORITY_DEFAULT)</span></pre><p id="f3d6" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">通知的点击动作</strong></p><p id="4e03" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">当您单击通知时，它应该会打开一个活动，为此，您必须指定一个用<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/android/app/PendingIntent" rel="noopener ugc nofollow" target="_blank">PendingIntent</a></code>对象定义的内容意图，并将其传递给<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/androidx/core/app/NotificationCompat.Builder#setContentIntent(android.app.PendingIntent)" rel="noopener ugc nofollow" target="_blank">setContentIntent()</a></code>。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="916f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">请注意，我们添加了setAutoCancel()，当您点击它时，它将取消通知。</p><p id="464e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">设置标志</strong></p><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="1e52" class="ml jq hi mb b fi mm mn l mo mp">val pendingIntent = PendingIntent.getActivity(context,<br/>    notificationId,activityIntent,PendingIntent.<em class="mq">FLAG_CANCEL_CURRENT</em>)</span></pre><p id="5249" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">当我们为通知的触摸动作创建待定意向时，我们可以通过调用<code class="du ly lz ma mb b">setFlags()</code>方法或在方法中提供对象值来设置标志y。它有助于在用户通过通知打开您的应用程序后，保持他们预期的导航体验。</p><p id="01ba" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我们是否需要设置这取决于我们正在打开的活动的类型。有两种情况:</p><ul class=""><li id="4648" class="lp lq hi it b iu iv iy iz jc lr jg ls jk lt jo mu lv lw lx bi translated"><strong class="it hj">常规活动</strong>:这是作为你的应用正常UX流的一部分而存在的活动。因此，当用户从通知到达活动时，新任务应该包括一个完整的<a class="ae iq" href="https://developer.android.com/guide/components/activities/tasks-and-back-stack" rel="noopener ugc nofollow" target="_blank"> back stack </a>，允许他们按<em class="mq"> Back </em>并在应用程序层次结构中向上导航。</li><li id="d40e" class="lp lq hi it b iu mc iy md jc me jg mf jk mg jo mu lv lw lx bi translated"><strong class="it hj">特殊活动</strong>:只有从通知开始，用户才能看到该活动。从某种意义上说，该活动通过提供难以在通知本身中显示的信息来扩展通知UI。所以这个活动不需要back stack。</li></ul><p id="232c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">关于标志的详细信息</strong></p><p id="624c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们已经讨论了一些在创建<code class="du ly lz ma mb b">PendingIntent</code>时可以使用的标志，但是还有一些其他的标志需要讨论。</p><p id="ae3c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">🤡<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#FLAG_IMMUTABLE:kotlin.Int" rel="noopener ugc nofollow" target="_blank">FLAG_IMMUTABLE</a></code>:表示<code class="du ly lz ma mb b">PendingIntent</code>内的意图不能被传递<code class="du ly lz ma mb b">Intent</code>到<code class="du ly lz ma mb b">PendingIntent.send()</code>的其他应用修改。一个应用程序总是可以使用<code class="du ly lz ma mb b">FLAG_UPDATE_CURRENT</code>来修改它自己的挂起内容</p><p id="b52e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">🆕<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#FLAG_MUTABLE:kotlin.Int" rel="noopener ugc nofollow" target="_blank">FLAG_MUTABLE</a></code>:只有当某些功能依赖于修改潜在意图时，才应该使用它，例如，任何需要与内嵌回复或气泡一起使用的PendingIntent。</p><p id="81d3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">😎<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#flag_update_current" rel="noopener ugc nofollow" target="_blank">FLAG_UPDATE_CURRENT</a></code>:请求系统用新的额外数据更新现有的<code class="du ly lz ma mb b">PendingIntent</code>，而不是存储新的<code class="du ly lz ma mb b">PendingIntent</code>。如果<code class="du ly lz ma mb b">PendingIntent</code>没有注册，那么这个就会注册。</p><p id="ba3e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">👆🏻<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#flag_one_shot" rel="noopener ugc nofollow" target="_blank">FLAG_ONE_SHOT</a></code>:表示该PendingIntent只能使用一次的标志。与#getActivity、<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#getBroadcast(android.content.Context,%20kotlin.Int,%20android.content.Intent,%20kotlin.Int)" rel="noopener ugc nofollow" target="_blank">getBroadcast</a></code>和<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#getService(android.content.Context,%20kotlin.Int,%20android.content.Intent,%20kotlin.Int)" rel="noopener ugc nofollow" target="_blank">getService</a></code>一起使用。</p><p id="56bc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果设置了，在对它调用<code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#send()" rel="noopener ugc nofollow" target="_blank">send()</a></code>之后，它将自动为你取消，并且任何未来通过它发送的尝试都将失败。</p><p id="e788" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">🔐利用<code class="du ly lz ma mb b">FLAG_ONE_SHOT</code>可以防止诸如<a class="ae iq" href="https://en.wikipedia.org/wiki/Replay_attack" rel="noopener ugc nofollow" target="_blank">“重放攻击”</a>之类的问题。</p><p id="4e0b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><code class="du ly lz ma mb b"><a class="ae iq" href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#flag_cancel_current" rel="noopener ugc nofollow" target="_blank">FLAG_CANCEL_CURRENT</a></code>:在注册新的<code class="du ly lz ma mb b">PendingIntent</code>之前，取消现有的<code class="du ly lz ma mb b">PendingIntent</code>(如果存在的话)。如果一个特定的<code class="du ly lz ma mb b">PendingIntent</code>被发送到一个应用程序，而你想把它发送到不同的应用程序，可能会更新数据，这可能很重要。通过使用<code class="du ly lz ma mb b">FLAG_CANCEL_CURRENT</code>，第一个应用程序将不再能够调用send，但是第二个应用程序可以。</p><p id="736d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这就是我们在上面的代码片段中使用的内容。</p><p id="595d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">设置声音:</strong></p><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="f444" class="ml jq hi mb b fi mm mn l mo mp">Uri alarmSound = RingtoneManager.<em class="mq">getDefaultUri</em>(RingtoneManager.<em class="mq">TYPE_NOTIFICATION</em>);<br/>builder.setSound(alarmSound);<br/>builder.setVibrate(AbstractNotificationGCMHandler.<em class="mq">DEFAULT_VIBRATE_PATTERN</em>);</span></pre><p id="e600" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">显示通知</strong></p><p id="b944" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">创建通知生成器、通道并将内容设置为后。展示和。全体行动。是时候展示了。通知。</p><pre class="ko kp kq kr fd mh mb mi mj aw mk bi"><span id="d879" class="ml jq hi mb b fi mm mn l mo mp">notificationManager.notify(notificationId, builder.build());</span></pre><p id="fb56" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">见下面通知的完整代码:</strong></p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="mr ms l"/></div></figure></div><div class="ab cl mx my gp mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="hb hc hd he hf"><p id="b837" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我希望这篇文章对你有帮助。如果我们想引起用户的注意，通知在许多android应用中是很重要的。在这里，我们了解了什么是通知，如何通知。他们着眼于，如何创建一个通知通道，如何为通知添加显示内容，如何提供点击动作和显示通知。</p><p id="3755" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但这还没有结束。在本文的下一部分，我们将了解分组通知、有时间限制的通知和通知上的用户操作按钮，以及在应用程序进度条中检索用户输入数据。</p><p id="d354" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在此找到本文的下一部分:</p><div class="ne nf ez fb ng nh"><a href="https://karishma-agr1996.medium.com/notifications-in-android-part-2-d37102e7e29a" rel="noopener follow" target="_blank"><div class="ni ab dw"><div class="nj ab nk cl cj nl"><h2 class="bd hj fi z dy nm ea eb nn ed ef hh bi translated">Android中的通知—第2部分</h2><div class="no l"><p class="bd b fp z dy nm ea eb nn ed ef dx translated">karishma-agr1996.medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ik nh"/></div></div></a></div><h1 id="2ab6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><div class="ne nf ez fb ng nh"><a href="https://developer.android.com/training/notify-user/build-notification#notify" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab dw"><div class="nj ab nk cl cj nl"><h2 class="bd hj fi z dy nm ea eb nn ed ef hh bi translated">创建通知| Android开发者</h2><div class="nv l"><h3 class="bd b fi z dy nm ea eb nn ed ef dx translated">当您的应用程序未被使用时，通知会提供有关该应用程序中事件的简短、及时的信息。本页教你…</h3></div><div class="no l"><p class="bd b fp z dy nm ea eb nn ed ef dx translated">developer.android.com</p></div></div><div class="np l"><div class="nw l nr ns nt np nu ik nh"/></div></div></a></div><div class="ne nf ez fb ng nh"><a href="https://developer.android.com/reference/kotlin/android/app/PendingIntent#flag_one_shot" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab dw"><div class="nj ab nk cl cj nl"><h2 class="bd hj fi z dy nm ea eb nn ed ef hh bi translated">待定内容| Android开发者</h2><div class="nv l"><h3 class="bd b fi z dy nm ea eb nn ed ef dx translated">AccessibilityServiceMagnificationController . OnMagnificationChangedListener</h3></div><div class="no l"><p class="bd b fp z dy nm ea eb nn ed ef dx translated">developer.android.com</p></div></div><div class="np l"><div class="nx l nr ns nt np nu ik nh"/></div></div></a></div><div class="ne nf ez fb ng nh"><a rel="noopener follow" target="_blank" href="/androiddevelopers/all-about-pendingintents-748c8eb8619"><div class="ni ab dw"><div class="nj ab nk cl cj nl"><h2 class="bd hj fi z dy nm ea eb nn ed ef hh bi translated">关于未决事件的一切</h2><div class="nv l"><h3 class="bd b fi z dy nm ea eb nn ed ef dx translated">待定内容是Android框架的重要组成部分，但大多数可用的开发人员资源都集中在…</h3></div><div class="no l"><p class="bd b fp z dy nm ea eb nn ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="ny l nr ns nt np nu ik nh"/></div></div></a></div></div><div class="ab cl mx my gp mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="hb hc hd he hf"><p id="7a4b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你有任何反馈，请给我回信，地址是<em class="mq">karishma.agr1996@gmail.com。非常感谢你的鼓掌帮助其他人找到这篇文章😃。</em></p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es nz"><img src="../Images/8ab18394d7b7572db8a392347888a3d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*9AGIfjZD-frmbWmn.gif"/></div></figure></div></div>    
</body>
</html>
<html>
<head>
<title>Optimizing Angular Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化角度应用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/optimizing-angular-applications-6161816d6f64?source=collection_archive---------5-----------------------#2021-02-20">https://medium.com/geekculture/optimizing-angular-applications-6161816d6f64?source=collection_archive---------5-----------------------#2021-02-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/ef635d79ae506fa196da9537ab26e3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqPZaFPCBO5H92q0BCNtHA.jpeg"/></div></div></figure><div class=""/><p id="6caa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，你可以找到一些可选的技巧，帮助你优化你的角度应用，我希望你在你的项目中受益。我们开始吧。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="ab3d" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">关键的CSS内联:</h1><p id="70f3" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">这是一个很酷的新功能。在构建过程中，Angular将解析CSS选择器，并尝试找到与呈现页面的匹配。因此Angular将决定该样式是否是关键路径的一部分，并将这些样式内联到HTML中。启用此功能将改善页面的第一次内容绘制指标。</p><p id="24b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以通过调整<code class="du kz la lb lc b">angular.json</code>文件中的<code class="du kz la lb lc b">optimization</code>浏览器构建器选项来启用关键的CSS内联:</p><pre class="ld le lf lg fd lh lc li lj aw lk bi"><span id="e87e" class="ll jw ht lc b fi lm ln l lo lp">"optimization": {<br/>    "styles": {<br/>        "minify": true,<br/>        "inlineCritical": true // enable critical css inlining<br/>    }</span><span id="77e1" class="ll jw ht lc b fi lq ln l lo lp">}</span></pre><p id="a3a2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你正在使用Angular Universal来SSR你的应用程序，并且想要启用关键的CSS内联，你需要在<code class="du kz la lb lc b">server.ts</code>中启用它</p><pre class="ld le lf lg fd lh lc li lj aw lk bi"><span id="48e8" class="ll jw ht lc b fi lm ln l lo lp">server.engine(‘html’, ngExpressEngine({<br/>    bootstrap: AppServerModule,<br/>    inlineCriticalCss: true<br/>}));</span></pre><h1 id="0bd6" class="jv jw ht bd jx jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks bi translated">字体内嵌</h1><p id="3203" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">这是另一种方式来改善<a class="ae ky" href="https://web.dev/first-contentful-paint/" rel="noopener ugc nofollow" target="_blank">第一个内容丰富的油漆</a>。如果你使用的是谷歌字体，你可以启用这个优化选项，angular会在index.html文件中嵌入谷歌字体。这将为您节省一个额外的请求，浏览器需要这样做，以获得和渲染字体。</p><p id="5b1b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您也可以从<code class="du kz la lb lc b">angular.json</code>文件中的<code class="du kz la lb lc b">optimization</code>浏览器构建器选项启用字体内嵌:</p><pre class="ld le lf lg fd lh lc li lj aw lk bi"><span id="6155" class="ll jw ht lc b fi lm ln l lo lp">"optimization": {<br/>    "fonts": {<br/>        "inline": <strong class="lc hu">true</strong>,// enable font inlining<br/>    }<br/>}</span></pre><p id="ed7a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在这里了解更多关于关键CSS内联和字体内联的信息<a class="ae ky" href="https://angular.io/guide/workspace-config#styles-optimization-options" rel="noopener ugc nofollow" target="_blank">https://angular . io/guide/workspace-config # styles-optimization-optimization-options</a>。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="ecd6" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用OnPush更改检测策略</h1><p id="3b93" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">这种策略防止angular在整个组件子树上运行变化检测，从而导致更快的执行。您可以通过如下方式更改<code class="du kz la lb lc b">changeDetection</code>属性，在组件配置元数据中启用OnPush更改检测:</p><pre class="ld le lf lg fd lh lc li lj aw lk bi"><span id="1097" class="ll jw ht lc b fi lm ln l lo lp">@Component({<br/>    selector: 'my-company',<br/>    templateUrl: './my-company.component.html',<br/>    styleUrls: ['./my-company.component.scss'],<br/>    changeDetection: ChangeDetectionStrategy.OnPush,<br/>})</span></pre><p id="03b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将停用该组件及其子指令的自动变更检测，但保留明确调用变更检测的可能性。在这种情况下，只有三种情况会检测到元件的角度变化:</p><ol class=""><li id="cd75" class="lw lx ht is b it iu ix iy jb ly jf lz jj ma jn mb mc md me bi translated">组件@输出引用之一已被更改。</li><li id="a0b3" class="lw lx ht is b it mf ix mg jb mh jf mi jj mj jn mb mc md me bi translated">组件或其子指令中的任何Dom事件。</li><li id="228a" class="lw lx ht is b it mf ix mg jb mh jf mi jj mj jn mb mc md me bi translated">明确触发变化检测。</li></ol><p id="3635" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，您可以找到两篇关于OnPush变更检测的详细文章:</p><p id="aee6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ky" href="https://netbasal.com/a-comprehensive-guide-to-angular-onpush-change-detection-strategy-5bac493074a4" rel="noopener ugc nofollow" target="_blank">https://net basal . com/a-comprehensive-guide-to-angular-on push-change-detection-strategy-5 BAC 493074 a4</a></p><p id="83d0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ky" href="https://blog.angular-university.io/onpush-change-detection-how-it-works/" rel="noopener ugc nofollow" target="_blank">https://blog . angular-university . io/on push-change-detection-how-it-works/</a></p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="f847" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用Angular Universal进行服务器端渲染</h1><p id="4d79" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">在<a class="ae ky" href="https://nichola.dev/user-experience-core-web-vitals-optimization-angular-universal/" rel="noopener ugc nofollow" target="_blank">的上一篇文章</a>中，我使用Angular Universal在服务器端呈现了一个示例web应用程序，以改善用户体验并提高核心Web生命体征分数。</p><p id="d443" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">默认情况下，角度应用程序在客户端呈现。换句话说，浏览器加载所有的应用程序javascript文件，引导应用程序，进行必要的API调用以获得要显示的数据，然后呈现最终的页面。Angular Universal将在服务器端执行应用程序，同时生成一个静态HTML，该HTML将被传递给客户端以直接呈现给用户。之后，浏览器将加载javascript文件，并在客户端重新整合应用程序。因此，应用程序的呈现速度会快得多，用户也能更早地看到呈现的页面。</p><p id="e184" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在这里找到关于如何启用和使用Angular Universal的全部细节<a class="ae ky" href="https://angular.io/guide/universal" rel="noopener ugc nofollow" target="_blank">https://angular.io/guide/universal</a></p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="4377" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用延迟加载</h1><h2 id="59ac" class="ll jw ht bd jx mk ml mm kb mn mo mp kf jb mq mr kj jf ms mt kn jj mu mv kr mw bi translated">模块延迟加载</h2><p id="7ad7" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">默认情况下，所有的Angular代码都打包发送给客户端。随着您不断向应用程序添加新功能，这个包的大小可能会增加。幸运的是Angular支持延迟加载部分应用程序的能力。这将改善应用程序的初始加载，因此<a class="ae ky" href="https://web.dev/first-contentful-paint/" rel="noopener ugc nofollow" target="_blank">最大内容绘制(LCP) </a>。同时Angular通过路由支持延迟加载。这意味着您可以延迟加载应用程序的一部分，只要它有一个单独的路由。</p><p id="d068" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以在官方角度文档<a class="ae ky" href="https://angular.io/guide/lazy-loading-ngmodules" rel="noopener ugc nofollow" target="_blank">https://angular.io/guide/lazy-loading-ngmodules</a>中找到更多关于如何惰性加载你的角度模块的细节</p><h2 id="affb" class="ll jw ht bd jx mk ml mm kb mn mo mp kf jb mq mr kj jf ms mt kn jj mu mv kr mw bi translated">组件延迟加载</h2><p id="fd2a" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">有了新的Ivy渲染器，现在可以延迟加载角度组件，这是一个很棒的特性。但是，这需要一些额外的手工工作来完成，尤其是当您的组件包含一些子指令或子组件时。</p><p id="9943" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里你可以找到一篇关于组件延迟加载如何工作的文章<a class="ae ky" href="https://johnpapa.net/angular-9-lazy-loading-components/" rel="noopener ugc nofollow" target="_blank">https://johnpapa.net/angular-9-lazy-loading-components/</a></p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="b3cb" class="jv jw ht bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用可用的工具</h1><p id="01af" class="pw-post-body-paragraph iq ir ht is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">最后，您可以使用许多工具来测量应用程序的性能，这是优化过程的第一步。这些工具中的许多还为您提供了如何修复应用程序中潜在问题的建议。这些工具中最重要的可能是:</p><ul class=""><li id="15c7" class="lw lx ht is b it iu ix iy jb ly jf lz jj ma jn mx mc md me bi translated"><a class="ae ky" href="https://developers.google.com/web/tools/lighthouse" rel="noopener ugc nofollow" target="_blank"> Lighthouse </a>:开源项目，附带chrome dev工具，目的是提高网页质量。</li><li id="db01" class="lw lx ht is b it mf ix mg jb mh jf mi jj mj jn mx mc md me bi translated"><a class="ae ky" href="https://developers.google.com/speed/pagespeed/insights/" rel="noopener ugc nofollow" target="_blank"> PageSpeed Insights </a>:一个在线工具，可以生成桌面和移动设备上页面的性能报告，并为您提供如何改进和修复现有问题的广泛建议。</li></ul></div></div>    
</body>
</html>
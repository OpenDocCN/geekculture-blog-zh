<html>
<head>
<title>Error Handling in Laravel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Laravel中的错误处理</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/error-handling-in-laravel-e5bb55a11f64?source=collection_archive---------1-----------------------#2022-08-09">https://medium.com/geekculture/error-handling-in-laravel-e5bb55a11f64?source=collection_archive---------1-----------------------#2022-08-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d74b3ce5716b7dc7b0312d3d84e71a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RY-pWTzNeMYOz9g3Rq9fVQ.png"/></div></div></figure><p id="f000" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你好，你们都好吗，我希望你们都健康和成功。这一次我们将讨论一个关于如何发现Laravel中出现的错误的教程。</p><p id="32a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Laravel在错误处理方面给了你很大的灵活性。我相信你会在本教程中学到一些新东西。您可以覆盖任何laravel状态代码模板。</p><p id="a798" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您还可以学习其他教程:</p><p id="a7a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://temanngoding.com/en/creating-ratings-and-reviews-with-laravel/" rel="noopener ugc nofollow" target="_blank">用Laravel创建评级和评论</a></p><p id="dcbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://temanngoding.com/en/drag-and-drop-image-file-upload-using-laravel/" rel="noopener ugc nofollow" target="_blank">使用Laravel拖放图像/文件上传</a></p><p id="9391" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://temanngoding.com/en/rest-api-login-register-with-sanctum-laravel/" rel="noopener ugc nofollow" target="_blank"> REST API登录&amp;向Sanctum Laravel注册</a></p><p id="1960" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Laravel中处理错误的一个主要特性是异常处理。Laravel带有一个内置的异常处理程序，允许您以一种简单友好的方式报告和创建异常。</p><p id="7de4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在默认设置中，异常处理程序提供的是通过handler类来了解laravel如何处理异常。我们将看到如何创建一个异常处理程序来创建自定义的异常。</p><h1 id="f496" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">HTTP响应代码和状态</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/573d76250a254ba756e089c0e647df74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*eoIjvnvQr9QiXmvGJLc87A.png"/></div></figure><p id="8fab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">代码状态描述2000确定请求已成功完成。201创建新资源已成功创建。400错误请求请求无效。401未授权无效登录凭据。403禁止您没有足够的权限执行此操作。404未找到请求的资源/页面未找到。405不允许的方法此请求不受资源支持。409冲突由于冲突而无法完成请求。500内部服务器错误由于上的内部错误，请求未完成</p><p id="97c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您必须遵循上述文件结构，否则您将无法替换上述错误页面。要在视图文件中获得错误消息，您可以在刀片视图中使用以下变量:</p><blockquote class="ks kt ku"><p id="3e31" class="iq ir kv is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hb bi translated">404.blade.php</p><p id="a7c3" class="iq ir kv is b it iu iv iw ix iy iz ja kw jc jd je kx jg jh ji ky jk jl jm jn hb bi translated">{{ $exception-&gt;getMessage() }}</p></blockquote><h1 id="678d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">安装Laravel</h1><p id="79e7" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">启动应用程序的第一件事是，我们必须先安装laravel。</p><pre class="ko kp kq kr fd le lf lg lh aw li bi"><span id="93ac" class="lj jq hi lf b fi lk ll l lm ln">composer create-project laravel/laravel handling-laravel</span></pre><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/5f6b84953bb1e49cc2a3b59fee06bc68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/0*1JOadY1pfZUwPjYH.png"/></div></figure><p id="2ddb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">配置属性设置</p><p id="8994" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们安装了laravel之后，这次我们可以在config/app.php中设置我们的配置文件。</p><p id="9baf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果设置为<code class="du lp lq lr lf b">TRUE</code>，将有助于您调试应用程序产生的错误。该变量的默认值被设置为文件<code class="du lp lq lr lf b">.env</code>中环境变量<code class="du lp lq lr lf b">APP_DEBUG</code>的值</p><p id="1d3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开发环境中，您应该将它设置为<code class="du lp lq lr lf b">TRUE</code>，这样您就可以轻松地跟踪错误并修复它们。另一方面，您应该在生产环境中关闭它，在这种情况下，它将显示一个常规错误页面。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/472cc1d34c46944b42410febad3e2261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/0*T0ReOMcEskW9R3BA.png"/></div></figure><p id="67c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">标准日志文件位于<code class="du lp lq lr lf b">storage/logs/laravel.log</code>，在大多数情况下已经足够。另一方面，<code class="du lp lq lr lf b">APP_LOG_LEVEL</code>被设置为指示要记录的错误的严重性的值。</p><h1 id="61ca" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">亨德勒设置</h1><p id="7f2f" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">接下来，我们将看看默认Laravel应用程序附带的默认处理程序类。继续打开<code class="du lp lq lr lf b">app/Exceptions/Handler.php</code>文件。</p><p id="9ef3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你们想为自定义错误创建自定义响应或视图，可以在laravel中完成。你需要做的是修改App\Exceptions\Handler类。</p><pre class="ko kp kq kr fd le lf lg lh aw li bi"><span id="9dfb" class="lj jq hi lf b fi lk ll l lm ln">&lt;?php</span><span id="bb28" class="lj jq hi lf b fi lt ll l lm ln">namespace App\Exceptions;</span><span id="bea4" class="lj jq hi lf b fi lt ll l lm ln">use Illuminate\Foundation\Exceptions\Handler as ExceptionHandler;<br/>use Illuminate\Database\Eloquent\ModelNotFoundException;<br/>use Illuminate\Http\JsonResponse;<br/>use Illuminate\Http\Response;<br/>use Illuminate\Http\Request;<br/>use Throwable;</span><span id="b556" class="lj jq hi lf b fi lt ll l lm ln"><em class="kv">class</em> Handler extends ExceptionHandler<br/>{<br/>    /**<br/>     * A list of the exception types that are not reported.<br/>     *<br/>     * @var array<br/>     */<br/>    protected $dontReport = [<br/>        //<br/>    ];</span><span id="b374" class="lj jq hi lf b fi lt ll l lm ln">    /**<br/>     * A list of the inputs that are never flashed for validation exceptions.<br/>     *<br/>     * @var array<br/>     */<br/>    protected $dontFlash = [<br/>        'current_password',<br/>        'password',<br/>        'password_confirmation',<br/>    ];</span><span id="914b" class="lj jq hi lf b fi lt ll l lm ln">    /**<br/>     * Register the exception handling callbacks for the application.<br/>     *<br/>     * @return void<br/>     */<br/>    public <em class="kv">function</em> register()<br/>    {<br/>        $this-&gt;reportable(<em class="kv">function</em> (Throwable $e) {<br/>            return false;<br/>        });<br/>    }</span><span id="819d" class="lj jq hi lf b fi lt ll l lm ln">    /**<br/>     * @param Request $request<br/>     * @param Throwable $e<br/>     * @return JsonResponse|Response|\Symfony\Component\HttpFoundation\Response<br/>     * @throws Throwable<br/>     */<br/>    public <em class="kv">function</em> render($request, Throwable $e)<br/>    {<br/>        if ($request-&gt;is('api/*')) {<br/>            return response()-&gt;json([<br/>                'message' =&gt; 'Record not found.'<br/>            ], 404);<br/>        }</span><span id="c67a" class="lj jq hi lf b fi lt ll l lm ln">        return parent::render($request, $e);<br/>    }<br/>}</span></pre><p id="be72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你们可以在这里添加一些其他的定制逻辑来满足你们的排除需求。</p><h1 id="ec4b" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">使用寄存器方法的错误处理</h1><p id="2049" class="pw-post-body-paragraph iq ir hi is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hb bi translated">还可以在App\Exceptions\Handler类中使用laravel register方法呈现不同的错误页面。让我们举一个例子，让我们创建一个新的异常类，当订单在我们的应用程序中失败时将调用它。</p><p id="d171" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要生成新的异常类，请执行以下命令:</p><pre class="ko kp kq kr fd le lf lg lh aw li bi"><span id="bbe5" class="lj jq hi lf b fi lk ll l lm ln">php artisan make:exception InvalidOrderException</span></pre><p id="8ae5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述命令将在app/Exceptions文件夹下创建一个名为InvalidOrderException.php的文件。我们不需要这个文件，只需要修改一下就可以了:</p><pre class="ko kp kq kr fd le lf lg lh aw li bi"><span id="e4eb" class="lj jq hi lf b fi lk ll l lm ln">&lt;?php</span><span id="9c8b" class="lj jq hi lf b fi lt ll l lm ln">namespace App\Exceptions;</span><span id="91b3" class="lj jq hi lf b fi lt ll l lm ln">use Exception;</span><span id="a042" class="lj jq hi lf b fi lt ll l lm ln"><em class="kv">class</em> InvalidOrderException extends Exception<br/>{<br/>    /**<br/>     * Get the exception's context information.<br/>     *<br/>     * @return array<br/>     */<br/>    public <em class="kv">function</em> context(): array<br/>    {<br/>        return ['order_id' =&gt; 123];<br/>    }<br/>}</span></pre><p id="4bed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们修改App\Exceptions\Handler类，如下所示:</p><pre class="ko kp kq kr fd le lf lg lh aw li bi"><span id="c3de" class="lj jq hi lf b fi lk ll l lm ln">&lt;?php</span><span id="fd95" class="lj jq hi lf b fi lt ll l lm ln">namespace App\Exceptions;</span><span id="6832" class="lj jq hi lf b fi lt ll l lm ln">use Illuminate\Foundation\Exceptions\Handler as ExceptionHandler;<br/>use Illuminate\Http\JsonResponse;<br/>use Illuminate\Http\Response;<br/>use Illuminate\Http\Request;<br/>use Throwable;</span><span id="77a8" class="lj jq hi lf b fi lt ll l lm ln"><em class="kv">class</em> Handler extends ExceptionHandler<br/>{<br/>    /**<br/>     * A list of the exception types that are not reported.<br/>     *<br/>     * @var array<br/>     */<br/>    protected $dontReport = [<br/>        //<br/>    ];</span><span id="f29c" class="lj jq hi lf b fi lt ll l lm ln">    /**<br/>     * A list of the inputs that are never flashed for validation exceptions.<br/>     *<br/>     * @var array<br/>     */<br/>    protected $dontFlash = [<br/>        'current_password',<br/>        'password',<br/>        'password_confirmation',<br/>    ];</span><span id="3e50" class="lj jq hi lf b fi lt ll l lm ln">    /**<br/>     * Register the exception handling callbacks for the application.<br/>     *<br/>     * @return void<br/>     */<br/>    public <em class="kv">function</em> register()<br/>    {<br/>        $this-&gt;renderable(<em class="kv">function</em> (InvalidOrderException $e, $request) {<br/>            return response()-&gt;view('errors.invalid-order', [], 500);<br/>        });<br/>    }<br/>}</span></pre><p id="6312" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在app/resources/views/errors文件夹下创建一个名为invalid-order.php的文件，并根据需要修改文件内容。</p><p id="b2bb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，这次教程我螺栓。可能有用。</p><p id="bf07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢了。</p></div></div>    
</body>
</html>
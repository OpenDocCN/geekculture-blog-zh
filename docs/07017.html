<html>
<head>
<title>Vector Auto-Regressive (VAR) Models for Multivariate Time Series Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元时间序列预测的向量自回归模型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/vector-auto-regressive-var-models-for-multivariate-time-series-forecasting-106bb6f74add?source=collection_archive---------4-----------------------#2021-09-05">https://medium.com/geekculture/vector-auto-regressive-var-models-for-multivariate-time-series-forecasting-106bb6f74add?source=collection_archive---------4-----------------------#2021-09-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2e1b8a830a72a22e714a629ce24d75e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ld_9Cuphta9MuaSK71gZmQ.gif"/></div></div></figure><p id="71cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">向量自回归(VAR)模型是分析多元时间序列最成功、最灵活、最易于使用的模型之一。它是单变量自回归模型到动态多变量时间序列的自然延伸。事实证明，风险值模型对于描述经济和金融时间序列的动态行为以及预测特别有用。它通常提供优于单变量时间序列模型和基于理论的复杂联立方程模型的预测。风险值模型的预测非常灵活，因为它们可以以模型中特定变量的潜在未来路径为条件。</p><p id="172d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了数据描述和预测，VAR模型还用于结构推断和政策分析。在结构分析中，对被调查数据的因果结构进行了某些假设，并总结了对特定变量的意外冲击或创新对模型中变量的因果影响。这些因果影响通常用脉冲响应函数和预测误差方差分解来概括。</p><p id="11e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文假设我们已经了解基本的时间序列模型，如ARMA、ARIMA、SARIMAX等。</p><h1 id="25a6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">介绍</h1><p id="f3db" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">向量自回归(VAR)是一种预测算法，当两个或多个时间序列相互影响时，可以使用<strong class="is hj">，即所涉及的时间序列之间的关系是<strong class="is hj">双向</strong>。它被认为是一个自回归模型，因为每个变量(时间序列)都被建模为过去值的函数，也就是说，预测值只不过是序列的滞后(时间延迟值)。</strong></p><p id="962c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其他自回归模型，如AR、ARMA或ARIMA模型是单向的，其中预测因子影响Y，而不是相反。向量自回归(VAR)模型是双向的，即变量相互影响。</p><h1 id="22e6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">风险值模型的类型</h1><p id="286f" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">有三大类型的风险值模型，简化形式，递归形式，和结构风险值模型。</p><ol class=""><li id="fde2" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated"><strong class="is hj">简化形式的风险值模型:</strong>这些模型认为每个变量都是其自身过去值的函数，所有其他变量的过去值都被考虑在内，还有一个序列不相关的误差项。在这些模型中，误差项将与方程相关。这意味着我们不能考虑个别冲击会对系统产生什么影响。</li><li id="d631" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">递归VAR模型:</strong>这些模型包含了简化形式模型的所有组成部分，但也允许一些变量是其他并发变量的函数。通过强加这些短期关系，递归模型允许我们对结构性冲击进行建模。递归VAR将每个回归方程中的误差项构造为与前面方程中的误差不相关的<br/>。这是通过明智地将一些同期值作为回归量来实现的。</li><li id="3fdd" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">结构风险值模型:</strong>这些模型包括一些限制条件，允许我们识别简化形式或递归模型无法识别的因果关系。这些因果关系可用于模拟和预测个别冲击的影响，如政策决定。</li></ol><h1 id="fdaa" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">定义模型</h1><p id="8487" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">基本上，VAR模型意味着<em class="jo">一切都依赖于一切</em>。VAR模型可以定义为:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/bb89a1821c9d90efb5d05d5d50cdc30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*lIORUh98sl_97JaloMe8PQ.png"/></div><figcaption class="ll lm et er es ln lo bd b be z dx">where t = 1,2,…..,T</figcaption></figure><p id="8170" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">假设:</strong></p><ul class=""><li id="4675" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">yt:平稳K变量向量</li><li id="cce6" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">v: K常数参数向量</li><li id="a1ef" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">Aj: K乘K参数矩阵，j=1，…，p</li><li id="7083" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">ut: i.i.d.(0，适马)</li><li id="b383" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">可以包括趋势:delta(t)，其中delta是K乘1</li><li id="33a4" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">可以添加外部变量X</li></ul><p id="9c8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在给定一些假设的情况下，可以使用普通最小二乘法来估计该方程:</p><ul class=""><li id="52d1" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">误差项的条件均值为零。</li><li id="3bc0" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">模型中的变量是稳定的。</li><li id="74c7" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">不太可能出现大的异常值。</li><li id="c0a9" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">没有完美的多重共线性。</li></ul><p id="decd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这些假设下，普通最小二乘法估计:</p><ul class=""><li id="d293" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">会始终如一。</li><li id="dc94" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">可以使用传统的t统计和p值进行评估。</li><li id="1d85" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">可用于联合测试多个等式的限制。</li></ul><p id="5cf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">VAR模型是由一个代表多个变量之间关系的方程组组成的。当提到风险值模型时，我们经常使用特殊的语言来说明:</p><ul class=""><li id="3b89" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">内生变量的数量。</li><li id="8cca" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">自回归项的数目。</li></ul><p id="6c8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如，如果我们有两个内生变量和自回归项，我们说该模型是一个双变量VAR(2)模型。如果我们有三个内生变量和四个自回归项，我们说这个模型是一个三元VAR(4)模型。通常，VAR模型由n个方程(代表n个内生变量)组成，并包括变量的p滞后。</p><h1 id="f48d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">滞后选择</h1><p id="d3b9" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">滞后选择是VAR模型规范的重要方面之一。在实际应用中，我们一般选择一个最大滞后数p(max)，并评估模型的性能，包括p = 0，1，…。，p(最大值)。最优模型是模型VAR(p ),它使一些滞后选择标准最小化。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/1028414692d3eb9516b2a906e3fc2a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*kTcrLyUYz6UeB-tz-lsh0Q.png"/></div></figure><p id="18dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其中:</p><ul class=""><li id="c9c1" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">Yt = (y1t，y2t，…..ynt)是时间序列变量的(n * 1)向量</li><li id="904c" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">a =截距的(n * 1)个向量</li><li id="bd06" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">Ai (i=1，2，…，p) = (n * n)系数矩阵</li><li id="c012" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">Ei =不可观察的i.i.d .零均值误差项(白噪声)的(n * 1)向量</li></ul><p id="d3e0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最常用的滞后选择标准是:</p><ul class=""><li id="3d03" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">赤池(AIC)</li><li id="9f06" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">施瓦兹-贝叶斯(BIC)</li><li id="9f20" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">汉南-奎因公司(总部)</li><li id="2513" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">最终预测误差(FPE)</li><li id="d13c" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">以上平均值</li></ul><p id="6ea0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些方法通常被内置到库中，而标签选择现在几乎完全自动化了。</p><h1 id="bcd6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">变量选择、预测和评估</h1><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/872ee6f6597e144a21edc312776d1800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0pBvvlDQBEOzAlhTNPy5uA.gif"/></div></div></figure><p id="089b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">内生变量的预测相关性可以用格兰杰因果检验、沃尔德检验等进行检验。如果你有两个以上的变量，你应该考虑使用VAR进行多变量格兰杰因果检验。你还应该考虑变量是稳定的还是不稳定的。如果变量是平稳的，你可以在平稳的VAR中应用格兰杰因果检验。如果变量是非平稳的，也不是协整的，你可以对变量进行差分，并在差分变量的平稳VAR中应用格兰杰因果检验。如果变量是非平稳的，并且是协整的，那么可以在VECM(包含短期和长期成分)中应用格兰杰因果检验，该VECM通过协整或差分转换假设所有数据都是平稳的。如果没有协整，可以排除误差修正项，并通过平稳VAR中的Wald检验进行检验。或者，你可以使用Toda和Yamamoto (1995)使用非平稳数据的剩余滞后格兰杰因果检验。</p><p id="bbe9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">VAR模型最重要的功能之一是生成预测。使用迭代预测算法为风险值模型生成预测:</p><ul class=""><li id="d5ba" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">使用每个方程的OLS估计风险值模型。</li><li id="f2ae" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">计算所有变量的提前一期预测。</li><li id="efb4" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">使用一期提前预测计算两期提前预测。</li><li id="0db1" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">迭代直到计算出h步预测。</li></ul><p id="7ac0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通常我们对VAR模型预测的动态比估计的实际系数更感兴趣。因此，最常见的风险值研究报告是:</p><ul class=""><li id="85fa" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">格兰杰因果统计。</li><li id="7d2c" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">脉冲响应函数。</li><li id="c25c" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">预测误差分解</li></ul><h1 id="78c0" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">SAS中的实施</h1><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/986f0c651f1d334629521357d9d1b7fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKWNiWcRMTTIXnpMUksjvw.png"/></div></div></figure><p id="59b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们以DJIA指数和总市值为例，看看风险值在SAS中是如何工作的。</p><ul class=""><li id="b5bf" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">可检验的假设:DJIA指数必须依赖于自身的滞后和总市值的滞后，反之亦然。</li><li id="f990" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">使用DJIA回报率指数和市值回报率</li><li id="0e08" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">每月观察</li></ul><p id="5657" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集和实现如下所示:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/0cddbbd0da77f5d7ce2453b1dc0f520d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4m1SPE4_v2GzZb1YUnoBpw.png"/></div></div></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/42830c5f6dc514c06e3b293ae5c017dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*usUlgVsmbeEj_Cqt5HC2pg.png"/></div></div></figure><p id="e912" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">关于python中的实现，请参考官方文档<a class="ae lv" href="https://www.statsmodels.org/dev/vector_ar.html" rel="noopener ugc nofollow" target="_blank">stats models . TSA . vector _ ar</a>。</p><h1 id="6d16" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">批评和有用性</h1><p id="72b6" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">var面临的一个批评是，他们是理论上的；也就是说，它们不是建立在某种经济理论之上的，这种理论将理论结构强加于方程式之上。假设系统中的每个变量都影响其他变量，这使得直接解释估计的系数变得困难。尽管如此，风险值模型在几种情况下是有用的:</p><ul class=""><li id="332a" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn lp ky kz la bi translated">预测一组不需要明确解释的相关变量；</li><li id="f0bc" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">测试一个变量在预测另一个变量时是否有用(格兰杰因果检验的基础)；</li><li id="1eff" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">脉冲响应分析，分析一个变量对另一个变量的突然但暂时的变化的响应；</li><li id="b688" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn lp ky kz la bi translated">预测误差方差分解，其中每个变量的预测方差的比例归因于其他变量的影响。</li></ul><p id="c44f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望这篇文章能让您对这种处理多变量时间序列数据的先进而有用的技术有所了解。我期待着你的宝贵反馈/意见，因为它有助于我更好地计划和研究我的文章。请随意评论你想让我写的关于机器学习的任何话题。</p><p id="5072" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读！注意安全！</p><p id="b34b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">参考:<br/></em><a class="ae lv" href="http://www.aptech.com" rel="noopener ugc nofollow" target="_blank">【www.aptech.com】</a></p></div></div>    
</body>
</html>
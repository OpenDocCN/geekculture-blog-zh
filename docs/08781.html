<html>
<head>
<title>Introduction to AutoML using PyCaret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyCaret的AutoML简介</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/introduction-to-automl-using-pycaret-3c9d4f83aaae?source=collection_archive---------5-----------------------#2021-11-14">https://medium.com/geekculture/introduction-to-automl-using-pycaret-3c9d4f83aaae?source=collection_archive---------5-----------------------#2021-11-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1be4" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Python中自学模型的世界之旅</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/a34f3bcb2590cd266b75fad5856e1696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lszWcP67bOR-x4bD2Efb-g.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://www.pexels.com/@pavel-danilyuk?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pavel Danilyuk</a> from <a class="ae jn" href="https://www.pexels.com/photo/black-and-silver-video-camera-on-brown-wooden-table-8438868/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><h1 id="d871" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">1.为什么是AutoML？</h1><p id="1ec8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">曾几何时，自动训练的机器学习模型是数据科学家的梦想。数据科学家的典型工作是识别—理解—获取—分析—准备—培训—评估—传达。但是他们的大部分时间将只花在准备、训练和评估阶段。有时它可能是一个无限的while循环！</p><p id="6bd6" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">随着越来越多的企业转向机器学习来解决他们的关键问题，数据科学家被期望在更短的时间内提供结果。这就产生了将数据科学项目中的关键步骤自动化的需求，以便数据科学家可以专注于实际问题，而不是编写数百行代码来寻找最佳模型。然后出现了一个流行词，镇上的谈论。</p><h1 id="2b56" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">2.如何做到这一点？</h1><p id="e3ce" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">近年来，许多AutoML软件包开始出现，有些甚至是由所谓的<strong class="ki hj">MAGNA</strong>(Meta-Apple-Google-网飞Amazon)公司开发的，并作为其云服务的一部分提供，如Google的Cloud AutoML。</p><p id="bbfc" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">一些开源软件有:AutoWEKA，Auto-sklearn，Auto-PyTorch，PyCaret，H2O AutoML等等。，我们将在这篇博客中研究它的PyCaret实现。</p><p id="b0d0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><strong class="ki hj"> PyCaret </strong>是一个开源、低代码的机器学习库，帮助数据科学家自动化他们的机器学习工作流程。它简化了模型实验阶段，从而允许他们用最少的代码获得想要的结果。</p><blockquote class="lh li lj"><p id="b8f9" class="kg kh lk ki b kj lc ij kl km ld im ko ll le kr ks lm lf kv kw ln lg kz la lb hb bi translated"><strong class="ki hj">注意:</strong>我假设PyCaret已经安装在您的机器上。你可以通过这个命令安装<strong class="ki hj"><em class="hi">pip install py caret</em></strong></p></blockquote><p id="3d55" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我将使用PyCaret提供的样本数据集向您展示这个过程。这是一个分类问题，我们将预测客户是否会违约。您可以使用get_data()函数导入数据</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="eff5" class="lt jp hi lp b fi lu lv l lw lx">from pycaret.datasets import get_data</span><span id="3868" class="lt jp hi lp b fi ly lv l lw lx"># Import the data<br/>df = get_data("credit")</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lz"><img src="../Images/ed72f69dc5155b7c7efb8e0a89b0457b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkRjDketHxutj8s7EpWkqQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">PyCaret displaying the head of the loaded dataset automatically</figcaption></figure><p id="3eaa" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们可以检查数据集的形状，并将数据分为知识(将从中获得训练、验证和测试集)和有效载荷数据集。</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="61c2" class="lt jp hi lp b fi lu lv l lw lx"># Prints the shape of the dataframe<br/>df.shape</span><span id="2ffc" class="lt jp hi lp b fi ly lv l lw lx"># Preparing Knowledge set<br/>knowledge = df.sample(frac=.8, random_state=seed)<br/>knowledge.reset_index(inplace=True, drop=True)<br/>knowledge.shape</span><span id="1730" class="lt jp hi lp b fi ly lv l lw lx"># Preparing Payload set<br/>payload = df.drop(knowledge.index)<br/>payload.reset_index(inplace=True, drop=True)<br/>payload.shape</span></pre><p id="e09c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">PyCaret包括多种分类问题的算法。我们可以通过进口来利用它们。</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="ed0d" class="lt jp hi lp b fi lu lv l lw lx">from pycaret.classification import *</span></pre><p id="d9fe" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">接下来，我们需要初始化环境和转换管道。这可以在setup()函数的帮助下完成。该函数负责所有的预处理步骤，以便根据需要准备数据。我们也可以通过在调用时指定缺省参数来手动覆盖它们。我们只需要传递数据集和目标列，其他所有参数都是可选的。</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="f0df" class="lt jp hi lp b fi lu lv l lw lx">clf = setup(data=knowledge, target="default", session_id=123)</span></pre><p id="d6ce" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在笔记本中执行此操作后，系统会提示我们指定检测到的列数据类型是否正确。按回车键确认，PyCaret将显示以下一组信息。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/1250ef6174affd5d5285c8725b124b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*qqdt2bC2KedoVvdPBuSYBQ.png"/></div></figure><p id="deae" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">现在，我们可以使用compare_models()函数比较不同模型在我们的训练集上的表现</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="ec45" class="lt jp hi lp b fi lu lv l lw lx">best_model = compare_models(fold=3)</span></pre><p id="4fae" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">下表显示了不同模型在我们的数据集中的表现，默认情况下根据准确性进行排序。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mb"><img src="../Images/6ca8becb014a7896431f14d184b7123c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*X7k8EPjqbdOKcJKUsz5UHw.png"/></div></figure><p id="b658" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">我们可以使用plot_model()函数来可视化模型性能</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="c740" class="lt jp hi lp b fi lu lv l lw lx">plot_model(best_model, plot="auc")</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/5f56f3ed2dce1d699420fb794c540cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*fCRVZmTkomuKx1PI0HOuJg.png"/></div></figure><p id="d0b2" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">借助tune_model()，我们可以轻松地执行超参数调优</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="480f" class="lt jp hi lp b fi lu lv l lw lx">tuned = tune_model(best_model)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es md"><img src="../Images/4f71a879bb3f69643514e6d3d44a7912.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*AGlIXG9jBXK0Dgig4L1QBg.png"/></div></figure><p id="0e57" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">一旦我们对模型满意了，我们就可以使用该模型来预测有效负载数据，以了解它如何使用predict_model()函数来预测看不见的数据</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="dab5" class="lt jp hi lp b fi lu lv l lw lx">predictions = predict_model(final_model, data=payload)</span></pre><p id="1b69" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">PyCaret还允许我们以. pkl文件的形式保存模型，这样就可以进一步部署它以服务于生产管道。</p><pre class="iy iz ja jb fd lo lp lq lr aw ls bi"><span id="aa51" class="lt jp hi lp b fi lu lv l lw lx">save_model(final_model,'Tuned Model 13 Nov 2021')</span></pre><p id="f421" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">正如我们可以看到的，我们用非常少的代码对数据进行了预处理，用超过15种算法进行了实验，并生成了我们的模型工件，可以部署这些工件以服务于实时预测。这就是使用PyCaret进行数据科学项目是多么容易。PyCaret还允许我们执行先进的技术，如装袋，增压和堆叠各自的功能。</p><h1 id="d9e9" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">完整代码</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="me mf l"/></div></figure><h1 id="7311" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">3.它带来了什么？</h1><p id="e9a9" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><strong class="ki hj"> AutoML </strong>通过自动训练和调整模型来简化数据科学家的任务，以便根据提供给它的数据实现最佳准确性。这乍一看似乎很神奇，但它所做的只是使用不同的算法训练不同的模型，并使用网格搜索调整参数。对于一个懒惰的数据科学家来说，这绝对是梦想成真的时刻。</p><p id="ecfc" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">AutoML仍然需要很多改进，但它绝对是机器学习领域的一个进步。作为it数据的结果，科学家可以专注于带来高质量的数据来解决问题。一天结束时，你花在获取高质量数据上的时间越多，你需要从中创建最佳模型的时间就越少！</p><h1 id="daee" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">参考</h1><p id="9fd9" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><a class="ae jn" href="https://pycaret.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> PyCaret — pycaret 2.2.0文档</a></p><p id="b741" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" href="https://pycaret.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">安装— pycaret 2.2.0文档</a></p><p id="92c5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" href="https://www.forbes.com/sites/janakirammsv/2018/04/15/why-automl-is-set-to-become-the-future-of-artificial-intelligence/?sh=56e16d99780a" rel="noopener ugc nofollow" target="_blank">为什么AutoML将成为人工智能的未来</a></p><p id="46b4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated"><a class="ae jn" href="https://www.cmswire.com/digital-workplace/why-automl-is-emerging-as-a-key-digital-workplace-technology/" rel="noopener ugc nofollow" target="_blank">AutoML如何帮助创建机器学习模型</a></p></div></div>    
</body>
</html>
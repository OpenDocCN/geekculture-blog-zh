<html>
<head>
<title>Classification Model Performance Evaluation using AUC-ROC and CAP Curves</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AUC-ROC和CAP曲线的分类模型性能评估</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/classification-model-performance-evaluation-using-auc-roc-and-cap-curves-66a1b3fc0480?source=collection_archive---------7-----------------------#2021-07-05">https://medium.com/geekculture/classification-model-performance-evaluation-using-auc-roc-and-cap-curves-66a1b3fc0480?source=collection_archive---------7-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/60b664fa2338627d55fd7d40d46a74d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DN72jvehyA1pKFyz.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Classification Model Performance Evaluation (Image courtesy: <a class="ae hv" href="https://bit.ly/36b7Lf2" rel="noopener ugc nofollow" target="_blank">https://bit.ly/36b7Lf2</a>)</figcaption></figure><div class=""/><p id="6fae" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated">性能测量是任何机器学习项目的一项基本任务，检查我们的模型好坏非常重要。在回归模型中，我们使用R平方(R)和均方根误差(RMSE)。在分类模型的情况下，当我们需要评估或说明多类分类问题的表现时，我们可以依赖AUC-ROC曲线或CAP曲线。</p><p id="0f3e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">什么是AUC-ROC曲线？<br/> </strong> AUC <em class="kc">(曲线下面积)</em> ROC <em class="kc">(受试者操作特征)</em>曲线，也称为AUROC <em class="kc">(受试者操作特征下面积)</em>是对各种阈值水平下分类问题的性能度量。它是评估二分类问题性能的最重要的评估方法之一。<br/> ROC是绘制TPR ( <em class="kc">真阳性率</em>)对FPR ( <em class="kc">假阳性率</em>)的概率曲线。AUC是可分性的度量，它显示了我们的模型在多大程度上能够区分类别。<br/>AUC表示模型区分阳性和阴性类别的程度。AUC越大越好。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kd"><img src="../Images/aa4d4c5d17c3ae4686e83889ccbefb85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7wxQ1ZymPqM-nj0ZCF1KHA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">AUC-ROC Curve</figcaption></figure><p id="111c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">什么是CAP曲线？<br/></strong>CAP(<em class="kc">累积精度剖面</em>)曲线是对分类问题的一种性能度量。它用于通过将当前曲线与'<em class="kc">完美</em>或<em class="kc"> </em> ' <em class="kc">理想</em>曲线和'<em class="kc">随机</em>曲线进行比较来评估模型。<br/>一个体面或优秀的模特会有一顶在完美和随机曲线中间的帽子。模型越接近完美的帽子越好。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kd"><img src="../Images/fa2ffbde8e278426ed9ea46042e36574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1MsGU9XT35XcPyyz1OJ6WQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">CAP Curve</figcaption></figure><p id="92de" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用CAP曲线分析性能有两种方法:</p><ul class=""><li id="ef9c" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">曲线下面积:我们通过计算完美模型和随机模型下的面积(aP)，计算预测模型和随机模型下的面积(aR)来计算准确率(AR)。<br/>准确率(AR)= AR/aP<br/>AR越高，即越接近1，模型越好。</li></ul><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kd"><img src="../Images/dbd97824e1447da22f6cfbdff919e728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MTxNjfilxZpcbS5nueFyug.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Area under the perfect model and random model (aP)</figcaption></figure><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kd"><img src="../Images/176a2d2feacf2225c34e0c70a8d32fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3pqWPt9_YZ9UKP2gSj3AA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Area under the good model and random model (aR)</figcaption></figure><ul class=""><li id="2554" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">绘图:我们从x轴的50%处画一条垂直线，直到它与'<em class="kc">好模型</em>'线相交，从该交点画一条水平线，直到y轴。现在这个与y轴相交的点是，如果你选择50%的人口，你会发现多少积极的结果。</li></ul><figure class="ke kf kg kh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kd"><img src="../Images/35a4be0007281704e87d0c2a87fe9618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWOvvrbn_huZhT3QyF_POg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Plot method to assess the performance</figcaption></figure><p id="0244" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">只需查看该图，您就可以根据X%值评估模型的性能。</p><ol class=""><li id="1257" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kr ko kp kq bi translated">X &lt; 60% →垃圾</li><li id="8380" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kr ko kp kq bi translated">60% &lt; X &lt; 70% →差/一般</li><li id="55c5" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kr ko kp kq bi translated">70% &lt; X &lt;80% →好</li><li id="72ad" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kr ko kp kq bi translated">80% &lt; X &lt; 90% →非常好</li><li id="a5f8" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kr ko kp kq bi translated">90% &lt; X &lt; 100% →太好(在这种情况下，您应该非常小心过度拟合的可能性)</li></ol><p id="30be" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我将向您展示如何使用AUCROC曲线和CAP曲线来评估使用python的分类模型。</p><p id="e239" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">数据集<br/> </strong>我使用的是<a class="ae hv" href="https://www.kaggle.com/rakeshrau/social-network-ads?select=Social_Network_Ads.csv" rel="noopener ugc nofollow" target="_blank">社交_网络_广告</a>数据集，其中我只使用了三个特征，<em class="kc">年龄</em>、<em class="kc">估计销售额</em>和<em class="kc">购买</em>。输出标签是“0”和“1 ”,它们表示一个人a是否购买了该产品。<br/> 0 →未购买<br/> 1 →已购买<br/>我们的目标是预测是否有人会购买该产品。</p><figure class="ke kf kg kh fd hk er es paragraph-image"><div class="er es kx"><img src="../Images/60ecc58878ca0c0fac5f89db157fbf12.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*vMEmzeSVk_9VFhXOQ9_t0g.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">Complete Dataset</figcaption></figure><p id="f326" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">“<em class="kc">红色</em>点代表没有购买该产品的人，“<em class="kc">绿色</em>点代表已经购买该产品的人。</p><p id="3e8a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">分类<br/> </strong>我已经将数据集分成两组，75%的训练数据和25%的测试数据。我使用了<strong class="ix hz"> <em class="kc">逻辑回归</em> </strong>来训练和测试模型。该模型的准确率达到了89%<strong class="ix hz"><em class="kc"/></strong></p><figure class="ke kf kg kh fd hk er es paragraph-image"><div class="er es ky"><img src="../Images/430d535582dfd75120e5ff5de68ec649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*Zn6lo1p6GpImBxe7t1lw8A.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">Classification on test set</figcaption></figure><p id="e78a" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">绩效评估:</strong></p><ul class=""><li id="1491" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">AUROC : <br/>从<em class="kc"> sklearn.metrics </em>导入<em class="kc"> roc_curve </em>和<em class="kc"> auc </em>以创建ROC曲线并计算曲线下面积。<br/>首先，使用<em class="kc"> predict_proba计算预测的概率。</em>它将返回一个包含两列的numpy数组，第一列包含类0的概率，第二列包含类1的概率。因为我们必须衡量我们的模型区分正类和负类的能力，所以我使用了类1的概率来绘制ROC曲线。</li></ul><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="36c6" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kc"> roc_curve </em>将生成roc曲线并返回<em class="kc"> fpr </em>、<em class="kc"> tpr </em>和<em class="kc">阈值</em>。我们需要<em class="kc"> fpr </em>和<em class="kc"> tpr </em>来计算这个模型的曲线下面积，现在我们已经有了<em class="kc"> roc_curve </em>返回的面积。因此，我们可以使用<em class="kc"> fpr </em>和<em class="kc"> tpr </em>的值作为<em class="kc"> auc </em>函数的输入来计算曲线下的面积。现在我们绘制ROC曲线并分析我们模型的性能。</p><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="ke kf kg kh fd hk er es paragraph-image"><div class="er es lb"><img src="../Images/be0e70e2521e751add04f7a54d76a4fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*hu_JcSlZONIhaUw1tSjKSg.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">AUC → 95%</figcaption></figure><p id="93da" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">曲线下的面积是0.95 → 95%，很不可思议，说明我们的模型做得不错。</p><ul class=""><li id="ada4" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">CAP: <br/>首先计算测试数据中的总数据点(100)。然后计算测试数据中类别1的数据点的数量(32)，并且还计算测试数据中类别0的数据点的数量(68)。</li></ul><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="0dbc" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们开始绘制我们的CAP曲线。首先，我们基于类1的正确检测将线性增加的假设来创建随机模型。接下来我们绘制完美的模型。完美的模型是在与类中数据点数量相同的试验数量中检测所有类1数据点的模型。完美的模型需要正好32次试验来检测32个1级数据点。<br/>现在，我们最终绘制出<em class="kc">逻辑回归的结果。</em>如在AUROC曲线中，我们必须获得第1类的概率，并使用<em class="kc"> zip </em>函数将这些值与<em class="kc"> y_test </em>合并。<br/>为了计算y值，我们使用<em class="kc"> np.cumsum() </em>。<em class="kc"> np.cumsum() </em>通过将数组中所有以前的值与当前值相加，生成一个值数组。例如，考虑数组<em class="kc">【1，1，1，1，1】</em>。<em class="kc">【1，2，3，4，5】</em>将是<em class="kc"> np.cumsum() </em>函数的结果。此外，我们必须将<em class="kc"> 0 </em>追加到数组的起点<em class="kc"> (0，0) </em>。<em class="kc"> x值</em>将在<em class="kc"> 0 </em>到<em class="kc">总计+ 1 </em>的范围内。</p><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="ke kf kg kh fd hk er es paragraph-image"><div class="er es lc"><img src="../Images/439fe8f2b66547f3d80f78178de9c519.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*DZJ5pZNkwa0TJvRFTqq6bA.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">CAP curve</figcaption></figure><p id="7947" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们有两种使用CAP方法分析性能的方法:</p><ul class=""><li id="e19f" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">曲线下面积:首先我们必须使用<em class="kc"> auc </em>函数计算所有面积，然后使用这些值计算准确率。该比率为0.90，非常接近于1，表明我们的模型确实有效。</li></ul><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><ul class=""><li id="b2cd" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated">剧情:首先我们要找到总测试数据的50%的指标。然后，我们必须画一条垂直线，直到它与我们训练好的模型线相交，然后从那个交点画一条水平线，直到它与y轴相交。然后通过将观察到的1类值除以1类数据点的总数并乘以100来计算X%值。我们得到96.875%</li></ul><figure class="ke kf kg kh fd hk"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="ke kf kg kh fd hk er es paragraph-image"><div class="er es ld"><img src="../Images/f3c02fbdc87028cb5662607a3fed1ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*fLHXF4aWWSieRL4D5gjfuA.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">CAP curve using plot method</figcaption></figure><p id="2d14" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">CAP曲线给了我们96.875%，这意味着我们的模型太好了。它告诉我们，我们的模型太好了，无法区分积极和消极的类别。</p><p id="cd9f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">结论<br/> </strong>本文分享了关于性能度量和方法的简要理解，您可以使用这些度量和方法来分析您的分类模型的性能。您可以使用上述任何一种方法来衡量您的模型的性能。</p><p id="9132" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以在我的github存储库中找到从实现逻辑回归到性能评估的完整代码:</p><div class="hh hi ez fb hj le"><a href="https://github.com/RushiKanjaria/Logistic-Regression.git" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hz fi z dy lj ea eb lk ed ef hx bi translated">RushiKanjaria/逻辑回归</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">本笔记本向您介绍了如何使用逻辑回归对数据集进行分类。</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls hp le"/></div></div></a></div><p id="9e07" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">参考文献</strong></p><ul class=""><li id="3e18" class="ki kj hy ix b iy iz jc jd jg kk jk kl jo km js kn ko kp kq bi translated"><a class="ae hv" href="https://towardsdatascience.com/machine-learning-classifier-evaluation-using-roc-and-cap-curves-7db60fe6b716" rel="noopener" target="_blank">https://towards data science . com/machine-learning-classifier-evaluation-using-roc-and-cap-curves-7 db 60 Fe 6b 716</a></li><li id="ce34" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kn ko kp kq bi translated"><a class="ae hv" href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5" rel="noopener" target="_blank">https://towards data science . com/understanding-AUC-roc-curve-68b 2303 cc9 C5</a></li><li id="a581" class="ki kj hy ix b iy ks jc kt jg ku jk kv jo kw js kn ko kp kq bi translated">https://en.wikipedia.org/wiki/Cumulative_accuracy_profile<a class="ae hv" href="https://en.wikipedia.org/wiki/Cumulative_accuracy_profile" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="2b0c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您阅读本文！，希望你们今天都学到了新东西。</p></div></div>    
</body>
</html>
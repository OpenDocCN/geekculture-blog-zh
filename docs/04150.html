<html>
<head>
<title>React — Uncaught TypeError: destroy is not a function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React未捕获的类型错误:destroy不是函数</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/react-uncaught-typeerror-destroy-is-not-a-function-192738a6e79b?source=collection_archive---------5-----------------------#2021-06-22">https://medium.com/geekculture/react-uncaught-typeerror-destroy-is-not-a-function-192738a6e79b?source=collection_archive---------5-----------------------#2021-06-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/6b74633f5eece612bbbde88e0084a0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/0*rm7TJlkeGdJMSyQz"/></div></figure><p id="80d9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在React和React Native中试验useEffect挂钩时，我遇到了以下错误:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1b0b" class="jt ju hi jp b fi jv jw l jx jy">Uncaught TypeError: destroy is not a function</span></pre><p id="568c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我的应用程序无法运行。经过调试和四处查找，我找到了原因和解决方法。</p><p id="aab0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我的代码的简化版本如下所示:</p><figure class="jk jl jm jn fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="86ae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里的关键是“myFunction”是“async ”,以及我使用的快速箭头函数语法。</p><p id="b39e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上面的简单代码导致我的应用程序崩溃的原因是由于useEffect钩子、异步函数和快速箭头函数语法的工作方式。</p><p id="0c89" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">useEffect钩子的一个特性是清理功能。如果从useEffect钩子函数返回任何东西，它必须是一个清理函数。该函数将在组件卸载时运行。这可以认为大致相当于类组件中的componentWillUnmount生命周期方法。</p><p id="f4eb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在JavaScript中，标有“async”关键字的函数允许使用“await”功能，该功能允许开发人员暂停函数的执行，同时等待异步任务完成。异步函数也总是返回一个承诺；如果函数还没有返回一个，返回值会自动包装在一个承诺中。</p><p id="9b61" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，简写箭头函数语法允许开发人员省略函数体周围的花括号，这对简单的一行程序很有用。函数体的值自动成为arrow函数的返回值，不需要' return '关键字。这种功能称为隐式返回。</p><p id="452a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，这些花絮是如何聚在一起导致如此神秘的错误的呢？简单来说，myFunction的值，也就是一个承诺，变成了useEffect钩子中arrow函数的返回值。还记得useEffect钩子期望返回一个清理函数吗？承诺不是一种功能。所以React出错并产生错误。</p><p id="81bd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要修复您的应用程序，请更改useEffect arrow函数以添加花括号并删除隐式Return，如下所示:</p><figure class="jk jl jm jn fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="3188" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，useEffect钩子中的arrow函数返回' undefined ',这是可以接受的，并告诉React不需要清理函数。这将解决问题，但如果React在出现这种情况时给出一个更有用的错误消息就更好了！</p></div></div>    
</body>
</html>
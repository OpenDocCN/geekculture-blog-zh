<html>
<head>
<title>Abstract layouts with Higher Order Components (HOC) in React.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中具有高阶组件(HOC)的抽象布局。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/abstract-layouts-with-higher-order-components-hoc-in-react-da8379f18c9a?source=collection_archive---------7-----------------------#2021-10-17">https://medium.com/geekculture/abstract-layouts-with-higher-order-components-hoc-in-react-da8379f18c9a?source=collection_archive---------7-----------------------#2021-10-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2f17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去，很难创建一个布局一致的网站。如果你愿意，你需要在最好的情况下使用iframes，在最坏的情况下使用frameset。</p><p id="a553" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在那个时候，javascript是大多数人在网络上害怕的东西，几乎每个人都禁用了它(现在想想真是疯狂)。</p><p id="75aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是拥有布局的固定和动态部分的能力是web开发人员和web设计人员一直梦寐以求的。横向菜单是一种常见的设计模式，它让用户可以随时访问网站的各个部分，顶部栏显示网站名称是一种品牌选择，几乎每个人都遵循这种选择。</p><p id="c52f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，我们不再回到过去的日子了:javascript构成了90%的web，随之而来的是一系列被许多库和框架所利用的功能。</p><h1 id="8410" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">现代社会:做出反应</h1><p id="8305" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">如果你点击了这篇文章，你可能会知道React是一个javascript库，它让你以声明的方式指定你的设计:你描述你的设计就像你用HTML做的一样，但是你可以在其中加入javascript变量，React会神奇地将它呈现给你的DOM。</p><p id="c71a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是如何用react实现这种复合布局呢？</p><p id="1880" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">呈现给你:react-路由器。</p><p id="b4c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">react-router是react应用程序中处理路由的"<em class="kg">事实上的</em>"库。它会查看您所在页面的路径名，您可以通过编程方式指定哪个组件需要在特定时刻呈现。</p><p id="c75b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但那只是说说而已，让我们来看看例子。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/a2608eaf80adf6254f578419c87119f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpYDGdteDLpDsXv7mGTUhA.png"/></div></div></figure><p id="b011" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个简单的React应用程序…BrowserRouter是路由的提供者，交换机(两个组件都来自<em class="kg"> react-router-dom </em>库)负责检查我们在哪个路由上，并显示Home组件或About组件。</p><p id="de63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果不言自明:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/18b89507cbcead61a075b2ce0de86fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fh8Rmh2SExXlu6yY-ZS_kQ.png"/></div></div></figure><p id="508c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是这对我们的情况没有帮助。让我们创建一些导航组件和一个应用程序栏组件，让我们稍微改变一下这个应用程序。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es et"><img src="../Images/f9112605c5f2f9f88b5b2b96f732e80a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhxGJVDYiAkrl8iR8CQsCQ.png"/></div></div></figure><p id="d507" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导航只是一个带有链接(react-router-dom的a标签)组件的ul，它指向不同的页面。appbar只是一个名为out fabolous webapp的div。所有东西都被包装在一个容器中，这个容器用grid定位这些元素，这里我们有一个通用的webapp布局:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/223a21649a6b6a51fc6a26cfed755703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5VbNt1akmYvLZfeb0n1-w.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">The layout in the home page</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/dc9fcad51f959e5c0ee72b978a485b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xnb9wUcW-BzIe6k-Pngdg.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">The layout in the about page</figcaption></figure><p id="2518" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那很酷。而且你肯定能看出来我是个开发者，不是设计师。但是，让我们假设一个真正的设计师来了，说“嘿…你知道什么会很酷吗？中心区域可以有一个白色的背景，带有轻微的阴影，以便更好地聚焦内容。你能做到吗？”。</p><p id="eeb9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以用你最喜欢的IDE打赌，我可以。我只需要将样式添加到内容类中，对吗？</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/1f6d8b996bfcc18b1f08160709495e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQ_QEYL4lQ030d5sHsVN9g.png"/></div></div></figure><p id="5fd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">骄傲的开发商对设计师说:“我们走吧”。但是设计师说了一些让没有经验的开发者害怕的话:“嗯…这很酷，但是…我们不能在这个边框上加上页面的标题吗？”。</p><p id="c8ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这改变了一些事情。容器不知道呈现的是什么页面。人们可以开发不同解决方案来解决这些问题，但是许多方案的设计都很糟糕，需要进行大量的维护工作:</p><ol class=""><li id="ac61" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">您可以简单地在每个组件内移动边框，并将标题直接写在组件内。但这意味着每次你写一个新的组件时，你必须写完整的代码来放置标题和边框，如果你想改变布局，你必须遍历每个组件来更新它。</li><li id="db5f" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">您可以创建一个新的组件，将组件和标题作为道具，并正确地呈现它们。但这意味着在应用程序的主页中，你必须记住不要渲染实际的组件，而是用正确的道具渲染这个包装组件。这对可读性没有帮助。</li><li id="ffaa" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">您可以在App.js中添加一个状态变量，并将setter作为props传递给每个组件，然后在组件的useEffect中调用这个setter。仍然没有很好的可读性。</li></ol><p id="7d3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是后来我们的开发人员想起了在一篇关于Medium的很棒的文章中读到的一些东西。</p><h1 id="6f8c" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">高阶组件</h1><p id="8378" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Javascript是一种很酷的语言。它是一种函数式语言。这是什么意思？这意味着你可以将函数存储在变量中，甚至可以将它们作为其他函数的参数来传递。</p><p id="c646" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">函数有一个特殊的子类，叫做高阶函数。这些函数要么接受函数作为输入，要么返回函数。这些函数的一些例子是数组的map函数或React中的useState函数。</p><p id="31f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">鉴于React组件只是将道具作为输入并返回渲染函数的函数，我们可以将这些知识结合起来，创建我们的第一个高阶组件。</p><p id="a7c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顾名思义，这些组件实际上是一些函数，它们将一个组件和您想要的任何参数作为输入，并返回一个函数，该函数返回一个渲染函数(因此基本上是一个新组件)…让我们看看如何在我们的应用程序中使用它:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lm"><img src="../Images/cb498573260ff1e9cdde99d444a81319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e354oXx4yILIdm75hCXidA.png"/></div></div></figure><p id="bdbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们的HOC:它将一个组件和标题作为输入参数，返回一个将props作为输入的函数，并返回一个渲染函数。这个render函数呈现一个有标题的容器(一个简单的网格，将标题和内容一个放在另一个下面),在args中呈现标题和组件的跨度，传递所有的属性。</p><p id="ccb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们需要修改App.js中的旧css来删除我们添加的框(因为现在由这个HOC负责在视图周围呈现框)，我们需要修改Home和About页面，如下所示:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ln"><img src="../Images/e0156d8652bb4c63efd5107740ccf2fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*dYcKqX39uSDcMxBs2yRsEA.png"/></div></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lo"><img src="../Images/72117fab162d270043be285aca3fabe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*wwO_Ucfb4KtuRUi86z03Yw.png"/></div></figure><p id="070c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我唯一需要更改的是导出值。我不是只导出组件，而是导出了包装在withTitle函数中的组件，并且传递了必须呈现的标题。</p><p id="053c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我还添加了一个新组件，一个需要不带标题和框的仪表板，只是为了显示决定我是否需要一个带标题的组件是多么容易。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lp"><img src="../Images/b9e3bc0aba3299d3d531a3bf19188b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*T6a5kLx2Vpeb0A_Kx8iz1g.png"/></div></figure><p id="6c3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最棒的是……在App.js中，我不需要做任何修改……我只需要相同的、良好的、可读的代码</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lq"><img src="../Images/4bc384f5c1c2040dcdb40578e2f62331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydUs6N6pubb3saJ7SQkr4g.png"/></div></div></figure><p id="f17e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是最后一次展示，这是所有这些变化后的webapp的外观</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/ef3b778f4d9b7c16f06645e7e3f9cf02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vk3_Ql6P2GcQjdPRSUzjvQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">The Home page with the title Home and the box around</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/12c6205b935f94eef4e78f6aa29c8175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_nm1bLxiSR80yCTxbRAxw.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">The About page with the title About and the box around</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kt"><img src="../Images/d8c441ced9036942eabe50ba2f59cd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jn-71zyBWhD8rxqw-qzp0g.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx">The Dashboard page without border and title</figcaption></figure><p id="9621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我们开始吧。我们做了一个开发者友好的方法来保持设计的一致性，如果我们想改变标题的外观，我们唯一要做的就是改变一个文件。</p><p id="8478" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这整个高阶组件的东西，甚至对于布局以外的东西也是有用的。例如，您可以在呈现私有视图之前添加对用户身份验证的检查，或者执行api调用，将get作为道具传递给使用HOC的每个组件。</p><p id="4ec6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，如果你想试验我的代码，我会在这里留下一个代码沙箱的链接。</p><p id="8d99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有任何问题，欢迎在评论区提问。</p><p id="6296" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae lr" href="https://codesandbox.io/s/hoc-dnx9e" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/hoc-dnx9e</a></p></div></div>    
</body>
</html>
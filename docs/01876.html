<html>
<head>
<title>Understanding the Mutating Keyword in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Swift中的变异关键字</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/understanding-the-mutating-keyword-in-swift-71163418e2f6?source=collection_archive---------8-----------------------#2021-04-27">https://medium.com/geekculture/understanding-the-mutating-keyword-in-swift-71163418e2f6?source=collection_archive---------8-----------------------#2021-04-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/41899ef6693fb30de9e3e4181b5e6b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oe5R4HEsOSehhGD8ggf9sg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@joshuaryanphoto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Joshua Reddekopp</a> on <a class="ae iu" href="https://unsplash.com/s/photos/coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0c8f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当谈到在Swift中管理对象时，苹果的建议是使用一个<strong class="ix hj">结构</strong>而不是一个<strong class="ix hj">类</strong>，这样不仅对开发者来说更容易管理内存，对应用程序的健康也是如此。结构是<strong class="ix hj">值类型</strong>，这意味着它们被分配给设备的堆，在内存中没有引用指针，并且针对速度进行了优化。</p><p id="286f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设我们正在开发一个捕捉用户信息的应用程序。我们的数据模型是一个名为User的简单结构，它在初始化时接受名字和姓氏。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/cf21e3b8c7bd0c53df75067d35e8bad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*UkRW5RD5XrPBuJfogTbCoA.png"/></div></figure><p id="c0ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的应用程序逻辑要求我们确保每个用户都有一个大写的名字和姓氏。因为我们希望数据模型管理自己的属性，所以我们将编写一个方法来确保输入的信息配置正确。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/3d8b1cababf70e76f83a7d064522a163.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*x2OnilpIarou3oAkvzNcPA.png"/></div></figure><p id="9fda" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在就像调用我们的属性一样简单。大写的属性使我们的用户对象随时可用！</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/445e529334af78f094c08e57d7718478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*eRAMeQmMhzOv0lHXL01jGg.png"/></div></div></figure><p id="8831" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我们试图操作我们的属性时，我们得到一个错误。这是怎么回事？错误消息如下:<strong class="ix hj"> <em class="ka">不能赋值给属性:“self”是不可变的</em> </strong>。从结构本身来看，结构的属性是<strong class="ix hj">不可变的</strong>，换句话说，Swift无法推断该结构在创建时将被声明为变量还是常量，因此为了安全起见，Swift不允许从其方法中对结构的属性进行任何更改。</p><p id="91ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">幸运的是，Swift为我们提供了一个关键字，允许我们处理这些不可变的属性。<strong class="ix hj"> Mutating </strong>关键字标志着我们的函数能够将我们的属性作为变量使用，允许我们将字符串大写。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kb"><img src="../Images/1f29e81a65bba38baa68b94f430e84df.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*KVaDrsfF9Wx9IKQcKullJQ.png"/></div></figure><p id="a80b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">知道我们的结构的属性仍然是<strong class="ix hj">不可变的</strong>很重要，那么为什么<strong class="ix hj">可变的</strong>关键字允许我们操纵我们的属性呢？在幕后，Swift为我们的结构制作了一个新的副本，并将我们的新值赋给它的属性。然后，我们定义的<strong class="ix hj">原始结构</strong>被我们的<strong class="ix hj">复制结构</strong>替换。由于结构是<strong class="ix hj">值类型</strong>，当它们被赋给新的变量或常量时，它们总是被<strong class="ix hj">复制</strong>，并且不包含对内存中特定点的引用。</p><p id="aeec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在整个Swift中看到mutating关键字。常见的地方是在本机数组类型中。一旦一个数组被声明，<strong class="ix hj"> <em class="ka">就没有办法简单的给它分配更多的空间来存放更多的条目</em> </strong>。操纵数组内容的数组方法都是<strong class="ix hj">变异</strong>函数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/4702e63a661bfb06367a44856f3b7655.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*qyUDOaKf1u7Z1_wKkSEcOg.png"/></div></figure><p id="469b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然我们不能向这个数据集合添加更多的空间，但是append()方法可以向数组中添加新元素，然后将其所有内容复制到一个新数组中。</p><p id="a096" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我知道您在想什么，“为什么不在init方法中简单地大写用户的属性，或者为什么不直接使用点符号来操作它的属性？”虽然这是一个过于简化的例子，但现实世界中的数据可能需要在以后进行更改，而不是在初始化时。<strong class="ix hj"> Mutating </strong>关键字允许结构的方法管理其自身属性的状态，从而使管理结构变得更加容易，并允许在整个代码中使用点符号来减少混乱。</p></div></div>    
</body>
</html>
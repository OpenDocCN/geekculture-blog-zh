<html>
<head>
<title>Creating Git Repository From Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始创建Git存储库</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/creating-git-repository-from-scratch-5f3d81955a88?source=collection_archive---------16-----------------------#2021-03-13">https://medium.com/geekculture/creating-git-repository-from-scratch-5f3d81955a88?source=collection_archive---------16-----------------------#2021-03-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dbc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Git是每个开发人员日常生活中必不可少的一部分，但是他们中有多少人真正了解git的内幕呢？当你说<code class="du jd je jf jg b">git commit</code>或其他命令时，git如何执行git提交。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/14c9842e0b1528df8d2bb5ec33363f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UdCDnZ6JfQ9GtYcK"/></div></div></figure><p id="3efa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是知道幕后发生了什么真的很重要吗，为什么一个人应该关心？</p><ul class=""><li id="5d8b" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated">作为开发人员，我们应该了解我们使用的工具的内部结构，特别是当我们非常频繁地使用时。</li><li id="5f93" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">如果我们了解git的内部结构，它将真正帮助我们做很多事情，比如创建一个分支，解决合并冲突，或者解决任何其他与git相关的问题。</li><li id="ee49" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">当你知道内部的东西，特别是当你认为你搞砸了一些事情的时候，它提供了工作和使用命令的信心。</li></ul><h1 id="a80c" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">这篇文章是给你的吗？</h1><ul class=""><li id="1bc3" class="jt ju hi ih b ii lf im lg iq lh iu li iy lj jc jy jz ka kb bi translated">如果您不熟悉git及其基本命令，我建议您去阅读一下，了解一下我们将要讨论的内容。</li><li id="3c4b" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated">如果你已经知道基本的命令，如<code class="du jd je jf jg b">git commit</code>、<code class="du jd je jf jg b">git add</code>、<code class="du jd je jf jg b">git branch</code>、<code class="du jd je jf jg b">git pull</code>等，并且你想知道它们的内部工作原理，你可以开始了，这是给你的。</li></ul><h1 id="5d00" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">接下来是什么？</h1><p id="d7c1" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">我们将在不使用<code class="du jd je jf jg b">git init</code>命令的情况下从头创建一个git repo，这将让我们了解git如何创建一个<code class="du jd je jf jg b">.git</code>目录以及它的内容，我们将能够在进行过程中关联许多顶级命令，例如，当我们向git staging area添加内容时会发生什么。</p><h1 id="0a8b" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">我们开始吧</h1><p id="c5a9" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">我们将从创建一个还没有初始化git的目录开始。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ln"><img src="../Images/6e9fd2dfd5e083e16bb798a4b390f01f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlU9GcLsGXu7SbCwjHXCRw.png"/></div></div></figure><p id="0e52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的步骤中，我们已经创建了一个目录并在那里使用了git状态，我们可以清楚地看到git对这个命令不满意，它说这不是一个git库。</p><p id="a1d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，让我们首先使用<code class="du jd je jf jg b">git init</code>命令，看看当我们初始化git repo时git做了什么。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lo"><img src="../Images/027ad229989016836287e312c60e1205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kud8E1WKr5c52bgsWr75Pw.png"/></div></div></figure><p id="f4f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能会注意到，一旦我们初始化了git，它就为我们创建了一个名为<code class="du jd je jf jg b">.git</code>的目录，现在让我们探索一下<code class="du jd je jf jg b">.git</code>文件夹中的内容。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lp"><img src="../Images/a91081d605da2c7cd1fd9f0b3ae730a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9snCe3quhJrQ05Y6Ye_siQ.png"/></div></div></figure><p id="474c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">到目前为止，我们可以清楚地看到<code class="du jd je jf jg b">.git</code>中有两个主目录<strong class="ih hj">【objects】</strong>和<strong class="ih hj">【refs】</strong>以及一些子目录，其中还有一个名为hooks的目录，但现在我们不用担心它。</p><p id="b3ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有一些文件需要注意<strong class="ih hj"> HEAD </strong>和config，我们会在某个时候看看这些是什么。</p><p id="ce82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们创建一个文件，并将其添加到git中，看看它能做什么</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lq"><img src="../Images/61da3ce4c47557af6a4e2fd2a4c0d292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SB9Bmca4hbEhRp6mVPXbBw.png"/></div></div></figure><p id="bf7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，在将文件添加到git之后，它已经在<strong class="ih hj">内部创建了一些东西。git/objects" </strong>这似乎是一个有趣的数字，现在我们已经做了足够多的工作，并看到了基本结构<code class="du jd je jf jg b"><strong class="ih hj">.</strong>git</code>。我们已经看到了使用<code class="du jd je jf jg b">git init</code>命令的初始化，现在让我们删除<code class="du jd je jf jg b">.git</code>并自行初始化。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es lr"><img src="../Images/c78541d8e16ebb9e5eb127445edb5417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VYTr_qAUekbVJ5tzVlKsRQ.png"/></div></div></figure><p id="6053" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们删除了<code class="du jd je jf jg b">.git</code>目录，它现在不是一个git存储库。</p><h1 id="efb3" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">展开“git init”魔法</h1><p id="ee88" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">正如我们已经看到的git repo，它必须有一个<code class="du jd je jf jg b">.git</code>，在<code class="du jd je jf jg b">.git</code>里面有两个更重要的子目录，分别叫做<strong class="ih hj">【objects】</strong>和<strong class="ih hj">【refs】</strong>，让我们创建它们，看看git是否满意</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ls"><img src="../Images/c442bd90c27956fd22bb9b5721d09294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2r69EKnSkp6k7Wpp26pqoA.png"/></div></div></figure><p id="2991" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建<code class="du jd je jf jg b">.git</code>和子目录并没有帮助我们，因为git仍然不高兴，所以现在让我们在这里暂停一段时间来理解</p><h2 id="08be" class="lt ki hi bd kj lu lv lw kn lx ly lz kr iq ma mb kv iu mc md kz iy me mf ld mg bi translated">"这两个子目录是什么，它们对git有什么用？"</h2><h2 id="c28f" class="lt ki hi bd kj lu lv lw kn lx ly lz kr iq ma mb kv iu mc md kz iy me mf ld mg bi translated">。git/对象</h2><p id="dd67" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">让我们把git想象成维护一个文件系统，特别是及时维护文件的快照，一个文件系统可以包含文件、目录和子目录。</p><p id="fc06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">git对象目录用于存储三种对象，称为</p><ul class=""><li id="1dba" class="jt ju hi ih b ii ij im in iq jv iu jw iy jx jc jy jz ka kb bi translated"><strong class="ih hj">斑点</strong></li><li id="9ab5" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated"><strong class="ih hj">树</strong></li><li id="62f1" class="jt ju hi ih b ii kc im kd iq ke iu kf iy kg jc jy jz ka kb bi translated"><strong class="ih hj">提交</strong></li></ul><p id="7e2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> BLOB </strong> <strong class="ih hj">(二进制大对象)</strong>:BLOB只存储文件的内容，它不同于典型的文件，因为它不包含任何元数据，但它只包含每个BLOB通过其“sha-1”散列来识别的内容。</p><p id="e172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> TREE </strong>:在git中，目录的等价形式是TREE，它是一个目录列表，引用blob和其他树，它也由一个“sha-1”散列来标识，它存储指向其他blob和树的指针。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mh"><img src="../Images/645e7b240ad23171e4f692b77bdc7598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zl8oy72jkfcaGdOKASc1SQ.png"/></div></div><figcaption class="mi mj et er es mk ml bd b be z dx">directory like tree structure</figcaption></figure><p id="f53f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你仔细观察上面，你会发现它以树和blobs的形式表示了一个目录结构。</p><p id="3520" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提交:在git中，工作树的快照被称为提交，它存储对工作树的引用，还包含一些元数据，如作者姓名、时间、提交消息和父提交(如果有的话)。它还通过“sha-1”哈希进行识别。</p><p id="3b2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提交存储工作树的整个快照，而不仅仅是提交之间的差异，这难道不意味着它必须存储大量数据吗？</p><p id="0350" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决这个问题，git只在文件内容发生变化时创建一个新的blob，否则它使用相同的引用sha来指向那个<code class="du jd je jf jg b">blob</code>对象，例如——如果我们创建100个内容相同的文件，git将只为它创建一个blob对象，并引用每个文件。</p><h2 id="22d1" class="lt ki hi bd kj lu lv lw kn lx ly lz kr iq ma mb kv iu mc md kz iy me mf ld mg bi translated">。git/refs或。git/refs/heads</h2><p id="2c02" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lk is it iu ll iw ix iy lm ja jb jc hb bi translated">我们可能已经知道了git分支，当我们现在创建一个新的git存储库时，我们会将<code class="du jd je jf jg b">master</code>或<code class="du jd je jf jg b">main</code>作为默认的git分支。</p><p id="406f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分支只不过是对提交的名称引用，我们当然可以只引用提交，但是作为人类，我们不太愿意记住shaid，因此给它一个名称。</p><p id="b405" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">的。git/refs/heads目录包含关于分支的信息，它只不过是一个以分支命名的文件，分支的内容是引用commit，因为我们知道我们可以有许多分支，因此里面可以有多个文件。git/ref/heads。</p><p id="18aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们知道了对象和引用，让我们在<code class="du jd je jf jg b">refs/heads</code>中创建一个默认的分支<code class="du jd je jf jg b">main</code></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mm"><img src="../Images/6884eb9f850cd0d042c9a5f25624390f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8Tyr6ZqIJPAvdbfRqIb0A.png"/></div></div></figure><p id="cbcf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哦，饭桶似乎还是不开心，还剩下什么？</p><p id="86a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所知，在任何给定点我们都可以有多个分支，但是现在的问题是<em class="mn">“git如何知道它应该指向哪个当前分支？”</em></p><p id="bae0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决这个问题，git在顶层有一个名为<strong class="ih hj"> HEAD </strong>的文件，我们已经看到了。它存储对当前分支的引用。所以让我们添加指向<code class="du jd je jf jg b">main</code>分支的头</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mo"><img src="../Images/38bef74fcbf765c98bc702c689f938d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YE0oJjJSGpm6Y-r2tnNJ8g.png"/></div></div></figure><p id="0b6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哇！git这次好像高兴了，现在指向了main branch。</p><p id="a406" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在该怎么办？</p><p id="858e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在准备创建一个提交，我们将使用更多的内部命令来完成，暂时我们将删除cool.txt文件以使一切变得干净。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mp"><img src="../Images/b639264795372f76594f6e9283f2a1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J4X5Hy3_NIaMhE_7nUCP3A.png"/></div></div></figure><p id="6a3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的。git结构现在看起来更好了:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mq"><img src="../Images/8744cb32a1edcff382c85e6c982eb233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WNdns5jsqvIDWpU7C9OAMg.png"/></div></div></figure><p id="f09b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正在创建git提交</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mr"><img src="../Images/e153d5605f5dc86e1224629d561699dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sm_rXp2voLQJUNVlA2iwBQ.png"/></div></div></figure><p id="939b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">hash-object</code>命令接受一个输入，在这种情况下，该输入来自<code class="du jd je jf jg b">— stdin</code>，然后为其生成一个<code class="du jd je jf jg b">blob</code>。</p><p id="03f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用git <code class="du jd je jf jg b">hash-object</code>我们添加了一个带有内容“git很酷”的blob。请注意，我们没有给它指定文件名，它只是内容，我们还看到它在<code class="du jd je jf jg b">objects</code>目录中创建了一个文件，如果我们试图捕获这个文件，它会显示垃圾，但是我们有一个git命令，可以通过打印这个文件的类型和内容来解决这个问题。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ms"><img src="../Images/eb05a4bd09299fe3edf93c12b40c9431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtiUIhOPz8ExV8cXGuFdzw.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mt"><img src="../Images/f0c47d249c140c9c7721ef96ca9d9d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qbm94vAVcee2svoRmGuHVw.png"/></div></div></figure><p id="4db5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，对象类型是<code class="du jd je jf jg b">blob</code>，sha以目录名的两个字符结束，git使这些目录易于查找。</p><p id="8d91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们有一个斑点，我们可以添加到我们的<code class="du jd je jf jg b">staging/indexing</code>区域</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mu"><img src="../Images/449a30c8df2e463525787f0c2662fa6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCy43e5Gc721m13VIhalpg.png"/></div></div></figure><p id="be9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用了git内部使用的<code class="du jd je jf jg b">git update-index</code>命令，当我们说<code class="du jd je jf jg b">git add</code>时，我们可以看到git认为文件<code class="du jd je jf jg b">cool.txt</code>被删除了，因为根目录没有这个文件，当我们更新索引时，我们也给了文件名<code class="du jd je jf jg b">cool.txt</code>和权限<code class="du jd je jf jg b">10064</code>，我们现在不用担心权限，而是名称。</p><p id="6091" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们转储文件的内容并用相同的内容创建<code class="du jd je jf jg b">cool.txt</code>,然后看看git的行为</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mv"><img src="../Images/41a922a8c5dc982ec05f1451b749f7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24nxVZDhEUAvxDLba8LJ4Q.png"/></div></div></figure><p id="ebe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于文件现在已创建，git看起来更加开心和环保，现在我们处于可以提交的阶段，但在此之前，我们需要用这个特定的<code class="du jd je jf jg b">blob</code>创建一个树，因为我们只能提交一个<code class="du jd je jf jg b">tree</code>，所以让我们使用<code class="du jd je jf jg b">git write-tree</code>命令来完成，它将选取我们已提交的所有更改并从中创建一个树。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mw"><img src="../Images/733d464d0ac58bb7076b3bdf4fece685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKCvqiJOZE_4vdrzTgkfgQ.png"/></div></div></figure><p id="d63a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在已经创建了一个树，我们可以看到树指向一个blob，它的文件名在reference (cool.txt)中。</p><p id="a69e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们都准备好提交了，现在让我们使用命令<code class="du jd je jf jg b">git commit-tree</code>来完成它</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mx"><img src="../Images/454edeb402ba4e3a72301c7d565250c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ck77WhoK58u5VKFhD0NJDg.png"/></div></div></figure><p id="f91c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用<code class="du jd je jf jg b">git commit-tree</code>，传递一个树id和一条消息，我们已经提交了一个树，一旦我们提交了一个树，它就会给我们一个<code class="du jd je jf jg b">commit id</code>，当我们对类型进行cat-file时，我们可以看到它是一个<code class="du jd je jf jg b">commit object</code>，内容有一个树，我们已经将它和消息一起传递给了它，它从本地git配置中选取作者。</p><p id="5fda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此时，如果我们看到<code class="du jd je jf jg b">.git</code>文件夹的结构，我们可以看到其中有三个对象，<code class="du jd je jf jg b">a blob</code>、<code class="du jd je jf jg b">a tree</code>和<code class="du jd je jf jg b">a commit</code></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es my"><img src="../Images/58251d281acbde1adc2dba8e23ecd105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zHz9iLmLRNiwiWVmZ9_tA.png"/></div></div></figure><p id="cc4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们做一个git日志，看看我们的提交是否反映在日志中？</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mz"><img src="../Images/2d5c0ff361768c45bb214b5b4dc547f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-PfTxCMaGXGGboCcmJgNw.png"/></div></div></figure><p id="5eaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哦不！我们的承诺到哪里去了？</p><p id="4dad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请记住，当我们使用touch命令创建分支时，我们没有指定它应该引用的提交id，这意味着主分支不知道它需要指向哪里并从哪里获取提交。</p><p id="6770" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决这个问题，我们需要将提交id分配给主分支</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es na"><img src="../Images/31f75d9f8a3ff21a10e3ca447b48c65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkDk3BG7LzH0rlorDdqypQ.png"/></div></div></figure><p id="3c83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">耶！！将提交id分配给分支<code class="du jd je jf jg b">main</code>，这意味着分支main现在将开始指向该提交，依此类推，因此<code class="du jd je jf jg b">git log</code>开始工作。</p><p id="541d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经结束了，我们已经创建了一个git存储库，并且在不使用任何顶级命令的情况下进行了提交。</p><p id="18a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望现在您对git的内部工作原理有了更好的了解。如果你想了解更多关于我在文章中使用的命令，你可以参考我以前的文章git <a class="ae nb" rel="noopener" href="/swlh/knowing-git-inside-out-223499c58860">了解Git Inside-Out </a></p><p id="3021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读:)</p></div></div>    
</body>
</html>
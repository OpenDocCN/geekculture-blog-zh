<html>
<head>
<title>Modeling The NBA Leap — Part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟NBA飞跃——第三部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/modeling-the-nba-leap-part-iii-74e31f55ee92?source=collection_archive---------59-----------------------#2021-08-02">https://medium.com/geekculture/modeling-the-nba-leap-part-iii-74e31f55ee92?source=collection_archive---------59-----------------------#2021-08-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e9ef" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">未来NBA全明星的分类</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/2be5fb91972b5986e12ae15dd713dd8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B5jBBsB_HdxF-7QELJLFrw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Source: <a class="ae jn" href="https://www.bostonherald.com/2020/08/19/live-blog-celtics-vs-76ers-game-2/" rel="noopener ugc nofollow" target="_blank">Boston Herald</a></figcaption></figure><p id="8424" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="kk">如果你还没有，请阅读</em> <a class="ae jn" rel="noopener" href="/geekculture/modeling-the-nba-leap-part-1-e9652fa64f80"> <strong class="jq hj"> <em class="kk">第一部分</em></strong></a><strong class="jq hj"><em class="kk"/></strong><em class="kk">&amp;</em><a class="ae jn" rel="noopener" href="/geekculture/modeling-the-nba-leap-part-ii-7675ae101796"><strong class="jq hj"><em class="kk">第二部分</em> </strong> </a> <em class="kk">。</em></p><h2 id="a846" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">概述</h2><ul class=""><li id="9a16" class="lg lh hi jq b jr li ju lj jx lk kb ll kf lm kj ln lo lp lq bi translated"><strong class="jq hj">商业问题— </strong>我们能否根据NBA球员在联盟的前3个赛季预测他们是否会在第4-6赛季入选全明星阵容？</li><li id="3db5" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated"><strong class="jq hj">数据集</strong> —经过网络搜集和数据格式化，我们剩下了大约1300名合格玩家和100多列统计特征。</li><li id="6d1c" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated"><strong class="jq hj">度量</strong> —精确度，努力减少误报</li><li id="f68f" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">EDA——只有7%的合格玩家达到我们的目标。最初的分析表明，所有NBA水平的球员都准备好在联盟中做出高水平的贡献，将自己与同龄人区分开来。</li></ul><h2 id="159b" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">特征工程</h2><p id="de64" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lw jz ka kb lx kd ke kf ly kh ki kj hb bi translated">这个项目的大部分功能工程是在我们格式化数据集时完成的。其中包括:</p><ul class=""><li id="d39c" class="lg lh hi jq b jr js ju jv jx lz kb ma kf mb kj ln lo lp lq bi translated">创建“每场比赛”统计数据，如<strong class="jq hj">场均得分(ppg)和场均助攻(apg) </strong></li><li id="039a" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">每个统计类别的年度波动</li><li id="5459" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">添加类别奖励</li><li id="f8c9" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">创造了一个新秀年的特性，允许玩家根据他们在哪个时代打球来分类</li></ul><p id="e447" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如前所述，在我们完成数据集的格式化并通过特征工程后，我们的数据集有超过100个特征供我们分析。</p><h2 id="c303" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">特征选择和建模</h2><p id="8e81" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lw jz ka kb lx kd ke kf ly kh ki kj hb bi translated">我们将关注的模型需要是可解释的。这意味着，虽然我们可以使用更先进的建模技术来增加我们的评估指标，但这些模型不一定会向我们展示我们的特征对识别我们的目标变量有多重要。考虑到这一点，我们将利用:<strong class="jq hj">逻辑回归、决策树</strong>和<strong class="jq hj">随机森林</strong>模型，因为我们将能够从这些模型中提取可推断的洞察力，让我们看到哪些特征可以帮助预测NBA最佳球员。</p><p id="db79" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">确定了我们的模型类型后，我接着使用<a class="ae jn" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">递归特征消除</strong> </a>来帮助确定哪些特征最适合每个模型，并减少我们的整体维度。有了100多个特征，很容易在我们的训练数据集上过度拟合我们的模型。下面是我们的随机森林模型RFE使用的代码。</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="bc3f" class="kl km hi md b fi mh mi l mj mk"><strong class="md hj"><em class="kk">#we first split the data into our training and testing sets</em></strong><br/>X = df.drop(columns = 'target')<br/>y = df['target']</span><span id="9da1" class="kl km hi md b fi ml mi l mj mk">X_train, X_test, y_train, y_test =  train_test_split(X, y, train_size= .8, random_state= 42)</span><span id="5c32" class="kl km hi md b fi ml mi l mj mk"><strong class="md hj"><em class="kk">#we then scaled all of the continuous variable</em></strong>s<br/>nba_scaled = StandardScaler()</span><span id="bffb" class="kl km hi md b fi ml mi l mj mk">nba_scaled.fit(X_train)<br/>X_train_sc = pd.DataFrame(nba_scaled.transform(X_train), index = X_train.index, columns = X_train.columns)<br/>X_test_sc = pd.DataFrame(nba_scaled.transform(X_test), index = X_test.index, columns = X_test.columns)</span><span id="1351" class="kl km hi md b fi ml mi l mj mk"><strong class="md hj"><em class="kk">#next we instantiated our cross-validation RFE for our random forest</em></strong><br/>rfe_rf = RFECV(estimator=RandomForestClassifier(class_weight = 'balanced', random_state = 42), step = 1, cv = 3, scoring = 'precision', n_jobs = -1, verbose = 1)<br/>rfe_rf.fit(X_train_sc, y_train)<br/>X_train_sc.columns[rfe_rf.get_support()]</span></pre><p id="9eac" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一旦我们运行RFE，我们的<strong class="jq hj">随机森林</strong>模型就剩下以下特征:<strong class="jq hj"> ['PTS '，' WS_2 '，' PER_2 '，' VORP_2 '，' PER_3 '，' VORP_3'] </strong>。<strong class="jq hj">逻辑回归</strong> &amp; <strong class="jq hj">决策树</strong>模型也通过RFE选择了相似的特征。</p><p id="d416" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来，选择我们的特征，我们开始为每种类型的模型调整超参数。我们对每个模型进行了密集的网格搜索，并利用<a class="ae jn" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> SMOTE </strong> </a>重采样来解决我们主要的职业不平衡问题。一天结束时，非SMOTE重采样模型在测试集上表现更好。下面是用于我们的随机森林模型的代码:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="c91c" class="kl km hi md b fi mh mi l mj mk"><strong class="md hj"><em class="kk">#RFE columns + 'season' to account for generational trends</em></strong><br/>rf_cols =['PTS', 'WS_2', 'PER_2', 'VORP_2', 'PER_3', 'VORP_3', 'season_year']</span><span id="70b5" class="kl km hi md b fi ml mi l mj mk"><strong class="md hj"><em class="kk">#paramters for our grid-search</em></strong><br/>params = { <br/>    'n_estimators': [10, 25, 50, 100, 200, 500],<br/>    'max_features': ['sqrt', 'auto', 'log2'],<br/>    'max_depth' : [2,4,6,8,10,12,15,20],<br/>    'criterion' :['gini', 'entropy']<br/>}</span><span id="eaa3" class="kl km hi md b fi ml mi l mj mk">rf = RandomForestClassifier(random_state = 42)</span><span id="1de9" class="kl km hi md b fi ml mi l mj mk">#<strong class="md hj"><em class="kk">running the grid-search</em></strong><br/>grid_search_RF = GridSearchCV(estimator=rf, param_grid=params, scoring=scorer, <br/>                              cv = 5, n_jobs = -1, verbose = 2)</span><span id="b1e5" class="kl km hi md b fi ml mi l mj mk"><strong class="md hj"><em class="kk">#fitting our grid-searched model to our RFE data</em></strong><br/>grid_search_RF.fit(X_train_sc[rf_cols], y_train)</span></pre><p id="ee69" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一旦我们对所有的模型进行网格搜索和重新采样，我们的测试集就会得到以下结果:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mm"><img src="../Images/9d6d6298dc2ca1624d9b7fc2b5584e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*vrXan_nALUMU36gVpRMy8Q.jpeg"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image by author</figcaption></figure><p id="7347" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">正如前面提到的，我们的<strong class="jq hj">随机森林</strong>模型在没有重采样的情况下取得了最大的成功。我们的准确度得分为95.3%，比我们的基线93%(基于每次选择主导类别的虚拟模型)高出2.3%，但更重要的是，我们的<strong class="jq hj">精确度</strong>得分为75%，这表明我们的模型在预测未来的NBA球员时，在减少误报方面做得很好。让我们更深入地了解一下我们的成功模式。</p><div class="iy iz ja jb fd ab cb"><figure class="mn jc mo mp mq mr ms paragraph-image"><img src="../Images/f577a048c7fd52d66b4ffd46876ad024.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*KDRUXOL-yUyw_HEJGpCoYw.png"/></figure><figure class="mn jc mo mp mq mr ms paragraph-image"><img src="../Images/2e54caf1813dcda23b5739c25dd2280b.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*Gt3QJsQTcXu68E74bkz8cw.png"/><figcaption class="jj jk et er es jl jm bd b be z dx mt di mu mv">Images by author</figcaption></figure></div><p id="787d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">根据上面的混淆矩阵，我们可以直观地看到我们的模型如何得分。虽然它在减少假阳性方面做得很好，但它在召回率为50%的情况下与假阴性作斗争。这告诉我们，我们的模型在预测谁真正有资格成为全明星球员时可能有点严格。</p><p id="836d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如前所述，我们希望能够从表现最佳的模型中获得有价值的见解。有了随机森林模型，我们能够提取特征重要性，看看哪些统计数据最有助于识别未来的NBA球员。上图中，我们可以看到第三季的<strong class="jq hj">比&amp; VORP </strong>和<strong class="jq hj">总积分</strong>得分最高确定了我们的目标玩家。这可以追溯到我们之前在EDA上的博客，在那里我们确定，似乎所有NBA水平的球员都准备好了高水平的表现，并不一定表现出巨大的同比增长。</p><h2 id="75f9" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">后续步骤</h2><p id="d765" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lw jz ka kb lx kd ke kf ly kh ki kj hb bi translated">该项目中有许多需要改进的地方，例如，我们希望扩展/实施:</p><ul class=""><li id="1fbd" class="lg lh hi jq b jr js ju jv jx lz kb ma kf mb kj ln lo lp lq bi translated">团队成功特征，因为获胜团队和明星球员之间可能存在潜在的相关性</li><li id="7c3f" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">进一步的类别不平衡技术</li><li id="09cc" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">更深层次的代际分析NBA的比赛风格在几代人的时间里发生了巨大的变化</li><li id="fb08" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated">预测我们持有的至少打了3个赛季，但少于6个赛季的球员</li></ul><p id="7caa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您关注这个项目，如果您有任何问题/建议/意见，请联系我们。随着时间的推移，我们将继续修补这些模型和数据集，所以请关注本系列的另一个安装。在此期间，完整的项目可以在 这里查看<a class="ae jn" href="https://github.com/rylewww/Modeling-The-NBA-Leap" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">。</strong></a></p><p id="9892" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们上<a class="ae jn" href="https://www.linkedin.com/in/rylewww/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> Linkedin </strong> </a>连线吧！</p><h2 id="4d03" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">参考</h2><ul class=""><li id="5ab2" class="lg lh hi jq b jr li ju lj jx lk kb ll kf lm kj ln lo lp lq bi translated"><a class="ae jn" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . feature _ selection。RFE.html</a></li><li id="7469" class="lg lh hi jq b jr lr ju ls jx lt kb lu kf lv kj ln lo lp lq bi translated"><a class="ae jn" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/smote-over sampling-for-unbalanced-class ification/</a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Simple Machine Learning project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单机器学习项目</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/ds-04-machine-learning-project-441a9d62e935?source=collection_archive---------25-----------------------#2021-07-17">https://medium.com/geekculture/ds-04-machine-learning-project-441a9d62e935?source=collection_archive---------25-----------------------#2021-07-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1dfd5d8f0e09f489975f37181e476a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_Bcymw_fXmdWZVh_DUReA.jpeg"/></div></div></figure><blockquote class="iq ir is"><p id="9fe6" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">github<br/><a class="ae js" href="https://github.com/saulotp/project_how-can-we-increase-revenue" rel="noopener ugc nofollow" target="_blank">https://github . com/sau lotp/project _ how-can-we-increase-revenue</a></p></blockquote><p id="3f30" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">Project_name:我们如何增加收入？</p><p id="e413" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">目标:在这个项目中，一家约定的初创企业联系我们，请求我们帮助他们如何增加公司收入。我们这些数据科学爱好者接受了这一挑战，因为我们看到了增长知识和测试数据分析技能的大好机会。</p><p id="6f29" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">什么_我们_有:该公司发送给我们一个单一的数据库包含一些数据的方式，该公司投资的资本和有多少是在销售形式回报。</p><h1 id="f0a4" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">逐步地</h1><p id="5a18" class="pw-post-body-paragraph it iu hi iw b ix ku iz ja jb kv jd je jt kw jh ji ju kx jl jm jv ky jp jq jr hb bi translated">首先，我们必须导入python库，它将帮助我们以数据帧的形式打开文件。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="9714" class="li jx hi le b fi lj lk l ll lm">import pandas as pd</span></pre><p id="db66" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在，我们可以打开CSV文件来查看数据的结构:</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="2b6c" class="li jx hi le b fi lj lk l ll lm">main_df = pd.read_csv('/content/drive/MyDrive/DataScience/Projetos/How can we increase our revenue?/advertising.csv')</span><span id="e4b5" class="li jx hi le b fi ln lk l ll lm">main_df</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/85ac0e63e7ae0ce55fd044de64a3a1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*DE0vhP5iUVoncb78FJmJeg.png"/></div></figure><p id="cd9c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们的数据帧有200行和4列。让我们看看是否有一些空数据</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="7101" class="li jx hi le b fi lj lk l ll lm">main_df.info()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/b1026ca8f31708fa242d471824cedb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*p7jBs-fQ7MwBP40sUNXnPw.png"/></div></figure><p id="14c7" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们有200行，其中有200个非空值。所有数据帧的数据类型都是浮点型的。</p><p id="6c6a" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">使用describe()命令，我们可以看到一些关于平均值、字段计数、最小/最大值等信息。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="45b2" class="li jx hi le b fi lj lk l ll lm">main_df.describe()</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/7ea5879326b702400f992a9c05d48085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*8LbdVCvT2k37lqfCQO3SLg.png"/></div></figure><p id="612b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">现在我们可以绘制一些数据，以获得更好的可视化效果。为此，我们可以导入库seaborn。<br/> PS。库‘警告’是为了阻止seaborn阴谋的警告，它不要求进行分析。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="8a3f" class="li jx hi le b fi lj lk l ll lm">import seaborn as sns<br/>import warnings<br/>warnings.simplefilter(action='ignore', category=FutureWarning)</span><span id="7477" class="li jx hi le b fi ln lk l ll lm">sns.pairplot(main_df)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/ae3a4385d8e248d1cf3ac708f7fc7a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mEyL7j4duBl_1SeA18XgWA.png"/></div></div></figure><p id="ee87" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">这张图表向我们展示了有关电视和销售的有趣数据。这些数据之间可能存在关联，因为我们可以看到，随着电视投资的增加，销售额也在增加。关于其他数据，似乎没有一个模式。让我们绘制另一种类型的图表，试图提取更多的信息。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="f8cb" class="li jx hi le b fi lj lk l ll lm">sns.heatmap(main_df.corr(), cmap='Wistia', annot=True)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/afb082d94b8e47f6b2809f0aa938a4a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*GtLLol052Q9LaTsE7o8mCw.png"/></div></figure><p id="0ee9" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">上图是一张热图，越靠近第一名，相关的数据就越多。再一次，电视和销售看起来有某种关联。</p><p id="6638" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">有了这些数据，我们就可以解决显示更好的电视投资可以增加公司收入的问题。但是让我们玩一玩机器学习，看看我们能做些什么。</p><p id="92f5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">首先，我们将选择算法将用于训练的数据。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="4247" class="li jx hi le b fi lj lk l ll lm">#importing train library<br/>from sklearn.model_selection import train_test_split</span><span id="c2f1" class="li jx hi le b fi ln lk l ll lm">#selecting columns to be trained<br/>x = main_df.drop('Vendas', axis=1)<br/>y = main_df['Vendas']</span><span id="4e4f" class="li jx hi le b fi ln lk l ll lm">#spliting the train data in 'data to train' and 'data to test'<br/>#'test size' mean that the algorithm will be trained with 70% of all #data, and will use 30% for test. But why we can't train our #algorithm with 100% of data and create an ultimate powerfull AI? #Doing this, we only will make our AI do CTRL+C / CTRL+V, the #algorithm will be very in copy past and not in predict values.</span><span id="e28e" class="li jx hi le b fi ln lk l ll lm">x_train, x_test, y_train, y_test = train_test_split(x,y, test_size=0.30)</span></pre><p id="871e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">在这种情况下，我们想要预测销售额的数值，那么我们需要一个回归算法。我们有3个变量来计算我们的销售价值，我们将使用决策树算法。(如果我们有两个相关的值，例如TV-Sales，我们可以使用简单的线性回归，但是对于多个变量，决策树更有意义。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="44ff" class="li jx hi le b fi lj lk l ll lm">## importing algorithms librarys that will be used<br/>## We will use 2 kinds of decision tree and see wich will bring us a ## better result (random forest and extratree)</span><span id="b5ad" class="li jx hi le b fi ln lk l ll lm">from sklearn.ensemble import RandomForestRegressor, ExtraTreesRegressor</span><span id="f620" class="li jx hi le b fi ln lk l ll lm">randomforest = RandomForestRegressor()<br/>extratree = ExtraTreesRegressor()</span><span id="0a75" class="li jx hi le b fi ln lk l ll lm">## algorithm training<br/>randomforest.fit(x_train, y_train)<br/>extratree.fit(x_train, y_train)</span></pre><p id="48d3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">经过训练后，我们可以衡量我们的算法有多精确。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="b1dc" class="li jx hi le b fi lj lk l ll lm">from sklearn import metrics<br/>test_random = randomforest.predict(x_test)<br/>test_extra = extratree.predict(x_test)</span><span id="5ea8" class="li jx hi le b fi ln lk l ll lm">r2_random = metrics.r2_score(y_test, test_random)<br/>r2_extra = metrics.r2_score(y_test, test_extra)</span><span id="5f8b" class="li jx hi le b fi ln lk l ll lm">print('R²')<br/>print(f'randomforest = {r2_random:.2%}')<br/>print(f'extratree    = {r2_extra:.2%}')<br/>print('='*20)</span><span id="027a" class="li jx hi le b fi ln lk l ll lm">erro_random = metrics.mean_squared_error(y_test, test_random)<br/>erro_extratree = metrics.mean_squared_error(y_test, test_extra)</span><span id="08fd" class="li jx hi le b fi ln lk l ll lm">print('error')<br/>print(f'randomforest = {erro_random:.2f}')<br/>print(f'extratree    = {erro_extratree:.2f}')<br/>print('='*20)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/6eec4f88d176f98150df8f3728b065f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/1*8DLcs9oBpTvWV2lhnqtP9A.png"/></div></figure><p id="a652" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">extratree算法具有较高的准确率，准确率为93.80%，误差为1.86%。然后我们将使用extratree进行预测。</p><p id="bec4" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">绘制算法性能图。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="933a" class="li jx hi le b fi lj lk l ll lm">import matplotlib.pyplot as plt<br/>comparative_table = pd.DataFrame()<br/>comparative_table['Real Sales values'] = y_test<br/>comparative_table['Prediction'] = test_extra</span><span id="0029" class="li jx hi le b fi ln lk l ll lm">## plot <br/>plt.figure(figsize=(10,5))<br/>sns.lineplot(data=comparative_table)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/82de8ae668f839c60f58ba508b644f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Ed2lWBng7TIZriVxpzkgBQ.png"/></div></figure><p id="2b7d" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">如果我们想比较预测数据和真实数据，我们可以打印数据图表。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="757b" class="li jx hi le b fi lj lk l ll lm">display(comparative_table.head())</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/a3ab38e5a56f8e471b6b0f6e7f5abd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*0pnoSFlASvRX5pGnYLMsEg.png"/></div></figure><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="c636" class="li jx hi le b fi lj lk l ll lm">## for measure wich variable has more importance in our algorithm we can use the command 'feature_importances_'</span><span id="fa34" class="li jx hi le b fi ln lk l ll lm">print(extratree.feature_importances_)</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/07e4a5ca2f9235aa258ff6e678332f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*ZLSKvhHyaOoqbX3XT4G1Jg.png"/></div></figure><p id="fb35" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">我们的栏目有:1电视<br/> 2电台<br/> 3报纸<br/>目前，我们知道电视对销售结果更重要。广播和报纸几乎是一样的，但看起来对报纸的投资会给销售公司带来更多的价值。如果我们做一个预测，模拟在电视和报纸上的更多投资，而广播的价值很低，会发生什么？</p><p id="f5f3" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">为了预测价值，我们必须使用命令' used algorithm+predict([[values]]'，在这种情况下，代码将是:<br/>extra tree . predict([[' TV _ value '，' radio_value '，' Newpaper_value']))让我们来玩投资数字，我们有100%的机会在电视、广播和报纸中进行分割，让我们看看我们能做些什么。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="a4b7" class="li jx hi le b fi lj lk l ll lm">print(extratree.predict([['80','10', '10']]))<br/>print(extratree.predict([['50','10', '40']]))<br/>print(extratree.predict([['50','25', '25']]))<br/>print(extratree.predict([['20','30', '50']]))<br/>print(extratree.predict([['40','30', '30']]))<br/>print(extratree.predict([['10','80', '10']]))</span></pre><figure class="kz la lb lc fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/d88f2870f365d46ca4d107403d374f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:174/format:webp/1*uAAFpAnpMWucT8ieo4kxzA.png"/></div></figure><p id="ff16" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">有了这些数据，我们可以得出结论，要增加公司收入，只要在电视上注入更多的重要性，销售额就会增加。</p><p id="a1ba" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jt jg jh ji ju jk jl jm jv jo jp jq jr hb bi translated">在这种情况下，我们不寻找统计数据，对此我很抱歉，但请记住，我只是一名试图学习一些数据科学知识的学生。我希望这篇文章对你有帮助，我还有很多要学的。但是如果你对我们如何增加对这个案例的分析有一些建议，请随时与我交谈。</p><ul class=""><li id="3867" class="ly lz hi iw b ix iy jb jc jt ma ju mb jv mc jr md me mf mg bi translated"><a class="ae js" href="mailto:saulodetp@gmail.com" rel="noopener ugc nofollow" target="_blank">saulodetp@gmail.com</a></li></ul><blockquote class="iq ir is"><p id="5c2d" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">github<br/><a class="ae js" href="https://github.com/saulotp/project_how-can-we-increase-revenue" rel="noopener ugc nofollow" target="_blank">https://github . com/sau lotp/project _ how-can-we-increase-revenue</a></p></blockquote></div></div>    
</body>
</html>
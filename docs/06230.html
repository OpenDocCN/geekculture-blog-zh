<html>
<head>
<title>Using locally the Python Quantiacs Toolbox in your own environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在您自己的环境中本地使用Python Quantiacs工具箱</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-locally-the-python-quantiacs-toolbox-in-your-own-environment-d035beae66da?source=collection_archive---------5-----------------------#2021-08-13">https://medium.com/geekculture/using-locally-the-python-quantiacs-toolbox-in-your-own-environment-d035beae66da?source=collection_archive---------5-----------------------#2021-08-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0821" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将介绍如何在您的机器上安装最新版本的Python Quantiacs工具箱，以及如何为本地算法开发设置您自己的环境。</p><p id="3fd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae je" href="http://www.quantiacs.com" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Quantiacs </strong> </a> <strong class="ih hj">工具箱</strong>是一个开源引擎，用于开发和测试用Python编写的交易算法。工具箱可以轻松地与所有用于数据科学、机器学习和统计数据可视化的Python库集成。</p><p id="3de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">工具箱可以在<strong class="ih hj">注册到</strong><a class="ae je" href="http://www.quantiacs.com" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">quanti ACS</strong></a>后在线使用，或者离线下载到您的本地机器上使用。在我们的云上开始更容易，但是过一段时间后，出于不同的原因，离线工作更有用:</p><ul class=""><li id="3d53" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">Quantiacs为Jupyter笔记本和JupyterLab提供在线支持。脱机工作时，您可以<strong class="ih hj">使用您喜欢的IDE </strong>。</li><li id="639b" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">在你的机器上工作，你可以使用你的本地内存、处理和存储资源。</li><li id="6510" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">您可以<strong class="ih hj">修改源代码</strong>，如果您认为工具箱可以改进，请向我们发送建议。</li><li id="e080" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">你可以在自己的机器上下载数据集，然后随心所欲地分析它们。</li></ul><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/573ef7c4a48b1ed695a3b2ec57eff769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikaQIz5vMriV8O3s34JFyg.png"/></div></div></figure><p id="a56c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">源代码可以在我们的<a class="ae je" href="https://github.com/quantiacs" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> GitHub仓库</strong> </a>中查看，在那里你可以找到源代码和许多例子，用于<a class="ae je" href="https://github.com/quantiacs/strategy-first-crypto-daily-long" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">入门</strong> </a>算法交易和使用<a class="ae je" href="https://github.com/quantiacs/strategy-cryptofutures-ml-ridge" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">更高级的方法</strong> </a>。</p><p id="f268" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Quantiacs工具箱是用Python编写的，它可以在Linux、Mac和Windows操作系统上运行，并且支持用<strong class="ih hj"> Python 3.7 </strong>编写的交易系统。它的结构高度模块化，引擎非常快，因为它依靠<a class="ae je" href="http://xarray.pydata.org/en/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> xarray </strong> </a>和<a class="ae je" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> pandas </strong> </a>进行数据处理，依靠<a class="ae je" href="http://numba.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> numba </strong> </a>进行高性能计算。</p><h1 id="c22e" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">安装工具箱</h1><p id="acb5" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">安装Quantiacs工具箱的最佳解决方案是使用<a class="ae je" href="https://docs.conda.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> conda </strong> </a>，因为它允许稳定和灵活地处理软件包，并且它提供了为您的项目轻松定义<strong class="ih hj">环境</strong>的选项。此外，作为一个软件包管理器，康达可以帮助您查找和安装软件包，它可以在<a class="ae je" href="https://repo.anaconda.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">【repo.anaconda.com】</strong></a>安装和管理上千个软件包。</p><p id="bdf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要使用conda，您可以简单地遵循安装说明，例如在<a class="ae je" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Anaconda </strong> </a>页面。</p><p id="b734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">安装conda后，您可以创建一个用于开发策略的隔离环境，并安装Quantiacs工具箱，如下所示:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="e34f" class="ln kg hi lj b fi lo lp l lq lr">conda create -n qntdev quantiacs-source::qnt conda-forge::ta-lib conda-forge::pandas==1.2.5 conda-forge::dash==1.18 python==3.7</span></pre><p id="c78f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该命令将创建一个名为<strong class="ih hj"> qntdev </strong>的环境，可以使用以下命令将其禁用:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="3238" class="ln kg hi lj b fi lo lp l lq lr">conda activate qntdev</span></pre><p id="125a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和停用，例如当您想要恢复到conda base环境时，使用:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="4d1b" class="ln kg hi lj b fi lo lp l lq lr">conda deactivate qntdev</span></pre><h1 id="3e96" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">设置您的API密钥</h1><p id="7f46" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">接下来，您需要<strong class="ih hj">设置您的API密钥</strong>。您的API密钥可在您的个人帐户中获得。单击“显示”并将密钥复制到剪贴板中。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ls"><img src="../Images/9a43fbf4f44eeb1441aa36a64650b68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ho1OwbGnQHXsNT__bWMVeg.png"/></div></div></figure><p id="50ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，使用以下命令将您的API密钥保存在我们的conda环境中:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="73ed" class="ln kg hi lj b fi lo lp l lq lr">conda env config vars set -n qntdev API_KEY=your_key</span></pre><p id="8114" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您遇到问题，例如使用<a class="ae je" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> PyCharm </strong> </a>可能会出现问题，您可以在策略的开头添加以下行，以确保API键设置正确:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="7897" class="ln kg hi lj b fi lo lp l lq lr">import os<br/>os.environ['API_KEY'] = "your_key"</span></pre><h1 id="fd6d" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">在本地运行系统</h1><p id="7d6b" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">现在，您可以在本地运行一个策略:激活您的环境，在一个<strong class="ih hj"> strategy.py </strong>文件中编写系统代码，并键入以下内容运行它:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="2aab" class="ln kg hi lj b fi lo lp l lq lr">python strategy.py</span></pre><p id="08e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个简单的起始示例交易<a class="ae je" href="https://quantiacs.com/contest" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">加密货币</strong> </a>可以是例如一个交叉系统:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="554a" class="ln kg hi lj b fi lo lp l lq lr">import xarray as xr</span><span id="96e6" class="ln kg hi lj b fi lt lp l lq lr">import qnt.ta as qnta<br/>import qnt.backtester as qnbt<br/>import qnt.data as qndata</span><span id="8810" class="ln kg hi lj b fi lt lp l lq lr">def load_data(period):<br/>  return qndata.cryptodaily_load_data(tail=period)</span><span id="bc18" class="ln kg hi lj b fi lt lp l lq lr">def strategy(data):<br/>  close = data.sel(field=”close”)<br/>  is_liquid = data.sel(field=”is_liquid”)<br/>  sma_slow = qnta.sma(close, 200).isel(time=-1)<br/>  sma_fast = qnta.sma(close, 20).isel(time=-1)<br/>  weights = xr.where(sma_slow &lt; sma_fast, 1, 0)<br/>  weights = weights * is_liquid<br/>  weights = weights / 10.0<br/>  return weights</span><span id="6795" class="ln kg hi lj b fi lt lp l lq lr">weights = qnbt.backtest(<br/>  competition_type = “crypto_daily_long”,<br/>  load_data = load_data,<br/>  lookback_period = 365,<br/>  start_date = “2014–01–01”,<br/>  strategy= strategy)</span></pre><p id="1da2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">运行系统后，会出现一个基于<a class="ae je" href="https://dash.plotly.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">破折号</strong> </a>的数据可视化app。在那里，您可以检查资产的<strong class="ih hj">位置值</strong>:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lu"><img src="../Images/1b9c842a9079062f5190cc5e1e5e8154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dauDqeVcNZRQuHCCmbrl8g.png"/></div></div></figure><p id="f00c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以检查最重要的<strong class="ih hj">统计指标</strong>的值:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lv"><img src="../Images/949764d2c6c3b00335cf18bd11b6611a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5GPQ_p8ACoMsYelIf_j2FQ.png"/></div></div></figure><p id="5bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，您可以可视化<strong class="ih hj">盈亏</strong>、<strong class="ih hj">水下图</strong>和<strong class="ih hj">滚动夏普比率</strong>的演变:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lw"><img src="../Images/fe24470551f92dacb8460882081ce75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrxIZdHQ9f2-TYBRs1jJrA.png"/></div></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lx"><img src="../Images/f5f541b14a77bf7fcf413746cc7fef6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sERKyJwwhr-u1GUYrM4nA.png"/></div></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ly"><img src="../Images/bb62a204d1fdbf31d029e107efb0828b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6YaS-BqcggUB2ps-ULHGA.png"/></div></div></figure><p id="2dc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多信息可在<strong class="ih hj"> Quantiacs </strong> <a class="ae je" href="https://quantiacs.com/documentation/en/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">文档页面</strong> </a>找到。</p><p id="d7f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您的代码可以上传到我们的比赛，方法是将其翻译到名为<strong class="ih hj"> strategy.ipynb </strong>的Jupyter笔记本上并提交。</p><h1 id="ada6" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">添加包</h1><p id="4d4b" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">安装新软件包很容易，只需使用conda，例如:</p><pre class="ju jv jw jx fd li lj lk ll aw lm bi"><span id="aaf2" class="ln kg hi lj b fi lo lp l lq lr">! conda install -y scikit-learn</span></pre><p id="3be1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可用于安装<a class="ae je" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> scikit-learn </strong> </a>包。对云的依赖可以通过编辑根目录中的<strong class="ih hj"> init.py </strong>文件来解决。</p><p id="d5a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有问题或建议吗？在我们的<a class="ae je" href="https://quantiacs.com/community/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">论坛</strong> </a>页面联系我们！</p><p id="8be9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你在用<a class="ae je" href="https://colab.research.google.com/notebooks/intro.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Google Colab </strong> </a>吗？</p><ul class=""><li id="c7d6" class="jf jg hi ih b ii ij im in iq jh iu ji iy jj jc jk jl jm jn bi translated">如果你想使用一个<strong class="ih hj">托管的运行时</strong>，从这个<a class="ae je" href="https://quantiacs.com/documentation/en/_static/colab.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>开始。它包含配置托管运行时所需的命令。</li><li id="8911" class="jf jg hi ih b ii jo im jp iq jq iu jr iy js jc jk jl jm jn bi translated">如果您将colab与一个<strong class="ih hj">本地运行时</strong>一起使用，那么您可以使用一个常规的conda环境。</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Detection Of Pneumonia From Chest X-Ray Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从胸部x光图像中检测肺炎</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/detection-of-pneumonia-from-chest-x-ray-images-aa36e096c51a?source=collection_archive---------10-----------------------#2021-08-28">https://medium.com/geekculture/detection-of-pneumonia-from-chest-x-ray-images-aa36e096c51a?source=collection_archive---------10-----------------------#2021-08-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发现深度学习的真正力量，因为它预测一个人是否患有肺炎的准确率为93%</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/36c0bfefb4efdffae2b38005b0e0be8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_wdkrXvn3ja5pTiz"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@cdc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">CDC</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ju jv jw"><p id="fef4" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">要查看完整代码，请点击<a class="ae jt" href="https://jovian.ai/herambhd03/chest-x-ray-pneumonia" rel="noopener ugc nofollow" target="_blank">此处</a></p></blockquote><h1 id="5435" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是肺炎？</h1><p id="8753" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">肺炎是一种由细菌、病毒或真菌引起的感染，它使一个或两个肺部的气囊(肺泡)发炎。气囊充满液体或脓，导致咳嗽带痰和呼吸困难。</p><p id="88f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">患有肺炎的人的胸部x光片具有不正常的混浊区域，这对于人眼来说并不总是清晰可见的。这使得准确预测和拯救生命变得困难。这就是我们可以看到深度学习的美妙之处。</p><h1 id="612a" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">什么是深度学习？</h1><p id="79db" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">深度学习是人工智能的一个子集，它使用<a class="ae jt" href="https://www.investopedia.com/terms/n/neuralnetwork.asp#:~:text=A%20neural%20network%20is%20a,organic%20or%20artificial%20in%20nature." rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">神经网络</strong> </a>，模仿人脑在处理数据和创建模式以做出决策方面的工作。</p><p id="1a8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">神经网络由许多层组成，这些层相互连接并捕捉某些非线性和线性关系。每一层负责学习特定的特征，并且随着层数的增加，模型变得越来越好。</p><h1 id="e650" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">方法</h1><p id="0e0e" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这个项目使用了一个Python原生包<a class="ae jt" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> PyTorch </strong> </a>，它很容易与其他Python包集成，这使得它成为一个简单易学的选择。</p><p id="ebed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我使用的是<a class="ae jt" href="https://en.wikipedia.org/wiki/Residual_neural_network" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">残差网络</strong> </a> (ResNets) via <a class="ae jt" href="https://en.wikipedia.org/wiki/Transfer_learning" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">迁移学习</strong> </a>，一种流行的深度学习神经网络模型。</p><p id="5ac7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下是涉及的步骤:</p><ol class=""><li id="6e06" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">下载数据集</li><li id="afa7" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">导入所需的库</li><li id="fd5d" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">数据分析和可视化</li><li id="76cd" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">数据扩充和标准化</li><li id="eae4" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">准备训练和验证数据集</li><li id="7f2e" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">设置GPU</li><li id="5268" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">创建模型类</li><li id="db29" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">训练和评估模型</li><li id="6cd3" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">精确度和损耗图</li><li id="b0bc" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">根据实际标签绘制预测</li><li id="4111" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">结论</li></ol><h1 id="7090" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">下载数据集</h1><p id="0be2" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">第一步是下载我们打算使用的数据。该数据集可在<a class="ae jt" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/paultimothymooney/chest-x ray-pneumonia</a>获得。使用Jovian的<a class="ae jt" href="https://github.com/JovianML/opendatasets" rel="noopener ugc nofollow" target="_blank"> opendatasets </a>库，我从<a class="ae jt" href="https://www.kaggle.com/stanford-open-policing/stanford-open-policing-project-bundle-2" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载了数据。</p><h1 id="4d48" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">导入所需的库</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/a92caad0729ab816d192aa3b6f1f3eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U2OypOBO6gV53o5C"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@izzuddindanial?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Zaini Izzuddin</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="37c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将需要一些库，如<em class="jx"> Pandas、Matplotlib、Numpy和其他PyTorch </em>实用程序来简化我们的工作流程。</p><h1 id="1fed" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">数据分析和可视化</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/17456e425c0951e1ff4da036ce29ca88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jnt8N6E-qK58k922"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Carlos Muza</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4cbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使用我们的数据集，我们必须首先检查它，并采取必要的措施使它最适合我们的模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/ba5b50500cf7fd8fb55a4bef7f0bdd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*mBJZuBxNe18VS5j8fEqR8w.png"/></div></figure><p id="6a9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在研究这些数据时，我发现了一些重要的东西。肺炎组的图像数量多于正常组。这可能会产生错误的结果，因为我们的模型可能会给肺炎类别更多的权重。为了解决这个问题，我们应用了数据增强。</p><p id="5fa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们的模型被训练的图像样本的样子！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/8a274dafaf183ec93fc51c3fd7606584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hF43UnHoeBGE62ehXs04aQ.png"/></div></div></figure><p id="dc85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以看出，仅仅从x光片上很难准确判断一个人是否患有肺炎。</p><h1 id="b74a" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">数据扩充和标准化</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lw"><img src="../Images/80781cc5a5ee6e29b911db68a76930d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*GsSwqID_Vgqa6S9d"/></div><figcaption class="jp jq et er es jr js bd b be z dx">by Shubham Goyal from Towards Data Science</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lx"><img src="../Images/36243d64f8ddddb8353be0de376be7cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ERdSuxCcVFUnR2tm.png"/></div></div></figure><p id="7127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们希望我们的模型学习它特别针对的特征，而不是背景中存在的任何东西。这就是我们应用<a class="ae jt" href="https://en.wikipedia.org/wiki/Data_augmentation" rel="noopener ugc nofollow" target="_blank">数据增强</a>的原因。这有助于我们归纳数据，并防止它学习任何不需要的特征。</p><p id="1e59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">标准化数据可以防止来自任何一个通道的值在训练时不成比例地影响损耗和梯度，只需比其他通道具有更高或更宽的值范围。</p><h1 id="6857" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">准备训练和验证数据集</h1><p id="3479" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">现在是时候准备我们的训练和验证数据集了。这里，我们将训练数据集分为75%训练和25%验证。</p><p id="b988" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">训练集</strong> —用于训练模型，即使用梯度下降计算损失并调整模型的权重。</p><p id="b240" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">验证集</strong> —用于在训练时评估模型，调整超参数(学习率等)。)并挑选模型的最佳版本。</p><p id="69eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在可以创建数据加载器来帮助我们批量加载数据。我们混洗训练数据加载器，以确保每个时期中生成的批次是不同的。这种随机化有助于概括和加速训练过程。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/d210fd84d0f4ca3588994160d99b5d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*cg0pcDANbsKb0YJUziSzxA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">A batch of Training Data from the DataLoader</figcaption></figure><h1 id="f8f2" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">设置GPU</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/b8399f592377f137e76aa4591d897ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6nyleNtwU73CRvOs"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@andyjh07?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andy Holmes</a> on <a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8701" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图形处理单元(GPU)包含数百个内核，这些内核针对在短时间内对浮点数执行昂贵的矩阵运算进行了优化，这使得它们非常适合训练具有许多层的深度神经网络。</p><p id="7adc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了无缝地使用GPU，如果有可用的话，我们定义了两个助手函数(get_default_device &amp; to_device)和一个助手类DeviceDataLoader，以便根据需要将模型和数据移动到GPU。</p><h1 id="b6fc" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">创建模型类</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/1f20692895e30b5c840f00135acfff9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/0*zX9l1y46rXMnv7QO.png"/></div></figure><p id="c9d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在模型中使用剩余网络。残差网络将残差块添加到CNN，CNN将原始输入添加回通过使输入通过一个或多个卷积层而获得的输出特征图。这一小小的改变带来了性能上的巨大提高。它允许在不损害性能的情况下训练更深层次的网络，因为可以跳过一些层。</p><p id="3109" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以参考这篇博文来更好地了解ResNet是如何工作的:<a class="ae jt" href="https://towardsdatascience.com/residual-blocks-building-blocks-of-resnet-fd90ca15d6ec" rel="noopener" target="_blank">https://towardsdatascience . com/residual-blocks-building-blocks-of-ResNet-FD 90 ca 15d 6 EC</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/577bbae6f959071d0b9ddcc9ed608846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P6qNoH-VomJRGVts.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Representation of ResNet50</figcaption></figure><h1 id="658d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">训练和评估模型</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/4689689762281adef742169b96147908.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*t97o7Uqu_miPGZvU0Fggrg.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Negotiation Experts</figcaption></figure><p id="6cd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，是时候在整个训练和验证集上训练和评估我们的模型了。</p><p id="d1b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像批量大小、学习率等配置。需要在训练模型时预先挑选，称为<strong class="ih hj">超参数</strong>。挑选正确的超参数是让一个好的模型从优秀的模型中脱颖而出的关键。</p><h1 id="f7ef" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">精确度和损耗图</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/3cf82cdcf9e9ec187454139db3b47cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mtlkyv-7w7IdEQCDMqPWgQ.png"/></div></div></figure><p id="1215" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型在训练集上的准确率为100%，在验证集上的准确率为98.88%，这是一个相当不错的结果。</p><h1 id="23d0" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">根据实际标签绘制预测</h1><p id="aabb" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">让我们看看几个图像，它们各自的标签以及我们的模型预测了什么。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es md"><img src="../Images/7f5f8392170c697ba100ce89f806f74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSHRnKkgCyELW4AeGR1-uA.png"/></div></div></figure><p id="0d98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的模型具有93%的测试准确度，这远远好于人类的预测。因此，我们可以更加确定我们的预测，拯救更多的生命。</p><h1 id="9347" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="d5e1" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我希望这篇文章揭示了深度学习的潜在力量。随着技术的快速发展，我们很快就会拥有足够强大的处理器，能够以令人难以置信的高精度在几分之一秒内完成这项工作。</p><blockquote class="ju jv jw"><p id="8ed7" class="if ig jx ih b ii ij ik il im in io ip jy ir is it jz iv iw ix ka iz ja jb jc hb bi translated">要查看完整的代码，请点击<a class="ae jt" href="https://jovian.ai/herambhd03/chest-x-ray-pneumonia" rel="noopener ugc nofollow" target="_blank">这里</a></p></blockquote></div></div>    
</body>
</html>
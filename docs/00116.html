<html>
<head>
<title>Numerical differentiation via the FFT algorithm: Calculating the Spectral Derivative</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过FFT算法的数值微分:计算光谱导数</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/numerical-differentiation-via-the-fft-algorithm-calculating-the-spectral-derivative-a8ab18e1abbe?source=collection_archive---------0-----------------------#2020-06-19">https://medium.com/geekculture/numerical-differentiation-via-the-fft-algorithm-calculating-the-spectral-derivative-a8ab18e1abbe?source=collection_archive---------0-----------------------#2020-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">物理领域确实取得了长足的进步。</p><p id="f285" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">过去，当一个人想到物理职业时，通常会联想到怪人的形象，蓬头垢面，胡须未刮，围着黑板团团转。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/d4960df9325c50b2ff3faa2ad8bbc5e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DY5pD8e5uCfuXQ30.jpg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Something like this?</figcaption></figure><p id="fd3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些天来，这个领域发生了巨大的变化。计算的复杂性早已超越了袖珍计算器和黑板，需要大量使用计算机算法。</p><p id="07b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算物理领域已经发展到能够满足当今科学家和研究人员的需求。</p><p id="d066" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从根本上说，物理原理是一样的。</p><p id="0843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，明智的软件优化有助于大大提高计算的准确性。或者，它有助于对手工无法解决的问题做出更准确的估计。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jt"><img src="../Images/391727028a818a68ea711b115bef6374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fj3P225vbnbipS8H.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Credits: Wikipedia</figcaption></figure><p id="b847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们开始吧</p><h1 id="9bf6" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">正弦函数的性质</h1><p id="309d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">考虑一个一维周期函数，用复数表示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/92170575d8feeeba69e58016c1de8ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*DOx2SfrvrdC36p6nCplZtw.png"/></div></figure><p id="5767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">函数的微分导致以下微分:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/2c0d7160363160ea21e9a29dce628985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7yePn_-YxYkrgijW85wyA.png"/></div></div></figure><p id="0787" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导数与原函数几乎相同，增加了<strong class="ih hj"> i和2(π)k/L，</strong>使我们可以获得结果:</p><blockquote class="kz"><p id="7642" class="la lb hi bd lc ld le lf lg lh li jc dx translated"><strong class="ak">F</strong>(<em class="lj">df</em>/<em class="lj">dx</em>)= Iω<strong class="ak">F</strong>(F)，其中<strong class="ak"> F </strong>表示傅里叶变换。</p></blockquote><blockquote class="lk ll lm"><p id="8b1a" class="if ig ln ih b ii lo ik il im lp io ip lq lr is it ls lt iw ix lu lv ja jb jc hb bi translated">通过利用傅里叶变换和傅里叶逆变换，我们有一个非常方便的方法来恢复函数的导数。</p></blockquote><h2 id="411e" class="lw jv hi bd jw lx ly lz ka ma mb mc ke iq md me ki iu mf mg km iy mh mi kq mj bi translated">测试光谱导数的准确性。</h2><p id="7998" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">再说一次，该表扬的地方就要表扬。</p><p id="89b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考文献和结果都是从这本教科书中获得的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/24942bb2531e56548cf0fb2ce1951368.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/0*eYrKazfWFJQXwHKu.jpg"/></div><figcaption class="jp jq et er es jr js bd b be z dx"><a class="ae ml" href="https://www.amazon.sg/Data-Driven-Science-Engineering-Learning-Dynamical/dp/1108422098" rel="noopener ugc nofollow" target="_blank">https://www.amazon.sg/Data-Driven-Science-Engineering-Learning-Dynamical/dp/1108422098</a></figcaption></figure><p id="7dde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以下代码示例被细分为3个块。</p><ol class=""><li id="94c4" class="mm mn hi ih b ii ij im in iq mo iu mp iy mq jc mr ms mt mu bi translated"><strong class="ih hj">我们创建一个简单的周期函数。</strong></li></ol><p id="3e72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于这里的作用是<strong class="ih hj">评估光谱导数的准确性</strong>，我们创建了一个简单的函数，在该函数中可以获得解析解，以便为比较提供基线。</p><pre class="je jf jg jh fd mv mw mx my aw mz bi"><span id="d343" class="lw jv hi mw b fi na nb l nc nd">import numpy as np <br/>import matplotlib.pyplot as plt</span><span id="0300" class="lw jv hi mw b fi ne nb l nc nd">plt.rcParams['figure.figsize'] = [12, 12]<br/>plt.rcParams.update({'font.size': 18})</span><span id="8258" class="lw jv hi mw b fi ne nb l nc nd">n=64<br/>L=30<br/>dx=L/n<br/>x=np.arange(-L/2,L/2,dx,dtype="complex_") </span><span id="a169" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Create a Function</strong></span><span id="4203" class="lw jv hi mw b fi ne nb l nc nd">f=np.cos(x) * np.exp(-np.power(x,2)/25)     </span><span id="294f" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Analytically obtain the Derivative</strong><br/>               <br/>df= -(np.sin(x) * np.exp(-np.power(x,2)/25 + (2/25)*x*f))  #Derivative</span></pre><p id="f079" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">我们试图通过有限差分法(FDM)来估计导数。</strong></p><p id="3967" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">FDM是微分和求导的另一种方法。事后看来，我们知道这是一种更粗糙、更不准确的确定导数的方法。但是为了比较，我们已经包括了它。</p><pre class="je jf jg jh fd mv mw mx my aw mz bi"><span id="6908" class="lw jv hi mw b fi na nb l nc nd"><strong class="mw hj">##Approximate derivative by FDM</strong></span><span id="f653" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Create a numpy array<br/>#Discretizes the function into finite regions</strong></span><span id="c194" class="lw jv hi mw b fi ne nb l nc nd">dfFD=np.zeros(len(df), dtype='complex_') </span><span id="4697" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Iterate across array</strong></span><span id="8725" class="lw jv hi mw b fi ne nb l nc nd">for kappa in range(len(df)-1):<br/>    dfFD[kappa]=(f[kappa+1]-f[kappa])/dx   <br/>    <br/>dfFD[-1]=dfFD[-2]</span></pre><p id="fb3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj">通过快速傅立叶变换&amp;快速傅立叶变换近似光谱导数。</strong></p><pre class="je jf jg jh fd mv mw mx my aw mz bi"><span id="a08c" class="lw jv hi mw b fi na nb l nc nd"><strong class="mw hj">##Approximate derivative by FFT</strong></span><span id="292f" class="lw jv hi mw b fi ne nb l nc nd">fhat = np.fft.fft(f)</span><span id="3b0a" class="lw jv hi mw b fi ne nb l nc nd">kappa = (2*np.pi/L)*np.arange(-n/2,n/2)</span><span id="151d" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Re-order fft frequencies</strong></span><span id="f502" class="lw jv hi mw b fi ne nb l nc nd">kappa = np.fft.fftshift(kappa) </span><span id="42fe" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Obtain real part of the function for plotting</strong></span><span id="6b26" class="lw jv hi mw b fi ne nb l nc nd">dfhat = kappa*fhat*(1j)</span><span id="3247" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">#Inverse Fourier Transform</strong></span><span id="43e6" class="lw jv hi mw b fi ne nb l nc nd">dfFFT = np.real(np.fft.ifft(dfhat))</span><span id="ab8f" class="lw jv hi mw b fi ne nb l nc nd"><strong class="mw hj">##Plot results</strong></span><span id="fcd7" class="lw jv hi mw b fi ne nb l nc nd">plt.plot(x, df.real, color='k', LineWidth=2, label='True Derivative')<br/>plt.plot(x, dfFD.real, '--', color='b', LineWidth=1.5, label='Finite Difference')<br/>plt.plot(x, dfFFT.real, '--', color='c', LineWidth=1.5, label='Spectral Derivative')</span><span id="8933" class="lw jv hi mw b fi ne nb l nc nd">plt.xlabel('X values')<br/>plt.ylabel('Y values')</span><span id="6c34" class="lw jv hi mw b fi ne nb l nc nd">plt.legend()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/6a1c20602bc9f20dd23160121ce2af35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rH_leDNYqtLUw67D0gGFAg.png"/></div></div></figure><p id="81e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于平滑和连续的函数区域，可以观察到代表<strong class="ih hj">光谱</strong> <strong class="ih hj">导数的线</strong>更接近实际导数的线，证明它是真实导数的更精确的近似。</p><p id="ba2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">值得注意的是，对应于FDM和FFT的代码(代码块2和3)对于表达式是不可知的，t <strong class="ih hj">它们将接受任何表达式，不管有多复杂，并返回估计值。</strong></p><p id="a19a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在现实生活中不可能获得解析导数的情况下，使用光谱导数是有意义的。</p><h2 id="e987" class="lw jv hi bd jw lx ly lz ka ma mb mc ke iq md me ki iu mf mg km iy mh mi kq mj bi translated">光谱导数可能不准确的情况</h2><p id="21e9" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">函数是<strong class="ih hj">不连续</strong>的情况，并且具有尖锐的转折点，这导致光谱导数变得不精确的情况。</p><p id="3721" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是众所周知的<a class="ae ml" href="https://en.wikipedia.org/wiki/Gibbs_phenomenon" rel="noopener ugc nofollow" target="_blank">吉布斯现象</a>，它试图量化为什么光谱导数不能精确地逼近这些急剧转折点处的导数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ng"><img src="../Images/00f15e6977e2a67ec9f6d7e740f0f8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q3svPGGdAtxSUCP_nvJ7IA.png"/></div></div></figure><p id="8349" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，在现实世界中，趋势表现出不连续跳跃的情况非常罕见，如果不是不可能的话。</p><p id="d8c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">吉布斯现象的讨论和证明最好留给纯数学领域。</p><p id="1eec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">光谱导数到此为止！</p></div></div>    
</body>
</html>
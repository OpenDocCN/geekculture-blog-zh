<html>
<head>
<title>Logistics regression in 5 minutes (1/4)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5分钟内的物流回归(1/4)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/logistics-regression-in-5-minutes-1-3-64a890ed79e1?source=collection_archive---------53-----------------------#2021-06-24">https://medium.com/geekculture/logistics-regression-in-5-minutes-1-3-64a890ed79e1?source=collection_archive---------53-----------------------#2021-06-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/66c5dda3b4c12dd2c5884542077387dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pMij4zrMLRzPQbma7GwVMA.jpeg"/></div></div></figure><p id="5e09" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最简单形式的逻辑回归是一种帮助分类数据的分类算法。我们有两个主要分类:</p><ol class=""><li id="9f8f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">二元逻辑回归</strong>，它给出了一个<strong class="is hj">是/否</strong>的答案。</li><li id="4c73" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">多项式/多类物流回归</strong>，它给出了几个可以推导出的选项，几乎就像一个<strong class="is hj">选择题</strong>。</li></ol><h1 id="84bf" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">二元物流回归</h1><p id="c754" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">如上所述，这种给你一个是或不是的答案。我们可以用的例子是，根据一些因变量(特征)，这个人会有心脏病吗？</p><p id="f179" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望这有意义，这是一个简单的是或不是的答案。<br/>让我们在下面的金属工业中想象一下，根据两个特征，根据“凸纹”和“正常PZ”，我们需要确定金属是高品位还是低品位。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/d2c867db0777b4a6cc2e70bdc75740b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*ZtApKQyqXnqasBPbM72cYw.png"/></div></figure><h1 id="37a2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">决策边界</h1><p id="3b04" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">运行物流回归，进行梯度下降，就可以确定什么叫做决策边界。在这里，我们将以</p><ol class=""><li id="6eae" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">θ0-或y轴截距</li><li id="30fa" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">θ1——斜率</li></ol><p id="3fd6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了这些，我们就可以画出如上的决策边界，这有助于我们可视化结果。</p><h1 id="5187" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">假设方程</h1><p id="00a0" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">为了对逻辑回归进行假设以<strong class="is hj">预测一个结果</strong>，我们可以使用下面的等式。您将在下一篇文章中看到这些方法的实际应用，但是现在先不要放弃它们。假设函数是:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/20a311c649f6c00863946a58cb29eb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*1pYD32CvdcWwA1mjBaBQVg.png"/></div></div></figure><p id="02b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">而g是一个sigmoid函数，定义如下:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/8eeae2fe02244b168ea728363cd318d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*3_qTqsBqGlUkJ16bIz96eg.png"/></div></figure><p id="886a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在matlab中，这可以编码如下:</p><pre class="lg lh li lj fd lm ln lo lp aw lq bi"><span id="692c" class="lr kd hi ln b fi ls lt l lu lv">function p = predict(theta, x)<br/>  m = size(x, 1); % Number of training examples<br/>  p = round(sigmoid(X * theta));<br/>end</span></pre><p id="6a77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">而sigmoid函数，可以编码如下:</p><pre class="lg lh li lj fd lm ln lo lp aw lq bi"><span id="e77e" class="lr kd hi ln b fi ls lt l lu lv">function h = sigmoid(z);<br/> h = 1 ./ (1 + exp(-z));<br/>end</span></pre><p id="bec3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">sigmoid函数可如下图所示，并确保我们<strong class="is hj">将始终获得介于0和1 </strong>之间的结果。然后我们可以对这些结果进行四舍五入，得到我们的<strong class="is hj">是或否</strong>答案。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/09f9c7e7bce8748f613c4fe5509da166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*IOGHP396CG8rOlGe3z4CYw.png"/></div></figure><h1 id="ba9d" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">计算假设的成本</h1><p id="59f2" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">所以，现在我们有了预测是/否的方法，我们还需要一种方法来计算我们预测的成本。计算成本时，我们需要计算以下两点:</p><p id="5ac1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">成本函数:</strong>用以下等式定义</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/3ce6490144f9227e61f0e304d29299b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdPooHGQkV6BvtchZiQVMg.png"/></div></div></figure><p id="1550" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">梯度</strong>:这是梯度(导数)，后面计算最佳θ时需要用到。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/c9b8a3be67fffd1a448b96fd3f089208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*n1Yf36uOhLOAJDdvpsr8pA.png"/></div></figure><p id="32db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看上面的方程式代码</p><pre class="lg lh li lj fd lm ln lo lp aw lq bi"><span id="e11c" class="lr kd hi ln b fi ls lt l lu lv">function [J, grad] = cost(theta, x, y)<br/>  [m,n] = size(x);               % get sizes of x<br/>  x = [ones(m,1), x];            % add column of 1's<br/>  gradient = zeros(size(theta)); % initialise gradient<br/>  h = sigmoid(x * theta);        % get hypothesis for this theta</span><span id="7966" class="lr kd hi ln b fi lz lt l lu lv">  % calculate the cost of this theta <br/>  J = ((-y)'*log(h) — (1-y)'*log(1-h))/m; </span><span id="8735" class="lr kd hi ln b fi lz lt l lu lv">  % calculate gradients for each feature<br/>  for j = 1:size(x,2)<br/>    grad(j) = (1/m) * ((h-y)' * X(:,j));<br/>  end<br/>end</span></pre><h1 id="c00e" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">成本优化</h1><p id="1de2" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">现在，我们有了一个可以计算成本和梯度的函数，我们想通过成本优化过程来运行它，这将为我们提供用于<strong class="is hj">未来预测</strong>的<strong class="is hj">最佳θ</strong>。</p><p id="9a5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们很幸运，matlab为我们提供了一个很好的功能。下面的函数称为<strong class="is hj">“寻找无约束多变量的最小值”</strong>。该函数将代表我们完成繁重的工作，遍历各种θ，直到找到<strong class="is hj">最低成本</strong>。下面是一个在Matlab中调用这段代码的例子。</p><pre class="lg lh li lj fd lm ln lo lp aw lq bi"><span id="85ef" class="lr kd hi ln b fi ls lt l lu lv">options = optimset(‘GradObj’,’On’,’MaxIter’,400);<br/>% Run cost optimisation <br/>theta = fminunc(@(t)computeCost(t, x, y, lambda), theta, options)</span></pre><p id="2bf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们看一个好的编码例子之前，我们还有一个话题要讲。当我们比较两个特性时，上面的方法很好，但是当我们有很多特性时，就不好了。</p><p id="0ef4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，是时候<a class="ae ma" href="https://shaun-enslin.medium.com/logistics-regression-regularisation-2-3-4a0d8b85564c" rel="noopener">进入下一篇文章</a>了。</p></div></div>    
</body>
</html>
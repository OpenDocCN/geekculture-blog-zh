<html>
<head>
<title>Getting Started with Celery &amp; RabbitMQ</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">芹菜和兔肉入门</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/getting-started-with-celery-243429df53b9?source=collection_archive---------5-----------------------#2021-04-26">https://medium.com/geekculture/getting-started-with-celery-243429df53b9?source=collection_archive---------5-----------------------#2021-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1f4528104f967d93ad3f58dc083f95c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kdcAU2J_qvOQS6ywOfKs6A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Getting Started with Celery</figcaption></figure><p id="43e0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在这篇文章中，我将涵盖芹菜的基本概念。</p><ul class=""><li id="4bfc" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">什么是任务队列？</li><li id="a15d" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">芹菜介绍</li><li id="3859" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">什么是经纪人？</li><li id="6270" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">选择经纪人</li><li id="0472" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">安装芹菜</li><li id="2859" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">处理芹菜</li><li id="47fc" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">结论</li></ul><p id="2ecb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">让我们开始吧…</p><ol class=""><li id="3a13" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr kg jy jz ka bi translated"><strong class="iw hj">什么是任务队列？</strong></li></ol><ul class=""><li id="a1c7" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">任务<strong class="iw hj">的</strong>就是<strong class="iw hj">的</strong>本质上是一个python函数；给定一组参数就可以完成的任务。任务队列是一组要运行的任务。</li><li id="550b" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">一个应用程序中可以定义多个命名队列。任务队列允许应用程序在用户请求之外异步执行工作，称为任务。</li><li id="3a6b" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">如果应用程序需要在后台执行工作，它会将任务添加到任务队列中。这些任务稍后由工作服务执行。任务队列服务是为异步工作而设计的。</li></ul><p id="a903" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 2。芹菜简介</strong></p><ul class=""><li id="b2a0" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">Celery是一个开源的异步任务队列或作业队列，它基于Python web应用程序的分布式消息传递，用于在HTTP请求-响应周期之外异步执行工作。</li><li id="85f1" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">Celery可以在单台机器上运行，也可以在多台机器上运行，甚至可以跨数据中心运行。</li><li id="fd5e" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">Celery通过消息进行通信，通常使用一个代理在客户和工人之间进行调解。为了启动一个任务，客户机向队列中添加一条消息，然后代理将这条消息传递给一个工人。</li><li id="3001" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">芹菜简单、快速、灵活，而且可用性很高。</li><li id="b413" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">Celery很容易与web框架集成，如<a class="ae kh" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>、<a class="ae kh" href="https://flask.palletsprojects.com/" rel="noopener ugc nofollow" target="_blank"> Flask </a>等。</li></ul><p id="7dbf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 3。什么是经纪人？</strong></p><ul class=""><li id="b2d1" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">经纪人是买方和卖方之间的第三方调解人。</li><li id="4863" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">芹菜需要一个发送和接收消息的解决方案；通常，这是以称为<em class="ki">消息代理</em>的独立服务的形式出现的。</li><li id="7db1" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">在芹菜，经纪人是<a class="ae kh" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank">雷迪斯</a>、<a class="ae kh" href="https://www.rabbitmq.com/" rel="noopener ugc nofollow" target="_blank"> RabbitMQ </a>等在客户和芹菜之间传递消息的人。</li></ul><p id="d47a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 4。选择经纪人</strong></p><ul class=""><li id="1e25" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">在本例中，我使用的是<a class="ae kh" href="https://www.rabbitmq.com/" rel="noopener ugc nofollow" target="_blank"> RabbitMQ </a>。</li><li id="adc4" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">RabbitMQ功能齐全，稳定，耐用，易于安装。这是生产环境的绝佳选择。</li><li id="24ac" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">您可以使用以下命令安装和设置<a class="ae kh" href="http://www.rabbitmq.com/" rel="noopener ugc nofollow" target="_blank"> RabbitMQ </a>:</li></ul><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="6399" class="ks kt hi ko b fi ku kv l kw kx">sudo apt-get install rabbitmq-server</span></pre><p id="61f2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 5。安装芹菜</strong></p><p id="ce0b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Celery在Python包索引(PyPI)上，所以可以用标准的Python工具安装，如<code class="du ky kz la ko b">pip</code>或<code class="du ky kz la ko b">easy_install</code></p><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="1d2e" class="ks kt hi ko b fi ku kv l kw kx">pip install celery</span></pre><p id="08d8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 6。处理芹菜</strong></p><ul class=""><li id="021a" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">创建文件<code class="du ky kz la ko b">tasks.py</code></li></ul><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="98f9" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">from</strong> <strong class="ko hj">celery</strong> <strong class="ko hj">import</strong> Celery<br/><br/>app = Celery('tasks', broker='pyamqp://guest@localhost//')<br/><br/><strong class="ko hj">@app</strong>.task<br/><strong class="ko hj">def</strong> <strong class="ko hj">add</strong>(x, y):<br/>    <strong class="ko hj">return</strong> x + y</span></pre><ul class=""><li id="b7cf" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">现在，您可以通过使用<code class="du ky kz la ko b">worker</code>参数执行我们的程序来运行worker:</li></ul><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="d5ed" class="ks kt hi ko b fi ku kv l kw kx">celery -A tasks worker --loglevel=INFO</span></pre><ul class=""><li id="9741" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">要获得帮助，您可以使用以下命令:</li></ul><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="ad4c" class="ks kt hi ko b fi ku kv l kw kx">celery worker --help<br/>celery help</span></pre><ul class=""><li id="adcc" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">让我们创建一个文件test.py来调用我们的任务</li></ul><pre class="kj kk kl km fd kn ko kp kq aw kr bi"><span id="e9f3" class="ks kt hi ko b fi ku kv l kw kx"><strong class="ko hj">from</strong> <strong class="ko hj">tasks</strong> <strong class="ko hj">import</strong> add</span><span id="dbc5" class="ks kt hi ko b fi lb kv l kw kx">result = add.delay(<strong class="ko hj">4</strong>, <strong class="ko hj">4</strong>)<br/>#delay() is used to call a task</span><span id="6649" class="ks kt hi ko b fi lb kv l kw kx">print(result.ready())<br/>#ready() returns whether the task has finished processing or not.</span><span id="45c3" class="ks kt hi ko b fi lb kv l kw kx">print(result.get(timeout=<strong class="ko hj">1</strong>))<br/>#get() is used for getting results</span><span id="c988" class="ks kt hi ko b fi lb kv l kw kx">result.get(propagate=<strong class="ko hj">False</strong>)<br/>#In case the task raised an exception, <strong class="ko hj">get()</strong> will re-raise the exception, but you can override this by specifying the <!-- -->propagate<!-- --> argument</span></pre><p id="d9fb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 7。结论</strong></p><ul class=""><li id="ff4c" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">Celery是在python中执行异步任务的一个很好的选择。它是分布式的，易于使用。</li><li id="7bc6" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">Celery帮助我们减轻了应用服务器的负担，这有助于我们更快地满足您的请求。</li></ul><p id="d6f9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢阅读。如果你发现这篇文章有用，别忘了与你的朋友和同事分享。:)如果你有任何问题，请随时联系我。<br/> <strong class="iw hj">与我接通👉</strong><a class="ae kh" href="https://linkedin.com/in/hiteshmishra708" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">LinkedIn</strong></a><strong class="iw hj"/><a class="ae kh" href="https://github.com/hiteshmishra708" rel="noopener ugc nofollow" target="_blank"><strong class="iw hj">Github</strong></a><strong class="iw hj">:)</strong></p></div></div>    
</body>
</html>
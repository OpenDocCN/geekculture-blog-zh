<html>
<head>
<title>How to schedule the ETL jobs on AWS The Easy way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何以最简单的方式在AWS上调度ETL作业</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-schedule-the-etl-jobs-on-aws-the-easy-way-41c7ef26c96?source=collection_archive---------10-----------------------#2021-08-05">https://medium.com/geekculture/how-to-schedule-the-etl-jobs-on-aws-the-easy-way-41c7ef26c96?source=collection_archive---------10-----------------------#2021-08-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1064" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">5分钟内从EC2自动执行数据提取作业的分步指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/96ea0c2dbe33cce68b6eb1e0f8bcfa4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPV_y2UNQpJ_LbVkG9MEzA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@hudsoncrafted?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Debby Hudson</a> on <a class="ae jn" href="https://unsplash.com/s/photos/calendar?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8aa9" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">介绍</h1><p id="fe28" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">根据维基百科，<a class="ae jn" href="https://en.wikipedia.org/wiki/Cron" rel="noopener ugc nofollow" target="_blank"> cron </a>是一个软件实用程序，是一个基于时间的任务调度程序，可以在类似Unix的操作系统中找到。Cron在后台运行，使用cron执行计划的作业，称为“cron作业”。</p><p id="a7b5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">本指南提供了如何使用cron的正确语法来调度作业的高级概述。它还介绍了一些使作业时间表更容易编写和理解的方法。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="e853" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">先决条件</h1><p id="6b38" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">要完成本指南，您需要</p><p id="c53f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">1.获取一个AWS EC2实例，本教程基于Ubuntu 18.04版本</p><p id="c37d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">2.EC2凭证，存储在一个<code class="du lt lu lv lw b">.pem</code>文件中</p><p id="c65a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">3.安全传输应用程序，如Windows的WinSCP或macOS的Cyberduck。</p><p id="e50e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">4.Cron已经在EC2上安装并配置好了。</p><p id="6a3b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">5.有一个测试脚本运行在任何语言，我会使用python。</p><p id="afef" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">6.任何代码编辑器，我用的是vscode</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="c033" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">介绍</h1><p id="43ba" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">作为我日常职业的一部分，我从不同的API中提取数据，并将它们加载到数据库中，以便为其他业务部门生成每日/每月报告。在某些情况下，运行脚本并等待它成功加载到数据库中是非常乏味的。因此，我们决定更进一步，将这些python脚本部署到AWS-EC2中，并将它们放在一个cron作业上，以便在特定时间运行。</p><p id="5f1b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">日程安排的好处是巨大的，可以节省大量的时间和精力；例如:</p><ol class=""><li id="ed82" class="lx ly hi ki b kj lc km ld kp lz kt ma kx mb lb mc md me mf bi translated">ETL独立运行，不管谁应该运行它。</li><li id="748b" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">避免在高峰时间消耗大数据的API避免失败。</li><li id="022b" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">避免在个人电脑上运行脚本。</li><li id="ad6f" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">避免生成临时或定期报告的延迟。</li><li id="2d93" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">易于维护</li></ol><p id="26b1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">在所有这些优点之后，让我们开始步骤</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="2970" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">步伐</h1><ol class=""><li id="1ee6" class="lx ly hi ki b kj kk km kn kp ml kt mm kx mn lb mc md me mf bi translated">在第一步中，您需要使用以下命令安全地登录到EC2实例:</li></ol><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="aaac" class="ms jp hi lw b fi mt mu l mv mw">$ssh -i &lt;key-pairs.pem&gt; &lt;ec2_address&gt;  </span></pre><p id="5a3f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Mac用户可以直接通过终端ssh。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/ce74bbfb84e089b1446272abf9378560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VSk84kzA8L_Rm2v8ZlJwA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">selecting a new remote connection for ec2 — image by the author</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/5059e2638a16107dd6ce24c655f33844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LCHpZDXJWxT0ga2LHN6Qw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">running the command from the interface — Image by the author</figcaption></figure><p id="95d2" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">2.登录到ec2实例后，运行以下命令，通过运行以下命令确保cron设置为在后台运行:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="38b9" class="ms jp hi lw b fi mt mu l mv mw">sudo systemctl enable cron</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/1a1d6761551cb0077c3769d6c555b637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2bBL6jq7KJc9TD_ijuZfw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">running sudo systemctl — image by the author</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es na"><img src="../Images/05a935a4f82f8d32201e6a3fd1a97187.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*ZbZ-x0GaGo5ohKDKUPdc6A.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx"><a class="ae jn" href="https://www.cyberciti.biz/humour/top-xkcd-comics-for-linux-and-unix-fans/" rel="noopener ugc nofollow" target="_blank">https://www.cyberciti.biz/humour/top-xkcd-comics-for-linux-and-unix-fans/</a></figcaption></figure><p id="99e4" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">3.接下来，cron将被安装到您的系统上，并准备好让您开始调度作业。</p><p id="0514" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">Crontab是一个负责监控和管理cron作业的文件。</p><p id="1949" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">要调度一个作业，您需要编辑您的crontab并以cron语法的形式编写作业。语法很简单，它有两个部分，调度和运行<strong class="ki hj">命令。</strong></p><p id="780f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">该命令是您通常在本地运行以执行脚本的终端命令。语法的schedule元素有五个不同的字段，按以下顺序编写:</p><p id="eda0" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">综合来看，crontab中调度的作业类似于以下内容:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="db75" class="ms jp hi lw b fi mt mu l mv mw">minute hour DayOfTheMonth month DayOfTheWeek RunningCommand</span></pre><p id="5aa9" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">这里有一个cron作业的工作示例。该表达式在每周二下午5:30运行命令<code class="du lt lu lv lw b">python3.8 src/&lt;my_script.sh&gt;</code>:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="f427" class="ms jp hi lw b fi mt mu l mv mw">30 17 * * 2 python3.8 src/&lt;my_script.sh&gt;</span></pre><p id="b791" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">此外，您可以在cron脚本的schedule部分插入一些特殊字符，以简化调度:</p><p id="b045" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">1.<code class="du lt lu lv lw b">*</code>:在cron表达式中，星号是一个通配符变量，代表“所有”因此，一个被调度的任务<code class="du lt lu lv lw b">* * * * *</code>将在每月每天每小时的每一分钟运行。</p><p id="c98e" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">2.<code class="du lt lu lv lw b">,</code>:逗号将时间表值作为一个列表。如果您需要在每小时开始和结束时运行一个任务，而不是写出两个单独的任务。(例如<code class="du lt lu lv lw b">0 * * * *</code>和<code class="du lt lu lv lw b">30 * * * *</code>)，你可以用<code class="du lt lu lv lw b">0,30 * * * *</code>做同样的事情</p><p id="3876" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">5.<code class="du lt lu lv lw b">/</code>:使用带星号的正斜杠创建步长值。例如，不是每三个月编写四个独立的cron任务来运行一个脚本，而是可以将其调度为<code class="du lt lu lv lw b">0 * * */3 *</code>。</p><p id="0083" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">对于进一步的调度任务组合，有一个由<a class="ae jn" href="https://cronitor.io/" rel="noopener ugc nofollow" target="_blank"> Cronitor </a>命名为<a class="ae jn" href="https://crontab.guru/" rel="noopener ugc nofollow" target="_blank">“Crontab Guru”</a>的cron编辑器，您可以编写您的cron，它会显示与您提供的表达式相对应的预期日期和时间。</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="afd7" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">管理Crontabs</h1><p id="95c4" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">一旦你决定了一个时间表，就需要把它放在当前的守护进程中以便阅读。</p><p id="8c1d" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">必须知道crontab是一个特殊的文件，它保存着cron将要运行的作业的时间表。但是，直接编辑它们是一种不好的做法。或者，您可以使用crontab命令；这使您能够在不改变<code class="du lt lu lv lw b">sudo</code>权限的情况下更新您的用户配置文件的crontab。</p><p id="a34f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">要编辑crontab，可以运行以下命令:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="f328" class="ms jp hi lw b fi mt mu l mv mw">crontab -e</span></pre><p id="11d5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">第一次运行crontab命令时，您需要选择编辑crontab时要使用的编辑器。我用的是nano！</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="a8fd" class="ms jp hi lw b fi mt mu l mv mw">OUTPUT<br/>no crontab for sammy - using an empty one<br/>Select an editor.  To change later, run 'select-editor'.<br/>1. /bin/nano        &lt;---- easiest<br/>2. /usr/bin/vim.basic<br/>3. /usr/bin/vim.tiny<br/>4. /bin/ed</span><span id="6379" class="ms jp hi lw b fi nb mu l mv mw">Choose 1-4 [1]:</span></pre><p id="3957" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">输入与您选择的编辑器相对应的编号。或者，您可以只按<code class="du lt lu lv lw b">ENTER</code>来接受默认选择<code class="du lt lu lv lw b">nano</code>。</p><p id="8e66" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">之后，你会看到这个屏幕，你可以在文件的末尾添加任务</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="01dc" class="ms jp hi lw b fi mt mu l mv mw"># Edit this file to introduce tasks to be run by cron.<br/>#<br/># Each task to run has to be defined through a single line<br/># indicating with different fields when the task will be run<br/># and what command to run for the task<br/>#<br/># To define the time you can provide concrete values for<br/># minute (m), hour (h), day of month (dom), month (mon),<br/># and day of week (dow) or use '*' in these fields (for 'any').#<br/># Notice that tasks will be started based on the cron's system<br/># daemon's notion of time and timezones.<br/>#<br/># Output of the crontab jobs (including errors) is sent through<br/># email to the user the crontab file belongs to (unless redirected).<br/>#<br/># For example, you can run a backup of all your user accounts<br/># at 5 a.m every week with:<br/># 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/<br/>#<br/># For more information see the manual pages of crontab(5) and cron(8)<br/>#<br/># m h  dom mon dow   command</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="e954" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">将文件从本地传输到ec2</h1><h2 id="ae18" class="ms jp hi bd jq nc nd ne ju nf ng nh jy kp ni nj ka kt nk nl kc kx nm nn ke no bi translated">使用Cyberduck(仅限macOS)</h2><p id="8170" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">1.打开Cyberduck，它通常位于“应用程序”文件夹中。或者通过简单的Spotlight搜索打开。</p><p id="21ba" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">2.单击打开连接，并从下拉列表中选择从SFTP (SSH文件传输协议)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es np"><img src="../Images/9e22b56c950c0bfd7cb8d8e044a5e830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipsMRFBCh19Kib1PN7q4ew.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">configure cyber duck — image by the author</figcaption></figure><p id="2a36" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">3.如上所述，输入EC2实例服务器名称和用户名。</p><p id="a210" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">4.使用下拉菜单选择您的私钥pem文件，以选择文件的位置。</p><p id="e526" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">到目前为止，您应该已经有了一个到EC2实例的SFTP连接。这就是全部了！此时，您可能希望创建一个书签来保存您的设置以备将来使用。</p><p id="dd46" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">您现在可以轻松地传输文件夹/文件，而不会有任何痛苦！</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="68e6" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">在EC2上设置目录env</h1><p id="e661" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">脚本目录应该已经转移到ec2实例。下一步是创建一个bash脚本来模拟这个过程，如果您在本地运行相同的脚本的话。</p><p id="9056" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">为你正在工作的项目文件夹创建一个虚拟环境是一个很好的实践，如果你不熟悉或者需要复习，你可以查看<a class="ae jn" href="https://towardsdatascience.com/how-to-set-up-python3-the-right-easy-way-11c18b0b4ac0" rel="noopener" target="_blank">如何以正确简单的方式</a>设置python3。一旦我们有了requirements.txt文件，我们就可以开始部署过程了。</p><p id="26b5" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">复制项目目录后，您需要安装所有必需的包，并在根路径下创建一个虚拟env。</p><p id="4a5f" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">当您在上传cron作业所需的脚本后登录EC2时，您需要遵循以下步骤:</p><ol class=""><li id="7cf2" class="lx ly hi ki b kj lc km ld kp lz kt ma kx mb lb mc md me mf bi translated">确保该脚本在您的本地计算机上运行。</li><li id="2bbb" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">创建一个requirements.txt文件，包括脚本中使用的所有包</li><li id="a30d" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">使用SFTP将脚本传输到EC2实例</li><li id="af46" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">移动到目录并使用创建一个虚拟环境</li></ol><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="5584" class="ms jp hi lw b fi mt mu l mv mw">virtualenv --python=python venv</span></pre><p id="11a1" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">5.激活虚拟</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="e4eb" class="ms jp hi lw b fi mt mu l mv mw">source venv/bin/activate</span></pre><p id="8480" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">5.安装所有软件包</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="383f" class="ms jp hi lw b fi mt mu l mv mw">pip install -rrequirements.txt</span></pre><p id="5bef" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">6.在您的本地上，创建一个新的shell脚本，并在其中编写以下代码</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="dbaf" class="ms jp hi lw b fi mt mu l mv mw">cd &lt;path_to_script_directory&gt;<br/>source &lt;virtual_env_name&gt;/bin/activate<br/>python &lt;script_name.py&gt;</span></pre><p id="4380" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">7.将此文件另存为<cron_name>。嘘</cron_name></p><p id="572c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">8.使用SFTP接口将该文件上传到EC2的主目录</p><p id="2b72" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">9.从EC2终端，通过启动一个新的crontab来编写一个cron作业</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="f2f6" class="ms jp hi lw b fi mt mu l mv mw">crontab -e</span></pre><p id="522b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">10.如下记下cron作业:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="0009" class="ms jp hi lw b fi mt mu l mv mw">* * * * * bash /home/ubuntu/&lt;cron_name&gt;.sh</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="44d0" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">笔记</h1><p id="5cc9" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">在将来运行crontab -e时，它会自动将您带到文本编辑器。然后你可以在新的一行写下每项任务的时间表。完成后，可以使用以下命令保存并关闭crontab</p><p id="227a" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">CTRL + X -&gt; Y -&gt; ENTER如果选择了nano。</p><p id="4b4c" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">如果您想列出您拥有的crontabs，应该使用以下命令:</p><pre class="iy iz ja jb fd mo lw mp mq aw mr bi"><span id="1b3a" class="ms jp hi lw b fi mt mu l mv mw">crontab -l</span></pre></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="8bed" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">结束语</h1><p id="c43d" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">通过本指南，我们已经探索了如何在基于Linux的系统上编写您的第一个cron作业。为作业设置时间表是自动化ETL任务并监控其性能的一个好方法。我希望这个指南能帮助你轻松地安排你的工作。</p><p id="400b" class="pw-post-body-paragraph kg kh hi ki b kj lc ij kl km ld im ko kp le kr ks kt lf kv kw kx lg kz la lb hb bi translated">最后，我希望这给出了一个关于实现cronjobs的全面指南，并从中获得最大收益。如果你遇到任何问题，请在评论区列出来；我很乐意帮忙。鼓励我的最好方式是在<a class="ae jn" rel="noopener" href="/@salmaeng71"><strong class="ki hj">Medium</strong></a><a class="ae jn" href="https://www.linkedin.com/in/salma-elshahawy/" rel="noopener ugc nofollow" target="_blank"><strong class="ki hj">LinkedIn</strong></a><strong class="ki hj"/>或<a class="ae jn" href="https://github.com/salma71" rel="noopener ugc nofollow" target="_blank"> <strong class="ki hj"> Github </strong> </a> <strong class="ki hj">上跟随我。</strong>快乐学习！</p></div><div class="ab cl lh li gp lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hb hc hd he hf"><h1 id="f2f5" class="jo jp hi bd jq jr lo jt ju jv lp jx jy io lq ip ka ir lr is kc iu ls iv ke kf bi translated">参考</h1><ol class=""><li id="19ca" class="lx ly hi ki b kj kk km kn kp ml kt mm kx mn lb mc md me mf bi translated">如何每三个月运行一次cron作业，<a class="ae jn" href="https://serverfault.com/questions/129633/how-to-run-cron-job-every-3-months" rel="noopener ugc nofollow" target="_blank">服务器保险库-堆栈交换</a></li><li id="66cb" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">监控任何cron作业或计划任务— <a class="ae jn" href="https://cronitor.io/cron-job-monitoring?utm_source=crontabguru&amp;utm_campaign=cronitor_top" rel="noopener ugc nofollow" target="_blank"> Cronitor </a></li><li id="2420" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">如何在Linux上使用cron—<a class="ae jn" href="https://opensource.com/article/17/11/how-use-cron-linux" rel="noopener ugc nofollow" target="_blank">开源</a></li><li id="725b" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">如何在Linux中设置cron作业— <a class="ae jn" href="https://phoenixnap.com/kb/set-up-cron-job-linux" rel="noopener ugc nofollow" target="_blank"> phoenixnap </a></li><li id="630d" class="lx ly hi ki b kj mg km mh kp mi kt mj kx mk lb mc md me mf bi translated">如何列表显示查看所有cron作业Linux — <a class="ae jn" href="https://phoenixnap.it/kb/how-to-list-display-view-all-cron-jobs-linux" rel="noopener ugc nofollow" target="_blank"> phoenixnap </a></li></ol></div></div>    
</body>
</html>
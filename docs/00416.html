<html>
<head>
<title>Setting up python environment in macOS using Homebrew, Pyenv, and Pipenv</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Homebrew、Pyenv和Pipenv在macOS中设置python环境</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/setting-up-python-environment-in-macos-using-pyenv-and-pipenv-116293da8e72?source=collection_archive---------0-----------------------#2021-02-04">https://medium.com/geekculture/setting-up-python-environment-in-macos-using-pyenv-and-pipenv-116293da8e72?source=collection_archive---------0-----------------------#2021-02-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6468" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如果您正在处理需要部署到生产环境并维护干净代码库的不同项目，Pyenv和Pipenv是必要的工具。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/2f4a19d6418d4369b2594681055bfaf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySgFIISCBZ79DY7y3xHPwg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">A high-level overview of how Pyenv and Pipenv are different and solve the bigger problem.</figcaption></figure><p id="d93a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在本地系统中处理不同的项目时，我们经常会遇到一个问题</p><ol class=""><li id="1e0b" class="kj kk hi jp b jq jr jt ju jw kl ka km ke kn ki ko kp kq kr bi translated">对于不同的项目，我们可能需要不同的python版本(不太常见)</li><li id="e044" class="kj kk hi jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated">我们可能需要与特定版本兼容的python包(更有可能)。</li><li id="3012" class="kj kk hi jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated">不同项目的虚拟环境便于部署</li></ol><p id="6dca" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在遇到这个问题后，我找到了一个完美的解决方案，它使用了两个非常棒的库——Pyenv和Pipenv。</p><p id="e2d6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Pyenv是管理python版本，Pipenv是创建每个项目所需的虚拟环境，管理每个项目的Python包及其依赖关系。</p><p id="e9ec" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这是在本地进行不同项目的一个很好的方式，没有任何麻烦。</p><p id="6e41" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们将使用自制软件安装Pyenv和Pipenv。如果你已经有了自制软件，跳过下一步。</p><h2 id="d877" class="kx ky hi bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">安装自制软件</h2><p id="f676" class="pw-post-body-paragraph jn jo hi jp b jq ls ij js jt lt im jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">家酿是一个macOS的软件包管理器。还有其他像MacPorts这样的包管理器，但是家酿很容易也很受欢迎。这是我的一站式软件包管理器，用于安装一些软件包，如java、scala、apache-spark、python…</p><p id="8062" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">只需运行下面的代码从它的git repo安装家酿。或者查看他们的官方页面—【https://brew.sh/ T2】获取说明和故障排除</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="a062" class="kx ky hi lz b fi md me l mf mg">ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"</span></pre><h2 id="6bb2" class="kx ky hi bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">安装Pyenv</h2><p id="8534" class="pw-post-body-paragraph jn jo hi jp b jq ls ij js jt lt im jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">我们可以使用带有<code class="du mh mi mj lz b">brew install python</code>的自制软件或特定版本<code class="du mh mi mj lz b">brew install python@3.7</code>来安装python，但是使用Pyenv是处理不同版本的更好方式。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="be29" class="kx ky hi lz b fi md me l mf mg">brew install pyenv</span></pre><p id="9603" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">也将这段代码添加到您的。zshrc或者。bashrc，取决于你用的shell。然后重新启动终端，使更改生效。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="ee8a" class="kx ky hi lz b fi md me l mf mg">if command -v pyenv 1&gt;/dev/null 2&gt;&amp;1; then<br/>  eval "$(pyenv init -)"<br/>fi</span></pre><p id="95b8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要查看所有pyenv可用的python版本:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="1f52" class="kx ky hi lz b fi md me l mf mg">pyenv install --list</span></pre><p id="84e3" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要安装特定版本:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="b8b4" class="kx ky hi lz b fi md me l mf mg">pyenv install 3.7.0</span></pre><p id="e3e6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">默认情况下，macOS选择系统python版本。要将pyenv版本设置为默认值:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="3c8c" class="kx ky hi lz b fi md me l mf mg">pyenv global 3.7.0</span></pre><p id="dd19" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">检查python版本，它应该反映如上设置的版本:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="da0a" class="kx ky hi lz b fi md me l mf mg">python --version</span></pre><p id="dbda" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果特定项目需要不同的python版本，则首先安装该版本(如果尚未安装)，导航到项目文件夹，并将该版本设置为该文件夹的本地版本。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="90f8" class="kx ky hi lz b fi md me l mf mg">pyenv install 3.6.5<br/>cd &lt;path to project folder&gt;<br/>pyenv local 3.6.5</span></pre><p id="78f6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这样，一个特定的项目将使用3.6.5版本，所有其他项目默认使用3.7.0版本。</p><p id="5e00" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要检查使用pyenv安装的所有python版本，请输入以下命令:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="ea8c" class="kx ky hi lz b fi md me l mf mg">pyenv versions</span></pre><p id="d19b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">查看他们的主页了解更多详情—【https://github.com/pyenv/pyenv T4】</p><h2 id="8e44" class="kx ky hi bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">安装管道</h2><p id="fcfc" class="pw-post-body-paragraph jn jo hi jp b jq ls ij js jt lt im jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">而pyenv将拥有不同版本的python，并能够在它们之间轻松切换。Pipenv是为不同的项目创建虚拟环境，我们需要不同版本的python包。总的来说，我建议使用虚拟环境，这样可以很容易地在生产中复制或者共享项目所需的包列表。</p><p id="f94b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">使用自制软件安装Pipenv:</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="04df" class="kx ky hi lz b fi md me l mf mg">brew install pipenv</span></pre><p id="2ecb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">注意:</strong>这个pipenv创建了对python版本的依赖，该版本在pyenv中被设置为全局的。</p><p id="8387" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">导航到项目文件夹并运行<code class="du mh mi mj lz b">pipenv install</code></p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="d190" class="kx ky hi lz b fi md me l mf mg">cd &lt;path to project folder&gt;<br/>pipenv install</span></pre><p id="7705" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这将在该文件夹中创建一个虚拟环境。虚拟环境的名称与文件夹名称相同。(注:我的全球版本是3.8.1)</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/24682f651ef3efe74108b17565086a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0UfhKdmCeUJzRfigN8yAA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Using pipenv to create a virtual environment within the project folder.</figcaption></figure><p id="0f5f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果您有一个包含requirements.txt的现有项目文件夹，这也将安装该文件中列出的包。</p><p id="2e9e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">它还创建了两个文件——Pipfile和Pipfile.lock。</p><p id="2802" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要安装任何软件包，请执行pipenv install <list of="" packages="" separated="" by="" space="">。不需要激活虚拟环境。注意是<strong class="jp hj"> pipenv </strong>而不是<strong class="jp hj"> pip </strong>。</list></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/df81e6fa84d79c335378d6b74325b5d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44mkVU_noPdx8FhhrDZ1Aw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Using pipenv to install necessary packages.</figcaption></figure><p id="374a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在让我们看一下Pipfile。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es et"><img src="../Images/795a5280a294f417784a8b391dada728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXCvx00TcOmq-0-dKlDhSA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Contents of Pipfile created by pipenv install.</figcaption></figure><p id="72e8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Pipenv中另一个很棒的命令，用来查找包之间的依赖关系，它存储在Pipfile中</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="b86f" class="kx ky hi lz b fi md me l mf mg">pipenv graph</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/8f0230161c2e7dec2dbfec267bf48034.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEhBq4DWLePkFDO4m0tbzQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Results of Pipenv graph command.</figcaption></figure><p id="8a77" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如果只安装了seaborn，那么所有这些包也会被安装。这是显示依赖关系的一种很好的方式，与不知道哪个包依赖哪个包或者为什么某个包在列表中的<code class="du mh mi mj lz b">pip list</code>相比，我非常喜欢这种方法。</p><p id="81f8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">反过来也一样。当卸载<code class="du mh mi mj lz b">pipenv uninstall pandas</code>时，它会移除其他包不需要的依赖包。</p><p id="17ec" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">要运行python文件，请使用<code class="du mh mi mj lz b">pipenv run python &lt;file.py&gt;</code>。不需要激活虚拟环境并从中运行python。一行代码就能完成所有工作，而且非常简单。</p><p id="281b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Pipenv比我在本文中提到的要多得多。因此，我建议仔细阅读他们的文档以了解更多细节和定制—<a class="ae lx" href="https://docs.pipenv.org/" rel="noopener ugc nofollow" target="_blank">https://docs.pipenv.org/</a></p><p id="e559" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">专业提示:</strong>为中的所有命令创建别名。zshrc或者. bashrc .下面是我的列表供参考。</p><pre class="iy iz ja jb fd ly lz ma mb aw mc bi"><span id="200e" class="kx ky hi lz b fi md me l mf mg">alias py="python $1"<br/>alias prp="pipenv run python $1"<br/>alias ps="pipenv shell"<br/>alias pi="pipenv install $1"<br/>alias pu="pipenv uninstall $1"<br/>alias pg="pipenv graph"<br/>alias pr="pipenv --rm"</span></pre><h2 id="2b8e" class="kx ky hi bd kz la lb lc ld le lf lg lh jw li lj lk ka ll lm ln ke lo lp lq lr bi translated">结论</h2><p id="322e" class="pw-post-body-paragraph jn jo hi jp b jq ls ij js jt lt im jv jw lu jy jz ka lv kc kd ke lw kg kh ki hb bi translated">当处理需要不同python版本或不同python包的不同项目时，或者为了易于部署，pyenv+pipenv是一个极好的组合。设置它需要一点时间和精力，但从长远来看是值得的。</p></div></div>    
</body>
</html>
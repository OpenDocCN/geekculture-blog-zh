<html>
<head>
<title>SQL HackerRank : Interviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL HackerRank:访谈</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/sql-hackerrank-interviews-1f79dfa0a971?source=collection_archive---------2-----------------------#2022-01-06">https://medium.com/geekculture/sql-hackerrank-interviews-1f79dfa0a971?source=collection_archive---------2-----------------------#2022-01-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="4300" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">硬连接:高级SQL连接</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/9ddc318893339c472981fc5d30c5fe97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4sEYplhWgww3TYZ88Uy6g.jpeg"/></div></div></figure><p id="d185" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题陈述:萨曼莎通过编码挑战和竞赛采访了许多来自不同大学的候选人。编写一个查询来打印contest_id、hacker_id、名称以及按contest_id排序的每个竞赛的total_submissions、total_accepted_submissions、total_views和total_unique_views的总和。如果四项总和都是<strong class="ih hj"> 0 </strong>，则从结果中排除比赛。</p><p id="52b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注:</strong>一个特定的大赛可以在多个学院进行候选人筛选，但每个学院只举办<strong class="ih hj"> 1次</strong>筛选赛。</p><p id="c677" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jp" href="https://www.hackerrank.com/challenges/interviews/problem" rel="noopener ugc nofollow" target="_blank">链接</a>到HackerRank问题。</p><p id="a78d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">输入格式</strong></p><p id="3837" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下表包含面试数据:</p><ul class=""><li id="c5b3" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">contests:contest _ id是竞赛的id，hacker_id是创建竞赛的黑客的id，name是黑客的名字。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jz"><img src="../Images/52cfe0dba8d92e378ee95e23c2ace6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/0*XZy6wCMBMH8UKdqD.png"/></div></figure><ul class=""><li id="24ef" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">colleges:college _ id是学院的id，contest_id是Samantha用来筛选候选人的竞赛的id。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/5668023fb231ce71f9595705f7fda380.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/0*i_Eev0Q1aZMzdYQl.png"/></div></figure><ul class=""><li id="50ee" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">challenges:challenge _ id是challenge的id，它属于Samantha忘记了其竞赛id的竞赛之一，college_id是向候选人提供挑战的学院的id。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/54b218fa29bc371370cf318d5237bc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/0*41mocxhb7wbvnceN.png"/></div></figure><ul class=""><li id="9745" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">view _ Stats:challenge _ id是质询的id，total_views是候选人查看质询的次数，total_unique_views是唯一候选人查看质询的次数。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kc"><img src="../Images/7fb965a1c8bae202842814ac606f82c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/0*hQ1cHUF24yUMSoHB.png"/></div></figure><ul class=""><li id="14df" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">submission _ Stats:challenge _ id是挑战的id，total_submissions是挑战的提交次数，total_accepted_submission是获得满分的提交次数。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/2927d13c2a441d9d664f3199a4f64f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/0*WEJCTc0vl3rWUyKA.png"/></div></figure></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="f523" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案及其演练</strong> :-</p><p id="7b94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">整体工作流程如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kl"><img src="../Images/73d325ea65a5db5017dab238be1c5ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svv8_8rrXJ_2JGv3daX8Bw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Relationship Diagram</figcaption></figure><p id="a6d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">竞赛、大学和挑战表的样本数据集:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kq"><img src="../Images/cd3bff0b16824cc924220c5c7e1d67e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXoVYfCa6l3aHM4_QxRYJQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Sample Dataset 1</figcaption></figure><p id="2b94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">View_Stats和Submission_Stats表的样本数据集:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kr"><img src="../Images/92fa7f5b900180f665edc314647640d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zOUMdXIc7r_FvdUhivUfZw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Sample Dataset 2</figcaption></figure><p id="29ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第一步:</strong>我们来拿竞赛_id: 66406。我们想得到所有举办过Contest_id: 66406的大学。</p><p id="1e0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只有学院_id : 11219举办过大赛_id: 66406。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/229f30832e7d28bf571b16bbe460a986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*qYLHto4wd5naAooKvE7T6Q.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 1</figcaption></figure><p id="143d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询:-</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3ad1" class="ky kz hi ku b fi la lb l lc ld">SELECT con.contest_id, con.hacker_id, con.name, col.college_id <br/>FROM Contests con<br/>inner join Colleges col on con.contest_id = col.contest_id</span></pre><p id="8492" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong></p><p id="fa7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在college_id : 11219有两个挑战，挑战id为18765和47127</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/0e21c77ac842e5a8fb8dd7abc551652b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*1pNTmKtohNn3OP4YiDNJDg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 2</figcaption></figure><p id="f7e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询:-</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="7899" class="ky kz hi ku b fi la lb l lc ld">SELECT con.contest_id, con.hacker_id, con.name, ch.challenge_id <br/>FROM Contests con<br/>inner join Colleges col on con.contest_id = col.contest_id<br/>inner join Challenges ch on col.college_id = ch.college_id</span></pre><p id="110e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第3步:</strong>按challenge_id查找总浏览量和总提交量</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/46a2b0f25c3e7cc22c7ef440cf22f13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGb99TqOAdxkM9HKn3fxKA.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 3-a</figcaption></figure><p id="c075" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的示例中，挑战id为18765和47127</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/3a665268610958c75728a59f4849e734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_A9WpoZGyR9zjH1PLeSAg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 3-b</figcaption></figure><p id="8c17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们必须将这个结果与第二步的结果结合起来。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/c034220fad7683f5e93dacb7aec267e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvJnUPgkUcb1fUkIln6BFg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 3-c</figcaption></figure><p id="5358" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询:-</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="2042" class="ky kz hi ku b fi la lb l lc ld">WITH Sub_stats_cte as<br/>(<br/>select challenge_id, SUM(total_Submissions) as total_submissions, SUM(total_accepted_Submissions) as total_accepted_submissions <br/>from Submission_Stats group by challenge_id <br/>), View_stats_cte as<br/>(<br/>select challenge_id, SUM(total_views) as total_views, SUM(total_unique_views) as total_unique_views <br/>from View_Stats group by challenge_id <br/>)<br/>SELECT con.contest_id, con.hacker_id, con.name, ch.challenge_id, total_submissions, total_accepted_submissions<br/> total_views, total_unique_views<br/>FROM Contests con<br/>inner join Colleges col on con.contest_id = col.contest_id<br/>inner join Challenges ch on col.college_id = ch.college_id<br/>left join Sub_stats_cte c1 ON ch.challenge_id = c1.challenge_id<br/>left join View_stats_cte c2 ON ch.challenge_id = c2.challenge_id</span></pre><p id="475b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第4步:</strong>汇总结果</p><p id="d02b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们需要按竞赛id排序的每个竞赛的total_submissions、total_accepted_submissions、total_views和total_unique_views的总和。</p><p id="6e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">total _ views = 115+41 = 155<br/>total _ unique _ views = 23+33 = 56<br/>total _ submissions = NULL(0)+111 = 111<br/>total _ accepted _ submissions = NULL(0)+39 = 39</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/192062243113a3901c3d9826a1bce76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMIyDqfBubon9f5NNH_W1g.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Part 4</figcaption></figure><p id="251c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">查询:-</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="cdce" class="ky kz hi ku b fi la lb l lc ld">WITH Sub_stats_cte as<br/>(<br/>select challenge_id, SUM(total_Submissions) as total_submissions, SUM(total_accepted_Submissions) as total_accepted_submissions <br/>from Submission_Stats group by challenge_id <br/>), View_stats_cte as<br/>(<br/>select challenge_id, SUM(total_views) as total_views, SUM(total_unique_views) as total_unique_views <br/>from View_Stats group by challenge_id <br/>)<br/>SELECT con.contest_id, con.hacker_id, con.name, ISNULL(SUM(total_submissions),0) total_submissions, <br/>ISNULL(SUM(total_accepted_submissions),0) total_accepted_submissions,<br/>ISNULL(SUM(total_views),0) total_views, ISNULL(SUM(total_unique_views),0) total_unique_views<br/>FROM Contests con<br/>inner join Colleges col on con.contest_id = col.contest_id<br/>inner join Challenges ch on col.college_id = ch.college_id<br/>LEFT JOIN Sub_stats_cte c1 ON ch.challenge_id = c1.challenge_id <br/>LEFT JOIN View_stats_cte c2 ON ch.challenge_id = c2.challenge_id<br/>GROUP BY con.contest_id, con.hacker_id, con.name<br/>HAVING SUM(total_submissions)&gt;0<br/>OR SUM(total_accepted_submissions)&gt;0<br/>OR SUM(total_views)&gt;0<br/>OR SUM(total_unique_views)&gt;0<br/>ORDER BY contest_id;</span></pre><p id="0290" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lj">注意:如果四个和都是</em> <strong class="ih hj"> <em class="lj"> 0 </em> </strong> <em class="lj">，我们必须从结果中排除这场比赛。这就是我们使用HAVING子句的原因。</em></p><p id="88fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">下面是对给定数据集的上述查询的结果。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/71e3383d49e47af06205749429396c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pXgPVovjy8N31JBwzb45Dg.png"/></div></div></figure></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="5a37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我准备了下面的脚本，如果有人想尝试这个问题以及样本数据集。这将消除从零开始创建虚拟数据集的麻烦:D</p><pre class="je jf jg jh fd kt ku kv kw aw kx bi"><span id="3739" class="ky kz hi ku b fi la lb l lc ld">with Contests as<br/>(<br/>select 66406 as contest_id, 17973 as hacker_id,'Rose' as name union all<br/>select 66556 as contest_id, 79153 as hacker_id,'Angela' as name union all<br/>select 94828 as contest_id, 80275 as hacker_id,'Frank' as name <br/>), Colleges as<br/>(<br/>select 11219 as college_id, 66406 as contest_id union all<br/>select 32473 as college_id, 66556 as contest_id union all<br/>select 56685 as college_id, 94828 as contest_id<br/>), Challenges as <br/>(<br/>select 18765 as challenge_id, 11219 as college_id union all<br/>select 47127 as challenge_id, 11219 as college_id union all<br/>select 60292 as challenge_id, 32473 as college_id union all<br/>select 72974 as challenge_id, 56685 as college_id <br/>), View_Stats as<br/>(<br/>select 47127 as challenge_id, 26 as total_views, 19 as total_unique_views union all<br/>select 47127 as challenge_id, 15 as total_views, 14 as total_unique_views union all<br/>select 18765 as challenge_id, 43 as total_views, 10 as total_unique_views union all<br/>select 18765 as challenge_id, 72 as total_views, 13 as total_unique_views union all<br/>select 75516 as challenge_id, 35 as total_views, 17 as total_unique_views union all<br/>select 60292 as challenge_id, 11 as total_views, 10 as total_unique_views union all<br/>select 72974 as challenge_id, 41 as total_views, 15 as total_unique_views union all<br/>select 75516 as challenge_id, 75 as total_views, 11 as total_unique_views<br/>), Submission_Stats as<br/>(<br/>select 75516 as challenge_id, 34 as total_Submissions, 12 as total_accepted_Submissions union all<br/>select 47127 as challenge_id, 27 as total_Submissions, 10 as total_accepted_Submissions union all<br/>select 47127 as challenge_id, 56 as total_Submissions, 18 as total_accepted_Submissions union all<br/>select 75516 as challenge_id, 74 as total_Submissions, 12 as total_accepted_Submissions union all<br/>select 75516 as challenge_id, 83 as total_Submissions, 8 as total_accepted_Submissions union all<br/>select 72974 as challenge_id, 68 as total_Submissions, 24 as total_accepted_Submissions union all<br/>select 72974 as challenge_id, 82 as total_Submissions, 14 as total_accepted_Submissions union all<br/>select 47127 as challenge_id, 28 as total_Submissions, 11 as total_accepted_Submissions<br/>), Sub_stats_cte as<br/>(<br/>select challenge_id, SUM(total_Submissions) as total_submissions, SUM(total_accepted_Submissions) as total_accepted_submissions <br/>from Submission_Stats group by challenge_id <br/>), View_stats_cte as<br/>(<br/>select challenge_id, SUM(total_views) as total_views, SUM(total_unique_views) as total_unique_views <br/>from View_Stats group by challenge_id <br/>)<br/>SELECT con.contest_id, con.hacker_id, con.name, ISNULL(SUM(total_submissions),0) total_submissions, <br/>ISNULL(SUM(total_accepted_submissions),0) total_accepted_submissions,<br/>ISNULL(SUM(total_views),0) total_views, ISNULL(SUM(total_unique_views),0) total_unique_views<br/>FROM Contests con<br/>inner join Colleges col on con.contest_id = col.contest_id<br/>inner join Challenges ch on col.college_id = ch.college_id<br/>LEFT JOIN Sub_stats_cte T1 ON ch.challenge_id = T1.challenge_id <br/>LEFT JOIN View_stats_cte T2 ON ch.challenge_id = T2.challenge_id<br/>GROUP BY con.contest_id, con.hacker_id, con.name<br/>HAVING SUM(total_submissions)&gt;0<br/>OR SUM(total_accepted_submissions)&gt;0<br/>OR SUM(total_views)&gt;0<br/>OR SUM(total_unique_views)&gt;0<br/>ORDER BY contest_id;</span></pre></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="90ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你觉得这篇文章很有帮助，请与你的朋友和同事分享。如果还有其他问题，可以在<a class="ae jp" href="https://www.linkedin.com/in/shefali-bisht/" rel="noopener ugc nofollow" target="_blank"><em class="lj">Linkedin</em></a><em class="lj">上找我。</em></p></div></div>    
</body>
</html>
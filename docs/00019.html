<html>
<head>
<title>Going Serverless with AWS Lambda Functions — 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS Lambda函数实现无服务器— 1</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/going-serverless-with-aws-lambda-functions-1-edec330c2bce?source=collection_archive---------2-----------------------#2019-01-06">https://medium.com/geekculture/going-serverless-with-aws-lambda-functions-1-edec330c2bce?source=collection_archive---------2-----------------------#2019-01-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/de8812606fa81cf49eea41b43f57f4ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKIc1WANH4xdkcs2U2tfMw.png"/></div></div></figure><p id="6e28" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几年前，传统的物理服务器被云服务器所取代，现在，无服务器成为新的时尚。在无服务器执行中，服务器在那里，但是我们不再需要管理那些服务器。所有这些都由服务提供商负责。除此之外，由于除非触发触发器，否则不会有服务器实例运行，所以不会产生任何成本，而触发器在执行结束后立即终止。AWS Lambda功能通过按需提供计算资源而无需供应或管理服务器来促进无服务器执行，可以以不同的方式触发:HTTP请求、向S3上传新文档、计划的作业、AWS Kinesis数据流或来自AWS简单通知服务(SNS)的通知。</p><p id="f265" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">AWS Lambda函数可能看起来是无处不在的解决方案，但是使用它们有一些限制。单个lambda函数具有512 MBs的有限存储空间，在用于部署包的压缩形式中具有50 MBs的有限大小，并且是短暂的，最长15分钟。上面提到的所有缺点都可以用一种或另一种方法来处理。除此之外，AWS Lambda功能还有一个更重要的问题，即冷启动。Lambda函数处理第一个请求需要一些时间，因为Lambda必须启动该函数的一个新实例。如果在任何时候您期望快速响应，而您的函数没有活动实例，那么冷启动对您的函数来说可能是一个真正的问题。</p><p id="e763" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我将向您简要介绍简单和复杂的Lambda函数创建，以及使用AWS CLI创建和配置AWS Lambda层，以便与AWS Lambda函数一起使用，这使我们超越了最大50 MBs部署包的限制，允许我们拥有最多5层不同的库，库的总解压缩大小高达250 MBs。</p><p id="88f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，我们将介绍使用API创建一个简单的Lambda函数的步骤:</p><ol class=""><li id="877b" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">首先，登录AWS帐户。</li></ol><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jx"><img src="../Images/ae8be354b630749bebb219d40d0fdd13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeQjFU2iITuekWXUKRXEWw.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">AWS Login Screen</figcaption></figure><p id="ad80" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.转到Lambda仪表板。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kg"><img src="../Images/bf2ab48a507e5a0bd0fcaf2f46537aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hM3iqrS4QaczgW64hKQmYQ.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">AWS Service Dashboard</figcaption></figure><p id="cf82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.在Lambda仪表板上，单击创建函数选项。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/704c22942c700c64e20483e1a989b983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GGTBYZfQgg09qeFg7VJxPA.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">AWS Lambda Dashboard</figcaption></figure><p id="a381" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.在创建函数屏幕上，键入Lambda函数的名称，选择运行时环境，然后在角色选择区域中选择创建自定义角色，这将引导您进入角色创建屏幕。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/b0534ead1fb1bc3c09c5107792b4c476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r2R58SjXWHCqH6ydQm6eSg.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">Create Lambda Function Screen</figcaption></figure><p id="11d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Lambda角色:</strong>每个Lambda函数都有一个与之关联的IAM角色(执行角色)。在创建Lambda函数时指定IAM角色。您授予该角色的权限决定了AWS Lambda在承担该角色时可以做什么。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/1d8904f244d9e77b7f7006990676217a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIssEYwAQRE3kGO-wXVgKw.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">Role Creation Screen</figcaption></figure><p id="2243" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.现在，我们将选择lambda_basic_execution角色，该角色将只授予Amazon CloudWatch Logs操作写日志的权限。我们将使用这个策略，因为我们的Lambda函数是一个基本函数，除了写日志之外，不会访问任何其他AWS资源。</p><p id="c2ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">发布这篇文章，点击“允许”,这将带你回到“创建函数”屏幕，一个现有的lambda_basic_execution角色将被选中。之后，点击创建函数</p><p id="21f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.我们将进入Lambda配置屏幕，使用该屏幕我们可以更改Lambda功能的所有设置。主要包括添加/移除触发器、更改lambda函数、更改其角色、内存分配、设置环境变量、设置超时周期、选择虚拟私有云(VPC)以及设置错误处理机制。</p><div class="jy jz ka kb fd ab cb"><figure class="kk ij kl km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/5543258ea4e1640939004e42bb7c9383.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*JPq_iSlS-HNLwOdM_lOr6A.png"/></div></figure><figure class="kk ij kq km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ac64515f02bd5b1f2b28f7c3a71462ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*ElFrqyV2WB2OoNMiVSiLmA.png"/></div></figure><figure class="kk ij kr km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/080b05fc359c3156ea52f98dd11bb8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*uRlLFWVk4EVXk7mlxbZ0BQ.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx ks di kt ku">Lambda Configuration Screen</figcaption></figure></div><p id="358f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在激活Lambda功能之前，我们应该始终对所需的设置进行更改。目前，主要设置有:</p><ol class=""><li id="c100" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">引发</li><li id="31a6" class="jo jp hi is b it kv ix kw jb kx jf ky jj kz jn jt ju jv jw bi translated">Lambda函数的代码和lambda处理函数。</li><li id="707d" class="jo jp hi is b it kv ix kw jb kx jf ky jj kz jn jt ju jv jw bi translated">超时</li><li id="f4f2" class="jo jp hi is b it kv ix kw jb kx jf ky jj kz jn jt ju jv jw bi translated">分配的内存</li><li id="9856" class="jo jp hi is b it kv ix kw jb kx jf ky jj kz jn jt ju jv jw bi translated">角色和权限</li></ol><p id="d810" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.现在，我们将为我们的函数设置触发器(触发器实际上是应该调用和执行lambda函数的事件)。现在，我们将使用AWS API Gateway上的API hit作为触发事件，并在Configuration选项卡的Add Triggers面板上选择API Gateway。</p><div class="jy jz ka kb fd ab cb"><figure class="kk ij la km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/502cbdb6bdc0759e8acccb979f783382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*hHsKtQlm26RqOAMqivnNKQ.png"/></div></figure><figure class="kk ij lb km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/f42b634ca25d2477562eb77ec386d626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*aWyxpEmgwWZ0aQOujTqLlA.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx lc di ld ku">API Trigger Configuration</figcaption></figure></div><p id="3898" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们选择创建一个新的API，在“security”选项卡中，我们选择创建一个带有API密钥的开放API。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/42fcdf10794f3b66e433af9d7e25856d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbX_Q8LZ4OPBc5WpHw6Heg.png"/></div></div></figure><p id="bb32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">键入API的名称，然后单击“添加”按钮。</p><p id="b02a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在此之后，我们将单击“层”按钮上的first_lambda按钮，编辑代码，并将下面提到的代码用于我们的第一个lambda函数，该函数将在返回的表达式中使用传递的名称。</p><figure class="jy jz ka kb fd ij"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/26920f221fc881aeba4b3bf533632551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXruw3pYtyn5Q6oBK1CqyQ.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">Inline Code Editor</figcaption></figure><p id="d186" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用内嵌编辑器来编写代码，也可以上传包含代码的压缩文件。在这两种情况下，我们都必须将处理程序设置为<file_name>。<function_name>。在上面的例子中，我们将它设置为lambda_function.lambda_handler，因为文件名是lambda_function，函数名是lambda_handler。</function_name></file_name></p><p id="18fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，请注意，事件和上下文两个变量被传递给lambda_handler函数，该函数为我们提供有关触发事件的信息。</p><p id="b2cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">发布这篇文章，点击保存按钮保存Lambda函数中的修改。</p><p id="e175" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">8.我们已经成功地创建了第一个使用API触发的Lambda函数。点击突出显示的API Gateway按钮，我们将看到要使用的API端点和API密钥。</p><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/2d13a5e024633d2878869c79a839baf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R0LgVyty-xZmo5pgkLeP4w.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">Successful Creation of Lambda</figcaption></figure><p id="faf3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用Postman来尝试lambda函数，并在API端点上点击一个请求，同时在标头中添加API键，标头键为“x-api-key”。</p><div class="jy jz ka kb fd ab cb"><figure class="kk ij lj km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/9aa8f1d96d2288b300cb1c1046ab28aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*QDyQ1_6HXXhiq3UNKQNs5A.png"/></div></figure><figure class="kk ij lk km kn ko kp paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/102f5af29202965438bc177b94b14b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*K95MH52lQ36wLq81D9hWxw.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx lc di ld ku">API Hit using Postman</figcaption></figure></div><figure class="jy jz ka kb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/4ac9b9b32bbddb0881c4a48865529e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cqhfKatqLn5KH7n1nNdsg.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx">AWS Lambda Monitoring Screen</figcaption></figure><p id="e624" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">9.我们还可以使用lambda仪表板的Monitoring选项卡检查Lambda执行中发生的调用和错误。<br/>我们还可以使用CloudWatch检查Lambda执行的日志，因为我们提供了创建Cloud Watch日志流的权限。</p><p id="93dd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并不是所有的lambda函数都有这么小的代码，可能需要多个模块来实现这些功能。一个这样的用例可以是使用AWS Lambda函数下载图像。如果我们使用python开发，我们将需要PIL和请求模块以及它们的依赖关系。</p><p id="ad7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下一篇文章的<a class="ae lm" rel="noopener" href="/@info.ankitp/going-serverless-with-aws-lambda-functions-2-51a1bd786547">中，我们将介绍使用Docker创建自定义层、下载AWS Lambda实例的库或模块，并将使用AWS S3的对象创建创建一个Lambda触发器，该触发器将使用自定义创建的层。</a></p><p id="572b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我希望你能发现这篇文章内容丰富且简单易学，如果你有任何疑问，请随时拨打info.ankitp@gmail.com<a class="ae lm" href="mailto:info.ankitp@gmail.com" rel="noopener ugc nofollow" target="_blank">的电话联系我</a></p><p id="39cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">编辑:<a class="ae lm" rel="noopener" href="/@info.ankitp/going-serverless-with-aws-lambda-functions-2-51a1bd786547">带AWS Lambda功能的无服务器化— 2 </a>已发布。</p></div></div>    
</body>
</html>
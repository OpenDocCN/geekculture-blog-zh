<html>
<head>
<title>Swift Floating Pop-Up Picker with Index and Section Headers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有索引和章节标题的快速浮动弹出选择器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swift-floating-pop-up-picker-with-index-and-section-headers-c71fa7dfe44d?source=collection_archive---------11-----------------------#2021-05-08">https://medium.com/geekculture/swift-floating-pop-up-picker-with-index-and-section-headers-c71fa7dfe44d?source=collection_archive---------11-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a784" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">浮动弹出选择器允许用户从预定义的列表中进行选择，并将选择的值传递回调用视图控制器。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0a656e9c8ca0bbcaa5d62b32c82fc9e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8iMrAR6Vv5CxLTF1gwe4Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Book Source Animated Floating Pop-Up Picker</figcaption></figure><h1 id="7a11" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">方案</h1><p id="887f" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们的应用程序将允许用户启动一个弹出选择器，从值列表中选择，然后将选择的值传递回原始视图。在我们的例子中，新书和编辑书籍视图包含3个弹出选择器:<strong class="ih hj">流派</strong>、<strong class="ih hj">来源</strong>和<strong class="ih hj">格式</strong>。体裁涵盖了书籍的类别(惊悚、言情等。)，Source涵盖了来源或出版商(亚马逊、Kobo、公共图书馆等。)和格式涵盖介质(电子书、精装等。).</p><p id="6699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个实际的例子，本文将关注于<strong class="ih hj">源</strong>，但是这个逻辑适用于您为应用程序选择的任何弹出选择器。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/13e0f9553ec3f5cab99dc6ce0d2077c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/1*5JWb3u-QxOmoBOctoJIjRA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx">GIF Book Source Pop-Up Picker</figcaption></figure><h1 id="01f2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">技术</h1><p id="03dd" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">在两个视图(新建/编辑图书和来源选择器)之间传递数据的概念需要在Swift中实施<strong class="ih hj">委托</strong>功能。</p><p id="4433" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们从定义<strong class="ih hj">SourcePickerViewController</strong>开始，其中的值供用户选择，以及它的<strong class="ih hj">SourcePickerViewControllerDelegate</strong>协议，其中我们编写了当用户选择一个值时触发的函数，并将其传递给调用视图控制器。</p><p id="09d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们将<strong class="ih hj">NewBookTableViewController</strong>和<strong class="ih hj">EditBookTableViewController</strong>指定为SourcePickerViewController的代理，通过协议函数接收其数据(用户选择的值)。</p><h1 id="dc6a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">观众</h1><p id="fa66" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">本文面向寻求完整、成熟、以代码为中心的解决方案来加速开发项目的Swift开发人员。下面的代码片段可以通过最小的定制来使用。</p><h1 id="b159" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">应用模型</h1><p id="d51c" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">我们的文章基于苹果应用商店发布的<a class="ae kx" href="https://appsgym.com/projects/books/" rel="noopener ugc nofollow" target="_blank">apps gam Books</a>模型应用(名为<a class="ae kx" href="https://apps.apple.com/au/app/8books/id1152860892" rel="noopener ugc nofollow" target="_blank"> 8Books </a>，你可以在AppsGym.com上免费下载完整的<a class="ae kx" href="https://appsgym.com/appsgym-books-swift-xcode-project-tour/" rel="noopener ugc nofollow" target="_blank"> Xcode项目</a>。</p><h1 id="9ff3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">用户界面</h1><p id="aaa0" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated"><strong class="ih hj">source picker viewcontroller</strong>将利用故事板设置实现以下功能:</p><blockquote class="ky kz la"><p id="05b8" class="if ig lb ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">背景的视觉效果模糊，覆盖了整个底层视图</p><p id="efc6" class="if ig lb ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">背景按钮关闭弹出窗口(没有选择)，它覆盖了整个底层视图</p><p id="2727" class="if ig lb ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">可设计的视图来包围数值的表显示，这允许动画</p><p id="f979" class="if ig lb ih b ii ij ik il im in io ip lc ir is it ld iv iw ix le iz ja jb jc hb bi translated">显示值(表格的单元格/行)并允许选择的表格视图</p></blockquote><p id="aab6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可选地，我们可以动画显示弹出选择器的启动和浮动，在我们的例子中，我们将使用Meng To的来自GitHub的Spring包，链接到Designable视图。发布动画将是一个“zoomIn”。自然，你可以使用自己的动画包或代码。</p><p id="5e33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的<strong class="ih hj">故事板</strong> UI将如下图所示。如果您使用SwiftUI，您将需要以编程方式复制该设置。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/130d71d94f52a1f28a6de86dbbd19b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTDznDkP6-KnKMfefzDrmA.png"/></div></div></figure><p id="ebfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们利用一个按钮(图标图像)/序列方法来显示来自两个视图控制器的弹出选择器:<strong class="ih hj">newbooktableviewcontroller . swift</strong>和<strong class="ih hj">editbooktableviewcontroller . swift .</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/1c71dd10a2359583334e42154d21df90.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*IFzccrHMHZG7e05T8gC4wQ.png"/></div></figure><h1 id="19df" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">逻辑</h1><p id="ab1b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">首先，我们需要设计SourcePickerViewController来显示一个值列表，带有一个索引(源名称的第一个字母)和几个部分。然后设置逻辑来选取一个值，并将其传递回调用视图控制器。</p><p id="5cd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">协议<strong class="ih hj">SourcePickerViewControllerDelegate</strong>将有一个函数<em class="lb"> didPick </em>，其参数为字符串<em class="lb"> iconName </em>。</p><p id="1179" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类<strong class="ih hj">SourcePickerViewController</strong>将构造一个<em class="lb"> iconsDict </em>，一个所有picker值的字典，带有一个包含节标题首字母的数组<em class="lb">iconserctiontitles，</em>作为节标题。</p><p id="a18e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的示例中，我们想要实现一个<strong class="ih hj">动画，</strong>因此我们将把值表放在一个<em class="lb"> iconsDesignableView </em>中，它是由Meng To的Spring包(来自GitHub)制作的动画。需要一个<em class="lb"> closeButtonAction </em>，该按钮作为<em class="lb"> iconsDesignableView、</em>到<em class="lb"> </em>的背景，允许用户在不选择值的情况下关闭选取器。</p><p id="a739" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将所有的选择器列表值添加到一个数组<em class="lb">图标</em>中。然后我们使用<strong class="ih hj"> UITableView </strong>函数来显示数组中的表格单元格(行)。</p><p id="5e13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">NewBookTableViewController</strong>类将充当<em class="lb">SourcePickerViewControllerDelegate</em>并实现<em class="lb"> didPick </em>函数，检索选定的值。带有图标图像的“查看源代码”按钮将转到SourcePickerViewController。</p><h1 id="f9d1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">密码</h1><h1 id="3553" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">提货人代码</strong></h1><p id="357b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated"><strong class="ih hj">sourcepickerviewcontroller . swift</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="606f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">查看控制器代码</strong></h1><p id="ff70" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated"><strong class="ih hj">newbooktableviewcontroller . swift</strong>(类似于editbooktableviewcontroller . swift中的设置，只是sourceTextField的初始值是从viewDidLoad()中的核心数据中检索的)。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="903c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文介绍了实现一个动画、浮动、弹出选择器的完整设置、逻辑和代码，该选择器带有一个索引和部分标题。用户通过点击视图上的按钮来触发选择器，并从选择器列表中选择一个值。选取器将选定的值传输回调用视图控制器。我们使用的例子是图书来源选择器。</p><h1 id="67a5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">增强功能</strong></h1><p id="d844" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">上面的例子工作得很好，但是它是针对文本硬编码列表的。如果我们想在选择器列表中添加一个<strong class="ih hj">图像</strong>，使其动态化，从<strong class="ih hj">核心数据</strong>实体中检索列表值，并允许用户在列表上执行CRUD(创建、查看、更新、删除)操作，会怎么样？</p><p id="07b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些特性将在下一篇文章中以完整的代码详细介绍。敬请期待！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/5e2b04e69132a3876d3b8d45d543fddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*AxrzyxeNKYr3H3x0akawug.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Pop-Up Picker with Images and Dynamic List from Core Data</figcaption></figure><p id="0725" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这篇文章对你的应用有用。感谢阅读！</p></div></div>    
</body>
</html>
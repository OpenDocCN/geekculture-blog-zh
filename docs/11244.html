<html>
<head>
<title>Angular:How I finally understood when and how to use currentTarget property of Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:我终于明白了何时以及如何使用事件的currentTarget属性</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/angular-how-i-finally-understood-when-and-how-to-use-currenttarget-property-of-events-9bd3725d691a?source=collection_archive---------10-----------------------#2022-03-12">https://medium.com/geekculture/angular-how-i-finally-understood-when-and-how-to-use-currenttarget-property-of-events-9bd3725d691a?source=collection_archive---------10-----------------------#2022-03-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fb59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有没有遇到过这样的场景，你不得不<strong class="ih hj">操纵子元素</strong> <strong class="ih hj">的CSS，而不管事件发生在哪里:在父元素上还是在子元素</strong>上？</p><p id="621f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想分享一下我是如何处理这个场景的，以及如何使用指令使解决方案可重用的。这个例子还帮助我理解了事件的<strong class="ih hj">目标</strong>和<strong class="ih hj">当前目标</strong>属性之间的区别。</p><p id="fdc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我的<strong class="ih hj">图标切换角度应用</strong>的样子:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/799f3902f871dafb29058b90c74ee01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOX3ZOcHKkDprwTrx8s9Gw.png"/></div></div></figure><p id="e6c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的目标很简单。</p><ol class=""><li id="01b6" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">“在皱眉和微笑之间切换”文本旁边的图标必须在皱眉和微笑表情图标之间切换，不管我是点击文本还是图标。</li><li id="db59" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">“在生气和大笑之间切换”文本旁边的图标必须在生气和大笑表情图标之间切换，不管我是点击文本还是图标。</li></ol><p id="7618" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的组件模板看起来像这样。该模板显示图标和文本，如上面的屏幕截图所示。我在这个例子中使用了引导图标。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="04f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意元素的结构。我们有一个父元素<a>，它有两个子元素:<i>和<span>标签。不管我是点击<i>标签还是<span>标签，附加到<i>标签的引导图标类都会一直切换。我们将很快看到<strong class="ih hj"> event.currentTarget </strong>如何在这个场景中帮助我们。</i></span></i></span></i></a></p><p id="61bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用选择器<strong class="ih hj">切换</strong>的<strong class="ih hj">切换方向</strong>已应用于父&lt;标签。该指令将负责所有的切换图标逻辑。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="642a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你一定很奇怪上面的主旨没有逻辑:)逻辑相当直白简单。因此，在我们开始之前，有必要了解事件的<strong class="ih hj">目标</strong>和<strong class="ih hj">当前目标</strong>属性之间的不同。</p><p id="f1c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们首先记录了<strong class="ih hj"> event.target </strong>元素的<strong class="ih hj">标记名</strong>属性。当我第一次点击文本“<strong class="ih hj">在皱眉和微笑之间切换</strong>，正如你在下面看到的，它已经记录了“<strong class="ih hj">点击跨度</strong>”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/a1ff57b45bc0d1b879843334be4d029d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vxrh6CU5d4hZKHJX5BzjSg.png"/></div></div></figure><p id="e73c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我点击皱眉表情图标时，它已经记录了“<strong class="ih hj">点击了我</strong>”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kg"><img src="../Images/3a7f657140c6f1d530124d2b4c547eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IS3mRG8VqIjZNGWa42-jsA.png"/></div></div></figure><p id="be26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种行为意味着<strong class="ih hj"> event.target引用了事件发生的元素。</strong>您将观察到<strong class="ih hj"/><strong class="ih hj">文本在生气和大笑</strong>之间切换的类似行为。</p><p id="2d57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们修改下面的<strong class="ih hj"> ToggleDirective </strong>来记录<strong class="ih hj"> event.currentTarget </strong>元素的<strong class="ih hj">标记名</strong>属性。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="8750" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我第一次点击文本“<strong class="ih hj">在皱眉和微笑之间切换</strong>，正如你在下面看到的，它已经记录了“<strong class="ih hj">点击了一个</strong>”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/491cd561b8eb2dad5f83dd1aaafd938e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTkVhvCeF_oQXNwbqF_neQ.png"/></div></div></figure><p id="c123" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我点击皱眉表情图标时，它也记录了“<strong class="ih hj">点击了一个</strong>”。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/1c7c40bfc68ee387ef8fe725324065c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8gclZFSFN_ItOZi_KVFWA.png"/></div></div></figure><p id="94d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种行为意味着<strong class="ih hj"> event.currentTarget引用的是事件处理程序附加到的元素，而不是事件发生的元素。</strong></p><p id="d029" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将观察到<strong class="ih hj"/><strong class="ih hj">文本在生气和大笑</strong>之间切换的类似行为。</p><p id="a6ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么我们选择<strong class="ih hj"> event.currentTarget </strong>作为切换图标的例子？因为我们并不关心用户点击了哪个子元素，即&lt; i &gt;或&lt; span &gt;标签。不管他点击哪里，我们都需要附加到&lt; i &gt;标签的引导图标类来切换。</p><p id="3eac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将<strong class="ih hj"> ToggleDirective </strong>应用于父&lt; a &gt;标签而不是子&lt; i &gt;标签是一个更好的选择。这是因为用户可以自由点击&lt; span &gt;标签文本或&lt; i &gt;标签图标来切换图标类别。</p><p id="611a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看看指令中使用的实际切换图标逻辑。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kd ke l"/></div></figure><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="519d" class="ko kp hi kk b fi kq kr l ks kt">let iconElement = target.querySelector(‘.togglingIcon’);</span></pre><p id="18ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标</strong>是父&lt;元素&gt;而<strong class="ih hj">图标元素</strong>是带有类<strong class="ih hj"> togglingIcon </strong>的&lt; i &gt;标签。</p><p id="6eca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们创建了一个对象<strong class="ih hj">图标</strong>，有4个属性:<strong class="ih hj">皱眉、微笑、生气和大笑</strong>。每个属性的值又包含另外两个属性:<strong class="ih hj">图标和对</strong>。</p><p id="671f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">属性图标</strong>包含引导图标类名，而<strong class="ih hj">属性对</strong>包含字符串。如果你注意到这个字符串与<strong class="ih hj">图标</strong>对象中的另一个属性相同。</p><p id="2b34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，<strong class="ih hj">图标对象</strong>的<strong class="ih hj">皱眉属性</strong>拥有<strong class="ih hj">对属性</strong>为<strong class="ih hj">"微笑"</strong>。原因是皱眉表情符号必须切换到微笑表情符号。在图标对象下我们还有一个<strong class="ih hj">微笑属性</strong>。</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="4901" class="ko kp hi kk b fi kq kr l ks kt">let <strong class="kk hj">icons </strong>= {<br/>frown: { icon: 'bi-emoji-frown', pair: 'smile' },<br/>smile: { icon: 'bi-emoji-smile', pair: 'frown' },<br/>angry: { icon: 'bi-emoji-angry', pair: 'laughing' },<br/>laughing: { icon: 'bi-emoji-laughing', pair: 'angry' },<br/>}</span></pre><p id="d682" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果需要添加更多图标或删除现有图标，则需要单独更新<strong class="ih hj">图标对象</strong>。</p><p id="6927" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面这段代码执行实际的切换动作。使用<strong class="ih hj">渲染器2 </strong>来添加和移除类。</p><pre class="je jf jg jh fd kj kk kl km aw kn bi"><span id="aae8" class="ko kp hi kk b fi kq kr l ks kt">for (let x in icons) {<br/><strong class="kk hj">if (iconElement.classList.contains(icons[x].icon)) {</strong><br/>this.renderer.<strong class="kk hj">addClass</strong>(iconElement, icons[icons[x].pair].icon);<br/>this.renderer.<strong class="kk hj">removeClass</strong>(iconElement, icons[x].icon);<br/>break;<br/>}<br/>}</span></pre><p id="23c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在下面找到完整的工作示例:</p><div class="ku kv ez fb kw kx"><a href="https://stackblitz.com/edit/angular-yfn152?file=src/app/app.component.ts" rel="noopener  ugc nofollow" target="_blank"><div class="ky ab dw"><div class="kz ab la cl cj lb"><h2 class="bd hj fi z dy lc ea eb ld ed ef hh bi translated">角形(叉形)堆叠</h2><div class="le l"><h3 class="bd b fi z dy lc ea eb ld ed ef dx translated">一个基于rxjs，tslib，core-js，zone.js，@angular/core，@angular/forms，@angular/common的angular-cli项目…</h3></div><div class="lf l"><p class="bd b fp z dy lc ea eb ld ed ef dx translated">stackblitz.com</p></div></div><div class="lg l"><div class="lh l li lj lk lg ll jn kx"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>How I built a simple compiler — Markdown to HTML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何构建一个简单的编译器——Markdown to HTML</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-i-built-a-simple-compiler-markdown-to-html-4da63dc79a94?source=collection_archive---------1-----------------------#2019-11-22">https://medium.com/geekculture/how-i-built-a-simple-compiler-markdown-to-html-4da63dc79a94?source=collection_archive---------1-----------------------#2019-11-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8c76624e5e1a6170e867978e9f34ae54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTK3OsTXqZjg-zqgARvDng.png"/></div></div></figure><h1 id="3128" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">灵感</h1><p id="70c3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我的一个同事，碰巧是我在̶b̶o̶s̶s̶ ̶的领导，写了一个非常酷的编译器。它不是一个很酷的CRUD应用程序或复杂的动画。</p><p id="df17" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是一个编译器。用于生产环境。而且也不是靠一个社区或者一个大公司做后盾。</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="3e53" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我认为这很酷…我想编码酷的东西...所以我决定我要写一个编译器！</p><p id="fcca" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">所以我做了… </strong>因为我可以做以下事情</p><ul class=""><li id="8510" class="kx ky hi jq b jr km jv kn jz kz kd la kh lb kl lc ld le lf bi translated">了解更多关于编译器的神奇之处</li><li id="a471" class="kx ky hi jq b jr lg jv lh jz li kd lj kh lk kl lc ld le lf bi translated">学习新的JavaScript框架之外的东西</li><li id="0e12" class="kx ky hi jq b jr lg jv lh jz li kd lj kh lk kl lc ld le lf bi translated">实现我的一个目标。</li><li id="9447" class="kx ky hi jq b jr lg jv lh jz li kd lj kh lk kl lc ld le lf bi translated">编写不同的代码。</li><li id="bb24" class="kx ky hi jq b jr lg jv lh jz li kd lj kh lk kl lc ld le lf bi translated">更深入地了解代码库</li></ul><h1 id="a18d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">怎么会？</h1><p id="c2cc" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我的编译器的基础是建立在<a class="ae ll" href="https://github.com/IronyProject/Irony" rel="noopener ugc nofollow" target="_blank">讽刺</a>之上的。这是一个. NET语言实现工具包。不幸的是，网上没有太多的信息或教程。即使只有少量的在线文档，我也能够定义语言语法，所以我可以解析输入。</p><p id="1e5e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我使用Irony的<em class="lm">非终结符</em>和<em class="lm">终结符</em>类来定义我的减价。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/ffd06cfe3d562d4ea6a1668402335401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXKeyF3xqA9Dj_2Gy63mJg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/ee42ea031d9b04edeb039ecee200d997#file-nonterminaldef-cs" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/ee42ea031d9b04edeb039ecee200d997#file-nonterminaldef-cs</a></figcaption></figure><h2 id="4d05" class="ls ir hi bd is lt lu lv iw lw lx ly ja jz lz ma je kd mb mc ji kh md me jm mf bi translated">语法</h2><p id="29d7" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">现在是时候定义语法规则了。使用<a class="ae ll" href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form" rel="noopener ugc nofollow" target="_blank">巴科斯诺尔形式</a>定义语法。反语重载了C#操作符，使得定义语法变得非常容易。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/32495b525847142368525c8af46f3947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5O1hM1m0UbO--ONPIg7Ywg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/8c638b52517363e6093f35ab3d5eca46" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/8c638b52517363e6093f35ab3d5eca46</a></figcaption></figure><p id="a095" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">读起来太容易了。让我们开始吧。</p><p id="9ffa" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">粗体文本必须以<em class="lm">星号* </em>开头，后跟以<em class="lm">星号*结尾的<em class="lm">文本</em>。文本</em>可以是<em class="lm"> StyledText </em>或<em class="lm">明文。</em>但是<em class="lm">样式文本</em>可以<em class="lm">加粗</em>、<em class="lm">斜体</em>或者U͟n͟d͟e͟r͟s͟c͟o͟r͟e͟ <em class="lm">。你看到那个小黑客了吗？现在<em class="lm">粗体</em>文本也可以是下划线<em class="lm">斜体</em>！与<em class="lm">割台</em>相同。下划线标题？没问题，因为它符合我们的语法规则。</em></p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a15569601c937cbd7d2be470f7266c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aYgkI4mqH6eoqreU.jpg"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">It’s not THAT complicated.</figcaption></figure><p id="2bd8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果您注意到非终端和终端的定义，您会看到第二个参数是Ast节点的一种类型。这样我就可以把我的解析树映射到AST。实现这一点真的很痛苦。我搜索了StackOverflow，谷歌结果的第二页…没有运气。我的解决方案可能不是世界上最好的，但它是有效的。它是一个函数，创建一个你提供给它的类型的实例。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/a8e9eef2567ea36133d60cd08d0ff09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_rTgI6_mIoZxjz_FdW_bA.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/f0c184066ab4824bb6b821a8e974c6cd" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/f0c184066ab4824bb6b821a8e974c6cd</a></figcaption></figure><p id="e43b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">使用AST比解析树容易得多:)这就是你为什么这么做的原因。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/55a6b3d9fd54087def8f775ff32fdc41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hgUs6W3ldETMAP5J9JLe1Q.png"/></div></div></figure><h1 id="74e2" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">从抽象语法树到HTML</h1><p id="6c25" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">语法有定义，AST看起来不错。现在我不得不做一件我已经成功避免了5年的事情。我不得不学习 <a class="ae ll" href="https://en.wikipedia.org/wiki/Visitor_pattern" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">访客模式</strong> </a> <strong class="jq hj">。现在比几年前在大学里有意义多了。</strong></p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="mj kw l"/></div><figcaption class="lo lp et er es lq lr bd b be z dx">Accurate description of visitor pattern</figcaption></figure><p id="3f93" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这就是反语在遍历树时接受访问者的方式。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/97fbc9fc78fe16745c9cf1a7c88cf6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNAxAGipxLGyYl9zjunctg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/2e3b70a0e84d1fa4fc938556a7743491" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/2e3b70a0e84d1fa4fc938556a7743491</a></figcaption></figure><p id="a991" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这就是我如何编写我的HTML访问者。在你访问一个节点之前写下你的标签，之后他会访问每一个孩子。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/84ba75c813a07525548b5f32b2012b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*uHUtMJB2m277iTKqa9f7Gg.png"/></div></figure><p id="65b3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">当遇到<em class="lm"> PlainTextAst </em>时，输出我们解析的文本</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/1decc3e44b7fd3c96ae3365e76971e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gO-OMFJYZazfy92PR3a85w.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/a9f907207ed43043d478ce7dccba6e66" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/a9f907207ed43043d478ce7dccba6e66</a></figcaption></figure><p id="dc92" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在只要访问根</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/675439f36e459b64abc6a3513443bf7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Js94OCwr8QdiBLwhAuOAQw.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx"><a class="ae ll" href="https://gist.github.com/jozefchmelar/59677f63ae6cec240fbd9c95bac243ab" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/jozefchmelar/59677f63ae6cec240fbd9c95bac243ab</a></figcaption></figure><h1 id="e046" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">瞧啊。</h1><p id="2c2a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">从这个</p><pre class="kr ks kt ku fd mo mp mq mr aw ms bi"><span id="b72b" class="ls ir hi mp b fi mt mu l mv mw">#"H1 Heading"<br/>#_"H1 undescore heading"_<br/>##"H2 Heading"<br/>*"This is bold text"* "and this is regular text"<br/>"Following three items should be in a list, this is plaintext"<br/>- "Plaintext list item"<br/>- *"Bold List item"*<br/>- _*"Underscore bold list item"*_<br/>- _"Underscore  list item"_<br/>#"This is heading again"</span></pre><p id="65cc" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">对此</p><pre class="kr ks kt ku fd mo mp mq mr aw ms bi"><span id="7bb0" class="ls ir hi mp b fi mt mu l mv mw">&lt;div&gt;<br/>  &lt;h1&gt;H1 Heading&lt;/h1&gt;<br/>  &lt;h1&gt;<br/>    &lt;u&gt;H1 undescore heading&lt;/u&gt;<br/>  &lt;/h1&gt;<br/>  &lt;h2&gt;H2 Heading&lt;/h2&gt;<br/>  &lt;b&gt;This is bold text&lt;/b&gt;<br/>  &lt;p&gt;and this is regular text&lt;/p&gt;<br/>  &lt;p&gt;Following three items should be in a list, this is plaintext&lt;/p&gt;<br/>  &lt;ul&gt;<br/>    &lt;li&gt;Plaintext list item&lt;/li&gt;<br/>    &lt;li&gt;<br/>      &lt;b&gt;Bold List item&lt;/b&gt;<br/>    &lt;/li&gt;<br/>    &lt;li&gt;<br/>      &lt;u&gt;<br/>        &lt;b&gt;Underscore bold list item&lt;/b&gt;<br/>      &lt;/u&gt;<br/>    &lt;/li&gt;<br/>    &lt;li&gt;<br/>      &lt;u&gt;Underscore  list item&lt;/u&gt;<br/>    &lt;/li&gt;<br/>  &lt;/ul&gt;<br/>  &lt;h1&gt;This is heading again&lt;/h1&gt;<br/>&lt;/div&gt;</span></pre><p id="67ec" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><strong class="jq hj">管用！</strong></p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="mx kw l"/></div></figure><h1 id="3dd4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="ee5a" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我想写一个从我的markdown到HTML的编译器。我挑选了很棒的可用工具来实现它，并且<strong class="jq hj">做到了</strong>。你不必从汇编开始写你自己的解析器，编译器，语言，操作系统…</p><p id="96dd" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">试试看。动手吧。解决它。</p><div class="my mz ez fb na nb"><a href="https://github.com/jozefchmelar/MarkdownCompiler" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab dw"><div class="nd ab ne cl cj nf"><h2 class="bd hj fi z dy ng ea eb nh ed ef hh bi translated">jozefchmelar/MarkdownCompiler</h2><div class="ni l"><h3 class="bd b fi z dy ng ea eb nh ed ef dx translated">这是我自己的也是我的第一个编译器，它采用了我的非常差的支持# header # # header 2 # # # #的markdown版本…</h3></div><div class="nj l"><p class="bd b fp z dy ng ea eb nh ed ef dx translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np io nb"/></div></div></a></div><figure class="kr ks kt ku fd ij er es paragraph-image"><a href="https://www.buymeacoffee.com/jozefchmelar"><div class="er es nq"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></a><figcaption class="lo lp et er es lq lr bd b be z dx">I’m just ❤️really curious</figcaption></figure></div></div>    
</body>
</html>
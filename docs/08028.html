<html>
<head>
<title>NavMeshAgent Movement via Keyboard</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过键盘移动导航代理</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/navmeshagent-movement-via-keyboard-8ea09fcb4e17?source=collection_archive---------12-----------------------#2021-10-11">https://medium.com/geekculture/navmeshagent-movement-via-keyboard-8ea09fcb4e17?source=collection_archive---------12-----------------------#2021-10-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a57390427248ceb9a1f213151d8978c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSUiqIiAeomPTOJdFg-DOQ.png"/></div></div></figure><p id="34f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目标</strong>:通过WASD轴实现玩家运动</p><p id="ea68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在游戏差不多准备好了，我把它交给了我的一个密友，他和我一样对游戏充满热情。我们讨论了主要和次要的问题以及如何解决它们，但是从教程制作者的角度来看，有一个问题特别有趣。</p><p id="ddf6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">他问我为什么没有可能通过经典的<strong class="is hj"> WASD </strong>方向键<strong class="is hj">T10来移动达伦。事实上，我们没有理由不实现这样一个特性。所以尽管有一种方法可以让这成为可能。</strong></p><p id="5f59" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">幸运的是，Unity提供了一种收集默认输入的简单方法:<code class="du jo jp jq jr b">Input.GetAxis("AxisName")</code>方法允许检测箭头，以及WASD键，按下并模拟一种类似的<strong class="is hj">行为。根据按压时间的不同，浮动值的范围从最小值到最大值，0为非按压值。我们甚至可以在播放器设置中调整达到这些值的速度。</strong></p><p id="b96d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，在<em class="js"> PlayerInput </em>脚本中，我们可以通过鼠标点击获得这些值。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="ea5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我必须检查零值的原因是，当按键未被按下时忽略轴，这是因为左击检测存在干扰。通过这种方式，我成功地在两个方向上移动了达伦，这很好，因为WASD更精确，而老鼠更舒服。</p><p id="9f6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我还在<em class="js"> PlayerMovement </em>脚本中写了一个重载方法<code class="du jo jp jq jr b">Move(float, float)</code>，当两个轴都有非零值时就会执行。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="8c1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jo jp jq jr b">Direction()</code>不是一个真正的方法，让我们说它是评估vector3的东西。我只是需要这个视图来解释运动是如何发生的:由于<code class="du jo jp jq jr b">transform.Translate(..)</code>和<code class="du jo jp jq jr b">_agent.Move(..)</code>似乎只是滑动了达伦而没有影响其navmesh代理速度属性，我不得不使用一些我确信会有效的东西——记住速度会触发行走和空闲动画。所以我设置了一个新的代理目的地，它是当前位置加上一个位移。</p><p id="bfa2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里有一点几何思维:如何评估这个vector3？<br/>首先，我们可以说y分量必须为0，这也是因为代理绑定到地面，非零值最终将是无用的。然后，我们可以从达伦的对象中寻找线索。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/64b1edf9cd93454219fb97d6a44f7c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*NHuhxS5L6ww4yOs0OZ8x_g.png"/></div></figure><p id="cf2e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它的前进方向由z分量决定。如果我们想将axis绑定到与Darren相关的方向，就必须考虑到这一点。这样，例如，按W应该总是向前移动Darren，即使这实际上意味着向屏幕的底部移动，而按D意味着向他的右边移动Darren，这可能是我们的左边...我在这里说的是，这种运动的选择强烈依赖于相机，即如果它面对达伦或看着他的背，这对于玩家来说有点奇怪或违反直觉。</p><blockquote class="ka kb kc"><p id="89d4" class="iq ir js is b it iu iv iw ix iy iz ja kd jc jd je ke jg jh ji kf jk jl jm jn hb bi translated">如果我们选择拿着相机(越过肩膀)从后面跟踪达伦，或者使用第一人称视角，这就不再奇怪了。</p></blockquote><p id="4196" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相反，我们应该坚持一个更直观的行为:向上意味着向上，向右意味着向右，所以方向指的是相机的角度。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a57390427248ceb9a1f213151d8978c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSUiqIiAeomPTOJdFg-DOQ.png"/></div></div></figure><p id="d1a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于主摄像头<strong class="is hj">总是</strong>看着达伦，我们可以分辨出两个方向:一个是将摄像头连接到达伦，另一个是第一个的法线。后者可以以这样或那样的方式指向，但是因为Unity reference是右手的，所以我们正在构建的也应该是右手的。根据<a class="ae kg" href="https://en.wikipedia.org/wiki/Right-hand_rule" rel="noopener ugc nofollow" target="_blank">右手法则</a>，你在图片中看到的是正确的x轴方向。现在我们只需要将水平和垂直输入正确地投射到这些轴上。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="4178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个相当简单:相机到达伦线只是位置之间的差异，它是<strong class="is hj">归一化</strong>(幅度设置为1)，并乘以垂直输入。</p><p id="3825" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第二个需要更多一点的代数知识:为了得到正确的x方向，我使用了在相机到达伦线和-y方向之间执行<a class="ae kg" href="https://en.wikipedia.org/wiki/Cross_product" rel="noopener ugc nofollow" target="_blank">叉积</a>的技巧。根据<a class="ae kg" href="https://en.wikipedia.org/wiki/Right-hand_rule" rel="noopener ugc nofollow" target="_blank">右手法则</a>，负号对于获得正确的x(否则将是-x)是必要的。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="abd0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在可以在一个简单的矢量和<strong class="is hj">中使用这些矢量来评估位移。最终位移也有一个比例因子，这是为了得到和左键点击一样快的移动而进行的实验结果。</strong></p></div></div>    
</body>
</html>
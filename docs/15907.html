<html>
<head>
<title>ReactJSX Meets Instagram: Adding and Deleting Comments Made Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ReactJSX与Instagram相遇:轻松添加和删除评论</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-a-comment-app-using-reactjsx-b46522aa95f6?source=collection_archive---------11-----------------------#2022-11-29">https://medium.com/geekculture/create-a-comment-app-using-reactjsx-b46522aa95f6?source=collection_archive---------11-----------------------#2022-11-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div class="er es hg"><img src="../Images/da33ece6bd71aa5d9792fffb430b0d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*YMSIDcLkITLLtEqAHx46zQ.png"/></div><figcaption class="hn ho et er es hp hq bd b be z dx">Simple comment App</figcaption></figure><div class=""/><div class=""><h2 id="9678" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">你知道Instagram完全基于ReactJS库吗？你想知道如何编写一些基本功能的代码吗，比如添加和/或删除评论？如果是，继续读下去！</h2></div><h2 id="28f0" class="ji jj ht bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">掌握ReactJSX的威力</h2><p id="316e" class="pw-post-body-paragraph kg kh ht ki b kj kk iu kl km kn ix ko jt kp kq kr jx ks kt ku kb kv kw kx ky hb bi translated">首先在create-react-app环境中设置一个简单的应用程序，它将使用npm下载并安装几个NodeJS包，然后继续在应用程序中添加状态。了解如何连接事件处理程序来添加新注释，以及如何连接事件处理程序来删除注释。</p><p id="040d" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">目标:</p><ul class=""><li id="7185" class="le lf ht ki b kj kz km la jt lg jx lh kb li ky lj lk ll lm bi translated">在create-react-app环境中开发一个简单的应用程序</li><li id="3bd7" class="le lf ht ki b kj ln km lo jt lp jx lq kb lr ky lj lk ll lm bi translated">在应用程序中使用状态和属性</li><li id="6db6" class="le lf ht ki b kj ln km lo jt lp jx lq kb lr ky lj lk ll lm bi translated">连接事件处理程序来添加和删除注释</li></ul><p id="b34b" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">如果你是新手，对开发这个应用没有足够的信心，请在<a class="ae ls" href="https://www.youtube.com/watch?v=w7ejDZ8SWv8" rel="noopener ugc nofollow" target="_blank"> Youtube </a>上观看教程。</p><p id="4ebc" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">让我们开始编码吧！👩‍💻</p><p id="71b6" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">通过按Ctl +`打开Visual Studio代码终端，并键入:<em class="lt">npx create-react-app simple-comment-app。</em>在这里阅读更多关于这个命令<a class="ae ls" href="https://create-react-app.dev/docs/getting-started" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es lu"><img src="../Images/9259e285f00140352436c16edf7403db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VQP84NGDYkRUhgzeT-K0vw.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-1 Create react app cli</figcaption></figure><p id="655b" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">接下来进入创建的子文件夹:<em class="lt"> cd simple-comment-app。</em>并运行:<em class="lt"> npm start </em>运行React的开发服务器。该应用将在您的浏览器中打开，网址为<a class="ae ls" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000/ </a>。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es md"><img src="../Images/4e2529c42a791255b00aaf180a67da54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u0DcTQyJRpI7tNHdisglig.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-2 CLI</figcaption></figure><p id="f604" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">通过展开来浏览您的公共和源代码文件夹(Img-3，index.html是我们的切入点)。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es me"><img src="../Images/7e651e2779f4744043ff26845c99c8e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLQu5RSd8tTOILxHulzpnA.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-3 Created files.</figcaption></figure><p id="2ae3" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">接下来，我们将创建一个名为<em class="lt"> Comment.js </em>的新组件，它将呈现从应用程序顶层组件一直传递到Comment的消息。在render函数中，我们将以表格的形式显示注释。table元素应用了css类“comment”。在这个表中，我们用一行来表示这个注释(也就是&lt; tr &gt;标签)。在这一行的第一个单元格中，我们显示消息图标。第二个单元格是通过props从<em class="lt"> CommentList </em>传递到<em class="lt">组件</em>的消息的实际内容。第三个单元格是回收站图标，用于删除评论。在最底层，确保您有<em class="lt">导出默认注释</em>，这样这个注释模块就可以用于其他js文件中的代码。</p><p id="2fb5" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">让我们连接一个删除事件处理程序，以便能够使用index删除注释(Img-4，第6–8行)。每个<em class="lt">评论</em>组件都有一个关联的索引，该索引作为props的一部分被传入。这个<em class="lt"> deleteComment </em>事件处理程序只需要调用<em class="lt"> this.props.deleteComment </em>并传入<em class="lt"> this.props.index </em>。此外，我们希望用户能够通过点击垃圾箱图标来删除评论，为此，我将把<em class="lt"> onClick </em>事件处理程序添加到在&lt; td &gt;标记中包含该图标的单元格中(Img-4，第19行)。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mf"><img src="../Images/68e50e95b22e0e0d6e85b057ad27013c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGM58OKOL8Z8rMw3qrIIGQ.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-4 Comment Component</figcaption></figure><p id="f123" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">我现在将创建一个新文件<em class="lt"> CommentList.js </em>来表示一个组件，该组件将呈现和显示评论列表。将react和Comment组件导入该文件。然后，我将创建一个具有render函数的类，该类返回一个具有className="commentList "的&lt; div &gt;和从最高级别的应用程序组件(参见Img-7上的应用程序组件代码)传递的属性。我们需要在应用程序中呈现的消息可以在<em class="lt"> this.props.messages </em>中找到。我将调用消息列表上的map函数(Img-5，第13行)。map函数接受另一个函数作为输入参数，该函数对列表中的每个元素应用某种转换。这里我们想要的转换是，对于每条消息，我们将把该消息传递给一个<em class="lt"> Comment </em>组件(Img-5，第15行)。您将为这个组件指定属性:一个惟一标识这个组件的键，一个prop消息的值，该消息是<em class="lt">注释</em>必须呈现的消息。为了能够使用消息的索引位置删除消息，我们需要将每个评论的索引传递到this <em class="lt"> </em>组件中。我将设置一个名为index的变量，并将其初始化为0 (Img-5，第8行)。接下来，我将为每个<em class="lt">评论</em>组件(Img-5，第15行)传递指定的索引值。此外，我还将传入另一个名为<em class="lt">index = { index++ }:</em>index的最后一个值，先初始化为0，然后index值会为下一个注释递增。我还将使用<strong class="ki hu">扩展操作符</strong> <em class="lt"> {…this.props} </em>来传递我们从更高级别的组件接收到的所有属性。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mg"><img src="../Images/c52e33922b6e4a7999ff86d1e66f2332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwdrPaJJCP6IHOzBe2pPzw.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-5 CommentList Component</figcaption></figure><p id="b8f0" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">让我们继续向我们的应用程序添加另一个组件<em class="lt"> CommentBox.js </em> (Img-6) <em class="lt">。</em>这将是一个允许我们输入新评论的表单，新评论将显示在评论列表中。为react包中的React和组件设置导入语句。在渲染函数中，我们有一个外部的&lt; div &gt;和输入框。在输入框下，我们有一个按钮，其文本为:Post。这是一个允许我们在应用程序上发表新评论的组件。我将在第4行Img-6的顶部添加一个构造函数，它接受props作为输入参数，并在向它传递props时调用超类。这里我要做一个决定:这个<em class="lt">评论框</em>应该作为一个<strong class="ki hu">控制的</strong>组件还是一个<strong class="ki hu">非控制的</strong>组件与输入文本框一起工作？这个选择很重要，原因有几个:React中的最佳实践建议您的组件通常应该是受控组件，其中您在输入框中指定的值是使用您的<em class="lt"> React控制的。组件</em>状态(通常不允许表单元素管理自己的内部数据)。在这里，我将有意识地选择让我的输入文本框成为一个不受控制的组件。原因是这是一个相当简单的表单元素。现在我们必须创建一个<em class="lt"> ref </em>来引用该组件的DOM节点(Img-6，第7行)。我们需要在render函数中引用这个<em class="lt"> ref </em>，这样输入就有了<em class="lt"> ref </em>属性(Img-6，第18行)。一旦用户指定了他/她想要在输入文本框中添加的评论，用户将继续并点击Post按钮。因此，我们需要为Post按钮添加click处理程序，以便将消息添加到我们的消息列表中(Img-6，第19行)。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mh"><img src="../Images/eace6ce033305ffd3136467e4f6a1456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eyMYsNaHkAis5a-xl5-bw.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-6 CommentBox Component</figcaption></figure><p id="86ef" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">标准的做法是让应用程序中最高级别的组件是一个。/App.js '。我将删除此处的现有代码，它指的是使用create-react-app环境创建的starter应用程序，我将粘贴我自己的代码。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mi"><img src="../Images/f08b8a96044afe82674a9869a9ba05a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oCkxpCqNN11MofQ41982g.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-7 App Component(highest level)</figcaption></figure><p id="dd94" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">在添加交互性之前，让我们给应用程序添加一些状态(Img-7，第6–13行)。我们将把我们的状态存储在尽可能高的组件中(最佳实践！)，也就是<em class="lt"> App </em> <em class="lt">组件</em>。该状态仅保存将要使用我们的评论应用程序显示的消息列表。这里的状态只包含一个属性:我们希望在应用程序中显示的消息列表。我将通过props (Img-7，第40行)把我在这个<em class="lt">应用组件</em>的状态中的消息列表传递给<em class="lt"> &lt; CommentList &gt; </em>。</p><p id="2b7f" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">将交互性添加到组件中非常重要，这需要事件处理程序。没有交互性意味着这个应用在这个时间点很无聊。让我们解决这个问题(Img-8，第15–23行)。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mj"><img src="../Images/a5b24c5873bfe6e3e65305ed7219b748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oeFNikHVuPXNMwq595EJSg.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-8 Adding interactivity to our App component</figcaption></figure><p id="15a1" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">我将添加一个事件处理程序来处理添加一个新的注释，该注释将显示在应用程序的注释中。我已经使用箭头符号定义了名为<em class="lt"> addComment </em>的事件处理程序(Img-8，第15行)。事件处理程序通常使用箭头符号定义，因为当您在ES6类中使用箭头符号时，您定义的方法会自动绑定到组件的当前实例。在这个<em class="lt"> addComment </em>事件处理程序中，我们要做的就是更新应用组件的当前状态。我们将调用this.setState函数(Img-8，第16行)。这需要一个输入参数——这个函数的输入参数是这个对象的前一个状态。在更新状态之前，我们将使用以前的状态来访问该组件中的当前消息列表。</p><p id="ae48" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated"><em class="lt">prev state . messages . concat</em>将创建一个新的JS列表，该列表将保存在messages变量中(Img-8，第17行)。我们将通过使用<em class="lt"> messages.push </em> (Img-8，第18行)<em class="lt">将我们想要添加的新消息推送到列表的最后来更新这个消息列表的新副本。现在我们将返回组件的新状态。messages属性有一个新的消息列表，在该列表的最末尾附加了全新的消息(Img-8，第19–21行)。从该事件处理程序更改组件的状态将重新呈现该组件。但是我们首先需要连接这个事件处理程序。</em></p><p id="664c" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">负责允许我们添加新消息的组件是CommentBox，它现在将成为我们CommentList的一部分。我将把这个事件处理程序<em class="lt"> this.addComment </em>以道具的形式传入CommentBox组件(Img-9，第38行)。<em class="lt"> addComment </em>事件处理程序在这个应用程序注释中定义，它作为函数属性传递给CommentBox。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mk"><img src="../Images/100aaa80c877f0a76e2f422642d5e5ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FBP-vRvdpLKazUv49Svrg.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-9 Passing event handler from the App component down to CommentBox component</figcaption></figure><p id="ef19" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">接下来，我们将设置一个事件处理程序，允许我们删除评论。看看这个<em class="lt"> deleteComment </em>事件处理程序的输入参数:它接受您想要删除的注释的索引，并相应地更新状态(Img-10，第25行)。一旦我们知道了需要删除的注释的索引，我们就调用<em class="lt"> this.setState </em>并传递一个允许我们访问先前状态的函数。我们使用<em class="lt">prev state . messages . concat()</em>创建当前消息的副本。然后，我们可以在变量<em class="lt"> messages、</em>中使用这些消息，我们称之为messages.splice来删除由index (Img-10，第28行)指定的消息。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es ml"><img src="../Images/3709b5771a10902a8ce502d22117951c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KTKxhgb8aF3-_Z6XJheHWg.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-10 Event handler to delete comments</figcaption></figure><p id="5b16" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">在我们的React应用程序中，我们将允许用户通过单击每条消息旁边的垃圾桶图标来删除消息，这意味着我们必须将这个<em class="lt"> deleteComment </em>事件处理程序传递给<em class="lt"> CommentList </em>组件(Img-11，第41行)。<em class="lt">注释列表</em>是使用<em class="lt">注释</em>组件显示单个消息的列表。</p><figure class="lv lw lx ly fd hk er es paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="er es mm"><img src="../Images/4f223d79c6071b250cf0c359074d1efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BpYCIvrah223Ti0CxjjpvA.png"/></div></div><figcaption class="hn ho et er es hp hq bd b be z dx">Img-11 Passing delete function as part of props to CommentList component</figcaption></figure><p id="fe87" class="pw-post-body-paragraph kg kh ht ki b kj kz iu kl km la ix ko jt lb kq kr jx lc kt ku kb ld kw kx ky hb bi translated">你做到了！谢谢你和我一起编码！感谢您的时间和关注！</p><div class="hh hi ez fb hj mn"><a href="https://youtube.com/shorts/UVAhEZ-Leo4?feature=share" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hu fi z dy ms ea eb mt ed ef hs bi translated">简单注释反应应用程序</h2><div class="mu l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">你最终的申请应该是这样的。</p></div></div><div class="mv l"><div class="mw l mx my mz mv na hl mn"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Multiple environments in Create React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建React应用程序中的多个环境</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/multiple-environments-in-create-react-app-619bd3dc1c61?source=collection_archive---------7-----------------------#2021-05-08">https://medium.com/geekculture/multiple-environments-in-create-react-app-619bd3dc1c61?source=collection_archive---------7-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1ea1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">为您的 <strong class="ak"> <em class="ix">开发/本地、QA </em> </strong> <em class="ix">和</em> <strong class="ak"> <em class="ix">生产构建</em> </strong>将您的React应用与<strong class="ak"> <em class="ix">不同的API端点</em> </strong> <em class="ix">连接起来</em></h2></div><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es iy"><img src="../Images/b5fbb64b884fb220dffedf41506d3131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rde0LCcCPf6tLGrD7blQVA.png"/></div></div></figure><p id="b638" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">在本文中，我们将学习如何在一个React应用程序中配置多个环境。<em class="kg">例如，您可能希望您的开发环境连接到您的开发API端点，QA连接到QA端点，而生产连接到生产端点。我们可以用一个。但是，每次您将代码推到特定的环境中时，您都需要记住更改端点值，这有点令人头疼，而且容易出错。让我们看看如何解决这个问题！</em></p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es ko"><img src="../Images/389a03f30b6a6e6ee628ea7405d984e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*ph4OBpZXrtpxueekIR8JnA.gif"/></div></figure><p id="374b" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">是的，相信我。我们要去做了！！！</p><p id="481c" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">首先，通过运行以下命令从npm获得包<a class="ae kp" href="https://www.npmjs.com/package/env-cmd" rel="noopener ugc nofollow" target="_blank"> env-cmd </a></p><pre class="iz ja jb jc fd kq kr ks kt aw ku bi"><span id="86ce" class="kv kw hi kr b fi kx ky l kz la">npm install — save-dev env-cmd</span></pre><p id="3df5" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">接下来，创建您的特定环境。环境文件。在这个例子中，我在我的根目录中创建了一个名为“<strong class="jm hj"> environments </strong>”的文件夹(与package.json在同一层)。<strong class="jm hj">重要</strong>环境变量<strong class="jm hj">必须</strong>以<strong class="jm hj"> REACT_APP_开头。</strong>此处阅读更多<strong class="jm hj"> </strong> <a class="ae kp" href="https://create-react-app.dev/docs/adding-custom-environment-variables/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="43c1" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">然后，我在<strong class="jm hj">环境</strong>文件夹中创建了我的. dev.env、qa.env和. prod.env。</p><pre class="iz ja jb jc fd kq kr ks kt aw ku bi"><span id="1245" class="kv kw hi kr b fi kx ky l kz la">REACT_APP_API_END_POINT==http://my-dev-url.com<br/>//.dev.env</span><span id="ee1c" class="kv kw hi kr b fi lb ky l kz la">REACT_APP_API_END_POINT==http://my-qa-url.com<br/>//.qa.env</span><span id="4fbe" class="kv kw hi kr b fi lb ky l kz la">REACT_APP_API_END_POINT==http://my-prod-url.com<br/>//.prod.env</span></pre><p id="f25c" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">请注意. dev.env、qa.env和. prod.env是环境文件夹中的三个独立文件。见下文</p><figure class="iz ja jb jc fd jd er es paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="er es lc"><img src="../Images/8f002ed1d6dde57403ce84a2fdcdc3b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*y0czWlHNZNres63UG1JPWA.png"/></div></div></figure><p id="bcea" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">接下来，更新package.json。更新您的<code class="du ld le lf kr b">package.json</code>的<code class="du ld le lf kr b">scripts</code>部分，以包括以下内容:</p><pre class="iz ja jb jc fd kq kr ks kt aw ku bi"><span id="7d74" class="kv kw hi kr b fi kx ky l kz la">“scripts”: {</span><span id="4ecf" class="kv kw hi kr b fi lb ky l kz la">“start”: “react-scripts start”,<br/>“build”: “react-scripts build”,<br/>“test”: “react-scripts test”,<br/>“eject”: “react-scripts eject”,<br/>“start:dev”: “env-cmd -f ./environments/.dev.env react-scripts start”,<br/>“build:dev”: “env-cmd -f ./environments/.dev.env npm run-script build”,<br/>“start:qa”: “env-cmd -f ./environments/.qa.env react-scripts start”,<br/>“build:qa”: “env-cmd -f ./environments/.qa.env npm run-script build”,<br/>“start:prod”: “env-cmd -f ./environments/.prod.env react-scripts start”,<br/>“build:prod”: “env-cmd -f ./environments/.prod.env npm run-script build”</span><span id="b857" class="kv kw hi kr b fi lb ky l kz la">},</span></pre><p id="48ae" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">接下来，通过运行以下命令启动您的本地/开发react应用程序</p><pre class="iz ja jb jc fd kq kr ks kt aw ku bi"><span id="b74f" class="kv kw hi kr b fi kx ky l kz la">npm run start:dev</span></pre><p id="bc4b" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">您可以通过执行以下操作来测试应用程序中的env变量</p><pre class="iz ja jb jc fd kq kr ks kt aw ku bi"><span id="edeb" class="kv kw hi kr b fi kx ky l kz la">console.log(process.env.REACT_APP_API_END_POINT);</span></pre><p id="a7f0" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">对于QA和生产构建，分别将命令<strong class="jm hj"> <em class="kg"> npm运行构建</em> </strong>替换为新添加的环境特定命令<strong class="jm hj"> <em class="kg"> npm运行构建:qa </em> </strong>或<strong class="jm hj"> <em class="kg"> npm运行构建:prod </em> </strong>。(<em class="kg">例如，如果您在AWS上，编辑Codebuild上的buildspec并将</em> <strong class="jm hj"> <em class="kg"> npm运行构建</em> </strong> <em class="kg">替换为</em> <strong class="jm hj"> <em class="kg"> npm运行构建:qa </em> </strong> <em class="kg">或</em> <strong class="jm hj"> <em class="kg"> npm运行构建:prod) </em> </strong></p><p id="8094" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">始终运用你的判断技巧，记住不要在这些文件中添加任何敏感信息。</p><p id="0c13" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">仅此而已。我们已经学习了如何使用CRA在react应用程序中创建多个环境。</p><p id="48b2" class="pw-post-body-paragraph jk jl hi jm b jn jo ij jp jq jr im js jt ju jv jw jx jy jz ka kb kc kd ke kf hb bi translated">我希望这篇文章是有帮助的。谢谢，干杯！</p><h1 id="27c9" class="lg kw hi bd lh li lj lk ll lm ln lo lp io lq ip lr ir ls is lt iu lu iv lv lw bi translated">感谢所有的掌声！</h1><figure class="iz ja jb jc fd jd er es paragraph-image"><div class="er es lx"><img src="../Images/5a97d6354aba17cefcc14f59d8e3e2ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*pZiJVXQg8K9as4PJ.png"/></div></figure></div></div>    
</body>
</html>
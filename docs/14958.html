<html>
<head>
<title>Top Competitor SQL Question</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">主要竞争对手SQL问题</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/part-2-top-competitor-sql-question-404e8220d48a?source=collection_archive---------16-----------------------#2022-10-04">https://medium.com/geekculture/part-2-top-competitor-sql-question-404e8220d48a?source=collection_archive---------16-----------------------#2022-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="98e7" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">第17部分:SQL问题</h2></div><p id="d95c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于任何有兴趣过渡到数据科学领域并磨练其SQL和Python技能的人来说，HackerRank是一个优秀的平台。这个平台提供从初级到高级的编码问题。当你成功回答一个问题时，它还会颁发徽章。我强烈建议你注册一个HackerRank账户，并在文章中练习这个问题。我将使用MySql SQL数据库来解决这个问题。</p><p id="1a6b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以通过研究基于产品的公司提出的一系列SQL问题来提高您的SQL问题解决技能。以下是基于产品的企业提出的Postgres SQL问题集合的链接:</p><div class="jt ju ez fb jv"><div role="button" tabindex="0" class="ab bv ff cb dy jw jx bn jy jz ka"><div class="kb l"><div class="ab q"><div class="l di"><img alt="R. Gupta" class="l de bw kc kd du" src="../Images/70207ad0decf9fadb709608abf121645.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*VKG7ua5JklBVaWVvc2cB8Q.jpeg"/><div class="dr bw l kc kd ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated">r .古普塔</p></div></div><div class="kg kh fg l"><h2 class="bd hj sh lq dy si ea eb sj ed ef hh bi translated">面试问题</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi sk au sl sm sn oy so an fx fy sp sq sr gb gc gd de bk ge" href="https://agupta97.medium.com/list/stratascratch-postgres-interview-problems-c4020531504b?source=post_page-----404e8220d48a--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="ss l dw"><span class="bd b fp z dx">18 stories</span></div></div></div><div class="kt dh ku dy ab kv dw di"><div class="di kl bv km kn"><div class="dh l"><img alt="" class="dh" src="../Images/e566d22f927cc4d9b2e12e2bb52bc915.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*SLyuftfrcBDQAkH1eKD9Xg.jpeg"/></div></div><div class="di kl bv ko kp kq"><div class="dh l"><img alt="" class="dh" src="../Images/1352126327d45095086041e8e64954b6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*wZyz0GXAws3cQNKwhQpXHw.jpeg"/></div></div><div class="di bv kr ks kq"><div class="dh l"><img alt="" class="dh" src="../Images/1352126327d45095086041e8e64954b6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*wZyz0GXAws3cQNKwhQpXHw.jpeg"/></div></div></div></div></div><p id="afe6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你从事数据科学工作或者想从事数据科学职业，SQL是一项至关重要的技能。<br/>如果你熟悉SQL，你将有更好的机会通过数据科学面试或处理日常任务。本文将集中讨论一个问题以及如何解决它。您应该阅读这篇文章来提高您的SQL知识和经验。你集思广益和寻求解决方案的方法无疑会提高。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es la"><img src="../Images/dc55d69842f08d118c70a801f41dec40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qKE-fgf80HbusoX9XSjtRw.jpeg"/></div></div><figcaption class="ll lm et er es ln lo bd b be z dx">Photo by <a class="ae lp" href="https://unsplash.com/@euwars?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Farzad</a> on <a class="ae lp" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cadc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是HackerRank上问的中级问题。可以在这里 查看问题<a class="ae lp" href="https://www.hackerrank.com/challenges/full-score/problem" rel="noopener ugc nofollow" target="_blank"> <strong class="iz hj">。问题名称是<strong class="iz hj">顶级竞争对手。</strong>以下是问题的详细内容:</strong></a></p><p id="32e9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">问题:顶级竞争对手</strong></p><p id="3bb0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Julia刚刚完成了一场编码竞赛，她需要您的帮助来组装排行榜！编写一个查询来打印在多个挑战中获得满分的黑客各自的hacker_id和姓名。按照黑客获得满分的挑战总数降序排列您的输出。如果多个黑客在相同数量的挑战中获得满分，则按hacker_id升序排列。</p><p id="e334" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">输入格式</strong></p><p id="a041" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下表包含竞赛数据:</p><ul class=""><li id="e5bb" class="lq lr hi iz b ja jb jd je jg ls jk lt jo lu js lv lw lx ly bi translated"><strong class="iz hj">黑客:</strong>hacker _ id是黑客的id，name是黑客的名字。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es lz"><img src="../Images/25389e1943af0b37dc8d370ac082f529.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/0*yQgnOT_NWrfDUyz3.png"/></div></figure><ul class=""><li id="a667" class="lq lr hi iz b ja jb jd je jg ls jk lt jo lu js lv lw lx ly bi translated"><strong class="iz hj">难度:</strong>难度等级是挑战的难度等级，分数是挑战对于难度等级的分数。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ma"><img src="../Images/88d753d8d6fb23bfaf991fc04af30ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/0*VFaGV6TUZZHMShaG.png"/></div></figure><ul class=""><li id="53e8" class="lq lr hi iz b ja jb jd je jg ls jk lt jo lu js lv lw lx ly bi translated"><strong class="iz hj">挑战:</strong>挑战_id是挑战的id，黑客_id是创建挑战的黑客的id，难度_等级是挑战的难度等级。请注意，此表中显示的hacker_id是创建挑战的人的hacker_id，而不是解决挑战的人的hacker _ id。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mb"><img src="../Images/75668795aea497a49c2d795b73e3993d.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/0*RUF60zEEwFFVby7z.png"/></div></figure><ul class=""><li id="75ee" class="lq lr hi iz b ja jb jd je jg ls jk lt jo lu js lv lw lx ly bi translated"><strong class="iz hj">提交:</strong>submission _ id是提交的id，hacker_id是提交的黑客的id，challenge_id是提交所属挑战的id，score是提交的分数。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ma"><img src="../Images/7de8d32d94ca5e965b905d0ca64fe510.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/0*HR85A232WPBI8gXw.png"/></div></figure><p id="6683" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">样本输入</strong></p><p id="c83d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">黑客表:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mc"><img src="../Images/1d3490587d8652093fb864835bfd02af.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/0*y5GPiqg7cOdOSxqx.png"/></div></figure><p id="eef1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">难度表:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es md"><img src="../Images/bf01e9e7b047bb08b2ed1864b18fdbd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/0*3LiyJSlMhCefK4rh.png"/></div></figure><p id="9bd7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">挑战表:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es me"><img src="../Images/a08315bd606cc3d20486ad8201e7e2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/0*QRo97irkeXWOLzJj.png"/></div></figure><p id="7125" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">提交表格:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mf"><img src="../Images/260b58706c19c67cf601523cbc371e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/0*lt1uwHwxcqIVqZym.png"/></div></figure><p id="e53c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">样本输出</strong></p><pre class="lb lc ld le fd mg mh mi mj aw kz bi"><span id="08bd" class="mk ml hi mh b fi mm mn l mo mp"><strong class="mh hj">90411 Joe</strong></span></pre><p id="1679" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文假设您熟悉select、from、where、order by和limit子句。如果你想温习一下你的概念，你可以先阅读下面列出的文章，然后回到这里对这个问题有更深入的理解。</p><p id="9e4d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae lp" href="https://agupta97.medium.com/list/lets-explore-postgres-in-deep-e9d4985a1413" rel="noopener">https://agupta 97 . medium . com/list/lets-explore-postgres-in-deep-e9d 4985 a 1413</a></p><p id="ef2a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">方法:</strong></p><ol class=""><li id="3420" class="lq lr hi iz b ja jb jd je jg ls jk lt jo lu js mq lw lx ly bi translated"><strong class="iz hj">逻辑部分:</strong></li></ol><p id="1f20" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">连接表:</strong>首先，我们需要连接所有给定的具有共同特征的表，即<code class="du mr ms mt mh b"><strong class="iz hj">(Submissions.challenge_id = Challenges.challenge_id )</strong></code>、<code class="du mr ms mt mh b"><strong class="iz hj">(Challenges.difficulty_level = Difficulty.difficulty_level )</strong></code>、<br/>、<code class="du mr ms mt mh b"><strong class="iz hj"> ( Submissions.hacker_id = Hackers.hacker_id).</strong></code></p><p id="ec50" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">找到满分的记录:</strong>那么我们需要再加一个条件，黑客得了满分。为此，我们可以增加一个条件，使<code class="du mr ms mt mh b">Submissions.score </code>和<code class="du mr ms mt mh b">Difficulty.score</code>相等。</p><p id="ebf5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">查找多项挑战满分的记录:</strong>查找那些多项挑战满分的黑客。为此，我们可以根据<code class="du mr ms mt mh b"> Hackers.hacker_id</code>和<code class="du mr ms mt mh b">Hackers.name</code>对记录进行分组，并在having子句中添加条件<code class="du mr ms mt mh b">count(1) &gt; 1</code>，因为不能在where子句中对聚合函数使用过滤器。</p><p id="7620" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">排序记录:</strong>应用上述条件后，您必须对记录进行排序，以便它们出现在排行榜上。如问题中所述，记录应按黑客参与的挑战数量降序排列。如果不止一名黑客参与了相同的挑战，则记录应按黑客id的升序排序。为了实现这种期望的顺序，我们将使用order by子句，如下所示:<code class="du mr ms mt mh b"><strong class="iz hj">order by <br/> count(s.challenge_id) desc , h.hacker_id asc ;</strong></code></p><p id="ff39" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.<strong class="iz hj">编码部分:</strong>我们将首先执行连接，然后过滤记录，最后应用group by和order by子句，以期望的顺序输出期望的记录。</p><pre class="lb lc ld le fd mg mh mi mj aw kz bi"><span id="1c0b" class="mk ml hi mh b fi mm mn l mo mp"><strong class="mh hj">select  <br/>             s.hacker_id, <br/>             h.name <br/>        from <br/>             Hackers as h, <br/>             Difficulty as d,<br/>             Challenges as c,<br/>             Submissions as s<br/>        where <br/>             s.challenge_id = c.challenge_id and<br/>             c.difficulty_level = d.difficulty_level and <br/>             s.hacker_id = h.hacker_id and <br/>             s.score  = d.score <br/>       group by <br/>             s.hacker_id, h.name <br/>       having <br/>             count(s.score) &gt; 1 <br/>       order by <br/>             count(s.challenge_id) desc , h.hacker_id asc ;</strong></span></pre></div><div class="ab cl mu mv gp mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="hb hc hd he hf"><p id="86be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">实际上，需要将问题分解成更小的问题。在阅读问题两遍后，决定使用哪些列来计算期望的结果。之后，确定计算每个子问题所需的函数，然后尝试连接子问题的解决方案。使用这种方法，你可以快速解决任何问题。接触将提高你开发解决问题的新方法和途径的能力。<br/>感谢你阅读我的帖子并回复我；这对我意义重大。如果你喜欢它，竖起大拇指，点击“关注”在媒体上关注我，以便在我发布新内容时得到通知。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How To Measure Football Prediction Model Quality</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何衡量足球预测模型质量</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-measure-football-prediction-model-quality-cac480a1e2f7?source=collection_archive---------5-----------------------#2021-12-14">https://medium.com/geekculture/how-to-measure-football-prediction-model-quality-cac480a1e2f7?source=collection_archive---------5-----------------------#2021-12-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="9d3b" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">分析变得简单</h2><div class=""/><div class=""><h2 id="2d3d" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">联盟可预测性指数(LPI)在起作用</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/30721cd2f5b613993c424aaa476d604d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3p5jLuScDMFtekvZwCK5w.jpeg"/></div></div></figure><h2 id="11da" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ho bi translated">介绍</h2><p id="dd70" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">在预测建模中，最重要的步骤之一是测量模型质量。更重要的是，你需要有一个可以理解和概括的衡量标准。有很多指标可以用来训练模型、选择参数或进行交叉验证。其中，对于分类问题，我们可以提到准确度、<a class="ae li" href="https://en.wikipedia.org/wiki/F-score" rel="noopener ugc nofollow" target="_blank"> F1得分</a>，或者<a class="ae li" href="https://en.wikipedia.org/wiki/Cross_entropy" rel="noopener ugc nofollow" target="_blank">对数损失</a>。</p><p id="c132" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">虽然它们相对容易使用，但要理解对数损失为-0.93或准确度为10%是否意味着模型是一个好的或坏的预测器并不总是容易的。</p><p id="00b9" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">在本文中，我们证明了足球预测模型的性能数字不足以判断其质量。我们将引入<strong class="kr hs">基准</strong>的概念，这对于理解一个模型是否真正从数据中学习是必要的。</p><h1 id="88bf" class="lo jt hi bd ju lp lq lr jy ls lt lu kc ix lv iy kg ja lw jb kk jd lx je ko ly bi translated">基准的必要性</h1><p id="9e7d" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">我们已经介绍了<a class="ae li" rel="noopener" href="/p/1e5e22310497">对数损失和准确度</a>，这是足球预测中使用的分类模型的两个性能度量。</p><p id="63f3" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">对数损失为您提供了模型产生的概率质量的度量。但是这种损失随着班级数量的增加而不同。因此，很难将模型性能与对数损失的规模联系起来。</p><p id="7fc3" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">准确度没有这个问题。事实上，很容易理解你10%的预测是正确的。但这就说明你的模式好还是不好？如果你有一个两级问题，可能不是。如果你有100个类的问题呢？事实上，即使你知道班级的数量，你也无法回答这个问题。让我们解释一下为什么。</p><p id="b582" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">比方说，从你的窗户前经过的90%的汽车是白色的，我们教一个深度神经网络模型来预测下一辆汽车的颜色。如果模型最终总是预测“汽车是白色的”,那么它的准确率将达到90%。然而，这并不能使它成为一个很好的模型。此外，你可以透过窗户观察，观察到大多数汽车是白色的，并预测下一辆汽车将是白色的。<strong class="kr hs">你会达到和深度神经网络一样的性能。</strong>在这种情况下，你会得出模型不好的结论，因为你可以达到同样的性能:<strong class="kr hs">你作为基准</strong>。</p><blockquote class="lz"><p id="1ae7" class="ma mb hi bd mc md me mf mg mh mi lh dx translated">拥有一个基准是断言模型质量的好方法。没有超过基准意味着模型是porr，或者你试图预测的东西太随机，无法从数据中学习。</p></blockquote><p id="595d" class="pw-post-body-paragraph kp kq hi kr b ks mj is ku kv mk iv kx kd ml kz la kh mm lc ld kl mn lf lg lh hb bi translated">这是一个明显的夸张，但是它给你一个<strong class="kr hs">基准模型</strong>的概念:一个普通的模型，在这种情况下，你可以透过窗户观看。</p><h1 id="b2df" class="lo jt hi bd ju lp lq lr jy ls lt lu kc ix lv iy kg ja lw jb kk jd lx je ko ly bi translated">足球模特的标杆</h1><p id="e4e8" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">在足球中，我们可以预测很多事件:最终比分，半场比分，第一个进球的球队，进球数等等。为它们中的每一个设定一个基准将有助于对模型质量有一个共同的度量。</p><p id="38db" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">正如我们对汽车例子所做的那样，我们可以为每个市场建立一个基准。显然，你不会观看所有的比赛，并计算哪些比赛出现得更频繁。相反，我们可以使用数据，查看过去的匹配，并找出最常见的结果。这是一个简单的<strong class="kr hs">历史模型。</strong></p><p id="97c4" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">例如，在一个特定联赛的过去100场比赛中，我们观察到主队赢得45%的时间，客场30%，平局35%。这将使我们的对数损失为-1.06。相比之下，随机对数损失为-1.098。</p><blockquote class="mo mp mq"><p id="5659" class="kp kq mr kr b ks lj is ku kv lk iv kx ms ll kz la mt lm lc ld mu ln lf lg lh hb bi translated">随机模型也是一个可能的基准，但它不公平。例如，我们知道主场球队赢的几率超过33%,所以知识应该在基准中</p></blockquote><h2 id="8d7c" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ho bi translated"><strong class="ak">举例</strong></h2><p id="4f22" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">让我们用一个模型和匹配结果得到一个例子。数据由<a class="ae li" href="https://www.sportmonks.com/" rel="noopener ugc nofollow" target="_blank"> sportmonks </a>提供。我们将他们的概率用于1x2市场。</p><p id="a493" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">我们收集了2021年10月到2021年12月之间的15000场比赛，分布在643个联赛中。匹配和对数丢失是按时间排序的。首先，我们使用每个日期1000个过去匹配的平均结果来计算基准概率。下一幅图展示了这些历史概率随时间的演变。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mv"><img src="../Images/1ed72e8643d65a82183bcb68b2cac5a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFCcVk8JlBmo6dP9dr0bXQ.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx">Evolution of the historical probabilities for 1, X and 2</figcaption></figure><p id="9fe1" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">例如，在2021年12月底，我们测得主队获胜的概率为39.5%，失败的概率为31.5%，平局的概率为29%。随机基准应该是33%。</p><p id="3d14" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">然后使用预测模型概率和我们新的历史概率，我们计算每个匹配的对数损失。然后我们取1000次观察的滚动平均值。我们还添加了随机基准。下图显示了对数损失的演变。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es na"><img src="../Images/e825e055662f3cab096b80e0d1775830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fhlRz_QbZ0q1WzhCpVkJ_w.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx">Evolution of the log-loss for each model</figcaption></figure><p id="36bd" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">我们观察到预测模型优于基准，这意味着它能够从数据中学习有用的信息。我们还注意到历史模型是比随机猜测更好的基准。</p><h1 id="c207" class="lo jt hi bd ju lp lq lr jy ls lt lu kc ix lv iy kg ja lw jb kk jd lx je ko ly bi translated">联盟预测指数</h1><p id="f7a8" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">联盟可预测性指数(LPI)是一种衡量模型相对于历史基准的对数损失的方法，被<a class="ae li" href="https://www.sportmonks.com/" rel="noopener ugc nofollow" target="_blank"> sportmonks </a>用来评估他们的模型。<strong class="kr hs">每天，对于每个联赛，</strong>在过去的100场比赛中，计算每个赛事<strong class="kr hs">的模型对数损失，或者更少，如果没有至少50场比赛的数据。</strong></p><p id="df86" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">基准对数损失是在相同数量的比赛上计算的，但不是使用联盟的平均市场结果。</p><p id="bd9f" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">然后，<strong class="kr hs">模型的质量被分类为差、中、好或高</strong>取决于其对数损失level(ℓ)相对于基准的百分比量。下表显示了我们用于所有型号的数字。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nb"><img src="../Images/d5ae219d9be5b3bd4e983cdffb9d9e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZz22mjH5aaagXDuMLQvtw.png"/></div></div><figcaption class="mw mx et er es my mz bd b be z dx">Predictability index classification</figcaption></figure><p id="b886" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">例如，对于特定联盟，如果基准日志损失为-1.01，而我们的模型日志损失为-0.98，则可预测性指数将为<strong class="kr hs">中</strong>。如果我们的模型对数损失为-0.94，指数将为<strong class="kr hs">良好</strong>和<strong class="kr hs">高</strong>如果它高于-0.93425。</p><h1 id="5637" class="lo jt hi bd ju lp lq lr jy ls lt lu kc ix lv iy kg ja lw jb kk jd lx je ko ly bi translated">结论</h1><p id="3539" class="pw-post-body-paragraph kp kq hi kr b ks kt is ku kv kw iv kx kd ky kz la kh lb lc ld kl le lf lg lh hb bi translated">在本文中，我们讨论了为什么在足球预测的情况下，仅仅有性能指标不足以评估模型的质量。事实上，使用一个普通的基准将有助于理解一个模型是否真的从数据中学习到有用的信息。</p><p id="50b6" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">历史模型似乎是一个很好的基准，因为它将向你展示一个模型与联盟的平均结果相比在性能方面的表现。它是通用的，易于计算，并可扩展到任何市场。</p><p id="0024" class="pw-post-body-paragraph kp kq hi kr b ks lj is ku kv lk iv kx kd ll kz la kh lm lc ld kl ln lf lg lh hb bi translated">或者，您可以使用另一个模型或您自己的基准来帮助您了解您的模型预测是否真的在执行。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Flight Fare Prediction: Machine Learning project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机票价格预测:机器学习项目</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/flight-fare-prediction-93da3958eb95?source=collection_archive---------0-----------------------#2022-02-05">https://medium.com/geekculture/flight-fare-prediction-93da3958eb95?source=collection_archive---------0-----------------------#2022-02-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="4d0f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">您的航班票价预测机器学习项目的分步指南！</h1><p id="3a83" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在本文中，我将带您了解我们如何训练一个模型来帮助我们预测机票价格。您将练习到目前为止所学的机器学习工作流，以使用价格的属性来预测价格。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/040fbf64583ea1121e9abcb22aa03f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNGEychD0x_HYqjyWEQGHw.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Photo by <a class="ae kr" href="https://unsplash.com/@punttim?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Tim Gouw</a> on <a class="ae kr" href="https://unsplash.com/s/photos/plane?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="19c9" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">潜在的业务问题</strong>--</p><p id="c553" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">机票价格很难猜测。我们已经获得了2019年3月至6月期间各航空公司和各城市之间的机票价格，我们旨在利用这些价格建立一个模型，该模型使用各种输入特征预测航班价格。</p><p id="b32b" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">关于数据集，请访问</strong>:</p><p id="7c26" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><a class="ae kr" href="https://www.kaggle.com/nikhilmittal/flight-fare-prediction-mh/" rel="noopener ugc nofollow" target="_blank"><em class="kx">https://www . ka ggle . com/nikhilmittal/flight-fare-prediction-MH/</em></a></p><p id="e92d" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们这里有2个数据集—训练集和测试集。</p><p id="df75" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">训练集包含这些功能，以及航班的价格。它包含10683条记录、10个输入特征和1个输出列—“价格”。</p><p id="7228" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">测试集包含2671条记录和10个输入特征。需要在该集合中预测输出“价格”列。这里我们将使用回归技术，因为预测的输出将是一个连续的值。</p><p id="5cb1" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">以下是数据集中可用的要素-航空公司、旅行日期、来源、目的地、路线、停靠时间、到达时间、持续时间、总停靠站、附加信息、价格。</p><h1 id="5274" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据科学项目的整个生命周期分为四个部分:</h1><ol class=""><li id="78f3" class="ky kz hi jf b jg jh jk jl jo la js lb jw lc ka ld le lf lg bi translated"><a class="ae kr" href="https://medium.com/p/93da3958eb95/edit#e6a5" rel="noopener">探索性数据分析</a></li><li id="b1db" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><a class="ae kr" href="https://medium.com/p/93da3958eb95/edit#1aee" rel="noopener">特征工程</a></li><li id="d836" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><a class="ae kr" href="https://medium.com/p/d25559cf2d2a/edit#7edb" rel="noopener">功能选择</a></li><li id="116f" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated"><a class="ae kr" href="https://medium.com/p/d25559cf2d2a/edit#61e6" rel="noopener">模型部署</a></li></ol></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h2 id="e6a5" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated"><a class="ae kr" href="https://medium.com/p/93da3958eb95/edit#e6a5" rel="noopener"> <strong class="ak">探索性数据分析</strong> </a></h2><p id="d20e" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">现在，让我们从机器学习预测航班票价的任务开始。首先，我将导入完成此任务所需的所有必要的库，并导入训练数据集。</p><p id="9833" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">1)导入库</p><p id="a367" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">2)导入数据集</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mh"><img src="../Images/a92043a2540c524c02e5273bf0c76686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ot37u5LKjo8JtTG3jd5ww.png"/></div></div></figure><p id="8a23" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">在处理数据科学问题时，我们可以做的第一件事是了解您正在处理的数据集。记录下数据中的主要观察结果和趋势。监控变量和输出价格之间的所有相关性。为此，您可以使用<strong class="jf hj"> df.info </strong>、<strong class="jf hj"> df.head()等。</strong></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mi"><img src="../Images/b50a25474f0092738e873511053beac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4KeMiROf88KzgpFmDMCThQ.png"/></div></div></figure><p id="2e6f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">通过观察训练数据集，我们注意到:</p><p id="7091" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj"> Route </strong>列包含我们需要分离的城市列表，因为我们的数据集中有多个组合。</p><p id="9939" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">到达时间</strong>列附带了日期，我们需要将它们分开。</p><p id="2eb5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj"> Duration，Date_of_Journy </strong>列为字符串格式，需要转换为整型。</p><p id="0980" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj"> Total_stops </strong>列中添加了单词“stops”以及停止次数，并且<strong class="jf hj"> Dep_Time、Duration </strong>列也不是我们需要转换为整数的适当形式。</p><p id="ca8a" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">在数据分析中，我们将尝试找出以下内容</strong></p><ol class=""><li id="dc28" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka ld le lf lg bi translated">数据集中缺少值。</li></ol><p id="5cb0" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">2.所有的数值变量和数值变量的分布</p><p id="c06f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">3.分类变量</p><p id="6dd8" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">4.极端值</p><p id="544d" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">5.独立功能和从属功能之间的关系(<em class="kx">价格</em>)</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mm"><img src="../Images/73d8b51a68cb1a12151a42700a0e3d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2GopjYHfHBrjuiAjF5WcA.png"/></div></div></figure><p id="dd85" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们的训练数据集中没有缺失值，因为所有列都有10683个条目。正如我们在train_data.info()中看到的，所有相关列都是“对象”数据类型，为了将这些列正确用于模型，我们必须将这些数据类型转换为适当的形式，我们将在特征工程中看到。</p><p id="67dc" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">探索性数据分析以两种不同的方式交叉分类，每种方法都是图形化的或非图形化的。然后，每种方法都是单变量、双变量或多变量的。</p><p id="ed0a" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">单变量分析</strong></p><p id="6f19" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">在单变量分析中，只有一个可靠变量。单变量分析的目的是导出数据并分析其中的模式。在训练数据集中，它分别研究每个分类列。</p><p id="4b7c" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">条形图在比较数据类别时非常方便。它有助于跟踪随时间的变化。它最适合可视化离散数据。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mn"><img src="../Images/18289dd83191ef43e31f8c3d8a8b683f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5EYwyWCdBvnBHCY-9ucV0g.png"/></div></div></figure><ul class=""><li id="896c" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka mo le lf lg bi translated">Jet Airways是最受欢迎的航空公司，排在第一位，其次是Indigo和AirIndia。喷气航空业务是最昂贵的航空公司。</li><li id="7e54" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mo le lf lg bi translated">Vistara Premium economy、Trujet、Multiple carries premium economy和Jet airways的业务很低。</li></ul><p id="0bb9" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">在数据分析之后，我们将尝试在特征工程中对上述内容进行如下处理。</p></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h2 id="1aee" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated"><a class="ae kr" href="https://medium.com/p/93da3958eb95/edit#1aee" rel="noopener"> <strong class="ak">特征工程</strong> </a></h2><p id="d979" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您可以看到数据的样子，但是在使用它之前，我们需要对它进行定制。我们将在特征工程中执行以下所有步骤。</p><ul class=""><li id="ef2e" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka mo le lf lg bi translated"><strong class="jf hj">分类变量的替代</strong></li></ul><p id="e422" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们发现所有的列都是“object”数据类型，只有“Price”列是整数类型。人们可以找到许多处理分类数据的方法。其中一些分类数据是，</p><ol class=""><li id="04c0" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka ld le lf lg bi translated">名义数据→数据没有任何顺序→在这种情况下使用OneHotEncoder</li><li id="b438" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka ld le lf lg bi translated">序数数据→数据按顺序→ LabelEncoder在这种情况下使用。</li></ol><p id="67f0" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">“航空公司”列有12个唯一值—“IndiGo”、“印度航空公司”、“Jet航空公司”、“SpiceJet”、“多家航空公司”、“GoAir”、“Vistara”、“亚洲航空公司”、“Vistara高级经济舱”、“Jet航空公司商务”、“多家航空公司高级经济舱”、“Trujet”。</p><p id="a016" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">Airline列是名义分类数据，基数较小，因此我们将执行一次热编码。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/a0997417bb8f131fe47b5f3836b8978d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Pg1YzCNvr5QZLJJGiINprQ.png"/></div></figure><p id="6e86" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">从。info()我们知道Date_of_Journey是一个对象数据类型。为了处理这种分类数据，我们使用特征提取方法，其中我们使用<strong class="jf hj">旅行日期</strong>导出新特征。为此，我们需要pandas <strong class="jf hj"> to_datetime </strong>将对象数据类型转换为datetime dtype。</p><ol class=""><li id="6326" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka ld le lf lg bi translated">旅程之日2。旅行的月份</li></ol><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/30e25bf5ab59767eab59641bc0de06ad.png" data-original-src="https://miro.medium.com/v2/format:webp/1*MSL96xGTKH68_YfbyiWr0Q.png"/></div></figure><p id="e456" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">类似地，我们从Dep_Time和Arrival_Time中提取值，并为出发时间[“Dep _ hour”]和分钟[“Dep _ min”]、到达时间、到达分钟创建单独的列。</p><p id="a548" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">由于我们已经将Date_of_Journey、Dep_Time和Arrival_Time列转换为整数，现在我们可以删除它，因为它没有用。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/909e6aa20490c4053ddc7a67d542d5da.png" data-original-src="https://miro.medium.com/v2/format:webp/1*_Y_ED3z_xvD46IqpE4LxtA.png"/></div></figure><p id="c9d2" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">持续时间列不是帮助预测机器学习模型的适当形式。我们必须用同样的格式。在数据集中，一些飞行持续时间可能只有“30分钟”，所以我们将它写成“0小时30分钟”。因此，我们从“持续时间”中提取两个新列“持续时间_小时”和“持续时间_分钟”。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/07b2217e8a5ce30a0723ab905970d8ad.png" data-original-src="https://miro.medium.com/v2/format:webp/1*a1SH6XLWsSi16-kG0qzCJg.png"/></div></figure><p id="bcf5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">源列有5个唯一值-“班加罗尔”、“加尔各答”、“钦奈”、“德里”和“孟买”。因为源是名义分类数据，基数较小，所以我们将执行OneHotEncoding。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mq"><img src="../Images/69a781c786c3418432044835b62dc6b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8tD-RKWMJVuIp5npgqEPA.png"/></div></div></figure><p id="dd58" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">目的地列有6个唯一值-“新德里”、“邦洛尔”、“科钦”、“加尔各答”、“德里”、“海德拉巴”。目标是名义分类数据，基数较小，因此我们将执行OneHotEncoding。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/f1c5ead6d5519508b22c70ce88c95050.png" data-original-src="https://miro.medium.com/v2/format:webp/1*O5AIFKjCFZId1pUw4_V_lg.png"/></div></figure><p id="cbde" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">附加信息包含几乎80%的无信息，路线和总停靠站也相互关联。因此我们将删除这两列。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="ab fe cl mp"><img src="../Images/23f84ee28038fd3bd592857d4be50a66.png" data-original-src="https://miro.medium.com/v2/format:webp/1*k2szQY_hfx7jwziRCFvoYg.png"/></div></figure><p id="c40e" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">Total_Stops有5个唯一值:“1站”、“不停”、“2站”、“3站”、“4站”。在这种情况下，我们执行标签编码器。<br/>数值由相应的键分配。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mr"><img src="../Images/7d718cbafae9c7c4c36c3453136cb785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4nv9sqZ4bfc0bytRVYayw.png"/></div></div></figure><p id="c21f" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们为这个模型使用kaggle数据集，其中训练和测试数据已经存储在不同的文件中。我们不应该合并测试数据集和训练数据集，这可能导致数据泄漏。</p><p id="8837" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">同样的，</p><p id="848b" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们为训练数据集所做的所有功能工程与我们将为测试数据集所做的相同。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ms"><img src="../Images/1d86dd1e3e9212f3afad7772d8ff1168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVkjfmw1HTVcfK9mPx9zrg.png"/></div></div></figure></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><h2 id="97ac" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated"><a class="ae kr" href="https://medium.com/p/d25559cf2d2a/edit#7edb" rel="noopener">功能选择</a></h2><p id="d717" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">模特培训:</strong></p><p id="4b69" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们事先不知道哪个模型在这个问题上表现最好，因为它是不可知的。我们在训练集上使用额外的树回归器、随机森林回归模型(特征选择)。您可以尝试任意数量的回归模型，并从中选择一个最合适的模型。</p><p id="1514" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们从训练数据集中删除“价格”列，并使(y)成为独立变量，以找到独立数据和非独立数据之间的相关性。清理完数据后，我们可以将数据可视化，更好地理解不同变量之间的关系。为了更好地了解数据集，您还可以做更多的可视化工作，如散点图、直方图、箱线图等。</p><p id="5e7e" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">使用<strong class="jf hj"> sns.heatmap() </strong>我们可以看到,【总停站数】<em class="kx"/>与<em class="kx">价格</em>正相关，导致燃料成本增加，价格上涨。此外，总停留次数与持续时间高度相关，这意味着如果停留次数增加，飞行的持续时间也会增加。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mt"><img src="../Images/ee499a120c96ea2392c3dc81da352438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrCHfD8E0tZCcvQ8679Y8w.png"/></div></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mu"><img src="../Images/5aca4c0d50830516e622b896a8927d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Idgru3PkticprCzhdcTERw.png"/></div></div></figure><h2 id="ff24" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">树外回归模型</h2><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mv"><img src="../Images/1d6d571d9c25d110b0b964a9567e1e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xSKTosmmXPmPnza7EZOzDQ.png"/></div></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mw"><img src="../Images/d5ad8d56559a37727562f234f97a4198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zEn9mSzV3WmqkHv-wXu0ig.png"/></div></div></figure><p id="ccf5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我们可以看到Total_stops是决定价格时最重要的特征。</p><h1 id="ee20" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用随机森林拟合模型</h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mx"><img src="../Images/b4301fca1a6e6462b4f8250efa708e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OxhXH3JBcxmxqJ2hJhzKbg.png"/></div></div></figure><p id="a0d7" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">拟合参数分布</strong></p><p id="0392" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">您还可以使用<code class="du my mz na nb b"><strong class="jf hj">distplot()</strong></code>来拟合数据集的参数分布，并直观地评估它与观察数据的对应程度。它应该是一个封闭的高斯分布图，并且“y_test”(真实值)和“预测值”之间的差异也应该是最小的。这里大部分残差都是0，这意味着我们的模型泛化能力很好。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es nc"><img src="../Images/20a77ab10667f50a544e45848ee84046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ptxOTRsPnqv8oe6lHwX32g.png"/></div></div></figure><h2 id="2766" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">绘制y_test与预测。</h2><p id="2d9f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">散点图用于观察变量之间的关系，并用点来表示变量之间的关系。这里的点几乎排成一条线。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nd"><img src="../Images/be567dd0e621d2bcacd842bcb80d5508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*TymfduHQNXPTIR_wJK5Njw.png"/></div></figure><h1 id="6313" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">超参数调谐</h1><p id="4f95" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们使用随机搜索CV寻找最佳超参数。参数的随机搜索，在100个不同的组合中使用5折交叉验证搜索。</p><p id="9350" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated"><strong class="jf hj">检查模型的准确性</strong></p><p id="2af5" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">评估模型准确性是创建机器学习模型以描述模型在预测中表现如何的过程中的一个重要部分。MSE、MAE和RMSE度量主要用于评估回归分析中的预测误差率和模型性能。</p><ul class=""><li id="7703" class="ky kz hi jf b jg ks jk kt jo mj js mk jw ml ka mo le lf lg bi translated"><strong class="jf hj"> MAE </strong>(平均绝对误差)代表原始值和预测值之间的差异，通过对数据集的绝对差异进行平均来提取。</li><li id="57c1" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mo le lf lg bi translated"><strong class="jf hj"> MSE </strong>(均方误差)代表原始值和预测值之间的差异，通过对数据集的平均差异进行平方来提取。</li><li id="fe3f" class="ky kz hi jf b jg lh jk li jo lj js lk jw ll ka mo le lf lg bi translated"><strong class="jf hj"> RMSE </strong>(均方根误差)是以MSE的平方根表示的误差率。</li></ul><p id="c38d" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">回归器保存为pickle文件，以便将来加快执行速度。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ne"><img src="../Images/efbedb73155706791cb3b308a38d5499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0iMGtQcWeTNKMuxd9-Qng.png"/></div></div></figure><h2 id="03ec" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated">保存模型</h2><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es nf"><img src="../Images/21f898aff9e50c5d4792f3caa2353358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfnrLGcgQfg6akF55GmUew.png"/></div></div></figure><h2 id="de03" class="lt ig hi bd ih lu lv lw il lx ly lz ip jo ma mb it js mc md ix jw me mf jb mg bi translated"><a class="ae kr" href="https://medium.com/p/d25559cf2d2a/edit#61e6" rel="noopener">模型部署</a></h2><p id="7cec" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">模型部署是任何机器学习项目的最后阶段之一。在这里，我们将设计一个用户界面。我们用一个烧瓶制作了一个HTML文件，用于航班价格预测。这将获取每个要素的输入值，并计算航班的价格，如下图所示。</p><p id="fc5b" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">您可以通过GitHub链接在Heroku上部署您的模型。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ng"><img src="../Images/f1da5d9eff1c1be1de03ae6a6b449819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDnIo-97HRKcxS3K3bX1Iw.png"/></div></div></figure><p id="ebd0" class="pw-post-body-paragraph jd je hi jf b jg ks ji jj jk kt jm jn jo ku jq jr js kv ju jv jw kw jy jz ka hb bi translated">我希望你喜欢这篇关于如何用机器学习预测机票价格的文章。欢迎在下面的评论区提出你有价值的问题:)</p></div></div>    
</body>
</html>
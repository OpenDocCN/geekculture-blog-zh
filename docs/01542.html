<html>
<head>
<title>Create Scalable Business Workflows Using AWS Step Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS步骤功能创建可扩展的业务工作流</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-scalable-business-workflows-using-aws-step-functions-1fde6d6d37ea?source=collection_archive---------16-----------------------#2021-04-14">https://medium.com/geekculture/create-scalable-business-workflows-using-aws-step-functions-1fde6d6d37ea?source=collection_archive---------16-----------------------#2021-04-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="9610" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在这篇博文中，我们将探讨如何使用无服务器框架创建简单的AWS步骤函数。</h2></div><h2 id="516b" class="ix iy hi bd iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">我为什么选择无服务器？</h2><p id="5e20" class="pw-post-body-paragraph jv jw hi jx b jy jz ij ka kb kc im kd ji ke kf kg jm kh ki kj jq kk kl km kn hb bi translated">因为它在一个文件中定义了所有内容:</p><ul class=""><li id="640b" class="ko kp hi jx b jy kq kb kr ji ks jm kt jq ku kn kv kw kx ky bi translated">IAM角色声明</li><li id="f819" class="ko kp hi jx b jy kz kb la ji lb jm lc jq ld kn kv kw kx ky bi translated">Lambda函数处理器</li><li id="85bb" class="ko kp hi jx b jy kz kb la ji lb jm lc jq ld kn kv kw kx ky bi translated">Lambda函数触发器</li><li id="c46d" class="ko kp hi jx b jy kz kb la ji lb jm lc jq ld kn kv kw kx ky bi translated">阶跃函数状态</li><li id="f643" class="ko kp hi jx b jy kz kb la ji lb jm lc jq ld kn kv kw kx ky bi translated">云形成资源</li></ul><p id="2cc2" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated">现在，让我们开始构建阶跃函数。</p><p id="c010" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">步骤1: </strong>使用下面的命令创建node-js模板项目</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="88de" class="ix iy hi lm b fi lq lr l ls lt">sls create - template aws-nodejs - path aws-sg-stepfunctions-demo</span></pre><p id="318b" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">第二步:</strong>导航到<strong class="jx hj">文件夹<em class="lu"> aws-sg-stepfunctions-demo。</em> </strong>文件夹内创建serverless.yml。如果您使用下面的命令在本地调用示例hello函数</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="9e1a" class="ix iy hi lm b fi lq lr l ls lt">sls invoke local -f hello</span></pre><p id="284f" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated">收到以下结果。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="9bb3" class="ix iy hi lm b fi lq lr l ls lt">{<br/>    "statusCode": 200,<br/>    "body": "{\n  \"message\": \"Go Serverless v1.0! Your function executed successfully!\",\n  \"input\": {}\n}"<br/>}</span></pre><p id="7c79" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">步骤3: </strong>通过改变主体内部的消息来重构这个lambda函数。我将再创建两个lambda函数，在所有这些lambda函数中，只有消息组件是不同的。</p><figure class="lh li lj lk fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es lv"><img src="../Images/59ba4a2f297f4c9df33c9f9a3bf525ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZhBOqIZ3HbNerq_eFZNFw.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx">aws lambda nodejs</figcaption></figure><p id="3ea3" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">第四步:</strong>创建<strong class="jx hj"><em class="lu">functions-definition . yml如下。</em> </strong>我们会在serverless.yml中引用这个文件。</p><figure class="lh li lj lk fd lw er es paragraph-image"><div class="er es mh"><img src="../Images/46da9bb2ac1c3433718468139987990a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*hRUiXRNJXHO6sTGU79oyLg.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">functions-definition.yml</figcaption></figure><p id="9227" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">步骤4: </strong>创建<strong class="jx hj">步骤<em class="lu"> functions-definition.yml如下。</em> </strong>我们也会在serverless.yml中引用这个文件。</p><figure class="lh li lj lk fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mi"><img src="../Images/779582d129fe1807e2756644bb13dbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EO1QD79cyFVDS-HDSdOqWw.png"/></div></div></figure><p id="b3ff" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">步骤6: </strong>为步骤功能创建<strong class="jx hj"> </strong> cloudwatch日志组。</p><figure class="lh li lj lk fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mj"><img src="../Images/275ee0ef441d6faa7d0e981d21f073c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qac4P_a1fiZtEOViN7L91Q.png"/></div></div></figure><p id="2af6" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated"><strong class="jx hj">第五步:</strong>使用以下配置创建<strong class="jx hj"> </strong> serverless.yml</p><figure class="lh li lj lk fd lw er es paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="er es mk"><img src="../Images/1fa50509e240c9c9f4381391815b3db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqqtlTqCizaLso4_6oegKg.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx">serverless.yml</figcaption></figure><p id="ebcc" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated">现在所有的配置都准备好了，使用下面的命令部署step函数。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="653d" class="ix iy hi lm b fi lq lr l ls lt">sls deploy</span></pre><p id="3a16" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated">这将在新加坡地区创建一个状态机，如下所示。</p><figure class="lh li lj lk fd lw er es paragraph-image"><div class="er es ml"><img src="../Images/4646d0edb008dcb04208f16323041dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:184/format:webp/1*-noJ0lYza8OxQRJI-0bLJw.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">State Machine</figcaption></figure><p id="93e9" class="pw-post-body-paragraph jv jw hi jx b jy kq ij ka kb kr im kd ji le kf kg jm lf ki kj jq lg kl km kn hb bi translated">来源:<a class="ae mm" href="https://github.com/pradheepap/aws-sg-stepfunctions-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/pradheepap/aws-sg-stepfunctions-demo</a></p></div></div>    
</body>
</html>
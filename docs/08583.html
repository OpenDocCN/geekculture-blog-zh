<html>
<head>
<title>Angular:Passing data in and out of Dynamic Components created using ngComponentOutlet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular:将数据传入和传出使用ngComponentOutlet创建的动态组件</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/angular-passing-data-in-and-out-of-dynamic-components-created-using-ngcomponentoutlet-cb677f018735?source=collection_archive---------3-----------------------#2021-11-07">https://medium.com/geekculture/angular-passing-data-in-and-out-of-dynamic-components-created-using-ngcomponentoutlet-cb677f018735?source=collection_archive---------3-----------------------#2021-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3589" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经写了一个故事，探讨了如何将数据传入和传出使用ComponentFactoryResolver创建的动态组件。以下是链接:</p><div class="jd je ez fb jf jg"><a href="https://ramya-bala221190.medium.com/angular-passing-data-into-and-out-of-dynamic-components-created-using-componentfactoryresolver-64c5d08c61e8" rel="noopener follow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">Angular:将数据传入和传出使用ComponentFactoryResolver创建的动态组件</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">我探讨了两种创建动态组件的方法:ComponentFactoryResolver和ngComponentOutlet，以及如何…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">ramya-bala221190.medium.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><p id="5a70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个故事提供了通过ngComponentOutlet实现的相同示例。</p><p id="cd88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先创建两个选项卡，它们实际上是两个组件:<strong class="ih hj"> Tab1Component和Tab2Component </strong>动态加载到父组件<strong class="ih hj"> TabContainerComponent </strong>中</p><p id="cc94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> TabContainerComponent模板:</strong></p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="eab8" class="kf kg hi kb b fi kh ki l kj kk">&lt;ul class=”nav”&gt;<br/>&lt;li <strong class="kb hj">*ngFor=”let x of tabs;let ind=index”</strong> class=”nav-item”&gt;<br/>&lt;a <strong class="kb hj">[ngClass]="x.isActive ? 'activeTab' : ''"</strong> class=”nav-link” (click)=”<strong class="kb hj">ldTab(x.component, x.data,ind)”</strong>&gt;{{x.tab}}&lt;/a&gt;<br/>&lt;/li&gt;<br/>&lt;/ul&gt;</span><span id="9dd4" class="kf kg hi kb b fi kl ki l kj kk">&lt;ng-container<strong class="kb hj"><br/>[ngComponentOutlet]="activeComponent"[ngComponentOutletInjector]="myInjector"</strong><br/>&gt;&lt;/ng-container&gt;</span><span id="2b18" class="kf kg hi kb b fi kl ki l kj kk">&lt;p&gt;Data received from Tab Component: <strong class="kb hj">{{ receivedData }}</strong>&lt;/p&gt;</span></pre><figure class="jw jx jy jz fd kn er es paragraph-image"><div class="er es km"><img src="../Images/7ff739ea39034561f336ff3f975f0fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/0*fGBJHSH0drxpRsx3.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx">Tab1 is active in TabsContainerComponent</figcaption></figure><figure class="jw jx jy jz fd kn er es paragraph-image"><div class="er es kt"><img src="../Images/9be8bb41e1f3ce282cf280c479357358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L8Cw_8jIwoEyFo6v.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx">Tab2 is active in TabsContainerComponent</figcaption></figure><p id="d1fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在迭代一个变量<strong class="ih hj"> tabs，</strong>，它是一个包含每个选项卡的数据、组件细节和活动状态的2个对象的数组。</p><p id="a5b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击一个特定的选项卡，我们调用一个方法<strong class="ih hj"> ldTab() </strong>，传递组件名、选项卡数据和选项卡索引作为参数。</p><p id="85bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><ng-container>已经接受了2个属性:<strong class="ih hj">ngcomponentfoutlet</strong>和<strong class="ih hj">ngComponentOutletInjector</strong>。</ng-container></p><p id="397c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> activeComponent </strong>变量包含需要动态创建的组件名称。此变量作为值传递给ngComponentOutlet属性。</p><p id="d7a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> myInjector </strong>是一个定制的注入器，用于向动态组件传递数据。此注入器作为值传递给ngComponentOutletInjector属性。</p><p id="25bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将很快看到如何创建注入器，将它传递给这个属性，以及它如何将数据传递给动态组件。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="36b8" class="kf kg hi kb b fi kh ki l kj kk"><strong class="kb hj">export const token = new InjectionToken&lt;string&gt;(‘’);</strong></span><span id="c869" class="kf kg hi kb b fi kl ki l kj kk">@Component({<br/>selector: ‘app-tabs-container’,<br/>templateUrl: ‘./tabs-container.component.html’,<br/>styleUrls: [‘./tabs-container.component.css’],<br/>})</span><span id="77a3" class="kf kg hi kb b fi kl ki l kj kk">export class <strong class="kb hj">TabsContainerComponent </strong>implements OnInit {<br/>constructor(<strong class="kb hj">private serv: DynamicService, private injector: Injector</strong>) {}</span><span id="cfc7" class="kf kg hi kb b fi kl ki l kj kk">public <strong class="kb hj">tabs</strong>: any = [{<br/>tab: ‘Tab1’,<br/>component: <strong class="kb hj">Tab1Component</strong>,<br/>data: ‘This is the first Tab’,<br/>isActive:true<br/>},<br/>{<br/>tab: ‘Tab2’,<br/>component: <strong class="kb hj">Tab2Component</strong>,<br/>data: ‘This is the second tab’,<br/>isActive:false<br/>},<br/>];</span><span id="2bde" class="kf kg hi kb b fi kl ki l kj kk">public <strong class="kb hj">activeComponent</strong>: any;<br/>public <strong class="kb hj">activeComponentData</strong>: string = ‘’;<br/>public <strong class="kb hj">receivedData</strong>: string;<br/>public <strong class="kb hj">myInjector</strong>: Injector;</span><span id="2907" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">ngOnInit() {</strong><br/>this.serv.getObservable().subscribe((data) =&gt; {<br/>this.receivedData = data;<br/>});</span><span id="1a67" class="kf kg hi kb b fi kl ki l kj kk">this.ldTab(this.tabs[0].component, this.tabs[0].data,0);<br/>}</span><span id="4c9d" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">setActiveTab(tabInd: number) {</strong><br/>this.tabs.forEach((tab, tabIndex) =&gt; {<br/>tab.isActive = tabIndex === tabInd;<br/>});<br/>}</span><span id="f339" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">ldTab(tabComponent: any, tabData: string,tabIndex:number) {<br/></strong>setTimeout(() =&gt; {</span><span id="462c" class="kf kg hi kb b fi kl ki l kj kk">this.<strong class="kb hj">setActiveTab(tabIndex)</strong>;<br/>this.receivedData = ‘’;<br/>this.activeComponent = tabComponent;<br/>this.activeComponentData = tabData;<br/><strong class="kb hj">this.createInjector();</strong></span><span id="909a" class="kf kg hi kb b fi kl ki l kj kk">}, 0);<br/>}</span><span id="483a" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">createInjector() {<br/></strong>this.myInjector = Injector.<strong class="kb hj">create</strong>({<br/>providers: [{ provide: token, useValue: this.activeComponentData }],<br/>parent: this.injector,<br/>});<br/>}</span><span id="dba9" class="kf kg hi kb b fi kl ki l kj kk">}</span></pre><p id="3644" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个类中，我们定义了数组<strong class="ih hj"> tabs </strong>，这是一个由2个对象组成的数组。每个对象包含4个属性:<strong class="ih hj">选项卡、组件、数据和isActive。</strong></p><p id="acad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选项卡包含要在模板中显示的选项卡名称；组件包含该页签对应的组件名称，即<strong class="ih hj">页签1组件和页签2组件</strong>；数据包含一个小字符串，它将作为输入传递给组件；isActive告诉我们该选项卡当前是否被选中。</p><p id="6b4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> activeComponent </strong>是当前活动的动态组件。例如:如果我点击Tab1，那么Tab1Component就是活动组件。</p><p id="cad1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> activeComponentData </strong>是与动态组件相关联的数据，我们将把它从TabsContainerComponent传递给动态组件。该数据存在于<strong class="ih hj">选项卡</strong>数组中每个对象的数据属性中。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="8a7c" class="kf kg hi kb b fi kh ki l kj kk"><strong class="kb hj">ngOnInit() {</strong><br/>this.serv.getObservable().subscribe((data) =&gt; {<br/><strong class="kb hj">this.receivedData = data;</strong><br/>});</span><span id="bfc2" class="kf kg hi kb b fi kl ki l kj kk">this.ldTab(this.tabs[0].component, this.tabs[0].data,0);<br/>}</span></pre><p id="171c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj"> ngOnInit() </strong>生命周期钩子中，我们在<strong class="ih hj">动态服务</strong>中订阅了一个名为<strong class="ih hj">输出</strong>的主题。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="d3db" class="kf kg hi kb b fi kh ki l kj kk">@Injectable()<br/>export class <strong class="kb hj">DynamicService </strong>{<br/><strong class="kb hj">private output = new Subject&lt;string&gt;();</strong><br/>constructor() {}</span><span id="cc00" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">getObservable() {</strong><br/>return this.output.asObservable();<br/>}</span><span id="c95f" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">outputFromDynamicComponent(data: string) {</strong><br/>this.output.next(data);<br/>}<br/>}</span></pre><p id="a878" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主题的目的是帮助父TabsContainerComponent从动态组件接收数据。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="105d" class="kf kg hi kb b fi kh ki l kj kk">&lt;p&gt;Data received from Tab Component: <strong class="kb hj">{{ receivedData }}</strong>&lt;/p&gt;</span></pre><p id="e940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> receivedData </strong>包含从动态组件发送到TabContainerComponent的数据。我们在TabContainerComponent中显示上面的<strong class="ih hj">接收数据</strong>。</p><figure class="jw jx jy jz fd kn er es paragraph-image"><div class="er es ku"><img src="../Images/602bc185dffa2f749cf7acfca410d77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/0*grmj9mu9JtZ_CNCc.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx">TabsContainerComponent receives data from Tab1</figcaption></figure><figure class="jw jx jy jz fd kn er es paragraph-image"><div class="er es kv"><img src="../Images/841d69f18a976a998794d99a8d8a440b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/0*fTv6AncXfTv1wpM2.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx">TabsContainerComponent receives data from Tab2</figcaption></figure><p id="0838" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在应用程序加载时，我们希望创建Tab1Component并显示其数据。因此，在同一个生命周期钩子中，我们调用了<strong class="ih hj"> ldTab() </strong>方法，将组件、<strong class="ih hj">选项卡数组</strong>的第一个对象的数据属性和选项卡索引作为参数传递。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="9ab5" class="kf kg hi kb b fi kh ki l kj kk">this.ldTab(this.tabs[0].component, this.tabs[0].data,0);</span></pre><p id="d0b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们跳到<strong class="ih hj"> ldTab() </strong>方法。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="c0cd" class="kf kg hi kb b fi kh ki l kj kk"><strong class="kb hj">ldTab(tabComponent: any, tabData: string) {<br/></strong>setTimeout(() =&gt; {</span><span id="6acb" class="kf kg hi kb b fi kl ki l kj kk">this.<strong class="kb hj">setActiveTab(tabIndex);</strong><br/>this.receivedData = ‘’;<br/>this.activeComponent = tabComponent;<br/>this.activeComponentData = tabData;<br/><strong class="kb hj">this.createInjector();</strong></span><span id="2518" class="kf kg hi kb b fi kl ki l kj kk">}, 0);<br/>}</span></pre><p id="4661" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将其余代码包含在setTimeout()中的目的是为了避免ExpressionChangedAfterChecked错误。</p><p id="2bc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先调用<strong class="ih hj"> setActiveTab() </strong>，将选项卡索引作为参数传递，以便设置选项卡的<strong class="ih hj"> isActive </strong>属性值。基于这个属性值，我们使用ngClass添加或删除CSS类<strong class="ih hj"> activeTab </strong>，如下所示。</p><p id="b16f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个CSS类只是添加了一个背景色到活动标签中，以示区别。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="b5cc" class="kf kg hi kb b fi kh ki l kj kk">&lt;li <strong class="kb hj">*ngFor=”let x of tabs;let ind=index”</strong> class=”nav-item”&gt;<br/>&lt;a <strong class="kb hj">[ngClass]="x.isActive ? 'activeTab' : ''"</strong> class=”nav-link” (click)=”<strong class="kb hj">ldTab(x.component, x.data,ind)”</strong>&gt;{{x.tab}}&lt;/a&gt;<br/>&lt;/li&gt;</span></pre><p id="ed99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们接下来将<strong class="ih hj"> receivedData </strong>属性设置为空字符串，这样在切换选项卡时，前一个选项卡的数据将被删除。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="a569" class="kf kg hi kb b fi kh ki l kj kk">this.receivedData = ‘’;</span></pre><p id="76da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> activeComponent </strong>变量设置为组件名，需要动态创建。</p><p id="0ca0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> activeComponentData </strong>变量包含与将被动态创建的组件相关的数据。</p><p id="db5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在调用<strong class="ih hj"> createInjector() </strong>，在这里我们创建了我们的自定义注入器<strong class="ih hj"> myInjector </strong>。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="6bf4" class="kf kg hi kb b fi kh ki l kj kk"><strong class="kb hj">createInjector() {<br/></strong>this.myInjector = Injector.<strong class="kb hj">create</strong>({<br/>providers: [{ provide: token, useValue: this.activeComponentData }],<br/>parent: this.injector,<br/>});<br/>}</span></pre><p id="228c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">创建注射器类的()</strong>，创建注射器实例<strong class="ih hj"> myInjector </strong>。</p><p id="33ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注射器的用途是什么？</p><p id="703a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">依赖基本上是一个类或一个对象，任何类都需要它来执行它的功能。Angular创建内部依赖关系图。</p><p id="d524" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个映射的关键字是<strong class="ih hj">依赖注入(DI)令牌</strong>，这个映射的值是依赖的运行时值。注入器首先使用DI令牌来定位依赖值。然后，注入器实例化依赖项，并将其注入到需要依赖项的类中。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="2c3d" class="kf kg hi kb b fi kh ki l kj kk">providers: [<strong class="kb hj">{ provide: token, useValue: this.activeComponentData }</strong>]</span></pre><p id="cb16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">提供的</strong>属性包含DI令牌。第二个属性基本上告诉注入器如何创建依赖值。这里使用的第二个属性是<strong class="ih hj"> useValue，</strong>，但是根据场景，它也可以是useClass、useExisting等。</p><p id="e208" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想让你注意一下写在@Component注释之前的下面一行代码。</p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="cc59" class="kf kg hi kb b fi kh ki l kj kk"><strong class="kb hj">export const token = new InjectionToken&lt;string&gt;(‘’);</strong></span></pre><p id="bf9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经创建了一个名为<strong class="ih hj">令牌</strong>的<strong class="ih hj"> InjectionToken </strong>对象作为DI令牌。当不需要类依赖时，InjectionToken对于创建DI标记很有用。</p><p id="d5de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，注入器将把<strong class="ih hj">令牌</strong>与变量<strong class="ih hj"> activeComponentData </strong>相关联。该注入器将在动态组件中使用，以访问存储在<strong class="ih hj"> activeComponentData </strong>中的数据。</p><p id="2cc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们检查<strong class="ih hj"> Tab1Component </strong>和<strong class="ih hj"> Tab2Component </strong>，看看我们如何从注射器实例中提取依赖值，以及动态组件如何将数据发送到父TabsContainerComponent。</p><p id="daea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">表1组件模板:</strong></p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="9af9" class="kf kg hi kb b fi kh ki l kj kk">&lt;p&gt;Data received from Parent Component:<strong class="kb hj">{{dataIn}}</strong>&lt;/p&gt;</span><span id="7aa6" class="kf kg hi kb b fi kl ki l kj kk">&lt;button (click)=”<strong class="kb hj">sendData()</strong>”&gt;Send data from Tab1 to Parent&lt;/button&gt;</span></pre><p id="6a3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">表1组件类:</strong></p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="2eda" class="kf kg hi kb b fi kh ki l kj kk">export class <strong class="kb hj">Tab1Component </strong>implements OnInit {</span><span id="e0ee" class="kf kg hi kb b fi kl ki l kj kk">public <strong class="kb hj">dataIn</strong>: string;</span><span id="789e" class="kf kg hi kb b fi kl ki l kj kk">constructor(<strong class="kb hj">private inject: Injector, private serv: DynamicService</strong>) {}</span><span id="f87f" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">ngOnInit() {</strong><br/>this.dataIn = <strong class="kb hj">this.inject.get(token);</strong><br/>}</span><span id="7287" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">sendData() {</strong><br/>this.serv.outputFromDynamicComponent(‘Sent data from Tab1’);<br/>}</span><span id="5856" class="kf kg hi kb b fi kl ki l kj kk">}</span></pre><p id="d4a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据输入</strong>是从TabsContainerComponent接收的数据。我们使用了注入器实例<strong class="ih hj"> inject </strong>来获取基于DI令牌(key)的数据(依赖值)，并作为参数传递给<strong class="ih hj"> get()。</strong></p><p id="ac09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们点击<strong class="ih hj">将数据从Tab1发送到父节点</strong>按钮时，我们调用动态服务中的<strong class="ih hj">outputFromDynamicComponent()</strong>，将数据作为参数传递。该方法将数据传递给名为<strong class="ih hj"> output </strong>的主题。主题在TabsContainerComponent内订阅以接收数据。</p><p id="f5e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Tab2Component只是Tab1Component的翻版，改动很小。</p><p id="ebe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">tab 2组件模板:</strong></p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="5b63" class="kf kg hi kb b fi kh ki l kj kk">&lt;p&gt;Data received from Parent Component:<strong class="kb hj">{{dataIn}}</strong>&lt;/p&gt;</span><span id="0521" class="kf kg hi kb b fi kl ki l kj kk">&lt;button (click)=”<strong class="kb hj">sendData()</strong>”&gt;Send data from Tab2 to Parent&lt;/button&gt;</span></pre><p id="7068" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">tab 2组件类:</strong></p><pre class="jw jx jy jz fd ka kb kc kd aw ke bi"><span id="dd20" class="kf kg hi kb b fi kh ki l kj kk">export class <strong class="kb hj">Tab2Component </strong>implements OnInit {</span><span id="0b10" class="kf kg hi kb b fi kl ki l kj kk">public <strong class="kb hj">dataIn</strong>: string;</span><span id="345d" class="kf kg hi kb b fi kl ki l kj kk">constructor(<strong class="kb hj">private inject: Injector, private serv: DynamicService</strong>) {}</span><span id="3c12" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">ngOnInit() {</strong><br/>this.dataIn = <strong class="kb hj">this.inject.get(token);</strong><br/>}</span><span id="8fd9" class="kf kg hi kb b fi kl ki l kj kk"><strong class="kb hj">sendData() {</strong><br/>this.serv.outputFromDynamicComponent(‘Sent data from Tab2’);<br/>}</span><span id="851b" class="kf kg hi kb b fi kl ki l kj kk">}</span></pre><p id="f613" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以在以下链接中找到工作代码:</p><div class="jd je ez fb jf jg"><a href="https://stackblitz.com/edit/angular-rs5tp8?file=src/app/tab2/tab2.component.ts" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">角形(叉形)堆叠</h2><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">将数据传入和传出使用ngcomponent outlet stackblitz.com创建的动态组件</p></div></div><div class="jp l"><div class="kw l jr js jt jp ju jv jg"/></div></div></a></div></div></div>    
</body>
</html>
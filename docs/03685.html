<html>
<head>
<title>The Complete Angular Performance Guide For 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年完整的角度性能指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/the-complete-angular-performance-guide-for-2021-c5e55225b4d?source=collection_archive---------2-----------------------#2021-06-14">https://medium.com/geekculture/the-complete-angular-performance-guide-for-2021-c5e55225b4d?source=collection_archive---------2-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e6e8" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">对你的慢角度应用程序感到沮丧？以下是如何让你的角度应用速度翻倍甚至三倍的方法。</h2></div></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><p id="18ff" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">需要提高Angular应用的运行速度吗？然后<a class="ae ka" href="https://danielk.tech/user/pages/01.home/complete-angular-performance-guide/Angular%20Performance%20Checklist.pdf" rel="noopener ugc nofollow" target="_blank">点击此处</a>查看并下载完整的角度性能清单。</p><p id="514f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">否则，如果你想深潜…</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kb"><img src="../Images/7a050d45ced9d3208bdddb1fcb934415.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/0*OdGiuQRiIqugOSRN.gif"/></div></figure><p id="6698" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">…深入了解我们如何提高Angular应用性能的所有机制和逻辑，然后继续阅读。</p><blockquote class="kj"><p id="7a5e" class="kk kl hi bd km kn ko kp kq kr ks jz dx translated">我们有太多的内容要讲，你要开始真正的旅程了！</p></blockquote><h1 id="e621" class="kt ku hi bd kv kw kx ky kz la lb lc ld io le ip lf ir lg is lh iu li iv lj lk bi translated">介绍</h1><p id="94a0" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">想象一下，您的angular应用程序的性能增加一倍或三倍。</p><p id="5f0e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果您的Angular应用程序加载速度提高一倍会怎样？</p><p id="eb18" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">或者一旦加载，它的运行速度比现在快很多倍？</p><p id="9e09" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们甚至可以更进一步…</p><p id="95aa" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果您确切地知道去哪里寻找Angular应用程序中的性能瓶颈，您会有什么感觉？</p><p id="cfd2" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">每当你的老板出现告诉你Angular应用程序很慢时，你都知道从哪里开始，以及如何让你的Angular应用程序运行得更快。</p><blockquote class="kj"><p id="8d5b" class="kk kl hi bd km kn ko kp kq kr ks jz dx translated">那不是感觉很神奇吗？</p></blockquote><p id="b4af" class="pw-post-body-paragraph je jf hi jg b jh lq ij jj jk lr im jm jn ls jp jq jr lt jt ju jv lu jx jy jz hb bi translated">所以…</p><p id="9a14" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如何提高角度应用的性能？并解决角度性能问题？</p><p id="1912" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">除了<a class="ae ka" href="https://danielk.tech/consulting/" rel="noopener ugc nofollow" target="_blank">雇佣一个角度顾问来帮助你</a>，这里有一个深入的指导来改善和优化你的角度性能，并确保它加载速度极快。每一个。单身。时间。</p><p id="3e84" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在这份完整的Angular性能指南中，我将向您展示一步一步的过程，让您的Angular应用程序加载更快、运行更快、执行更快，同时让您的团队、您的老板和您的用户对其性能感到欢欣鼓舞。</p><p id="9c46" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我还会给你一份角度性能清单，你可以免费下载，随时使用。这个角度性能清单是为了帮助你像对付一个足球明星一样处理你的角度应用而创建的。</p><p id="8849" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你想下载角度性能清单，那么点击<a class="ae ka" href="https://danielk.tech/user/pages/01.home/complete-angular-performance-guide/Angular%20Performance%20Checklist.pdf" rel="noopener ugc nofollow" target="_blank">这个链接</a>。否则，继续阅读，我会给你一步一步的公式，使你的角度应用程序执行速度比以往任何时候都快。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="er es lv"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure><h1 id="fae0" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">为什么angular apps速度慢？</h1><p id="1532" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">是因为Angular是个蹩脚的项目吗？</p><p id="9163" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">还是因为它被谷歌的Angular团队设计得很差？</p><p id="1506" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我最近调查了一群angular开发人员，问他们对Angular最大的挫折是什么。</p><p id="35c4" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">想猜猜哪个答案得票数最多？</p><p id="8e7c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">棱角表现。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lz"><img src="../Images/5b71f793c3846d9f320f22499ea3bbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*6qSYruW7Ia2S8Dbc.png"/></div></figure><p id="1157" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">许多Angular开发者对Angular感到沮丧，因为他们说它很慢。</p><p id="cd4a" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">有人认为很难构建一个快速的角度应用程序。特别是考虑到它最大的竞争对手React &amp; Vue.js的包大小通常只有它的一半，并且需要一半的时间来解析和运行JavaScript。</p><p id="917a" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么这是不是意味着你的角度应用注定只能像海龟一样工作呢？</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ma"><img src="../Images/113de4b9a534ab882bc4216247c8c279.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/0*IiAXUkq2b-TicNSZ.gif"/></div></figure><p id="52de" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">没有。如果你应用我将在这篇文章中向你展示的东西，按照步骤并投入工作，就不会了。</p><p id="3c21" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">是的，伙计，你必须学会如何让你的Angular应用程序加载得更快，运行得更快，执行得更快。</p><p id="9ffb" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么你从哪里开始呢？</p><h1 id="d97b" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">切割角性能问题</h1><p id="aedf" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">在深入研究您的角度应用程序代码之前，我们需要定义一些东西。</p><p id="2de9" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">首先，您的Angular应用程序可能会遇到两个性能瓶颈。</p><ul class=""><li id="2cd5" class="mb mc hi jg b jh ji jk jl jn md jr me jv mf jz mg mh mi mj bi translated"><strong class="jg hj">角负载性能</strong></li><li id="4435" class="mb mc hi jg b jh mk jk ml jn mm jr mn jv mo jz mg mh mi mj bi translated"><strong class="jg hj">角度运行时性能</strong></li></ul><p id="2d5f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">角度负载性能是指浏览器下载应用程序、将其加载到浏览器中、解析JavaScript并显示给用户所需的时间。</p><p id="e1b2" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">加载后，下一种性能是运行时性能。当用户与你的Angular应用程序交互时，它的速度快吗？还是有时会慢下来？是记忆猪吗？或者它很轻，即使在小型移动设备上运行也更快？</p><p id="ece1" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">您可能已经猜到，最常见的角度性能问题是第一个选项——角度负载性能。</p><p id="ba4e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">但是，没有一个Angular应用程序不受运行时性能的影响。运行时性能通常是由于没有正确地取消订阅RxJS可观察对象，在没有使用trackbyFn的情况下将数千个元素绑定到一个列表，以及改变检测周期过载造成的。</p><p id="d605" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">本角度性能指南分为两个部分——角度负载性能部分和角度运行时间性能部分。</p><p id="ef92" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们将首先深入探讨让您的Angular应用程序加载更快的机制。然后，最后，我们将讨论如何确保它在加载后快速执行。</p><h1 id="ae8b" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">入门:如何测量和分析角度应用的性能</h1><p id="6a81" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">提高Angular应用程序性能的第一步是<strong class="jg hj">测量</strong>在浏览器中加载和引导需要多长时间。</p><p id="bdc2" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为什么？</p><p id="abdb" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">一些开发者知道他们需要优化他们的Angular应用程序，但是他们不知道要优化多少或者从哪里开始。因此，他们对代码或构建配置进行这些疯狂的尝试，然后刷新应用程序，看看它是否比以前加载得更快。这种优化方法只不过是一场小丑表演，应该受到各种各样的批评。这就像在没有必要的量杯的情况下试着烤一个蛋糕。或者在泰坦尼克号沉没前重新摆放甲板上的椅子。</p><p id="bd23" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么更聪明的方法是什么呢？</p><p id="3251" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">测量。测量。测量。</p><p id="2fed" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">不知何故，我们作为开发人员并不总是注意到会打扰用户的额外的一两秒钟。至少这是我的经历。</p><p id="e31e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">例如，我的一个开发伙伴是Django开发人员。他一直坚持说他的Django应用比我的Angular应用快。</p><p id="f75d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">当我们在一起时，他会拿出一个浏览器向我展示它有多快…</p><p id="72fa" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">和他的Django的东西相比，我的角度应用是一只乌龟…</p><p id="6617" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">等等，等等，直到…</p><p id="a678" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们开始使用浏览器的开发工具来计算毫秒数。在对我的Angular应用程序和他的Django应用程序的性能进行分析后，我们发现它们的平均加载时间差不多。</p><p id="884d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">哪个更快？我不记得了。😁</p><p id="dff4" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">显然，我朋友的内部计时器没有正确计数，这证明了为什么开发人员必须仔细分析他的Angular应用程序的性能，并准确知道加载它需要多少毫秒。通过计算加载Angular应用程序所需的毫秒数，您将能够准确地知道在尝试优化时，加载速度和性能提高了多少。是的，数一数毫秒。</p><h1 id="16d6" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">如何让你的Angular app加载更快⚡️</h1><h1 id="51c8" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">1.将您的应用程序拆分成延迟加载的模块。</h1><p id="c31b" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">几年前，当我还是个新手，对angular几乎一无所知的时候，我创建了一个大型的Angular应用程序，并将整个程序打包到一个模块中——<code class="du mp mq mr ms b">app.module.ts</code>文件。</p><p id="ee4c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这是一个让我付出了很多性能问题代价的错误。如果你不熟悉角度模块，那么看看由角度喜剧演员沙伊·雷兹尼克做的这个演讲。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="0b96" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">默认情况下，NgModules会被急切地加载，这意味着您的Angular应用程序会加载单个NgModules，即使它们不是立即需要的。所以，为了让你的Angular应用程序加载得更快，你需要先把这个庞然大物分割成更小的部分。</p><p id="d57c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Angular文档很好地解释了如何设置延迟加载模块。你可以在这里找到所有的例子和最佳实践<a class="ae ka" href="https://angular.io/guide/lazy-loading-ngmodules" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="4432" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">2.确保使用并正确配置预加载策略</h1><p id="f262" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">一旦我们将我们的应用程序分割成延迟加载的模块，我们就需要优化这些模块的加载方式。Angular框架给了我们两个基本的预加载策略。</p><p id="e174" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么应该用哪一个呢？</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mv"><img src="../Images/fcda2608640993a19688224cb3cd65ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*XaAxTS_WgscW2six.gif"/></div></figure><p id="99c2" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">嗯…</p><p id="0483" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这完全取决于谁使用你的角度应用。</p><p id="8245" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你的用户是使用高速光纤连接的员工，那么使用全部预加载策略，立即加载整个Angular应用程序。</p><p id="a9a6" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">但是，如果你的Angular应用程序有移动用户使用慢速3G连接，那么保守的方法会更明智。还有其他预加载策略可供您安装和配置，如果您想了解更多信息，请阅读本文，其中我深入解释了角度预加载策略。</p><h1 id="d84f" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">3.不要过度关注app.module.ts文件</h1><p id="f76e" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">最近，我在审查一个用Angular构建的商业应用程序的代码。我对这个项目了如指掌。或者至少我认为我做到了，因为我是主要的开发者，并且为这个项目写了95%的代码。</p><p id="b7d9" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">打开app.module.ts文件…来个巅峰…我惊呆了！😲</p><p id="eabe" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">它被项目已经超越的导入和库破坏了。</p><p id="9e83" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那我做了什么？我把那些进口的东西拉出来，然后把这个项目修整得干净整洁，就像一只时髦的小狗一样。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mv"><img src="../Images/7d7bb38a48b5135da1b5920dd1f5e1fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*nZpL0UAZz_Mkr_8d.gif"/></div></figure><p id="ebb3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">是的，伙计，如果你的Angular应用包太大，我首先会去app.module.ts。</p><p id="8526" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这是一个快速优化角度应用的好方法。谁知道呢——你可能会吓出一些奇怪的东西。🙈</p><h1 id="8bbd" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">4.使用应用程序外壳</h1><p id="24fc" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">什么是app shell？</p><p id="7c8f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">应用程序外壳是一种快速渲染Angular应用程序一部分的方式。它旨在通过创建一个静态呈现的页面(或一个所有页面通用的框架)发送给客户端，从而提高Angular应用程序的速度。然后，浏览器加载Angular应用程序的其余部分，并在完成后自动切换到该应用程序。</p><p id="3557" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">一个应用程序外壳被设计来显示一个有意义的<a class="ae ka" href="https://web.dev/first-contentful-paint/" rel="noopener ugc nofollow" target="_blank">首画</a>，允许你的应用程序在加载和解析剩下的JavaScript文件之前快速出现。</p><p id="844b" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Angular docs有一个关于应用外壳以及如何使用它们的很好的指南<a class="ae ka" href="https://angular.io/guide/app-shell" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p><h1 id="21ac" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">5.用Brotli。</h1><p id="6a38" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">Brotli是提高任何角度应用加载时间的最快方法。</p><p id="1bec" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果您从未听说过Brotli，这是一种压缩构建文件并将其作为较小文件提供给用户的方法。它最初是由谷歌在2013年开发的，此后获得了很大的吸引力。也许你听说过广为人知的Gzip标准？Brotli是作为Gzip的后继者引入的，最近获得了更多的欢迎。平均而言，用Brotli压缩的JavaScript文件大约小15%，HTML文件小20%，CSS文件小16%。</p><p id="57ef" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">需要明确的是，Angular和Brotli之间并没有什么特殊的关系。你可以用Brotli压缩任何东西。它与其他前端库和框架(如React或Vue.js等)配合得很好。</p><p id="3e7e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">但是由于你我都是有棱角的人，下面介绍如何创建一个定制的构建步骤，用Brotli自动压缩生产文件。</p><p id="f713" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第一步是安装<a class="ae ka" href="https://www.npmjs.com/package/@angular-builders/custom-webpack" rel="noopener ugc nofollow" target="_blank">定制网络包</a>包。安装与您的Angular应用程序版本相匹配的版本是至关重要的，因此请访问软件包页面，获取针对您的特定Angular版本的安装说明。</p><p id="e2fd" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">你需要安装的第二个包是<a class="ae ka" href="https://www.npmjs.com/package/brotli-webpack-plugin" rel="noopener ugc nofollow" target="_blank"> brotli-webpack-plugin </a>。下面是命令。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="60da" class="na ku hi ms b fi nb nc l nd ne">npm i brotli-webpack-plugin --save-dev</span></pre><p id="004c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在我们已经安装了依赖项，我们需要在Angular应用程序的根目录下创建一个<code class="du mp mq mr ms b">webpack.config.json</code>。它看起来会像这样。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nf"><img src="../Images/0e36efb53e8eaba14a71d88f7ae4c0fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*QfVvUQa6zOoDkfb1r516uw.png"/></div></figure><p id="ada3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们最后的更改将是angular.json文件。我们将配置Angular来使用我们的自定义webpack构建器和webpack配置文件。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ng"><img src="../Images/1a4adc91bc8ce312836c078684ea085b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*EwYo29_1G-bHtndFHAe5xw.png"/></div></figure><p id="ca60" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这就是Brotli和Angular的用法。下次创建产品构建时，Angular应用程序的构建文件将自动使用Brotli算法进行压缩，该算法允许您为用户的浏览器提供较小的文件。</p><p id="a41d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你想了解更多，我有一整篇文章解释Brotli和Angular。这里可以找到<a class="ae ka" href="https://danielk.tech/home/how-to-use-brotli-to-make-your-angular-app-perform-faster" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="1411" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">如何让你的Angular app执行得更快</h1><h1 id="7d16" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">1.使用trackBy函数来提高ngFor性能。</h1><p id="60fa" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">Angular框架由一个名为Zone.js的库提供支持，该库在DOM事件发生时触发变化检测。</p><p id="6c79" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Angular还有另一个漂亮的功能，叫做<a class="ae ka" href="https://angular.io/guide/built-in-directives#listing-items-with-ngfor" rel="noopener ugc nofollow" target="_blank"> ngFor </a>。只需交给它一组信息进行渲染，然后看着它呼啸而过…</p><blockquote class="kj"><p id="1e6b" class="kk kl hi bd km kn ko kp kq kr ks jz dx translated">…直到它啪的一声，砰的一声，在你面前爆炸！🤯</p></blockquote><p id="4a51" class="pw-post-body-paragraph je jf hi jg b jh lq ij jj jk lr im jm jn ls jp jq jr lt jt ju jv lu jx jy jz hb bi translated">因为Zone.js在每次DOM事件发生时触发一个新的渲染，这意味着当一个按钮被点击时你的列表被重新渲染，等等…当然你永远看不到它，因为列表的数据没有改变。</p><p id="e84e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你的列表没有增长，这可能没问题。但是小列表往往会变成大列表，大列表会产生性能问题，除非你是一个明智的开发人员。伙计，这就是我想让你成为的——一个精明睿智的Angular开发者，知道如何让你的Angular应用程序运行起来！</p><p id="59e3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么我们如何解决这个问题呢？</p><p id="e349" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们使用trackBy函数。</p><p id="b498" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">简单描述一下Angular trackBy函数，它是一个可选函数，可以与Angular的ngFor一起使用。Angular trackBy用于定义如何跟踪列表中某个项目的更改。不如我们深入研究一些代码。创建我们自己的trackBy函数需要什么？并且避免昂贵的重新渲染操作？</p><p id="431e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">下面是角度跟踪功能的一个基本示例。第一步是将trackBy函数添加到我们的components Typescript文件中，如下所示。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="7526" class="na ku hi ms b fi nb nc l nd ne">trackByItems(index: number, item: Item): number { return item.id; }</span></pre><p id="7151" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然后，我们将修改我们的NGF来使用新的trackBy函数。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="4d90" class="na ku hi ms b fi nb nc l nd ne">&lt;ul&gt;<br/>    &lt;li *ngFor="let item of items; index as i; trackBy: trackByFn"&gt;<br/>        {{ item.value }}<br/>    &lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="24fe" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这就是如何使用trackBy函数让你的列表执行得更快。</p><h1 id="75da" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">2.调整Angular的变化检测设置，以避免不必要的变化检测周期。</h1><p id="d4be" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">正如我已经说过的，Angular使用Zone.js来检测鼠标点击、键盘按压等事件。当Zone.js检测到一个事件时，它会检查数据绑定并更新任何过时的数据绑定，这样向用户显示的数据总是新鲜的、新的和正确的。简而言之，这就是变化检测。这可能是一个很酷的功能，但它有局限性…而且…如果你滥用角度变化检测，它会变得暴躁。</p><p id="0f33" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">那么，我们如何跟踪变更检测性能问题呢？</p><h1 id="2200" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">启用Angular的调试工具</h1><p id="ab2c" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">打开<code class="du mp mq mr ms b">main.ts</code>文件(用于引导您的Angular应用程序)并编辑这些代码行...</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="0aba" class="na ku hi ms b fi nb nc l nd ne">platformBrowserDynamic().bootstrapModule(AppModule) .catch(err =&gt; console.error(err));</span></pre><p id="840f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">…看起来像这样。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="8425" class="na ku hi ms b fi nb nc l nd ne">platformBrowserDynamic().bootstrapModule(AppModule).then(module =&gt; enableDebugTools(module.injector.get(ApplicationRef).components[0])) .catch(err =&gt; console.error(err));</span></pre><h1 id="60f5" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">分析更改检测时间</h1><p id="1691" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">现在我们已经启用了调试工具，我们可以使用它们来发现变更检测需要多长时间。</p><p id="5236" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们将使用<code class="du mp mq mr ms b">ng serve --open</code>运行我们的角度应用程序。</p><p id="e5e7" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">一旦它在您的浏览器中启动，就在开发人员工具中打开控制台，并键入以下命令来测量上一个变更检测周期持续了多长时间。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="1f83" class="na ku hi ms b fi nb nc l nd ne">ng.profiler.timeChangeDetection()</span></pre><p id="9d80" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">对于非常基本的角度应用，变化检测周期预计为0.01–0.05毫秒。尽管意见不一，我还是建议你永远不要让你的变更检测周期超过10ms。</p><h1 id="1a1c" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">那么，如何修复糟糕的变更检测性能呢？</h1><p id="4d50" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">假设我们有一个显示5000个随机数的角度组件。</p><pre class="kc kd ke kf fd mw ms mx my aw mz bi"><span id="d3b3" class="na ku hi ms b fi nb nc l nd ne">import { Component, OnInit } from '@angular/core';<br/><br/>@Component({<br/>  selector: 'app-number-list',<br/>  template: `<br/>    &lt;ul&gt;<br/>        &lt;li *ngFor="let number of numbers"&gt;{{ number }}&lt;/li&gt;<br/>    &lt;/ul&gt;<br/>  `,<br/>  styleUrls: ['./number-list.component.css']<br/>})<br/>export class NumberListComponent implements OnInit {<br/><br/>  numbers: number[] = [];<br/><br/>  constructor() { }<br/><br/>  ngOnInit(): void {<br/>    this.generateNumbers();<br/>  }<br/><br/>  generateNumbers(): void {<br/>    for(let i = 0; i &lt; 5000; i++) {<br/>      let number = Math.random();<br/>      this.numbers.push(number);<br/>    }<br/>  }<br/>}</span></pre><p id="c83c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">你认为它的性能会有多好？</p><p id="6424" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">当我检查变更检测周期时，至少需要12-14毫秒。😯</p><p id="8499" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这是一个性能不佳组件的简单示例。列表是长变化检测周期的罪魁祸首，修复长列表的好方法是使用虚拟滚动策略。棱角分明的材质CDK有一个很棒的<a class="ae ka" href="https://material.angular.io/cdk/scrolling/overview" rel="noopener ugc nofollow" target="_blank">虚拟滚动包</a>值得一探究竟。</p><h1 id="759e" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">3.监控HTTP调用的速度。</h1><p id="a12b" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">也许缓慢的API服务器使你的Angular应用程序变慢了？如果是，你怎么知道？</p><p id="088e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">嗯，您可以使用HTTP拦截器来监控任何缓慢的HTTP调用。一旦创建了HTTP拦截器，就可以用它来监控出站HTTP请求需要多长时间才能完成。</p><p id="a3d6" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">有大量例子的更深入的解释需要它自己的文章，所以如果你想要一个完整的，一步一步的关于如何监控HTTP请求的指南，那么点击<a class="ae ka" href="https://danielk.tech/home/angular-http-logging-how-to-monitor-the-slowness-of-your-angular-app" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="er es lv"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure><h1 id="f4ad" class="kt ku hi bd kv kw kx ky kz la lb lc ld io lw ip lf ir lx is lh iu ly iv lj lk bi translated">结论</h1><p id="c887" class="pw-post-body-paragraph je jf hi jg b jh ll ij jj jk lm im jm jn ln jp jq jr lo jt ju jv lp jx jy jz hb bi translated">我的朋友，这解释了你可以将角度应用的性能提高一倍，甚至三倍或四倍的多种方法。</p><p id="7741" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Angular是一个快速发展的框架——这是我喜欢Angular的原因之一。</p><p id="8508" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">它是由一大群想知道Angular开发者的挫折的人建立的。Angular团队已经为改进Angular应用程序的性能付出了很多汗水，我们可以期待他们会继续这样做。</p><p id="3b51" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">当然，Angular可能有一个性能怪癖，但我仍然喜欢它胜过其他一些库和框架。</p><p id="1468" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="jg hj">如果你喜欢这篇文章或者觉得它有用，请点击👏按钮，关注我，获取更多类似本文的精彩文章。</strong></p><p id="1d7f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><strong class="jg hj">关注我:</strong> <a class="ae ka" href="https://github.com/dkreider" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，<a class="ae ka" href="https://dkreider.medium.com/" rel="noopener">中型</a>，<a class="ae ka" href="https://danielk.tech" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es nh"><img src="../Images/e6b4a013ca0c51d3afe727d2442bd268.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*fM21_CoH0UiYdl9oxIYQFw.png"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="er es lv"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><p id="08e3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated"><em class="ni">最初发布于</em><a class="ae ka" href="https://danielk.tech/home/complete-angular-performance-guide" rel="noopener ugc nofollow" target="_blank"><em class="ni">https://danielk . tech</em></a><em class="ni">。</em></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to upload and preview images in React.JS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中上传和预览图片？射流研究…</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-upload-and-preview-images-in-react-js-4e22a903f3db?source=collection_archive---------0-----------------------#2021-10-30">https://medium.com/geekculture/how-to-upload-and-preview-images-in-react-js-4e22a903f3db?source=collection_archive---------0-----------------------#2021-10-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f9b01d2d73b007f4904ded489da11c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*e-CnQ3XcOSjznpnBhMXQKg.gif"/></div></div></figure><p id="463f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我们将讨论如何允许用户上传图片到你的应用程序中，然后我们如何在你的应用程序中预览这些图片。这个基础也将允许你做更复杂的任务，因为你将可以访问图像，并可以将它们发送到你的后端服务，或在前端操作它们。</p><p id="4970" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">注意:我不会在本教程中重复造型，纯粹是逻辑上的</em></p><h1 id="9c28" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">首先，让我们为我们的用户创建一个上传图像的方式</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/4506b39105144b040ae39c2300f2fc64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8ZAGPiLDNiKv5Maurl8vA.png"/></div></div></figure><h2 id="5fc9" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">上面片段的分解</h2><p id="0a82" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">所以上面的代码看起来应该很熟悉，但是在进入下一步之前，让我们先浏览一下。</p><p id="37d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的渲染函数中，我们需要为用户设置一个<input/>标签进行交互。</p><pre class="ko kp kq kr fd ll lm ln lo aw lp bi"><span id="529a" class="ks jq hi lm b fi lq lr l ls lt">&lt;input type="file" multiple accept="image/*" onChange={onImageChange} /&gt;</span></pre><p id="b5b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们设置一个文件类型的输入，多接受设置为任何图像类型，所以一个用户可以上传多个图像。在上传时，它将运行我们称为onImageChange的处理函数。</p><p id="8864" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们的处理函数<strong class="is hj"> onImageChange </strong>非常简单，我们通过事件对象访问文件，然后将它们存储在我们的状态中。</p><h1 id="98fc" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">现在让我们创建一种方法来将这些图像呈现到我们的应用程序中</h1><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/92a081b1a7f9c265b746429e396ccbc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGMXTkdXX96kloQJf7wmbA.png"/></div></div></figure><h2 id="271b" class="ks jq hi bd jr kt ku kv jv kw kx ky jz jb kz la kd jf lb lc kh jj ld le kl lf bi translated">上面片段的分解</h2><p id="6e4f" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">因此，在上面的代码片段中，我们保留了上一个代码片段中的相同代码，并添加到它上面。你可以把这个逻辑分离成它自己的组件，主要的事情是应该利用<strong class="is hj"> useEffect钩子</strong>来改变<strong class="is hj">图像</strong>。</p><p id="803a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，通过这一点，它应该再次是最熟悉的一个例外。</p><pre class="ko kp kq kr fd ll lm ln lo aw lp bi"><span id="8147" class="ks jq hi lm b fi lq lr l ls lt">URL.createObjectURL(image);</span></pre><p id="3dcd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">URL是Javascript中的一个标准对象，它有一个很棒的方法叫做<strong class="is hj"> createObjectURL </strong>。该方法接收一个图像对象，然后返回该图像的临时本地源的字符串。<em class="jo">请注意，在页面重新加载或重新呈现时，必须重新构建这些字符串</em></p><blockquote class="lv lw lx"><p id="f59d" class="iq ir jo is b it iu iv iw ix iy iz ja ly jc jd je lz jg jh ji ma jk jl jm jn hb bi translated"><a class="ae mb" href="https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">正式文档为URL.createObjectURL() </strong> </a></p></blockquote><p id="1f71" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，现在我们已经清除了这个可怕的方法，剩下的代码就很简单了。</p><p id="dd2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们使用useEffect钩子来查找images数组中的变化，当它检测到变化时，我们首先想看看是否有图像要转换成字符串。</p><pre class="ko kp kq kr fd ll lm ln lo aw lp bi"><span id="1e4c" class="ks jq hi lm b fi lq lr l ls lt">// You can have dynamic bounds, for instance if you have a cap<br/>if (images.length &lt; 1 || images.length &gt; yourCap) return; </span></pre><p id="9f24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，如果你的边界内有图像，我们将开始把它们添加到一个临时数组中，以收集这些URL字符串。</p><pre class="ko kp kq kr fd ll lm ln lo aw lp bi"><span id="afb2" class="ks jq hi lm b fi lq lr l ls lt">images.forEach(image =&gt; newImageURLs.push(URL.createObjectURL(image)));</span></pre><p id="2af3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们只需使用一个简单的地图功能来呈现给用户！</p><pre class="ko kp kq kr fd ll lm ln lo aw lp bi"><span id="f67d" class="ks jq hi lm b fi lq lr l ls lt">{ imageURLs.map(imageSrc =&gt; &lt;img src={imageSrc} /&gt;) }</span></pre><p id="b2df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这真的是它的全部！感谢您的阅读，我希望这能让您在React.JS中使用用户上传的图片有一个好的开始。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Exporting data in excel file in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Node.js中导出excel文件中的数据</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/exporting-data-in-excel-file-in-node-js-f1b298997d47?source=collection_archive---------0-----------------------#2021-11-03">https://medium.com/geekculture/exporting-data-in-excel-file-in-node-js-f1b298997d47?source=collection_archive---------0-----------------------#2021-11-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/deeb1ca52c6b268485e8f7eaf25d2ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0KzMFWkIqVj7Bvz02DOz7A.png"/></div></div></figure><p id="741a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→很多时候，当我们有一些报告或管理面板应用程序时，我们需要下载excel文件中的数据。</p><p id="2b16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→这可以在<strong class="is hj">任何JavaScript框架</strong>中实现。对于本文，我们将使用节点和<strong class="is hj"> express.js. </strong></p><p id="4655" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→同样，我们将使用<a class="ae jo" href="https://www.npmjs.com/package/exceljs" rel="noopener ugc nofollow" target="_blank"> exceljs </a>包。</p><p id="f540" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→我们需要使用以下命令安装基本快速设置</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="9365" class="jy jz hi ju b fi ka kb l kc kd">express &lt;your_app_name&gt; --view=ejs</span></pre><p id="2d7b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→在您最喜欢的代码编辑器中打开应用程序。目录结构将如下所示:</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/bcf4b2779162fbbde8dc93aeed9a0520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYG7T6U-lBv20OwKwEryqQ.png"/></div></div></figure><p id="f127" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→让我们使用下面的命令<strong class="is hj">启动节点服务器</strong></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="23ed" class="jy jz hi ju b fi ka kb l kc kd">npm start</span></pre><p id="bdb0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→在浏览器中打开<strong class="is hj"> localhost:3000 </strong>。默认归属路由打开。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/60c51f81981bdfc90ecc886749ed38af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0CGC6G9Sn4ITsFFtZZTw5Q.png"/></div></div></figure><p id="35d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→一旦项目建立，我们将安装<strong class="is hj"> exceljs </strong>包</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="480f" class="jy jz hi ju b fi ka kb l kc kd">npm install exceljs</span></pre><p id="a421" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→ <strong class="is hj">步骤1: </strong>我们将创建一个<strong class="is hj">路径</strong>，用于下载。打开<strong class="is hj"> route/index.js </strong>文件。</p><p id="e8fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的<strong class="is hj">导出用户</strong>是一个<strong class="is hj">控制器</strong>，我们将在步骤3中创建它</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="6b15" class="jy jz hi ju b fi ka kb l kc kd">router.<strong class="ju hj">get</strong>("/downloadExcel", <strong class="ju hj">exportUser</strong>);</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/2ff40098672250e4d8e2b7b542fd1050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbp3G-3CeISFr8I8Hqv7LA.png"/></div></div></figure><p id="f8df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→ <strong class="is hj">第二步:</strong>我们将<strong class="is hj">创建一个模型</strong>。这个页面将<strong class="is hj">保存我们想要导出的数据</strong>。在实际场景中，我们将连接关系或非关系数据库并获取数据。</p><p id="0c68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→这里，为了简单起见，我们只写了任何数据库的数据输出。</p><p id="4f54" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建<strong class="is hj">模型/User.js </strong></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="8c7b" class="jy jz hi ju b fi ka kb l kc kd"><em class="kg">// GET DATA FROM DATABASE</em></span><span id="0fab" class="jy jz hi ju b fi kh kb l kc kd"><em class="kg">// Sample data</em></span><span id="ae7a" class="jy jz hi ju b fi kh kb l kc kd">const User = [</span><span id="d82a" class="jy jz hi ju b fi kh kb l kc kd">{ <br/> fname: "Amir", <br/> lname: "Mustafa", <br/> email: "amir@gmail.com", <br/> gender: "Male" <br/>},</span><span id="f94f" class="jy jz hi ju b fi kh kb l kc kd">{<br/> fname: "Ashwani",<br/> lname: "Kumar",<br/> email: "ashwani@gmail.com",<br/> gender: "Male",<br/>},</span><span id="e92a" class="jy jz hi ju b fi kh kb l kc kd">{ <br/> fname: "Nupur", <br/> lname: "Shah", <br/> email: "nupur@gmail.com", <br/> gender: "Female" <br/>},</span><span id="44db" class="jy jz hi ju b fi kh kb l kc kd">{<br/> fname: "Himanshu",<br/> lname: "Mewari",<br/> email: "himanshu@gmail.com",<br/> gender: "Male",<br/>},</span><span id="1e79" class="jy jz hi ju b fi kh kb l kc kd">{<br/>fname: "Vankayala",<br/>lname: "Sirisha",<br/>email: "sirisha@gmail.com",<br/>gender: "Female",</span><span id="06a6" class="jy jz hi ju b fi kh kb l kc kd">},</span><span id="3e28" class="jy jz hi ju b fi kh kb l kc kd">];</span><span id="f935" class="jy jz hi ju b fi kh kb l kc kd">module.exports = User;</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/aa663a2fe50f5630e2c3e651a5a0a8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yh4dMCSvmq96UCBvNlWD-g.png"/></div></div></figure><p id="ac10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→ <strong class="is hj">步骤3: </strong>我们将<strong class="is hj">创建一个控制器</strong>，它将链接到我们的路线</p><p id="e5b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建<strong class="is hj">控制器/用户. js </strong></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="5953" class="jy jz hi ju b fi ka kb l kc kd">const User = <strong class="ju hj">require</strong>("../Models/User");</span><span id="28a8" class="jy jz hi ju b fi kh kb l kc kd">const excelJS = <strong class="ju hj">require</strong>("exceljs");</span><span id="bc18" class="jy jz hi ju b fi kh kb l kc kd">const <strong class="ju hj">exportUser</strong> = async (req, res) =&gt; {</span><span id="25d0" class="jy jz hi ju b fi kh kb l kc kd">   // WRITE DOWNLOAD EXCEL LOGIC</span><span id="fb09" class="jy jz hi ju b fi kh kb l kc kd">};</span><span id="5332" class="jy jz hi ju b fi kh kb l kc kd">module.<strong class="ju hj">exports</strong> = <strong class="ju hj">exportUser</strong>;</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/5848c73d6c488120b39726dd4ef73eb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EoR1B8MF2bE9MK50t50ijQ.png"/></div></div></figure><p id="bdbc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在<strong class="is hj">路线</strong>中，我们将<strong class="is hj">导入这个控制器</strong>并配置到我们的路线中</p><p id="e1a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> route/index.js </strong></p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="cba6" class="jy jz hi ju b fi ka kb l kc kd">var <strong class="ju hj">express</strong> = <strong class="ju hj">require</strong>("express");</span><span id="e84a" class="jy jz hi ju b fi kh kb l kc kd">const <strong class="ju hj">exportUser</strong> = <strong class="ju hj">require</strong>("../Controller/User"); // CONTROLLER</span><span id="1947" class="jy jz hi ju b fi kh kb l kc kd">var router = <strong class="ju hj">express</strong>.<strong class="ju hj">Router</strong>();</span><span id="0c0b" class="jy jz hi ju b fi kh kb l kc kd"><br/>router.<strong class="ju hj">get</strong>("/downloadExcel", <strong class="ju hj">exportUser</strong>); // DOWNLOAD ROUTE</span><span id="5164" class="jy jz hi ju b fi kh kb l kc kd">module.exports = router;</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/eafbb879a6df2963b4f453215a7ee4ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9C9w3xdT738iBB42bhyQgg.png"/></div></div></figure><p id="d981" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→步骤5:这里，我们将在用户控制器中编写下载excel 的<strong class="is hj">逻辑:</strong></p><p id="94c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">控制器/用户. js</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="2932" class="jy jz hi ju b fi ka kb l kc kd">const User = <strong class="ju hj">require</strong>("../Models/User"); // This has data to be used<br/>const excelJS = <strong class="ju hj">require</strong>("exceljs");</span><span id="603b" class="jy jz hi ju b fi kh kb l kc kd">const <strong class="ju hj">exportUser</strong> = async (req, res) =&gt; { </span><span id="f12a" class="jy jz hi ju b fi kh kb l kc kd">  const workbook = new excelJS.<strong class="ju hj">Workbook</strong>();  // Create a new workbook</span><span id="a14a" class="jy jz hi ju b fi kh kb l kc kd">  const worksheet = workbook.<strong class="ju hj">addWorksheet</strong>("My Users"); // New Worksheet</span><span id="aec6" class="jy jz hi ju b fi kh kb l kc kd">  const path = "./files";  // Path to download excel</span><span id="a782" class="jy jz hi ju b fi kh kb l kc kd">  // Column for data in excel. key must match data key<br/>  worksheet.columns = [</span><span id="bc9b" class="jy jz hi ju b fi kh kb l kc kd">    { header: "S no.", key: "s_no", width: 10 }, <br/>    { header: "First Name", key: "fname", width: 10 },<br/>    { header: "Last Name", key: "lname", width: 10 },<br/>    { header: "Email Id", key: "email", width: 10 },<br/>    { header: "Gender", key: "gender", width: 10 },</span><span id="adba" class="jy jz hi ju b fi kh kb l kc kd">];</span><span id="2df9" class="jy jz hi ju b fi kh kb l kc kd">// Looping through User data<br/>let counter = 1;</span><span id="bf9f" class="jy jz hi ju b fi kh kb l kc kd">User.<strong class="ju hj">forEach</strong>((user) =&gt; {</span><span id="17e4" class="jy jz hi ju b fi kh kb l kc kd">  user.s_no = counter;</span><span id="3828" class="jy jz hi ju b fi kh kb l kc kd">  worksheet.<strong class="ju hj">addRow</strong>(user); // Add data in worksheet</span><span id="310d" class="jy jz hi ju b fi kh kb l kc kd">  counter++;</span><span id="3bf6" class="jy jz hi ju b fi kh kb l kc kd">});</span><span id="7132" class="jy jz hi ju b fi kh kb l kc kd">// Making first line in excel bold<br/>worksheet.<strong class="ju hj">getRow</strong>(1).<strong class="ju hj">eachCell</strong>((cell) =&gt; {</span><span id="537e" class="jy jz hi ju b fi kh kb l kc kd">  cell.font = { bold: true };</span><span id="5581" class="jy jz hi ju b fi kh kb l kc kd">});</span><span id="0b27" class="jy jz hi ju b fi kh kb l kc kd">try {</span><span id="bb4e" class="jy jz hi ju b fi kh kb l kc kd">  const data = await workbook.xlsx.<strong class="ju hj">writeFile</strong>(`${path}/users.xlsx`)</span><span id="9727" class="jy jz hi ju b fi kh kb l kc kd">   .then(() =&gt; {</span><span id="50d6" class="jy jz hi ju b fi kh kb l kc kd">     res.<strong class="ju hj">send</strong>({</span><span id="9c16" class="jy jz hi ju b fi kh kb l kc kd">       status: "success",</span><span id="8da2" class="jy jz hi ju b fi kh kb l kc kd">       message: "file successfully downloaded",</span><span id="f664" class="jy jz hi ju b fi kh kb l kc kd">       path: `${path}/users.xlsx`,</span><span id="88a2" class="jy jz hi ju b fi kh kb l kc kd">      });<br/>   });</span><span id="e70c" class="jy jz hi ju b fi kh kb l kc kd">} catch (err) {</span><span id="eb2c" class="jy jz hi ju b fi kh kb l kc kd">    res.<strong class="ju hj">send</strong>({</span><span id="361c" class="jy jz hi ju b fi kh kb l kc kd">    status: "error",</span><span id="9253" class="jy jz hi ju b fi kh kb l kc kd">    message: "Something went wrong",</span><span id="4ebd" class="jy jz hi ju b fi kh kb l kc kd">  });</span><span id="e648" class="jy jz hi ju b fi kh kb l kc kd">  }</span><span id="2179" class="jy jz hi ju b fi kh kb l kc kd">};</span><span id="baae" class="jy jz hi ju b fi kh kb l kc kd">module.<strong class="ju hj">exports</strong> = <strong class="ju hj">exportUser</strong>;</span></pre><p id="362f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→这里我们<strong class="is hj">创建一个工作簿。</strong>在工作簿内部，我们创建一个<strong class="is hj">工作表</strong>。</p><p id="9bf5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→每张工作表包含不同的数据集。对于本文，我们只有一个文件可以下载，即用户工作表</p><p id="7485" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→下一步，我们<strong class="is hj">定义要打印的列</strong>。每个条目的键应该与用户模型中的用户数据相匹配。</p><p id="977e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→我们使用以下命令下载。这将以xlsx格式下载。exceljs还提供了CSV格式的下载工具</p><pre class="jp jq jr js fd jt ju jv jw aw jx bi"><span id="e5fd" class="jy jz hi ju b fi ka kb l kc kd">await workbook.xlsx.<strong class="ju hj">writeFile</strong>(`${path}/users.xlsx`)</span></pre><p id="5230" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→保持节点服务器运行。让我们在浏览器中运行该路线</p><p id="c997" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本地主机:3000/downloadExcel</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/5a01426e9f4a790091163574307c9402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rpb617uyXSMLQueTkPnOfg.png"/></div></div></figure><p id="90ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">→文件现已下载到回复中提到的路径中</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/c1b90c620914f47c333845c765ae40d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qItKxvpuH6zt_7zpsDoxjQ.png"/></div></div></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/c447f462c2b08a9e9caba45d7b269dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5rUPKfc1tNw576s0u4LHQ.png"/></div></div></figure><h1 id="5a1d" class="kl jz hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">视频:</h1><p id="548a" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated"><a class="ae jo" href="https://secure.vidyard.com/organizations/1904214/players/Qr56rBG9FMtqB1SrETx2ut?edit=true&amp;npsRecordControl=1" rel="noopener ugc nofollow" target="_blank">https://secure . vid yard . com/organizations/1904 214/players/QR 56 rbg 9 fmt qb1 sretx 2 ut？edit = true&amp;npsRecordControl = 1</a></p><h1 id="f298" class="kl jz hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">存储库:</h1><p id="e186" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">https://github.com/AmirMustafa/export-to-excel<a class="ae jo" href="https://github.com/AmirMustafa/export-to-excel" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="58d9" class="kl jz hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">结束语:</h1><p id="e274" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">我们已经看到了在excel文件中导出数据是多么简单。尝试阅读exceljs文档。在那里，我们可以在excel文件中进行许多格式化和下载选项。</p><blockquote class="ln lo lp"><p id="861a" class="iq ir kg is b it iu iv iw ix iy iz ja lq jc jd je lr jg jh ji ls jk jl jm jn hb bi translated">谢谢你一直坚持到最后🙌。如果你喜欢这篇文章或者学到了新的东西，请点击下面的分享按钮来支持我，让更多的人了解我和/或在<a class="ae jo" href="https://twitter.com/amir__mustafa" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，看看我在那里学到和分享的其他技巧、文章和东西。</p></blockquote><div class="lt lu ez fb lv lw"><a href="https://twitter.com/amir__mustafa" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">关注Amir Mustafa的JavaScript、TypeScript和AWS内容。</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">twitter.com</h3></div></div><div class="me l"><div class="mf l mg mh mi me mj io lw"/></div></div></a></div></div></div>    
</body>
</html>
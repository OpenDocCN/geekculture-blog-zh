<html>
<head>
<title>Three overlooked but powerful Python functions to replace the ‘replace’ function for hacking dataframes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三个被忽略但功能强大的Python函数来代替“替换”函数，用于破解数据帧</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/three-overlooked-but-powerful-python-functions-to-replace-the-replace-function-for-hacking-101abf184fef?source=collection_archive---------16-----------------------#2022-01-18">https://medium.com/geekculture/three-overlooked-but-powerful-python-functions-to-replace-the-replace-function-for-hacking-101abf184fef?source=collection_archive---------16-----------------------#2022-01-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/59f8f4f4964ebec01c1d4ce05739154c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gCX4K8FhUGevQg5X.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://www.familyhandyman.com/article/how-to-replace-a-lightbulb/" rel="noopener ugc nofollow" target="_blank">How to Upgrade and Replace Lightbulbs | The Family Handyman</a></figcaption></figure><p id="a339" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你经常使用Python，你可能知道强大的<a class="ae iu" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <em class="jt">熊猫</em> </a>库，这是这种语言数据分析的支柱。此外，您可能还知道一些关键函数，这些函数使处理数据帧变得更加容易，例如:</p><ul class=""><li id="fb01" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated"><em class="jt">形容</em></li><li id="8083" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">为空</em></li><li id="750a" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">合并</em></li><li id="56f7" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">至_日期时间</em></li><li id="1d7e" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">数值计数</em></li><li id="88f9" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt"> str </em></li><li id="bbc7" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt"> dropna </em></li><li id="438e" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">分组依据</em></li><li id="7730" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">排序值</em></li><li id="e966" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">串联</em></li><li id="3292" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">枢轴</em></li><li id="90fa" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">剧情</em></li><li id="983d" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated"><em class="jt">应用</em></li></ul><p id="1b8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个清单还在继续。</p><p id="028a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些绝不是Python中与数据帧相关的函数的详尽列表。还要注意，这些函数中有些是熊猫函数(<a class="ae iu" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> pd.concat </em> </a>，<a class="ae iu" href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank"><em class="jt">PD . to _ datetime</em></a>等。)而剩下的都是dataframe函数(<a class="ae iu" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> df.dropna </em> </a>，<a class="ae iu" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> df.pviot </em> </a>等。).然而，它们都是可用于切片和切割数据帧的函数。</p><p id="78cb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">另一个关键的dataframe函数是<a class="ae iu" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.replace.html" rel="noopener ugc nofollow" target="_blank"> <em class="jt"> df.replace </em> </a>，我们将在本文中详细介绍。对于许多用户来说，作为机器学习工作流程的一部分，该功能已经成为<a class="ae iu" href="https://www.tableau.com/learn/articles/what-is-data-cleaning#:~:text=Data%20cleaning%20is%20the%20process,incomplete%20data%20within%20a%20dataset.&amp;text=If%20data%20is%20incorrect%2C%20outcomes,though%20they%20may%20look%20correct." rel="noopener ugc nofollow" target="_blank">数据清理</a>和<a class="ae iu" href="https://www.omnisci.com/technical-glossary/feature-engineering" rel="noopener ugc nofollow" target="_blank">特征工程</a>的基石。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/5cb2290c16f6cf27eaeb20799c951ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1vo9FFfuYU4jWJTFFDqVQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://www.aihr.com/blog/hr-analytics-data-cleaning-guide/" rel="noopener ugc nofollow" target="_blank">6-Step Guide to Cleaning your HR Analytics Data — AIHR</a></figcaption></figure><p id="9b51" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们举一个例子，你有四个标签为“芬兰”的条目，但有一个条目误标为“文兰”。这就是<em class="jt">替换</em>功能作为快速数据清理解决方案派上用场的地方。语法应该是这样的:</p><p id="e323" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"><em class="jt">df _ world = df _ world . replace('文兰'，'芬兰')</em> </strong></p><p id="0812" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的例子中，dataframe中“Vinland”的每个实例都将被替换为字符串“Finland”。也可以使用以下代码自定义代码，使其在dataframe中只包含一列:</p><p id="16f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> df_world['国家或地区'] = df_world['国家或地区']。替换('文兰'，'芬兰')</em> </strong></p><p id="ad6b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该函数还可以很好地将字符串列表替换为不同的字符串，如下例所示，其中<strong class="ix hj">‘文兰’，‘丹麦’和‘挪威’</strong>都分组到一个名为<strong class="ix hj">‘斯堪的纳维亚’</strong>的类别中。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/15661c8c5102dedae7047105fd756c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/0*yTMMNuZzjXrtDbtH"/></div></figure><p id="a3f7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">说到分组，在特征工程中，经常需要将连续值分组到离散类别中，以使算法更有效地解释该特征。在下面的例子中，所有高于7.5的分数被标记为“0”，其余的被标记为“1”。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ko"><img src="../Images/fd9765fad7864da9a23fc7c4ec903cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/0*lGGh-ct1h2r_ypTn"/></div></figure><p id="a2ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，生成这个解决方案需要两行代码，其中必须创建一个名为“Score 1”的单独变量。当一个条件是双边的时，使用replace函数事情会变得更加复杂。</p><p id="7d33" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是其他三个强大功能发挥作用的地方，它们可以被证明是<em class="jt">替换</em>功能的更好替代。</p><h1 id="dc35" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">np.where()</h1><p id="fd27" class="pw-post-body-paragraph iv iw hi ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">注意，这个函数是<a class="ae iu" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"><em class="jt">Numpy</em></a><em class="jt"/>库的一部分，而不是熊猫库。</p><p id="e70f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt"> np.where </em>函数的最大优点是它允许在单行代码中对一系列值使用<em class="jt"> if-else </em>条件。它对分类变量同样有用，但在这种情况下，它与<em class="jt"> replace </em>函数相比没有明显优势。</p><p id="adbd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面显示了一个示例语法:</p><p id="9842" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"><em class="jt">df _ world[' Score 1 ']= NP . where(df _ world[' Score ']&gt;7.5，1，0) </em> </strong></p><p id="1318" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的示例中，<em class="jt"> df_world['Score'] </em>系列中任何大于7.5的值都被转换为' 1 '，所有其他值都被设置为' 0 '。然而，结果被存储在一个名为“分数1”的新系列中。下面显示了上述样本的结果，使用的数据集与前面显示的相同。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/9eea9508814fc93c059dceae75e36654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/0*zkX9ibdveXzkA-R5"/></div></figure><p id="d5a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如我们所见，代码执行了与第一个示例相同的功能，使用<em class="jt">替换</em>，但是使用的代码行更少。</p><h1 id="5da4" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">df.between()</h1><p id="9544" class="pw-post-body-paragraph iv iw hi ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">该功能是<em class="jt"> np.where </em>的补充功能。</p><p id="1729" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt"> between </em>函数的一个关键优势是，它可以接受两边有界的连续值的范围。换句话说，它可以同时适应大于T39的T38和小于T41的T40，而T42 NP . where T43一次只能接受两个条件中的一个。</p><p id="f149" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">示例语法:</p><p id="9586" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> df_world['分数1'] = np.where(df_world['分数'])。</em>(7.5，7.6)，1，0)之间</strong></p><p id="c9ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的示例实现了上面的代码，它将7.5到7.6之间的所有“分数”值转换为“1”，其余的转换为“0”。是的，它在逻辑和代码方面更复杂一些，但功能更强大。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/7aef4c0a61feee77413a9a7b3f8376c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/0*l1jj9zOCvTOQrbNY"/></div></figure><h1 id="3655" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">df.mask()</h1><p id="98cf" class="pw-post-body-paragraph iv iw hi ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">最后，我们得到了<em class="jt">屏蔽</em>函数，它不如函数之间的<em class="jt">函数强大，但在替换一系列值时，它仍然是<em class="jt">替换</em>函数的一个很好的替代。注意，它不允许一个<em class="jt"> if-else </em>类型的条件，这正是它所缺少的。</em></p><p id="5520" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">语法如下:</p><p id="0b79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt"> df_world['分数1'] = df_world['分数']。mask(df_world['Score'] &lt; 7.5，0) </em> </strong></p><p id="e307" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面显示的是上述代码与<em class="jt">掩码</em>函数的实现，该函数执行与作为<em class="jt"> where </em>函数的一部分显示的代码相似的任务。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/91ee4d4f35de643e7d535ceb3afd564b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/0*7m7LKgSAjWen1ZN0"/></div></figure><p id="fbe5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，必须执行两行单独的代码(和条件)才能获得预期的结果。</p><h1 id="bafc" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h1><p id="0a9d" class="pw-post-body-paragraph iv iw hi ix b iy ln ja jb jc lo je jf jg lp ji jj jk lq jm jn jo lr jq jr js hb bi translated">综上所述，<em class="jt"> replace </em>对于不需要太多条件的小规模替换操作来说是一个很好的功能。然而，与<em class="jt">之间的<em class="jt">与</em>、<em class="jt">屏蔽</em>功能在处理以下情况时提供了更大的灵活性:</em></p><ul class=""><li id="5369" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">长范围的连续值</li><li id="0059" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">多重条件</li></ul><p id="4a17" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里提供了代码(用于示例)和数据集的链接<a class="ae iu" href="https://github.com/saychelsea11/Pandas_Replace_Function_Alternatives" rel="noopener ugc nofollow" target="_blank">。Jupyter笔记本包含上述功能如何工作的其他示例，提供了与<em class="jt">替换</em>功能的比较。</a></p><p id="93c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是这篇简短但甜蜜的文章的结尾。希望这有帮助！请在评论中告诉我，这些功能中哪些是你经常使用的，以及你处理过的最复杂的“替换”任务是什么。此外，请随意分享你经常使用的其他被低估的熊猫功能。干杯！</p></div><div class="ab cl lv lw gp lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="hb hc hd he hf"><p id="c15b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="jt">原载于2022年1月18日http://thecraftofdata.com</em><a class="ae iu" href="http://thecraftofdata.com/2022/01/three-overlooked-but-powerful-python-functions-to-replace-the-replace-function-for-hacking-dataframes" rel="noopener ugc nofollow" target="_blank"><em class="jt"/></a><em class="jt">。</em></p></div></div>    
</body>
</html>
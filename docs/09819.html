<html>
<head>
<title>The Three Little Pigs in Go Language</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">围棋语言中的三只小猪</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/the-three-little-pigs-in-go-language-eb83ab469d6f?source=collection_archive---------4-----------------------#2021-12-30">https://medium.com/geekculture/the-three-little-pigs-in-go-language-eb83ab469d6f?source=collection_archive---------4-----------------------#2021-12-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="af0a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Golang适合绝对初学者</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/27b0a6570775702ec9f3a7f48f2be363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JkGqg1eyqUPYUfu3KZquw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image by <a class="ae jn" href="https://pixabay.com/users/myrtillemymy-13928113/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6703047" rel="noopener ugc nofollow" target="_blank">Myrtillemymy</a> from <a class="ae jn" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6703047" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="c83b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你还记得三只小猪用各种材料建造住所，却遭到大灰狼攻击的寓言吗？如果你不熟悉这个故事，剧透警告:当狼被第三只小猪活活煮熟时，他得到了他应得的甜点(这只小猪用煮熟的身体做了什么，留给人们去猜测。事实上，据说猪是杂食动物。我只是把它放在那里)。</p><p id="11b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇文章中，我想用Go语言(水平——绝对初学者)重新告诉你<a class="ae jn" href="https://www.hellokids.com/c_14958/reading-learning/stories-for-children/animal-stories-for-kids/the-three-little-pigs?pos=0#top_page" rel="noopener ugc nofollow" target="_blank">这个</a>寓言。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="9db3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">都是针对绝对初学者的，那就从头开始吧。</p><h1 id="3d64" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated"><strong class="ak">变量声明</strong></h1><p id="0cde" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">关于围棋，你应该知道的第一件事:</p><blockquote class="lo lp lq"><p id="3fb2" class="jo jp lr jq b jr js ij jt ju jv im jw ls jy jz ka lt kc kd ke lu kg kh ki kj hb bi translated">“Go是一种静态类型的编译编程语言，由Robert Griesemer、Rob Pike和Ken Thompson在谷歌设计”，<a class="ae jn" href="https://en.wikipedia.org/wiki/Go_(programming_language)" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="a430" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">“静态类型化”意味着变量类型应该显式声明。下面是我们如何在Go中声明一个变量并给它赋值:</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="b830" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这段代码中:<code class="du lx ly lz ma b">var</code>键盘代表一个“新变量”。接下来我们可以看到一个变量的名字— <code class="du lx ly lz ma b">prologue</code>，后面是它的类型<code class="du lx ly lz ma b">string</code>。</p><p id="97f4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">另一种简单等效的声明变量的方法是使用冒号等于:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><h1 id="bf16" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated"><strong class="ak">结构和接口</strong></h1><p id="f018" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">接下来你要知道的是，Go不是面向对象的编程语言。它不知道类和对象。Go的数据抽象建立在结构和接口之上。这个故事让我们直接接触到这些概念。</p><blockquote class="mb"><p id="5a89" class="mc md hi bd me mf mg mh mi mj mk kj dx translated">第一只小猪用稻草盖房子，因为这是最简单的事情。</p><p id="7830" class="mc md hi bd me mf mg mh mi mj mk kj dx translated">第二只小猪用树枝盖了他的房子。这比稻草房子稍微坚固一点。</p><p id="48a1" class="mc md hi bd me mf mg mh mi mj mk kj dx translated">第三只小猪用砖建造了他的房子。</p></blockquote><h2 id="7849" class="mm ks hi bd kt mn mo mp kx mq mr ms lb jx mt mu ld kb mv mw lf kf mx my lh mz bi translated">结构</h2><p id="deff" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">让我们把重点放在猪的房子上。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es na"><img src="../Images/20f7447825581d5b5b876130630196f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHWvdoyUoce5GMgqT_pRAw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image by <a class="ae jn" href="https://pixabay.com/users/myrtillemymy-13928113/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6703047" rel="noopener ugc nofollow" target="_blank">Myrtillemymy</a> from <a class="ae jn" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=6703047" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><p id="1288" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">根据Go(而不是OO)方法，有一种特定类型的实例(在我们的例子中是房子)可能具有一些属性(建筑材料)。该实例具有与其连接的函数(新房屋建筑),可以操纵属性。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="399a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">看一看一张<code class="du lx ly lz ma b">type House struct {}</code>。<code class="du lx ly lz ma b">type</code>关键字代表一个可以实例化的定制数据类型。<code class="du lx ly lz ma b">struct</code>表示数据类型是结构。Go中的结构是属性的集合。它们有助于通过将数据分组来形成记录。在我们的例子中，我们有一个House类型的数据结构和string类型的属性Material。</p><p id="0156" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在我们来复习一下<code class="du lx ly lz ma b">func NewHouse(material string) House {}</code>。这是一个函数，用关键字<code class="du lx ly lz ma b">func</code>来表示。一个函数可以接受多少个参数是没有限制的。在这种情况下，<code class="du lx ly lz ma b">NewHouse</code>函数接受一个字符串参数。该函数可以是void或返回一个或多个<strong class="jq hj">类型。我们的函数只返回一种类型，House，但是它也可以返回几种类型，比如说House和它的描述:</strong></p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="8a8a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">多个返回类型由逗号分隔，并在括号中列出。它们以同样的顺序返回，也用逗号隔开。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="f553" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">毫无疑问，您已经注意到，在上面的例子中，所有的结构名、它们的属性和它们的函数都是以大写字母<strong class="jq hj">开始的。这是因为Go中函数的可访问性是用大写字母表示的。我是认真的。<code class="du lx ly lz ma b">NewHouse()</code>对<strong class="jq hj">公共</strong>开放，而<code class="du lx ly lz ma b">newHouse()</code>是<strong class="jq hj">私有</strong>。请记住，在Go中，隐私是在<strong class="jq hj">包级别</strong>定义的(记住，没有类？).</strong></p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><h2 id="1853" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">接口</h2><p id="3b50" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">所有人都盯着猪。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ng"><img src="../Images/b471a8f61acd729255eb4dc9af3bb88b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*YXB_WKojliA8ddOLbzvqCg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Pigs functions</figcaption></figure><p id="7b9e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">三只小猪都做着同样的事情:他们盖房子(如此普通的养猪事业)。他们之间唯一的区别是他们使用的材料类型。它有一股强烈的复制气味。幸运的是，和许多其他编程语言一样，Go鼓励重用。</p><p id="a18d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">欢迎来到界面的世界！如果你以前使用过面向对象编程，你肯定会傻笑着说，“去过那里，做过那个！”你也许应该抛弃你所知道的关于接口的一切。Go的界面与其他语言的界面有很大不同。</p><p id="f360" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该接口是一个自定义类型，它指定了函数签名的集合。通过实现这些方法，其他类型可以成为此接口的成员。界面会员作为精英俱乐部的成员，可以访问代表其定义的所有功能。不要困惑。这比看起来容易。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="a735" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下面是一个带有<code class="du lx ly lz ma b">GetMaterial() string</code>签名的<code class="du lx ly lz ma b">LittlePig</code>接口。<code class="du lx ly lz ma b">BuildHouse()</code>是这个接口的一个通用函数，它接收接口(实际上是它的成员)并执行一些构建逻辑。</p><p id="71cf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，如果第一只小猪想加入小猪俱乐部(相信我，他想)，他应该实现<code class="du lx ly lz ma b">GetMaterial()</code>方法。我们到了。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="362d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">考虑一下<code class="du lx ly lz ma b">(pig FirstLittlePig) GetMaterial() string {}</code>函数。你已经注意到了一种新的语法。我们有一个<code class="du lx ly lz ma b">FirstLittlePig</code>类型，它被称为<strong class="jq hj">接收器</strong>，就在函数名之前。接收方的目的是表明<code class="du lx ly lz ma b">GetMaterial()</code>函数现在可用于类型<code class="du lx ly lz ma b">FirstLittlePig</code> (Oink！).</p><p id="79ad" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们把其他的猪也加入小猪俱乐部吧。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="99f0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，每只精英小猪都可以调用这个叫做<code class="du lx ly lz ma b">BuildHouse()</code>的可重用函数。万岁！让我们运行程序，看看我们有什么。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="69fe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lx ly lz ma b">main()</code>功能是应用的起点。要运行它，您可以简单地点击您的想法中的运行图标，或者您可以通过CLI从相关包中使用命令<code class="du lx ly lz ma b">go run main.go</code>来执行它。瞧，这就是你的输出:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="52b5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">为了打印应用程序的输出，我使用了名为“fmt”的Go源包(“format”的简称)。你可以在这里阅读更多关于这个包的功能<a class="ae jn" href="https://pkg.go.dev/fmt" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="bd39" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">顺便说一下，在Go语言中使用缩写是一种惯例。我的意思是，你可以很容易地找到带有参数<code class="du lx ly lz ma b">s string</code>的函数的例子。在我看来，这与干净代码的概念背道而驰。所以，在我的例子中，我使用了完整的变量名。我的准则，我的规则😎。</p><p id="f4be" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">既然我已经提到了干净的代码，让我们偷偷把打印内容放在<code class="du lx ly lz ma b">BuildHouse()</code>函数中。很好的机会来看看Go中的开关。</p><h1 id="97f6" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">开关</h1><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="7278" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我想，我没有什么可说的了，Go中的开关和其他语言中的开关非常相似。</p><p id="1d81" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我想提醒您注意以小写字母<strong class="jq hj">开始的<code class="du lx ly lz ma b">printOutPigPerformance()</code>函数名。也就是说，这是一条<strong class="jq hj">私信</strong>。</strong></p><h1 id="eb84" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated"><strong class="ak">切片，用于循环和映射</strong></h1><h2 id="2ce7" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">部分</h2><p id="2675" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">是时候谈谈数组了。Go定义了两种处理记录列表的基本数据结构:数组和切片。Array表示一个固定长度的列表，而slice是一个可以增长或收缩的数组的别称。</p><p id="dd54" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们的猪是切片的完美候选。哦，我的天，听起来太可怕了。但是，你知道，坏大灰狼可以对猪阵的大小产生影响。没关系，我会这样重新组织它:让我们列一个清单🐷🐷🐷。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="8049" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">方括号</strong>用于声明Go中的切片，以及将出现在该切片中的数据类型。因此，在这个例子中，我们有一个类型为<code class="du lx ly lz ma b">LittlePig</code>的切片。我们可以在声明状态下将猪添加到切片中，方法是用花括号将它们括起来。或者将它们附加到现有切片，如下所示:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><h2 id="6975" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">对于循环</h2><p id="abb9" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">当我们有一个切片时，我们可以迭代它的元素。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="dac9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">For循环接收两个元素:数组中元素的索引和元素本身。关键字<code class="du lx ly lz ma b">range</code>表示这一片小猪会循环播放。</p><p id="b818" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们的例子中，每只小猪应该建一座房子，对吗？我们也可以把这些住宅映射到猪身上。是啊，我们来绘制地图。</p><h2 id="682e" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">地图</h2><p id="a09b" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Map是<strong class="jq hj">键值对</strong>的集合。在Go中声明地图的方法不止一种。</p><p id="075c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">第一种方式:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="6582" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，与其他语言不同，我们在<strong class="jq hj">中添加的每个键值对(包括最后一个)都应该以逗号</strong>结尾。</p><p id="93e3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">另外两种创建映射的方法与空映射声明有关，我将改变键和值的类型来匹配我们的fabel的过程。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="4a1e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">后期增值完全赞赏。这正是我们要做的。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="a467" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于小猪切片中的每一只小猪，我们将建造房子并将其添加到地图中。语法是:<code class="du lx ly lz ma b">map[key] = value</code>。</p><p id="e309" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意,<strong class="jq hj">下划线</strong>代替了索引变量。Go绑定使用声明的变量。如果变量已声明但未被使用，您将面临编译错误。下划线用于跳过实例化变量。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="f402" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">到目前为止一切顺利。上述解决方案的唯一问题是一次只能建造一个猪舍。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/e983b27e7450ad8f069325e56d7c5189.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*ixMhIxen_ODs31yYAE7_ig.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Execution Schema</figcaption></figure><p id="4da8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我的意思是，第二只猪只有在第一只完成后才能开始建造他的房子。第三头猪甚至还没开始造就可以吃了。这可能会极大地影响故事的结局🐺🍖。太糟糕了。我们最好让所有的猪协同工作。为此，Go语言提供了一个称为Goroutines的特殊特性。</p><h1 id="f9bc" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">戈鲁廷斯</h1><p id="3728" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Goroutine是同时运行的任何独立活动的通用术语。</p><p id="2a41" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我想让你明白的第一件事是，当我们启动一个Go程序时，我们会自动创建一个Goroutine，也称为Main Goroutine。这个Goroutine获取我们程序中的每一行代码，并逐个执行。</p><p id="3abb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以通过简单地在函数调用前添加关键字<code class="du lx ly lz ma b">go</code>来创建并发的Goroutines。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="3a2d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请记住,<strong class="jq hj">并发并不等同于并行</strong>。并行性是(潜在相关的)计算的同时执行。而并发是独立执行的进程的组合。即使您创建了几个Goroutines，一次也只能执行一个，因为它们都使用相同的CPU内核。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ni"><img src="../Images/d2b91947787ac0dde9e9dc447f7dd3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*nIqnhm16VgpIygfVrnWYqw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Goroutines use one CPU core</figcaption></figure><p id="f565" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在上图中，你可以看到CPU内核和Goroutines之间的Go调度程序层。这个调度器的工作是跟踪每个Goroutine中执行的代码。当调度程序检测到其中一个例程已经运行完其中的所有代码时，或者如果例程中的某个函数进行了阻塞调用(如sleep)，则当前例程暂停，下一个go例程开始。这是默认的Go行为。</p><p id="9ea7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当然，这些默认值可以被覆盖。本地机器上多个CPU核心的存在改变了游戏规则。例如，Goroutines可以并行运行。但是，这是一个更高级的话题，我打算跳过。干杯。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="006e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">回到我们的猪身上。小猪的性能负责一个叫做通道的Go结构。</p><h2 id="b910" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">频道</h2><p id="62d0" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">管理不同操作程序之间通信的唯一方法是使用通道。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="526d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们调整我们的<code class="du lx ly lz ma b">BuildHouse()</code>代码来更好地理解通道。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="8d60" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请先移除返回类型。你不再需要它了。因为此函数被设计为作为子Goroutine运行，所以它的值必须以不同的方式传输(通过特定的通道dah)。</p><p id="f1e2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，添加这个特定的通道作为函数参数。语法:<code class="du lx ly lz ma b">{channel name} chan {value type}</code>。与Go的函数不同，Channel只能传递一个<strong class="jq hj">单值类型</strong>。如果您希望与房屋及其创建者(Pig)进行通信，您可以使用列出的属性创建自定义类型。</p><p id="31d9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">建造一个家需要时间。我猜对小猪来说更是如此。无论如何，我建议包括一个睡眠经纪人。假设在猪的一生中，5秒钟等于5天。</p><p id="b6f6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后一步是应用函数结果到通道，使用<code class="du lx ly lz ma b">channel &lt;- result</code>语法。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="3a2a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lx ly lz ma b">main()</code>功能也需要少量更改:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="0705" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lx ly lz ma b">main()</code>函数的代码运行在主Goroutine上。我们希望这个主Goroutine知道子go routine的进度。所以，首先要声明渠道:<code class="du lx ly lz ma b">make(chan {value type})</code>。接下来，这个通道将被传递给函数:<code class="du lx ly lz ma b">go BuildHouse(pig, channel)</code>。</p><p id="3fb9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您可以注意到代码片段中有两个循环。第一个循环遍历小猪切片，并为每个切片启动一个单独的Goroutine。第二个循环将频道结果反映在地图上。</p><p id="e6fa" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里需要理解的最重要的一点是，我们正在使用通道为主Goroutine 创建一个<strong class="jq hj">拦截器。通过添加这个<code class="du lx ly lz ma b">channelResult := &lt;-channel</code>行，我们实际上是在说:停止运行，直到通道返回结果。你能看见它吗？</strong></p><p id="4f45" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，因为我们为每只小猪创建了Goroutine，所以我们想等待所有小猪完成它们的房子。这就是为什么在循环中检索通道结果。只是澄清一下，<code class="du lx ly lz ma b">&lt;-channel</code>语法从通道接收一个值。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="bb84" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们很好！我们已经涵盖了围棋的大部分基础知识！但是，相信我，我救了🌰最后。</p><h1 id="575e" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">两颗北极指极星</h1><p id="9c6b" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">如果C是你的语言宝库中的一员，你可能对指针很感兴趣。但是，我说的是Java，太痛苦了。</p><p id="0c80" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">总之，在前面的例子中，我为每只小猪创建了一个单独的结构。让我们一般化它。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="cee5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里我们有一个具有属性<code class="du lx ly lz ma b">Name</code>和<code class="du lx ly lz ma b">House</code>的<code class="du lx ly lz ma b">Pig</code>结构。Pig类型的实例可以接收一个<code class="du lx ly lz ma b">UpdateName(newName string)</code>函数。好吗？</p><p id="0774" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们可以创建一个名为Fist Little Pig的猪实例，它有一个用稻草建造的房子。让我们假设一下，这头猪一开始对第一只小猪这个名字没意见，但后来他意识到这个名字不够独特。Fifer被选为新名字。现在，尝试运行代码。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="0c1e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是您将看到的输出。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="8185" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你不应该感到吃惊。正如我前面所说的，这一节是关于指针的👆。这是因为Go是一种按值传递的语言。也就是说，每当我们将值作为接收方或参数传递给函数时，Go都会复制这个值，并将其存储在本地机器内存中的一个空容器中。</p><p id="262f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，当您在<code class="du lx ly lz ma b">UpdateName()</code>函数中更改小猪的名字时，通过运行这段代码，您正在更新第一只小猪的副本，而不是原始结构。</p><p id="5edb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">若要更新原始结构，必须首先定位该结构的内存地址并获取其值。这里有两个您需要的运算符:</p><p id="84e2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lx ly lz ma b">&amp;variable</code> —返回该变量指向的值的内存地址。</p><p id="9c26" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><code class="du lx ly lz ma b">*pointer </code> —返回该内存地址指向的值。</p><p id="c483" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，我们可以稍微修改一下我们的代码。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="e372" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">看一看<code class="du lx ly lz ma b">UpdateName()</code>的修改。您可能会注意到两个变化:第一，接收方键入前的星号，第二，指针前的星号。根据Go的指示，这是一个相当复杂的情况。不，这不是复制。虽然接收者前面的星号仅仅是描述性的<strong class="jq hj">，但是它们表明我们正在处理一个<code class="du lx ly lz ma b">Pig</code>类型的指针。指针前面的星号表示真正的<strong class="jq hj">操作符</strong>，这意味着我们想要改变指针所指向的值。</strong></p><p id="c645" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">简要归结为<code class="du lx ly lz ma b">main()</code>功能的修改。你可以在这里看到一个<code class="du lx ly lz ma b">firstLittlePigPointer</code>变量声明，它保存了原来<code class="du lx ly lz ma b">firstLittlePig</code>的内存位置。最后的变化是函数在新形成的指针上运行。</p><p id="41d9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">再次运行代码。试试看。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="3754" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有用！！！但还是很困惑，对吧？幸运的是，Go语言的创造者很仁慈，为我们提供了指针快捷方式。</p><h2 id="1587" class="mm ks hi bd kt mn nb mp kx mq nc ms lb jx nd mu ld kb ne mw lf kf nf my lh mz bi translated">指针快捷方式</h2><p id="ff4e" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">令我非常高兴的是，Go中的指针传奇可以简化为传递的值类型前的一个星号。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="3739" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">至于我，我可以接受，即使是我下巴颏上的毛🐽。</p></div><div class="ab cl kk kl gp km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="hb hc hd he hf"><p id="9497" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这篇博客文章只包含了“三只小猪”寓言的第一幕，已经翻译成Go。其余的源代码(没有残忍的细节)可以在我的<a class="ae jn" href="https://github.com/genezeiniss/go-three-little-pigs" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。</p></div></div>    
</body>
</html>
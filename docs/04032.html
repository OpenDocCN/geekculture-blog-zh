<html>
<head>
<title>Scope in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的范围</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/scope-in-javascript-559b8ce416c1?source=collection_archive---------19-----------------------#2021-06-20">https://medium.com/geekculture/scope-in-javascript-559b8ce416c1?source=collection_archive---------19-----------------------#2021-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f5bb04e2beb5638c0c3e9bbb989bd569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eoAUZDb0V-X3qGwA"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Arnold Francisca</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2a87" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">什么是范围？</h1><p id="d538" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">作用域是变量(或函数)存在并可访问的代码区域。JavaScript中有几种不同类型的作用域:全局作用域、函数作用域和块作用域。</p><h1 id="b125" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">全球范围</h1><p id="0615" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在函数或块之外声明的变量(花括号{ })被认为具有全局范围，这意味着它们可以在JavaScript程序中的任何地方被访问</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="a007" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><strong class="jv hj">注意</strong>:当在函数外使用<em class="lc"> var </em>关键字定义变量时(因此对其进行全局作用域)，变量被附加到<em class="lc">窗口</em>对象上。用<em class="lc"> let </em>或<em class="lc"> const </em>定义的变量不会附加到<em class="lc">窗口</em>对象上。这是因为<em class="lc">变量</em>被设计成函数或全局作用域。<em class="lc"> let </em>和<em class="lc"> const </em>实际上被创建为块范围</p><p id="f3dc" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><em class="lc">窗口</em>对象代表浏览器的窗口，包含所有全局函数、对象和变量。</p><p id="b35f" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">所以从技术上讲，当你在一个javascript程序的代码块外使用<em class="lc"> let </em>和<em class="lc"> const </em>声明一个变量时，它们只在javascript程序的全局范围内，而不在<em class="lc">窗口</em>对象的全局范围内。</p><h1 id="ab89" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">功能范围</h1><p id="e95e" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在函数中声明的变量被认为是函数范围的一部分。这个范围被称为<em class="lc">功能范围</em>。你有时会看到<em class="lc">功能范围</em>也被称为<em class="lc">局部</em>范围<em class="lc">范围</em>。</p><p id="2714" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">在函数范围内声明的变量可以从函数内部访问，但不能从函数外部访问。</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="0ea0" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><strong class="jv hj">注意:</strong>用<em class="lc"> var </em>关键字声明的变量在函数内部定义时具有函数(也称为局部)作用域。用<em class="lc">声明的变量let </em>和<em class="lc"> const </em>在函数内部声明时，技术上具有块作用域(在花括号内)(即变量的作用域绑定到花括号，而不是函数本身)。因为函数使用花括号来封装函数体，所以函数体的函数作用域和块作用域本质上是一回事。</p><p id="f682" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">下面的例子展示了使用<em class="lc">变量</em>和<em class="lc"> let </em>时函数作用域的不同</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><h1 id="220c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">块范围</h1><p id="6378" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">在ES2016中引入了块范围以及<em class="lc"> let </em>和<em class="lc"> const </em>变量声明关键字。块范围仅适用于用<em class="lc"> let </em>或<em class="lc"> const </em>关键字创建的变量。</p><p id="17de" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">块范围是在一组花括号{ }内定义的范围。花括号定义了代码的“块”，因此被称为“块范围”。</p><p id="a449" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">不能在定义块范围变量的块之外访问该变量。</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="697d" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><strong class="jv hj">注意</strong>:用<em class="lc"> var </em>关键字do <strong class="jv hj"> NOT </strong>声明的变量有阻塞作用域，只有用<em class="lc">声明的变量let </em>或<em class="lc"> const </em>有阻塞作用域。用<em class="lc"> var </em>声明的变量将忽略块范围规则。</p><p id="7585" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">请看下面的例子，用<em class="lc"> var </em>关键字声明的变量不遵循块作用域:</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><h1 id="dfda" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">词汇范围</h1><p id="1602" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">JavaScript是一种词汇作用域语言(与动态作用域语言相反)。您还会看到词法范围被定义为静态范围。那么词法范围是什么意思呢？</p><p id="ed86" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">词法作用域意味着作用域是在定义变量和函数的位置定义的(相对于它们运行的位置)。</p><p id="ed22" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">参见下面关于词法范围如何工作的例子:</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="6c28" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">我们来分解一下上面的代码片段。</p><p id="bc76" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">1.当调用<em class="lc"> logVariable( ) </em>函数时，它会创建一个局部变量x，并将其值设置为50。</p><p id="8ec4" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">2.在下一行中，调用了<em class="lc"> myFunc( ) </em>函数，让我们到定义<em class="lc"> myFunc( ) </em>函数的地方。</p><p id="d389" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">3.<em class="lc"> myFunc( ) </em>在<em class="lc"> x </em>变量上调用<em class="lc"> console.log( ) </em>函数，但是<em class="lc"> x </em>没有在<em class="lc"> myFunc( ) </em>作用域中定义。因此，我们需要上升一个范围到全局范围，以获得值为1的<em class="lc"> x </em>。(参见下面关于作用域链接的部分)。</p><p id="36c6" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">请注意，我们从未访问过<em class="lc"> x = 50 </em>的值，即使它出现在<em class="lc"> logVariable( ) </em>函数中的<em class="lc"> myFunc( ) </em>调用的正上方。同样，这是因为词法范围要求我们去定义函数的地方，而不是运行它们的地方。如果JavaScript是一种动态作用域语言，调用<em class="lc"> logVariable( ) </em>将导致控制台记录值50而不是1。</p><h1 id="f93e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">范围链接</h1><p id="8cff" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">理解JavaScript如何使用作用域链接访问变量是非常有帮助的。理解范围链的概念将有助于您理解如何确定变量/函数的范围。</p><p id="f90d" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">当一个函数或方法需要访问JavaScript中一个没有用当前作用域中的值初始化的变量时，JavaScript将上升一个作用域级别来查找该变量的值。它将继续向上扩展范围，直到找到函数声明。</p><p id="b2aa" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><strong class="jv hj">注意:</strong>注意，作用域链接不会向下<em class="lc">到</em>作用域层次，它只会向上寻找下一个更大作用域中的变量声明</p><p id="ff9d" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated">范围链如何工作的示例:</p><figure class="kr ks kt ku fd ij"><div class="bz dy l di"><div class="kv kw l"/></div></figure><h1 id="6c47" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">参考</h1><p id="128c" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated"><a class="ae iu" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/block" rel="noopener ugc nofollow" target="_blank"> MDN —模块</a></p><p id="b3b1" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#variable_scope" rel="noopener ugc nofollow" target="_blank"> MDN —变量作用域</a></p><p id="9743" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Control_flow_and_error_handling#block_statement" rel="noopener ugc nofollow" target="_blank"> MDN — block语句</a></p><p id="fff3" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://www.w3schools.com/js/js_scope.asp" rel="noopener ugc nofollow" target="_blank"> W3学校JavaScript范围</a></p><p id="0eb3" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://www.w3schools.com/js/js_window.asp" rel="noopener ugc nofollow" target="_blank"> W3 Schools JavaScript窗口—浏览器对象模型</a></p><p id="6685" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://wesbos.com/javascript/03-the-tricky-bits/scope" rel="noopener ugc nofollow" target="_blank"> Wes Bos —范围</a></p><p id="7f27" class="pw-post-body-paragraph jt ju hi jv b jw kx jy jz ka ky kc kd ke kz kg kh ki la kk kl km lb ko kp kq hb bi translated"><a class="ae iu" href="https://blog.bitsrc.io/understanding-scope-and-scope-chain-in-javascript-f6637978cf53" rel="noopener ugc nofollow" target="_blank">理解JavaScript中的作用域和作用域链</a></p></div></div>    
</body>
</html>
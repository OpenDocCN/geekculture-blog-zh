<html>
<head>
<title>Part 15: Highest Cost Orders SQL Question Asked by Amazon</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第15部分:亚马逊提出的最高成本订单SQL问题</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/part-15-highest-cost-orders-sql-question-asked-by-amazon-fd16b68bc9bc?source=collection_archive---------9-----------------------#2022-10-10">https://medium.com/geekculture/part-15-highest-cost-orders-sql-question-asked-by-amazon-fd16b68bc9bc?source=collection_archive---------9-----------------------#2022-10-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="f1e0" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">让我们解决基于产品的公司提出的SQL问题</h1><p id="6c78" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是基于产品的公司在面试中提出的一系列SQL问题中的第15篇文章。对于本文，我使用StrataScratch平台来获取基于产品的公司中被问到的问题。</p><p id="0388" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">StataScratch是一个优秀的平台，适合任何希望开始学习数据科学并提高其SQL和Python技能的人。这个平台不仅提供编码题，还提供与数据科学相关的非编码题，比如统计、概率等等。我强烈建议你在StrataScratch网站上注册一个账户，在文章旁边练习这个问题。我将使用Postgres SQL数据库来解决这个问题。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/44a11b0f334c6a4f666bad1cd8f09828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGHkpxzlnzwfR6yBG1JgWw.jpeg"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Photo by <a class="ae kb" href="https://unsplash.com/@ikukevk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Kevin Ku</a> on <a class="ae kb" href="https://unsplash.com/s/photos/database?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ac2b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">以下是基于产品的公司提出的一系列Postgres SQL问题的链接:</p><p id="7e60" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><a class="ae kb" href="https://agupta97.medium.com/list/postgres-interview-problems-asked-in-productbased-comapnies-c4020531504b" rel="noopener">https://agupta 97 . medium . com/list/postgres-interview-problems-asked-in-product based-comapnies-c 4020531504 b</a>如果你从事数据科学工作或想在数据科学领域开始职业生涯，SQL是最重要的技能之一。<br/>如果你熟悉SQL，你将有更好的机会通过数据科学面试或处理日常任务。本文将集中讨论一个问题以及如何解决它。如果你想提高你的SQL知识和经验，你必须阅读这篇文章。你提出想法和寻找解决方案的方法无疑会有所改进。</p><p id="fce3" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">这是<strong class="jf hj">亚马逊</strong>在一次采访中提出的中级问题。可以在这里查看问题<a class="ae kb" href="https://platform.stratascratch.com/coding/9915-highest-cost-orders?code_type=1" rel="noopener ugc nofollow" target="_blank"> <strong class="jf hj">。</strong> </a>问题名称是<strong class="jf hj">最高成本订单。</strong>以下是问题的详细内容:</p><h1 id="d2a7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated"><strong class="ak">最高成本订单</strong></h1><p id="d370" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">查找2019-02-01到2019-05-01之间日订单总成本最高的客户。如果客户在某一天有多个订单，则按天计算订单成本。输出顾客的名字、商品的总价格和日期。</p><p id="8816" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">为简单起见，您可以假设数据集中的每个名字都是唯一的。</p><blockquote class="kx ky kz"><p id="bda8" class="jd je la jf b jg kc ji jj jk kd jm jn lb ke jq jr lc kf ju jv ld kg jy jz ka hb bi translated"><em class="hi">公司:</em> <strong class="jf hj"> <em class="hi">亚马逊</em> </strong> <em class="hi">，难度:</em> <strong class="jf hj"> <em class="hi">中等</em> </strong> <em class="hi">，面试问题id:</em><strong class="jf hj"><em class="hi">9915</em></strong><em class="hi">，</em> <strong class="jf hj"> <em class="hi"> </em> </strong> <em class="hi">表格:</em> <strong class="jf hj">客户，订单<em class="hi">，</em> </strong></p></blockquote><p id="4aa3" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">表架构:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es le"><img src="../Images/0dace56b1b64b856a8bd8b03fc817699.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*n9gutpvP2Em09CyGQk3N_A.jpeg"/></div></figure><p id="4faa" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">客户表预览:</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lf"><img src="../Images/15d84071dd20e0e6c840afee2fb9e48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*YUzMWPkUxJLS5iTRnUHW2A.jpeg"/></div></figure><p id="7989" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">订单表预览:</strong></p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lg"><img src="../Images/20600b0cee13f65ca354fe3fc0bc9462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*j0S9-IZMwNCgQ_9VpubUgg.jpeg"/></div></figure><p id="4514" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">首先，让我们试着理解这个问题。如问题中所述，我们必须确定2019-02-01至2019-05-01单日订单成本最高的客户。如果客户在一天内不止订购一次，则必须考虑这些订单的总数。</p><p id="404b" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated"><strong class="jf hj">方法:</strong></p><ol class=""><li id="226d" class="lh li hi jf b jg kc jk kd jo lj js lk jw ll ka lm ln lo lp bi translated">首先，我们需要使用联接条件<code class="du lq lr ls lt b">orders,cust_id = customers.id</code>合并customers和orders表，并检索2019年2月1日至2019年5月1日期间的first_name、order_date和totol_order_cost列。</li></ol><pre class="ki kj kk kl fd lu lt lv lw aw lx bi"><span id="1220" class="ly ig hi lt b fi lz ma l mb mc"><strong class="lt hj">SELECT first_name,order_date, total_order_cost<br/>        FROM orders join customers <br/>        on orders.cust_id = customers.id <br/>        where order_date between '2019-02-01' and '2019-05-01';</strong></span></pre><p id="ef10" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">2.如问题中所述，数据集中的first_name是唯一的，我们需要计算一天的订单总数，因此，我们可以对first_name使用group by，对上述查询使用totol_cost_order。然后，我们可以按照total_order_cost的降序排列行，并将输出限制为1条记录，以获得最高成本的订单。</p><pre class="ki kj kk kl fd lu lt lv lw aw lx bi"><span id="af97" class="ly ig hi lt b fi lz ma l mb mc"><strong class="lt hj">SELECT first_name,<br/>        order_date, <br/>        sum(total_order_cost) as total_daily_order<br/>        FROM orders join customers <br/>        on orders.cust_id = customers.id<br/>        where order_date between '2019-02-01' and '2019-05-01' <br/>        group by first_name, order_date <br/>        order by  total_daily_order desc<br/>        limit 1 ;</strong></span></pre><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es md"><img src="../Images/db43b817c8bc1eb9cf5ee92027b6c801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*5Iu57Uqpx7zFpZMPEFwWJg.jpeg"/></div></figure></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><p id="52ee" class="pw-post-body-paragraph jd je hi jf b jg kc ji jj jk kd jm jn jo ke jq jr js kf ju jv jw kg jy jz ka hb bi translated">你花时间阅读我的帖子并回复我，这对我意义重大。竖起大拇指，如果你喜欢，点击“关注”。在媒体上关注我，以便在我发布新内容时接收通知。</p></div></div>    
</body>
</html>
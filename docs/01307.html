<html>
<head>
<title>Grab a Coffee and Let Python Fill Out a Form for You</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">喝杯咖啡，让Python为您填表</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/grab-a-coffee-and-let-python-fill-out-a-form-for-you-79c141702a5e?source=collection_archive---------14-----------------------#2021-04-05">https://medium.com/geekculture/grab-a-coffee-and-let-python-fill-out-a-form-for-you-79c141702a5e?source=collection_archive---------14-----------------------#2021-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2418d78b51b863b11e5d7f462e927a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H2eWGThjl7OQYxvZ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nathan Dumlao</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bdec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有多少次<strong class="ix hj">你让自己陷入了一个彻底又极其无聊的任务</strong>中，从谷歌表单(或excel文件)中提取信息，然后将部分信息插入另一个谷歌表单？</p><p id="95d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这种任务让你的日子<strong class="ix hj">变得无聊</strong>，你上班第一天的兴奋开始<em class="jt">消退……</em><br/>你认为你可以从事<strong class="ix hj">更具挑战性的任务</strong>，或者你可以<strong class="ix hj">发展新技能或学习新东西！</strong></p><p id="7238" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了<strong class="ix hj">摆脱这种无聊的东西</strong>，让一个简单的<code class="du ju jv jw jx b">for loop</code>为你执行工作！！</p><p id="091b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将详细展示如何使用Python语言自动填写一个Google表单(然后在Google表单上打开它)。此外，我将展示如何使用<code class="du ju jv jw jx b">pandas.</code>来阅读Google表单</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="379d" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">如何自动填写谷歌表单</h1><p id="9f59" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">自动填写google表单的第一步是创建一个包含必须填写的字段的google表单。(表单问题必须用相应的数据类型表示google表单上的列)。<br/>下面你可以看到一个有4个问题的谷歌表单，代表我的谷歌表单的列。(姓名、年龄、电子邮件、国家)</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es li"><img src="../Images/ab07d283932317fd12399ee738d0286f.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*oW75N8qMntBPIR2XIB9pCQ.png"/></div></figure><p id="bc69" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">之后，您需要创建一个预填充的链接。为此，在屏幕右上方转到“更多选项”菜单，然后单击“获取预填链接”按钮，如下所示:</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/9605ae99ea44e495bd2110eb41671945.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*2kcVU8-5jj4lrxisM1tLtQ.png"/></div></figure><p id="7ad5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下一步，您需要在表单中填写代表每个问题的信息，您插入的信息将用于识别哪个是该问题的“条目”,稍后我将对此进行解释。填写完表格后，在页面末尾点击“获取链接”并复制链接。</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/577b21db2d9a83a1be5ce9aa314d7c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*NCMtEgseRyVncvCrSGWcPw.png"/></div></figure><p id="371d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您复制的链接将与我自己创建的链接具有相同的结构:</p><p id="2da5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://docs.google.com/forms/d/e/1FAIpQLSd6mtyTunOr3hmJstMVRIZm8W0UbfY06zx5ZC-5dB95w0ihPA/viewform?usp=pp_url&amp;entry.316027912=Daniel+Mille&amp;entry.272409573=33&amp;entry.779187075=dmille@gmail.com&amp;entry.1382791830=Brazil" rel="noopener ugc nofollow" target="_blank">https://docs . Google . com/forms/d/e/1 faipqlsd 6 mtytunor 3 hmjstmvrizm 8 w 0 ubfy 06 zx 5 ZC-5 db 95 w0 ihpa/view form？USP = PP _ URL&amp;entry . 316027912 = Daniel+Mille&amp;entry . 272409573 = 33&amp;entry.779187075=dmille@gmail.com&amp;entry . 1382791830 =巴西</a></p><p id="013d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们把这个网址分成几部分吧！<br/>让我们把出现在“/视图表单”之前的所有东西都叫做<code class="du ju jv jw jx b">base_url</code>。这样我的<code class="du ju jv jw jx b">base_url</code>是:<br/><a class="ae iu" href="https://docs.google.com/forms/d/e/1FAIpQLSd6mtyTunOr3hmJstMVRIZm8W0UbfY06zx5ZC-5dB95w0ihPA/viewform?usp=pp_url&amp;entry.316027912=Daniel+Mille&amp;entry.272409573=33&amp;entry.779187075=dmille@gmail.com&amp;entry.1382791830=Brazil" rel="noopener ugc nofollow" target="_blank">https://docs . Google . com/forms/d/e/1 faipqlsd 6 mtytunor 3 hmjstmvrizm 8 w0 ubfy 06 zx5 ZC-5 db 95 w0 ihpa</a></p><p id="1333" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，在URL中，每个条目都有各自的标识号，旁边是我们在预填充链接中填充的值。例如，条目编号316027912代表我们表单上的名称字段答案(Daniel+Mille)。我们将使用这些id来实现Python的自动化。</p><p id="0117" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们检查代码！</p><figure class="lj lk ll lm fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="6523" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将要使用的图书馆是<code class="du ju jv jw jx b">pandas</code>和<code class="du ju jv jw jx b">requests</code>。首先，我创建了一个名为<code class="du ju jv jw jx b">post_form</code>的函数，它将接收我们的<code class="du ju jv jw jx b">base_url</code>和一个<code class="du ju jv jw jx b">dictionary</code>作为参数，包含作为键的条目和作为值的数据帧信息。该函数将返回一个在<code class="du ju jv jw jx b">base_url</code>上发布字典信息的请求。</p><figure class="lj lk ll lm fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="acc5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在代码的顶部有我们的<code class="du ju jv jw jx b">base_url</code>。在第二部分，我创建了一个数据框架，其中包含我们将在google表单上发布的信息，如果您已经有了一个包含您要发布的信息的excel文件，您不需要自己创建数据框架，只需使用您的excel/csv文件即可。</p><p id="0ac5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在代码的底部，我使用了<code class="du ju jv jw jx b">pandas iterrows</code>来遍历我们的数据帧，并使用每行的信息来执行<code class="du ju jv jw jx b">post_function</code>。请注意，该函数的第二个参数是一个字典，其中包含预填充链接的四个id以及来自dataframe行的相应值。</p><p id="5472" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">恭喜你！来自数据框的所有信息都发布在表单上，你可以随时通过谷歌表单访问它！</strong></p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="ab48" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">如何阅读带有熊猫的谷歌图片</h1><p id="9305" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">通过pandas读取google工作表的方法是使用read_excel执行的(与读取xlsx文件的方式相同)。不同之处在于，您将使用google sheet url，而不是使用文件路径作为参数。</p><p id="7c06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要做到这一点，谷歌表单必须首先发布到网络上或用户面前。为了说明这一点，我将阅读一份公开的谷歌表单(确保你不会公开包含敏感信息的谷歌表单！拥有url的每个人都可以访问该信息)</p><p id="1fe1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要发布您的google表单，请在屏幕右上方点击共享按钮，如下图所示:</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/dd21c152c54cd7f2c85419ca4efc908f.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*wkIngWYYXUkZY9p3CxkK_Q.png"/></div></figure><p id="9ea6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，在“获取链接”字段切换到“任何有链接的人”:</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es li"><img src="../Images/08be6c3d6043046fdcbe9ce8240e5eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*YhtkvIprJtsOAdfVbTmVZA.png"/></div></figure><p id="f756" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后一步是发布到网络上。在<em class="jt">文件</em>上选择<em class="jt">“发布到web”</em>选项，然后选择文件扩展名并发布！这个url就是我们要传递的参数，用来用<code class="du ju jv jw jx b">pandas</code>读取这个文件</p><figure class="lj lk ll lm fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/21efd00b9e0108cf14a94c5ad4805b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*nG9Qp_i9vzlVbJdQ-TO34g.png"/></div></figure><p id="551b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在你的google sheet已经在网上公开了，使用带有google sheet url的<code class="du ju jv jw jx b">read_excel</code>和<code class="du ju jv jw jx b">pandas</code>来浏览你的数据吧！</p><figure class="lj lk ll lm fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><h1 id="e87d" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">最后的想法</h1><p id="03dd" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">小心你发布到网络上的信息！<br/> 任何拥有该链接的人都可以访问您的google表单上的信息。我公开了我的电子表格来展示代码是如何工作的，但是你可以把你的电子表格限制在你的组织中的人或者仅仅是授权的人！</p><p id="b20a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望你喜欢这篇文章，并且你可以摆脱那些来回的工作！</p><p id="4a59" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢这篇文章，请毫不犹豫地鼓掌！如果你有任何疑问或要求，请随时使用评论！</p></div></div>    
</body>
</html>
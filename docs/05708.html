<html>
<head>
<title>My flutter 2.0 migration story : Still better story than twilight 🔮</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的flutter 2.0迁移故事:比《暮光之城》更好的故事🔮</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/my-flutter-2-0-migration-story-still-better-story-than-twilight-5d3754bbf1a6?source=collection_archive---------24-----------------------#2021-07-28">https://medium.com/geekculture/my-flutter-2-0-migration-story-still-better-story-than-twilight-5d3754bbf1a6?source=collection_archive---------24-----------------------#2021-07-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="e42a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">将flutter和dart版本升级到2.0，并将现有项目迁移到新的更新开发环境</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/0e5240e142c484529e0259fa64011965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9k0AxjPWybKJPHe3tnkOeg.png"/></div></div></figure><p id="92e0" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">免责声明:在开始迁移过程之前，请务必进行完整的备份。一般来说，建议你至少拥有高于平均水平的flutter或编程技能👍，如果您有任何未解决的依赖关系。我不建议迁移您的开发环境，除非您需要整合flutter 2.0的特性。先说故事。</p><h2 id="092d" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">日期是7月27日，颤振应用程序…需要升级…🤭</h2><p id="3905" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">对于喜欢构建原生应用程序的开发人员来说，flutter 2.0带来了什么新的东西？最重要的特性是空安全性，它通过区分可空类型和不可空类型进一步增强了Dart，这有助于防止空崩溃，这是应用程序崩溃的常见原因😵‍💫。看起来很漂亮的谷歌移动广告和iOS的新Cupertino材料组件是我的最爱。</p><p id="cf00" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">首先，你必须升级你的颤振和飞镖版本。你可以在你的终端上运行flutter--upgrade。如果这个命令不起作用，这意味着已经对您的flutter SDK进行了修改，因此您可以通过使用以下指令来强制升级。之后，您可以运行flutter a doctor来验证用于检查您的flutter安装的待办事项列表。</p><h2 id="a4d6" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">起初一切都是彩虹和独角兽🦄</h2><p id="b31d" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">让我们继续将我们的应用程序迁移到最新的SDK版本，但是首先备份您的flutter a项目，因为不是所有的flutter项目都可以迁移。对于可解析的包，我们可以使用下面的命令。</p><pre class="iy iz ja jb fd lf lg lh li aw lj bi"><span id="3b1b" class="kf kg hi lg b fi lk ll l lm ln">flutter pub outdated --mode=null-safety</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/f19c3d4b02347314cc35afe47675167b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQv8z3ir4XDGVOyu1VLIkA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Package checking</figcaption></figure><p id="1e99" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">如果您注意到最右边带有“x”的依赖项，这些是无法解决的，如果它们提供了功能性的可能性，您应该等到它们被解决。有记号的是头奖；您可以复制这些版本，然后将它们粘贴到您的“pubspec.yml”文件中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/759230cef9e02cc6d5ee9acc17dae3f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_kA9K7uAgbicF4OWEqFFg.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Find alternatives if packages are for Aesthetics</figcaption></figure><p id="07e4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在是未解决的问题，因为它们没有提供像状态管理、API处理或会话存储这样的功能前景。我选择放弃其中的一些，并在酒吧开发网站上寻找替代品。检查发布开发中未解析的包；您可能仍然会发现许多支持零安全的替代方案。例如，我没有使用SplashScreen，而是使用了flutter native splash: 1.2.0，它提供了null安全性。我将对剩下的三个包重复这个过程，我们不再有任何包的问题。如果你注意到一波错误，不要惊慌；一切都会恢复正常，希望是🥲.</p><p id="50e4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">检查您的dart版本是否至少是2.12。如果不是，请使用命令" dart- -version "来检查您的dart版本。它通常会随着你的flutter包更新。</p><h2 id="14fd" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">让我们为了科学而这样做🚀</h2><p id="4cf0" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">您可以跳到下一部分，无需手动修复。升级后我在pubspec文件里把flutter SDK版本改成了2.12.0 3。零安全的标准相当简单。让我们通过添加最近的关键字来修复空变量，并出于科学的目的做一些手工劳动来观察发生了什么变化。示例“@ from @required”</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lu"><img src="../Images/c81ffe07f82924d72582db5b5eac961e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bf2p7RPSGDT2mQ9ZVJlmxA.png"/></div></div></figure><p id="1f87" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">！将可空类型转换为不可空类型，比如在snackbar中放置空检查，以及许多其他规则幸运的是，我发现了一个演练，我将在参考资料部分提供。</p><pre class="iy iz ja jb fd lf lg lh li aw lj bi"><span id="7589" class="kf kg hi lg b fi lk ll l lm ln">_scaffoldKey.currentState!.showSnackBar(snackbar);</span><span id="a4f4" class="kf kg hi lg b fi lv ll l lm ln">_formKey.currentState!.reset();</span><span id="00d6" class="kf kg hi lg b fi lv ll l lm ln">}</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lw"><img src="../Images/dc7caa19585d2c1873322d81ae0b5b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_h9WK0r00LLgb8v3tIfpvg.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Using the Late keyword for undefined placeholders</figcaption></figure><p id="cbff" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，在更新了变量并修复了150+个可空约束之后，我仍然有几个问题，下面提到了其中的一些，我将手动纠正它们，因为，你猜对了！为了科学！🧑‍🔬你认为我修复23个错误需要多长时间？更新:修复它们花了一个小时。</p><pre class="iy iz ja jb fd lf lg lh li aw lj bi"><span id="d300" class="kf kg hi lg b fi lk ll l lm ln">error • A value of type 'Color?' can't be assigned to a variable of type 'Color' at lib/configuration.dart:3:21 • (invalid_assignment)<br/>  error • The argument type 'Color?' can't be assigned to the parameter type 'Color' at lib/configuration.dart:6:13 • (argument_type_not_assignable)<br/>  error • The argument type 'Null' can't be assigned to the parameter type 'Key' at lib/.dart:595:27 • (argument_type_not_assignable)<br/>  error • The named parameter 'onInit' is required, but there's no corresponding argument at lib/.dart:46:16 • (missing_required_argument)<br/>  error • The named parameter 'key' is required, but there's no corresponding argument at lib/pages/.dart:27:14 • (missing_required_argument)<br/>  error • The argument type 'void Function(String)' can't be assigned to the parameter type 'void Function(String?)?' at lib/pages/cart.dart:324:15 • (argument_type_not_assignable)<br/>  error • The named parameter 'user' is required, but there's no corresponding argument at lib/pages/.dart:194:15 • (missing_required_argument)<br/>  error • The named parameter 'key' is required, but there's no corresponding argument at lib/pages/.dart:195:15 • <br/>  error • The named parameter 'user' is required, but there's no corresponding argument at lib/pages/.dart:216:15 • (missing_required_argument)<br/>  error • Undefined name 'user' at lib/redux/.dart:24:33 • (undefined_identifier)<br/>  error • The default 'List' constructor isn't available when null safety is enabled at lib/redux/.dart:156:42 • (default_list_constructor)<br/>  error • The named parameter 'store' is required, but there's no corresponding argument at test/widget_test.dart:16:29 • (missing_required_argument)</span></pre><p id="079d" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">*鼓角色* 🥁成功地更改为空安全，但让我们看看应用程序是否再次工作，因为我想自己学习所有的转换。手指交叉。这款应用确实推出了，但一些功能被破坏了。现在我们已经完成了实验，让我们试试dart迁移工具。</p><h2 id="be8a" class="kf kg hi bd kh ki kj kk kl km kn ko kp js kq kr ks jw kt ku kv ka kw kx ky kz bi translated">你迷失了方向…你的起点在这里。🤗</h2><p id="aa19" class="pw-post-body-paragraph jj jk hi jl b jm la ij jo jp lb im jr js lc ju jv jw ld jy jz ka le kc kd ke hb bi translated">我回滚到开始，保留了迁移文件中的pub文件，删除了未满足依赖关系的实例，并执行了<strong class="jl hj"> dart迁移。</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/e7e4f360652ed32f82e344a3e0de4da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t81Oupdd8RmANfs2eGc2Lg.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Dart migrate success</figcaption></figure><p id="8cc4" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">此时，我想对Flutter和Dart团队表示感谢，感谢他们让手动迁移预览变得信息丰富👏，通过视觉亮点向您展示迁移的变化，这太棒了。我亲自检查了所有提议的修改并发现了它们。在点击迁移之前，我成功地完成了其中的85%以上。点击migrate flutter后，更改会自动进行，你不必担心🤩。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lx"><img src="../Images/a1f04ab54d790005c4c3b795b6858bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_0PhFU4UdrglxozOLQ7WyQ.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Null safety changes proposed by the migration tool</figcaption></figure><p id="5a68" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">然后我尝试了颤振运行命令。是的，这似乎没有工作，所以我尝试了两个模拟器只是为了确定，但没有，所以我没有颤振干净和颤振酒吧得到代替。没有运气仍然停留在空白屏幕上</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/67d12e6b3a96b84cd720d035ce2b90cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f4Nllar9A2TaVknYBt2QOA.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Flutter Migration blank screen result</figcaption></figure><p id="22ce" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">让我看看，当我手动执行时，只有几个功能坏了，但其他功能都正常。我能够浏览所有的面板，状态管理看起来是可操作的。由于我进行了手动迁移并了解了哪里最有可能出错，我做了必要的修改，然后,*鼓点* 🥁 <strong class="jl hj"> </strong>，它在🥳.成功了</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lt"><img src="../Images/2a613910c3ec1b84448a359e2536ac1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKQJLnUsZtPZQyTyeWtZdQ.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">Worked 🥳</figcaption></figure><p id="f2ee" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">从功能到布局的一切现在都可以利用新的颤振V2功能。我将进一步测试我的应用程序是否有任何错误，科学又一次拯救了我们！这就是我飘忽不定的迁徙故事。我将列出一些对我真正有帮助的资源，它们是纯粹的幸福。看看那些伟大的开发者，给他们你的支持。快乐编码✨</p></div></div>    
</body>
</html>
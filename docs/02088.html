<html>
<head>
<title>The Power of Image Augmentation: An Experiment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像增强的力量:一个实验</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/the-power-of-image-augmentation-an-experiment-1c93084ff96c?source=collection_archive---------31-----------------------#2021-05-03">https://medium.com/geekculture/the-power-of-image-augmentation-an-experiment-1c93084ff96c?source=collection_archive---------31-----------------------#2021-05-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="fc25" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">通过图像增强提高物体检测模型性能的4点建议</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/97106a29fc3ba256cf80a588e4d1ec0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qtH1-vr-Mh2jZ20sw6Ttxg.jpeg"/></div></div></figure><p id="b8a6" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">计算机视觉的惊人之处之一是使用现有图像加上随机变化来增加有效样本量。假设你有一张包含咖啡杯的照片。然后，复制照片，顺时针旋转10度。从你的角度来看，你做得不多。</p><p id="c89f" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">但是你已经(很容易地)将你要给你的模型的图片数量增加了一倍！你的计算机视觉模型现在对咖啡杯的样子有了一个全新的视角。</p><p id="055c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">现在，为同一个现有的咖啡杯照片制作两个版本还不如为一个咖啡杯拍摄两张不同的照片好。例如，你不应该拍摄一张照片，将其放大10，000倍，并根据该数据拟合一个对象检测模型，然后期望你的模型表现得像你拍摄了10，000张咖啡杯的真实照片一样好。图像增强有一些限制。</p><p id="c514" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">也就是说，图像增强是一种从现有数据生成新数据的非常强大的技术。使用<a class="ae kg" href="https://roboflow.com/" rel="noopener ugc nofollow" target="_blank"> Roboflow </a>的一个巨大好处是，你只需点击一个按钮就可以做到这一点！</p><p id="18a9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">图像增强到底有多强大？我决定做一个小实验。我研究了模型性能如何基于三个不同的维度变化:原始数据集的大小、扩充的类型和扩充的数量。</strong></p><h1 id="a4bc" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">原始数据集的大小</h1><p id="958a" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">我从<a class="ae kg" href="https://public.roboflow.com" rel="noopener ugc nofollow" target="_blank">public.roboflow.com</a>选择了三个<a class="ae kg" href="http://public.roboflow.com/" rel="noopener ugc nofollow" target="_blank">公共图像数据集</a>。(您现在就可以自己使用这些数据集！)</p><ul class=""><li id="b811" class="le lf hi jl b jm jn jp jq js lg jw lh ka li ke lj lk ll lm bi translated">一个<a class="ae kg" href="https://public.roboflow.com/object-detection/packages-dataset" rel="noopener ugc nofollow" target="_blank">包裹数据集</a>，由位于公寓和住宅门口附近的26个包裹图像组成。</li><li id="5cbd" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">一个<a class="ae kg" href="https://public.roboflow.com/object-detection/raccoon" rel="noopener ugc nofollow" target="_blank">浣熊数据集</a>，由196张浣熊图片组成。</li><li id="5ea9" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">一个<a class="ae kg" href="https://public.roboflow.com/object-detection/pothole" rel="noopener ugc nofollow" target="_blank">坑洞数据集</a>，由665幅道路坑洞图像组成。</li></ul><h1 id="fdd4" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">增强类型</h1><p id="774a" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">在文章的开始，我使用旋转作为一个示例增强:复制一个图像，并将其旋转10度。然而，有许多不同类型的<a class="ae kg" href="https://docs.roboflow.com/image-transformations/image-augmentation" rel="noopener ugc nofollow" target="_blank">图像增强技术</a>！我将我探索的增强类型分为三组。(<em class="kf">为什么把增强分解成集合？嗯，Roboflow让你可以应用</em> <a class="ae kg" href="https://docs.roboflow.com/image-transformations/image-augmentation" rel="noopener ugc nofollow" target="_blank"> <em class="kf">多达23种不同的增强技术</em> </a> <em class="kf">！对这些进行彻底的搜索需要很长时间。</em>)</p><h2 id="1ad0" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">设置A:随机旋转，随机裁剪，随机噪声</h2><ul class=""><li id="998e" class="le lf hi jl b jm kz jp la js mg jw mh ka mi ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/why-and-how-to-implement-random-rotate-data-augmentation/" rel="noopener ugc nofollow" target="_blank">随机旋转</a>:对于每次放大，我随机将每张图片逆时针或顺时针旋转10度。</li><li id="49f9" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/why-and-how-to-implement-random-crop-data-augmentation/" rel="noopener ugc nofollow" target="_blank">随机裁剪</a>:对于每次放大，我随机裁剪每张图片，最多20%。你可以认为这是在放大图像。</li><li id="d444" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/why-to-add-noise-to-images-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">随机噪声</a>:对于每一次放大，我都在图像的10%像素中随机添加了黑色或白色像素。看起来好像我在图像上撒了盐和胡椒，这有助于抵御恶意攻击并防止过度拟合。</li></ul><h2 id="261d" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">设置B:随机亮度，随机模糊，随机剪切，加上所有“设置A”的增强</h2><ul class=""><li id="56d4" class="le lf hi jl b jm kz jp la js mg jw mh ka mi ke lj lk ll lm bi translated">随机亮度:对于每一次增强，我随机地使图像变亮或变暗30%。对于一个图像来说，这几乎就像是如果太阳真的很亮，或者如果它是一个真正的阴天。</li><li id="23c0" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/using-blur-in-computer-vision-preprocessing/" rel="noopener ugc nofollow" target="_blank">随机模糊</a>:对于每一次增强，我都添加了高达1.75像素的随机高斯模糊，这可以模拟相机移动，就像你在车上拍照一样。</li><li id="d8ca" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">随机剪切:对于每次放大，我在图像上添加了5个随机放置的黑盒，最多占图像的15%。这复制了遮挡，其中感兴趣的对象被摄像机视图中的另一个对象遮挡。</li></ul><h2 id="42ff" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">集合C: <a class="ae kg" href="https://blog.roboflow.com/introducing-bounding-box-level-augmentations/" rel="noopener ugc nofollow" target="_blank">边界框级别的</a>旋转、边界框级别的裁剪和边界框级别的亮度，以及所有“集合A”和“集合B”的增强。</h2><p id="1273" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated"><a class="ae kg" href="https://docs.roboflow.com/image-transformations/image-augmentation/bounding-box-level-augmentation" rel="noopener ugc nofollow" target="_blank">边界框级增强</a>类似于常规的图像增强，除了不是整个图像改变(这是图像增强所发生的)，只有边界框中的区域变化受这些影响。它们是由一篇<a class="ae kg" href="https://arxiv.org/pdf/1906.11172.pdf" rel="noopener ugc nofollow" target="_blank"> 2019年谷歌研究论文</a>推广的。</p><ul class=""><li id="fce1" class="le lf hi jl b jm jn jp jq js lg jw lh ka li ke lj lk ll lm bi translated">随机边界框级别的旋转:对于每个增强，我随机地将每个边界框中的内容逆时针或顺时针旋转10度。</li><li id="c93d" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">随机边界框级别的裁剪:对于每个增强，我随机裁剪每个边界框中的内容，最多20%。</li><li id="5f25" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">随机边界框级别的亮度:对于每一次增强，我将图像的边界框区域随机增亮或变暗30%。</li></ul><h1 id="293f" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">扩增次数</h1><p id="88c3" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">对于每一张图片，我们将它放大(复制并添加随机变化)一定的次数。我们想了解的主要问题之一是，增强的数量如何影响模型性能？</p><p id="95d9" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">对于每个数据集，我们通过将每个图像增强一定次数来构建增强数据集，然后在每个增强数据集上拟合模型。</p><ul class=""><li id="4982" class="le lf hi jl b jm jn jp jq js lg jw lh ka li ke lj lk ll lm bi translated"><strong class="jl hj"> 0x增强</strong> —这只是没有增强的常规数据集</li><li id="148e" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><strong class="jl hj">3倍放大</strong>——每幅图像在随机扰动下复制3次</li><li id="9788" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><strong class="jl hj">5倍增强</strong></li><li id="2659" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><strong class="jl hj">10倍放大</strong></li><li id="6d1c" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><strong class="jl hj">20倍放大</strong></li></ul><h1 id="e17d" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">衡量绩效</h1><p id="0cb5" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">我们通过查看对象检测中的三个常见指标来衡量性能:</p><ul class=""><li id="0b45" class="le lf hi jl b jm jn jp jq js lg jw lh ka li ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/mean-average-precision/" rel="noopener ugc nofollow" target="_blank">平均精度</a>(地图):黄金标准度量。地图范围从0%到100%。您的贴图越接近100%，您的模型执行得越好。</li><li id="8646" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/glossary/#:~:text=Precision%20-%20A" rel="noopener ugc nofollow" target="_blank"> Precision </a>:不要和mean平均精度混淆，Precision(也叫阳性预测值)计算的是正确预测的对象数除以模型预测的对象总数。例如，如果一个模型预测数据集上有10个对象，并且其中8个预测是正确的，那么我们的模型在该数据集上有80%的精度分数。</li><li id="bd5a" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><a class="ae kg" href="https://blog.roboflow.com/glossary/#:~:text=Recall%20-%20A" rel="noopener ugc nofollow" target="_blank"> Recall </a>:也叫灵敏度，Recall计算的是正确预测对象的数量除以数据中“地面真实”对象的总数。例如，如果模型预测数据集中有20个对象，而我们的模型正确地检测到其中的8个对象，那么我们的模型在该数据集上的召回分数为40% (8/20)。</li></ul><h1 id="cc4b" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">结果</h1><h2 id="23aa" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">包数据集</h2><p id="97a6" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">当在packages数据集(有26个源图像)上拟合模型时，在扩充图像之前，mAP非常低-潜在的100%中的3.5%。应用增强技术显著增加了地图高达80个百分点。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mj"><img src="../Images/ba2f863a2e1bf40c0cc0b603cf932171.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/0*XUdzuZBS9oU-LMtP.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx">Evaluating mAP by number of augmentations on the packages dataset.</figcaption></figure><p id="d17c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">我们看到精确度和召回率也有类似的提高，从零增加的0%提高到70%或80%以上。下面是包数据集的mAP、precision和recall分数的完整表格。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/3e409feed928338897af6c719bb2dbee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdJTWWhqcEKfPZ0XSGIHuw.png"/></div></div><figcaption class="mk ml et er es mm mn bd b be z dx">Calculating mAP, precision, and recall by number of augmentations on the packages dataset.</figcaption></figure><h2 id="ec8c" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">浣熊数据集</h2><p id="dce0" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">当在浣熊数据集(具有196幅源图像)上拟合模型时，在零增强的情况下，平均精度高于88%。在这种情况下，增强的效果各不相同！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/bd4a74b957a5e548a0b1303698aeb249.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/0*0nka4ct5nVWxEbsc.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx">Evaluating mAP by number of augmentations on the raccoons dataset.</figcaption></figure><p id="9180" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">非边界框级别的增强对mAP没有显著影响，但在精度方面有显著提高(高达20或30个百分点)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mo"><img src="../Images/42b7391b4bfac132933914cb3bb73335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDH5pwZKMeZ1eXNBPNlkxg.png"/></div></div><figcaption class="mk ml et er es mm mn bd b be z dx">Calculating mAP, precision, and recall by number of augmentations on the raccoons dataset.</figcaption></figure><p id="178c" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">包围盒级别的增强对地图和回忆有显著的负面影响。</p><h2 id="8e0e" class="ls ki hi bd kj lt lu lv kn lw lx ly kr js lz ma kt jw mb mc kv ka md me kx mf bi translated">坑洞数据集</h2><p id="7306" class="pw-post-body-paragraph jj jk hi jl b jm kz ij jo jp la im jr js lb ju jv jw lc jy jz ka ld kc kd ke hb bi translated">当在potholes数据集(有665幅源图像)上拟合模型时，地图开始时大约有74%没有放大。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mp"><img src="../Images/ba8084db8a5dd97dc1feec8fb4f1971d.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/0*t5w7xAtxZh8x_af7.png"/></div><figcaption class="mk ml et er es mm mn bd b be z dx">Evaluating mAP by number of augmentations on the potholes dataset.</figcaption></figure><p id="c866" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">在扩充了potholes数据集之后，我们看到了类似于raccoons数据集的性能效果。浣熊和坑洞数据集的源影像(分别为196和665)明显多于包数据集(26张影像)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mq"><img src="../Images/59ba8602337f2312ecdf0e253a4eb5ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eex57Rnn72vxp3zllup4WQ.png"/></div></div><figcaption class="mk ml et er es mm mn bd b be z dx">Calculating mAP, precision, and recall by number of augmentations on the potholes dataset.</figcaption></figure><h1 id="37b9" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">外卖食品</h1><ul class=""><li id="4061" class="le lf hi jl b jm kz jp la js mg jw mh ka mi ke lj lk ll lm bi translated"><strong class="jl hj">扩充的积极效果似乎在小样本数据集上最为明显。</strong>这真是一个好消息:即使您的数据集非常小，图像增强也可以帮助您的模型表现得相当好！有26张图片的软件包数据集，看到<em class="kf">地图通过增强</em>提高了80多个百分点！</li><li id="0bf0" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">如果你要做扩张，做更多的扩张！虽然有3到5次强化是有帮助的，但如果你增加强化次数，你通常会看到好处。例如，20倍放大的地图总是比3倍放大的地图高，这对于精确度和召回率来说几乎总是正确的。</li><li id="d158" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated">更多类型的增强并不总是更好。包围盒级增强技术在与非包围盒级增强技术结合使用时，通常会对模型性能产生负面影响。主题专业知识和<a class="ae kg" href="https://blog.roboflow.com/tag/augmentation/" rel="noopener ugc nofollow" target="_blank">知道在给定场景中应用哪种类型的增强</a>非常重要！</li><li id="6e77" class="le lf hi jl b jm ln jp lo js lp jw lq ka lr ke lj lk ll lm bi translated"><strong class="jl hj">增强不是魔法。</strong>这不像“增强使事情变得更好”那么简单在很多情况下(样本量已经很大了)，零放大比放大图像更好。这可能归结为数据集中的特定图像或所选的特定增强类型。计算机视觉不是一门完美的科学，但也是一门艺术。</li></ul><p id="419a" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">请注意，每个数据集只包含一个类(分别为包裹、浣熊和坑洞)。在对象检测问题中，情况并不总是这样——例如，门可以在packages数据集中进行标记，因此我们将“packages”和“doors”作为两个独立的类包含在内。</p><p id="f317" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><strong class="jl hj">那么，为什么我们只研究了单类物体检测问题呢？</strong>嗯，我已经在这里比较了很多变量(原始数据集的大小、扩充的数量、扩充的类型)，所以我选择不<em class="kf">也不</em>探究扩充的数量如何影响类的数量。</p><p id="97db" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated">为了让你的模型更加生动，考虑使用<a class="ae kg" href="https://blog.roboflow.com/a-primer-on-transfer-learning/" rel="noopener ugc nofollow" target="_blank">迁移学习</a>和我们在这篇文章中没有探讨的增强类型。</p></div><div class="ab cl mr ms gp mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="hb hc hd he hf"><p id="5232" class="pw-post-body-paragraph jj jk hi jl b jm jn ij jo jp jq im jr js jt ju jv jw jx jy jz ka kb kc kd ke hb bi translated"><em class="kf">原载于2021年5月3日https://blog.roboflow.com</em><a class="ae kg" href="https://blog.roboflow.com/the-power-of-image-augmentation-experiment/" rel="noopener ugc nofollow" target="_blank"><em class="kf"/></a><em class="kf">。</em></p></div></div>    
</body>
</html>
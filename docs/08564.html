<html>
<head>
<title>Time Steering in Swift 5.5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift 5.5中的时间控制</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/time-steering-in-swift-5-5-ae39fd9ccd09?source=collection_archive---------5-----------------------#2021-11-06">https://medium.com/geekculture/time-steering-in-swift-5-5-ae39fd9ccd09?source=collection_archive---------5-----------------------#2021-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/a5b7f2cee4429148f220189486deb60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7jXoF6fGGP-t3dAT"/></div></div><figcaption class="iy iz et er es ja jb bd b be z dx">Photo by <a class="ae jc" href="https://unsplash.com/@loic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Djim Loic</a> on <a class="ae jc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6096" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在应用程序开发中有效地处理日期和时间是非常重要的。像Twitter、WhatsApp或Instagram这样的流行应用程序使用日期和时间格式以及许多其他操作功能来有效地传递信息。</p><p id="f4b2" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">从基本的操作功能到非常需要的格式化功能，我们将回忆一切。</p><h2 id="1744" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">向今天添加n个时刻</h2><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="9f42" class="kb kc hi kx b fi lb lc l ld le">let tomorrow = Calendar.current.date(byAdding: DateComponents(day: 1), to: Date())</span><span id="c38a" class="kb kc hi kx b fi lf lc l ld le">let yesterday = Calendar.current.date(byAdding: .day, value: -1, to: Date())</span></pre><p id="2256" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">通过更改第一个Calendar.component参数，我们可以前进/后退任意天数、月数、分钟数、小时数、秒钟数和年数。</p><h2 id="2938" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">下一个日期要求</h2><p id="a562" class="pw-post-body-paragraph jd je hi jf b jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka hb bi translated">当用户想知道下一个可能的日期是哪个月的第二天是星期二时。</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="1589" class="kb kc hi kx b fi lb lc l ld le">Calendar.current.nextDate(after: Date(), matching: DateComponents(day: 2, weekday: 3), matchingPolicy: .strict, repeatedTimePolicy: .first, direction: .forward)</span></pre><p id="c8ef" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这样，向前和向后计算都是可能的。任何这样的日期、月份、年份、分钟或秒钟的排列要求都可以通过这个功能实现。</p><p id="4988" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">此外，上述方法中所有这些可能性的列举可以如下进行:</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="2fe8" class="kb kc hi kx b fi lb lc l ld le">var i = 8</span><span id="efb4" class="kb kc hi kx b fi lf lc l ld le">// enumerate above result</span><span id="42cd" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.enumerateDates(startingAfter: Date(), matching: DateComponents(day: 2, weekday: 3), matchingPolicy: .strict, repeatedTimePolicy: .first, direction: .forward) { result, exactMatch, stop in</span><span id="f2f1" class="kb kc hi kx b fi lf lc l ld le">   print(result!)</span><span id="0f45" class="kb kc hi kx b fi lf lc l ld le">   i = i-1</span><span id="da3a" class="kb kc hi kx b fi lf lc l ld le">   if i == 0 {</span><span id="45f8" class="kb kc hi kx b fi lf lc l ld le">    stop = true</span><span id="7617" class="kb kc hi kx b fi lf lc l ld le">   }</span><span id="bb45" class="kb kc hi kx b fi lf lc l ld le">}</span></pre><p id="fcb1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这给出了满足要求的下8个结果。</p><h2 id="4dbf" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">验证用户输入的日期</h2><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="23b7" class="kb kc hi kx b fi lb lc l ld le">Calendar.current.isDateInTomorrow(tomorrow)</span><span id="b420" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.isDateInToday(Date())</span><span id="ef7f" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.isDateInWeekend(Date())</span><span id="ba4b" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.isDateInYesterday(yesterday)</span></pre><p id="d691" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用上述方法和其他类似的方法，我们可以验证用户输入的日期是否在周末/明天/昨天。</p><h2 id="3e4c" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">按粒度比较</h2><p id="21aa" class="pw-post-body-paragraph jd je hi jf b jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka hb bi translated">swift中的两个日期时间对象可以在swift中使用比较运算符进行比较，例如或==。</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="ecb5" class="kb kc hi kx b fi lb lc l ld le">Date() == Date() //true</span><span id="9a6a" class="kb kc hi kx b fi lf lc l ld le">Date() &lt; tomorrow! //true</span><span id="5bcf" class="kb kc hi kx b fi lf lc l ld le">Date() &lt; yesterday! //false</span></pre><p id="bad6" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">相反，如果你想仅通过任何组件进行比较，那么我们可以使用下面的</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="7a8f" class="kb kc hi kx b fi lb lc l ld le">Calendar.current.compare(Date(), to: yesterday, toGranularity: .hour) == .orderedAscending</span></pre><p id="a934" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">此外，如果我们想比较所有的时间组成部分，而不是只有一个，那么下面是一种方法</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="c566" class="kb kc hi kx b fi lb lc l ld le">let date1  = Date()</span><span id="8426" class="kb kc hi kx b fi lf lc l ld le">let components = Calendar.current.dateComponents([.hour, .minute, .second], from: tomorrow!)</span><span id="eeca" class="kb kc hi kx b fi lf lc l ld le">let date2 = Calendar.current.date(bySettingHour: components.hour!, minute: components.minute!, second: components.second!, of: Date())!</span></pre><p id="644f" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">转换后的datetime对象date2和date1可以通过比较操作进行比较，或者通过下面的方法获得差异。</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="5505" class="kb kc hi kx b fi lb lc l ld le">let difference = Calendar.current.dateComponents([.hour, .minute], from: date1, to: date2)</span></pre><h2 id="a557" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">标志</h2><p id="310d" class="pw-post-body-paragraph jd je hi jf b jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka hb bi translated">另一个有用的方法是各种样式的月份和工作日的符号，可以用本地方法制作。</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="991d" class="kb kc hi kx b fi lb lc l ld le">Calendar.current.weekdaySymbols</span><span id="8514" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.shortWeekdaySymbols</span><span id="6be0" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.standaloneWeekdaySymbols</span><span id="f6a1" class="kb kc hi kx b fi lf lc l ld le">Calendar.current.veryShortWeekdaySymbols</span></pre><h2 id="c9e2" class="kb kc hi bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku kv bi translated">格式化日期和时间</h2><p id="5c60" class="pw-post-body-paragraph jd je hi jf b jg lg ji jj jk lh jm jn jo li jq jr js lj ju jv jw lk jy jz ka hb bi translated">从swift 5.5开始，使用DateFormatter格式化的拖动方式被压缩方式所取代。</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="3ed1" class="kb kc hi kx b fi lb lc l ld le">Date().formatted(date: .abbreviated, time: .shortened)</span></pre><p id="f254" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">日期和时间样式的不同组合可以由简单的上述功能组成，包括省略任何组件。</p><p id="b703" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">特别是，如果您想要包含、排除或样式化单个组件，如包含日期和排除月份，可以使用以下内容</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="e37f" class="kb kc hi kx b fi lb lc l ld le">Date().formatted(.dateTime.day().weekday())</span><span id="5191" class="kb kc hi kx b fi lf lc l ld le">Date().formatted(.dateTime.hour().minute().weekday(.wide))</span></pre><p id="c11d" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated"><strong class="jf hj">格式化间隔</strong></p><p id="9293" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">间隔的格式如下</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="0195" class="kb kc hi kx b fi lb lc l ld le">(Date()..&lt;tomorrow!).formatted(date: .numeric, time: .shortened) //"11/7/2021, 1:33 AM – 11/8/2021, 1:33 AM"</span><span id="cd6c" class="kb kc hi kx b fi lf lc l ld le">(Date()..&lt;tomorrow!).formatted(.timeDuration) //"23:59:59"</span><span id="b6bc" class="kb kc hi kx b fi lf lc l ld le">(Date()..&lt;tomorrow!).formatted(.components(style: .abbreviated)) //"23 hr, 59 min, 59 sec"</span><span id="2144" class="kb kc hi kx b fi lf lc l ld le">(yesterday!..&lt;Date()).formatted(.components(style: .condensedAbbreviated, fields: [.day])) //"1 day"</span></pre><p id="70cf" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">与上面的方法类似，使用RelativeDateFormatter的痛苦格式化也变得简单了，如下所示</p><pre class="in io ip iq fd kw kx ky kz aw la bi"><span id="9414" class="kb kc hi kx b fi lb lc l ld le">tomorrow!.formatted(.relative(presentation: .named, unitsStyle: .wide)) //"tomorrow"</span><span id="de61" class="kb kc hi kx b fi lf lc l ld le">tomorrow!.formatted(.relative(presentation: .numeric, unitsStyle: .wide)) //"in 1 day"</span><span id="95b6" class="kb kc hi kx b fi lf lc l ld le">tomorrow!.formatted(.relative(presentation: .numeric, unitsStyle: .abbreviated)) //"in 24 hr."</span></pre><p id="db58" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">就是这样！</p><p id="96d8" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">感谢阅读！！！</p><p id="9ec1" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">👉你觉得这个帖子有用吗？你现在可以通过<a class="ae jc" href="https://www.buymeacoffee.com/maheshsai" rel="noopener ugc nofollow" target="_blank">给我买一个披萨</a>来支持我坚持下去的努力！</p></div></div>    
</body>
</html>
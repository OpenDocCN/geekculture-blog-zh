<html>
<head>
<title>1. Comparison &amp; Aggregation Functions in SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">1.SQL中的比较和聚集函数</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/1-comparison-aggregation-functions-in-sql-934d6ec76bff?source=collection_archive---------8-----------------------#2022-08-12">https://medium.com/geekculture/1-comparison-aggregation-functions-in-sql-934d6ec76bff?source=collection_archive---------8-----------------------#2022-08-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="2c7c" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">了解SQL NULL和聚合函数</h2><div class=""/><div class=""><h2 id="8ca1" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">NVL、合并、解码、NULLIF、NVL2、AVG、求和、最小值、最大值、计数</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/2a8fe455af26276df6b3c72bd91fc7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t89oKKYOBQCrUTiamaBWZA.jpeg"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Photo by <a class="ae jw" href="https://unsplash.com/@pathdigital?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">path digital</a> on <a class="ae jw" href="https://unsplash.com/s/photos/data-analytics?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="077a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">你好。！</p><p id="0df5" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我只是在修改SQL查询中使用的重要函数，同时为我的办公室工作处理ETL过程。所以我想，为什么不写一篇简短的文章或方便的笔记供将来参考。这些也是面试中被问到的一些重要的SQL问题。因此，在接下来的3篇文章中，我将写SQL查询中使用的6个主要函数类别。这些类别基本上是-</p><p id="90e5" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">1- SQL比较函数</p><p id="5d35" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">2- SQL聚合函数</p><p id="cd41" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">3- SQL字符串函数</p><p id="c1d0" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">4- SQL日期函数</p><p id="4e7b" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">5- SQL数学函数</p><p id="b8b3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">6- SQL窗口函数。</p><p id="2944" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">本文将仅限于前两个内置函数，即比较和聚合函数。此外，正如我提到的，这将是一种简短的笔记，所以我将保持简短，并将链接我发现最适合这些概念的外部材料。所以让我们一个一个来看，</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="a2a3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs"> SQL比较函数:</strong>这些是单行函数(每行给出一个结果)，可用于任何数据类型(日期、字符和数字)，主要与数据库表中空值的使用有关。最常用的比较函数有<strong class="jz hs"> NVL、联合、NULLIF、NVL2 &amp;解码。</strong></p><p id="cc15" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 1。</span> <strong class="jz hs"> NVL(expr1，expr2): </strong>将空值转换为实际值。在语法<code class="du lj lk ll lm b"><strong class="jz hs">NVL(expr1, expr2),</strong></code> <strong class="jz hs">中，expr1 </strong>是源值或表达式<strong class="jz hs">可能</strong>包含空值，<strong class="jz hs"> expr2 </strong>是目标值，如果在expr1 中发现<strong class="jz hs">空值，则转换/替换空值。语法是，</strong></p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="2cb0" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">NVL(expr1,expr2)</strong></span></pre><p id="bc38" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 2。</span> <strong class="jz hs"> COALESCE(): </strong>该函数返回列表中第一个<strong class="jz hs">非空的</strong>表达式。它首先从左到右检查第一个表达式，如果发现表达式不为空，则返回该表达式，否则它将进行评估，直到找到第一个<strong class="jz hs">非空</strong>参数。非空表达式之后剩余的所有表达式都不会被计算。</p><p id="4bcf" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">COALESCE()函数优于NVL()函数，即COALESCE函数可以采用多个替代值/表达式。只有当列表中的所有表达式都为空时，才会返回空值。语法，</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="29ed" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">COALESCE (expr1, expr2, expr3.............. exprN)</strong></span></pre><p id="ca98" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 3。</span> <strong class="jz hs"> NULLIF(expr1，expr2): </strong> <a class="ae jw" href="https://www.sqltutorial.org/sql-comparison-functions/sql-nullif/" rel="noopener ugc nofollow" target="_blank">这是一个控制流函数，它测试表达式并根据结果评估返回NULL或第一个表达式。它比较两个表达式，如果两个表达式相等，它将返回NULL，如果不相等，它将返回第一个表达式。语法，</a></p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="7671" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">NULLIF (expr1, expr2)</strong></span></pre><p id="2865" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 4。</span> <strong class="jz hs"> NVL2(expr1，expr2，expr3) </strong>:检查第一个表达式，如果expr1(第一个表达式)不为空，则NVL2将返回expr2(第二个表达式)，反之，如果expr1为空，则NVL2将返回expr3。<strong class="jz hs"> </strong>参数expr1可以有任何数据类型。语法，</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="eaf4" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">NVL2 (expr1, expr2, expr3)</strong></span></pre><p id="8c8a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 5。</span> <strong class="jz hs">解码:</strong> <a class="ae jw" href="https://www.sqltutorial.org/sql-comparison-functions/sql-decode/" rel="noopener ugc nofollow" target="_blank">该函数有助于以类似于IF-THEN-ELSE逻辑条件或CASE语句的方式解码表达式。此函数在将表达式与每个搜索值进行比较后对其进行解码。</a></p><p id="cb59" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><a class="ae jw" href="https://www.sqltutorial.org/sql-comparison-functions/sql-decode/" rel="noopener ugc nofollow" target="_blank">如果表达式与搜索值相同，则返回结果。但是如果搜索值与任何结果值都不匹配，那么它将返回默认值，而如果没有提到默认值，它将返回NULL。语法是，</a></p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="387d" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">DECODE(column|expression,</strong> <strong class="lm hs">search1</strong>,<strong class="lm hs"> result1</strong> , <strong class="lm hs">search2</strong>, <strong class="lm hs">result2</strong>,.......<strong class="lm hs">searchN</strong>, <strong class="lm hs">resultN, [</strong>, <strong class="lm hs">default]</strong>)</span></pre><p id="d141" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">因此，这5个是最常用的空函数，现在我们将研究聚合函数。我们一个一个来看。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="1434" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs"> SQL聚合函数:</strong>这些函数接受一组值并返回单个值。因为它对一组值进行操作，所以通常与GROUP BY子句一起使用。执行聚合函数的一般语法是:</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="1b19" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">SELECT</strong> c1, aggregate_fun (c2) <br/><strong class="lm hs">FROM</strong> table<br/><strong class="lm hs">GROUP</strong> BY c1</span></pre><p id="fc84" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">最常用的聚合函数有<strong class="jz hs"/><strong class="jz hs">COUNT()</strong><strong class="jz hs">MAX()</strong><strong class="jz hs">MIN()</strong><strong class="jz hs">SUM()</strong>。除了Count()函数，所有其他函数都忽略空值。理解这些函数的工作是不言自明的，它只是关于理解业务需求和使用正确的语法。让我们简单地浏览一下这些函数。</p></div><div class="ab cl kt ku gp kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="hb hc hd he hf"><p id="6634" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 1。</span>T5】AVG():返回集合中的平均值。寻找一组值的语法是<code class="du lj lk ll lm b"><strong class="jz hs">AVG(All | Distinct)</strong></code>。默认情况下，选择ALL，其中也包括重复值，而为了只查找不同值的平均值，我们使用关键字distinct。显示从雇员表中计算每个部门平均工资的示例。</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="db24" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">SELECT</strong> department_name, <strong class="lm hs">RROUND</strong>(<strong class="lm hs">AVG</strong>(Salary),0) <strong class="lm hs">AS</strong> avg_salary<br/><strong class="lm hs">FROM</strong><br/>employees<br/><strong class="lm hs">GROUP BY</strong> department_name<br/><strong class="lm hs">ORDER BY </strong>department_name</span><span id="0be9" class="lr ls hi lm b fi lx lu l lv lw"><em class="ly">Output:</em><br/><strong class="lm hs"><em class="ly">department_name</em>      <em class="ly">avg_salary</em></strong><em class="ly"><br/>Accounting           10800<br/>Administration       20333<br/>Executive            14500</em></span><span id="5ebc" class="lr ls hi lm b fi lx lu l lv lw"><strong class="lm hs">Note: ROUND</strong> Function have round-off the avg_salary to Zero decimal Places.</span></pre><p id="cb1c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 2。</span> <strong class="jz hs"> COUNT(): </strong>此函数返回集合中的项数。计算值的语法是<code class="du lj lk ll lm b">COUNT(* | DISTINCT)</code>。*用于计算所有值(也包括重复值)，而Distinct仅强制计算集合中存在的不同值。在employee表中查找各部门人数的示例:</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="6fd3" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">SELECT</strong> department_name, <strong class="lm hs">COUNT</strong>(*) <strong class="lm hs">AS</strong> num_employee<br/><strong class="lm hs">FROM</strong><br/>employees<br/><strong class="lm hs">GROUP BY</strong> department_name<br/><strong class="lm hs">ORDER BY </strong>department_name</span><span id="9f8b" class="lr ls hi lm b fi lx lu l lv lw"><em class="ly">Output:</em><br/><strong class="lm hs"><em class="ly">department_name</em>      <em class="ly">num_employee</em></strong><em class="ly"><br/>Accounting           5<br/>Administration       2<br/>Executive            6<br/>Finance              5<br/>IT                   7<br/>Marketing            3<br/>Sales                6</em></span></pre><p id="b285" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 3。</span> <strong class="jz hs"> MAX(): </strong>此函数返回集合中的最大值。从雇员表中查找每个部门雇员最高工资的示例。</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="31ff" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">SELECT</strong> department_name, <strong class="lm hs">MAX</strong>(Salary) <strong class="lm hs">AS</strong> max_salary<br/><strong class="lm hs">FROM </strong>employees <strong class="lm hs">GROUP BY</strong> department_name <strong class="lm hs">ORDER BY </strong>department_name</span><span id="bcf5" class="lr ls hi lm b fi lx lu l lv lw"><em class="ly">Output:</em><br/><strong class="lm hs"><em class="ly">department_name</em>      max<em class="ly">_salary</em></strong><em class="ly"><br/>Accounting           17000<br/>Administration       6000<br/>Executive            5000<br/>Finance              2500</em></span></pre><p id="1ad1" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 4。</span> <strong class="jz hs"> MIN(): </strong>与Max函数类似，MIN()函数用于返回一组值中的最小值/最低值。</p><p id="8732" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> 5。</span> <strong class="jz hs"> SUM(): </strong>返回集合中所有值的总和。语法是<code class="du lj lk ll lm b">SUM ( ALL |DISTINCT)</code>。在按部门分组的雇员表中查找所有雇员的工资总额，</p><pre class="jh ji jj jk fd ln lm lo lp aw lq bi"><span id="f91b" class="lr ls hi lm b fi lt lu l lv lw"><strong class="lm hs">SELECT</strong> department_name, <strong class="lm hs">SUM</strong>(Salary) <strong class="lm hs">AS</strong> total_salary<br/><strong class="lm hs">FROM </strong>employees <strong class="lm hs">GROUP BY</strong> department_name <strong class="lm hs">ORDER BY </strong>department_name</span><span id="2319" class="lr ls hi lm b fi lx lu l lv lw"><em class="ly">Output:</em><br/><strong class="lm hs"><em class="ly">department_name</em>      <em class="ly">total_salary</em></strong><em class="ly"><br/>Accounting           59500<br/>Administration       27800<br/>Executive            57600<br/>Finance              24600</em></span></pre><p id="abef" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">这就是最常用的SQL聚合函数。</p><p id="9550" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在下一篇文章中，我们将研究SQL字符串函数、SQL日期函数和数学函数。</p><p id="88d8" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">继续练习！！</p><p id="5f6b" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">感谢您的阅读！！</p><p id="0061" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">参考资料:</p><div class="lz ma ez fb mb mc"><a href="https://www.sqltutorial.org/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">SQL教程-初学者必备的SQL</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">本SQL教程通过许多实际例子帮助你快速有效地开始使用SQL。如果你是一个…</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">www.sqltutorial.org</p></div></div></div></a></div><div class="lz ma ez fb mb mc"><a href="https://www.geeksforgeeks.org/sql-tutorial/?ref=ghm" rel="noopener  ugc nofollow" target="_blank"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hs fi z dy mh ea eb mi ed ef hr bi translated">SQL教程- GeeksforGeeks</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">结构化查询语言或SQL是一种标准的数据库语言，用于创建、维护和检索数据</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">www.geeksforgeeks.org</p></div></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Hack This Site: Realistic Web Mission — Level 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑掉这个网站:现实的网络任务——10级</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-10-a2ee5e525a7c?source=collection_archive---------13-----------------------#2021-10-07">https://medium.com/geekculture/hack-this-site-realistic-web-mission-level-10-a2ee5e525a7c?source=collection_archive---------13-----------------------#2021-10-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/7c8433f0a4d84d87db61cb7b7685571a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jHXOLdEviL4Q0b2a"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Hack This Site: Realistic Web Mission — Level 10</figcaption></figure><p id="22f2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">哦，你好，真想不到在这里见到你。今天我们来看看<a class="ae js" href="https://hackthissite.org/" rel="noopener ugc nofollow" target="_blank">黑掉这个网站</a>现实网络任务10。换句话说，我们将演示如何不实现认证机制。总的来说，这次任务很有趣。它需要从公开列出的教师名单中创建一个单词表。然后，我们使用这个单词表来暴力破解登录页面，以访问人员控制面板。登录后，我们必须通过修改cookies来将自己标记为管理员。然后，我们修改了一个帖子请求来更改成绩。如果你没有看过我在现实系列上的其他帖子，你可以在这里看到:<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-missions-level-1/" rel="noopener ugc nofollow" target="_blank">第一部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-2/" rel="noopener ugc nofollow" target="_blank">第二部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-3/" rel="noopener ugc nofollow" target="_blank">第三部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-4/" rel="noopener ugc nofollow" target="_blank">第四部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-5/" rel="noopener ugc nofollow" target="_blank">第五部分</a>、<a class="ae js" href="https://haxez.org/2021/09/hack-this-site-realistic-web-mission-level-6/" rel="noopener ugc nofollow" target="_blank">第六部分</a>、<a class="ae js" href="https://haxez.org/2021/10/hack-this-site-realistic-web-mission-level-7/" rel="noopener ugc nofollow" target="_blank">第七部分</a>和<a class="ae js" href="https://haxez.org/2021/10/hack-this-site-realistic-web-mission-level-8/" rel="noopener ugc nofollow" target="_blank">第八部分</a></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/4d2b8123e4df390d0b7d0d5560fd9c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*BYl_7serh71Z71Kq"/></div><figcaption class="iq ir et er es is it bd b be z dx">Holy Word High School</figcaption></figure><h1 id="f508" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="0bce" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">可怜的扎克·桑切斯在学校过得很艰难。其实他不一定能毕业，因为成绩太差了。因此，他给我们发信息，询问我们是否可以侵入他学校的在线成绩数据库，更改他的成绩。此外，他还向我们提供了他的用户名和密码，让我们可以探索这个应用程序。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/de2465fb31dc4130c01efc4136612886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*2jIOlctgK29HWiuu"/></div><figcaption class="iq ir et er es is it bd b be z dx">Message From Zach Sanchez</figcaption></figure><h1 id="9ebe" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">探索Web应用程序</h1><p id="12dc" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">这个应用程序相当简单，它在页面顶部有三个链接，在页面中间有一个链接。从下图可以看出，它没有太多的功能。例如,“主页”按钮让您返回主页，员工列表让您看到用户列表，学生访问系统让您看到登录页面。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/dd67a13b54d1422b609654692ab0b631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*oOuLan9WXO-VWRQT"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Holy Word High School</figcaption></figure><p id="c103" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们单击学生访问系统，就会出现一个登录页面，要求输入用户名和密码。Zach向我们提供了他的登录凭证，所以让我们测试一下，看看它能让我们访问什么。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/4d40b44c854995b30c62a8f5f286b6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*xmdp6-qWS35XucR6"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Authentication Mechanism</figcaption></figure><p id="1cbd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">以Zach的身份登录后，我们并没有获得很多增加的功能。如下图所示，我们可以查看他的班级、他的成绩以及老师留下的任何评论。我们在这没什么能改变他的成绩。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/f5807c374a99cf6c62cce62e23af71be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*j5vVOHy_JdRV-rZ7"/></div><figcaption class="iq ir et er es is it bd b be z dx">Zach Grades</figcaption></figure><p id="e82d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们返回主页，查看应用程序的页面源代码，就会发现有一个对主页上没有显示的页面的引用。值得注意的是，该页面被命名为staff，这表明它可能是工作人员用来登录的页面。也许我们可以使用此页面来访问和更改Zach的分数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/a6d7b1c59d01037604d56161c9912e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*05GXPRH9Ba2H6j_V"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Page Source</figcaption></figure><h1 id="1c07" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Web应用程序暴力</h1><p id="16d2" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">当访问staff.php页面时，我们会看到一个登录表单。虽然我们有一个登录页面，但我们没有任何用于登录的凭据。我已经详细研究了这个应用程序，但没有找到任何其他信息。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/cca38deca39449c15e4d0297ac681eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*dXTifsK6J7z1Gl0q"/></div><figcaption class="iq ir et er es is it bd b be z dx">Staff Authentication</figcaption></figure><p id="0696" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是，我们在教师列表页面上有一份员工名单。记住这一点，也许我们可以使用这个列表来识别应用程序的真正用户。首先，我将用户的名和姓复制到一个文本文件中，并保存为usernames.txt。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/c61abbdecf5e50421700188ec49d0db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*N-o23-n23w8lEi0j"/></div><figcaption class="iq ir et er es is it bd b be z dx">Teacher Listing</figcaption></figure><p id="85d4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">接下来，我从GitHub克隆了<a class="ae js" href="https://github.com/urbanadventurer/username-anarchy" rel="noopener ugc nofollow" target="_blank">用户名-无政府状态</a>库。一下载完存储库，我就告诉它使用名和姓、名和姓以及其他一些组合来生成一个单词表。然后我保存了结果。</p><pre class="ju jv jw jx fd lc ld le lf aw lg bi"><span id="f2a3" class="lh jz hi ld b fi li lj l lk ll">Josephs-MacBook-Pro:username-anarchy Joe$ sudo ./username-anarchy --input-file /Users/Joe/Desktop/usernames.txt --select-format first,first.last,f.last,flast<br/>adam<br/>adam.smith<br/>a.smith<br/>asmith<br/>alfred<br/>alfred.johnson<br/>a.johnson<br/>ajohnson<br/>corey<br/>corey.beelke<br/>c.beelke<br/>cbeelke<br/>edward<br/>edward.anderson<br/>e.anderson<br/>eanderson<br/>gordon<br/>gordon.freeman<br/>g.freeman<br/>gfreeman<br/>henry<br/>henry.mathison<br/>h.mathison<br/>hmathison</span></pre><p id="64e8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，我刷新登录页面，用Burp Suite捕获登录请求。一旦请求被捕获，我就把它发送给入侵者工具。然后，我删除了自动生成的有效负载位置，突出显示了用户名和密码参数值，并添加了有效负载位置。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/b6602df7432de30b286a9f24ba448783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*oRaCuwlMUNkPRVXh"/></div><figcaption class="iq ir et er es is it bd b be z dx">Burp — Intruder</figcaption></figure><h1 id="81ac" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">发起攻击</h1><p id="1070" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">我选择了攻击类型，然后将单词列表中的值粘贴到payloads选项卡上的位置1和2。攻击准备就绪后，我点击了启动攻击按钮。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/90443bea1aed414ed2c547802d2a7fd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*loqO3Dzk8CPpeC3d"/></div><figcaption class="iq ir et er es is it bd b be z dx">Burp — Brute Force</figcaption></figure><p id="e666" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">等了一会儿后，我们找到了正确的用户名和密码组合。正如您在下图中看到的，当提交正确的凭证时，来自应用程序的响应长度是不同的。当提交不正确的凭据时，响应长度都相同(1876)。这是因为来自服务器的响应是相同的。然而，当提交正确的凭证时，响应长度是不同的，因为它正在加载页面。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/ede8d6947993f1427fd8400f416d7e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*Bqh7ZWmr5INv0Ok6"/></div><figcaption class="iq ir et er es is it bd b be z dx">Burp Intruder — Results</figcaption></figure><h1 id="8231" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">登录</h1><p id="c389" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">有了正确的凭证，我们现在可以以Samantha Miller的身份登录员工区。该应用程序的这一区域似乎为我们提供了更多的功能，但不幸的是，我们对它的访问受到限制，因为我们不是管理员。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/fa4d4f067a1f8c61a882b12a5ea2a932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*t7uyeyBJxsxvxZK7"/></div><figcaption class="iq ir et er es is it bd b be z dx">Staff — Control Panel</figcaption></figure><p id="d2c8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了将我们的权限提升到管理员权限，我们需要检查页面并查看我们的cookies。我们可以用打嗝来拦截请求，并为每个请求更改它们，但这将使我们的生活更加困难。下图说明了如何将admin cookie的值从0更改为1。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/a6937d38f65a2eb3ebcaf3d41dcfc1da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*jKYlaKfod2OrKM8m"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Cookies</figcaption></figure><h1 id="745c" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">改变等级</h1><p id="8b50" class="pw-post-body-paragraph iu iv hi iw b ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr hb bi translated">现在我们拥有管理员权限，可以访问“更改等级”选项。不幸的是，现在改成绩已经太晚了，因为成绩马上就要寄出去了。然而，如果我们查看应用程序的源代码，我们可以看到有一个POST方法，其中包括一个change grades函数。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/82fb853e21ce1dfb24d1f94f11ddd58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*80SUwKKYZ3tZPnQU"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Page Source</figcaption></figure><p id="097b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果我们复制POST请求并稍加修改，我们可以将其发送到Burp Repeater并使用它来更改成绩。下面的代码片段显示了post请求，需要修改的值以粗体突出显示。将等级值更改为5，然后将rec值更改为0并发送请求，然后将rec值增加1并再次发送请求。</p><pre class="ju jv jw jx fd lc ld le lf aw lg bi"><span id="4d5b" class="lh jz hi ld b fi li lj l lk ll">staff.php?action=changegrades&amp;changeaction=modrec<strong class="ld hj">&amp;rec=</strong>1&amp;studentid=1&amp;<strong class="ld hj">grade=5</strong></span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/f0376803383645159bf3f5de600943ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*8oICliwn0gUkKRv2"/></div><figcaption class="iq ir et er es is it bd b be z dx">Burp — Repeater</figcaption></figure><p id="30f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您可以继续修改和发送请求，直到响应从提交的等级变为完成任务的祝贺消息。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/768a9c09ede88b4ee286c80add7a3a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*IZbcIRfFYW3GjMZ3"/></div><figcaption class="iq ir et er es is it bd b be z dx">Burp Response — Grades Updated</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/32add01f4de38dcd24c6d8c31d9c5bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*FupGjWp4KXJctgBY"/></div><figcaption class="iq ir et er es is it bd b be z dx">Web Application — Grades Updated</figcaption></figure><p id="54e7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">就这样，你应该完成了信息。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/46282a821819257fe902e7c331c6a1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/0*8-x_P9x_JpijYO2f"/></div><figcaption class="iq ir et er es is it bd b be z dx">Congratulations</figcaption></figure><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="ln lo l"/></div></figure></div></div>    
</body>
</html>
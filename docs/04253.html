<html>
<head>
<title>Building an Idea Tracker application with Flutter and Firebase</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Flutter和Firebase构建一个Idea Tracker应用程序</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/building-an-idea-tracker-application-with-flutter-and-firebase-4474a9f87ad6?source=collection_archive---------20-----------------------#2021-06-23">https://medium.com/geekculture/building-an-idea-tracker-application-with-flutter-and-firebase-4474a9f87ad6?source=collection_archive---------20-----------------------#2021-06-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/58ae5b796b577dd9a6aab697a337381e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npr7ea8nsm01ybHINohE3A.png"/></div></div></figure><div class="iq ir is it fd ab cb"><figure class="iu ij iv iw ix iy iz paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ada807fd88b066aeba6af647d19453ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/1*-XRVvG_6BKip4Mc4N3lpng.gif"/></div></figure><figure class="iu ij iv iw ix iy iz paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/a59e17ed02a398c7d29449b84c874232.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/1*6y5NKdWKcKEXUgzTPdh8Dw.gif"/></div></figure><figure class="iu ij iv iw ix iy iz paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/f99f728c73319bfe76f8b4f94c68602b.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/1*K__YTEsrfalspE92TzSCUQ.gif"/></div></figure></div><p id="b456" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">了解如何在Flutter中实现Firebase组件，方法是构建一个idea tracker应用程序，帮助用户跟踪新的商业想法/机会，提供上传和获取特定于每个想法的文档的选项。</p><p id="6178" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><a class="ae jy" href="https://flutter.dev/" rel="noopener ugc nofollow" target="_blank"> Flutter </a>是Google为轻松构建跨平台应用而制作的工具包。</p><p id="3bf3" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">Firebase是谷歌的一款产品，可以帮助开发者轻松构建、管理和开发他们的应用。它附带了许多预打包的服务，为开发人员节省了很多麻烦和时间。FireBase的一些特性有:使用Firebase认证的用户认证，使用云FireStore的NoSQL实时数据库，使用Firebase存储的文件存储等。我们将使用这些特性来构建我们的应用程序。</p><p id="1878" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">在本教程中，我将展示如何建立一个有4个屏幕的想法跟踪器应用程序:</p><ol class=""><li id="5bb4" class="jz ka hi jc b jd je jh ji jl kb jp kc jt kd jx ke kf kg kh bi translated"><strong class="jc hj">闪屏:</strong>这个自定义闪屏将被用作这个应用程序的闪屏。</li><li id="077e" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><strong class="jc hj">欢迎屏幕:</strong>该屏幕将用于输入用户电话号码，并使用Firebase身份验证对其进行身份验证。每次用户试图登录时，Firebase都会向输入的电话号码发送一个唯一的6位验证码。身份验证后，用户将被重定向到他/她自己的控制面板。</li><li id="66f1" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><strong class="jc hj"> DashBoard: </strong>这是默认屏幕，如果用户已经在任何以前的实例中登录到应用程序，就会显示该屏幕。用户可以选择查看现有的想法，添加新的想法，更新/删除现有的想法，并为每个想法上传新的文档到Firebase存储。</li><li id="ee9e" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><strong class="jc hj">查看文件屏幕:</strong>该屏幕将用于显示每个用户上传的文件。对于每个现有建议，每个查看文件屏幕都是唯一的。用户可以选择从该屏幕下载和删除文档。</li></ol><h1 id="fe5b" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1.先决条件</h1><ol class=""><li id="1f37" class="jz ka hi jc b jd ll jh lm jl ln jp lo jt lp jx ke kf kg kh bi translated">在开始之前，请确保在您的机器上安装了Flutter。你可以按照<a class="ae jy" href="https://flutter.dev/docs/get-started/install" rel="noopener ugc nofollow" target="_blank">颤振安装指南</a>来做。</li><li id="e2f1" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated">创建一个新的Flutter项目，删除所有不必要的代码。</li></ol><pre class="iq ir is it fd lq lr ls lt aw lu bi"><span id="2926" class="lv ko hi lr b fi lw lx l ly lz">flutter create idea_tracker</span></pre><p id="e4d5" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">二。或者你可以从:<a class="ae jy" href="https://github.com/birat051/ideatracker" rel="noopener ugc nofollow" target="_blank"> idea tracker仓库</a>中克隆GitHub仓库。</p><p id="5816" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">3.添加步骤1.2中提到的包。到pubspec.yaml文件并运行:</p><pre class="iq ir is it fd lq lr ls lt aw lu bi"><span id="66dd" class="lv ko hi lr b fi lw lx l ly lz">flutter pub get</span></pre><p id="c5ae" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">4.下一步是使用你的谷歌帐户登录Firebase，并创建一个新的Firebase应用程序。您可以按照<a class="ae jy" href="https://firebase.google.com/docs/flutter/setup" rel="noopener ugc nofollow" target="_blank">firebase setup with flutter</a>中提到的步骤将fire base应用程序添加到您的Flutter项目中。</p><h1 id="ad1f" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1.1.项目文件结构</h1><pre class="iq ir is it fd lq lr ls lt aw lu bi"><span id="8c6b" class="lv ko hi lr b fi lw lx l ly lz">Lib // root folder of all dart files in a Flutter app<br/>|_ services<br/>|____ dbservice.dart<br/>|____ deleteanddownloadfiles.dart<br/>|____ getcloudfiles.dart<br/>|____ uploadfiles.dart</span><span id="c3c5" class="lv ko hi lr b fi ma lx l ly lz">|_ components<br/>|____ addtask.dart<br/>|____ cloudfiles.dart<br/>|____ ideacount.dart<br/>|____ idealist.dart<br/>|____ rounded_button.dart<br/>|____ select_priority.dart<br/>|____ sidenavigation.dart<br/>|____ updatetask.dart</span><span id="e219" class="lv ko hi lr b fi ma lx l ly lz">|_ screens<br/>|____ chooselogin.dart<br/>|____ dashboard.dart<br/>|____ splash_screen.dart<br/>|____ viewfiles.dart<br/>|____ welcomescreen.dart</span><span id="5478" class="lv ko hi lr b fi ma lx l ly lz">|_ utilities<br/>|____ constants.dart</span><span id="8052" class="lv ko hi lr b fi ma lx l ly lz">|_ main.dart</span></pre><p id="4061" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">这就是我们的项目结构的样子。我们将通过在服务目录下创建单独的dart文件，将UI组件与UI屏幕分开，并创建单独的directories.Reading/writing来处理服务。所有可重复使用的常量(不同的文本样式)都将在utilities目录下的constants.dart文件中定义。</p><h1 id="5bb8" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1.2.包和依赖项</h1><p id="0141" class="pw-post-body-paragraph ja jb hi jc b jd ll jf jg jh lm jj jk jl mb jn jo jp mc jr js jt md jv jw jx hb bi translated">在Flutter中，我们可以在项目中导入第三方包来添加额外的功能，而无需从头开始创建这些功能。<a class="ae jy" href="https://pub.dev/" rel="noopener ugc nofollow" target="_blank"> pub.dev </a>网站包含一个你可以在你的项目中使用的flutter包列表。要使用一个包，我们只需在<code class="du me mf mg lr b">pubspec.yaml</code>文件中添加包名和版本，如下所示。继续在您的文件中添加以下家属。</p><pre class="iq ir is it fd lq lr ls lt aw lu bi"><span id="5feb" class="lv ko hi lr b fi lw lx l ly lz">firebase_auth: ^1.2.0<br/>cloud_firestore: ^2.2.0<br/>firebase_core: ^1.2.0<br/>animated_text_kit: ^4.2.1<br/>loading_overlay: ^0.3.0<br/>font_awesome_flutter: ^9.0.0<br/>flutter_slidable: ^0.6.0<br/>firebase_storage: ^8.1.1<br/>file_picker: ^3.0.2+2<br/>url_launcher: ^6.0.6</span></pre><ol class=""><li id="0f1d" class="jz ka hi jc b jd je jh ji jl kb jp kc jt kd jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/firebase_auth" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">firebase _ auth</strong></a><strong class="jc hj">:</strong>这个包用于在Flutter中实现Firebase认证。我们将使用此包中的身份验证API使用我们的电话号码登录，并检查当前用户。</li><li id="b9e4" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/cloud_firestore" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">Cloud _ firestore</strong></a><strong class="jc hj">:</strong>这个包用来实现Flutter中的云FireStore。我们将使用FireStore APIs将想法以集合的形式存储在FireStore DB中，并对它们执行更新/删除操作。</li><li id="427e" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/firebase_core" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">FireBase _ Core</strong></a><strong class="jc hj">:</strong>这个包用来实现flutter中的FireBase Core API。我们将使用这个API来连接到我们的FireBase应用程序。</li><li id="8ca0" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/animated_text_kit" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">animated _ text _ kit</strong></a><strong class="jc hj">:</strong>自带预打包的文字动画。我们将在欢迎屏幕中使用它来显示文本动画，而不是从头开始构建。</li><li id="2330" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/loading_overlay" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">loading _ overlay</strong></a><strong class="jc hj">:</strong>提供了使用模态进度HUD的高级包装器。我们将用它来显示一个用户认证时的加载屏幕。</li><li id="bbe6" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/font_awesome_flutter" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">Font _ Awesome _ flutter</strong></a><strong class="jc hj">:</strong>使我们能够使用<a class="ae jy" href="https://fontawesome.com/icons" rel="noopener ugc nofollow" target="_blank"> Font Awesome </a>图标包。我们将使用仪表板中的图标在AppBar上显示一个非常棒的徽标。</li><li id="2f78" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/flutter_slidable" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">flutter _ slide</strong></a><strong class="jc hj">:</strong>可滑动列表项的Flutter实现，具有可解除的方向滑动动作。我们将实现每个想法作为一个可滑动的小工具，增加了更新，删除，查看和上传附件的选项。</li><li id="b6cb" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/firebase_storage" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">firebase _ Storage</strong></a><strong class="jc hj">:</strong>这个包为我们提供了在Flutter中实现Firebase存储的高级API。我们将使用这个API从Firebase存储中上传、删除和检索附件。</li><li id="e33c" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/file_picker" rel="noopener ugc nofollow" target="_blank"> <strong class="jc hj"> file_picker: </strong> </a>我们将使用这个包来实现原生文件资源管理器，以选择添加了扩展名过滤支持的文件，即:PDF。</li><li id="e5b4" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx ke kf kg kh bi translated"><a class="ae jy" href="https://pub.dev/packages/url_launcher" rel="noopener ugc nofollow" target="_blank"><strong class="jc hj">url _ launcher:</strong></a>我们将使用这个包将从Firebase存储器中获取的下载URL启动到浏览器中。浏览器会负责文件下载。</li></ol><h1 id="1a7c" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">2.构建欢迎屏幕和电话号码认证</h1><p id="967a" class="pw-post-body-paragraph ja jb hi jc b jd ll jf jg jh lm jj jk jl mb jn jo jp mc jr js jt md jv jw jx hb bi translated"><strong class="jc hj"> 2.1。在欢迎屏幕中显示应用程序名称的文本动画:</strong>在欢迎屏幕中，我们将使用来自<a class="ae jy" href="https://pub.dev/packages/animated_text_kit" rel="noopener ugc nofollow" target="_blank"> animated_text_kit </a>的TypewriterAnimatedText设置一个预打包的文本动画。下面是我们使用这个小部件显示文本动画的代码片段。</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="5201" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 2.2。构建电话认证系统:</strong>在Flutter中使用FireBase设置电话认证在<a class="ae jy" href="https://firebase.flutter.dev/docs/auth/phone/" rel="noopener ugc nofollow" target="_blank"> Flutter Fire </a>网站中有生动的记载。我们将使用“Firebaseauth.verifyPhoneNumber”来验证使用电话号码的用户。该过程需要四个参数:</p><blockquote class="mj mk ml"><p id="45c1" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">2.1.电话号码:您提供电话号码。</p><p id="2171" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">2.2.<strong class="jc hj">验证完成:</strong>定义验证完成后要遵循的步骤。</p><p id="d88b" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">2.3.<strong class="jc hj">超时:</strong>设置OTP的有效期。</p><p id="f77a" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">2.4.<strong class="jc hj"> codeSent: </strong>定义代码发送给用户进一步验证后的步骤。在codeSent中，我们将使用输入的验证码和电话号码创建一个AuthCredential对象来登录我们的应用程序。</p><p id="a5e6" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">2.5.<strong class="jc hj">codeAutoRetrievalTimeout:</strong>处理超时，自动短信代码处理失败。</p></blockquote><p id="14fd" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">完整的代码片段可以在下面找到:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="ebc8" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 2.3。验证用户身份时显示加载屏幕:</strong>我们将使用LoadingOverlay小部件在验证用户身份时显示一个模态HUD。小部件通过使用“_saving”变量呈现。在进行身份验证时，我们在setState((){})中将该属性设置为true，以呈现模式HUD。</p><h1 id="0d25" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">3.构建仪表板</h1><p id="9bae" class="pw-post-body-paragraph ja jb hi jc b jd ll jf jg jh lm jj jk jl mb jn jo jp mc jr js jt md jv jw jx hb bi translated"><strong class="jc hj"> 3.1。添加新想法:</strong>将使用BottomSheet小部件添加新想法，其代码片段可以在:<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/components/addtask.dart" rel="noopener ugc nofollow" target="_blank">添加任务小部件</a>中找到。</p><p id="2bc7" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 3.1.1。创建一个类来创建/更新和删除FireStore中的数据:</strong>在继续下一步之前，请确保您已经在Cloud FireStore中创建了一个新集合。在我的例子中，这个集合的名称是“ideacollection”。</p><p id="c6cf" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">我们将在<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/dbservice.dart" rel="noopener ugc nofollow" target="_blank">services/dbservice . dart</a>中创建一个类来添加新想法，以及从“ideacollection”中删除/更新现有想法。我们将为“ideacollection”中的每个文档记录创建三个字段。这些字段是:</p><blockquote class="mj mk ml"><p id="4df3" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.1.1.1.<strong class="jc hj">创意:</strong>创意名称。</p><p id="dbcb" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.1.1.2.<strong class="jc hj">优先级:</strong>优先级可以是“高”、“正常”和“低”。这由用户在<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/components/addtask.dart" rel="noopener ugc nofollow" target="_blank">添加任务小部件</a>中的下拉菜单中选择。</p><p id="50a8" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.1.1.3.<strong class="jc hj">用户:</strong>用户的电话号码将被发送到该字段，以创建特定于用户的记录。</p></blockquote><p id="5f1a" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">以下是在FireStore collection中添加、删除和更新创意的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="6fe5" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 3.2。查看想法:</strong>我们将使用仪表板中的StreamBuilder从FireStore Cloud为我们的登录用户获取想法。这提供了所有想法的实时视图，包括对新想法的添加、删除或更新。使用StreamBuilder查看数据的代码片段如下:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="eed9" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 3.3。将每个想法实现为可滑动的小部件:</strong>我们将每个想法实现为可滑动的小部件。滑动时，用户将看到4个选项:</p><p id="68d4" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">3.3.1。更新想法:使用类似于<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/components/addtask.dart" rel="noopener ugc nofollow" target="_blank">添加任务小部件</a>的底部表单小部件来更新想法。点击此处进入<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/components/updatetask.dart" rel="noopener ugc nofollow" target="_blank">更新任务小工具</a>。将使用我们之前创建的<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/dbservice.dart" rel="noopener ugc nofollow" target="_blank"> DBStorage </a>类中的<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/dbservice.dart" rel="noopener ugc nofollow" target="_blank"> updateIdea </a>函数更新FireStore集合中的数据。</p><p id="a03d" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 3.3.2。删除想法:</strong>点击此选项将从<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/dbservice.dart" rel="noopener ugc nofollow" target="_blank"> DBStorage </a>类中调用<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/dbservice.dart" rel="noopener ugc nofollow" target="_blank"> deleteIdea </a>函数，这将从“ideacollection”中删除文档记录。</p><p id="74e6" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 3.3.3。上传附件:</strong>我们将使用类<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/uploadfiles.dart" rel="noopener ugc nofollow" target="_blank"> UploadFiles </a>在services目录中创建一个新的dart文件，以提示用户从设备的FileExplorer中选择一个文档，然后该文档将被上传到FirebaseStorage。</p><blockquote class="mj mk ml"><p id="0e88" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.3.3.1.我们将使用<a class="ae jy" href="https://pub.dev/packages/file_picker" rel="noopener ugc nofollow" target="_blank"> file_picker </a>包中的<a class="ae jy" href="https://pub.dev/packages/file_picker" rel="noopener ugc nofollow" target="_blank">file picker . platform . pick files</a>从文件资源管理器中选取文件。</p><p id="735e" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.3.3.2.默认情况下，FireBaseStorage没有为应用程序存储用户特定的数据。我们将使用自定义逻辑，为每个用户创建一个目录，为每个想法创建一个子目录，并在目录中上传与该想法相关的文档。文档将上传到以下目录:</p><p id="1a82" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">/ <user_name> / <idea_name> / <your filename=""/></idea_name></user_name></p><p id="48f8" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">3.3.3.3.上传文件到FirebaseStorage不需要我们做额外的设置。为了上传获取的文件，我们将使用storage.ref(您的目录名)。从<a class="ae jy" href="https://pub.dev/packages/firebase_storage" rel="noopener ugc nofollow" target="_blank"> firebase_storage </a>包中放一个文件(文件名)到firebase存储器。</p></blockquote><p id="bf7b" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是UploadFiles类的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="79fa" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">3.3.4。查看上传的附件:点击此选项，用户将被重定向至查看文件屏幕，在此用户可以查看意见的所有上传附件。</p><p id="72f4" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是可滑动小部件实现的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><h1 id="9471" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">4.构建查看文件屏幕</h1><p id="1509" class="pw-post-body-paragraph ja jb hi jc b jd ll jf jg jh lm jj jk jl mb jn jo jp mc jr js jt md jv jw jx hb bi translated">我们将创建一个新的<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/screens/viewfiles.dart" rel="noopener ugc nofollow" target="_blank">视图文件</a>小部件，使用FutureBuilder从Firebase存储中检索上传的附件。现在为什么用<a class="ae jy" href="https://api.flutter.dev/flutter/widgets/FutureBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> FutureBuilder </a>而不是StreamBuilder？这是因为FirebaseStorage不像Cloud FireStore那样提供实时数据。我们将使用一个FutureBuilder并从<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/getcloudfiles.dart" rel="noopener ugc nofollow" target="_blank"> GetCloudFiles() </a>类(在services目录下创建)中调用<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/getcloudfiles.dart" rel="noopener ugc nofollow" target="_blank"> getFileNames() </a>方法来检索每个文件的文件路径。</p><p id="16cc" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是GetCloudFiles()类的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="db0e" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">使用FutureBuilder显示文件名的代码片段如下:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="f1b8" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">对于ViewFiles小部件中显示的每个附件，我们将为用户提供两个选项:</p><p id="3efc" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 4.1。下载附件:</strong>我们将在services目录中创建一个新的dart(deleteanddownloadfiles . dart)文件，使用DeleteandDownloadFiles类来删除和下载附件。</p><p id="0edf" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">对于下载附件，我们将使用<a class="ae jy" href="https://firebase.flutter.dev/docs/storage/usage/" rel="noopener ugc nofollow" target="_blank">firebase storage . instance . ref(&lt;file path&gt;)检索该附件的下载URL。getDownloadURL() </a>。</p><p id="becf" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">然后我们将使用<a class="ae jy" href="https://pub.dev/packages/url_launcher" rel="noopener ugc nofollow" target="_blank"> url_launcher </a>包中的launch( <download url="">)函数在浏览器中打开这个URL。浏览器将负责下载过程。</download></p><p id="3594" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是从FireBase存储中获取下载URL和下载文件的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="7d64" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated"><strong class="jc hj"> 4.2。删除附件:</strong>在DeleteandDownloadFiles类中，我们将创建另一个方法<a class="ae jy" href="https://github.com/birat051/ideatracker/blob/master/lib/services/deleteanddownloadfiles.dart" rel="noopener ugc nofollow" target="_blank"> deletefromStorage() </a>，使用FireBase Storage . instance . ref(&lt;file path&gt;)从FireBase存储中删除附件。删除()。</p><p id="ac20" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是从Firebase存储中删除附件的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><blockquote class="mj mk ml"><p id="0e1f" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated">我们现在已经学会了如何从FireBase存储中下载和删除文件。但是，您认为ViewFiles widget会完美地显示删除附件后的更新列表吗？简单的回答是不会。</p><p id="3216" class="ja jb mm jc b jd je jf jg jh ji jj jk mn jm jn jo mo jq jr js mp ju jv jw jx hb bi translated"><a class="ae jy" href="https://api.flutter.dev/flutter/widgets/FutureBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> FutureBuilder </a>小部件将只监听一次异步数据并建立列表。附件列表是使用从<a class="ae jy" href="https://api.flutter.dev/flutter/widgets/FutureBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> FutureBuilder </a>接收的异步快照构建的。我们解决了这个问题，并通过定期调用附件列表的setState(){ &lt;变量名&gt; }来强制FutureBuilder定期从FireBase存储中检索文件名并重建列表，从而使<a class="ae jy" href="https://api.flutter.dev/flutter/widgets/FutureBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> FutureBuilder </a>的行为类似于<a class="ae jy" href="https://api.flutter.dev/flutter/widgets/StreamBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> StreamBuilder </a>。</p></blockquote><p id="eba4" class="pw-post-body-paragraph ja jb hi jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx hb bi translated">下面是定期侦听FirebaseStorage数据并重建列表的代码片段:</p><figure class="iq ir is it fd ij"><div class="bz dy l di"><div class="mh mi l"/></div></figure><h1 id="7ffd" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">5.结论</h1><ul class=""><li id="a50c" class="jz ka hi jc b jd ll jh lm jl ln jp lo jt lp jx mq kf kg kh bi translated">这个项目的完整源代码可以在<a class="ae jy" href="https://github.com/birat051/ideatracker" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</li><li id="ff5d" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx mq kf kg kh bi translated">大多数复杂的后端工作，如身份验证、数据库管理和文件存储，只需很少的配置和调整就可以由FireBase处理。点击阅读更多关于<a class="ae jy" href="https://firebase.flutter.dev/docs/overview" rel="noopener ugc nofollow" target="_blank"> Firebase与Flutter </a>的集成。</li><li id="360b" class="jz ka hi jc b jd ki jh kj jl kk jp kl jt km jx mq kf kg kh bi translated">从官方<a class="ae jy" href="https://www.youtube.com/channel/UCwXdFgeE9KYzlDdR7TG9cMw" rel="noopener ugc nofollow" target="_blank"> Flutter频道</a>的youtube视频中了解更多关于<a class="ae jy" href="https://www.youtube.com/watch?v=nQBpOIHE4eE" rel="noopener ugc nofollow" target="_blank">流和未来</a>的信息。</li></ul></div></div>    
</body>
</html>
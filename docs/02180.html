<html>
<head>
<title>How to Analyze Amazon Reviews: Climbing Shoe Sentiment Analysis in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何分析亚马逊评论:Python中的登山鞋情绪分析</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/analyzing-rock-climbing-shoe-amazon-reviews-cb3e12c91a67?source=collection_archive---------20-----------------------#2021-05-06">https://medium.com/geekculture/analyzing-rock-climbing-shoe-amazon-reviews-cb3e12c91a67?source=collection_archive---------20-----------------------#2021-05-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="5c97" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">基于用户评论使用自然语言处理的能力来识别顶级鞋模</h2></div></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><p id="c5e2" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">完整的代码可以在我的<a class="ae ka" href="https://github.com/kokkeanshern/blogpost_rockclimbingnlp" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/3a6773256a2ed2852ba084828bfa3182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-fH4kU57wLd1bD4JVEujvw.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Photo by <a class="ae ka" href="https://unsplash.com/@worldsbetweenlines?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Patrick Hendry</a> on <a class="ae ka" href="https://unsplash.com/s/photos/rock-climbing-shoes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="ca21" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated"><strong class="ak">简介</strong></h1><p id="d127" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">那些已经熟悉这项运动的人会知道，穿一双完全合脚的攀岩鞋是多么重要。不合脚的鞋子会在很多方面带来灾难。作为一项小众运动，买一双合身的鞋并不像走进商店试穿那样容易。根据一个人居住的国家，出售登山鞋的商店可能少之又少。这就是为什么许多人求助于网上购买。</p><p id="9963" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然而，买一双不是一件容易的事，梳理数百条评论肯定会让我们中最系统的人疲惫不堪。因此，在这篇文章中，我对尽可能多的亚马逊攀岩鞋评论进行了探索性分析。</p><h1 id="59ee" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">网络搜集数据集:亚马逊评论</h1><p id="0a41" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">为此，我使用Python中的Selenium库。我将把web抓取过程分成多个部分。</p><h2 id="c1f5" class="lo ks hi bd kt lp lq lr kx ls lt lu lb jn lv lw ld jr lx ly lf jv lz ma lh mb bi translated">第1部分:获取产品URL</h2><p id="1591" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">与大多数Selenium任务一样，第一步是初始化webdriver。在我的例子中，我使用了谷歌Chrome网络驱动，你可以在这里下载<a class="ae ka" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank"/>。下面的代码用于初始化Chrome webdriver。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="a136" class="lo ks hi md b fi mh mi l mj mk">from selenium import webdriver<br/>driver_path = &lt;path to your chromedriver&gt;<br/>driver = webdriver.Chrome(executable_path=driver_path)</span></pre><p id="541d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">接下来，我使用<em class="ml"> get() </em>方法访问亚马逊网站。为了避免模拟输入搜索查询和击键，我简单地将搜索查询附加到基本URL上。用户搜索产生的网页(结果页面)具有以下格式:<a class="ae ka" href="https://www.amazon.com/s?k=" rel="noopener ugc nofollow" target="_blank"><em class="ml">https://www.amazon.com/s?k=</em></a><em class="ml">&lt;您的查询在此&gt;。</em></p><p id="d276" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">运行以下代码会打开搜索查询“la sportiva攀岩鞋”的亚马逊结果页面。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="3224" class="lo ks hi md b fi mh mi l mj mk">base_url = 'https://www.amazon.com/'<br/>query = 'la sportiva climbing shoe'<br/>query_url = base_url+'s?k='+query<br/>driver.get(query_url)</span></pre><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mm"><img src="../Images/fa4949e5084bccf167a60c96aa80f825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFwh3B_F9HVLGJrRg6dgwQ.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Screenshot of Amazon’s results page</figcaption></figure><p id="409b" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">下一步是将页面上的所有URL抓取并写入一个文件，然后转到下一页结果。如此重复，直到最后的结果页面。我为这个过程创建了几个实用函数。</p><p id="5dd0" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这个函数将一个字符串写入一个文件。参数“a”指定创建新文件(如果尚未创建)或写入现有文件。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="0075" class="lo ks hi md b fi mh mi l mj mk">def write_to_file(filename,content):<br/>      f = open(filename, "a")<br/>      f.write(content+'\n')<br/>      f.close()</span></pre><p id="8426" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这个函数抓取当前页面上的所有URL。然后，如果URL中包含单词“climbing”和“shoe ”,它会将URL写入文件<em class="ml"> links.txt </em>(使用write_to_file实用程序函数)。添加了一个附加条件来只计算字符串(<em class="ml"> type(link) == str </em>)，以避免Python NoneType错误，这是由Selenium拾取NoneType对象引起的。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="850f" class="lo ks hi md b fi mh mi l mj mk">def get_all_urls():<br/>        # identify elements with tagname &lt;a&gt;<br/>        links = driver.find_elements_by_tag_name("a")<br/>        # traverse list<br/>        for link in links:<br/>            # get_attribute() to get all href<br/>            link = link.get_attribute('href')<br/>            if (type(link) == str) and ('climbing' in link) and ('shoe' in link):<br/>                write_to_file('links.txt',link)</span></pre><p id="05e3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">综合所有这些，我们从评估结果页面的数量开始。在<a class="ae ka" href="https://www.google.com/search?q=dom+tree&amp;rlz=1C1CHBF_enMY839MY839&amp;oq=DOM+tree&amp;aqs=chrome.0.0l2j0i20i263j0l3j0i20i263j0l3.1738j0j7&amp;sourceid=chrome&amp;ie=UTF-8" rel="noopener ugc nofollow" target="_blank"> DOM树</a>中，数字由类“a-normal”表示。我使用<em class="ml">find _ elements _ by _ class _ name</em>方法获得所有数字(在本例中是1到5)，然后将最后一个数字赋给变量<em class="ml"> last_page </em> ( <em class="ml">)。text </em>提取实际的文本值，并将其转换为int变量)。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mn"><img src="../Images/add51c593034397423b5a4a240ecc5b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*i_WK0Mlg0wd_LkrnWuDzqQ.jpeg"/></div><figcaption class="kn ko et er es kp kq bd b be z dx">Amazon’s page navigation buttons</figcaption></figure><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="1cda" class="lo ks hi md b fi mh mi l mj mk">pages = driver.find_elements_by_class_name("a-normal")<br/>last_page = int(pages[-1].text)</span></pre><p id="0d42" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将前面两行放入一个函数中，我通过遍历结果页面来抓取URL。亚马逊的每个递增页码的URL结构是与搜索查询和页码连接的基本URL，如下所示:<a class="ae ka" href="https://www.amazon.com/s?k={query}&amp;page={page" rel="noopener ugc nofollow" target="_blank"><em class="ml">https://www.amazon.com/s?k={query}&amp;page = { page</em></a><em class="ml">number }</em>。添加了一个异常处理程序，以防结果只有一页(页将评估为空列表)。其他顶级攀岩鞋品牌<em class="ml"> Ocun </em>、<em class="ml"> Five Ten </em>、<em class="ml"> Tenaya </em>、<em class="ml">黑钻</em>、<em class="ml"> Scarpa </em>、<em class="ml"> Mad Rock </em>、<em class="ml"> Evolv </em>和<em class="ml"> Climb X </em>也重复了这一过程。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="314b" class="lo ks hi md b fi mh mi l mj mk">def iterate_pages():<br/>      pages = driver.find_elements_by_class_name("a-normal")<br/>          try:<br/>              last_page = int(pages[-1].text)<br/>              # base_url would evaluate to ...amazon.com/s?k=&lt;query&gt;<br/>              base_url = driver.current_url<br/>              for page in range(2,last_page+1):<br/>                  get_all_urls()<br/>                  driver.get(base_url+'&amp;page='+str(page))<br/>          except IndexError:<br/>              get_all_urls()</span></pre><p id="6229" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第一次抓取产生了2655个URL。然而，需要额外的清理来过滤掉不需要的URL。检查以下不需要的URL示例:</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="cbcd" class="lo ks hi md b fi mh mi l mj mk">https://www.amazon.com/gp/slredirect/picassoRedirect.html/ref=pa_sp_mtf_aps_sr_pg1_1?ie=UTF8&amp;adId=A0187488H7LAC5K25U1L&amp;url=%2FTenaya-Oasi-Climbing-Shoe-Womens%2Fdp%2FB00G2G1U5U%2Fref%3Dsr_1_14_sspa%3Fdchild%3D1%26keywords%3Dtenaya%2Bclimbing%2Bshoe%26qid%3D1618629457%26sr%3D8-14-spons%26psc%3D1&amp;qualifier=1618629457&amp;id=3206048678566111&amp;widgetName=sp_mtf<br/>https://www.amazon.com/s?k=five+ten+climbing+shoe#<br/>https://www.amazon.com/s?k=mad+rock+climbing+shoe#s-skipLinkTargetForFilterOptions<br/>https://www.amazon.com/s?k=mad+rock+climbing+shoe#s-skipLinkTargetForMainSearchResults<br/>https://aax-us-east.amazon-adsystem.com/x/c/QmbTjAA2xKm5MsGgE8COatYAAAF43dZjkQEAAAH2AQqX8gE/https://www.amazon.com/stores/page/5F070E5E-577B-4B70-956A-02731ECF176A?store_ref=SB_A0421652LWRFVMVX8W4I&amp;pd_rd_w=fsNZy&amp;pf_rd_p=eec71719-2cb3-403b-a8de-e6266852cdb6&amp;pd_rd_wg=uFHFp&amp;pf_rd_r=5E5ZWZNV7GCVDNKR9EC7&amp;pd_rd_r=a8ad5a25-3cd0-4a36-a529-3000b5271936&amp;aaxitk=4VreBt7wvxz.JYuyg-2dbQ&amp;hsa_cr_id=7601608740401&amp;lp_asins=B07BJZTWGR,B07BKRBH7B,B07FQ5CYTK&amp;lp_query=mad%20rock%20climbing%20shoe&amp;lp_slot=desktop-hsa-3psl&amp;ref_=sbx_be_s_3psl_mbd</span></pre><p id="97fe" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第一个URL实际上是一个链接到类似产品的广告(这些是指在结果页面上有<em class="ml">赞助商</em>标签的产品)。第二、第三和第四个URL指向结果页面，而不是单个产品的页面。最后一个网址也是广告网址。</p><p id="a6d3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在让我们将它与<strong class="jg hj">指向特定产品页面的URL进行比较。</strong></p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="0594" class="lo ks hi md b fi mh mi l mj mk">https://www.amazon.com/Mad-Rock-Lotus-Climbing-Shoes/dp/B00L8BT7P4/ref=sr_1_15?dchild=1&amp;keywords=mad%2Brock%2Bclimbing%2Bshoe&amp;qid=1618629518&amp;sr=8-15&amp;th=1<br/>https://www.amazon.com/SCARPA-Instinct-SR-Climbing-Shoe/dp/B07PW8ZLHN/ref=sr_1_93?dchild=1&amp;keywords=scarpa+climbing+shoe&amp;qid=1618629505&amp;sr=8-93<br/>https://www.amazon.com/Climb-Apex-Climbing-Shoe-Yellow/dp/B07MQ79LNZ/ref=sr_1_9?dchild=1&amp;keywords=climb+x+climbing+shoe&amp;qid=1618629539&amp;sr=8-9</span></pre><p id="cb58" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">第一个观察是干净的URL不包含<em class="ml"> slredirect </em>或【picassoRedirect.html】T2。接下来，如果我们分解干净URL的结构，可以看到URL的前两部分是基本URL，后面是产品名称。这与那些有查询能指的“脏”URL形成了对比，<em class="ml"> s？k= </em>，就在基本URL之后。另一个观察结果是，产品URL以<a class="ae ka" href="https://www.amazon.com/" rel="noopener ugc nofollow" target="_blank"><em class="ml">【https://www.amazon.com/】</em></a>开头，这与脏URL的最后一个示例形成对比，后者不包含该字符串作为其基本URL。因此，使用<a class="ae ka" href="https://en.wikipedia.org/wiki/Regular_expression" rel="noopener ugc nofollow" target="_blank"> regex </a>实现了一些简单的数据清理来过滤掉这些脏URL。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="2d8f" class="lo ks hi md b fi mh mi l mj mk"># Remove sponsored product URLs.<br/>re.search('slredirect',line.strip("\n")):<br/># Remove results page URLs.<br/>re.search('s?k=',line.strip("\n")):<br/># Remove URLs that do not start with base URL.<br/>line.strip("\n").startswith("https://www.amazon.com"):<br/># Remove URLs with gp or ap following its base URL.<br/>re.search('https://www.amazon.com/gp/',line.strip("\n")):<br/>re.search('https://www.amazon.com/ap/',line.strip("\n")):</span></pre><p id="71f0" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">除此之外，还有许多URL指向同一个产品页面(尽管它们的URL不是100%相同)。例如:</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="37f3" class="lo ks hi md b fi mh mi l mj mk">https://www.amazon.com/Sportiva-Ultra-Raptor-Running-Yellow/dp/B008I6J7YS/ref=sr_1_46?dchild=1&amp;keywords=la+sportiva+climbing+shoe&amp;qid=1618629379&amp;sr=8-46#customerReviews<br/>https://www.amazon.com/Sportiva-Ultra-Raptor-Running-Yellow/dp/B008I6J7YS/ref=sr_1_46?dchild=1&amp;keywords=la+sportiva+climbing+shoe&amp;qid=1618629379&amp;sr=8-46</span></pre><p id="c289" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这篇<a class="ae ka" href="https://www.joehxblog.com/amazon-url-anatomy-dissection/" rel="noopener ugc nofollow" target="_blank">博文</a>分解了亚马逊的URL结构。总之，在URL中只有“/dp/”部分和ASIN (Amazon标准识别号)部分是重要的。因此，我删除了“ref=”部分的所有内容。最后一步是删除指向本项目未考虑的品牌的URL。数据清理的结果产生了425个干净的、唯一的和相关的URL。</p><h1 id="59b3" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">第2部分:搜集产品信息</h1><p id="92d4" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">刮擦的流程如下:</p><p id="6971" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">进入产品页面(刮产品标题，产品价格)。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mo"><img src="../Images/0f8807e455bd79a1cf11411c0f4954ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZOhYXkRETc1t-V5zxunJ1Q.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Example of Amazon’s product page</figcaption></figure><p id="4969" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">点击“查看所有评论”按钮。这将打开一个新的链接。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mp"><img src="../Images/16089e4db622fb400b563b02f595554c.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*DKVTO1U7-dd3EXf6D4wqmA.jpeg"/></div><figcaption class="kn ko et er es kp kq bd b be z dx">Amazon’s “See all reviews” button</figcaption></figure><p id="bfba" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">刮所有评论。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es mm"><img src="../Images/ccfdd132bf1cc3e905734795dae310a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_j0LDjtuJSJmKf9EnEXJUg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Amazon reviews displayed after clicking the “See all reviews” button</figcaption></figure><p id="cca5" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然而，探索链接流揭示了潜在的重复问题。就拿下面两个ASINs不同的URL来说吧。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="26db" class="lo ks hi md b fi mh mi l mj mk">https://www.amazon.com/Sportiva-Tarantulace-Climbing-Shoes-Black/dp/B081ZF79RK/<br/>https://www.amazon.com/Sportiva-Tarantulace-Climbing-Shoes-Black/dp/B081XVFMZ5/</span></pre><p id="a0e6" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">根据产品名称，显示这些链接指的是相同的产品。他们各自的评论页面有相同的链接。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="b4e0" class="lo ks hi md b fi mh mi l mj mk">https://www.amazon.com/Sportiva-Mens-TarantuLace-Performance-Climbing/product-reviews/B07BCK9CWR/ref=cm_cr_dp_d_show_all_btm?ie=UTF8&amp;reviewerType=all_reviews<br/>https://www.amazon.com/Sportiva-Mens-TarantuLace-Performance-Climbing/product-reviews/B07BCK9CWR/ref=cm_cr_dp_d_show_all_btm?ie=UTF8&amp;reviewerType=all_reviews</span></pre><p id="42d8" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">考虑到这一点，我决定如果两个或更多的产品链接延伸到同一个评论页面，那么只需要从其中一个产品链接中抓取评论。下面显示了几个代码片段:</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="2038" class="lo ks hi md b fi mh mi l mj mk"># Scrapes the product name.<br/>prod_name = driver.find_element(By.ID, 'productTitle').text<br/># Scrapes product price.<br/>prod_price = driver.find_element(By.ID,'priceblock_ourprice').text<br/># Click translate reviews button.<br/>translate_button = driver.find_element(By.XPATH,'/html/body/div[1]/div[3]/div/div[1]/div/div[1]/div[5]/div[3]/div/div[1]/span/a')<br/>translate_button.click()<br/># Scrape all reviews on the current page.<br/>reviews = driver.find_elements(By.XPATH,'//span[@data-hook="review-body"]')<br/>for review in reviews:<br/>    product_reviews.append(review.text)</span></pre><p id="fb49" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">生成的数据集具有以下结构:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es mq"><img src="../Images/d45e37d7f34d1af7e43bde48b2f4ba88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*ia4YKGPySBwTx8EXZYNXlg.jpeg"/></div><figcaption class="kn ko et er es kp kq bd b be z dx">Document structure as shown in the MongoDB console</figcaption></figure><h1 id="1e9f" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">数据清理和预处理</h1><p id="9846" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">第一步是衍生两个新的领域，品牌和模式。品牌很容易从产品名称中提取出来。然而，提取模型被证明是一项棘手的任务。首先，我通过对15个文档进行采样并分析产品名称的组成，确定了产品名称的一般组成部分。我使用MongoDB查询语言(MQL)来实现这一点。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="969e" class="lo ks hi md b fi mh mi l mj mk">db.products.aggregate(<br/>      [{$match:{"reviews_url":{$ne:null}}},<br/>      { $sample: { size: 15 } },<br/>      {$project:{"_id":0,"product_name":1}}]<br/>      )</span></pre><p id="37a3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这提供了如下所示的子集(截断的输出):</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="11ee" class="lo ks hi md b fi mh mi l mj mk">{ "product_name" : "La Sportiva Otaki, Women's Climbing Shoes" }<br/>{ "product_name" : "La Sportiva TX2 Women's Approach Shoe" }<br/>{ "product_name" : "Five Ten Men's Coyote Climbing Shoe" }<br/>{ "product_name" : "La Sportiva TX4 MID GTX Hiking Shoe - Men's" }<br/>{ "product_name" : "Five Ten Men's Stonelands VCS Climbing Shoe" }<br/>{ "product_name" : "Scarpa Women's Gecko WMN Approach Shoe" }</span></pre><p id="4684" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我重新抽取了另外30个产品名称进行调查，并确定了一个产品名称的以下组成部分:品牌、鞋型、型号、性别、年龄组、颜色、年份和尺码。此外，产品名称是这些成分中的一个或多个的组合。我还注意到一些徒步旅行、登山和休闲鞋设法通过了过滤器，所以用关键词搜索把它们删除了。</p><p id="e63e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">尽管我尽了最大努力，仍然需要对产品模型进行额外的清理。十二个文档在模型字段中有空值，所以我手工填充了它们。我还检查了模型列表，以手动验证模型名称的准确性。</p><p id="241b" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在创建了派生变量之后，是时候清理评审了。以下是3篇评论的随机样本。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="ee43" class="lo ks hi md b fi mh mi l mj mk">"I have narrow feet, but couldn't get my feet in these shoes.\nI prefer to wear comfortable climbing shoes, not meaning beginner shoes (though I'm a beginner).\nI asked around and talked with those die-hard climbers, they suggested me wear shoes that I fee comfortable with.\nI strongly agree.\nHow can you climb with shoes that hurt your feet? Not to speak of focusing on it."</span><span id="bedd" class="lo ks hi md b fi mr mi l mj mk">"I just started climbing regularly and these are great. Good grip."</span><span id="1c30" class="lo ks hi md b fi mr mi l mj mk">"Great shoes! They have good flexibility."</span></pre><p id="f989" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我使用Python中的<a class="ae ka" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> NLTK </a>库进行文本清理和预处理。因为我的意图是使用<a class="ae ka" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"> VADER </a>对亚马逊评论进行情感分析，所以我必须根据算法定制我的数据清理任务。<a class="ae ka" rel="noopener" href="/analytics-vidhya/simplifying-social-media-sentiment-analysis-using-vader-in-python-f9e6ec6fc52f">这篇文章</a>很好地解释了VADER如何分析情绪。简而言之，VADER通过以下方式分析情绪:</p><ol class=""><li id="5fc9" class="ms mt hi jg b jh ji jk jl jn mu jr mv jv mw jz mx my mz na bi translated">标点符号。</li><li id="4999" class="ms mt hi jg b jh nb jk nc jn nd jr ne jv nf jz mx my mz na bi translated">资本化。</li><li id="2f92" class="ms mt hi jg b jh nb jk nc jn nd jr ne jv nf jz mx my mz na bi translated">程度修饰符。</li><li id="396a" class="ms mt hi jg b jh nb jk nc jn nd jr ne jv nf jz mx my mz na bi translated">连词。</li><li id="1fce" class="ms mt hi jg b jh nb jk nc jn nd jr ne jv nf jz mx my mz na bi translated">颠覆情感的话语。</li></ol><p id="cb55" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">除此之外，VADER还可以处理表情符号、表情符号和常用俚语。因此，我进行了标记化、停用词删除和一般清理(删除文本中嵌入的“\n”)。我没有进行去大写和删除标点符号。下面是一个停用词被删除的评论的例子。可以定性地观察到，评论背后的意义仍然保留着。</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="3e26" class="lo ks hi md b fi mh mi l mj mk">Great aggressive shoe. I have a wider foot and these fit me great. The laces really allow me to tune the fit. I downsized a half size from my gym shoe size. Initially pretty uncomfortable, but a shower and a few climbing sessions and they fit just right.</span><span id="97e3" class="lo ks hi md b fi mr mi l mj mk">Great aggressive shoe . I wider foot fit great . The laces really allow tune fit . I downsized half size gym shoe size . Initially pretty uncomfortable , shower climbing sessions fit right .</span></pre><p id="f54a" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">此外，我希望每个文档代表一个品牌的一个型号。在关系数据库中，字段<em class="ml"> brand </em>和<em class="ml"> model </em>可以作为一个组合键。删除重复文档的代码可以在上面的GitHub资源库链接中找到。</p><p id="40bb" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为了将评论转化为可衡量的东西，我用VADER进行了情感分析。关于其实现的简明教程可以在<a class="ae ka" href="https://www.geeksforgeeks.org/python-sentiment-analysis-using-vader/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我的代码实现是这样的:</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="c66a" class="lo ks hi md b fi mh mi l mj mk">def get_sentiment_score(review):<br/>    # Create a SentimentIntensityAnalyzer object.<br/>    sid_obj = SentimentIntensityAnalyzer()<br/><br/>    # polarity_scores method of SentimentIntensityAnalyzer<br/>    # oject gives a sentiment dictionary.<br/>    # which contains pos, neg, neu, and compound scores.<br/>    sentiment_dict = sid_obj.polarity_scores(review)<br/><br/>    print("sentence was rated as ", sentiment_dict['neg']*100, "% Negative")<br/>    print("sentence was rated as ", sentiment_dict['neu']*100, "% Neutral")<br/>    print("sentence was rated as ", sentiment_dict['pos']*100, "% Positive")<br/>    print("sentence has a compound score of ", sentiment_dict['compound'])<br/><br/>    # decide sentiment as positive, negative and neutral<br/>    if sentiment_dict['compound'] &gt;= 0.05 :<br/>        print("Sentence Overall Rated As Positive")<br/>  <br/>    elif sentiment_dict['compound'] &lt;= - 0.05 :<br/>        print("Sentence Overall Rated As Negative")<br/>  <br/>    else :<br/>        print("Sentence Overall Rated As Neutral")</span></pre><p id="8613" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以下是两个输出示例:</p><pre class="kc kd ke kf fd mc md me mf aw mg bi"><span id="5a67" class="lo ks hi md b fi mh mi l mj mk">"This shoe holds much better older Akashas . The fit requires size one euro size normal LS shoes . The cushion great long days rough terrain"<br/>sentence was rated as  0.0 % Negative<br/>sentence was rated as  70.8 % Neutral<br/>sentence was rated as  29.2 % Positive<br/>sentence has a compound score of  0.8591<br/>Sentence Overall Rated As Positive</span><span id="5f2f" class="lo ks hi md b fi mr mi l mj mk">"Get size bigger shoe sizes run small ."<br/>sentence was rated as  0.0 % Negative<br/>sentence was rated as  100.0 % Neutral<br/>sentence was rated as  0.0 % Positive<br/>sentence has a compound score of  0.0<br/>Sentence Overall Rated As Neutral</span></pre><p id="4880" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如图所示，VADER将一个句子的情感分为三部分:消极、积极和中性。这些分数加起来是1，或者100%。除此之外，该算法还产生一个“复合分数”，它是这三个分数的总和，范围从-1(完全为负)到1(完全为正)。为了将评论分为负面/中性/正面，我使用了复合得分的典型阈值，即如果大于或等于0.05，则为正面；如果小于或等于-0.05，则为负面；如果在-0.05到0.05之间，则为中性。</p><p id="2420" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从例子中可以看出，VADER在衡量情绪方面做得相当不错。第一个例子清楚地表明，评论者使用该鞋进行户外攀登有积极的体验(“漫长的一天”，“崎岖的地形”暗示了这一点)。VADER成功地对情感进行了分类。第二个例子也相当鼓舞人心。如果我要对这篇评论进行定性评估，我也会将其归类为中立，因为它只是一个建议，实际上并没有传达任何情绪。</p><h1 id="4990" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">分析和见解</h1><h1 id="8ae2" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">第1部分:哪些是评论最多的品牌？</h1><p id="85b6" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">我自己作为电商行业的消费者，我进行购买的一个影响因素就是一个产品或者一个品牌在平台上的评论数。以下是每个品牌评论数量的细分。然而，数据集中的每个品牌都有不同数量的模型，这可能会影响评论的数量。因此，我通过创建一个双轴条形图，将每个品牌的模特数量和评论数量考虑在内。红条代表每个品牌的车型数量，蓝条显示每个品牌的点评数量。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ng"><img src="../Images/da545e98c8ac4d095c34a7c4bbb97264.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*RlyVtih9Uu0iir5EX_Ax8Q.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx">Bar chart comparing number of models Vs number of reviews per model</figcaption></figure><p id="179d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如上图所示，我们现在可以调查哪些品牌相对于其销售的型号数量拥有良好的评论水平。La Sportiva 和<em class="ml"> Scarpa </em>的评论数量最多，但这些品牌也销售了最多的车型。相比之下，<em class="ml"> Climb X </em>和<em class="ml"> Mad Rock </em>的销量大致相同，但据观察<em class="ml"> Climb X </em>是更受关注的品牌。此外，<em class="ml"> Tenaya </em>相对于其售出的车型数量而言，评价很少。<em class="ml">黑钻</em>、<em class="ml"> Evolv </em>和<em class="ml"> Ocun </em>有五个或更少的型号，但<em class="ml">黑钻</em>在评论数量方面远远超过其他两个品牌。</p><h1 id="eadb" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">第二部分:哪些型号获得了最好的评价？</h1><p id="031e" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">知道哪种型号评论最好不足以说服我购买。理想情况下，我不仅想知道哪些模特有最好的评价，还想知道哪些模特有最好的评价<strong class="jg hj">和最多的评价</strong>。为了这个分析，我画了一个散点图，分成四个象限。垂直线左边的每个模型都有低于平均水平的阳性率，反之亦然。水平线以下的每个模型都有低于平均水平的评论数，反之亦然。每个模型的阳性率计算为阳性分类数(VADER)除以综述数乘以100。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ng"><img src="../Images/53658f81a7dcff0d917625076de1d1a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*3IWeXqa3Xc81fQZoqhNGHQ.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx">Scatter plot comparing number of reviews against positivity rate per brand</figcaption></figure><p id="ceab" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如上图所示，平均阳性率约为85，而平均评论数约为25。可以观察到一些异常值，例如<em class="ml">的《狼蛛表演》</em>,其评论数量明显高于其他作品，以及<em class="ml">的《生态》</em>,其正面评价率较低。为了更仔细地分析模型，我删除了阳性率小于50且评论数量超过300的数据点(<em class="ml">即</em>模型)。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es nh"><img src="../Images/c03718bd62ad636e0bd4d7cd0dd69df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*webjvd2b0xbZyt7d3iHllg.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx">Scatter plot comparing number of reviews against positivity rate per brand (outliers removed)</figcaption></figure><p id="8c2c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在我们可以更好地观察整体意见更好的车型。象限1(右上框)显示阳性率和评论数高于平均水平的模型。这几款整体舆论最好。象限2(左上方框)显示了已经过良好评审但低于平均阳性率的模型。象限3(左下角的方框)显示了阳性率和评论数量最差的模型，而象限4(右下角的方框)显示了许多阳性率高于平均水平但评论数量低于平均水平的模型。</p><p id="980b" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">对于想要在购买前快速了解哪些型号需要研究的人，我建议进一步研究象限1中的型号。</p><h1 id="e4dd" class="kr ks hi bd kt ku kv kw kx ky kz la lb io lc ip ld ir le is lf iu lg iv lh li bi translated">结论</h1><p id="d8b2" class="pw-post-body-paragraph je jf hi jg b jh lj ij jj jk lk im jm jn ll jp jq jr lm jt ju jv ln jx jy jz hb bi translated">在这篇文章中，我展示了一些关键的技能，比如网页抓取、数据清理、探索性数据分析和情感分析。我已经根据亚马逊的评论确定了一组值得进一步研究的攀岩鞋模型。这个框架可以推广到其他亚马逊产品，只需对代码做一些调整。</p><ol class=""><li id="6b65" class="ms mt hi jg b jh ji jk jl jn mu jr mv jv mw jz mx my mz na bi translated"><a class="ae ka" href="https://kokkeanshern.github.io/2021/03/15/RockClimbingNLP.html#conclusion" rel="noopener ugc nofollow" target="_blank">结论</a></li></ol></div></div>    
</body>
</html>
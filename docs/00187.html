<html>
<head>
<title>Authorship Attribution through Markov Chain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于马尔可夫链的作者归属</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/authorship-attribution-through-markov-chain-922b01a40920?source=collection_archive---------0-----------------------#2020-09-28">https://medium.com/geekculture/authorship-attribution-through-markov-chain-922b01a40920?source=collection_archive---------0-----------------------#2020-09-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5237" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定一件作品，我们如何识别它的作者？这篇文章旨在用马尔可夫链给出作者归属的一个简要的想法。</p><p id="1883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">作者归属</strong> (AA)是识别给定文本的作者的任务。它不应该与作者信息(如年龄、性别或种族)相关的作者简介相混淆。</p><blockquote class="jd je jf"><p id="c074" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">让我们从<strong class="ih hj">假设</strong>开始:</p></blockquote><ol class=""><li id="b01e" class="jk jl hi ih b ii ij im in iq jm iu jn iy jo jc jp jq jr js bi translated">AA认为每个人都有自己独特的写作风格，并在工作中始终如一地运用。</li><li id="2296" class="jk jl hi ih b ii jt im ju iq jv iu jw iy jx jc jp jq jr js bi translated">我们假设真正的作者在候选作者组中。也就是说:预测模型将从作者池中产生单个输出。</li></ol><h1 id="d350" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">笔形特征</strong></h1><p id="3968" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">AA背后的主要思想是，通过提取一些可测量的文本特征(风格学特征)，我们可以辨别具有相似特征的给定文本的真正作者。</p><p id="0265" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有许多类型的文体学特征，如词汇特征(单词)、字符特征(字母频率、n-gram等)、句法特征(错误、短语结构)、语义特征(同义词、功能)和特定应用特征(HTML、电子邮件中问候语的使用)(Stamatatos 2009)。</p><p id="afbb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们关注字符级特征，它具有独立于语言(至少对于大多数语言)和对拼写错误(如错别字，与词汇特征相比)鲁棒的优点。</p><h1 id="767a" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">马尔可夫链:</strong></h1><p id="2b4e" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">马尔可夫链是一种随机过程，仅通过其当前状态来模拟未来状态的概率。它是由俄罗斯数学家安德烈·马尔科夫引入的。</p><p id="7d4c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本可以被视为一系列单词或字符，其中下一个单词或字符由作者的风格控制。</p><p id="0aa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，可以应用马尔可夫链，并且字符之间的转移概率可以用作作者身份指纹来区分作者。</p><h1 id="b5d8" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">对数似然</h1><p id="fc92" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">文本序列的似然性是字符的所有概率的乘积。例如，我们有以下概率:</p><p id="c3b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(H|T) = 0.02，即给定当前T，字符H的概率是0.02</p><p id="73f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">P(E|H) = 0.03，即给定当前H，字符E的概率是0.03</p><p id="bf70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本的可能性:则为0.02 x 0.03 = 0.006</p><p id="5ebe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，出现一长串文本的可能性非常小，很难进行比较。相反，使用对数似然法。</p><p id="5c02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">文本的可能性:则为log(0.02 x 0.03)= log(0.006)=-2.22</p></div><div class="ab cl lb lc gp ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="hb hc hd he hf"><h1 id="0a79" class="jy jz hi bd ka kb li kd ke kf lj kh ki kj lk kl km kn ll kp kq kr lm kt ku kv bi translated"><strong class="ak"> Python实现</strong></h1><p id="c069" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq ky is it iu kz iw ix iy la ja jb jc hb bi translated">我们将使用古登堡计划中的几本书作为我们的训练和测试数据集。</p><p id="c312" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先从NLTK导入Gutenberg数据集</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="867d" class="lw jz hi ls b fi lx ly l lz ma">import nltk<br/>nltk.download('gutenberg')<br/>nltk.corpus.gutenberg.fileids() </span></pre><figure class="ln lo lp lq fd mc er es paragraph-image"><div class="er es mb"><img src="../Images/84c7e702d2900edae6e0d65ab61f872a.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*Zyps95Jr3wCqNZNYogZolA.png"/></div><figcaption class="mf mg et er es mh mi bd b be z dx">Books in the NLTK Gutenberg corpus</figcaption></figure><p id="9ecf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NLTK古腾堡语料库中有18本书，我们使用简·奥斯汀的<strong class="ih hj"> <em class="jg">【奥斯汀-sense . txt】</em></strong>作为测试数据，并与简·奥斯汀的<strong class="ih hj"> <em class="jg">【奥斯汀-艾玛. txt】</em></strong>和莎士比亚的<strong class="ih hj"> <em class="jg">【莎士比亚-凯撒. txt】</em></strong>作为训练数据进行比较。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="3183" class="lw jz hi ls b fi lx ly l lz ma">emma = nltk.corpus.gutenberg.words('austen-emma.txt')<br/>emma = ' '.join(emma)</span><span id="4db8" class="lw jz hi ls b fi mj ly l lz ma">caesar = nltk.corpus.gutenberg.words('shakespeare-caesar.txt')<br/>caesar = ' '.join(caesar)</span><span id="2105" class="lw jz hi ls b fi mj ly l lz ma">sense = nltk.corpus.gutenberg.words('austen-sense.txt')<br/>sense = ' '.join(sense)</span></pre><p id="b753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将马尔可夫链中的状态数限制为26个英文字符和一个空格字符(" ")。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="4a98" class="lw jz hi ls b fi lx ly l lz ma">state = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p","q", "r", "s", "t", "u", "v", "w", "x", "y", "z", " "]</span><span id="40fa" class="lw jz hi ls b fi mj ly l lz ma">#create word2id and id2word dictionary<br/>char2id_dict = {}</span><span id="d476" class="lw jz hi ls b fi mj ly l lz ma">for index, char in enumerate(state):<br/>    char2id_dict[char] = index</span></pre><p id="f1dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，让我们定义一个从给定文本中创建转移矩阵的函数</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="9066" class="lw jz hi ls b fi lx ly l lz ma">import numpy as np</span><span id="50eb" class="lw jz hi ls b fi mj ly l lz ma">def create_transition_matrix(text):<br/>    transition_matrix = np.zeros((27, 27))<br/>    <br/>    for i in range(len(text)-1):<br/>        current_char = text[i].lower()<br/>        next_char = text[i+1].lower()<br/>        <br/>        if (current_char in state) &amp; (next_char in state):<br/>            current_char_id = char2id_dict[current_char]<br/>            next_char_id = char2id_dict[next_char]<br/>            transition_matrix[current_char_id][next_char_id] = transition_matrix[current_char_id][next_char_id] + 1</span><span id="19ce" class="lw jz hi ls b fi mj ly l lz ma">sum_of_each_row_all  = np.sum(transition_matrix, 1)<br/>    <br/>    for i in range (27):<br/>            single_row_sum = sum_of_each_row_all[i]<br/>            if (sum_of_each_row_all [i] == 0):<br/>                single_row_sum = 1<br/>            <br/>            transition_matrix[ i,: ] =  transition_matrix[ i,: ] / single_row_sum<br/>    return transition_matrix</span></pre><p id="1c44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们获得训练数据的转移矩阵</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="0dee" class="lw jz hi ls b fi lx ly l lz ma">TM_emma = create_transition_matrix(emma)<br/>TM_caesar = create_transition_matrix(caesar)</span></pre><p id="259d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们比较了简·奥斯汀和莎士比亚写的书<strong class="ih hj"><em class="jg">【Austen-sense . txt】</em></strong>的对数似然。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="2a5c" class="lw jz hi ls b fi lx ly l lz ma">log_likelihood_jane = 0<br/>log_likelihood_shakespeare = 0</span><span id="b735" class="lw jz hi ls b fi mj ly l lz ma">for i in range(len(sense)-1):<br/>    current_char = sense[i].lower()<br/>    next_char = sense[i+1].lower()</span><span id="454f" class="lw jz hi ls b fi mj ly l lz ma">if (current_char in state) &amp; (next_char in state):<br/>        current_char_id = char2id_dict[current_char]<br/>        next_char_id = char2id_dict[next_char]<br/>        if TM_emma[current_char_id][next_char_id] != 0 and TM_caesar[current_char_id][next_char_id] != 0:<br/>            log_likelihood_jane += np.log(TM_emma[current_char_id][next_char_id])<br/>            log_likelihood_shakespeare += np.log(TM_caesar[current_char_id][next_char_id])</span></pre><h1 id="ab4e" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结果</h1><figure class="ln lo lp lq fd mc er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mk"><img src="../Images/53b2e50962300c11a60865ca439a037e.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*0k23BDFSHqo8xSUFTtxp7w.png"/></div></div></figure><p id="d129" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，与莎士比亚相比，给定文本更有可能是简·奥斯汀写的。我们将指定文本的作者指定为简·奥斯汀。为了让演示简单明了，我们只使用了1本不知名的书和2个作者。您可以扩大训练集和测试集的大小。</p><p id="3dcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GitHub上传的完整的一阶马尔可夫链代码链接:<a class="ae mp" href="https://github.com/yuanxy33/Authorship-Attribution" rel="noopener ugc nofollow" target="_blank">https://github.com/yuanxy33/Authorship-Attribution</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to Build a Django Chatbot using Dialogflow: A Step-by-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Dialogflow构建Django聊天机器人:分步指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-build-a-django-chatbot-using-dialogflow-a-step-by-step-guide-ade0c41f30f1?source=collection_archive---------2-----------------------#2020-12-29">https://medium.com/geekculture/how-to-build-a-django-chatbot-using-dialogflow-a-step-by-step-guide-ade0c41f30f1?source=collection_archive---------2-----------------------#2020-12-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/139a094c14180dd95792c0dd0db0ace3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_8WaztYue2t-QEEc.png"/></div></div></figure><p id="cb8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>是当今最流行的编程语言之一，而<a class="ae jo" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>是一个免费、开源的Python web开发平台，是一个非常通用的web开发工具，可以用来构建任何需要的网站或应用程序。</p><p id="ed60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我将努力让你很容易理解如何将Dialogflow chatbot集成到Django网站中。</p><p id="012e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你还没有Dialogflow聊天机器人，那么这里有一个<a class="ae jo" href="https://www.kommunicate.io/blog/dialogflow-tutorial-create-chatbots/" rel="noopener ugc nofollow" target="_blank">的分步教程来构建你自己的聊天机器人</a>。然而，Dialogflow有其自身的局限性。它没有提供我们聊天对话所需的UI。</p><p id="25b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于我们现在不是80年代，我们需要一个前端，而不是一个为非技术人员提供的沉闷黑暗的命令行用户界面，来提供一个能够引起共鸣并且对用户友好的聊天机器人。</p><p id="2e1e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们正在将Dialogflow与Kommunicate集成，它为聊天小部件和管理仪表板提供了预建的UI。</p><p id="a19d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您没有通信帐户，<a class="ae jo" href="https://www.kommunicate.io/product/dialogflow-integration" rel="noopener ugc nofollow" target="_blank">请在此</a>注册免费帐户以继续。</p><p id="af3a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了便于理解，这篇文章分为两部分。</p><ul class=""><li id="9252" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">将Dialogflow bot与通信集成在一起</li><li id="5fcf" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">将通信与Django框架相结合</li></ul><h1 id="efc4" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">第1部分:将Dialogflow与通信集成</h1><p id="1203" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">要在komunicate中集成您的Dialogflow bot，请登录到您的komunicate仪表板并导航到bot集成部分。如果您没有帐户，您可以在这里创建一个<a class="ae jo" href="https://dashboard.kommunicate.io/signup?product=kommunicate" rel="noopener ugc nofollow" target="_blank">。找到Dialogflow部分，然后单击Integrate Bot。</a></p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/4dddac3eeb9b7773c9e22bcdeeb83771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zY8aRtWrcgaH48f1UT4Vqg.png"/></div></div></figure><p id="99b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，导航到您的Dialogflow控制台并下载服务帐户密钥文件。以下是查找文件的步骤:</p><ol class=""><li id="f3a3" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ll jv jw jx bi translated">通过单击设置图标打开对话流代理设置</li><li id="86b5" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ll jv jw jx bi translated">点击谷歌项目栏中提到的<strong class="is hj">谷歌云链接</strong></li><li id="a355" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ll jv jw jx bi translated">在google云页面中，通过单击API &amp; services导航到凭据部分</li><li id="d911" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ll jv jw jx bi translated">在“凭据”下，找到服务帐户，然后单击“对话流集成”的“编辑”</li><li id="a1e4" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ll jv jw jx bi translated">在屏幕的底部，点击ADD key按钮并创建一个key选项，一个JSON密匙将被下载</li><li id="5ae9" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ll jv jw jx bi translated">现在上传<strong class="is hj">密钥文件</strong></li></ol><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/f7abde41fbae3b9fdf33eeac5a0bc9d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcqyNzFr69iFRGXQFX_Pxg.png"/></div></div></figure><p id="a03d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过为您的机器人命名，完成设置并在最后一步启用/禁用机器人到人的切换，然后您可以在两个地方检查和测试您新开发的机器人:</p><p id="64e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">仪表板→ Bot集成→管理Bot:您可以在这里检查您所有集成的Bot<br/>仪表板→Bot集成:您的Dialogflow图标应该是绿色的，显示您成功集成的Bot数量。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/f7abde41fbae3b9fdf33eeac5a0bc9d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcqyNzFr69iFRGXQFX_Pxg.png"/></div></div></figure><h1 id="e902" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">第2部分:用Django框架集成Kommunicate</h1><p id="3108" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">既然我们已经有了Dialogflow聊天机器人及其用户界面，现在我们可以将它与Django web框架集成。在创建了Django项目之后，有两种可能的方法将kommunicate脚本代码添加到您已经创建的HTML模板中</p><p id="990a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.从kommunicate dashboard中复制javascript代码，并将其粘贴到您创建的HTML页面的结束body标记(</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="3786" class="ls ke hi lo b be lt lu l lv lw">&lt;h1&gt;Hello, World!&lt;/h1&gt; &lt;body&gt; &lt;script type="text/javascript"&gt; (function(d, m){ var kommunicateSettings = {"appId":"kommunicate-support","popupWidget":true,"automaticChatOpenOnNavigation":true}; var s = document.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = "https://widget.kommunicate.io/v2/kommunicate.app"; var h = document.getElementsByTagName("head")[0]; h.appendChild(s); window.kommunicate = m; m._globals = kommunicateSettings; })(document, window.kommunicate || {}); /* NOTE: Use webserver to view HTML files as the real-time update will not work if you directly open the HTML file in the browser. */ &lt;/script&gt; &lt;/body&gt;</span></pre><p id="9203" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.在settings.py文件中定义STATIC_URL，如下所示，并将该文件直接加载到模板中</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="15e5" class="ls ke hi lo b be lt lu l lv lw">STATIC_URL = '/static/'</span></pre><p id="e645" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用下面的表达式加载模板中的静态文件</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="49f1" class="ls ke hi lo b be lt lu l lv lw">1 {% load static %}</span></pre><p id="5369" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在您的项目中，首先创建一个“静态”目录，并将文件存储在其中。在静态目录中创建js文件，并将Kommunicate脚本添加到您生成的js文件中。</p><p id="92ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">HTML模板应该是这样的</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="d629" class="ls ke hi lo b be lt lu l lv lw">&lt;!DOCTYPE html&gt; &lt;html lang="en"&gt; &lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Index&lt;/title&gt; {% load static %} &lt;script src="{% static '/JS/script.js' %}" type="text/javascript"&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, World!&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt;</span></pre><p id="4e0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Script.js文件应该是这样的(注意:用安装部分提到的您自己的应用程序ID替换APP-ID)</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="f109" class="ls ke hi lo b be lt lu l lv lw">(function(d, m){ var kommunicateSettings = {"appId":"APP-ID","popupWidget":true,"automaticChatOpenOnNavigation":true}; var s = document.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = "https://widget.kommunicate.io/v2/kommunicate.app"; var h = document.getElementsByTagName("head")[0]; h.appendChild(s); window.kommunicate = m; m._globals = kommunicateSettings; })(document, window.kommunicate || {});</span></pre><p id="fee2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用以下命令启动安装了Dialogflow bot的新创建的网站。</p><pre class="lh li lj lk fd ln lo lp bn lq lr bi"><span id="9d96" class="ls ke hi lo b be lt lu l lv lw">1 python manage.py runserver</span></pre><p id="969d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">瞧啊。有多简单？通过这几个简单的步骤，您可以将Dialogflow bot集成到Django网站中。这是聊天小部件在网站上的外观:</p></div><div class="ab cl lx ly gp lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="hb hc hd he hf"><p id="25e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="me">原载于2020年12月29日</em><a class="ae jo" href="https://www.kommunicate.io/blog/dialogflow-chatbot-django-website/" rel="noopener ugc nofollow" target="_blank"><em class="me">https://www . komunicate . io</em></a><em class="me">。</em></p></div></div>    
</body>
</html>
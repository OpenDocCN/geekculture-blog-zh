<html>
<head>
<title>Find The Easy Pass has been Pwned!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发现易通行已被pwn！</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/ollydbgfind-the-easy-pass-has-been-pwned-2288b25cfb93?source=collection_archive---------8-----------------------#2021-09-16">https://medium.com/geekculture/ollydbgfind-the-easy-pass-has-been-pwned-2288b25cfb93?source=collection_archive---------8-----------------------#2021-09-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/2c60c4ad505326e0996902fcc4d33e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wixmZr3jVdPGtkLh"/></div></div></figure><p id="3b36" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">今天，我们将继续<a class="ae jw" href="https://hackthebox.eu" rel="noopener ugc nofollow" target="_blank">Hack Bo</a>x初学者赛道，进行倒车挑战，找到容易通过的地方。完全免责声明，我几乎没有逆向工程的经验。我以前看过这个挑战，并完成了它，但我不明白是怎么回事。我在大学时做过一些组装工作，但那是十多年前的事了，现在我已经全忘了。</p><p id="83b4" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">因此，有了这种方式，让我们得到扭转。</p><p id="4986" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">首先你需要去黑盒子并下载这个挑战的文件。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es jx"><img src="../Images/5c19ff09ad38e14d2a8ebb46f53ecde7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iVLD-_7ppDzwIfgaPItwGg.png"/></div></div></figure><p id="dcd4" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">这会将文件下载到您的下载目录或您设置的任何地方。您需要提取zip存档的内容，但它是受密码保护的。密码列在挑战中，是“黑客盒子”。如果你在Windows上，你应该能够双击可执行文件并立即运行它。然而，如果你使用的是Linux，那么你需要用wine这样的仿真软件来运行它。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es jy"><img src="../Images/0c851c6ac8a7a023b749dcbf8a278bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*dfvowyXHQuYUV3Ly"/></div></figure><p id="63e7" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">现在应用程序正在运行，最好记下应用程序中显示的字符串。当需要对程序进行反编译时，这有助于跟踪程序中的位置。接下来要检查的是当我们向应用程序提交数据时会发生什么。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es jz"><img src="../Images/ddedeba652669c6f5cf8b8127f5ba4be.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*-xy0hajQIjswFiamaUqzag.png"/></div></figure><p id="714c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">我们失败了，我们提交了错误的密码，应用程序在嘲笑我们。那么，我们该何去何从呢？我们需要一个程序把其他程序撕成碎片，这样我们就能看到它们的内部。如果您还没有设置和安装它，可以看看我在Ghidra上的文章。我们开始倒车吧。与。现在是时候搜索我们之前记下的那些字符串了。顶部菜单有一个搜索选项。点按它，然后点按“搜索字符串”。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es ka"><img src="../Images/8ad67b8b1d8b23fc3c9c38cdab4a43b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*y-fNi0yNwlUO3e69BAYqNg.png"/></div></figure><p id="43c3" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">应该会弹出一个新窗口，提供一些选项来优化搜索。我保留了默认选项，并点击了搜索。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es kb"><img src="../Images/6a30b8ce8af302b67f5cc84da54fc0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*_-VItkymCnyaxMTZ7Je1qA.png"/></div></figure><p id="a88c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">一旦完成，将弹出另一个窗口，显示Ghidra在代码中找到的所有字符串。底部有一个过滤器选项，您可以使用它来进一步细化搜索。从测试应用程序中我们知道，在应用程序上可以看到字符串“password”。我们找找吧。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kc"><img src="../Images/011bac895c31cb5ac1eb3e6a7f7a47ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpWREADT0D4PT4RYvRiwVw.png"/></div></div></figure><p id="96cd" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">好的，我们正在缓慢但稳定地前进，这就是我们需要做的，为了打败兔子，或者是野兔？希望所有倒车不用这么久。接下来，我们需要双击包含“错误密码”的行，这将把我们带到应用程序中代码部分的位置。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es jy"><img src="../Images/1180b5ba8ccc598d4afcb2686ad2f2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*7vX8CZQVB7piATGy"/></div></figure><p id="0428" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">代码部分以蓝色突出显示。您可以看到，当前正在查看内存引用00545200。如果我们右键单击突出显示的部分，并单击引用，然后显示地址引用，将弹出一个新窗口，显示内存地址。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kd"><img src="../Images/22bd22a8a3f0294d871085a233d9603f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGu7sq1RfJ5DD4_eHoG-GA.png"/></div></div></figure><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ke"><img src="../Images/5182116a40404125837f8b9bf92414eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*61TtebX6qE3_ps4TICscYw.png"/></div></div></figure><p id="3a59" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">可以看到位置是00454144。如果我们再次双击那个地址，那么它将把我们带回到主窗口和下一个内存引用的位置。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kf"><img src="../Images/1b7c645cc7936f3231134c05ed8d1c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HqMq5Bax_2jZ78-OS7d_g.png"/></div></div></figure><p id="4757" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">迷路了？是的，不要担心，我花了几次尝试才走到这一步，我并不羞于承认我已经阅读了一些演练。现在，如果你看一下顶栏，在绿色播放按钮旁边有一个“层次顺序”图标(我唯一能想到的称呼)。单击它以启动函数图窗口。你应该得到一个窗口，看起来像下面的东西。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es kg"><img src="../Images/e0e428c645c8a2ac704d7733946ce687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*1sJRWPxJKHuNvOmY0IOlEg.png"/></div></figure><p id="3f20" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">现在，如果你放大到最后4个方框，你可以看到有一点逻辑在起作用。根据结果，程序有两个不同的代码部分。本质上，这是一个IF语句。如果满足一个条件，则运行第一个框中的代码(00454138)，否则运行第二个框中的代码(00454144)。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kh"><img src="../Images/78dfbcb763878801518605a473fcd419.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2VguA2GScNYthMs2DUPmQ.png"/></div></div></figure><p id="e5c7" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">如果我们看看这两个框正上方的框，您可以看到函数(FUN_00404628)决定了下一个要运行哪个框。如果我们点击函数号，它会把我们带到调用函数的地方。记下内存引用00454131。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es jy"><img src="../Images/f5c722052ba738457aba3e3d07557e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*5-u7ycqz18GVOWXc"/></div></figure><p id="e00e" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">然后，如果你双击这个函数，它会把你带到主窗口中的if语句，在这里我们可以看到它在做什么。正如您在下面看到的，应用程序从param_1和param_2中获取值，并将它们存储在EAX和EDX。接下来，您应该会看到使用PUSH将param_1和param_2的值写入堆栈，并使用CMP进行比较。我们可以假设，因为这是检查密码是否正确，所以这些参数之一包含正确的密码。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ki"><img src="../Images/31fae88349d8da8905fd51fa19cc32ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z0-WVJvUH2hHCLRqbW7prA.png"/></div></div></figure><p id="440c" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">因此，接下来我们需要调试程序，并检查这些参数的内容。为此，我将使用ollydbg。如果您需要安装ollydbg，您可以从CLI使用“sudo apt-get install ollydbg”进行安装。程序安装后，您可以通过运行“ollydbg”来启动它。ollydbg运行后，单击文件，打开并选择EasyPass.exe。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kj"><img src="../Images/df410ed4faa672c906acbd219e71f2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tex4mR9CFepcNGO8SsaSDQ.png"/></div></div></figure><p id="78f2" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">随着程序的加载，我们需要找到我们的内存引用。可能有搜索内存引用的方法，但我只是滚动直到找到它。右击引用，选择断点，然后单击切换。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es kk"><img src="../Images/33e3017e3714d4716b0f38f78c6291d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*QXs_ALYdzGzRotGCSd0ybA.png"/></div></figure><p id="b1d0" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">现在，如果你点击播放按钮运行程序，它将启动并要求你输入密码。但是，这一次不是检查密码是否正确，而是暂停，您将能够看到它与之比较的值。下图显示了我们输入的“test”和另一个值“fortran！”。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es kk"><img src="../Images/1b274309d6ece251b2434c054a233794.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/0*IErFwlcH9XTTRyml"/></div></div></figure><p id="762d" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">现在，如果我们使用wine再次运行该程序，我们可以输入密码来检查它是否正确，它是正确的。恭喜你完成了最简单的倒车挑战。不使用Ghidra可能有更简单的方法，但我想试试。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es kl"><img src="../Images/00fa47cfdac0b1e2f5ec75f1351f882a.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*LRFbXsGX7aWVou_T5tfvCw.png"/></div></figure><p id="95a5" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated">看看我的其他一些帖子，包括<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-archetype-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">原型</a>、<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-oopsie-has-been-pwned/" rel="noopener ugc nofollow" target="_blank"> Oopsie </a>、<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-vaccine-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">疫苗</a>、<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-shield-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">盾牌</a>、<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-pathfinder-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">探路者</a>、<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-included-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">收录</a>和<a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-markup-has-been-pwned/" rel="noopener ugc nofollow" target="_blank">标记</a>。</p><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es km"><img src="../Images/3759c2465d838fd4955f41d863a6230b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*OEZYoSaMjk5IrH0okWoYNQ.png"/></div></figure></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="5d50" class="pw-post-body-paragraph iy iz hi ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><em class="kn">原载于2021年9月16日https://haxez.org</em><a class="ae jw" href="https://haxez.org/2021/09/hack-the-box-reversing-find-the-easy-pass-has-been-pwned/" rel="noopener ugc nofollow" target="_blank"><em class="kn"/></a><em class="kn">。</em></p></div></div>    
</body>
</html>
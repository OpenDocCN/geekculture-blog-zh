<html>
<head>
<title>Visualizing Tweets Sentimentally in a Dashboard using Python &amp; Tableau.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Tableau在仪表板中感性地可视化推文。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/visualizing-tweets-sentimentally-in-a-dashboard-using-python-tableau-79925ceb3564?source=collection_archive---------4-----------------------#2021-03-24">https://medium.com/geekculture/visualizing-tweets-sentimentally-in-a-dashboard-using-python-tableau-79925ceb3564?source=collection_archive---------4-----------------------#2021-03-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9bdbee05030f993ab0d81010391af63c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6AKuitAypkh6nI6u"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@srd844?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Stephen Dawson</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c0f5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一点背景知识，在这篇文章的开始，我们首先需要了解情感分析以及它们现在和将来对我们周围世界的影响。品牌如何使用我们周围的情感分析，以及社交媒体在这种情况下有多强大，更具体地说，Twitter。在这篇文章中，我们将探讨twitter上的热门话题如何影响一个特定的个人、一个品牌甚至一个行业。</p><p id="185a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本文主要关注twitter上的时事趋势，更具体地说，用户使用的某个关键词可能会对商业品牌产生影响，并实时分析关于所提及主题的推文以及人们对此的看法。这种分析将在最终产品的用户友好的仪表板，可能有助于一般公众，品牌等。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/09a501cdaa492a2fbedd579c21f39f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*4YQ6-KwGQulCyl4i09IMuw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">An Overview of the System</figcaption></figure><p id="6135" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该系统旨在涵盖尽可能多的问题，这就是没有指定具体领域的原因。如下图所示，整个过程从用户键入他们想要的主题或搜索特定实体开始。然后从社交媒体(Twitter)中提取数据。这个过程是最长的(持续时间),因为很难获得数据。然后对数据进行挖掘和分析，以显示对该主题的观点模式。这个过程，情感分析，被用来分析互联网用户评论的文本形式。表情符号也被破译，因此显示了他们的情绪(像一个笑脸意味着快乐等。).</p><p id="742c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，所获取的数据被可视化并以这样的方式显示给用户，即每条信息都以用户能够理解的方式显示。</p><h1 id="1702" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">系统要求</h1><p id="0449" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">Python IDE(为此使用了py charm)<br/>Google帐户<br/> Tableau公共帐户</p><h1 id="5050" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">使用的库</h1><p id="bd93" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">在整个过程中使用了以下库:</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="501f" class="ln kg hi lj b fi lo lp l lq lr">import os<br/>import string<br/>#import stopwords as stopwords<br/>import tweepy as tw<br/>from tweepy import Stream<br/>from tweepy import OAuthHandler<br/>from tweepy.streaming import StreamListener<br/>import gspread<br/>from oauth2client.service_account import ServiceAccountCredentials<br/>import pandas as pd<br/>from tqdm import tqdm<br/>import time<br/>import re<br/>import preprocessor as p<br/>from nltk.tokenize import word_tokenize<br/>from textblob import TextBlob<br/>from nltk.corpus import stopwords<br/>import pygsheets<br/>from tkinter import *<br/>from tkinter.ttk import *<br/>import pycountry<br/>from tkinter import messagebox<br/>from tkinter import ttk<br/>import webbrowser</span></pre><h2 id="21be" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">十二岁</h2><p id="35b9" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf"> Tweepy是一个python模块，是这个项目不可或缺的一部分。Tweepy充当python包装器，允许我们直接从Twitter API流式传输和使用数据。</em></p><h2 id="7d90" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">PygSheets</h2><p id="91bb" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf"> Pygsheets是一个直观简单的python库，它使Python用户能够通过google sheets API v4访问他们的Google Sheets。</em></p><h2 id="14ee" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">熊猫</h2><p id="01bd" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">Pandas是一个基于python的快速、灵活的开源工具，用于数据分析和操作。我们将在这里使用它来创建数据帧。</p><h2 id="8f74" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">Tkinter</h2><p id="4026" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf"> Tkinter据说是Python默认的GUI包。它预装在python中，因此您不必手动安装。它是python中最常用的GUI。</em></p><h2 id="ea2d" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">预处理器</h2><p id="29a5" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf">这是python中的一个库，专门用于预处理提取的tweets。这个库很容易清理推文，并解析和标记提取的数据。</em></p><h2 id="5909" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">文本Blob</h2><p id="706d" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">TextBlob是python中的一个库，用于自动处理文本形式的数据。它为常见的自然语言处理任务(如词性标注、情感分析等)提供了一个通用的API。在这个系统中，textblob用于测量tweet的极性，以确定tweet的情绪，其范围从-1(负)到+1(正)。推文的主观性也是用textblob来衡量的。</p><h2 id="2076" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">NLTK</h2><p id="1e9f" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf">在这个系统中使用的最重要的库之一必须是他nltk(自然语言工具包)。NLTK库为开发人员提供了一种让他们的机器与人类语言数据交互的方法。nltk流行的主要原因是它易于使用接口以及跨平台的通用性。NLTK还提供了一些函数，可以帮助我们用word_tokenize()之类的函数预处理数据，在这些函数中，单词被拆分成标记并进行情感分析。它还具有各种其他功能，以便开发人员可以通过他们的机器来交互和理解人类语言数据。</em></p><h2 id="5030" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">（舞台上由人扮的）静态画面</h2><p id="be37" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf"> Tableau是一款交互式可视化软件，主要用于商业智能，以便更好地理解数据。在这个系统中，我们使用tableau live集成tableau public连接到google sheets。因此，每当我们的系统对google sheets进行更改时，数据的变化也会自动反映在Tableau中。</em></p><h2 id="6a2b" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">正则表达式</h2><p id="7008" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">正则表达式是文本分析的重要组成部分。它主要用于自动算法中，因为它的主要规范是匹配一个字符串或一组预先指定的字符串。</p><h2 id="6ae1" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">其他人</h2><p id="4c40" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated"><em class="mf">其他库如time和pycountry用于系统的高效性能。使用时间库，因为系统在若干情况下被设置为睡眠，以便平滑并发。Pycountry用于确定可视化位置。</em></p><h1 id="b07a" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">主要代码</h1><p id="3d54" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">在我们开始之前，你需要成为一名twitter开发者，并获得一些证书。这是一个简单的过程。我将在这里链接Shivani Dandir的文章，所以只需遵循最初的几个步骤，直到您获得您的消费者密钥和访问密钥。</p><p id="0947" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://towardsdatascience.com/extracting-data-from-twitter-using-python-5ab67bff553a#:~:text=Using%20Tweepy%20to%20extract%20tweets%20from%20Twitter&amp;text=For%20using%20the%20Twitter%20API,us%20retrieve%20data%20from%20Twitter." rel="noopener" target="_blank">使用Python从Twitter提取数据| Shiva ni Dandir |走向数据科学</a></p><h2 id="b7a3" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">使用Tweepy访问Twitter API:</h2><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="a58d" class="ln kg hi lj b fi lo lp l lq lr">#Twitter credentials for the app<br/>consumer_key = 'consumer_key'<br/>consumer_secret = 'consumer_secret'<br/>access_key= 'access_key'<br/>access_secret = 'access_secret'<br/><br/>#pass twitter credentials to tweepy<br/>auth = tw.OAuthHandler(consumer_key, consumer_secret)<br/>auth.set_access_token(access_key, access_secret)<br/>api = tw.API(auth)</span></pre><p id="7a2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这段代码将从您的twitter API中获取您的消费者密钥，并提取tweets。</p><h2 id="c93a" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">定义所有表情符号来帮助我们清理数据</h2><p id="5f9d" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">由于数据是实时提取的，因此不存在异常值等因素，因为不存在任何数据范围。缺少的数据(位置/标签)通常被更改为不可用，因为twitter用户不需要输入这些数据字段。虽然这么说，但有大量不一致的数据。</p><p id="5aad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特别是自从表情符号的引入，人们会认为基于表情符号识别的情感分析会更容易，事实上情况正好相反。大多数社交媒体用户使用表情符号是出于讽刺的目的，或者是为了讽刺挫败表情分析的目的。</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="a884" class="ln kg hi lj b fi lo lp l lq lr">#HappyEmoticons<br/>emoticons_happy = set([<br/>    ':-)', ':)', ';)', ':o)', ':]', ':3', ':c)', ':&gt;', '=]', '8)', '=)', ':}',<br/>   ':^)', ':-D', ':D', '8-D', '8D', 'x-D', 'xD', 'X-D', 'XD', '=-D', '=D',<br/>    '=-3', '=3', ':-))', ":'-)", ":')", ':*', ':^*', '&gt;:P', ':-P', ':P', 'X-P',<br/>    'x-p', 'xp', 'XP', ':-p', ':p', '=p', ':-b', ':b', '&gt;:)', '&gt;;)', '&gt;:-)',<br/>    '&lt;3'<br/>    ])<br/><br/># Sad Emoticons<br/>emoticons_sad = set([<br/>    ':L', ':-/', '&gt;:/', ':S', '&gt;:[', ':@', ':-(', ':[', ':-||', '=L', ':&lt;',<br/>    ':-[', ':-&lt;', '=\\', '=/', '&gt;:(', ':(', '&gt;.&lt;', ":'-(", ":'(", ':\\', ':-c',<br/>    ':c', ':{', '&gt;:\\', ';('<br/>    ])<br/><br/>#Emoji patterns<br/>emoji_pattern = re.compile("["<br/>         u"\U0001F600-\U0001F64F"  # emoticons<br/>         u"\U0001F300-\U0001F5FF"  # symbols &amp; pictographs<br/>         u"\U0001F680-\U0001F6FF"  # transport &amp; map symbols<br/>         u"\U0001F1E0-\U0001F1FF"  # flags (iOS)<br/>         u"\U00002702-\U000027B0"<br/>         u"\U000024C2-\U0001F251"<br/>         "]+", flags=re.UNICODE)<br/><br/>#combine sad and happy emoticons<br/>emoticons = emoticons_happy.union(emoticons_sad)</span></pre><p id="b6de" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这段代码编译了tweets中使用的所有基本表情符号，稍后我们将从文本中删除它们，以获得文本形式的更清晰的数据。</p><h2 id="6579" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">清理数据</h2><p id="dada" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">我们将使用下面的代码来清理所有的表情符号和停用词，所有不必要的标点符号等数据。</p><p id="7fab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过各种包清理我们从tweet上得到的文本。因为从tweet中提取的文本数据存在许多异常。早先开发者删除表情符号的代码被显示。正如前面在库部分提到的，Python自带tweet-pre-processor库，这个库会自动清理文本。此外，开发人员也使用手动清洗过程。最初，停用词被初始化并移除，随后移除表情符号，然后对整个剩余文本进行标记。Re和nltk.tokenize也用于去掉标点符号。我使用了姆维卡里·穆奥基的文章作为参考，您可以在下面找到:<br/> <a class="ae iu" href="https://mwi-kali.medium.com/african-influencers-twitter-users-segmentation-e52aba7a5bec" rel="noopener">非洲影响者:推特用户细分|由姆维卡里·穆奥基| Medium </a></p><p id="4fe1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特别是，这组代码应该可以工作:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/ca8218153056570b10fcaf7d70b5b511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JICE83-6Qt6QwWJY_hhHIw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">A Sample of the code (Taken from the article linked above).</figcaption></figure><p id="094f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦实现了这段代码，文本就会被清除。例如，文本字符串“这个水瓶……。“对我来说:D看起来很亮”将被简化为“水瓶很亮”，这有助于系统多愁善感地分析它。其他一些例子:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/e6e29276c39e5f43f66c911397a44a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQCOiyMtUjab-A-pjXBgKA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Before and After of Data Cleaning</figcaption></figure><h2 id="f240" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">一个简单的图形用户界面来配合这个系统</h2><p id="249d" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">一个没有GUI的程序什么都不是，所以对于这个系统，你将做一个非常简单的GUI，我们将使用Tkinter使它非常容易实现。</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="e959" class="ln kg hi lj b fi lo lp l lq lr">#Start of GUI<br/>window = Tk()<br/>#Title of Gui<br/>window.title("Sentiment Analysis")<br/>#multiple tabs<br/>tab_control = ttk.Notebook(window)<br/><br/>tab1 = ttk.Frame(tab_control)<br/><br/>tab2 = ttk.Frame(tab_control)<br/><br/>tab_control.add(tab1, text='System')<br/><br/>tab_control.add(tab2, text='About')<br/>#GUI window size<br/>window.geometry('1000x700')<br/>heading = Label(tab1, text="Welcome To Sentiment Analysis of tweets", font=("Arial Bold", 25))<br/>#GUI fields position<br/>heading.grid(column=1, row=0)<br/>lbl = Label(tab1, text="Please enter your keyword", font=("Times New Roman", 20))<br/>lbl.grid(column=1, row=10)<br/>txt = Entry(tab1,width=10)<br/><br/>txt.grid(column=2, row=10)<br/>prgbar = Label(tab1, text="Current status: Awaiting input from user", font=("Times New Roman", 10))<br/>prgbar.grid(column=3,row =12)<br/>#tab2<br/>abt = Label(tab2,text="Welcome To Sentiment Analysis of tweets", font=("Arial Bold", 25))<br/>abt.grid(column=1, row=0)<br/>abt2 = Label(tab2,text="Good Day", font=("Times New Roman", 15))<br/>abt2.grid(column=1, row=1)<br/>abt3 = Label(tab2,text="This program takes an input of a keyword from user and extracts latest 200-250 tweets relating to the keyword.", font=("Times New Roman", 15))<br/>abt3.grid(column=1, row=2)<br/>abt4 = Label(tab2,text="After extraction these tweets are analyzed exploratory and sentimentally before being presented visually", font=("Times New Roman", 15))<br/>abt4.grid(column=1, row=3)<br/>abt5 = Label(tab2,text="For more information please contact: Name", font=("Times New Roman", 15))<br/>abt5.grid(column=1, row=4)<br/>abt6 = Label(tab2,text="Email: ", font=("Times New Roman", 10))<br/>abt6.grid(column=1, row=5)<br/><br/><br/><br/>#process once the button is clicked<br/>def clicked():<br/>    messagebox.showinfo('Message', 'The analysis has begun')<br/><br/>    prgbar.configure(text="Current status: extracting tweets")</span></pre><p id="5fce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选项卡在GUI中创建了2个选项卡，其余的是我们使用过的标签和文本框。这将使系统看起来像这样:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/f091fa595d382abb3d2f56ab4fe17e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*kCRZs1b1A95-bbCyi8QIlg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">The Sample of What the GUI will look like</figcaption></figure><h2 id="434c" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">使用来自用户的关键词提取推文。</h2><p id="c959" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">这段代码将帮助我们首先从用户那里提取关键字，并使用该关键字提取250条最新推文。</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="fdde" class="ln kg hi lj b fi lo lp l lq lr">#extract keyword from user<br/>    search_words = txt.get()<br/><br/># Collect tweets<br/>    tweets = tw.Cursor(api.search,<br/>              q=  search_words,<br/>              lang="en").items(250)<br/>#print extraction of tweets<br/>    tweets_copy = []<br/>    for tweet in tqdm(tweets):<br/>        tweets_copy.append(tweet)<br/>        print(f"new tweets retrieved: {len(tweets_copy)}")<br/>        prgbar.configure(text=f"Current status: Tweets extracted, {len(tweets_copy)}" )</span></pre><h2 id="f26f" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">创建熊猫数据框架</h2><p id="c713" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">数据框架是非常关键的一步，因为在这里我们将放置所有的推文，存储它们，并对它们进行情感排序。以下是您将需要的代码:</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="6060" class="ln kg hi lj b fi lo lp l lq lr">#creation of dataframe<br/>polarity = []<br/>subjectivity = []<br/>Sentiment = []<br/>filtered_tweet = []<br/>clean_text = []<br/>country = []<br/>fltr_1 = []<br/>index = []<br/>Sentiment_rating = []<br/><br/>tweets_df = pd.DataFrame()<br/>for tweet in tqdm(tweets_copy):<br/>    clean_text = p.clean(tweet.text)<br/>    filtered_tweet = clean_tweets(clean_text)<br/>    blob = TextBlob(filtered_tweet)<br/>    Sentiment_rating = blob.sentiment<br/>    polarity = Sentiment_rating.polarity<br/>    #splitting 1st word<br/>    #fltr_1 = filtered_tweet.split()[0]<br/>    #sentiment in text output<br/>    subjectivity = Sentiment_rating.subjectivity<br/>    if polarity &gt;= 0.1 and polarity &lt;= 0.3:<br/>        Sentiment = " slightly positive"<br/>    elif polarity &lt; -0.1 and polarity &gt; -0.3:<br/>        Sentiment = "slightly negative"<br/>    elif polarity &gt;= 0.3:<br/>        Sentiment = "positive"<br/>    elif polarity &lt; -0.3:<br/>        Sentiment = "negative"<br/>    else:<br/>        Sentiment = "neutral"<br/>        #country name (where applicable)<br/>    for country in pycountry.countries:<br/>        if country.name in tweet.user.location:<br/>            country = country.name<br/>        else:<br/>            country = "Not Available"<br/>            #hashtags (where applicalble)<br/>    hashtags = []<br/>    try:<br/>        for hashtag in tweet.entities["hashtags"]:<br/>            hashtags.append(hashtag["text"])<br/>    except:<br/>        pass<br/>    tweets_df = tweets_df.append(pd.DataFrame({'tweet_id': tweet.id,<br/>                                           'tweet_location': country,<br/>                                           'polarity': polarity,<br/>                                           'subjectivity': subjectivity,<br/>                                           'Sentiment': Sentiment,<br/>                                           'date': tweet.created_at,<br/>                                           'text': tweet.text,<br/>                                           #'filtered_tweet': fltr_1,<br/>                                            'filtered_tweet': filtered_tweet,<br/>                                           'hashtags': [hashtags if hashtags else None],<br/>                                           'source': tweet.source,<br/>                                           'likes': tweet.favorite_count,<br/>                                           'is_retweet': tweet.retweeted}, index=[0]))<br/>    tweets_df.head()</span></pre><p id="a3ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我知道，我甚至知道这是什么代码，让我解释一下所有的单独属性:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/a68dc2c40faf38f8c726ce7c4f9e3e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*vjuUlqH7I8dZV3QgDt40ag.png"/></div></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/cd2d15ec16f6291e89137f8621dc9f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*UkXoN5-svFnzWG4LsWOYyw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Individual Attributes of Dataframe</figcaption></figure><h2 id="c5f1" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">将数据框架导出到GoogleSheets</h2><p id="23f4" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">此外，你还需要知道如何将数据帧插入谷歌工作表，不用担心！这将需要一些时间来完成，只需点击下面的链接就可以看到梅尔文·费尔南德斯的文章，这篇文章对此有很好的解释。</p><p id="5b66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://towardsdatascience.com/using-python-to-push-your-pandas-dataframe-to-google-sheets-de69422508f" rel="noopener" target="_blank">使用Python将您的熊猫数据框推送到Google Sheets |作者Melvynn Fernandez |走向数据科学</a></p><p id="b865" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们这样做是因为我们想使用tableau，为了使整个过程实时，我们将数据帧导出到Google Sheets中，等待tableau自动调整为新数据。</p><p id="fe58" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还记得之前您学习如何从google sheets获取服务文件并将其实现到python中吗？我们现在将使用它:</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="4020" class="ln kg hi lj b fi lo lp l lq lr">#EXPORTING DATAFRAME ONTO GOOGLESHEETS<br/>    client= pygsheets.authorize(service_file='<strong class="lj hj"><em class="mf">filepath</em></strong>')<br/>    lbl.configure(text="Authorized")<br/><br/>    sheet = client.open("fyp_tw")<br/>    prgbar.configure(text="Current status: Sheet opened")<br/><br/>    wks = sheet[0]<br/>    prgbar.configure(text="Current status: First sheet Accessed")<br/><br/>    wks.set_dataframe(tweets_df,(1,1))<br/>    prgbar.configure(text="Current status: Data Updated")</span></pre><p id="94d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您在Google Sheets中的数据将如下所示:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/f69dbac43b12213f7d3433a59c86a02f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*Ngli91YvBJhfc45EDunz4A.png"/></div></figure><h2 id="42f7" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">（舞台上由人扮的）静态画面</h2><p id="3799" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">要制作一个仪表板，下载Tableau public并创建你自己的仪表板，你可以把它连接到Google Sheets。您可以使用我的仪表板作为示例:</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="136d" class="ln kg hi lj b fi lo lp l lq lr"><a class="ae iu" href="https://public.tableau.com/views/FYPdash_16004530851980/FYPDashboard?:language=en&amp;:display_count=y&amp;publish=yes&amp;:origin=viz_share_link" rel="noopener ugc nofollow" target="_blank">https://public.tableau.com/views/FYPdash_16004530851980/FYPDashboard?:language=en&amp;:display_count=y&amp;publish=yes&amp;:origin=viz_share_link</a></span></pre><p id="573a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你在连接google sheets或制作仪表盘时遇到问题，我会附上一些简单易懂的资源:</p><p id="6a25" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.youtube.com/watch?v=O8j7FeA9J_U" rel="noopener ugc nofollow" target="_blank">将Google Sheets连接到Tableau &amp;连接数据— Tableau教程P.1 — YouTube </a></p><p id="90f3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae iu" href="https://www.youtube.com/watch?v=TPMlZxRRaBQ" rel="noopener ugc nofollow" target="_blank">数据科学和数据可视化Tableau速成教程— YouTube </a></p><p id="805b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是一些您可以使用的可视化示例:</p><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/9fab9453ff75a455c3649864cfdc6095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*NhfhYLESFclw4ihKaduVrQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Bubbles of Sentiments</figcaption></figure><figure class="kb kc kd ke fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mn"><img src="../Images/8cfafe71dca2ae9a8d97cd1fc63a9555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*aNAPFsmBMugLi4uGr5eb_Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Word Cloud for most associated word</figcaption></figure><h2 id="3722" class="ln kg hi bd kh ls lt lu kl lv lw lx kp jg ly lz kt jk ma mb kx jo mc md lb me bi translated">最后</h2><p id="af9c" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">只需使用下面的代码来关闭整个系统，并使其工作</p><pre class="kb kc kd ke fd li lj lk ll aw lm bi"><span id="cce9" class="ln kg hi lj b fi lo lp l lq lr">webbrowser.open("your public tableau link")<br/><br/>btn = Button(tab1, text="Click Me to start Analysis", command=clicked)<br/><br/>btn.grid(column=3, row=10)<br/>tab_control.pack(expand=1, fill='both')<br/><br/>window.mainloop()<br/></span></pre><figure class="kb kc kd ke fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/6000262b8cbd0db7bc310e5cd069d741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*hpjlcitI9IWGVwZgxNkCbg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">A sample Output</figcaption></figure><p id="7962" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就对了。如果您遇到任何问题，请随时联系我们！</p><p id="a29d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这篇文章有所帮助！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Roll Initiative!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">滚主动！</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/roll-initiative-ec1343797da1?source=collection_archive---------36-----------------------#2021-08-02">https://medium.com/geekculture/roll-initiative-ec1343797da1?source=collection_archive---------36-----------------------#2021-08-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="6fa4" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用Unity 3D和C#创建一个事件驱动系统，用于在回合制战术游戏中对演员进行排序</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/042e50431333da18e8be334a2699590f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZ7W65M_FTW0sJnlhMuo9g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Zip is running circles around Zap this round.</figcaption></figure><p id="695b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们的目标是:使用Unity 3D和C#我们希望构建一个系统，它可以提醒任意数量的参与者掷出一个随机数，并报告他们的姓名和倡议编号，以键/值对的形式存储在字典中。</p><p id="c867" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在第一部分，我们将使用Func <tresult>委托。这是一种可以接受任何返回由TResult指定的类型的函数的委托。在这种情况下，我们需要一个委托方法来返回一个整数值——参与者的主动角色。</tresult></p><p id="220a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">委托声明如下所示:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/041c1ca31f0498470d788bd478e0f8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9a1oQQEsFiNkWjJuLUBMLA.png"/></div></div></figure><p id="2f86" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">当我们发出该轮已经开始的信号时，订阅该委托的任何函数都将返回一个整数。让我们找一些订户:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/452152dcb47d39342560ccb0fe34cc74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77NBhvG9FkJTR9Cddofhvg.png"/></div></div></figure><p id="ec3f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里我有一个抽象的actor类，我的各种Actor类型可以继承它。由于每种参与者都有不同的方法来计算他们的主动性，我将为OnRoundStart委托订阅一个抽象的RollInitiative() int函数。现在，无论他们用什么方法来确定返回值，都取决于他们自己。这里有一个例子:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/104b50efa9288b09d586d1e096fd6965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtdFU9A5BSOnoUdqjgG5VA.png"/></div></div></figure><p id="345b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">接下来我们将声明字典:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/cdc5c938f92570153a3a9bd175d5f009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kFUJic8caGwMwWBziKIajQ.png"/></div></div></figure><p id="e893" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里有两个问题。</p><p id="d66a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">第一个问题:我们需要不止一个整数返回给我们。我们将这些信息放入一个字典中，它需要两种类型的数据——一个游戏对象(参与者)和一个整数(参与者的主动得分)。</p><p id="4d9e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">另一个问题:我们的Func委托是<em class="kk">多播，</em>意味着有多个订户。如果我们试图存储OnRoundStart <strong class="jp hj">的返回值，我们将只能获得调用列表中最后一个订户的值。</strong>显然，我们希望存储每个订户的值，所以简单的<em class="kk"> int roll = OnRoundStart？。Invoke() </em>将不起作用。</p><p id="1b0c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们可以在一个<em class="kk"> foreach </em>循环中解决这两个问题。第一个问题将通过使用委托来解决。目标属性。如果我们将目标转换为一个Actor，我们可以将Actor实例附加到的游戏对象存储在一个变量中，并将其用作字典键/值对的键的一半。</p><p id="4727" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了解决第二个问题，我们使用委托迭代foreach循环。GetInvocationList()方法。此方法保留委托的所有订阅者的列表。我们依次调用()每个订阅者，并将返回的整数存储到一个变量中，用作字典键/值对的值的一半。</p><p id="81bd" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">下面是实现这一切的C#方法:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kj"><img src="../Images/655652ffce72f9a061b5deba0a080588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SK8dcWheHI2cW06ff-XTVg.png"/></div></div></figure><p id="080f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">从那里我们得到以下输出:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/3c1bce89f289f77f5f77a25d3f748742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cR3nuIRH7EYnPEVgS9mUQA.png"/></div></div></figure><p id="4a1e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">前四个条目来自单个参与者的RollInitiative()方法，后四个条目是存储在Initiative字典中的内容的详细信息。完全匹配。</p><p id="04cf" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在下一篇文章中，我们将通过将字典中的每个键/值对加载到LinkedList <t>()中来使用字典，我们可以根据游戏的回合进展和参与者行动的初始成本来遍历和重新排序这个链表。</t></p></div></div>    
</body>
</html>
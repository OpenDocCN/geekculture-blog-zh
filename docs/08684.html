<html>
<head>
<title>Scraping Player Game Logs from NBA and ESPN Websites</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从NBA和ESPN网站抓取玩家游戏日志</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/scraping-player-game-logs-from-nba-and-espn-websites-18512eb9980?source=collection_archive---------6-----------------------#2021-11-10">https://medium.com/geekculture/scraping-player-game-logs-from-nba-and-espn-websites-18512eb9980?source=collection_archive---------6-----------------------#2021-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="2a15" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">硒，要求，美丽的Soup和熊猫</h2></div><p id="f71b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">电影“金钱球”向观众展示了采用统计分析可以提高运动队的表现。然而，它几乎没有提到乔纳·希尔的角色是如何收集所有这些数据的，或者普通的体育爱好者是否可以在不订阅付费服务的情况下做同样的事情。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/0ddf35e4e92ab5a11487b9835dc87802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiLWl3GCgmpksxK--dLMVg.jpeg"/></div></div></figure><p id="f4d4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本帖中，我们将看到一个体育爱好者如何使用python上的一些web抓取工具来获取公开可用的体育数据，以便进行更广泛的分析。</p><p id="ac02" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">我们要克服的主要障碍是</strong>我们必须一起整理两个数据源(【nba.com】T2和【espn.com】T4)，以获得更完整的视图和自动化流程。</p><h1 id="828f" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">内容</h1><p id="da44" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated"><a class="ae kf" href="#b8e4" rel="noopener ugc nofollow"> <strong class="iz hj">挑战一:</strong> </a></p><p id="39ff" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#c762" rel="noopener ugc nofollow"> <strong class="iz hj">挑战#2: </strong> </a></p><p id="6487" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#a5ed" rel="noopener ugc nofollow"> <strong class="iz hj">刮伪代码</strong> </a></p><p id="245f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#f735" rel="noopener ugc nofollow"> <strong class="iz hj">导入库</strong> </a></p><p id="a819" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#1d54" rel="noopener ugc nofollow"> <strong class="iz hj">第一步——游览NBA.com</strong></a></p><p id="23ed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#38cc" rel="noopener ugc nofollow"> <strong class="iz hj">第二步——在ESPN数据库中搜索球员id</strong></a></p><p id="c4d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#0b62" rel="noopener ugc nofollow"> <strong class="iz hj">第三步——访问ESPN.com获取游戏日志</strong> </a></p><p id="9d74" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae kf" href="#cdd7" rel="noopener ugc nofollow"> <strong class="iz hj">结论</strong> </a></p><h1 id="b8e4" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated"><strong class="ak">挑战#1: </strong></h1><p id="c272" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">如下图截图所示，通过在特定结构(球员的ESPN数据库id +年份)上发送url请求，我们可以通过那个球员的比赛统计得到季后赛，常规赛，季前赛的比赛。在这个例子中，可以看到沙奎尔·奥尼尔在ESPN服务器上的球员ID是614。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ld"><img src="../Images/8591133952b9b7926bd31079c5dedde9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zq0iV4aUW8CeZBYtTopOxQ.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Player Gamelog Example</figcaption></figure><p id="0fbd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们想知道蒂姆·邓肯的ESPN ID是什么，我们可以谷歌一下下面的关键词，得到他的ID，这要感谢谷歌给了我们第一个最相关的搜索结果。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es li"><img src="../Images/5953bad7ed9ada4c954001282923ef76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwWUkI8wY1QwyUHXBnI4Fw.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">Tim Duncan’s ESPN Player ID is 215, bottom left corner of the picture</figcaption></figure><h1 id="c762" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">挑战2:</h1><p id="41f8" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">尽管所有的NBA明星球员都是世界闻名的，但联盟中仍有许多球员的名气相对较小，比如当球队明星扣篮或投进3分时，他们会在板凳上挥舞毛巾。如果我们还想得到他们的游戏日志呢？</p><p id="2933" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">幸运的是，nba.com可以给我们一份完整的球员名单，按照他们的名字排序，包括他们的简历和关键数据，如下图所示。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lj"><img src="../Images/b2db0f90859c851073cc59e434439e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIx-YGrVsuyQyxMGuuccDg.png"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx">nba.com player bios screenshot, 50 Rows out of 441, page 1 of 9</figcaption></figure><h1 id="a5ed" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">刮除伪代码</h1><p id="473b" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">步骤1(与硒)-访问nba.com为一个特定的季节得到球员的bios (A到Z)，</p><p id="b9a7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第二步(带请求+ BeautifulSoup)- Google“球员姓名nba espn gamelog”并从第一个Google结果中获取每个球员的espn球员ID，</p><p id="e82d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">第三步(用熊猫Read _ html)<strong class="iz hj"/>——访问https://www.espn.com/nba/player/gamelog/_/id/<a class="ae kf" href="https://www.espn.com/nba/player/gamelog/_/id/" rel="noopener ugc nofollow" target="_blank"/>+球员的espn数据库id +我们感兴趣的年份，在ESPN上逐场比赛统计读取HTML表格。</p><h1 id="f735" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">导入库</h1><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="1d54" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">第一步——游览NBA.com</h1><p id="94f7" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们定义了一个从nba.com获取播放器bios表的函数。为此，我们需要selenium模块。因为我们需要点击页面上的一些按钮(接受cookies或选择所有结果而不是第一页),并且html结果是动态的，这需要等待一段时间才能获得更新后的页面结果。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="0fc9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们设法拿到了播放器的bios。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lm"><img src="../Images/fa4d50c8b092d85b65874261dbc567a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NLORFXBjsK0hEXFOyUmXaw.png"/></div></div></figure><h1 id="38cc" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">第二步——在谷歌上搜索ESPN数据库中的球员id</h1><p id="ebc8" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">用下面的for循环，我们将谷歌那个赛季每个球员的ESPN id。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="0cc7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的截图显示了一些在2000年被选中的球员，他们的bios和ESPN _游戏日志_ID。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es ln"><img src="../Images/ad73099f0090ecf55c2e8ba81e241fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PFvN3vLBNPdf9q2aprDNdg.png"/></div></div></figure><p id="031b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们去拿他们的游戏日志。</p><h1 id="0b62" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">第三步——参观ESPN.com获取游戏日志</h1><p id="6f71" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">我们定义了一个函数，使用pandas的read_html方法从espn.com获取玩家游戏日志表。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="fcb7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们选择了2000年被选中的球员，并通过2000 / 2001赛季的比赛统计来搜索他们的比赛。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="253a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">瞧！</strong></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lm"><img src="../Images/0316ad27f08d1c5fd4e423969a1fae0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQWhtNwKrFCwtUV5B5L0OA.png"/></div></div></figure><h1 id="cdd7" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">结论</h1><p id="41ba" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在这篇文章中，我们从不同的网站搜集了公开的体育数据，以获得每个球员更详细的信息。如果我们只依靠nba.com，我们不会得到NBA 2000名新秀每场比赛的上场时间统计。如果我们只依靠espn.com，我们不会得到2000年选秀的NBA球员的完整名单。通过将不同的抓取模块放在一起，我们从动态和静态html结果中获得数据。</p><p id="67d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽管体育分析服务需要付费订阅，但普通体育爱好者仍有希望在线获取数据。<strong class="iz hj">免费！</strong></p></div></div>    
</body>
</html>
<html>
<head>
<title>Installing NFS on Ubuntu 20.04 server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 20.04服务器上安装NFS</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/installing-nfs-on-ubuntu-20-04-server-3993bf9ac1b6?source=collection_archive---------8-----------------------#2021-12-21">https://medium.com/geekculture/installing-nfs-on-ubuntu-20-04-server-3993bf9ac1b6?source=collection_archive---------8-----------------------#2021-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="dd93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你好，我正在谈论NFS和NFS的安装。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/402eb4ef240d4f743f6f14ecaf2d2d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSKGAWP84SPxyLb8UdADYw.png"/></div></div></figure><p id="e495" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NFS是网络文件系统的缩写，是一种分布式文件系统<br/>协议。通过网络与他人共享文件和目录。<br/>可以帮你分享。远程系统上的程序<br/>彼此共享信息，就像它们在机器上一样，并且<br/>允许访问。</p><p id="8456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NFS运行在客户机-服务器环境中。换句话说，如果您要设置NFS在两个系统之间共享文件，必须将一个系统配置为服务器，另一个系统配置为客户端。</p><p id="5927" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">服务器充当管理员，验证和授权客户端访问共享数据。几乎任何数量的客户端都可以像访问本地存储中的任何其他文件或目录一样简单地访问共享数据。</p><h1 id="1597" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何在Ubuntu服务器上安装NFS服务器</h1><p id="e858" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我准备了一个详细的分步指南，指导你如何在Ubuntu中安装和设置NFS服务器，这样你就可以开始与其他客户端系统共享数据了。在本教程中，我们将使用Ubuntu 20.04 LTS。</p><h2 id="83b7" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">配置主机服务器</h2><p id="2920" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">要安装主服务器，您必须首先安装NFS内核服务器。<br/>必须。完成后，与所有客户端系统共享<br/>您可以创建和导出您想要的文件和目录。</p><p id="c617" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们完成这件事。</p><h2 id="a108" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤1:为NFS内核服务器安装服务器</h2><p id="afb2" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">NFS内核服务器到Ubuntu系统，首先作为服务器运行。我们需要安装这个软件包。但在此之前，下载系统软件包，以确保在此过程中不会出现任何问题。<br/>更新一下吧。</p><p id="d2b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，请在终端中键入以下命令:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="9475" class="ks jq hi lh b fi ll lm l ln lo">sudo apt update</span></pre><p id="0d16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于所有系统软件包更新，是时候使用以下命令安装软件包“nfs-kernel-server”了:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="f815" class="ks jq hi lh b fi ll lm l ln lo">sudo apt install nfs-kernel-server</span></pre><p id="0017" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这也将在您的系统上安装一些额外的软件包，包括“nfs-common”和“rpcbind”，它们是设置文件共享所必需的。</p><h2 id="53dc" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤2:创建NFS导出目录</h2><p id="8c05" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">在安装了“nfs-kernel-server”包之后，您现在可以创建一个nfs导出目录(简称为“导出目录”)，它将与所有客户机系统共享。为此，请在终端中键入以下命令。</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="8c15" class="ks jq hi lh b fi ll lm l ln lo">sudo mkdir -p /mnt/nfs_share</span></pre><p id="9914" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您希望客户端可以访问的所有文件都必须在此目录中创建。因为我们希望客户端系统对这个共享目录拥有完全访问权，所以我们需要删除任何限制访问权的目录权限。</p><p id="4d4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以通过以下命令完成:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="fc36" class="ks jq hi lh b fi ll lm l ln lo">sudo chown -R nobody:nogroup /mnt/nfs_share/</span></pre><p id="7b82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成上述命令后，继续下一步。</p><h2 id="0568" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤3:为客户端系统分配NFS服务器访问权限</h2><p id="c4e3" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">准备好导出目录后，您需要授予客户端系统对主服务器的访问权限。该权限在系统的/etc文件夹中的“exports”文件中定义。</p><p id="dce5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将需要编辑这个文件，并添加一些额外的命令行，以使客户端能够访问其系统的导出目录。因此，通过在终端中输入以下命令，使用Nano编辑器打开它:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="7c64" class="ks jq hi lh b fi ll lm l ln lo">sudo nano /etc/exports</span></pre><p id="ce1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从这里，您可以为单个客户端、多个客户端或整个子网提供NFS服务器访问。在本次阅读中，我们将为所有子网提供对NFS共享的访问。</p><p id="4394" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，您需要将这一行添加到“导出”文件中。</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="69e2" class="ks jq hi lh b fi ll lm l ln lo">/mnt/nfs_share subnet(rw,sync,no_subtree_check)</span></pre><p id="5999" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，您需要在提供的占位符中更改系统的子网。</p><p id="1753" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，让我们看看命令的其他部分是什么意思:</p><p id="6fe3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> rw : </strong>读/写命令<br/> <strong class="ih hj"> sync : </strong>更改在应用之前在磁盘上进行。<br/><strong class="ih hj">no _ subtree _ check</strong><strong class="ih hj">:</strong>取消子树检查。</p><p id="fbbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果您只想向单个客户端授予访问权限，可以使用以下语法:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="b637" class="ks jq hi lh b fi ll lm l ln lo">/mnt/nfs_share client_IP_1(rw,sync,no_subtree_check)</span></pre><p id="5901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于多个客户端关节，您必须一个接一个地这样做:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="919a" class="ks jq hi lh b fi ll lm l ln lo">/mnt/nfs_share client_IP_1(rw,sync,no_subtree_check)</span><span id="05f7" class="ks jq hi lh b fi lp lm l ln lo">/mnt/nfs_share client_IP_2(rw,sync,no_subtree_check)</span></pre><p id="56c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于客户端系统可以访问NFS服务器，现在是时候进入下一步了。</p><h2 id="de4a" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤4:导出共享NFS目录</h2><p id="6e77" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">有了上面所有可用的配置，就可以导出共享的NFS目录并使其对客户端系统可用了。</p><p id="2892" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以使用以下命令快速完成:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="fcd5" class="ks jq hi lh b fi ll lm l ln lo">sudo exportfs -a</span></pre><p id="4185" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为NFS执行此操作，以确保所有配置都有效。<br/>需要重启内核服务器。</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="aaef" class="ks jq hi lh b fi ll lm l ln lo">sudo systemctl restart nfs-kernel-server</span></pre><p id="9ea3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，是时候进入这个设置的最后一步了。</p><h2 id="8ad8" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤5:允许客户端通过防火墙</h2><p id="9480" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">授予客户端对NFS服务器的访问权限并导出共享目录(即使在传输后)后，如果客户端被防火墙阻止，它们仍然无法访问文件。因此，您需要为您的客户端打开防火墙。你的Ubuntu电脑已经有了一个默认的防火墙——UFW(简单防火墙)。</p><p id="23c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以键入以下命令来检查它在您的系统上是否有效:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="7434" class="ks jq hi lh b fi ll lm l ln lo">sudo ufw status</span></pre><p id="9ceb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果它显示为非活动，您必须使用以下命令将其重新打开:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="075f" class="ks jq hi lh b fi ll lm l ln lo">sudo ufw enable</span></pre><p id="556e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果由于某种原因它没有安装在您的系统上，您可以使用以下命令来安装它:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="2d46" class="ks jq hi lh b fi ll lm l ln lo">sudo apt install</span></pre><p id="0cf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在你的Ubuntu系统上安装并启用UFW后，你需要配置它来允许访问你的客户端。</p><p id="2819" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们为NFS提供了对整个子网的访问，因此我们需要使用以下命令:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="61eb" class="ks jq hi lh b fi ll lm l ln lo">sudo ufw allow from subnet to any port nfs</span></pre><p id="f6df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果您只允许基于每个客户端的NFS访问，则需要输入客户端IP作为。</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="ba18" class="ks jq hi lh b fi ll lm l ln lo">sudo ufw allow from client_IP_1 to any port nfs</span></pre><p id="d16a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！您已经在服务器计算机上成功安装并配置了NFS服务。</p><h1 id="67a3" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">配置客户端系统</h1><p id="e642" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">接下来，我们需要在客户端系统上安装和设置NFS来访问共享目录。与上一个类似，这里有一个分步指南来帮助你。</p><h2 id="a865" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤1:安装NFS通用软件包</h2><p id="c24c" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">安装NFS共享的客户端系统时，请安装“nfs-common”软件包。我们需要设置。如前所述，您必须首先更新系统软件包，然后使用以下命令更新NFS-common<br/>您必须安装:</p><p id="bdc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要更新软件包:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="37dd" class="ks jq hi lh b fi ll lm l ln lo">sudo apt update</span></pre><p id="cd0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要安装nfs通用软件包，请执行以下操作:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="20d6" class="ks jq hi lh b fi ll lm l ln lo">sudo apt install nfs-common</span></pre><p id="24ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成后，继续下一步。</p><h2 id="f2e1" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤2:让我们创建一个挂载点</h2><p id="5d38" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">接下来，您需要创建一个挂载点。它将用于从NFS服务器装载NFS共享文件。为此，请在终端中键入以下命令:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="6d32" class="ks jq hi lh b fi ll lm l ln lo">sudo mkdir -p /mnt/nfs_clientshare</span></pre><h2 id="69cb" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">步骤3:将NFS共享目录挂载到客户端系统</h2><p id="21e7" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">您在上述步骤中创建的文件夹与系统中的任何其他文件夹一样。要从主服务器访问NFS共享目录，您需要将其挂载到新文件夹:</p><p id="838c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，您必须首先知道NFS服务器的IP地址。<br/>必须。在服务器系统的终端中键入以下命令:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="0c2f" class="ks jq hi lh b fi ll lm l ln lo">ifconfig</span></pre><p id="3fc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将显示网络接口配置。服务器的IP <br/>是在“inet”下给出的IP，在我们的例子中是10.0.2.15。</p><p id="aef8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用此IP，在NFS客户端的终端中键入以下命令，最终将NFS共享目录挂载到客户端系统:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="a524" class="ks jq hi lh b fi ll lm l ln lo">sudo mount 10.0.2.15:/mnt/nfs_share /mnt/nfs_clientshare</span></pre><h2 id="01da" class="ks jq hi bd jr kt ku kv jv kw kx ky jz iq kz la kd iu lb lc kh iy ld le kl lf bi translated">第4步:链接看看是否一切正常测试它</h2><p id="5d11" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">通过按顺序执行以上步骤，您已经成功地创建了一个NFS服务器，用于在一个服务器系统和多个客户端系统之间共享文件和文件夹。</p><p id="bbab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剩下的工作就是检查一切是否正常。</p><p id="f6d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，请在服务器上的NFS共享目录中创建一个新文件。<br/>创造。您可以使用以下命令来完成此操作:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="5933" class="ks jq hi lh b fi ll lm l ln lo">cd /mnt/nfs_share/</span><span id="46ee" class="ks jq hi lh b fi lp lm l ln lo">touch file1.txt file2.txt file3.txt</span></pre><p id="1697" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该过程完成后，使用以下命令检查客户端系统，查看这些文件是否出现在NFS共享目录中:</p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="84af" class="ks jq hi lh b fi ll lm l ln lo">ls -l /mnt/nfs_clientshare/</span></pre><p id="6276" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您在列表中看到“file1.txt”、“file2.txt”和“file3.txt”文件，这意味着NFS服务器正在运行，您现在可以开始在客户端和服务器系统之间共享和接收文件。</p></div></div>    
</body>
</html>
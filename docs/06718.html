<html>
<head>
<title>Battle of the iOS Architecture Patterns: View Interactor Presenter (VIP)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS架构模式之战:查看交互演示者(VIP)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/battle-of-the-ios-architecture-patterns-view-interactor-presenter-vip-59ebdae86e84?source=collection_archive---------5-----------------------#2021-08-27">https://medium.com/geekculture/battle-of-the-ios-architecture-patterns-view-interactor-presenter-vip-59ebdae86e84?source=collection_archive---------5-----------------------#2021-08-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/53df6ee1068a751c17cae9aacdd3d990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMO3X4GPbN_09YAEK6TCoQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Architecture Series — View Interactor Presenter (VIP)</figcaption></figure></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="ed58" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">动机</h1><p id="7a7d" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在开始开发一个iOS应用之前，我们必须考虑项目的结构。我们需要考虑如何将这些代码添加到一起，以便它们在以后有意义——当我们回来重新访问应用程序的一部分时——以及如何与其他开发人员形成已知的“语言”。</p><p id="4c54" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">这是“架构模式”系列的最后一篇文章，我们将看到如何将VIP实现到Football Gather应用程序中。</p><p id="2660" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">如果您错过了其他文章，您可以在下面访问它们，或者您可以在本文末尾找到链接。</p><ul class=""><li id="1120" class="lc ld hi kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk bi translated">模型视图控制器(MVC)——<a class="ae ll" href="https://betterprogramming.pub/battle-of-the-ios-architecture-patterns-model-view-controller-mvc-442241b447f6" rel="noopener ugc nofollow" target="_blank">链接此处</a></li><li id="7feb" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">模型视图视图模型(MVVM)——<a class="ae ll" href="https://betterprogramming.pub/battle-of-the-ios-architecture-patterns-a-look-at-model-view-viewmodel-mvvm-bdfd07d9395e" rel="noopener ugc nofollow" target="_blank">链接此处</a></li><li id="4f5f" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">模特展示者(MVP)——<a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-model-view-presenter-mvp-f693f6efd23e">链接此处</a></li><li id="02f2" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">带协调员的模型视图演示者(MVP-C) — <a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-model-view-presenter-with-coordinators-mvp-c-99edf7ab8c36">链接此处</a></li><li id="285c" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">查看互动者演示者实体路由器(VIPER)——<a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-view-interactor-presenter-entity-router-viper-8f76f1bdc960">链接此处</a></li></ul><p id="8d24" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">你是不是不耐烦了，只想看看代码？别担心！你可以在GitHub 上找到它<a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/VIPER" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="498c" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">按照我们在其他帖子中使用的方法，我们将首先说一些关于这个模式的事情，以及它为什么有用。然后再看实际的实现。<br/>最后，我们将展示一些关于编译和构建时间的数字，检查编写单元测试有多容易，并陈述我们的结论。</p></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="2e55" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">为什么你的iOS应用需要一个架构模式？</h1><p id="92de" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">最需要考虑的是要有一个可维护的app。你知道视图在那里，这个视图控制器应该做X而不是y。更重要的是，其他人也知道。</p><p id="593d" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">以下是选择一个好的架构模式的一些优势:</p><ul class=""><li id="9528" class="lc ld hi kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk bi translated">更易于维护</li><li id="220e" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">更容易测试业务逻辑</li><li id="dfc1" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">与其他队友发展共同语言</li><li id="d975" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">分离实体的职责</li><li id="67eb" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">更少的错误</li></ul></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="5324" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">定义需求</h1><p id="e1e4" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">给定一个有六七个屏幕的iOS应用程序，我们将使用iOS世界最流行的架构模式来开发它:MVC、MVVM、MVP、VIPER、VIP和Coordinators。</p><p id="5560" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">该演示应用程序名为Football Gather，是朋友们跟踪业余足球比赛比分的一种简单方式。</p><h2 id="34e4" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">主要特征</h2><p id="0ebe" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">能够:</p><ul class=""><li id="8e5d" class="lc ld hi kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk bi translated">在应用程序中添加玩家</li><li id="122f" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">给运动员分配队伍</li><li id="eb54" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">编辑玩家</li><li id="678d" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">为比赛设置倒计时</li></ul><h2 id="da5e" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">屏幕模型</h2><figure class="mg mh mi mj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/669dcad664ef2b3270e4cbead48b1a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6e-HGbvAvd7lL-wXpd7zGQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Screen mockups of “Football Gather”, the iOS app</figcaption></figure><h1 id="5c90" class="jb jc hi bd jd je mk jg jh ji ml jk jl jm mm jo jp jq mn js jt ju mo jw jx jy bi translated">后端</h1><p id="c5b8" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">该应用由在<a class="ae ll" href="https://vapor.codes/" rel="noopener ugc nofollow" target="_blank"> Vapor web框架</a>中开发的web应用提供支持。你可以查看我的<a class="ae ll" href="https://www.radude89.com/blog/vapor.html" rel="noopener ugc nofollow" target="_blank"> Vapor 3初始篇</a>和关于迁移到Vapor 4 的<a class="ae ll" href="https://www.radude89.com/blog/migrate-to-vapor4.html" rel="noopener ugc nofollow" target="_blank">篇中的app。</a></p></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="8a11" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">像贵宾一样清理您的代码</h1><p id="cbf0" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">VIP不是一种常用的架构模式。它已由Raymond Law发明，旨在成为应用于iOS项目的大叔Bob Clean Architecture版本。更多内容请看这里:<a class="ae ll" href="https://clean-swift.com/" rel="noopener ugc nofollow" target="_blank">https://clean-swift.com/</a>。</p><p id="de14" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">VIP的主要目标是解决MVC中的大量视图控制器问题。VIP还打算为其他架构模式问题提供一个干净的替代方案。例如，VIPER将演示者放在应用程序的中心。VIP通过使用单向控制方式简化了流程，使得通过层调用方法变得更加容易。</p><p id="4ff1" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">VIP将您的应用程序控制转换为VIP周期，提供单向控制流。</p><p id="79d3" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">应用VIP的场景示例:</p><ol class=""><li id="632e" class="lc ld hi kb b kc kx kg ky kk le ko lf ks lg kw mp li lj lk bi translated">用户点击一个按钮来获取玩家名单。我们在<strong class="kb hj">视图控制器</strong>中。</li><li id="074b" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw mp li lj lk bi translated"><code class="du mq mr ms mt b">IBAction</code>从<strong class="kb hj">交互器</strong>中调用方法。</li><li id="1952" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw mp li lj lk bi translated"><strong class="kb hj">交互器</strong>转换请求，执行一些业务逻辑(从服务器获取玩家列表)并调用<strong class="kb hj">呈现器</strong>以可呈现的方式为用户转换响应。</li><li id="96d7" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw mp li lj lk bi translated"><strong class="kb hj">主持人</strong>调用<strong class="kb hj">视图控制器</strong>在屏幕上显示玩家。</li></ol><p id="6a71" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">体系结构组件描述如下。</p><h2 id="d070" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">视图/视图控制器</h2><p id="3bef" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">有两个功能:向<strong class="kb hj">交互器</strong>发送请求，并动作和显示来自<strong class="kb hj">演示器</strong>的信息。</p><h2 id="49e7" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">互动者</h2><p id="2952" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kb hj">的“新”主讲人</strong>。这一层是VIP架构的核心，执行诸如网络调用之类的任务来获取数据、处理错误、计算条目。</p><h2 id="72d4" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">工人</h2><p id="2a54" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">在足球聚会中，我们用“服务”来命名，但基本上这是一回事。一个<strong class="kb hj">工作器</strong>承担<strong class="kb hj">交互器</strong>的部分职责，并处理网络调用或数据库请求。</p><h2 id="9bc4" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">提出者</h2><p id="4396" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">处理来自<strong class="kb hj">交互器</strong>的数据，并将它们转换成适合在<strong class="kb hj">视图</strong>中显示的<strong class="kb hj">视图模型</strong>。</p><h2 id="f8dd" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">路由器</h2><p id="6b47" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">与VIPER中的角色相同，它负责场景转换。</p><h2 id="2678" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">模型</h2><p id="e57c" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">与其他模式类似，<strong class="kb hj">模型</strong>层用于封装数据。</p><h2 id="56aa" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">沟通</h2><p id="7945" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated"><strong class="kb hj">视图控制器</strong>与<strong class="kb hj">路由器</strong>和<strong class="kb hj">交互器</strong>通信。</p><p id="b419" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">交互器</strong>将数据发送给<strong class="kb hj">展示器</strong>。它也可以发送和接收来自<strong class="kb hj">工作器</strong>的事件。</p><p id="e298" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">呈现器</strong>将来自<strong class="kb hj">交互器</strong>的响应转换成<strong class="kb hj">视图模型</strong>并将其传递给<strong class="kb hj">视图/视图控制器</strong>。</p><h2 id="7bb7" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">优势</h2><ul class=""><li id="9bc1" class="lc ld hi kb b kc kd kg kh kk mu ko mv ks mw kw lh li lj lk bi translated">您不再有MVC中的大量视图控制器问题。</li><li id="d870" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">不正确地使用MVVM，你可能会得到大量的视图模型。</li><li id="ba53" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">用VIP循环解决了毒蛇的控制问题。</li><li id="1484" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">不正确地使用VIPER，你可以拥有大量的演示者。</li><li id="f1d8" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">作者说它遵循了干净的架构原则。</li><li id="767b" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">如果您有复杂的业务逻辑，它可以放入一个<strong class="kb hj"> Worker </strong>组件中。</li><li id="8387" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">非常容易进行单元测试和使用TDD。</li><li id="4041" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">良好的模块化。</li><li id="a53c" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">更容易调试。</li></ul><h2 id="e5a9" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">不足之处</h2><ul class=""><li id="cd77" class="lc ld hi kb b kc kd kg kh kk mu ko mv ks mw kw lh li lj lk bi translated">层太多，如果不使用代码生成器，过一会儿就会变得很无聊。</li><li id="d78b" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">即使是简单的动作，你也要写很多代码。</li><li id="7063" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">对小型应用程序来说不是很好。</li><li id="9183" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">根据您的应用程序使用案例，某些组件可能是多余的。</li><li id="3ba3" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">App启动会略有增加。</li></ul><h2 id="4e12" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">VIP vs毒蛇</h2><ul class=""><li id="9ccc" class="lc ld hi kb b kc kd kg kh kk mu ko mv ks mw kw lh li lj lk bi translated">在VIP中，<strong class="kb hj">交互器</strong>现在是与<strong class="kb hj">视图控制器</strong>交互的层。</li><li id="bce9" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated"><strong class="kb hj">视图控制器</strong>保存了对VIP中<strong class="kb hj">路由器</strong>的引用。</li><li id="2044" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">如果使用不当，蝰蛇会变成巨大的<strong class="kb hj">主持人</strong>。</li><li id="9aed" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">VIP具有单向的控制流。</li><li id="0a5e" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">服务人员在VIP中被称为<strong class="kb hj">工人</strong>。</li></ul></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="31b1" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">适用于我们的准则</h1><p id="5b78" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">将应用从VIPER转变为VIP可能没有你想象的那么容易。我们可以从将我们的<strong class="kb hj">呈现者</strong>转换成<strong class="kb hj">交互者</strong>开始。接下来，我们可以从<strong class="kb hj">表示器</strong>中提取<strong class="kb hj">路由器</strong>，并集成到<strong class="kb hj">视图控制器</strong>中。</p><p id="92cf" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">我们保留为VIPER所做的模块组装逻辑。</p><h2 id="32a3" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated"><code class="du mq mr ms mt b">Login</code>场景</h2><p id="e902" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">继续我们的场景。先说<strong class="kb hj">登录</strong>场景。</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="cefb" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">如你所见，我们不再告诉<strong class="kb hj">演示者</strong>视图已经被加载。我们现在请求<strong class="kb hj">交互器</strong>加载凭证。</p><p id="42a1" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><code class="du mq mr ms mt b">IBActions</code>已修改如下:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="47ea" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">我们启动加载视图，构造对<strong class="kb hj">交互器</strong>的请求，该请求包含用户名、文本字段的密码内容以及用于记住用户名的<code class="du mq mr ms mt b">UISwitch</code>的状态。</p><p id="5db6" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">接下来，通过<code class="du mq mr ms mt b">LoginViewConfigurable</code>协议处理<code class="du mq mr ms mt b">viewDidLoad</code> UI更新:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="e1a3" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">最后，当逻辑服务调用完成时，我们从<strong class="kb hj">表示器</strong>调用以下方法:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="869c" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">交互器</strong>看起来和VIPER架构中的那个一样。它具有相同的依赖关系:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="a004" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">这里的关键是我们现在通过初始化器注入了<strong class="kb hj">表示器</strong>，它不再是一个弱变量。</p><p id="c556" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">加载凭据如下所示。我们首先接收来自<strong class="kb hj">视图控制器</strong>的传入请求。我们为演示者创建一个响应，并调用函数<code class="du mq mr ms mt b">presentCredentials(response: response)</code>。</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="3926" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">登录和注册方法是相同的，除了网络服务(<strong class="kb hj"> Worker </strong>)。</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="5681" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">展示者</strong>不持有对<strong class="kb hj">路由器</strong>或<strong class="kb hj">互动者</strong>的引用。我们只保留<strong class="kb hj">视图</strong>的依赖关系，它必须很弱才能完成VIP周期，并且没有保留周期。</p><p id="0b3b" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">表示器</strong>已经被大大简化，公开了公共API的两个方法:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="4654" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">路由器</strong>层保持不变。</p><p id="e103" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">我们对<strong class="kb hj">模块</strong>组件进行了一些小的更新:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="25e6" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated"><code class="du mq mr ms mt b">PlayerList</code>场景</h2><p id="de2d" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">接下来，我们转到<code class="du mq mr ms mt b">PlayerList</code>场景。</p><p id="240b" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><code class="du mq mr ms mt b">ViewController</code>将会以类似的方式被转换——呈现者<strong class="kb hj">将会被交互者<strong class="kb hj">所取代，我们现在拥有了对<strong class="kb hj">路由器</strong>的引用。</strong></strong></p><p id="8160" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">VIP中一个有趣的方面是我们可以在<strong class="kb hj"> ViewController </strong>中拥有一组视图模型:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="598c" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">我们不再告诉<strong class="kb hj">演示者</strong>视图<strong class="kb hj">已经被加载。<strong class="kb hj"> ViewController </strong>将在初始状态配置其UI元素。</strong></p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="24b7" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">类似于<strong class="kb hj">登录</strong>,<code class="du mq mr ms mt b">IBActions</code>将构造一个请求，并将调用<strong class="kb hj">交互器</strong>中的一个方法。</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="2009" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">当数据将被获取并准备好显示时，<strong class="kb hj">呈现器</strong>将从<strong class="kb hj">视图控制器</strong>T1】中调用该方法。</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="6220" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">表格视图的数据源如下所示:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="a7b3" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">你可能注意到了，我们的细胞不再需要<strong class="kb hj">展示者</strong>。我们的视图控制器中有所有需要的东西(视图模型的数组)。</p><p id="347c" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">交互器</strong>详述如下:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="9e0c" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><strong class="kb hj">细节</strong>、<strong class="kb hj">添加</strong>、<strong class="kb hj">确认</strong>屏幕代表现在从<strong class="kb hj">演示者</strong>移动到<strong class="kb hj">互动者</strong>:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="618e" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">最后，<strong class="kb hj">主持人</strong>:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="62b0" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">测试我们的业务逻辑</h1><p id="1218" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">当单元测试<code class="du mq mr ms mt b">Gather</code>业务功能时，从VIPER切换到VIP并不像看起来那么难。<br/>基本上，<strong class="kb hj">互动者</strong>就是新的<strong class="kb hj">展示者</strong>。</p><p id="6c59" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">我们遵循相同的模拟方法，无论何时调用函数，布尔标志都被设置为true:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="8311" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">以下是<strong class="kb hj">交互器</strong>的一些单元测试:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="5cff" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">和<strong class="kb hj">演示器</strong>单元测试:</p><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="6f38" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">关键指标</h1><h2 id="39fc" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—协议</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="cdcb" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—视图控制器和视图</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="e470" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—模块</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="8b2c" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—路由器</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="3be8" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—演示者</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="4a08" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—交互器</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="8896" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">代码行—本地模型</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="4b3b" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">单元测试</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><h2 id="9108" class="lr jc hi bd jd ls lt lu jh lv lw lx jl kk ly lz jp ko ma mb jt ks mc md jx me bi translated">构建时间</h2><figure class="mg mh mi mj fd ij"><div class="bz dy l di"><div class="mx my l"/></div></figure><p id="2ce8" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated"><em class="mz">测试在8核英特尔酷睿i9，MacBook Pro，2019上运行。Xcode版本:12.5.1。大苏尔马科斯。</em></p></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="02fe" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">结论</h1><p id="c45a" class="pw-post-body-paragraph jz ka hi kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">我们将VIP应用到一个用VIPER编写的应用程序中，我们可能注意到的第一件事是<strong class="kb hj">演示者</strong>被简化了，更加整洁。如果我们来自一个MVC应用程序，视图控制器会因为关注点的分离而大大减少</p><p id="9720" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">VIP通过使用单向控制方式简化了流程，使得通过层调用方法变得更加容易。</p><p id="75ce" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">平均建造时间与蝰蛇和MVP相似，大约10秒。<br/>拥有更多的单元测试，会增加测试执行的时间。然而，我们比蝰蛇快一点。</p><p id="76d8" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">与VIPER相比，<strong class="kb hj">演示者</strong>已经大大减少了<strong class="kb hj"> 514 </strong>行代码。但是主要的缺点是我们增加了<strong class="kb hj">交互器</strong>中的行数，总体上增加了<strong class="kb hj"> 508 </strong>行代码。基本上，我们从<strong class="kb hj">主持人</strong>那里得到的东西，我们放进了<strong class="kb hj">互动者</strong>。</p><p id="8e82" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">个人比较喜欢蝰蛇。在VIP架构中有一些我不喜欢的东西，从我的角度来看，他们并没有像吹嘘叔叔的鲍勃原则那样遵循。</p><p id="945b" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">例如，为什么我们需要构造一个请求对象，即使它没有附加任何东西？我的意思是，我们不能这样做，但是如果你打开示例的<a class="ae ll" href="https://github.com/Clean-Swift/CleanStore/blob/master/CleanStore/Scenes/ListOrders/ListOrdersViewController.swift#L79-L83" rel="noopener ugc nofollow" target="_blank">repo</a>你可以看到大量的空请求对象。</p><p id="9054" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">有很多锅炉板代码。</p><p id="e702" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">在<strong class="kb hj"> ViewController </strong>中保存一个视图模型数组会增加复杂性，并且很容易与<strong class="kb hj"> Worker </strong>模型不同步。</p><p id="932d" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">当然，您可以使用自己的VIP变体来缓解这些问题。</p><p id="8943" class="pw-post-body-paragraph jz ka hi kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hb bi translated">从积极的方面来说，我喜欢VIP循环的概念，以及使用TDD是多么容易。然而，遵循层上的严格规则，每个微小的改变都很难实现。应该是软件吧？！</p></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="7aff" class="jb jc hi bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">有用的链接</h1><ul class=""><li id="ef9a" class="lc ld hi kb b kc kd kg kh kk mu ko mv ks mw kw lh li lj lk bi translated">iOS应用，足球聚会— <a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather" rel="noopener ugc nofollow" target="_blank"> GitHub回购链接</a></li><li id="4187" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">Vapor制作的web服务器应用程序— <a class="ae ll" href="https://github.com/radude89/footballgather-ws" rel="noopener ugc nofollow" target="_blank"> GitHub Repo Link </a></li><li id="134f" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">Vapor 3后端API<a class="ae ll" href="https://radu-ionut-dan.medium.com/using-vapor-and-fluent-to-create-a-rest-api-5f9a0dcffc7b" rel="noopener">文章链接</a></li><li id="cf0b" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">迁移到蒸汽4 <a class="ae ll" href="https://radu-ionut-dan.medium.com/migrating-to-vapor-4-53a821c29203" rel="noopener">文章链接</a></li><li id="d8af" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">模型视图控制器(MVC) — <a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/MVC" rel="noopener ugc nofollow" target="_blank"> GitHub回购链接</a>和<a class="ae ll" href="https://betterprogramming.pub/battle-of-the-ios-architecture-patterns-model-view-controller-mvc-442241b447f6" rel="noopener ugc nofollow" target="_blank">文章链接</a></li><li id="58bb" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">模型视图ViewModel (MVVM) — <a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/MVVM" rel="noopener ugc nofollow" target="_blank"> GitHub回购链接</a>和<a class="ae ll" href="https://betterprogramming.pub/battle-of-the-ios-architecture-patterns-a-look-at-model-view-viewmodel-mvvm-bdfd07d9395e" rel="noopener ugc nofollow" target="_blank">文章链接</a></li><li id="89ce" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">模型视图展示者(MVP)——<a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/MVP" rel="noopener ugc nofollow" target="_blank">GitHub回购链接</a>和<a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-model-view-presenter-mvp-f693f6efd23e">文章链接</a></li><li id="bb3f" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">协调员模式—带协调员的MVP(MVP-C)—<a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/MVP-C" rel="noopener ugc nofollow" target="_blank">GitHub Repo链接</a>和<a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-model-view-presenter-with-coordinators-mvp-c-99edf7ab8c36">文章链接</a></li><li id="df21" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">查看交互者展示者实体路由器(VIPER)——<a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/VIPER" rel="noopener ugc nofollow" target="_blank">GitHub Repo链接</a>和<a class="ae ll" rel="noopener" href="/geekculture/battle-of-the-ios-architecture-patterns-view-interactor-presenter-entity-router-viper-8f76f1bdc960">文章链接</a></li><li id="7d66" class="lc ld hi kb b kc lm kg ln kk lo ko lp ks lq kw lh li lj lk bi translated">查看互动演示者(VIP)——<a class="ae ll" href="https://github.com/radude89/footballgather-ios/tree/master/FootballGather/VIP" rel="noopener ugc nofollow" target="_blank">GitHub回购链接</a></li></ul></div></div>    
</body>
</html>
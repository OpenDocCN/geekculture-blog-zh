<html>
<head>
<title>How to handle click outside a div in React with a custom hook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用自定义钩子处理在一个div之外的点击</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-handle-click-outside-a-div-in-react-d2283dc4ed57?source=collection_archive---------13-----------------------#2021-06-24">https://medium.com/geekculture/how-to-handle-click-outside-a-div-in-react-d2283dc4ed57?source=collection_archive---------13-----------------------#2021-06-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/87aa4ecaa5e169a7959b5e604195ee36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gP2cJtJUYudbNBBd.png"/></div></div></figure><p id="e9d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一件非常重要的事情，尤其是在创建下拉菜单的时候。用户希望当他们在下拉菜单外单击时，下拉菜单会关闭。所以我们要看看如何做到这一点。</p><h1 id="c3f3" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">创建新的react应用程序</h1><p id="7143" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">创建react应用程序的先决条件-</p><ul class=""><li id="275c" class="kr ks hi is b it iu ix iy jb kt jf ku jj kv jn kw kx ky kz bi translated"><a class="ae la" href="https://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>(推荐最新版本)</li></ul><p id="9539" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装节点后，您需要运行以下命令-</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="fc29" class="lk jp hi lg b fi ll lm l ln lo">npx create-react-app handle-click-demo # you can name it anything you want</span></pre></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="2fe3" class="jo jp hi bd jq jr lw jt ju jv lx jx jy jz ly kb kc kd lz kf kg kh ma kj kk kl bi translated">启动应用程序-</h1><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="0f9e" class="lk jp hi lg b fi ll lm l ln lo"># npm<br/>npm start<br/># yarn<br/>yarn start</span></pre></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="f9cc" class="jo jp hi bd jq jr lw jt ju jv lx jx jy jz ly kb kc kd lz kf kg kh ma kj kk kl bi translated">清理过程</h1><ul class=""><li id="9114" class="kr ks hi is b it km ix kn jb mb jf mc jj md jn kw kx ky kz bi translated">删除App.js中div内部的所有内容，并删除顶部logo.svg的导入。</li><li id="2156" class="kr ks hi is b it me ix mf jb mg jf mh jj mi jn kw kx ky kz bi translated">删除App.test.js，SetupTests.js，logo.svg文件。</li><li id="d3b8" class="kr ks hi is b it me ix mf jb mg jf mh jj mi jn kw kx ky kz bi translated">删除App.css中的所有内容。</li><li id="d8ce" class="kr ks hi is b it me ix mf jb mg jf mh jj mi jn kw kx ky kz bi translated">在index.css中，在顶部添加这一行-</li></ul><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><p id="afb8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将创建自己的下拉列表，而不是使用select标记。</p><h2 id="dbf4" class="lk jp hi bd jq ml mm mn ju mo mp mq jy jb mr ms kc jf mt mu kg jj mv mw kk mx bi translated">创建下拉列表</h2><p id="8663" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们将创建一个按钮来打开和关闭下拉菜单。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="122c" class="lk jp hi lg b fi ll lm l ln lo">&lt;button&gt;Open&lt;/button&gt;</span></pre><p id="2471" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以在屏幕的左上角看到这个按钮。</p><figure class="lb lc ld le fd ij er es paragraph-image"><div class="er es my"><img src="../Images/a2c89a751fcc1c65137e51f0a237fb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:130/format:webp/1*hbb8ulVWkQi2L4tI37G2jQ.png"/></div></figure><p id="30f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将创建一个状态来检查下拉菜单是打开还是关闭。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="9bf9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将在按钮上添加一个onClick事件。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="0cee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果状态为真或假，我们将使用三元运算符更改按钮的文本。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="e5e5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们将创建下拉菜单。</p><p id="eba2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在按钮下面创建了一个简单的下拉菜单，有3个选项。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="b6a9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我对下拉菜单和应用程序div应用了一些基本的样式，以使元素居中。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h2 id="dbcd" class="lk jp hi bd jq ml mm mn ju mo mp mq jy jb mr ms kc jf mt mu kg jj mv mw kk mx bi translated">基于单击按钮呈现下拉列表</h2><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="84c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码的作用是，如果isOpen为真，则显示下拉列表，否则不显示任何内容。</p><p id="ac7c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是这有一个问题，如果你在div之外点击，下拉菜单不会关闭。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mz mk l"/></div></figure></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h2 id="871c" class="lk jp hi bd jq ml mm mn ju mo mp mq jy jb mr ms kc jf mt mu kg jj mv mw kk mx bi translated">创建自定义挂钩</h2><p id="2dac" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">我们将创建一个名为useComponentVisible的自定义挂钩。因此，在src目录中创建一个文件useComponentVisible.js，并添加以下代码片段。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="74fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这段代码使用了状态，并做了与我们创建下拉菜单时类似的事情。然后添加和删除事件监听器。</p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h2 id="0735" class="lk jp hi bd jq ml mm mn ju mo mp mq jy jb mr ms kc jf mt mu kg jj mv mw kk mx bi translated">使用自定义挂钩</h2><p id="4ad2" class="pw-post-body-paragraph iq ir hi is b it km iv iw ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn hb bi translated">现在，我们将在应用程序中使用自定义挂钩。</p><p id="3f24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">呼叫钩子。我们将用这个替换使用状态。现在这会产生一些错误。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="8029" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导入挂钩。</p><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="65a4" class="lk jp hi lg b fi ll lm l ln lo">import useComponentVisible from "./useComponentVisible";</span></pre><p id="4eb9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将把ref附加到按钮和下拉容器上，因为我们希望当我们单击其他位置时下拉容器关闭。</p><p id="75e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将把isOpen改为isComponentVisible，把setisOpen改为setIsComponentVisible，如下所示</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="9f4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们的下拉菜单运行良好。</p><figure class="lb lc ld le fd ij"><div class="bz dy l di"><div class="mz mk l"/></div></figure><p id="9506" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你从这篇教程中学到了什么。让我知道你接下来想看什么。✌</p><p id="13cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有用的链接-</p><p id="7f49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae la" href="https://github.com/avneesh0612/handle-click-outside-div" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><p id="662c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae la" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应堆文件</a></p><p id="7f92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae la" href="https://avneesh-links.vercel.app/" rel="noopener ugc nofollow" target="_blank">所有社交</a></p></div></div>    
</body>
</html>
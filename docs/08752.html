<html>
<head>
<title>Handling Missing Values in R using Tidyr</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Tidyr处理R中的缺失值</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/handling-missing-values-in-r-using-tidyr-da49766203f1?source=collection_archive---------3-----------------------#2021-11-13">https://medium.com/geekculture/handling-missing-values-in-r-using-tidyr-da49766203f1?source=collection_archive---------3-----------------------#2021-11-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5633f1a84f620979e9fa916d75d5fa4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbbGyaniC9OSiq9EtRoMYQ.jpeg"/></div></div></figure><p id="cb41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您是否听说过R中的缺失值，并想知道如何处理这些缺失值？那么，如果你把这篇文章看完，那是最好的。这篇文章不仅将讨论丢失值，而且我们将在这里花费大量时间实践如何使用tidyr包处理丢失值的情况。Hadley Wickham和他的团队创造了tidyr包来帮助你从杂乱的数据变得整洁。</p><p id="cf8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们开始讨论之前，还有一件事。我写过两篇重要的文章，非常详细地阐述了整齐数据的概念。你可以在这里阅读第一篇<a class="ae jo" href="https://arimoroolayinka.medium.com/a-gentle-introduction-to-tidy-data-in-r-b6673b4d304c" rel="noopener">，在这里</a>阅读第二篇<a class="ae jo" href="https://arimoroolayinka.medium.com/tidy-data-case-studies-using-r-648c87b40ecf" rel="noopener">。</a></p><p id="5765" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在标题为<strong class="is hj">“tidy数据简介”</strong>的Tidy数据系列的第一篇文章中，我深入探讨了主要的Tidy数据原则。在那篇文章中，我还强调了在讨论整洁数据的概念时需要注意的其他整洁数据原则。</p><p id="d8c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在这里讨论的动机是基于其中一个原则，即<strong class="is hj"> <em class="jp">“任何单元格值都不应该包含缺失值”。</em>T11】</strong></p><p id="db2a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，在我们检查如何处理丢失的值之前，最好知道R中丢失的值是什么。</p><h2 id="c5da" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated"><strong class="ak">R中有哪些缺失值？</strong></h2><p id="7337" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">当一个值未知时，我们就说它丢失了。在R中，我们用符号<strong class="is hj"> NA </strong>(不可用)来表示缺失值，而不可能的值(例如被零除)用<strong class="is hj"> NaN </strong>(不是数字)来表示。与SAS等软件不同，R对字符和数字数据使用相同的符号(NA)。</p><p id="127f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，NA不是字符串或数值，而是缺失的指示符。NA是一个唯一值，其属性不同于其他值。NA是R中为数不多的保留字之一，意思是你不能给任何东西起这个名字。</p><p id="8d46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">关于R中缺失值的重要说明</strong></p><ul class=""><li id="008a" class="kq kr hi is b it iu ix iy jb ks jf kt jj ku jn kv kw kx ky bi translated">is.na()用于测试对象是否为na</li><li id="c521" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">is.nan()用于测试nan</li><li id="6754" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">一个NaN值也是NA，但反之则不成立</li></ul><p id="f762" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了这些，我相信你现在对r中的缺失值有了高层次的理解。</p><p id="cb2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们看看如何使用tidyr包来处理丢失的值。</p><p id="d80a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">tidyr包提供了一组处理缺失值的函数。注意，我不会详尽地解释如何使用每个函数(及其所有参数)；然而，我会告诉你你需要知道什么来帮助你解决未来的价值缺失问题。</p><p id="79c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请放心，在这篇文章中，您将会学到很多好主意。你可以在GitHub 上找到这个实践演练<a class="ae jo" href="https://github.com/Predicare1/Tidy-Data-Case-Studies-in-R" rel="noopener ugc nofollow" target="_blank">的脚本，以便重现。</a></p><p id="fbc6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了演示如何使用tidyr处理R中的缺失值，我们将使用<strong class="is hj"> ggplot2 </strong>包中的<strong class="is hj"> msleep </strong>数据集。<strong class="is hj"> msleep </strong>是哺乳动物睡眠数据集。这是一个有83行和11个变量的数据集。你可以在这里阅读数据<a class="ae jo" href="https://www.rdocumentation.org/packages/ggplot2/versions/3.3.5/topics/msleep" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="a3d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一步是将<strong class="is hj"> tidyverse </strong>包加载到r中。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es le"><img src="../Images/a7ceb00374820346d8598c58b166dbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*rzNnZyf_vJ_X-L3640Zubg.png"/></div></figure><p id="a754" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将把ggplot2包加载到R中，因为我们将在这个演示中使用的msleep数据集就在那个ggplot2包中。之后，我们将使用<strong class="is hj"> data() </strong>函数将msleep数据集加载到r中。最后，我们将使用<strong class="is hj"> head() </strong>函数返回msleep数据集的前六(6)行。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/9c82f2ffb250b177aa497fcec8a9978a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*fuQa0ZPXkKS_5TqVBzP4zA.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lk"><img src="../Images/0edad43642f4d2d84282c1d44974da75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*8B-5xTljI1AKSGZ6oifaLw.png"/></div></figure><p id="68a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">head(m sleep)</strong>函数的结果让我们一次性浏览数据集，而不必查看所有数据。</p><p id="a487" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，让我们分别使用<strong class="is hj"> dim() </strong>和<strong class="is hj"> names() </strong>函数来检查数据集中列的维度和名称。这些初始步骤对于理解和熟悉我们想要在本文中使用的数据至关重要。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/c810474de1d2d78030ee7fb1d6512882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*JaAkf11XHKmPN4hpG5EnjA.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/8969c15bfa1df6050bd276ed99723d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*w1B3BrZAFrejBNzwn--57w.png"/></div></figure><p id="d8a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我上面提到的，这个数据帧有83行和11个变量。此外，我们可以看到数据集中列的名称。我建议您阅读数据文档，了解每个列名代表什么。</p><p id="24e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们计算数据集中每个变量缺失值的数量。我认为这是我们应该采取的一个重要步骤，因为我们对处理丢失的值感兴趣。</p><p id="54a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以用一个基本的R函数来完成这个任务。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/db3ac772a8b9c48aa8a6cab76f4efab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*jtFvjgCA22rVz3IzaA-9Qw.png"/></div></figure><p id="df63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">sapply()函数是r中的一个循环函数。上面的代码将遍历msleep数据的每一列或变量，并计算该变量中缺失值的总数。为了计算缺失值的数量，我编写了一个简单的匿名函数。</p><p id="beb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们看看下面的结果:</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/e02476817aedd8f434cc102cacd70f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YejS-p3C_3W0LK2oP4D9ZA.png"/></div></figure><p id="a30f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">vore列包含七个缺失值(NAs)。conservation列有29个，sleep_rem有22个，sleep_cycle有51个，brainwt有27个缺失值。</p><p id="9007" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以使用purrr包(tidyverse包之一)中的<strong class="is hj"> map() </strong>函数来实现这个确切的目的。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/448facef04abb084ea5a1a336ca652df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*jFX-rD0NhgXOBq_3VJAcWQ.png"/></div></figure><p id="1243" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:我没有返回这段代码的结果。我把它放在这里是为了向您展示如何使用map()函数来实现同样的目的。</strong></p><p id="ca47" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">再者，我觉得在msleep数据中计算出每个变量中的缺失比例是有意义的。现在，我将使用<strong class="is hj"> map() </strong>函数来完成这项工作。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/90266af9119667528cc1e54de3c764d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*1R3MTGPKnCxuo5AuwFuTBg.png"/></div></figure><p id="5f39" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码计算每个变量中缺失值的比例。你可能想知道<strong class="is hj"> % &gt; % </strong>是什么意思。它被称为管道操作符，用于按顺序和层次顺序将函数链接在一起。这里，我们想要获取msleep数据并检查每个变量的缺失值。然后，将其传递到下一行<strong class="is hj"> map(sum) </strong>中，以计算每个变量中缺失值的总和。然后，<strong class="is hj">地图(~。/ nrow(msleep)) </strong>表示选取之前计算的每个变量中缺失值的总和，除以msleep数据集中的行数(我们知道是83) <strong class="is hj">。</strong>最后，<strong class="is hj"> bind_cols() </strong>按列高效绑定多个数据帧。</p><p id="11fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有意思！现在，让我们看看结果。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/8fa434d0a85fae7b1b119208b308f168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*nFtb4htiDkk-AL9fvykyog.png"/></div></figure><p id="7205" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太神奇了！vore变量有大约8%的缺失值，守恒有34.9%，sleep_rem有26.5%，sleep_cycle有61.4%，brainwt有32.5%的缺失值。</p><p id="8937" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些比例将帮助我们决定如何处理每个变量中缺失的值。随着我们的深入，对于我们这里的工作，我们将引用vore、sleep_rem、sleep_cycle和brainwt列，因为它们包含NA值并且是数字列。</p><p id="c711" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:我没有包括conversation列，因为它是一个字符列，包含大约35%的缺失值。简而言之，我们不会在这里使用该专栏。</strong></p><p id="502a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从原始的msleep数据中，我们将使用dplyr包中的<strong class="is hj"> select() </strong>动词/函数来选择我们需要的列。我们可以将结果保存为一个名为<strong class="is hj"> msleep_data </strong>的新对象，以便将来使用。</p><p id="bc81" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注:</strong>DP lyr包隶属于tidyverse包家族。<strong class="is hj"> dplyr </strong>包非常强大，事实上，它是R中对数据操作最有用的包。这是我有史以来最好的数据处理软件包。你可以点击 <strong class="is hj">在R </strong> <a class="ae jo" href="https://www.coursera.org/learn/data-manipulation-with-dplyr-in-r/home/welcome" rel="noopener ugc nofollow" target="_blank">查看我在Coursera上题为<strong class="is hj">用dplyr进行数据操作的项目课程。我在那个课程中介绍了dplyr包的使用。</strong></a></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/00e6feedb0b9b9799b9d0ae268cadee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*emJ_Vm9kAUDQMAfa04aO9Q.png"/></div></figure><p id="6261" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们打印我们创建并保存在msleep_data对象中的新数据，并检查数据的维度。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/e78a88e4be3991ce6308d7c2c14c78ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Hbozv33wTocb1vCQG4H1FQ.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/37d59ce55c2056b11e72b789de86a9c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*FpxqDrRX-Hx5_h4SjTA7fQ.png"/></div></figure><p id="207b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如所料，我们可以看到我们选择的四列；维度确认仍然有83行，但不是11列，我们现在有4列。</p><p id="641b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">回想一下，vore变量只有7个(约8%)缺失值。我们可以决定删除vore列中NA值的行。我们将在vore列上使用tidyr中的<strong class="is hj"> drop_na() </strong>函数。</p><p id="bb45" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意:在使用drop_na()函数之前，一定要删除一列中缺少的行，因为这将删除整行数据或观察数据，从而影响其他列中该行的值。</strong></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/6aa20255409296e8aaff07fbcc7ae5a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*8r5JVhrYw-UXe1st-Zxzbw.png"/></div></figure><p id="ee32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们检查新的数据维度，我们已经从vore列中删除了七个缺失的值。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/eed371d0ab2ee86ecfbd5a9b4460cf4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*KJri9Qcfuh539TBhPs7NVQ.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/dc37428b91de33d163503700c1277590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*P0ARTEvojZGhaJfpYF75EQ.png"/></div></figure><p id="b5e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果显示数据现在有76行和4列。回想一下，最初的msleep数据有83行。因此，当我们从83中去掉7行时，我们将剩下76行。同样，回想一下我们使用dplyr包中的<strong class="is hj"> select() </strong>动词从原始数据集中的11个列/变量中选择4个；这就是为什么我们有四列。</p><p id="649b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据新msleep_data的结果，您会注意到sleep_rem、sleep_cycle和brainwt列中缺少值。让我们看看如何处理这些缺失的价值观。</p><p id="ee1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们想用零整数值(0L)替换sleep_rem列中的NA值。为此，我们将使用<strong class="is hj"> replace_na() </strong>函数。该函数用指定的值替换NAs。它需要一个名为<strong class="is hj"> replace </strong>的重要参数—如果数据是一个数据帧，则“replace”需要一个值列表，其中每一列都有一个要替换的NA值。你可以在这里阅读replace_na()文档<a class="ae jo" href="https://www.rdocumentation.org/packages/tidyr/versions/1.1.4/topics/replace_na" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/a7c00de2863d9a5a72798c5898a9c652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*4C6sjeOTgytO9rIs27-aMw.png"/></div></figure><p id="67db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我们想用0替换sleep_rem列中的NAs，所以我们使用了<strong class="is hj"> 0L </strong>来指定正确的数据类型。另外，这是一个数据帧，因此使用了<strong class="is hj">列表(sleep_rem = 0L)。</strong></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/2a16d30013c9f0b2719a44306b85b1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*8RFK2S2YDbTDviHRVQKVRw.png"/></div></figure><p id="4490" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太棒了。！！sleep_rem列中缺少的值用0填充。注意我们有0L；这是为了让我们替换的新值具有正确的数据类型<strong class="is hj"> —整数(dbl)。</strong></p><p id="cf91" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还可以向上或向下填充brainwt列中缺少的值。也就是说，我们可以用缺失值之前或之后的值来填充。这完全取决于您希望如何填充缺失的值。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/be04edde864219744698e7692c7969f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*LiLjOhkggI3bfqgUoqrxqQ.png"/></div></figure><p id="83d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，我们使用了fill()函数。tidyr包中的fill()函数使用下一个或上一个条目填充选定列中的NA值。这在通用输出格式中很有帮助，在这种格式中，值不会重复，只有在发生变化时才会被记录。</p><p id="83f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">的。方向参数指示填充缺失值的方向。我们可以填写“下”(默认)、“上”、“下上”(即先下后上)或“上下”(先上后下)。</p><p id="ad6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，我们希望向上填充(用当前缺失值之后的下一个值填充当前缺失值)。</p><p id="86c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了这个解释，让我们看看返回的结果。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/4086ca5c537f42e8f454b9bcb34f4af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*588V9NGco7TnyxzY4wqQCA.png"/></div></figure><p id="244c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您返回到之前的最后一个结果，您会注意到在brainwt列中，第一个、第三个、第六个和第七个值丢失了。在此结果中，brainwt列的第一个值(或第一行)现在被替换为0.0155(这是该列的第二个值且非缺失值)。</p><p id="0b73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">类似地，先前丢失的第三个值现在替换为0.00029(该列的第四个值)。此外，第6行和第7行被替换为下一个非缺失值，即第8个值-0.07。如果您检查brainwt列，您将看到我们向上填充了缺少的值。</p><p id="dbe6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请再看一遍这个解释，确保你理解了我在这里的解释，然后再继续。</p><p id="134d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们继续前进。同样，您会注意到sleep_rem列仍然有NAs，尽管我们在前面用0替换了它。为了解决这个问题，我们将把我们一起执行的最后两个操作链接起来。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/7e70963959167f7429993132daf6eb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*BMUkpNjbMmpTUmgYFTJLGw.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/f7b85f3f249e940a026e9af0a5167711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*jhgxIcl1PEmj7_mZtkQhmA.png"/></div></figure><p id="6b00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太神奇了！！！现在，我们得到了预期的结果。我们已经处理了sleep_rem和brainwt列中缺失的值。</p><p id="9aa1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们也可以决定向下填充brainwt列(即使用之前的值)。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/625238204673a32b8a1f3c2ce35fefba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*COoQhuN5xEe6mZjNfMYiug.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/7af39168ea3b78118d7b45b85588a25f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*ZmKH0DmmH-czDeSfr7Xw-w.png"/></div></figure><p id="bf24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的结果与我之前解释的向上填充正好相反。这里，向下填充用以前的值填充brainwt列中缺少的值。显然，从结果来看，即使在使用fill()函数之后，brainwt列的第一个值仍然缺失(NA ),因为没有以前的值来填充它。</p><p id="d166" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注:你也可以填写“downup”和“updown”。您可以更改。方向参数设置为“downup”或“updown ”,看看它是什么样子，并返回结果。</strong></p><p id="92b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我将让您按照自己的选择来处理sleep_cycle变量中缺少的值。能够做到这一点将有助于您巩固在本文中学到的知识。</p><p id="6cec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，可能会有这样的情况，您希望用平均值或中值来填充列中缺少的值。我更喜欢使用中位数来填充缺失值，因为它是一个有抵抗力的统计量(不容易受到异常值的影响)。</p><p id="a784" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">让我们看看如何做到这一点。</strong></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/875b1888a32131f4526920880042c8bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*r6zBkfO5gZ22K6gaDcdpvw.png"/></div></figure><p id="d8ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">哇…这里有很多信息。让我给你分析一下。我们这里有非常直接的。我们将msleep_data传递给一个名为<strong class="is hj"> mutate的dplyr动词或函数。</strong>动词<strong class="is hj"> mutate() </strong>帮助创建新列，同时保留其他列。记住replace_na()函数是如何工作的。</p><p id="38f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我们希望用中值替换sleep_cycle列中缺少的值，所以我们使用了<strong class="is hj"> median() </strong>函数。<strong class="is hj"> na.rm = T </strong>参数意味着我们希望在计算中值之前删除该列中缺失的值。如果您不添加该参数，那么当您计算中值时，它将返回NA。我认为这很直观。</p><p id="9f66" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在这里传达的想法是，您不能对缺失值执行任何计算；因此，需要首先删除那些丢失的值，计算中值，然后使用replace_na()函数用中值替换丢失的值。最后，我们将这个被替换的列保存到原始列中，以实现我们刚才所做的更改。</p><p id="e6db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看上面代码的结果。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/496e7fbd6f0c70f2e8d4927d7ca16f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*flQigwfm-2aLpLgvcSIl-w.png"/></div></figure><p id="fbb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">漂亮！！！这一列的中值是0.333，这里替换的就是这个。您可以决定将中值改为平均值，并用平均值填充缺失值。这取决于你如何看待你解决问题的过程。</p><p id="74ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了在每一列中获得所需的干净数据，我们需要使用管道操作符将所有操作链接在一起，并将干净数据保存在同一个msleep_data对象中。干净的数据可用于未来的分析。</p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/b721a0eca162fa0af308aec6cccab8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*G24FW0XWemjrp1m2V2w_qw.png"/></div></figure><p id="72fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">让我们看看最终的结果。</strong></p><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/6fb3530bd2bb3c7491175a410769fcf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*LuB-WMloCbCOgwrAqwYHCQ.png"/></div></figure><figure class="lf lg lh li fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/36c98801a97f637a82ca75a54928180d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*ptBOKNDv0yi_nUl36ZR2RA.png"/></div></figure><p id="20c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太神奇了！！！你做得很好。干得好！！！我们已经成功处理了该数据集中缺失的值。</p><h2 id="0567" class="jq jr hi bd js jt ju jv jw jx jy jz ka jb kb kc kd jf ke kf kg jj kh ki kj kk bi translated"><strong class="ak">总结</strong></h2><p id="51bd" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj kp jl jm jn hb bi translated">在本文中，我们看到了如何实现整洁数据原则之一，即<strong class="is hj"> <em class="jp">【任何观察都不应有缺失值】</em> </strong>。这种理解对于作为数据爱好者或数据专家的您是有益的。在数据生命周期的初始阶段处理丢失的值，会让您在到达数据生命周期的分析阶段时省去很多“头痛”的事情。我在这里阐述的一个想法是，作为一个数据爱好者，你必须确定你希望如何处理数据集中缺失的值。当你清楚自己想要采取的方法时；然后R里有几个工具，函数，包可以帮你实现这个；在本文中，我们只是检查了使用tidyr包。</p><p id="1a77" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我给你留下这些名言:</p><blockquote class="lz"><p id="2a4e" class="ma mb hi bd mc md me mf mg mh mi jn dx translated">幸福的家庭都是相似的，但不幸的家庭各有各的不幸 ~列夫·托尔斯泰</p><p id="7186" class="ma mb hi bd mc md me mf mg mh mi jn dx translated"><em class="mj">“整洁的数据集都是相似的，但每一个杂乱的数据集都有自己的杂乱之处。”</em> ~哈德利·韦翰</p></blockquote><p id="f8eb" class="pw-post-body-paragraph iq ir hi is b it mk iv iw ix ml iz ja jb mm jd je jf mn jh ji jj mo jl jm jn hb bi translated">请在下面的评论区留下您的评论，并与他人分享这篇文章。如果你喜欢这篇文章，如果你能点击“鼓掌”图标(最多允许50次鼓掌)，这将对我意义重大。</p><p id="a954" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想参加我在Coursera上教的关于处理R中缺失值的基于项目的指导课程，以获得一个可验证的证书，那么点击<a class="ae jo" href="https://www.coursera.org/projects/handling-missing-values-r-using-tidyr" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="548a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">作为Coursera Guided Project Network的一名基于项目的课程讲师，我教授了几门关于使用r的课程。你可以点击<a class="ae jo" href="https://www.coursera.org/instructor/arimoro-olayinka" rel="noopener ugc nofollow" target="_blank">这里</a>查看这些课程。谢谢大家！下次见！</p><p id="0489" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献</strong></p><ul class=""><li id="6868" class="kq kr hi is b it iu ix iy jb ks jf kt jj ku jn kv kw kx ky bi translated"><a class="ae jo" href="https://www.statmethods.net/input/missingdata.html" rel="noopener ugc nofollow" target="_blank">https://www.statmethods.net/input/missingdata.html</a></li><li id="87bb" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated"><a class="ae jo" href="https://stats.idre.ucla.edu/r/faq/how-does-r-handle-missing-values/" rel="noopener ugc nofollow" target="_blank">https://stats . idre . UCLA . edu/r/FAQ/how-do-r-handle-missing-values/</a></li><li id="0a69" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated"><a class="ae jo" href="https://faq-ans.com/en/Q%26A/page=9cac166c8d89978dad8d8dcb632a53c0#s2" rel="noopener ugc nofollow" target="_blank">https://FAQ-ans . com/en/Q % 26A/page = 9 CAC 166 c8 d 89978 dad 8d CB 632 a 53 c 0 # S2</a></li><li id="06aa" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">https://faculty.nps.edu/sebuttre/home/R/missings.html<a class="ae jo" href="https://faculty.nps.edu/sebuttre/home/R/missings.html" rel="noopener ugc nofollow" target="_blank">中缺少值</a></li><li id="d402" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated">用tidyr-R整理数据科学[图书]。<a class="ae jo" href="https://www.oreilly.com/library/view/r-for-data/9781491910382/ch09.html" rel="noopener ugc nofollow" target="_blank">https://www . oreilly . com/library/view/r-for-data/9781491910382/ch09 . html</a></li><li id="6404" class="kq kr hi is b it kz ix la jb lb jf lc jj ld jn kv kw kx ky bi translated"><a class="ae jo" href="https://www.oreilly.com/library/view/r-for-data/9781491910382/ch09.html" rel="noopener ugc nofollow" target="_blank">缺失值—用R [Book]进行回归分析。https://www . oreilly . com/library/view/regression-analysis-with/9781788627306/52f 1995 e-940 c-47fd-a35f-2f 58331 a 3746 . XHTML</a></li></ul></div></div>    
</body>
</html>
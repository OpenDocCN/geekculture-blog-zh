<html>
<head>
<title>Walmart Recruiting — Store Sales Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">沃尔玛招聘—商店销售预测</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/walmart-recruiting-store-sales-forecasting-b8b2f4cf19b1?source=collection_archive---------12-----------------------#2021-05-25">https://medium.com/geekculture/walmart-recruiting-store-sales-forecasting-b8b2f4cf19b1?source=collection_archive---------12-----------------------#2021-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="59a7" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">“<strong class="il hj">预测</strong>的<strong class="il hj">目标</strong>不是预测未来，而是告诉你你需要知道什么，以便在当下采取有意义的行动”。——<strong class="il hj">保罗·萨佛</strong></p></blockquote><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es jh"><img src="../Images/79e449e8c20ebada26ab76660da5024a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVek6mOi6qAY98SMe06rNQ.jpeg"/></div></div></figure><p id="da1c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">目录:</strong></p><ol class=""><li id="4087" class="jw jx hi il b im in iq ir jt jy ju jz jv ka jg kb kc kd ke bi translated">商业问题</li></ol><p id="4c7f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">2.为什么这个问题需要解决？</p><p id="6977" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">3.机器学习如何帮助解决这个问题？</p><p id="2552" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">4.作为性能指标的加权平均绝对误差(WMAE)</p><p id="457b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">5.为什么我们使用WMAE作为我的绩效指标？</p><p id="29fb" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">6.数据集信息</p><p id="ac68" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">7.探索数据分析</p><p id="1d7b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">8.基线模型</p><p id="67de" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">9.数据预处理</p><p id="206d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">10.模型</p><p id="7dce" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">11.部署</p><p id="eeea" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">12.未来的工作</p><p id="2958" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">13.参考:</p><h1 id="a8c4" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">1.简介和目标:</h1><blockquote class="if ig ih"><p id="1b25" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">沃尔玛是一家著名的零售公司，经营连锁超市。这里，沃尔玛提供了45家商店的数据组合，包括商店信息和月销售额。数据每周提供一次。沃尔玛试图发现假期对商店销售的影响。为此，它将四个假期周纳入数据集，分别是圣诞节、感恩节、超级碗、劳动节。这里我们要分析给定的数据集。在此之前，让我指出这个分析的目的。</p><p id="5bb4" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我们的主要目标是预测商店一周内的销售额。</p><p id="4da6" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">由于数据集大小和时间相关数据作为特征给出，因此分析销售是否受到基于时间的因素和基于空间的因素的影响。</p><p id="298a" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">最重要的是，如何在一周内包括假期来提高商店的销售额？</p></blockquote><h2 id="4c57" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">2.为什么这个问题需要解决？</h2><p id="2240" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated">假期会对销售产生巨大影响。因此，如果对销售额有一个好的预测，沃尔玛就可以计算出假期期间要订购多少产品。这将有助于预测假期期间需要购买哪些产品。因为计划购物的顾客希望产品能立即上市。通过预测，他们可以计算出什么时候需要什么产品。从而提高顾客对沃尔玛的信任度。这个问题也可以解决营销活动的问题。因为预测通常用于调整广告和营销活动，并能影响销售额。沃尔玛全年都会举办几次降价活动。这些降价事件发生在重要的节假日之前。因此，为了解决这个问题，沃尔玛可以更有效地组织这样的活动。</p><h2 id="f9e3" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">3.机器学习如何帮助解决这个问题？</h2><p id="be43" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated">已知具有线性的时间序列数据。简单的均值或中值模型不能有效或完全映射线性关系。像<a class="ae lw" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank"><em class="ik">【ARIMA】</em></a>(自回归综合移动平均线)这样的模型在预测销售额时没有考虑到商店规模、商店类型、假期等特征的影响。因此，如果数据集满足其线性假设，像线性回归模型这样的机器学习模型可以提供稳健的预测。再者，机器学习预测不是黑箱；可以衡量和理解模型输入的影响，从而使预测直观而透明。机器学习模型也可以更新，并适应数据集的变化。</p><p id="3f44" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">且还通过机器学习帮助，可以使用机器学习模型以正确的方式利用降价事件和每周销售之间的关系。</p><blockquote class="if ig ih"><p id="bc02" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">机器学习模型需要一个衡量标准来检查模型的表现是好是坏。这个指标被称为性能指标。</p></blockquote><p id="3a4e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> 4。加权平均绝对误差(WMAE)作为性能指标</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es lx"><img src="../Images/e9fed686232947200a20500c74681b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*uaI3u8QSLSci-TGFbydnSg.png"/></div></figure><p id="6565" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">很明显，我们的目标是在预测每周销售额的同时，尽可能降低这一分数。我们将在回归模型中使用这个性能指标。</p><h2 id="44c2" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated"><strong class="ak"> 5。为什么我们使用WMAE作为我的绩效指标？</strong></h2><p id="46c9" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated">首先，让我们看看为什么不使用RMSE(均方根误差)而使用MAE。给定的数据集不是大型数据集，因此异常点的影响会比通常情况下更大。而使用RMSE它可以使冲击力增加两倍以上。假设我们对你的问题有两个模型(M1和M2)。假设我们有4个正常点和1个异常点。让我们有实际的销售是正常的一周销售有平均值约10和离群值有销售100。模型1用平均值11和异常值110来预测正常周的销售额。模型2预测正常周平均值为14，异常值为105。分母中的N是常数，两种情况下计算异常点模型1的MAE:110–100 = 10计算异常点模型1的MSE:(110–100)= 100</p><p id="6ea4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">计算异常点模型1的MAE:105–100 = 5计算异常点模型1的MSE:(105–100)= 25</p><p id="3470" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">模型1的RMSE值将为=平方根(100+1+1+1+1) = 10.9，而对于模型2 =平方根(25+3+3+3+3) = 6.08。由于模型1的RMSE大于模型2，仅仅因为单个异常点，它将丢弃实际上表现更好的模型1。</p><p id="ae68" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">然而，模型1的MAE = 14，模型2的MAE = 17</p><p id="2c16" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">显然，在较小的数据集中，MAE受异常值的影响较小。</p><p id="3c82" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在，我们使用WMAE而不是普通的MAE，因为我们需要增加假期周销售的影响，因为沃尔玛根据即将到来的假期计划活动。很明显，WMAE就是这么做的，因为它给了放假的那几周5倍的权重。</p><blockquote class="if ig ih"><p id="b4e3" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">注:模型的WMAE值越小，模型性能越好。</p></blockquote><h2 id="45e8" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">6.数据集信息</h2><p id="7102" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated"><em class="ik">沃尔玛提供了四个数据集:这里的数据源链接是</em><a class="ae lw" href="https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting/data" rel="noopener ugc nofollow" target="_blank"/><em class="ik">。</em></p><p id="e707" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik"> Stores.csv </em> </strong></p><p id="ee08" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">它有三列。店铺:店铺编号从1到45，尺寸:店铺尺寸已提供，类型:店铺类型已提供，有A、B、C三种类型。</p><p id="3b43" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik"> Train.csv </em> </strong></p><p id="1107" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">它有五列。 Store:商店编号，Dept:部门编号，Date:星期，Weekly_Sales:给定商店中给定部门的销售额，IsHoliday:该周是否为特殊假日周</p><p id="f22e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"><em class="ik">test . CSV</em></strong><em class="ik">与train.csv相同，只是它没有IsHoliday列。</em></p><p id="157d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik"> Features.csv </em> </strong></p><p id="4964" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">它有十一列。商店:商店编号，日期:星期，温度:该地区的平均温度，燃料价格:该地区的燃料成本，减价1–5:与沃尔玛正在进行的促销减价相关的匿名数据。降价数据仅在2011年11月后可用，并非所有商店都随时可用。任何缺少的值都标有安娜。数据集中包括选定的假日降价事件。众所周知，这些降价会影响销售，但要预测哪些部门会受到影响以及影响的程度是很困难的。3 CPI——消费者价格指数，失业:失业率，假日:一周是否是特殊假日</p><p id="504e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">没有低延迟要求，模型花费的时间足够了。</strong></p><h1 id="29b3" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">7.探索性数据分析(EDA):</h1><blockquote class="ly"><p id="183a" class="lz ma hi bd mb mc md me mf mg mh jg dx translated">在<!-- -->机器学习/深度学习中，当务之急是知道什么是什么，怎样是什么？到目前为止，我们已经知道了问题的定义，我们也清楚我们想要达到的目标。但我们如何实现它才是最重要的。为了前进，我们需要已经提供给我们的数据。我们将执行称为探索性数据分析的过程，这是一种分析数据集以总结其主要特征的方法，通常采用可视化方法。</p></blockquote><p id="c68c" class="pw-post-body-paragraph ii ij hi il b im mi io ip iq mj is it jt mk iw ix ju ml ja jb jv mm je jf jg hb bi translated">首先，我们将导入所有需要的库。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mn"><img src="../Images/e2506e5f6a97776daca46b4adf8d1ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KX0ILRXuyGqJ5pab1YY0mw.png"/></div></div></figure><p id="f68b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">接下来，我们加载所有数据集:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mo"><img src="../Images/80369872a1aa2dc2959c7999a8f9b145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*FPuF9FQt_GEsHDne8sT_0g.png"/></div></figure><p id="73ef" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">现在我们从train.csv文件</strong>的日期特征中提取一些时间相关特征</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mp"><img src="../Images/87abe072b0322351fd324d129cff8ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*RpWEEjYaXYjelfHHWJ3X1Q.png"/></div></figure><p id="3c96" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在让我们检查在所提供的时间段内是否有任何趋势、波动或随机事件发生。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mq"><img src="../Images/778aed36988dd34be9c9c9a55951cb80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U24WIPGoDucVtYIZZIdOhQ.png"/></div></div></figure><h2 id="3fb4" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">观察:</h2><p id="3bee" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated">从折线图可以看出，没有年度趋势，也没有随机事件在任何一年发生。</p><p id="eb73" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">还可以看到，与其他月份相比，年底的销售额很高，这表明圣诞节和感恩节对销售额的影响比超级碗和劳动节更大。</p><p id="5972" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们可以创建功能，我们可以给每个假期单独的类别</p><p id="720c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">周特征折线图</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mr"><img src="../Images/f1d0fa99a04bc80fd21b4c7611d90a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYi_aqNiAIg76kCzbi8fbw.png"/></div></div></figure><p id="5a9a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="e4f1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">这可能是一个有用的特性，因为line每周都在波动。同样，在圣诞节和感恩节到来的时候，第45到50周的销售额更高。</p><p id="7e9e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">然后我们将train.csv与stores.csv和features.csv合并，以获得train.csv中每个数据点的更多特征</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ms"><img src="../Images/99f7d0e1c6a8f8250bb578e3caa71538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qtmd3tQwKRfcaQqBsjwoBQ.png"/></div></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es mt"><img src="../Images/d9bfa8682d7663f9776af95b6205a104.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/1*RuNxpXq7fv99P8mEoxsSEQ.gif"/></div></figure><p id="ab1f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在我们来看看哪些特性与Weekly_Sales更相关。在此之前，我们必须记住，有一些分类特征和一些数字特征，Weekly_Sales本质上也是数字的。因此，要检查数字特征与Weekly_Sales的相关性，我们可以简单地使用<a class="ae lw" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" rel="noopener ugc nofollow" target="_blank"> Pearson相关系数</a>或<a class="ae lw" href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient" rel="noopener ugc nofollow" target="_blank"> Spearman等级相关系数</a>这两种方法都广泛用于数字特征之间的相关性。为了检查分类特征和数字特征之间的相关性，我们有一个特殊的方法叫做<a class="ae lw" href="https://www.statisticshowto.com/eta-squared/" rel="noopener ugc nofollow" target="_blank"> eta平方检验</a>。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es mu"><img src="../Images/a6acad93a73ac118c3ff0e0fad3aac1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PaRmUSWDBF3WoYiYU0Waog.png"/></div></div></figure><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="cd7f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">分类特征与周销售额的相关性</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="5c7f" class="ld kg hi my b fi nc nd l ne nf">Correlation of store feature with Weekly_Sales<br/>0.09320619110455744<br/>**************************************************<br/>Correlation of Department feature with Weekly_Sales<br/>0.5368007370698533<br/>**************************************************<br/>Correlation of Type feature with Weekly_Sales<br/>1.8841978383051284e-07<br/>**************************************************</span></pre><p id="1b27" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">很容易看出，部门特征与周销售额高度相关。</p><p id="030e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">商店特征也与周销售额适度相关。</p><p id="882f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">数字特征与周销售额的相关性</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es ng"><img src="../Images/97befd2cf7d3e4e0d3e0b2a13a1bd5e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SfSPtfUvuz-3viz0lNGExw.png"/></div><figcaption class="nh ni et er es nj nk bd b be z dx">Heat Map of Correlation between Numerical Features</figcaption></figure><p id="38f1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="be3b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">规模与周销售额最相关。</p><p id="2591" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">大多数特征与尺寸相关，这在使用机器学习预测销售时并不好(点击<a class="ae lw" href="https://datascience.stackexchange.com/questions/24452/in-supervised-learning-why-is-it-bad-to-have-correlated-features" rel="noopener ugc nofollow" target="_blank">此处</a>了解原因)。因此，大多数功能可能是无用的，可以在以后删除。</p><p id="3d17" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">让我们使用简单随机森林模型来检查哪些特征是重要的。</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="ae8a" class="ld kg hi my b fi nc nd l ne nf">Top 5 Important Features:<br/>['Dept', 'Size', 'Store', 'Week', 'CPI']</span></pre><p id="34e7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">因此，成功地完成了上述分析。</p><p id="4419" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">让我们分别了解数据集中所有要素的分布</strong></p><p id="6f86" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">类型特征:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nl"><img src="../Images/fce44cf149eb585c83df3020f7f58a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-cnfRZkbuxO0ttfd5EA1g.png"/></div></div></figure><p id="d22f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察</strong>:A型店很多，C型店很少</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nm"><img src="../Images/46f97ed73c646a729c26f0554c455e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*R8BpN-M4kj9T3sbliUKbmQ.png"/></div></figure><p id="45a3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">观察:每类店铺的中位数从左到右递减，即<strong class="il hj">。</strong>，从A店到c店。</p><p id="2a6a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">店铺特色:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nn"><img src="../Images/e5c9b1e6e666fb2080bf062080989ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RetaAxBiS3bamJorsZvsqQ.png"/></div></div></figure><p id="0cc2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="fc66" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">商店特征是预测销售的有用特征。因为每个商店都有不同含义。假设:该特征包括部门、规模或类型，以及数据集中未提供的地区。</p><p id="d341" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">部门特色:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es no"><img src="../Images/020e4ceb81875a8cc152fc98cf71074d.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/1*2cRZnQSQ1z3QX_IjSOjqtw.gif"/></div><figcaption class="nh ni et er es nj nk bd b be z dx">Box plot of Department feature</figcaption></figure><p id="3eae" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="9931" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">部门可能是预测销售额的一个因素，因为通过箱线图可以看出，每个部门的销售额都不同于其他部门。此外，部门特征与类型特征的组合也增强了更准确地预测销售额的能力，因为可以看出类型A在大多数部门中具有更高的销售额。</p><p id="628d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj"> CPI特征(数值特征):</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es np"><img src="../Images/661a22c043c485c412720fec17d507a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIK4d9WRoq3Bl89a87SJ8w.jpeg"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx">PDF and Box plot of CPI feature</figcaption></figure><p id="22e0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="98cd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">CPI在160到180之间，因为没有数据，所以没有销售。除此之外，在特定时期内消费价格指数变化没有太大差别。</p><p id="a03d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">失业特征:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nq"><img src="../Images/1e93c621db0ecf9d3fd3674797d7253f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eb-2v0rQsDq9uTJfc4nqsg.jpeg"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx">PDF and Box plot of Unemployment feature</figcaption></figure><p id="c447" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="fd18" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">所有箱线图范围平均值相对来说是相等的，因此它在确定商店的销售额时没有用。所以这个功能可以去掉。</p><p id="d4e6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">燃油价格特性:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nr"><img src="../Images/a99369742a61b34df478e7f3892b1f30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nb5mkbwLc2vJ_4s9OkYQ9w.jpeg"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx">PDF and Box plot of Fuel Price feature</figcaption></figure><p id="610c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="fef0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">燃料价格对销售的影响很小，因为随着燃料价格的增加，销售没有变化。所以这个功能也可以去掉。</p><p id="692b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">温度特性:</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ns"><img src="../Images/5d2f39f545fce5049395e54b5e73f618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPrmd-2cqU4gnhyRdf4UZw.jpeg"/></div></div><figcaption class="nh ni et er es nj nk bd b be z dx">PDF and Box plot of Temperature feature</figcaption></figure><p id="4eb1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="dbce" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">这一功能也可以取消，因为在任何温度范围内销售都没有变化。</p><p id="8b70" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><em class="ik">注意:因为销售额不能为负，所以删除销售额为负的所有数据点。</em></p><blockquote class="if ig ih"><p id="a904" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">我们再提取一些特征，看看有没有用。</p></blockquote><p id="00b2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">让我们创建一个功能，查找一周中的假期数。</strong></p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nt"><img src="../Images/793efe57bed2b6d190cb035f4251a6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*Si-gvjy-fia5cDswoq0duQ.png"/></div></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nu"><img src="../Images/a028cd48b2865c37c290941b570680ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*VlwrFHHYVfPBwDx6I8hSsg.png"/></div><figcaption class="nh ni et er es nj nk bd b be z dx">Histogram of Holidays</figcaption></figure><p id="91ac" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="dc03" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">很少有一周有两个或两个以上的假期，一周中的大部分时间都没有假期。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nv"><img src="../Images/38dcccf25764abe7b856d6b1c67c6c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGXs9BhhFVF2bp7MFYdPtA.png"/></div></div></figure><p id="d911" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="776d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">销售额随着一周假日数的变化而变化。所以这是一个有用特性。</p><p id="c2fe" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">无效</strong> <strong class="il hj">特征提取。</strong></p><p id="d301" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们还尝试了月末功能和月初功能，因为人们往往在月末会有较少的工资，而在月初人们会得到工资，但这些功能被证明是无用的。</p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="f870" class="ld kg hi my b fi nc nd l ne nf">Correlation of Is_month_end feature with weekly_sales<br/>5.109982375092706e-06<br/>**************************************************<br/>Correlation of Is_month_start feature with weekly_sales<br/>1.919291806025242e-05<br/>**************************************************</span></pre><p id="7df0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">相关值很少被称为有用。</p><p id="6172" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用<a class="ae lw" href="https://machinelearningmastery.com/autoencoder-for-classification/" rel="noopener ugc nofollow" target="_blank">自动编码器</a>提取特征也没有用。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nw"><img src="../Images/19360154e33ed009e70e408e4c4b42ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eU4WxZMyp00dq_34SLH2xA.png"/></div></div></figure><p id="3cc3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用自动编码器功能后，WMAE增加，这意味着模型性能下降。</p><h2 id="c76e" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">我们发现感恩节和圣诞节比其他两个更有影响力。所以每个节日都有不同程度的影响。所以我们可以制作一个假日类别作为特色。</h2><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="9967" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">现在让我们检查Nan值的影响</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="8d2f" class="ld kg hi my b fi nc nd l ne nf">Feature         Nan values fraction</span><span id="1f40" class="ld kg hi my b fi nx nd l ne nf">Store           0.000000<br/>Dept            0.000000<br/>Date            0.000000<br/>Weekly_Sales    0.000000<br/>IsHoliday       0.000000<br/>Year            0.000000<br/>Month           0.000000<br/>Week            0.000000<br/>Day             0.000000<br/>n_days          0.000000<br/>Type            0.000000<br/>Size            0.000000<br/>Temperature     0.000000<br/>Fuel_Price      0.000000<br/>MarkDown1       0.642572<br/>MarkDown2       0.736110<br/>MarkDown3       0.674808<br/>MarkDown4       0.679847<br/>MarkDown5       0.640790<br/>CPI             0.000000<br/>Unemployment    0.000000<br/>dtype: float64</span></pre><p id="0ec0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">通过这一点，您可以看到降价价值具有高百分比的Nan值。</p><p id="692a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">由于降价事件发生在假期之前，因此可能会对Weekly_Sales产生影响。所以简单地给0或删除这些列可能会丢失一些信息。让机器学习模型学习隐藏在其中的模式，然后填充空值。</strong></p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="14ee" class="ld kg hi my b fi nc nd l ne nf">Features         Nan values fraction</span><span id="6b82" class="ld kg hi my b fi nx nd l ne nf">Store            0.000000<br/>Dept             0.000000<br/>Date             0.000000<br/>Weekly_Sales     0.000000<br/>IsHoliday        0.000000<br/>Year             0.000000<br/>Month            0.000000<br/>Week             0.000000<br/>Day              0.000000<br/>n_days           0.000000<br/>Type             0.000000<br/>Size             0.000000<br/>Temperature      0.000000<br/>Fuel_Price       0.000000<br/>MarkDown1        0.000000<br/>MarkDown2        0.000000<br/>MarkDown3        0.000000<br/>MarkDown4        0.000000<br/>MarkDown5        0.000000<br/>CPI              0.000000<br/>Unemployment     0.000000<br/>dtype: float64</span></pre><p id="300c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在让我们看看降价价值有多有用。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es ny"><img src="../Images/9a27f19740ec32350d61229e78d2b8a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*AJkTzeyR-KL8vQiPn4XiRA.png"/></div><figcaption class="nh ni et er es nj nk bd b be z dx">Heat map of markdown values and Weekly_Sales</figcaption></figure><p id="5c10" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">观察:</strong></p><p id="6101" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在降价价值与周销售额的相关性很小。而markdown 1和markdown4也是高度相关的。所以我们可以放弃他们。</p><h1 id="1c09" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">8.基线模型:</h1><p id="a306" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated">基线是一种使用启发式、简单汇总统计、随机性或机器学习来为数据集创建预测的方法。您可以使用这些预测来衡量基线的性能(例如，WMAE)，然后这个指标将成为您与任何其他机器学习算法进行比较的标准。</p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="08b0" class="ld kg hi my b fi nc nd l ne nf">Mean = np.mean(train['Weekly_Sales'])<br/>predicted value  = np.full((train.shape[0]), Mean)<br/>print("Model Performance(WMAE) of Mean Model: ",WMAE(train,train['Weekly_Sales'], predicted value))</span><span id="e30e" class="ld kg hi my b fi nx nd l ne nf">Model Performance(WMAE) of Mean Model:  15350.22</span><span id="b4e6" class="ld kg hi my b fi nx nd l ne nf">Median <strong class="my hj">=</strong> np.median(train['Weekly_Sales'])<br/>predicted_value  <strong class="my hj">=</strong> np.full((train.shape[0]), Median)print("Model Performance(WMAE) of Median Model: ",WMAE(train,train['Weekly_Sales'], predicted_value))</span><span id="0309" class="ld kg hi my b fi nx nd l ne nf">Model Performance(WMAE) of Median Model:  13625.26</span></pre><h1 id="a50d" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">9.数据预处理:</h1><p id="b691" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated"><strong class="il hj">预处理数据进行训练。</strong></p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="ee12" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">对测试数据进行预处理。</strong></p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><h1 id="88a3" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">10.型号:</h1><p id="a5a5" class="pw-post-body-paragraph ii ij hi il b im lr io ip iq ls is it jt lt iw ix ju lu ja jb jv lv je jf jg hb bi translated"><strong class="il hj">让我们使用WMAE作为性能指标来检查哪些模型性能最佳，以排除所有用于超参数调整的坏模型。</strong></p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="7f49" class="ld kg hi my b fi nc nd l ne nf">WMAE score of  linear regression  :  1.3978614345983337e+18<br/>----------------------------------------------------------------------------------------------------<br/>WMAE score of  SVR  :  734286.36<br/>----------------------------------------------------------------------------------------------------<br/>WMAE score of  RidgeCV  :  14816.99<br/>----------------------------------------------------------------------------------------------------<br/>WMAE score of  ElasticNet  :  14775.04<br/>----------------------------------------------------------------------------------------------------<br/>WMAE score of  RandomForest  :  1424.24<br/>----------------------------------------------------------------------------------------------------<br/>WMAE score of  XGboost  :  4244.98<br/>----------------------------------------------------------------------------------------------------</span></pre><p id="726f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">RandomForest和XGboost是最好的模型。我们也可以试试弹力网。</p><p id="83dd" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">让我们超调前面提到的模型</strong></p><p id="00d4" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">随机森林回归器</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="9d0f" class="ld kg hi my b fi nc nd l ne nf">n_estimators = [100,120,140]<br/>max_depth = [25, 27, 30]<br/>random_forest(n_estimators, max_depth)</span><span id="b135" class="ld kg hi my b fi nx nd l ne nf">k: 1 , n_estimators: 100 , max_depth: 25<br/>k: 2 , n_estimators: 100 , max_depth: 25<br/>k: 3 , n_estimators: 100 , max_depth: 25<br/>k: 4 , n_estimators: 100 , max_depth: 25<br/>WMAE: 1446.8874999999998<br/>k: 1 , n_estimators: 100 , max_depth: 27<br/>k: 2 , n_estimators: 100 , max_depth: 27<br/>k: 3 , n_estimators: 100 , max_depth: 27<br/>k: 4 , n_estimators: 100 , max_depth: 27<br/>WMAE: 1406.7475000000002<br/>k: 1 , n_estimators: 100 , max_depth: 30<br/>k: 2 , n_estimators: 100 , max_depth: 30<br/>k: 3 , n_estimators: 100 , max_depth: 30<br/>k: 4 , n_estimators: 100 , max_depth: 30<br/>WMAE: 1417.2475<br/>k: 1 , n_estimators: 120 , max_depth: 25<br/>k: 2 , n_estimators: 120 , max_depth: 25<br/>k: 3 , n_estimators: 120 , max_depth: 25<br/>k: 4 , n_estimators: 120 , max_depth: 25<br/>WMAE: 1419.4924999999998<br/>k: 1 , n_estimators: 120 , max_depth: 27<br/>k: 2 , n_estimators: 120 , max_depth: 27<br/>k: 3 , n_estimators: 120 , max_depth: 27<br/>k: 4 , n_estimators: 120 , max_depth: 27<br/>WMAE: 1415.1875<br/>k: 1 , n_estimators: 120 , max_depth: 30<br/>k: 2 , n_estimators: 120 , max_depth: 30<br/>k: 3 , n_estimators: 120 , max_depth: 30<br/>k: 4 , n_estimators: 120 , max_depth: 30<br/>WMAE: 1411.4775<br/>k: 1 , n_estimators: 140 , max_depth: 25<br/>k: 2 , n_estimators: 140 , max_depth: 25<br/>k: 3 , n_estimators: 140 , max_depth: 25<br/>k: 4 , n_estimators: 140 , max_depth: 25<br/>WMAE: 1419.2275<br/>k: 1 , n_estimators: 140 , max_depth: 27<br/>k: 2 , n_estimators: 140 , max_depth: 27<br/>k: 3 , n_estimators: 140 , max_depth: 27<br/>k: 4 , n_estimators: 140 , max_depth: 27<br/>WMAE: 1412.5725000000002<br/>k: 1 , n_estimators: 140 , max_depth: 30<br/>k: 2 , n_estimators: 140 , max_depth: 30<br/>k: 3 , n_estimators: 140 , max_depth: 30<br/>k: 4 , n_estimators: 140 , max_depth: 30<br/>WMAE: 1429.3125</span></pre><p id="a77a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><em class="ik">最佳参数是n_estimators = 100，max_depth = 27 </em></p><p id="765b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在让我们用最佳参数训练随机森林。</p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="4c0d" class="ld kg hi my b fi nc nd l ne nf">RF = RandomForestRegressor(n_estimators= 100 , max_depth= 27)<br/>RF.fit(data,train['Weekly_Sales'])</span></pre><p id="f85e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用Kaggle在随机森林的测试数据集上预测周销售额的WMAE得分。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es nz"><img src="../Images/4149401d1b42028c42995a65a9e97890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nB1ohq-xg9GkNoDPIKskEQ.png"/></div></div></figure><p id="440b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">用XGboost回归器训练数据集。</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="3614" class="ld kg hi my b fi nc nd l ne nf">max_depth = [20,25]<br/>n_estimators = [6000,7000,8000]<br/>gbdt(n_estimators, max_depth)</span><span id="93c3" class="ld kg hi my b fi nx nd l ne nf">k: 1 , n_estimators: 6000 , max_depth: 20<br/>k: 2 , n_estimators: 6000 , max_depth: 20<br/>k: 3 , n_estimators: 6000 , max_depth: 20<br/>k: 4 , n_estimators: 6000 , max_depth: 20<br/>WMAE: 1423.1125<br/>k: 1 , n_estimators: 6000 , max_depth: 25<br/>k: 2 , n_estimators: 6000 , max_depth: 25<br/>k: 3 , n_estimators: 6000 , max_depth: 25<br/>k: 4 , n_estimators: 6000 , max_depth: 25<br/>WMAE: 1436.5400000000002<br/>k: 1 , n_estimators: 7000 , max_depth: 20<br/>k: 2 , n_estimators: 7000 , max_depth: 20<br/>k: 3 , n_estimators: 7000 , max_depth: 20<br/>k: 4 , n_estimators: 7000 , max_depth: 20<br/>WMAE: 1416.3425000000002<br/>k: 1 , n_estimators: 7000 , max_depth: 25<br/>k: 2 , n_estimators: 7000 , max_depth: 25<br/>k: 3 , n_estimators: 7000 , max_depth: 25<br/>k: 4 , n_estimators: 7000 , max_depth: 25<br/>WMAE: 1405.5575<br/>k: 1 , n_estimators: 8000 , max_depth: 20<br/>k: 2 , n_estimators: 8000 , max_depth: 20<br/>k: 3 , n_estimators: 8000 , max_depth: 20<br/>k: 4 , n_estimators: 8000 , max_depth: 20<br/>WMAE: 1382.7775<br/>k: 1 , n_estimators: 8000 , max_depth: 25<br/>k: 2 , n_estimators: 8000 , max_depth: 25<br/>k: 3 , n_estimators: 8000 , max_depth: 25<br/>k: 4 , n_estimators: 8000 , max_depth: 25<br/>WMAE: 1372.6275</span></pre><p id="9417" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">最佳参数是n估计值= 8000，最大深度= 25 </p><p id="c04f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在让我们用最佳参数来训练XGboost。</p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="58db" class="ld kg hi my b fi nc nd l ne nf">gb = lgb.LGBMRegressor(n_estimators=8000, max_depth=25)<br/>gb.fit(data, train['Weekly_Sales'])</span></pre><p id="221e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用Kaggle预测XGboost测试数据集Weekly_Sales的WMAE得分。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ms"><img src="../Images/4c7b6880faea402c253f3716fef01280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*st_RMDDw3AhkJbDqoRzqXw.png"/></div></div></figure><p id="55b1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">用ElasticNet回归器训练数据集。</strong></p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="ce5b" class="ld kg hi my b fi nc nd l ne nf">l1_ratio = np.linspace(0.5, 1.0, num=6)<br/>linear regression(l1_ratio)</span><span id="1077" class="ld kg hi my b fi nx nd l ne nf">k: 1 , l1_ratio: 0.5<br/>k: 2 , l1_ratio: 0.5<br/>k: 3 , l1_ratio: 0.5<br/>k: 4 , l1_ratio: 0.5<br/>WMAE: 15394.74<br/>k: 1 , l1_ratio: 0.6<br/>k: 2 , l1_ratio: 0.6<br/>k: 3 , l1_ratio: 0.6<br/>k: 4 , l1_ratio: 0.6<br/>WMAE: 15340.665<br/>k: 1 , l1_ratio: 0.7<br/>k: 2 , l1_ratio: 0.7<br/>k: 3 , l1_ratio: 0.7<br/>k: 4 , l1_ratio: 0.7<br/>WMAE: 15365.2275<br/>k: 1 , l1_ratio: 0.8<br/>k: 2 , l1_ratio: 0.8<br/>k: 3 , l1_ratio: 0.8<br/>k: 4 , l1_ratio: 0.8<br/>WMAE: 15316.400000000001<br/>k: 1 , l1_ratio: 0.9<br/>k: 2 , l1_ratio: 0.9<br/>k: 3 , l1_ratio: 0.9<br/>k: 4 , l1_ratio: 0.9<br/>WMAE: 15389.147500000001<br/>k: 1 , l1_ratio: 1.0<br/>k: 2 , l1_ratio: 1.0<br/>k: 3 , l1_ratio: 1.0<br/>k: 4 , l1_ratio: 1.0<br/>WMAE: 14790.029999999999</span></pre><p id="8651" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated"><strong class="il hj">最佳l1_ratio = 1.0 </strong></p><p id="de9f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">现在让我们用最佳参数训练ElasticNet。</p><pre class="ji jj jk jl fd mx my mz na aw nb bi"><span id="fd00" class="ld kg hi my b fi nc nd l ne nf">lr = ElasticNet(random_state=0,normalize = True,l1_ratio = 1.0)<br/>lr.fit(data, train['Weekly_Sales'])</span></pre><p id="790b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用Kaggle对ElasticNet的测试数据集预测Weekly_Sales的WMAE得分。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es nt"><img src="../Images/eb64cbc77a93e198825f8b0ff444026b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*NwDrfOyyuPvuErOUtQ6a9g.png"/></div></figure><p id="f184" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">还尝试了<a class="ae lw" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html" rel="noopener ugc nofollow" target="_blank">堆叠</a>回归器。</p><figure class="ji jj jk jl fd jm"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="3f24" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">使用Kaggle对堆叠测试数据集预测Weekly_Sales的WMAE得分。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es oa"><img src="../Images/2064430368411096116bbcb3029ee92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*NSBDCqsIMYCgP4tYNOENPA.png"/></div></figure><p id="2b1a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">所有型号性能:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jn jo di jp bf jq"><div class="er es ob"><img src="../Images/c98cf32f21e5a029b8a48d4b40bb1d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gJnxOoXjfYp5X46Ki4QFA.png"/></div></div></figure><h2 id="1d37" class="ld kg hi bd kh le lf lg kl lh li lj kp jt lk ll kt ju lm ln kx jv lo lp lb lq bi translated">随机森林被证明是最好的模型。</h2><h1 id="98f0" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">11.部署:</h1><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es oc"><img src="../Images/9e0ea8b62c5a70cd18e9acb2e019bb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*JsCPe1EJIE2kHAUFxNunrg.gif"/></div></figure><p id="b745" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">我们在这里做的第一件事是输入商店号、部门号、该周是否有假日以及该周的最后一个星期五。利用这个信息网站已经预测了那一周的销售额。</p><h1 id="179a" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">12.未来工作:</h1><ol class=""><li id="4a71" class="jw jx hi il b im lr iq ls jt od ju oe jv of jg kb kc kd ke bi translated">由于资源有限，我使用了10万个数据点。使用所有数据肯定会提高模型的性能。</li><li id="093d" class="jw jx hi il b im og iq oh jt oi ju oj jv ok jg kb kc kd ke bi translated">实现深度学习。</li></ol><h1 id="4991" class="kf kg hi bd kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc bi translated">13.参考:</h1><div class="ol om ez fb on oo"><a href="https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting" rel="noopener  ugc nofollow" target="_blank"><div class="op ab dw"><div class="oq ab or cl cj os"><h2 class="bd hj fi z dy ot ea eb ou ed ef hh bi translated">沃尔玛招聘-商店销售预测</h2><div class="ov l"><h3 class="bd b fi z dy ot ea eb ou ed ef dx translated">使用历史降价数据预测商店销售额</h3></div><div class="ow l"><p class="bd b fp z dy ot ea eb ou ed ef dx translated">www.kaggle.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc jr oo"/></div></div></a></div><div class="ol om ez fb on oo"><a href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener  ugc nofollow" target="_blank"><div class="op ab dw"><div class="oq ab or cl cj os"><h2 class="bd hj fi z dy ot ea eb ou ed ef hh bi translated">应用课程</h2><div class="ov l"><h3 class="bd b fi z dy ot ea eb ou ed ef dx translated">应用机器学习课程文凭在人工智能和ML门CS混合课程面试准备课程人工智能工作坊人工智能…</h3></div><div class="ow l"><p class="bd b fp z dy ot ea eb ou ed ef dx translated">www.appliedaicourse.com</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc jr oo"/></div></div></a></div><div class="ol om ez fb on oo"><a href="https://machinelearningmastery.com/basic-feature-engineering-time-series-data-python/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab dw"><div class="oq ab or cl cj os"><h2 class="bd hj fi z dy ot ea eb ou ed ef hh bi translated">Python中时间序列数据的基本特征工程-机器学习精通</h2><div class="ov l"><h3 class="bd b fi z dy ot ea eb ou ed ef dx translated">在我们可以开始使用机器学习之前，时间序列数据必须重新构建为监督学习数据集…</h3></div><div class="ow l"><p class="bd b fp z dy ot ea eb ou ed ef dx translated">machinelearningmastery.com</p></div></div><div class="ox l"><div class="pe l oz pa pb ox pc jr oo"/></div></div></a></div><div class="ol om ez fb on oo"><a href="https://barnesanalytics.com/2017/06/14/basics-of-arima-models-with-statsmodels-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="op ab dw"><div class="oq ab or cl cj os"><h2 class="bd hj fi z dy ot ea eb ou ed ef hh bi translated">Python - Barnes Analytics中带Statsmodels的ARIMA模型基础</h2><div class="ov l"><h3 class="bd b fi z dy ot ea eb ou ed ef dx translated">许多企业中的一个常见问题是预测未来的价值。它对设定预算很有用…</h3></div><div class="ow l"><p class="bd b fp z dy ot ea eb ou ed ef dx translated">barnesanalytics.com</p></div></div><div class="ox l"><div class="pf l oz pa pb ox pc jr oo"/></div></div></a></div><p id="ab5b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">你可以在我的Github <a class="ae lw" href="https://github.com/iaayushgupta/walmart" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj">这里</strong> </a> <strong class="il hj">找到完整的代码。</strong></p><p id="0bf3" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jt iv iw ix ju iz ja jb jv jd je jf jg hb bi translated">很高兴在<a class="ae lw" href="https://www.linkedin.com/in/aayush-gupta-925442190/" rel="noopener ugc nofollow" target="_blank"> <strong class="il hj"> linkedin </strong> </a>上与您连线😃</p></div></div>    
</body>
</html>
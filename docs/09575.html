<html>
<head>
<title>Thymeleaf | Create dynamic hierarchy trees with Kotlin &amp; Micronaut</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">百里香叶|使用Kotlin和Micronaut创建动态层次树</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/thymeleaf-create-dynamic-hierarchy-trees-with-kotlin-micronaut-4b4449574f85?source=collection_archive---------11-----------------------#2021-12-17">https://medium.com/geekculture/thymeleaf-create-dynamic-hierarchy-trees-with-kotlin-micronaut-4b4449574f85?source=collection_archive---------11-----------------------#2021-12-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3bc5f57469f8837e26a9b93e42ef794d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*juagsfk7xfaKvcrr"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@virtualkee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mila Tovar</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b9d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这周我必须用Kotlin和百里香叶创建一个动态的树结构。我有一个dataClass节点，它有子节点、元数据和标题。这些子节点本身也是节点，因此也可以有子节点。这些节点中的最后一个被称为包含元数据的叶子。我需要做的是在一个HTML页面上显示整个结构，并使它成为动态的和可点击的，这样在开始时只能看到最高层。</p><h1 id="bcc1" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">创建控制器</h1><p id="d5bd" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">控制器是该应用程序的两个主要部分之一。它负责向前端提供它需要处理的数据。因为我在这个项目中与Micronaut一起工作，所以我的控制器看起来像这样:</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="c05a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，findDocumentations函数将监听根地址，并使用索引视图来显示响应。请注意，<code class="du lc ld le lf b">Root().createWholeTree(metadataRepository.getAll())</code>只会创建数据树供我们使用。这个函数将只返回一个包含多个子节点的父节点。</p><h1 id="22c9" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">在前端使用数据</h1><p id="44d4" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">首先，由于我们使用的是百里香，我们应该创建一个新的index.html文件，并在其中添加一些类似xmlns:th的东西。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="e0c4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最有趣的部分可能是第11行的列表项。在这个位置，将显示最低层次级别上的第一个项目。此列表项将被menuFragment.html文件中的nestedMenu替换。这里它还使用了menuItemsList属性，并将根对象的子对象发送给它，这是我们在控制器中发送的。</p><p id="9666" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们现在刷新主页，它会抛出一个异常，因为它找不到我们想要使用的片段。要解决这个问题，我们需要自己去创造。</p><h1 id="0638" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">定义菜单分段</h1><p id="092d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">menuFragment.html实际上有两个不同的片段。一个是嵌套菜单，另一个叫做菜单。我们有两个独立的片段，因为一次我们需要一个完整的无序列表，就像我们从索引文件中调用它一样，而另一次我们只需要列表项本身。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="c082" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，这些片段包含在它们自己的内部并被调用。菜单片段包含nestedMenu片段。nestedMenu片段为menuItemsList中的每个menuItem创建一个列表项，它通过其参数获得该列表项。在这个列表项中，要么是一个动态生成的位置链接，要么只显示一个标题，并创建一个包含新菜单片段的新部分。</p><p id="36ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其工作方式是，只有结构的叶节点包含元数据。其他节点只有标题和子节点。这样，我们可以根据需要创建尽可能多的层次，因为我们知道只有叶节点可以包含元数据，并且之前的所有内容都需要调用菜单片段。</p><p id="71d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这本身将创建一个看起来像这样的树。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/990de1bab40fd58fc4223d724225b5d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*fQsfrFmSDx-q2ciNnrV_dQ.png"/></div></figure><p id="4b03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">显然，这看起来并不漂亮，需要用一些适当的css来设计。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="8fac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加css后，我们可以看到只有第一层会显示出来，正如我们所希望的那样。问题是，现在它是不可点击的，我们不能访问上面有层次结构的链接。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/47e6dd57dee6f3f4671bf927fb2b35cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*FWSl8xgi7w_saEVO1qcHhw.png"/></div></figure><p id="1b96" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了解决这个问题，我们需要编写一点javascript并为click事件添加一个eventListener。这个简单脚本的最终版本如下所示:</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="1650" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们把这个脚本放到index.html文件中，我们应该能够像预期的那样点击层次结构。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es li"><img src="../Images/2b1679cfeb1cb6b9194a5021fb7165be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*NUze7eP4h3pHGm8z_N_A_g.gif"/></div></figure></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><h1 id="0b96" class="jt ju hi bd jv jw lq jy jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq bi translated">反射</h1><h2 id="2a94" class="lv ju hi bd jv lw lx ly jz lz ma mb kd jg mc md kh jk me mf kl jo mg mh kp mi bi translated">什么进展顺利</h2><p id="df4d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这个任务中最简单的部分可能就是控制器了。我在几分钟内就安装并运行了它，Micronaut文档写得非常好，在某些情况下非常有用。CSS和JavaScript部分也很简单，因为我在W3Schools 上找到了一个很好的例子，我可以在我的项目中或多或少地直接使用它。</p><h2 id="a252" class="lv ju hi bd jv lw lx ly jz lz ma mb kd jg mc md kh jk me mf kl jo mg mh kp mi bi translated">什么需要改进</h2><p id="cbe8" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">首先，我在用百里香叶创建片段和理解这些片段可以像你在Kotlin中处理类一样调用自己时遇到了一些困难。开始的时候，我也遇到了一些直接在百里香叶中消耗数值的问题。过了一段时间，我找到了正确的方法，从那以后，几乎一切都很好。</p></div></div>    
</body>
</html>
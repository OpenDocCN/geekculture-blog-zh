<html>
<head>
<title>A Chatbot Application by finetuning GPT-3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微调GPT-3的聊天机器人应用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/a-chatbot-application-by-finetuning-gpt-3-2682aad25356?source=collection_archive---------1-----------------------#2022-07-08">https://medium.com/geekculture/a-chatbot-application-by-finetuning-gpt-3-2682aad25356?source=collection_archive---------1-----------------------#2022-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cddb544f3ffe267ad752ea49e8ed4651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-BijI2-_aiOfnDFzvF2jw.jpeg"/></div></div></figure><p id="c6fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可能在许多客户服务中见过聊天机器人。这里有一个类似的机器人。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/0f2862034d964f48ae04eb1d0a31636d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYpzfm3D8CmiB3i-bh6dfQ.jpeg"/></div></div></figure><p id="4280" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这些机器人如何回应用户的查询？这个bot是如何理解用户意图并给出智能响应的？在这篇博客中，我们将通过利用机器学习和语言模型来构建上述智能聊天机器人。我们开始吧</p><h1 id="2b38" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">介绍</h1><p id="6919" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">聊天机器人是设计用来与用户进行交流的软件。聊天机器人的一个流行应用是客户支持。如今，我们几乎可以在每个网站上看到聊天机器人。通过使用聊天机器人，用户或顾客可以避免拨打客服电话并等待他们的回复的障碍。聊天机器人可以用不同的方式设计。它的复杂性可以从简单的基于规则、功能有限的聊天机器人，到利用人工智能等技术的智能聊天机器人。最近变得非常流行的一个智能聊天机器人是谷歌的λT1。聊天机器人的复杂性取决于它的用例。</p><p id="794c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">智能聊天机器人是使用机器学习和自然语言处理构建的。这些聊天机器人被设计成用自然语言与用户互动。这些更聪明地理解用户的查询意图，并像人一样做出响应。大多数智能聊天机器人都建立在深度神经网络和变压器模型的基础上。变压器模型是一种深度神经网络，它使用一种称为自注意的技术将输入序列从一种形式转换为另一种形式。Transformer的一个常见用例是语言转换，其中输入是一种语言的句子，输出是另一种语言的同一个句子。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/32c17ef6052c191701414c368e38fc43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ql8Re3co_BB6ECpUnYRq-A.png"/></div></div></figure><p id="8bc6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你想了解更多关于变形金刚的内容，请参考我之前的博客。</p><div class="ky kz ez fb la lb"><a rel="noopener follow" target="_blank" href="/geekculture/transformers-231c4a430746"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hj fi z dy lg ea eb lh ed ef hh bi translated">变形金刚(电影名)</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">Transformer模型已经成为大多数NLP任务中的首选模型。许多基于变压器的模型，如伯特…</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp io lb"/></div></div></a></div><p id="0ba0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">变压器是基于编码器-解码器的模型。编码器用于生成输入数据的有意义的表示。在上面的例子中，使用编码器将英语输入编码成向量。解码器将接收这些数据，并产生所需的输出。在这个例子中，期望的输出是日语翻译。目前有各种基于变压器的架构可供选择。你可以在这里看到<a class="ae kw" href="https://huggingface.co/models" rel="noopener ugc nofollow" target="_blank">的车型列表。你也可以参考我在</a><a class="ae kw" rel="noopener" href="/geekculture/different-transformer-models-f6f405999e4a">之前的博客</a>中讨论的内容。GPT就是这样一个受欢迎的模式。在这篇博客中，我们将使用GPT模型来微调聊天机器人的客户支持。</p><h1 id="ca58" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">GPT模型</h1><p id="4422" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">如前所述，GPT(创成式预训练转换器)是OpenAI发布的一种转换器模型。它是一个只有解码器的转换器模型，主要用于文本生成。GPT模型可用于许多自然语言生成任务，如文本补全、下一个单词建议、内容创建、聊天机器人等。有三种GPT型号可供选择——GPT一号(2018年)，GPT二号(2019年)和GPT三号(2020年)。这些模型在架构、参数数量、训练数据集、批量大小等方面各不相同。我们将使用GPT-3模型来构建聊天机器人应用程序。</p><h1 id="eb9f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">OpenAI API</h1><p id="4a9f" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">我们将使用OpenAI API来访问GPT模型。OpenAI是一个基于人工智能的研究实验室，它创建了许多机器学习和语言模型。2022年，Open AI宣布能够通过他们的API为不同的用例微调和定制GPT-3模型。通过微调，GPT-3可以用于定制用例，如文本摘要，分类，实体提取，客户支持聊天机器人等。</p><p id="227a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与API交互的第一步也是最重要的一步是生成用于身份验证的API密钥。用户可以通过登录这个<a class="ae kw" href="https://beta.openai.com/account/api-keys" rel="noopener ugc nofollow" target="_blank">页面</a>来创建API密钥。一旦您登录，您将获得一个秘密的API密钥，我们将在整个项目中使用它通过API进行多个请求。该API将提供价值18美元的免费积分，可在前三个月使用。</p><p id="6651" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，要使用OpenAI CLI命令，我们需要在环境中安装OpenAI。这可以通过在提示符下写入以下命令来完成。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="8897" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">GPT模型的推论</h1><p id="f3d4" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">如前所述，我们将通过微调现有的GPT-3模型来构建一个聊天机器人。但在此之前，让我们看看预训练的GPT-3模型如何作为聊天机器人工作。下面的对话是一个人和预训练的GPT-3模型之间的对话。</p><blockquote class="ls lt lu"><p id="ff7a" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">人类:你好，你是谁？</p><p id="0aac" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">艾:我做得很好。今天我能为你做些什么？</p><p id="091f" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">人类:你对人工智能了解多少？</p><p id="0dbd" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">人工智能是指由机器展示的智能，与人类和动物展示的自然智能形成对比。我有三个博士学位，事实上，我现在正在攻读第四个。</p></blockquote><p id="54a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们如何从模型中生成这个输出呢？你只需要几行代码。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="7689" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，提示只是我们给模型的输入文本。对于聊天机器人用例，我们以对话的形式给出输入。引擎代表模型。有不同的模式像达芬奇，阿达，居里，巴贝奇等。你可以在这里阅读更多关于每个型号<a class="ae kw" href="https://beta.openai.com/docs/models/gpt-3" rel="noopener ugc nofollow" target="_blank">的信息。stop参数用于标识API将停止生成未来令牌的点。例如，当“人类”这个词出现时，它就停止生成。温度参数表示答案的创造性程度。Top_p是温度采样的替代方案，称为核采样，其中模型考虑具有top_p概率质量的表征的结果。Best_of生成服务器端的Best_of completions，并返回“best”(每个令牌具有最高日志概率的那个)。最后，max_tokens表示可以生成的最大令牌数。</a></p><h1 id="82fc" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">聊天机器人的微调GPT模型</h1><p id="26a9" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">既然我们知道了如何从预训练的GPT模型生成完成，让我们试着为客户支持聊天机器人微调我们自己的模型。我们一步一步来。</p><h2 id="e78c" class="lz ju hi bd jv ma mb mc jz md me mf kd jb mg mh kh jf mi mj kl jj mk ml kp mm bi translated">收集数据</h2><p id="7c36" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">收集数据是任何微调任务的第一步，也是最重要的一步。对于这个用例，数据是从<a class="ae kw" href="https://www.kaggle.com/datasets/thoughtvector/customer-support-on-twitter" rel="noopener ugc nofollow" target="_blank"> Twitter客户支持竞赛</a>ka ggle收集的。数据包含客户和客户支持团队之间的交互。</p><h2 id="7e2c" class="lz ju hi bd jv ma mb mc jz md me mf kd jb mg mh kh jf mi mj kl jj mk ml kp mm bi translated"><strong class="ak">准备数据</strong></h2><p id="c3aa" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">上述数据首先被分为用户评论和客服回复。数据看起来像这样</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/de0f46805ace65c06cbad853361d17b7.png" data-original-src="https://miro.medium.com/v2/0*Wt938U2LapxXTjyx"/></div></figure><p id="d76a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里id=0表示id=0的用户和客户服务之间的对话链。现在，这些数据将被转换成JSON格式，然后用于训练模型。Open AI对于每个用例都有一些标准的数据格式。例如，聊天机器人用例需要以下形式的数据。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="4350" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">类似地，无论是什么用例，训练数据集都有一个标准格式。你可以在这里看到数据准备的指导方针<a class="ae kw" href="https://beta.openai.com/docs/guides/fine-tuning/preparing-your-dataset" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8d04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述数据集已被转换为微调所需的格式。</p><h2 id="6a8b" class="lz ju hi bd jv ma mb mc jz md me mf kd jb mg mh kh jf mi mj kl jj mk ml kp mm bi translated">微调模型</h2><p id="a0c2" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">一旦数据准备就绪，下一步就是对GPT-3模型进行微调。为此，我们使用Open AI CLI命令。第一步是添加您的秘密OpenAI API密钥。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="6198" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是将准备好的数据传递给模型进行训练。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="6718" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以使用前面提到的任何模型。每个模型都适合特定的任务。微调的成本因型号而异。</p><h2 id="5c12" class="lz ju hi bd jv ma mb mc jz md me mf kd jb mg mh kh jf mi mj kl jj mk ml kp mm bi translated">使用微调后的模型执行推理</h2><p id="0798" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">一旦模型被训练，你将得到一个训练模型的id。您可以使用这个id从这个模型中进行推理。从模型中进行预测类似于我们在预训练的GPT-3模型中所做的。只需用新训练的模型替换模型名称。仅此而已！</p><h1 id="1a48" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">创建聊天机器人应用程序</h1><p id="baa9" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">开发了一个简单的android应用程序，它通过rest API连接到微调后的模型。每次，当用户输入一个问题时，它会被发送到模型，模型的响应会显示在应用程序中。</p><div class="ky kz ez fb la lb"><a href="https://youtube.com/shorts/vmhTyUzQ_wA?feature=share" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hj fi z dy lg ea eb lh ed ef hh bi translated">GPT聊天机器人</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">使用GPT模型微调的客户服务聊天机器人</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">youtube.com</p></div></div><div class="lk l"><div class="mo l lm ln lo lk lp io lb"/></div></div></a></div><h1 id="e358" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">包扎</h1><p id="3ac7" class="pw-post-body-paragraph iq ir hi is b it kr iv iw ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn hb bi translated">感谢你阅读这篇文章！如果你喜欢它，有问题，或者发现了错误，请告诉我。可以参考<a class="ae kw" href="https://github.com/Vinithavn/Finetune-GPT-3-for-customer-support-chatbot-" rel="noopener ugc nofollow" target="_blank"> Github </a>上的代码库。请随时通过<a class="ae kw" href="https://www.linkedin.com/in/vinitha-v-n-5a0560179/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae kw" href="https://twitter.com/Vinitha_vn" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae kw" rel="noopener" href="/@vinithavn"> Medium </a>联系或关注我。要阅读更多我的博客，请参考<a class="ae kw" href="https://neuralnetwork.guru/author/vinitha/" rel="noopener ugc nofollow" target="_blank">https://neuralnetwork.guru/author/vinitha/</a></p></div></div>    
</body>
</html>
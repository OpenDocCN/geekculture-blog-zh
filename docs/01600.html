<html>
<head>
<title>Exploring Couchbase Analytics Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Couchbase分析服务</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/exploring-couchbase-analytics-service-6d2af7ea5043?source=collection_archive---------30-----------------------#2021-04-16">https://medium.com/geekculture/exploring-couchbase-analytics-service-6d2af7ea5043?source=collection_archive---------30-----------------------#2021-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/51d68d59e0010db05d1026044d134c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*odTqljIvYGuqstpv"/></div></div></figure><p id="fbac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最近，我一直在探索Couchbase分析服务，并发现与Couchbase查询服务相比，它如何更有用并提高效率。</p><p id="d559" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Couchbase分析服务附带企业附加功能。</p><p id="f3f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Couchbase Analytics是Couchbase Server的一个并行数据管理功能，旨在对许多记录高效地运行大型即席连接、集合、聚合和分组操作。</p><p id="9ea8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">为什么选择分析？</strong></p><p id="32eb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每个企业都在循环或螺旋中做这三件事(目标)。</p><ol class=""><li id="b0d4" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">运行业务流程，向客户交付产品或服务。</li><li id="e87e" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">分析业务，确定要改什么，改什么。</li><li id="4505" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">让改变发生。</li></ol><p id="ed33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">查询服务由运行业务所需的应用程序使用；它是为大量并发查询而设计的，每个查询执行少量的工作。在RDBMS世界中，这种工作负载称为OLTP工作负载。</p><p id="0bc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用于分析的应用程序或工具具有不同的工作负载特征。这些通常使用分析服务；它是为分析大量文档的少量并发查询而设计的。在RDBMS世界中，这种工作负载被称为OLAP工作负载(在线分析处理)</p><p id="2cb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Couchbase分析方法的优势/为什么选择Couchbase分析？</p><p id="6738" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">通用数据模型</strong>:我们不必强制将数据放入一个扁平的、预定义的关系模型中进行分析<br/> <strong class="is hj">工作负载隔离</strong>:运营查询延迟和吞吐量不会因您的分析查询工作负载而降低<br/> <strong class="is hj">高数据新鲜度</strong>:分析运行在最新的数据上，没有ETL或延迟。<strong class="is hj">持续数据同步</strong> <br/> <strong class="is hj">易于管理的SQL++接口</strong> <br/>通过单一系统降低基础架构复杂性、应用开发复杂性和运营与分析成本。</p><p id="1510" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分析服务应该在它自己的集群节点上单独运行，由于它可能执行的操作的大规模和持续时间，没有其他Couchbase服务在该节点上运行。</p><p id="adab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分析服务所需的最低内存(RAM)配额为1024 MB。</p><p id="50b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分析查询从不触及Couchbase数据服务器，而是并行运行在我们数据的实时阴影副本上。因此，不必担心复杂查询会降低Couchbase服务器节点的速度。</p><h1 id="2e3e" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">数据世界</h1><p id="c3e7" class="pw-post-body-paragraph iq ir hi is b it la iv iw ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn hb bi translated">分析数据世界中的顶级组织概念是dataverse。</p><p id="253a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个<strong class="is hj"> dataverse </strong>，是一个名称空间，它为您提供了一个为给定的分析应用程序创建和管理数据集和其他工件的地方。</p><p id="369c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这方面，dataverse类似于数据库或模式(模式是表示整个数据库的逻辑视图的框架结构。它定义了在关系DBMS中数据是如何组织的以及它们之间的关系是如何关联的。</p><p id="df46" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集是保存JSON对象集合的容器。它们类似于RDBMS中的表或N1QL中的键空间。一个数据集链接到一个Couchbase存储桶，这样数据集就可以从Couchbase服务器获取数据。</p><p id="5863" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">新的分析实例从两个数据部分开始，一个称为元数据(系统目录)，一个称为默认值(可用于保存数据)。</p><p id="9e0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第一个任务是告诉Analytics关于您想要隐藏的Couchbase服务器数据和您想要它存在的数据集。</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="abde" class="lo kd hi lk b fi lp lq l lr ls">CREATE DATASET datasetName ON `bucketName`;</span></pre><p id="cd42" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果bucket有不同类型或类别的数据，我们可以为那些使用<code class="du lt lu lv lk b">WHERE</code>的数据创建一个单独的数据集，它将被创建。</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="eb34" class="lo kd hi lk b fi lp lq l lr ls">CONNECT LINK Local;</span></pre><p id="1463" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Local =本地服务器(同一集群中的数据服务)</p><p id="01b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在从分析服务执行基本查询，检查是否一切正常。</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="2f09" class="lo kd hi lk b fi lp lq l lr ls">SELECT meta(k) AS meta, k AS data <br/>FROM datasetName k <br/>LIMIT 1;</span></pre><p id="cb41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与SQL一样，查询的FROM子句将变量<code class="du lt lu lv lk b">k</code>递增地绑定到位于名为<code class="du lt lu lv lk b">datasetName</code>的数据集中的数据实例。SELECT子句返回所有元信息以及满足谓词的每个绑定的数据值。</p><p id="fe0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦设置完成，你也可以从Couchbase java SDK访问这个服务。</p><p id="cf4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按照<a class="ae lw" href="https://kirankamath.hashnode.dev/establishing-connection-to-couchbase-server-from-aws-ec2-instance" rel="noopener ugc nofollow" target="_blank">使用Couchbase Java SDK </a>建立与Couchbase服务器的连接来设置Java SDK。</p><p id="3b10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客之后，用下面的代码编辑App.java代码以使用Couchbase analytics。</p><pre class="lf lg lh li fd lj lk ll lm aw ln bi"><span id="53e1" class="lo kd hi lk b fi lp lq l lr ls">import com.couchbase.client.java.*;<br/>import com.couchbase.client.java.kv.*;<br/>import com.couchbase.client.java.json.*;<br/>import com.couchbase.client.java.query.*;<br/>import com.couchbase.client.core.error.CouchbaseException;<br/>import com.couchbase.client.java.analytics.*;</span><span id="230f" class="lo kd hi lk b fi lx lq l lr ls">public class App {<br/>    public static void main(String[] args) {<br/>        try {<br/>            Cluster cluster = Cluster.connect("localhost", "username", "password");<br/>              final AnalyticsResult result = cluster<br/>                .analyticsQuery("SELECT * FROM datasetName LIMIT 2;");</span><span id="a127" class="lo kd hi lk b fi lx lq l lr ls">for (JsonObject row : result.rowsAsObject()) {<br/>                    System.out.println("Found row: " + row);<br/>                    System.out.println();</span><span id="e6dc" class="lo kd hi lk b fi lx lq l lr ls">}</span><span id="e456" class="lo kd hi lk b fi lx lq l lr ls">} catch (CouchbaseException ex) {<br/>              ex.printStackTrace();<br/>            }<br/>    }<br/>}</span></pre><p id="d4fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">学分:<a class="ae lw" href="https://docs.couchbase.com/home/index.html" rel="noopener ugc nofollow" target="_blank"> Couchbase文档</a></p></div><div class="ab cl ly lz gp ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="hb hc hd he hf"><p id="f7cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="mf">原发布于</em><a class="ae lw" href="https://blog.learnwithdata.me/exploring-couchbase-analytics-service" rel="noopener ugc nofollow" target="_blank"><em class="mf">https://blog . learnwithdata . me</em></a><em class="mf">。</em></p></div></div>    
</body>
</html>
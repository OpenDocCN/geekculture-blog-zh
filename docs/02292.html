<html>
<head>
<title>Deploying Resources with IaaC Using Lambdas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Lambdas通过IaaC部署资源</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/deploying-resources-with-iaac-using-lambdas-d987d39b6251?source=collection_archive---------23-----------------------#2021-05-09">https://medium.com/geekculture/deploying-resources-with-iaac-using-lambdas-d987d39b6251?source=collection_archive---------23-----------------------#2021-05-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/41de5650aba5003f72e8d25d77eefaee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DtAixHz3mQPg9AJ6.png"/></div></div></figure><p id="ce51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你有没有想过是否有可能通过lambdas使用AWS CloudFormation以代码的形式创建、管理和部署<em class="jo">基础设施？</em></p><p id="fa94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在研究这条路线时，我想到的一些好处是:</p><ol class=""><li id="21cf" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">对您的基础架构上正在创建、修改或删除的内容进行精细控制。</li><li id="510c" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">更容易迁移到另一个供应商。</li><li id="d6ff" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">更快地同时部署多种资源。</li><li id="cda4" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">都包装在AWS堆栈中。</li></ol><h1 id="55c0" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">最初的方法</h1><p id="2464" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">用Lambda在AWS帐户上创建资源带来了一些想法。我测试的是这条路:</p><ul class=""><li id="064e" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn lg jv jw jx bi translated">存储在桶中的json模板文件。</li><li id="80e6" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lg jv jw jx bi translated">一个lambda将运行并读取桶中的json文件</li><li id="b4af" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lg jv jw jx bi translated">lambda将与AWS CloudFormation“对话”,并发送一些参数来创建一个堆栈。其中一个参数是<strong class="is hj"> json模板</strong>。</li><li id="c020" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn lg jv jw jx bi translated">AWS CloudFormation将创建json模板上指定的资源。</li></ul><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/41de5650aba5003f72e8d25d77eefaee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DtAixHz3mQPg9AJ6.png"/></div></div></figure><h1 id="76c5" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">测试时间！</h1><p id="6355" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">首先，您需要将json模板放入一个桶中。请随意复制我在这里使用的那个:</p><p id="07de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ll" href="https://github.com/wifiwolfg/lambda-iaac/blob/main/s3template.json" rel="noopener ugc nofollow" target="_blank">https://github . com/wifi wolfg/lambda-iaac/blob/main/S3 template . JSON</a></p><p id="a7b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将创建一个带有公共s3存储桶的堆栈，准备托管一个网站。这个文件被保存为s3 bucket中的<strong class="is hj"> s3template.json </strong>。您需要的参数是对象URL。</p><h1 id="d113" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">拉姆达</h1><p id="c1cc" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">为了这个测试，我在python上创建了一个Lambda。您可以从这里下载:</p><p id="9042" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ll" href="https://github.com/wifiwolfg/lambda-iaac/blob/main/lambda-params.py" rel="noopener ugc nofollow" target="_blank">https://github . com/wifi wolfg/lambda-iaac/blob/main/lambda-params . py</a></p><p id="5652" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">或者如果您喜欢从这里复制它，它看起来是这样的:</p><figure class="lh li lj lk fd ij"><div class="bz dy l di"><div class="lm ln l"/></div></figure><blockquote class="lo lp lq"><p id="3572" class="iq ir jo is b it iu iv iw ix iy iz ja lr jc jd je ls jg jh ji lt jk jl jm jn hb bi translated"><strong class="is hj"> <em class="hi">重要:</em> </strong> <em class="hi">为了实现这一点，当我创建lambda时，附属于它的角色需要权限来读取S3资源和对</em> CloudFormation <em class="hi">资源进行写操作。</em></p></blockquote><p id="214f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以注意到<em class="jo"> Template_URL </em>指向包含json的s3对象URL。</p><h1 id="f513" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结果</h1><p id="8435" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">我们可以进入CloudFormation，看到堆栈已成功创建。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/682dfb47b7d7cda0a07deea13f27e7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5gLT_MXfzAW7n7rk.png"/></div></div></figure><p id="8c1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，如果你去s3，你将能够找到新的桶。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/d5c1a3b5eb857abeb46d20b896ac149f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rnA_iKTQBhtB_w-W.png"/></div></div></figure><h1 id="7546" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h1><p id="c869" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">我们能够有一个lambda，它可以以多种方式触发，然后它将使用CloudFormation创建资源，并拥有IaaC。</p><p id="2c5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在很多用例中，这非常有用。你认为你能如何使用这个？</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="328d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">原载于2021年5月9日https://mirairo.net</em><em class="jo">的</em> <a class="ae ll" href="https://mirairo.net/deploy-s3-iaac-lambdas-aws/" rel="noopener ugc nofollow" target="_blank"> <em class="jo">。</em></a></p></div></div>    
</body>
</html>
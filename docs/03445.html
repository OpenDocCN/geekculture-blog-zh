<html>
<head>
<title>Practical exercises to prepare your SQL job test</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">准备SQL作业测试的实践练习</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/practical-exercises-to-prepare-your-sql-job-test-fe3c1a03ea05?source=collection_archive---------23-----------------------#2021-06-08">https://medium.com/geekculture/practical-exercises-to-prepare-your-sql-job-test-fe3c1a03ea05?source=collection_archive---------23-----------------------#2021-06-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="4e15" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当你申请数据科学职位时，潜在雇主希望更好地了解你，因此他们将测试你的编程技能！许多人专注于Python和R，然而一些基本技能是SQL！</p><p id="1c9d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这篇短文中，我想与您分享一组真实的练习，这些练习(幸运地)将帮助您准备SQL测试，或者只是作为您继续准备SQL的指南。所以，我们开始吧！</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="65e4" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">准备</h1><p id="e6ba" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">希望你已经安装了运行SQL查询的软件并进行自己的实验，如果没有，我建议你创建一个免费帐户来使用Oracle <a class="ae kn" href="https://livesql.oracle.com/apex/f?p=590:1000" rel="noopener ugc nofollow" target="_blank">这里</a>，你不需要安装任何东西！</p><p id="66d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">以下练习是一家中型IT咨询公司为测试候选人而进行的一系列真实测试！即使是基础水平，我相信这是一个练习和继续准备的完美开端。</p><p id="a9bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">记住:雇主想测试应聘者的逻辑，这意味着他们不想要<em class="ko">完美的</em>解决方案，他们想知道<em class="ko">你解决问题的方式</em>。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="3357" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">你将练习什么:</strong></p><ul class=""><li id="1f4b" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">基本SELECT + WHERE语句</li><li id="415b" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">JOIN语句</li><li id="d077" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">标量和聚合函数</li><li id="c986" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">DML(数据操作语言):更新+删除</li><li id="5e26" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">集合操作</li><li id="9ff4" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">查找空值</li><li id="a95e" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">WITH + SELECT语句</li><li id="54ae" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">子查询</li></ul><h1 id="cb11" class="jk jl hi bd jm jn ld jp jq jr le jt ju jv lf jx jy jz lg kb kc kd lh kf kg kh bi translated">我们开始吧！</h1><p id="357a" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">您有以下模式结构。如果您不理解每个单元，请不要担心，只要记住这一点:</p><ol class=""><li id="c3c3" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj li kv kw kx bi translated">有三张桌子:电影院，电影和广告牌。</li><li id="bf7b" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj li kv kw kx bi translated">电影院和电影桌都和billboard有关。</li><li id="311d" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj li kv kw kx bi translated">电影院和电影桌彼此没有直接关系。</li></ol><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lj"><img src="../Images/147f347949ef9720ca7e7e8a8c9545f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fIG1h33Mm8OYKKI26CnlQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx">Schema structure</figcaption></figure><p id="8ecc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">但是用人单位没有给任何剧本！别担心，我创建了一个，这样你就可以练习并做自己的实验:<a class="ae kn" href="https://github.com/NinoGuzman/SQLPractice/blob/main/database.sql" rel="noopener ugc nofollow" target="_blank">https://github . com/Nino guzman/SQL practice/blob/main/database . SQL</a></p><p id="752d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该脚本创建以下数据库:</p><figure class="lk ll lm ln fd lo er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lz"><img src="../Images/88ce6e74ddfa0dd3482f12f96e188e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2Vou5OvTMKbqLYlxaK-HQ.png"/></div></div></figure><p id="5182" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习1:显示所有不同的年龄分类</strong></p><p id="2671" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="6c24" class="mf jl hi mb b fi mg mh l mi mj">SELECT DISTINCT classification_age <br/>FROM movie</span></pre><p id="6c45" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><p id="1f14" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可能第一个问题真的很基本，在这种情况下，只要记住关键字<em class="ko"> DISTINCT </em>将避免显示doubles。</p><p id="46dd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习2:寻找不放映任何电影的电影院</strong></p><p id="e433" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="4114" class="mf jl hi mb b fi mg mh l mi mj">SELECT cinema_name<br/>FROM cinema<br/>MINUS<br/>SELECT DISTINCT cinema_name<br/>FROM cinema <br/>NATURAL JOIN billboard <br/>NATURAL JOIN movie</span></pre><p id="fdb7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="cbd3" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">使用自然连接将把那些重合的键的信息放在一起。分析<em class="ko"> billboard </em>表，您可以观察到缺少的值是<strong class="io hj"> id_cinema = 104。</strong></li><li id="4324" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">然后使用<em class="ko">减去</em>运算，我们从集合1(所有电影院)和集合2(放映电影的电影院)中减去公共元素，即不放映电影的电影院。</li></ul><p id="4ae8" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习3:查找分级年龄大于16岁且未在任何电影院上映的电影</strong></p><p id="60d3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="4cd7" class="mf jl hi mb b fi mg mh l mi mj">SELECT movie_name<br/>FROM movie<br/>WHERE id_movie in (<br/>    SELECT id_movie <br/>    FROM movie<br/>    MINUS<br/>    SELECT DISTINCT id_movie<br/>    FROM billboard<br/>    )<br/>AND classification_age &gt; 16</span></pre><p id="c8bd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="aa62" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">WHERE中的子查询为我们提供了未在任何电影院放映的电影的id_movie(类似于上一个练习)。</li><li id="4773" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">添加AND关键字过滤分类年龄。</li></ul><p id="27c7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习4: <br/> a)播放没有年龄分类信息的电影<br/> b)更新符合上述标准的电影的信息，将这些值设置为0(针对所有公众)</strong></p><p id="1139" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="4c08" class="mf jl hi mb b fi mg mh l mi mj">a)<br/>SELECT movie_name <br/>FROM  movie<br/>WHERE classification_age IS NULL</span><span id="fa70" class="mf jl hi mb b fi mk mh l mi mj">b)<br/>UPDATE movie<br/>SET classification_age = 0<br/>WHERE classification_age IS NULL</span></pre><p id="031a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习5:删除未在任何影院上映的分级年龄在18岁以上的电影</strong></p><p id="a622" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="0e60" class="mf jl hi mb b fi mg mh l mi mj">DELETE FROM movie <br/>WHERE movie_name = (<br/>   SELECT movie_name<br/>   FROM movie<br/>   WHERE id_movie in (<br/>       SELECT id_movie <br/>       FROM movie<br/>       MINUS<br/>       SELECT distinct id_movie<br/>       FROM billboard<br/>       )<br/>   AND classification_age &gt; 18     <br/>)</span></pre><p id="cd3b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="c3d1" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">我们使用与之前相同逻辑来访问没有在任何电影院放映的电影，并根据年龄进行过滤(参见练习3)。</li><li id="0f89" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">我们使用关键字DELETE从表<em class="ko"> movie中删除结果。</em></li></ul><p id="f678" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习6:统计每家电影院的电影数量</strong></p><p id="273f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="bdd5" class="mf jl hi mb b fi mg mh l mi mj">SELECT cinema_name, COUNT(DISTINCT id_movie) Total_movies<br/>FROM cinema c<br/>NATURAL JOIN billboard b<br/>NATURAL JOIN movie m<br/>GROUP BY cinema_name</span></pre><p id="ea6b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="f3a3" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">请记住，我们必须将所有三个表连接在一起才能获得信息，这将为我们提供实际上在某些电影院上映的电影。</li><li id="c97a" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">在SQL中使用标量和聚合函数也是必不可少的，在这种情况下，我们对代表每部电影和按电影分组的所有不同的<strong class="io hj"> id_movie </strong>进行计数。</li></ul><p id="164d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习7:显示放映电影数量超过可用屏幕数量的电影院</strong></p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="853a" class="mf jl hi mb b fi mg mh l mi mj">WITH tab_aux as(<br/>    SELECT COUNT(DISTINCT id_movie) Total_movies<br/>    FROM cinema c<br/>    NATURAL JOIN billboard b<br/>    GROUP BY cinema_name</span><span id="af36" class="mf jl hi mb b fi mk mh l mi mj">)</span><span id="5200" class="mf jl hi mb b fi mk mh l mi mj">SELECT c.cinema_name, c.number_screens, t.Total_movies<br/>FROM tab_aux t, cinema c<br/>WHERE  c.number_screens &lt; t.Total_movies</span></pre><p id="2f45" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="99db" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">WITH语句用于创建一个辅助表，该表实际上包含与上面相同的结果(电影院的电影总数)</li><li id="1675" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">使用表<em class="ko"> tab_aux </em>和<em class="ko"> cinema，</em>我们过滤那些显示的电影多于可用屏幕数量的电影院。<br/> <strong class="io hj">警告:在这种情况下</strong> <strong class="io hj">所有电影院放映的电影都少于可用屏幕的数量。因此输出将是:<em class="ko">没有找到数据。</em> </strong></li></ul><p id="67d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习8:显示只向所有公众放映电影的电影院(classification_age = 0) </strong></p><p id="3336" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="54d3" class="mf jl hi mb b fi mg mh l mi mj">SELECT id_cinema, cinema_name<br/>FROM movie m<br/>NATURAL JOIN billboard b<br/>NATURAL JOIN cinema c<br/>WHERE m.classification_age = 0</span></pre><p id="48f0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习9:为12岁以上的公众放映电影，这些电影在可用屏幕数量超过5个的电影院中放映。</strong></p><p id="4297" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="08df" class="mf jl hi mb b fi mg mh l mi mj">SELECT movie_name, classification_age, number_screens <br/>FROM movie m<br/>NATURAL JOIN billboard b<br/>NATURAL JOIN cinema c<br/>WHERE m.classification_age &gt; 12<br/>AND c.number_screens &gt; 5</span></pre><p id="622d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="e54f" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">一旦信息被放在一起(自然连接)，我们就按照年龄和屏幕数量进行过滤。</li><li id="312e" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">记住符号<em class="ko"> a.col </em>的意思是:“从表<em class="ko"> a </em>中获取列<em class="ko"> col </em>”</li></ul><p id="f126" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">练习10:选择电影院，以及那些电影院中分类年龄与18岁不同的电影。</strong></p><p id="dad3" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">解决方案:</p><pre class="lk ll lm ln fd ma mb mc md aw me bi"><span id="b0f0" class="mf jl hi mb b fi mg mh l mi mj">SELECT cinema_name, movie_name, classification_age<br/>FROM movie m<br/>NATURAL JOIN billboard b<br/>NATURAL JOIN cinema c<br/>WHERE m.classification_age in (<br/>    SELECT DISTINCT classification_age<br/>    FROM movie<br/>    WHERE classification_age != 18<br/>)</span></pre><p id="fcdf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">逻辑:</p><ul class=""><li id="ab27" class="kp kq hi io b ip iq it iu ix kr jb ks jf kt jj ku kv kw kx bi translated">子查询用于获取所有不同于18岁的分类年龄。</li><li id="19fd" class="kp kq hi io b ip ky it kz ix la jb lb jf lc jj ku kv kw kx bi translated">当信息放在一起时，我们选择电影院、电影和分类年龄，除了分类年龄= 18。</li></ul></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="8efa" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">最终意见</h1><p id="8544" class="pw-post-body-paragraph im in hi io b ip ki ir is it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj hb bi translated">希望以上练习对你练习SQL技能有用。我鼓励你下载代码，运行查询，做你自己的实验，这才是我们真正学习的方式！</p><p id="44d4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你觉得这很有趣，请跟我来。如果您有任何意见、问题或建议，请随时联系我。</p><p id="f864" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果您对展示如何从示例中创建数据库的类似帖子或更复杂的SQL练习感兴趣，请告诉我。</p><p id="4318" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">祝你好运！</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="08ff" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Github库:<a class="ae kn" href="https://github.com/NinoGuzman/SQLPractice.git" rel="noopener ugc nofollow" target="_blank">https://github.com/NinoGuzman/SQLPractice.git</a></p></div></div>    
</body>
</html>
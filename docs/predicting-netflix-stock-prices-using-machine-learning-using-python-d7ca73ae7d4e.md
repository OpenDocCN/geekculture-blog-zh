# 使用机器学习和 Python 来预测网飞股票价格

> 原文：<https://medium.com/geekculture/predicting-netflix-stock-prices-using-machine-learning-using-python-d7ca73ae7d4e?source=collection_archive---------2----------------------->

![](img/cfac81deb1e45c14900612fcb636b2f1.png)

Photo by [Cameron Venti](https://unsplash.com/@ventiviews?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/netflix?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

## 使用 SARIMA 过程和线性回归预测网飞股票价格的实际应用

我将在这篇文章的开头陈述一个显而易见的事实:**网飞是世界上主要的流媒体公司之一。**

在意大利，有一句谚语说:“罗马人无所不能”。
它的基本意思是**“任何伟大的事情都需要时间去建造”**。

**在这本笔记本中，我们将尝试使用一些非常著名的机器学习技术来预测网飞的股票价格**。

重要的是，我们要非常精确地预测什么。

换句话说，我们将把我们的目标分成三部分:

1.  **长期**长期预测
2.  **中期**中期预测
3.  **短期**短期预测

我想让这个介绍尽可能简短，所以我会在介绍的时候解释我的意思。

## 0.数据集+库

数据集是开源的，可以从[这里](https://www.kaggle.com/akpmpr/updated-netflix-stock-price-all-time)下载。一点都不重，下载起来超级快。
这些是我用过的库:

这是导入数据和绘制数据的方式:

> P.S .我对使用**高**股价没有什么特别的兴趣，我用的就是。你可以使用低的或者开放的，实际上我甚至不认为这对我们的情况有很大的影响。我相信，一般的方法，甚至可能是结论，将是真正相似的。无论如何，您可以轻松地用数据集的另一列运行这段代码，不会有任何问题！

## 1.长期预测

我所说的**长期预测**指的是基于我们所有数据的所有时间预测。如果你考虑从开始到今天的所有数据集，你当然是在寻找你的函数的一般行为。这意味着你知道你无法捕捉到月份或天数的涨跌，但你希望能够捕捉到股价的**趋势。**

我们要用的工具叫做**多项式回归**，它是**线性回归的自然延伸。**有很多可以读的，从更经典的**书籍**开始，比如[这本](https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/#:~:text=This%20leading%20textbook%20provides%20a,well%20as%20researchers%20and%20practitioners.)或者更直接的方法，比如 **Sklearn** 文档(这里[这里](https://scikit-learn.org/stable/modules/linear_model.html)，这里[这里](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html)和[这里](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html))。

简而言之，我们将时间轴转换成一个 N 维矩阵，并对该矩阵应用线性回归模型。我将它应用于整个数据集，分为三部分:

*   **训练集**的 90%
*   **验证集**的 5%
*   **测试装置**的 5%

我使用训练集来测试不同类型的模型，使用不同类型的多项式次数。然后我使用验证集来挑选具有最低**均方误差**的一个，并对测试集应用最优度。

这就是如何测试不同的多项式模型:

这是这个过程的结果:

因此，**越简单越好**:)

具有最低 MSE 的模型是度数= 3 的模型。看起来是这样的:

我们可以看到，我们很好地抓住了这一趋势。当然，它只是一个三次多项式，所以它不会跟随真实股票价格的所有起伏。好的一面是，它不应该预测涨跌，因为它被认为是一个长期预测。

既然已经做出了这种预测，我们可以将它分离出来，并对原始信号进行去趋势化，以单独研究这些起伏:

这是新的信号，可以考虑用于**中期预测。**

## 2.中期预测

要进行这种预测，首先要做的是对信号进行平均，并考虑其月均值:

现在我们想考虑在一定数量的月份(比如说 44 个月)内发生了什么，并预测在接下来的三个月内会发生什么。

> 附注:我们没有使用整个数据集，因为查看 2010 年发生的事情对理解 2021 年将要发生的事情没有帮助…至少在这个模型中没有:)

在我们的案例中，我们将使用的工具是 ARIMA 模型。同样，我们试图理解线性模型的系数及其被建模为噪声的不确定性([此处](https://www.statsmodels.org/dev/generated/statsmodels.tsa.arima.model.ARIMA.html)您可以找到文档)。

让我们考虑一下从 2017 年开始会发生什么:

给定我们蓝色的东西，我们想预测我们将在**红色中看到什么。**

这是我们将要使用的函数:

这是优化过程(不应超过 5 分钟):

这就是 AIC(赤池信息标准)的价值:我们将从中挑选出最好的模型

这是我们最佳型号的统计表:

这里我们定义结果变量:

我们在这里绘制它:

一些注意事项:

*   **界限相当大**，但这是因为我们想要有 95%的信心，如果我们接受我们可能在超过 95%的不确定性中出错的事实，我们可以缩小界限
*   该模型实际上是预测未来三个月我们将有一个上升趋势。耶。:D

## 3.短期预测

这基本上是相同的理论和过程，但是现在我们想根据之前的 41 天来预测接下来的三天。

我将非常简要地解释这一过程，并强调其不同之处:

这是新数据集及其绘图的定义:

这是优化过程:

这是模型选择和结果生成部分:

这是最后一部分:

一些注意事项:

*   短期预测更加不确定和难以预测
*   尽管如此，我们的模型预测了第一次大的下跌，然后预测会有一些轻微的上涨，但大部分是持平的。**这不是事实，但大体上符合现实中将要发生的事情。**

## 4.结论

这本笔记本的目的只是为了强调一个我的教授们已经强调了无数次的概念:**预测是一个时间尺度的问题。**

预测“不确定时期”是不可能的，因为短期预测需要不同的数据和相对于中期或长期预测的不同方法。

如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:

A.在 [**Linkedin**](https://www.linkedin.com/in/pieropaialunga/) 上关注我，在那里我发布我所有的故事
B .订阅我的 [**简讯**](https://piero-paialunga.medium.com/subscribe) 。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。
C .成为 [**推荐会员**](https://piero-paialunga.medium.com/membership) ，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。再见:)
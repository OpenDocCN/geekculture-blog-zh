<html>
<head>
<title>Develop REST APIs in Go using Gorilla Mux</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Gorilla Mux在Go中开发REST APIs</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/develop-rest-apis-in-go-using-gorilla-mux-5869b2179a18?source=collection_archive---------6-----------------------#2021-07-05">https://medium.com/geekculture/develop-rest-apis-in-go-using-gorilla-mux-5869b2179a18?source=collection_archive---------6-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7317" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">介绍如何使用Gorilla Mux在Go中开发REST APIs</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/d7c39c274d7fde3444d909b95cdcc079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBn-ROC_CF_pheuqczMWiQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jt" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae jt" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="6413" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">介绍</h1><p id="ff6a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">REST APIs是当今程序员生活中不可或缺的一部分。如今，各种软件组件之间的大多数通信都是通过REST APIs进行的。著名的编程语言有各种各样的库和框架，帮助程序员减少从零开始构建API服务的时间。</p><p id="abad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将探讨如何使用Gorilla Mux在Go语言中开发REST APIs。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="7ed5" class="ju jv hi bd jw jx le jz ka kb lf kd ke kf lg kh ki kj lh kl km kn li kp kq kr bi translated">什么是大猩猩Mux</h1><p id="1bed" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Gorilla Mux是Gorilla Web Toolkit中的一个包。它提供了创建HTTP路由器的简单方法。使用这个包，我们可以将程序流重定向到各自的HTTP处理函数。</p><p id="116d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么叫Mux？名字来源于<em class="lj"> HTTP请求多路复用器。</em></p><p id="16f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">大猩猩网络工具包</strong></p><p id="3639" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Gorilla是一个用于Go编程语言的web工具包，由多个包组成。Gorilla Mux是Gorilla Web Toolkit中的一个包。其他包包括<a class="ae jt" href="https://github.com/gorilla/rpc" rel="noopener ugc nofollow" target="_blank">大猩猩RPC </a>和<a class="ae jt" href="https://github.com/gorilla/websocket" rel="noopener ugc nofollow" target="_blank">大猩猩WebSocket </a>。更多详情，请参考<a class="ae jt" href="https://www.gorillatoolkit.org/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="8289" class="ju jv hi bd jw jx le jz ka kb lf kd ke kf lg kh ki kj lh kl km kn li kp kq kr bi translated"><strong class="ak">项目</strong></h1><p id="e7dc" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们首先从创建项目结构开始。</p><p id="8262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为项目创建一个目录(我们将其命名为<em class="lj"> go-rest-api-example </em>)。现在，执行下面的代码来初始化Go模块。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="b267" class="lp jv hi ll b fi lq lr l ls lt">go mod init get <em class="lj">go-rest-api-example</em></span></pre><p id="688a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将初始化Go模块并创建一个名为<em class="lj"> go.mod </em>的文件来跟踪依赖关系。</p><h1 id="6dbb" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">安装</h1><p id="822a" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">Gorilla Mux的安装非常简单。从项目目录中执行以下命令:</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="74b1" class="lp jv hi ll b fi lq lr l ls lt">go get -u github.com/gorilla/mux</span></pre><p id="baff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦执行，这将下载Gorilla Mux并配置为依赖项。(在撰写本文时，Gorilla Mux的最新版本是<em class="lj"> v1.8.0 </em>)</p><p id="6d60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们继续构建简单的API端点。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="50a5" class="ju jv hi bd jw jx le jz ka kb lf kd ke kf lg kh ki kj lh kl km kn li kp kq kr bi translated">我们在开发什么？</h1><p id="1206" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">出于本文的目的，让我们挑选一个简单的例子。我们将创建两个API端点:</p><ul class=""><li id="96ee" class="lu lv hi ih b ii ij im in iq lw iu lx iy ly jc lz ma mb mc bi translated"><strong class="ih hj"> GET /health-check </strong>:这将返回一条消息，说明API服务器正在运行。如果我们没有得到任何响应，我们可以假设API服务器没有启动。</li><li id="9b07" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated">GET /persons :这将返回一个JSON消息，其中包含人员详细信息的数组。</li></ul><h1 id="0500" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">响应结构</h1><p id="0ead" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们将响应结构定义如下:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mi mj l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">REST API Response Structure</figcaption></figure><p id="3e00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将一个人的详细信息和响应定义为一组人。因为我们希望响应是JSON，所以我们也将为每个字段添加JSON映射。</p><h1 id="7656" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">路线</h1><p id="07e4" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在，是时候指定API端点、处理函数和HTTP方法了。</p><p id="7ccd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以这样做:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mi mj l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Configure REST API routes</figcaption></figure><p id="4ddd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">API服务器位于本地主机和端口8080。</p><h1 id="30b8" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">处理函数</h1><p id="c000" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">现在，我们需要为上面定义的各个端点定义处理函数。</p><p id="0da5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">健康检查</strong></p><p id="1e22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">处理函数接受请求和响应参数。我们将设置一个状态头和一个简单的响应，如下所示。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mi mj l"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Health Check handler function</figcaption></figure><p id="5ef0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">人物</strong></p><p id="f292" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在persons API端点的处理函数中，我们将响应类型设置为JSON。一旦从helper函数中检索到人员的详细信息，我们将把该结构转换成JSON并将其作为响应添加。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="d9c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通常，我们会从数据库中获取这些细节。目前，让我们使用一种简单的方法来获取人员详细信息，如下所示:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mi mj l"/></div></figure><p id="7b20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样。我们的代码已经准备好了。</p><blockquote class="mk ml mm"><p id="aab8" class="if ig lj ih b ii ij ik il im in io ip mn ir is it mo iv iw ix mp iz ja jb jc hb bi translated">你可以在这里找到代码<a class="ae jt" href="https://github.com/bijeshos/go-rest-api-example" rel="noopener ugc nofollow" target="_blank">的完整工作版本</a>。</p></blockquote><h1 id="6bc3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">执行</h1><p id="3eed" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们按如下方式执行程序:</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="0b0d" class="lp jv hi ll b fi lq lr l ls lt">go run main.go</span></pre><p id="c231" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将能够看到如下日志:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mq"><img src="../Images/a67ec0cce514b8e000aed9caaa42a489.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*itnLNgyxqT8ZXVHRpNOfhg.png"/></div></figure><p id="2a63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们的API服务器正在运行，并准备接受请求。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="b7b8" class="ju jv hi bd jw jx le jz ka kb lf kd ke kf lg kh ki kj lh kl km kn li kp kq kr bi translated">测试</h1><p id="87aa" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">为了测试API端点，让我们使用Postman。如果你还没有，你可以从<a class="ae jt" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank">这里</a>获取。</p><p id="d2ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">健康检查</strong></p><p id="7262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们使用以下URL访问运行状况检查端点:</p><p id="cf56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="http://localhost:8080/health-check" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/health-check</a></p><p id="fc4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/48e0320d80dc301d4294cace37c83ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEL69ysXbCwimU8VwyTkZw.png"/></div></div></figure><p id="c5a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">人</strong></p><p id="a485" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们使用以下URL访问persons端点:A</p><p id="684a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" href="http://localhost:8080/persons" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/persons</a></p><p id="26a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结果如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/9710befed1483a0f99bb70a51d4528e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M9-0YCaBvYc9Tn2FCByC9A.png"/></div></div></figure><p id="a5e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">日志</strong></p><p id="056e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您还可以在终端上看到如下日志:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mt"><img src="../Images/111f3a3246bc1c987399abc35bb70d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*GicBH8LnPXXu1tgRFJtclQ.png"/></div></figure></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><h1 id="0775" class="ju jv hi bd jw jx le jz ka kb lf kd ke kf lg kh ki kj lh kl km kn li kp kq kr bi translated">摘要</h1><p id="25a1" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">在本文中，我们使用Gorilla Mux在Go中创建了两个简单的REST API端点。</p><blockquote class="mk ml mm"><p id="2b8d" class="if ig lj ih b ii ij ik il im in io ip mn ir is it mo iv iw ix mp iz ja jb jc hb bi translated">项目的工作版本可以在下面的GitHub repo中找到:</p><p id="cf45" class="if ig lj ih b ii ij ik il im in io ip mn ir is it mo iv iw ix mp iz ja jb jc hb bi translated"><a class="ae jt" href="https://github.com/bijeshos/go-rest-api-example" rel="noopener ugc nofollow" target="_blank">https://github.com/bijeshos/go-rest-api-example</a></p></blockquote></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="2cd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天到此为止。直到我们再次见面，快乐编码！</p><h1 id="9ee4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">参考</h1><ul class=""><li id="fcbd" class="lu lv hi ih b ii ks im kt iq mu iu mv iy mw jc lz ma mb mc bi translated"><a class="ae jt" href="https://github.com/gorilla/mux" rel="noopener ugc nofollow" target="_blank">https://github.com/gorilla/mux</a></li><li id="075f" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><a class="ae jt" href="https://www.gorillatoolkit.org/" rel="noopener ugc nofollow" target="_blank">https://www.gorillatoolkit.org/</a></li><li id="2fd8" class="lu lv hi ih b ii md im me iq mf iu mg iy mh jc lz ma mb mc bi translated"><a class="ae jt" href="https://github.com/bijeshos/go-rest-api-example" rel="noopener ugc nofollow" target="_blank">https://github.com/bijeshos/go-rest-api-example</a></li></ul></div></div>    
</body>
</html>
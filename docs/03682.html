<html>
<head>
<title>My stdLogging Module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的标准日志模块</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/stdlogging-module-d5d69ff7103f?source=collection_archive---------32-----------------------#2021-06-13">https://medium.com/geekculture/stdlogging-module-d5d69ff7103f?source=collection_archive---------32-----------------------#2021-06-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="6c71" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">AlexBerUtils项目中的描述模块</h1><p id="339b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">这是瘦适配器层，将stdout/stderr(或任何其他类似流的对象)重定向到标准Python的logger。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><p id="af74" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">源代码你可以在这里找到<a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/emails.py" rel="noopener ugc nofollow" target="_blank">。它是我的AlexBerUtils项目的一部分。</a></p><p id="0266" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">您可以从PyPi安装AlexBerUtils:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0ab1" class="kx ig hi kt b fi ky kz l la lb">python3 -m pip install -U alex-ber-utils</span></pre><p id="914a" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">你可以选择安装一些依赖项，比如jinja2。最简单的方法是跑步:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="762e" class="kx ig hi kt b fi ky kz l la lb">python3 -m pip install alex-ber-utils[yml]</span></pre><p id="dc5f" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated"><strong class="jf hj">注意</strong>同时<a class="ae kn" href="https://github.com/zerwes/hiyapyco" rel="noopener ugc nofollow" target="_blank"> hiyapyco </a>至少应为0.4.16。</p><p id="bf01" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">然而，这并不是严格要求的。</p><p id="2b27" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">关于如何安装的更多详细说明，请参见此处的<a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="ceab" class="if ig hi bd ih ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc bi translated">高级描述</h1><p id="b61c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">该模块基于<a class="ae kn" href="https://github.com/fx-kirin/py-stdlogging/blob/master/stdlogging.py" rel="noopener ugc nofollow" target="_blank">https://github . com/FX-Kirin/py-STD logging/blob/master/STD logging . py</a>参见<a class="ae kn" href="https://github.com/fx-kirin/py-stdlogging/pull/1" rel="noopener ugc nofollow" target="_blank">https://github.com/fx-kirin/py-stdlogging/pull/1</a>。我在这里遇到过关于这个模块的<a class="ae kn" href="https://stackoverflow.com/questions/47325506/making-python-loggers-log-all-stdout-and-stderr-messages" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/47325506/making-python-loggers-log-all-stdout-and-stderr-messages</a>。引用:“但是要小心捕获stdout，因为它非常脆弱”</p><p id="28aa" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">我有一些第三方模块(即webpy ),它使用了<code class="du lh li lj kt b">stdout </code>和<code class="du lh li lj kt b">stderr </code>,但没有使用标准Python的日志机制。我的应用程序实际上是在docker内部运行的，所以我希望能够将这些输出重定向到标准的日志记录机制(这使我获得了最大的灵活性——例如，我可以在<code class="du lh li lj kt b">stdout</code>和日志文件中保存我的日志，日志文件将存储在挂载的卷上)。</p><p id="30d1" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">模块恰恰给了我这种能力。在我的特定用例中，只重定向<code class="du lh li lj kt b">stderr</code>就足够了。正如我之前说过的，我正在Docker内部运行。我在用<code class="du lh li lj kt b">tty</code>跑步。因为<a class="ae kn" href="https://unix.stackexchange.com/questions/616616/separate-stdout-and-stderr-for-docker-run" rel="noopener ugc nofollow" target="_blank">https://UNIX . stack exchange . com/questions/616616/separate-stdout-and-stderr-for-docker-run</a>所以只为<code class="du lh li lj kt b">stderr</code>做就够了。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="3936" class="if ig hi bd ih ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc bi translated">使用示例:</h1><figure class="ko kp kq kr fd lk"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="cd55" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">配置文件(简化):</p><figure class="ko kp kq kr fd lk"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="4255" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated"><strong class="jf hj">注意:</strong>我正在使用<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-major-init-app-conf-module-1a5d9fb3998c">我的init_app_conf模块</a>来解析这个文件。这不是必需的，您可以根据需要初始化日志模块。</p><p id="a7d9" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">如果你想改编<code class="du lh li lj kt b">stdout</code>，你应该写:</p><figure class="ko kp kq kr fd lk"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="a1f4" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">如果您想重定向来自<code class="du lh li lj kt b">stdout</code>和<code class="du lh li lj kt b">stderr</code>的输出(它们是不同的流)，您可以在代码中包含这两行。或者，您可以在程序启动时将<code class="du lh li lj kt b">stderr </code>重定向到<code class="du lh li lj kt b">stdout</code>(这就是Docker所做的，如果您在<code class="du lh li lj kt b">docker run</code>命令中有<code class="du lh li lj kt b">-t</code>选项)。</p><p id="a15f" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">您还可以提供用于回显输出的<code class="du lh li lj kt b">logger_level</code>。默认为<code class="du lh li lj kt b">logging.ERROR</code>。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="267c" class="if ig hi bd ih ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc bi translated">高级用法:</h1><p id="13d9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">您可以指定自己的适配器类。例如:</p><figure class="ko kp kq kr fd lk"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="8c7a" class="pw-post-body-paragraph jd je hi jf b jg ki ji jj jk kj jm jn jo kk jq jr js kl ju jv jw km jy jz ka hb bi translated">这指定了默认适配器类。您可以提供自己的实现。它可以是上面代码中的<code class="du lh li lj kt b">str</code>或<code class="du lh li lj kt b">class</code>。您的实现可以扩展默认协议，或者只实现相同的协议。</p></div><div class="ab cl kb kc gp kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="hb hc hd he hf"><h1 id="5bb1" class="if ig hi bd ih ii lc ik il im ld io ip iq le is it iu lf iw ix iy lg ja jb jc bi translated">另请参见:</h1><ul class=""><li id="169b" class="ln lo hi jf b jg jh jk jl jo lp js lq jw lr ka ls lt lu lv bi translated"><code class="du lh li lj kt b"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/importer.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">importer</em></a></code> <em class="lw"> </em>模块或者<a class="ae kn" rel="noopener" href="/analytics-vidhya/how-to-write-easily-customizable-code-8b00b43406b2">如何编写轻松可定制的代码？</a></li><li id="721b" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><code class="du lh li lj kt b"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">mains</em></a></code> <em class="lw"> </em>模块中的<code class="du lh li lj kt b"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L12" rel="noopener ugc nofollow" target="_blank"><em class="lw">fixabscwd()</em></a><em class="lw"> </em></code>功能或者<a class="ae kn" rel="noopener" href="/@alex_ber/making-relative-path-to-file-to-work-d5d0f1da67bf">制作文件的相对路径来工作</a>。</li><li id="fe5c" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><code class="du lh li lj kt b"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">mains</em></a></code> <em class="lw"> </em>模块或<a class="ae kn" href="https://alex-ber.medium.com/make-path-to-file-on-windows-works-on-linux-402ed3624f66" rel="noopener">中的<code class="du lh li lj kt b"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L237" rel="noopener ugc nofollow" target="_blank"><em class="lw">fix_retry_env</em></a><em class="lw">() </em></code>函数在Windows上生成文件路径在Linux上有效。</a></li><li id="29be" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/parsers.py" rel="noopener ugc nofollow" target="_blank"> <em class="lw">解析器</em> </a> <em class="lw"> </em>模块或<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-parser-module-429ed1457718">描述一个最老的AlexBerUtils项目</a></li><li id="9ca6" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/ymlparsers.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">ymlparser</em></a><em class="lw"/>模块或者<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-ymlparsers-module-88221edf16a6">模块的低级API模块对其他模块的描述</a></li><li id="a5ae" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/init_app_conf.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">init_app_conf</em></a>模块，或者<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-major-init-app-conf-module-1a5d9fb3998c">我的专业init _ app _ con模块</a></li><li id="afbd" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/deploys.py" rel="noopener ugc nofollow" target="_blank"> <em class="lw">部署</em> </a>模块，或者<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-deploys-module-26c5599f1b15">我的部署模块</a></li><li id="7174" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/emails.py" rel="noopener ugc nofollow" target="_blank"> <em class="lw">电子邮件</em> </a> <em class="lw"> </em>模块，或者<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-emails-module-3ad36a4861c5">我的电子邮件模块</a></li><li id="a23d" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/processinvokes.py" rel="noopener ugc nofollow" target="_blank"><em class="lw">processinvokes</em></a><em class="lw"/>模块，或<a class="ae kn" rel="noopener" href="/analytics-vidhya/my-processinvokes-module-de4d301518df"> My processinvokes模块</a></li><li id="2fee" class="ln lo hi jf b jg lx jk ly jo lz js ma jw mb ka ls lt lu lv bi translated"><a class="ae kn" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/stdlogging.py" rel="noopener ugc nofollow" target="_blank"> <em class="lw"> stdLogging </em> </a>模块，或<a class="ae kn" href="https://alex-ber.medium.com/stdlogging-module-d5d69ff7103f" rel="noopener"> My stdLogging模块</a></li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>Nesting Routes in Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在轨道中嵌套路线</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/nested-routes-5d9bb14c999d?source=collection_archive---------7-----------------------#2021-08-14">https://medium.com/geekculture/nested-routes-5d9bb14c999d?source=collection_archive---------7-----------------------#2021-08-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="19fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我开发了我的第一个Ruby on Rails应用。项目完成后，我对自己说“哇！多好的旅程啊！”换句话说，我学到了很多。我从头到尾都被一些概念卡住了，但最终还是通过了。</p><p id="8275" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我建立的应用程序是一个简单的模拟<a class="ae jd" href="https://github.com/slcsta/My-Crypto-Portfolio" rel="noopener ugc nofollow" target="_blank">加密货币交易和跟踪网站</a>。我认为加密货币会是我的Rails项目中一个有趣的主题。</p><p id="0c9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我的代码中最难部署的概念是嵌套路由。为了确保我最终理解了这些复杂的路由，我将解释什么是嵌套路由以及如何使用它们。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/9328f575dde8a1a4b6a6e380c952bcb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E_a7FdZlnSK2E6t2"/></div></div></figure><p id="78d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为什么嵌套航线？</strong></p><p id="c566" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用嵌套路由来:</p><ol class=""><li id="fbfa" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">使代码更具可读性，以及</li><li id="11e1" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">关联更容易——嵌套总是让我们通过URL访问父id。</li></ol><p id="2296" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何使用嵌套路线</strong></p><p id="ee44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了简单起见，让我们来看一个艺术家和歌曲的例子，而不是我的加密模型:一个艺术家有许多歌曲，一首歌曲属于一个艺术家。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ke"><img src="../Images/01be9a3757af2f848564d4964600e0af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NsUywLwcUd8RE7sX"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kf"><img src="../Images/0a0c334dee49513ce94381d6baf5593f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yN8EZvdEQkLQ8CbE"/></div></div></figure><p id="a920" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在嵌套路由中，belongs_to(子)关联始终嵌套在has_many(父)关联下。第一步是添加嵌套路由，如下所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kg"><img src="../Images/118bc2cfa3f7c9719e6061c6507ba47c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XEDNO2sQT2Myl0-0"/></div></div></figure><p id="17af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的Rails路由器示例中，“索引”和“显示”路由是唯一列出的嵌套路由(可以添加其他资源)。在嵌套下面，请注意歌曲的常规资源路径，这些路径没有嵌套。</p><p id="3945" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加嵌套路线后，歌曲控制器索引操作将处理非嵌套和嵌套路线:所有歌曲(非嵌套索引)和属于特定艺术家的所有歌曲(嵌套索引)。songs控制器中需要一个条件语句来考虑这两种情况。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kh"><img src="../Images/bc3c12c3bfeb15b5a10ec0aeb9e233ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UCda5ivi-xBDk3Op"/></div></div></figure><p id="7c5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，尽管嵌套发生在artist下，但我们处理的是songs控制器。当有疑问时，总是看一看可用的路线。控制器动作明确说明了我们需要哪个控制器。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ki"><img src="../Images/6f2bb6b993bc511644f92f61569aacdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pUrg1KNN3s651ggLDEo57w.png"/></div></div></figure><p id="55ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回到上面例子中的歌曲控制器。请注意，我们在索引操作中添加了一个条件语句，以检查params hash: params[:artist_id]中的artist_id键。</p><p id="34a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果艺术家id键存在，Rails知道控制器正在请求嵌套索引，并以适当的URL响应。如果请求嵌套索引，我们将@songs变量设置为属于该艺术家id:artist . find(params[:artist _ id])songs的所有歌曲。</p><p id="7055" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">否则(' else ')，如果params hash中没有艺术家id键，Rails就知道使用非嵌套索引并访问所有歌曲:Song.all。这有多神奇？！！一旦我们正确地设置了嵌套路由，默认情况下，我们只处理属于特定艺术家的歌曲对象。URL中的艺术家id将我们限制在只属于该艺术家的歌曲对象上。哇！</p><p id="8be1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我们更新了歌曲控制器中的索引动作，但是我们不必对显示动作做任何事情。show操作将处理嵌套和未嵌套的路由，但将根据路径呈现所请求的任何歌曲集。</p><p id="353f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想要嵌套一个“new”路径来在一个特定的艺术家下创建一首新歌，请注意，您必须将父元素和子元素都传递到表单中:([@artist，@song])，而不仅仅是(@song)。</p><p id="0b60" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像学习Rails时的所有事情一样，您一步一步地在代码中走得越多，就越能理解发生了什么。当我第一次接触路由嵌套时，我花了几天时间试图理解代码中发生的事情。我读了一堆解释，但最有帮助的是使用“bye bug”gem来进入我的代码，以访问与我的语法相关的值。</p></div></div>    
</body>
</html>
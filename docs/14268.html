<html>
<head>
<title>Error Handling Codeigniter 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">错误处理Codeigniter 4</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/error-handling-codeigniter-4-1e5b3e9234c1?source=collection_archive---------3-----------------------#2022-08-24">https://medium.com/geekculture/error-handling-codeigniter-4-1e5b3e9234c1?source=collection_archive---------3-----------------------#2022-08-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e45ebe2e01c8b1c1dd30b5543c4ec0bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQPxeil3gpxOyRsvYWb3rw.png"/></div></div></figure><p id="eebd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你好，朋友们，我祝你们身体健康，永远成功。这一次我们仍然在讨论错误处理，但是这一次我们讨论的是Codeigniter 4中的错误处理。</p><p id="733a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们创建应用程序时，我们经常会遇到一些问题，例如经常出现的错误。对于app用户来说很烦。Codeigniter还有一种方法可以在出现错误时处理问题。</p><p id="0410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">开发应用程序时，错误处理非常有用。这将使处理错误变得更加容易。</p><p id="4509" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请遵循以下步骤:</p><ol class=""><li id="bbd3" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">错误处理配置</li><li id="0a31" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">使用异常</li><li id="0da8" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">使用PageNotFoundException</li></ol><p id="8d07" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另请阅读其他教程:</p><p id="6c22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/membuat-sitemap-otomatis-codeigniter-4/" rel="noopener ugc nofollow" target="_blank">创建Codeigniter 4自动化网站地图</a></p><p id="c12c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kc" href="https://temanngoding.com/codeigniter-4-membuat-notifikasi-menggunakan-sweetalert/" rel="noopener ugc nofollow" target="_blank"> Codeigniter 4 ~使用SweetAlert创建通知</a></p><h1 id="1354" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">错误处理配置</h1><p id="3c48" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">默认情况下，CodeIgniter将显示开发和测试环境中的所有错误，而不会显示生产环境中的任何错误。您可以通过在。环境文件。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/9749da6d4666eb8a32fec5f40d62dea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/0*vaxlEaO4eSYcip5t"/></div></figure><p id="95c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不同的环境需要不同级别的错误报告。默认情况下，开发模式会显示错误，测试和实时模式会隐藏错误。CodeIgniter提供了如下所示的三个函数来处理错误。</p><p id="5e53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> show_error() </strong></p><p id="f77b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个函数通常用于HTML格式。</p><ul class=""><li id="9a73" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn ll ju jv jw bi translated"><strong class="is hj">$消息</strong> ( <em class="lm">混合</em>)—错误消息</li><li id="8af6" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn ll ju jv jw bi translated"><strong class="is hj">$ status _ code</strong>(<em class="lm">int</em>)—HTTP响应状态代码</li><li id="8fc3" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn ll ju jv jw bi translated"><strong class="is hj">$ heading</strong>(<em class="lm">string</em>)—错误页面标题</li></ul><p id="13db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> show_404() </strong></p><p id="db31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当访问的页面不存在时使用该函数。</p><ul class=""><li id="1e86" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn ll ju jv jw bi translated"><strong class="is hj"> $page </strong> ( <em class="lm">字符串</em> ) — URI字符串</li><li id="b9ae" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn ll ju jv jw bi translated"><strong class="is hj">$ log _ error</strong>(<em class="lm">bool</em>)—是否记录错误</li></ul><p id="c823" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> log_message() </strong></p><p id="c910" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该函数对于以日志消息的形式发送消息非常有用。</p><ul class=""><li id="7029" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn ll ju jv jw bi translated"><strong class="is hj"> $level </strong> ( <em class="lm">字符串</em>)—日志级别:“错误”、“调试”或“信息”</li><li id="0415" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn ll ju jv jw bi translated"><strong class="is hj">$消息</strong> ( <em class="lm">字符串</em>)—记录消息</li><li id="f4dd" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn ll ju jv jw bi translated"><strong class="is hj">$ php _ error</strong>(<em class="lm">bool</em>)—我们是否正在记录一个本地PHP错误消息</li></ul><p id="b78e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以在<strong class="is hj">app/Config/exceptions . PHP</strong>文件中启用日志记录。</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="5630" class="ls ke hi lo b fi lt lu l lv lw">&lt;?php</span><span id="a652" class="ls ke hi lo b fi lx lu l lv lw">namespace Config;</span><span id="d33d" class="ls ke hi lo b fi lx lu l lv lw">use CodeIgniter\Config\BaseConfig;</span><span id="38e4" class="ls ke hi lo b fi lx lu l lv lw">/**<br/> * Setup how the exception handler works.<br/> */<br/>class Exceptions extends BaseConfig<br/>{<br/>    /**<br/>     * --------------------------------------------------------------------------<br/>     * LOG EXCEPTIONS?<br/>     * --------------------------------------------------------------------------<br/>     * If true, then exceptions will be logged<br/>     * through Services::Log.<br/>     *<br/>     * Default: true<br/>     *<br/>     * @var bool<br/>     */<br/>    public $log = true;</span><span id="3f6b" class="ls ke hi lo b fi lx lu l lv lw">    /**<br/>     * --------------------------------------------------------------------------<br/>     * DO NOT LOG STATUS CODES<br/>     * --------------------------------------------------------------------------<br/>     * Any status codes here will NOT be logged if logging is turned on.<br/>     * By default, only 404 (Page Not Found) exceptions are ignored.<br/>     *<br/>     * @var array<br/>     */<br/>    public $ignoreCodes = [404];</span><span id="630a" class="ls ke hi lo b fi lx lu l lv lw">    /**<br/>     * --------------------------------------------------------------------------<br/>     * Error Views Path<br/>     * --------------------------------------------------------------------------<br/>     * This is the path to the directory that contains the 'cli' and 'html'<br/>     * directories that hold the views used to generate errors.<br/>     *<br/>     * Default: APPPATH.'Views/errors'<br/>     *<br/>     * @var string<br/>     */<br/>    public $errorViewPath = APPPATH . 'Views/errors';</span><span id="75f9" class="ls ke hi lo b fi lx lu l lv lw">    /**<br/>     * --------------------------------------------------------------------------<br/>     * HIDE FROM DEBUG TRACE<br/>     * --------------------------------------------------------------------------<br/>     * Any data that you would like to hide from the debug trace.<br/>     * In order to specify 2 levels, use "/" to separate.<br/>     * ex. ['server', 'setup/password', 'secret_token']<br/>     *<br/>     * @var array<br/>     */<br/>    public $sensitiveDataInTrace = [];<br/>}</span></pre><p id="6e65" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在application/log/中找到日志消息。在启用日志文件之前，请确保此目录是可写的。</p><p id="672e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以在application/views/errors/cli或application/views/errors/html中找到各种错误消息模板。</p><h1 id="1aa1" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">使用异常</h1><p id="f2d6" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">异常用于在创建的代码出错时为应用程序开发人员提供选项。</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="6bda" class="ls ke hi lo b fi lt lu l lv lw">&lt;?php</span><span id="ff2b" class="ls ke hi lo b fi lx lu l lv lw">throw new \Exception('Some message goes here');</span></pre><p id="1f92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以对异常使用<strong class="is hj"> try/catch </strong>:</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="1e40" class="ls ke hi lo b fi lt lu l lv lw">&lt;?php</span><span id="a5f0" class="ls ke hi lo b fi lx lu l lv lw">try {<br/>    $user = $userModel-&gt;find($id);<br/>} catch (\Exception $e) {<br/>    exit($e-&gt;getMessage());<br/>}</span></pre><p id="75fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我给你举个例子:</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="d66c" class="ls ke hi lo b fi lt lu l lv lw">&lt;?php namespace App\Controllers;<br/>use App\Models\PostModel;<br/>use App\Models\PostCategoryModel;<br/>class Post extends BaseController<br/>{<br/>	public function create()<br/>	{<br/>		$post = new PostModel();<br/>		$post-&gt;db-&gt;transBegin();<br/>		try {<br/>			$post-&gt;insert([<br/>				'title'=&gt;$this-&gt;request-&gt;getPost('title'),<br/>				'content'=&gt;$this-&gt;request-&gt;getPost('content')<br/>			]);</span><span id="ab80" class="ls ke hi lo b fi lx lu l lv lw">			$post_id = $post-&gt;insertID();</span><span id="2c02" class="ls ke hi lo b fi lx lu l lv lw">			$postLog = $this-&gt;TransLog($this-&gt;request-&gt;getPost());<br/>			if($postLog===false){<br/>				throw new Exception();<br/>			}<br/>			$postCategory = new PostCategoryModel();<br/>			$postCategory-&gt;insert([<br/>				'post_id'=&gt;$post_id,<br/>				'category_id'=&gt;$this-&gt;request-&gt;getPost('category_id')<br/>			]);</span><span id="7c38" class="ls ke hi lo b fi lx lu l lv lw">			$post-&gt;db-&gt;transCommit();<br/>		} catch (\Exception $e) {<br/>			$post-&gt;db-&gt;transRollback();<br/>		}<br/>	}<br/>}</span></pre><p id="7a0e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码使用了一个try catch，这样当<strong class="is hj"> $postLog </strong>返回false时。转到<strong class="is hj">捕捉</strong>和<strong class="is hj">回滚。</strong></p><h1 id="5be7" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">使用PageNotFoundException</h1><p id="5109" class="pw-post-body-paragraph iq ir hi is b it lb iv iw ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn hb bi translated">这用于404错误，找不到页面。抛出时，系统返回在app/Views/errors/html/error _ 404 . PHP中找到的视图。您必须为您的站点自定义所有错误显示。如果在app/Config/Routes.php中指定了404覆盖，将调用该覆盖而不是标准的404页面:</p><pre class="lh li lj lk fd ln lo lp lq aw lr bi"><span id="5dbb" class="ls ke hi lo b fi lt lu l lv lw">&lt;?php</span><span id="a629" class="ls ke hi lo b fi lx lu l lv lw">if (! $page = $pageModel-&gt;find($id)) {<br/>    throw \CodeIgniter\Exceptions\PageNotFoundException::forPageNotFound();<br/>}</span></pre><p id="cd88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以将消息传递给异常，该异常将在404页上显示，而不是默认消息。</p><p id="099a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是使用Codeigniter 4的应用程序开发人员经常使用的错误处理Codeigniter 4。</p><p id="73b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是我这次能给出的教程，希望有用。</p><p id="6c3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">谢了。</p><p id="e845" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">来源:<a class="ae kc" href="https://www.codeigniter.com/user_guide/general/errors.html" rel="noopener ugc nofollow" target="_blank">https://www.codeigniter.com/user_guide/general/errors.html</a></p></div></div>    
</body>
</html>
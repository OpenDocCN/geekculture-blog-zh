<html>
<head>
<title>Data Cleaning in MS Excel and SQL Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MS Excel和SQL Server中的数据清理</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/data-cleaning-in-ms-excel-and-sql-a1a3bd652c34?source=collection_archive---------34-----------------------#2021-05-25">https://medium.com/geekculture/data-cleaning-in-ms-excel-and-sql-a1a3bd652c34?source=collection_archive---------34-----------------------#2021-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3fae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MS Excel与SQL在数据清理中的比较</p><h1 id="39e2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">目标</h1><p id="1381" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">本文的主要目的是介绍几种使用MS Excel和SQL获得干净数据的方法</p><h1 id="5f53" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">介绍</h1><p id="0dec" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">数据清理是确保数据正确、一致和可用的过程。数据清理非常重要，因为它提高了数据质量，从而提高了整体生产率。干净的数据有助于做出准确的决策，提高业绩和收入，节省资金和时间，并最大限度地降低合规风险。本文介绍了几种使用MS Excel和SQL清理数据的方法。</p><h1 id="f4db" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">空</h1><p id="2025" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:用0替换空值</p><p id="24d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">EXCEL:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/236ae05368dca5bda39453b280f10233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3fO9fhw3-uFZtfO1H6gBA.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx">Image By Author</figcaption></figure><p id="bb9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SQL <code class="du kw kx ky kz b"><br/>SELECT ISNULL(column_name, 0 ) FROM table1<br/>OR<br/>SELECT COALESCE(column_name, 0 ) FROM table1</code></p><h1 id="10ad" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">拼写</h1><p id="f0c8" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:将Y替换为“是”，将N替换为“否”，并纠正其他拼写错误</p><p id="b14d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Excel中，这可以通过使用查找和替换方法以同样的方式实现。在“必需”列中找到Y并用“是”替换“全部”</p><pre class="kh ki kj kk fd la kz lb lc aw ld bi"><span id="546f" class="le je hi kz b fi lf lg l lh li">SQL : <br/>SELECT CASE WHEN IsAvailable='Y' THEN 'Yes'<br/>            WHEN IsAvailble='N' THEN 'No'<br/>            ELSE IsAvailable END<br/>FROM IceCream</span></pre><h1 id="4fd4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">充满</h1><p id="c27c" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:从电子邮件中找出名字和姓氏</p><p id="6ab2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在Excel中从电子邮件ID中提取名字和姓氏，我们使用了自动填充的快捷方式<strong class="ih hj"> Ctrl+E </strong>。选择每一列并按ctrl +E自动填充名字和姓氏。这也可以通过使用“填充”的主页选项卡中的<strong class="ih hj"> FlashFill </strong>选项来实现，这有助于快速填充这些字段。Excel能够智能地理解分隔符，这有助于轻松提取名字和姓氏。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lj"><img src="../Images/38c542d1088bc63ad6f42678c7267028.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*xlEhn1UrWG8rF_Lqonuptw.png"/></div></figure><div class="kh ki kj kk fd ab cb"><figure class="lk kl ll lm ln lo lp paragraph-image"><img src="../Images/46d3333bf7620ce238c2a5ae262434b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*rzZNQURpntf_Aw7J1L0B3A.png"/></figure><figure class="lk kl lq lm ln lo lp paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/5392830ada6ba3cf8bb183380e8db77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*G5fOBH79p7bltvjc9YccOg.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx lr di ls lt">Image By Author</figcaption></figure></div><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lu"><img src="../Images/cf756d10f02f63a7f0af49081c8e4973.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*Bh9s5OMJ3UZtOpiSw5r4aw.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx">First Name and Last Name from Email. Image By Author</figcaption></figure><p id="f5c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一种方法是选择要拆分的单元格。选择数据<strong class="ih hj">-&gt;-</strong>文本到列- &gt;选择分隔符并应用。</p><h1 id="48d2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">排序和过滤</h1><p id="f2f9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:根据名字对表格进行升序排序</p><div class="kh ki kj kk fd ab cb"><figure class="lk kl lv lm ln lo lp paragraph-image"><img src="../Images/efc83907ae2040730aec6fb9cf383def.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*3cUKuG2hJvotUivHVsON2g.png"/></figure><figure class="lk kl lw lm ln lo lp paragraph-image"><img src="../Images/67eca0804d2e1bff53c314e739193f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*qVS3LQHwA7xLNj0cFP3cuA.png"/><figcaption class="ks kt et er es ku kv bd b be z dx lx di ly lt">Sort First Name in Ascending order.</figcaption></figure></div><p id="2368" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要筛选薪资高于所有员工平均值的员工，右键单击薪资筛选器并选择数字筛选器。您可以看到许多选项，并选择所需的选项。我们还可以根据用户要求添加自定义过滤器。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lz"><img src="../Images/c984b45cc264dd361474631d9631aa71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ni06B6-vtxNj5oRiEQGSEA.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx">Image By Author</figcaption></figure><pre class="kh ki kj kk fd la kz lb lc aw ld bi"><span id="4c81" class="le je hi kz b fi lf lg l lh li">SQL:<br/>#ORDER BY clause is used for sorting in ascending or descending order</span><span id="b53c" class="le je hi kz b fi ma lg l lh li">SELECT * FROM TABLE<br/>ORDER BY First Name ASC;</span></pre><h1 id="c2d5" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">格式</h1><p id="0814" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:</p><ul class=""><li id="4b15" class="mb mc hi ih b ii ij im in iq md iu me iy mf jc mg mh mi mj bi translated">删除^ product _ name ^中的尾随空格和前导空格</li><li id="f751" class="mb mc hi ih b ii mk im ml iq mm iu mn iy mo jc mg mh mi mj bi translated">小写产品名称</li><li id="8899" class="mb mc hi ih b ii mk im ml iq mm iu mn iy mo jc mg mh mi mj bi translated">将销售日期更改为“年-月”格式</li></ul><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mp"><img src="../Images/3cc04abb72725a4197cf7f0f1a815158.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*r6pEk3GpjuF5hL1GJwUjXQ.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><a class="ae mq" href="https://leetcode.com/problemset/database/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><pre class="kh ki kj kk fd la kz lb lc aw ld bi"><span id="03e0" class="le je hi kz b fi lf lg l lh li">Excel:<br/>Lowercase formula: =lower(cellrange)<br/>Trim formula: = Trim(cellrange)<br/>Date and Month =LEFT(number of characters) or format the cells </span><span id="f3aa" class="le je hi kz b fi ma lg l lh li">SQL:<br/>SELECT lower(TRIM(product_name))product_name<br/>       ,LEFT(sale_date,7) sale_date<br/>FROM Sales<br/>GROUP BY product_name,sale_date</span></pre><h1 id="08b2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">复制</h1><p id="5a24" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:找到重复的电子邮件并从表格中删除</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mr"><img src="../Images/dd411f5871b51a375083c924984cf88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*vfLcX1ADYLrvnsFKtCIfcg.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx"><a class="ae mq" href="https://leetcode.com/problemset/database/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><pre class="kh ki kj kk fd la kz lb lc aw ld bi"><span id="07a0" class="le je hi kz b fi lf lg l lh li">EXCEL:<br/>Select the full data, go to Data and click on Remove duplicates.<br/>To visualize the duplicate values, we can use conditional formatting and highlight the duplicate cells or row</span><span id="44b3" class="le je hi kz b fi ma lg l lh li">SQL:<br/>#List of Duplicate Emails<br/>SELECT email<br/>       ,count(*) cnt_email<br/>FROM PERSON<br/>GROUP BY email<br/>HAVING cnt_email &gt; 1</span><span id="dd3b" class="le je hi kz b fi ma lg l lh li">#To Delete Duplicate Emails<br/>Delete FROM TABLE<br/>WHERE Id NOT IN<br/>       (select min(Id)<br/>        from Person<br/>        group by Email)</span></pre><h1 id="6739" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">移项</h1><p id="7cc3" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">目标:将行改为列</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ms"><img src="../Images/7ebdbf66a75c840ebe029463b37e90e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*5AgsKg-r-b0-nesxkcFSBw.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx">Ice-cream table</figcaption></figure><p id="c6f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您需要将行转换为列，或者将列转换为行，请选择您需要转置的单元格，然后复制它。右键单击并单击选择性粘贴，然后选择转置。使用转置函数进行转置的另一种方法是使用格式{=TRANSPOSE(Range)}</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="ab fe cl mt"><img src="../Images/2abc6a776ac59129fc56984f21a57b47.png" data-original-src="https://miro.medium.com/v2/format:webp/1*iBXv1hgTzfPj05QGGoT3BQ.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx">Transpose Ice-cream Table : Image By Author</figcaption></figure><h1 id="3610" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">总结</strong></h1><p id="db1b" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们已经看到了如何通过删除重复项、拼写错误、格式化、替换空值、排序和填充MS Excel和SQL来清理原始数据。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How I built an E-commerce API with NodeJs, Express and MongoDB(Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用NodeJs、Express和MongoDB构建电子商务API(第1部分)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-i-built-an-e-commerce-api-with-nodejs-express-and-mongodb-7b42b5253ffb?source=collection_archive---------0-----------------------#2021-12-13">https://medium.com/geekculture/how-i-built-an-e-commerce-api-with-nodejs-express-and-mongodb-7b42b5253ffb?source=collection_archive---------0-----------------------#2021-12-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3ccf40509849290ebc6614eeb62ff827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMMtO2szrWyPTQBZP4ns8w.jpeg"/></div></div></figure><h1 id="962f" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">简介</strong></h1><p id="5e1e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">最近，我很幸运地被埃努古Genesys技术中心接受为实习生，作为我们软件工程开发的一部分，我们应该有一个充满激情的项目，除了在团队中工作时构建产品之外，我们还可以单独工作。</p><p id="f6c5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我选择构建一个电子商务API，这就是我的做法。如果你按照本教程中的步骤操作，你也可以做到。</p><p id="f4c8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">基本上这是一个简单的API。它不具备现代电子商务web应用程序的所有花哨功能，但它确实具备开始工作的所有基本功能。你当然可以添加更多的特性来使它变得更好。</p><h1 id="a1c5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><ul class=""><li id="6ae0" class="kr ks hi jq b jr js jv jw jz kt kd ku kh kv kl kw kx ky kz bi translated">对javascript的基本理解</li><li id="2b22" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">Nodejs、MongoDB、Mongoose和Express的基础知识</li></ul><p id="0e91" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这个API的基本特性是:</p><ul class=""><li id="f951" class="kr ks hi jq b jr km jv kn jz lf kd lg kh lh kl kw kx ky kz bi translated">注册、登录和注销用户</li><li id="1bef" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">使用JSON Web令牌进行身份验证(JWT)。</li><li id="4f00" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">添加、编辑、查看和删除商店中所有产品的选项。</li><li id="e6e7" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">从购物车中添加或删除商品的选项。</li><li id="4991" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">为每个用户创建购物车，从购物车中添加和删除项目，并计算账单。</li></ul><p id="1939" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我将使用Express on NodeJs作为服务器，使用MongoDB将数据存储为JSON格式的文档，使用Mongoose进行建模。</p><p id="3d98" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">创建一个新文件夹，我将其命名为mine <em class="li"> e-commerce-api </em>，启动VSCode或您喜欢的代码编辑器，打开终端并在终端中键入命令以启动一个新的节点项目</p><p id="7a71" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">npm init</code></p><p id="f5d3" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">您将被引导通过一系列步骤来为您的项目创建package.json文件，或者您可以只使用<code class="du lj lk ll lm b">-y</code>标志来跳过定制并使用默认值，因此该命令变成</p><p id="5638" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">npm init -y</code></p><p id="ca73" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，我们安装依赖项。</p><p id="c38c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">顾名思义，依赖是我们的项目作为一个整体运作所依赖的模块。我们将安装相当多的程序，但是在我们安装之前，我会先对每个程序做一个测试。</p><ul class=""><li id="d254" class="kr ks hi jq b jr km jv kn jz lf kd lg kh lh kl kw kx ky kz bi translated"><strong class="jq hj"> bcryptjs </strong> —我们将在应用程序中对用户进行身份验证。他们需要密码才能登录，我们会将该密码存储在我们的数据库中。将密码存储为纯文本是不可取的，因为这会使我们的应用程序易受攻击，所以bcrypt就派上了用场。Bcrypt为我们提供了一个密码散列函数，我们可以在将这些密码保存到数据库之前使用它。</li><li id="ead8" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> Express </strong> —用于构建web应用程序和API的节点框架</li><li id="3354" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> jsonwebtoken </strong> —生成验证令牌来验证用户</li><li id="fdbd" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj">mongose</strong>—mongose是MongoDB和Node.js的对象数据建模(ODM)库，它管理数据之间的关系，提供模式验证，并用于在代码中的对象和MongoDB中这些对象的表示之间进行转换。</li><li id="334d" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj">验证器</strong> —一个字符串验证器库。我们将用它来验证用户的电子邮件。</li><li id="76c3" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> env-cmd </strong> —我们将使用它从外部文件加载环境变量。</li><li id="8de1" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> nodemon </strong> —它通过在我们的文件中检测到更改时重启服务器来保持我们的服务器运行。</li></ul><p id="e999" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我添加了一些脚本来使开发更容易，它们是</p><ul class=""><li id="4864" class="kr ks hi jq b jr km jv kn jz lf kd lg kh lh kl kw kx ky kz bi translated">dev —它通过调用env-cmd加载环境变量来启动开发服务器，然后调用nodemon来启动服务器。稍后我会解释这是怎么回事。所以请暂时容忍我。</li><li id="9a71" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">启动—这将在生产服务器上启动。这是heroku在尝试启动我们的应用程序时将运行的命令。<br/> <code class="du lj lk ll lm b">"start":”node src/app.js”</code></li></ul><p id="ecfe" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是我的<em class="li"> package.json </em>事后的样子。</p><figure class="ln lo lp lq fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="4793" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我建议您安装相同版本的dependences，以避免一路上遇到问题。</p><p id="71d1" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在，让我们开始建造。</p><ol class=""><li id="5fea" class="kr ks hi jq b jr km jv kn jz lf kd lg kh lh kl lt kx ky kz bi translated"><strong class="jq hj">设置环境变量和猫鼬</strong></li></ol><p id="4ba0" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在你的根目录下创建一个名为<em class="li"> config </em>的文件夹，在这个文件夹下用<em class="li">创建一个名为dev的新文件。env </em>作为其扩展。这个文件将保存我们的环境变量。</p><p id="66ca" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">复制并保存在文件中</p><p id="73d5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">JWT_SECRET=ecommercewebapi<br/>PORT=3000<br/>MONGODB_URL=mongodb://127.0.0.1:27017</code></p><p id="08e8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这将我带回我们的开发脚本<br/> <code class="du lj lk ll lm b">"dev":"env-cmd -f ./config/dev.env nodemon src/app.js"</code></p><p id="f3d2" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">-f</code>标志用于指定我们的env文件保存在机器上的什么位置，在调用nodemon之后，我们指定服务器文件的路径。</p><p id="773c" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，我们用mongoose建立到数据库的连接。</p><p id="e386" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在你的根目录下创建一个名为<em class="li"> db </em>的文件夹，在这个文件夹下创建一个名为<em class="li">mongose的新文件，扩展名为js。</em></p><p id="9d25" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">将这段代码复制并粘贴到这个文件中</p><p id="0640" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">const mongoose = require(‘mongoose’);<br/>mongoose.connect(process.env.MONGODB_URL, {<br/>useNewUrlParser: true,<br/>})</code></p><p id="e687" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在这里，我们加载mongoose并连接env文件中指定的MONGODB URL。</p><p id="354d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">保存文件，让我们继续创建我们的app.js文件。</p><p id="7a89" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">2.<strong class="jq hj">创建服务器</strong></p><p id="6825" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在根目录下创建一个新文件。</p><p id="3af8" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们把那个<em class="li">命名为app.js </em></p><p id="0708" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">首先，我们导入所有依赖项</p><p id="a32b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">const express = require(‘express’)<br/>require(‘./db/mongoose’)</code></p><p id="c218" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">然后，我们将调用我们的快速应用程序，并设置它的使用</p><p id="1645" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">const app = express()<br/>app.use(express.json())</code></p><p id="ca3e" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">接下来，我们指定希望服务器监听的端口。请记住，我们已经在env文件中定义了这一点。所以，</p><p id="daf4" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated"><code class="du lj lk ll lm b">const port = process.env.PORT</code></p><p id="c39d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">现在是时候倾听连接了<br/>T1</p><p id="fb35" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">启动mongoDB，并使用<em class="li"> npm run dev启动服务器。</em></p><p id="0644" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">如果一切顺利，您应该会在您的控制台上看到这个</p><figure class="ln lo lp lq fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/5657ffd197087cb386838cca89d448f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*R-Qf22xd4gchdEcDud3wVw.png"/></div></figure><p id="cc30" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">这是我们完成时app.js文件的样子。</p><figure class="ln lo lp lq fd ij"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="35ae" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">本教程系列的第一部分到此结束。</p><p id="23b2" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">在接下来的部分中，我们将处理我们的模型、路线和认证。</p><p id="6c4b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">点击这个链接进入下一篇文章，在那里我们建立模型</p><div class="lv lw ez fb lx ly"><a rel="noopener follow" target="_blank" href="/geekculture/how-i-built-an-e-commerce-api-with-nodejs-express-and-mongodb-part-2-c729b1e74336"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">我如何用NodeJs、Express和MongoDB构建电子商务API(第2部分)</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">第2部分:构建模型</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">medium.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm io ly"/></div></div></a></div></div></div>    
</body>
</html>
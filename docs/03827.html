<html>
<head>
<title>The Night I Pulled an All-Nighter for Bill Gates</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我为比尔·盖茨熬通宵的那个晚上</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/2001-the-night-i-did-an-all-nighter-for-bill-gates-feace4fb117c?source=collection_archive---------1-----------------------#2021-06-16">https://medium.com/geekculture/2001-the-night-i-did-an-all-nighter-for-bill-gates-feace4fb117c?source=collection_archive---------1-----------------------#2021-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="9bf3" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">向世界首富寻求完美演示</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1db05da636220770506695ed2141b6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0GHGc_DA9Vr4_jgC.jpg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Bill Gates circa 2001. He didn’t always smile during internal demos!</figcaption></figure><p id="c457" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">大约是凌晨5点，离比尔格会议还有5个小时。我的眼睛又红又肿，我有点神志不清。我已经起床快24小时了。但是我刚刚重新编译了代码，现在它似乎可以工作了。我可以在桌子底下睡上两三个小时，这样我就有足够的时间在那天早上与比尔·盖茨可怕的会面之前把演示交给我们的项目经理，那次会面将决定这个项目是否继续。</p><p id="34fe" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">早在2001年，我在微软的自然语言小组(NLG)工作。除此之外，我们拥有微软Office中所有的拼写和语法检查工具。我的团队正在开发一个叫做<strong class="jp hj">上下文拼写检查器</strong>的东西。这应该是Microsoft Word中既不是拼写错误(红色曲线)也不是语法错误(绿色曲线)的曲线。想想单词拼写正确，但只是错误的情况。例如，如果你用“鹿卡洛斯”这个词开始一封电子邮件，你的意思可能是“亲爱的”，而不是“鹿”但是拼写检查器不会发现这一点(deer是一个合适的词)，语法检查器也不会发现这一点(它在语法上是正确的)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kj"><img src="../Images/716a8d5a679a3ff0e5cbe574bfbc112c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/0*rSpKVOZVOwos9BpX.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Nice example from <a class="ae kk" href="https://edu.gcfglobal.org/en/word2010/checking-spelling-and-grammar/1/" rel="noopener ugc nofollow" target="_blank">https://edu.gcfglobal.org/en/word2010/checking-spelling-and-grammar/1</a></figcaption></figure><p id="d17c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们有一个重要的比尔·盖茨会议来演示概念验证，这是进一步资助该功能的去/不去会议，所以这是一件大事。在比尔面前展示总是一种恐怖的经历，但在这种情况下更是如此。我们拥有一个在Microsoft Word的可执行空间中运行的DLL，但是由于我们还没有将上下文拼写器集成到Word中，我们的演示本质上是一个穷人的演示，通过Word外部的命令行工具。只是MSDOS中调用我们的DLL的命令行工具。你在控制台中输入一个句子，按下回车键，然后它会在控制台中显示是否有上下文拼写错误。我觉得它缺乏在微软Word中看到标签的视觉冲击力。</p><p id="6f63" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><em class="kl">以后想看这个故事吗？</em> <a class="ae kk" href="https://usejournal.com/?utm_source=medium.com&amp;utm_medium=noteworthy_blog&amp;utm_campaign=tech&amp;utm_content=guest_post_read_later_text" rel="noopener ugc nofollow" target="_blank"> <em class="kl">保存在日记本上。</em> </a></p><p id="5be8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">作为一名工程师，我被平淡的经历所困扰。如果我真的能让它在Microsoft Word的调试版本中正常工作会怎么样？我想知道。我将Office的大量源代码下载到我的桌面上，构建它，用我的具有上下文拼写功能的DLL调试版本替换它的正式版本，并开始在调试器中设置断点。我花了很长时间挖掘代码，了解它是如何调用我们的DLL的。我想它已经有了显示红色和绿色曲线的代码，所以我所要做的就是以某种方式复制它，以获得不同类型的曲线，显示上下文拼写器。当时，Word向我们的DLL发送了一个指针，指向一个复杂的数据结构，不仅有文本，还有格式，还有一个巨大的撤消缓冲区，这样Control-Z就可以按预期工作。上下文拼写器必须解析和导航这个数据结构，以提取文本。问题是有太多的边缘案例。我在任何地方都找不到这些文档，所以我不得不逆向工程不同场景下的数据结构。当你只是键入文本时，它看起来像什么？当你把一个单词加粗，另一个单词斜体，是什么样子？当你改变字体大小时是什么样子的？当你突出显示一个单词，删除它并用另一个单词替换它时，它是什么样子的？等等等等。我花了几个小时来理解它是如何工作的，并为我们的上下文拼写器绘制了蓝色的曲线！那是非常令人兴奋的…直到它在两分钟后坠毁。我一整天都在调试它，一直到傍晚。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es km"><img src="../Images/8c7d8f18aa6aa1d717853c3eabbe48fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*g19-CGUvLHsAC1Ecyye9kw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Some SWAG I kept from that time</figcaption></figure><p id="8d92" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我的朋友Takeshi在下午5点左右回家的路上，他来到我的办公室打招呼，我展示了新的演示。他曾经是微软Word组织的软件开发人员，所以他对代码库非常熟悉，他决定坐在我旁边，帮我调试if语句处理所有边缘情况的噩梦。我见过的最丑陋的C++代码。我们不停地走了三个小时，笑着，咒骂着，抓着脑袋，满不在乎。每小时一次，武的妻子会打电话强烈建议他需要回家，他会道歉，并承诺“很快，很快。”</p><p id="c625" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我的朋友戈登是NLG的另一名软件工程师，他在晚上8点左右来访。我们都是夜猫子，经常工作到凌晨。在90年代，半夜看到微软在雷德蒙德的走廊里挤满了人是很平常的事。他也被我们努力实现的精神所吸引。因此，我们三个人坐在我的电脑屏幕前，尝试各种东西，每当Word崩溃时就大声咒骂，每当它崩溃时就歇斯底里地大笑。</p><p id="2669" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们继续前进。这不是我们的工作，但我们被一种强烈的热情所驱使，以最有影响力、最美丽的方式向世界首富(以及我们老板的老板的老板的老板……)展示我们的小特色。命令行演示是不行的！它需要在Word中展示，而且需要很漂亮。它需要在第二天上午10点前工作。所以我们继续前进。</p><p id="64ba" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">午夜，我们煮了一壶新鲜的咖啡，四处寻找麦片和任何我们能找到的食物，因为我们在晚餐时一直在编码。Takeshi的妻子已经放弃了他——她在晚上10点左右不再打电话，可能已经睡觉了。戈登和我是单身，没有孩子，在这个世界上没有义务，所以我们不介意长时间工作。我们的眼睛布满血丝，我们又累又糊涂，我们差一点就要成功了！</p><p id="381f" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">凌晨两点，Takeshi终于放弃了。他的大脑不再工作了。他连连道歉，然后回到自己的办公室，趴在桌子底下昏过去了。</p><p id="a3c6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">凌晨5点，我和戈登让它开始工作了！我给负责演示的项目经理发了电子邮件，告诉他我的想法。我编译了代码，把二进制文件放在软盘上(是的…软盘！！！)，把它放在他的桌子上，把我的闹钟设在上午9:30，然后在我的桌子底下昏睡了几个小时。</p><p id="28e8" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">那天早上我醒来，意识到我们的项目经理没有看到我的邮件！软盘还在他的桌子上。演示在比尔·盖茨的办公室所在的9号楼，所以我手里拿着软盘跑过了微软园区的一半。当我跑向会议室的时候，我确信我看起来很凌乱，出汗，气喘吁吁，很可能缺乏基本的卫生。“用这些二进制！！!"就在比尔要进门的前几分钟，我喊着把软盘递了过来。我们的总理怀疑地看着我，但决定大胆一试。我从未见过在复制二进制文件时进度条移动得如此之慢！他双击了Word，在Word的闪屏出现之前，他的硬盘一直在突突作响。然后，出现一个新的空文档，光标闪烁。我们都屏住了呼吸。杰瑞打了几个句子，我们等待着，感觉像是过了很长时间。然后，最漂亮的东西出现了:蓝色的小曲线！！！房间里的人都发出了一声叹息。</p><p id="f8cb" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">比尔喜欢这个演示，这个项目得到了资助。这是Microsoft Word中的一项最新功能。我认为那次通宵和那件事有关！</p><p id="73b6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">事实上，我从我的老同事那里得到了这个小小的历史金块。我们实际上向他展示了上下文拼写者是如何在他发给所有全职员工(10万名全职员工)的一封电子邮件中发现一个错别字的。你可以想象在点击发送之前有多少人已经校对过了。我相信那是会议期间他唯一一次笑了。”</p><p id="c69c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这个例子有很多我喜欢的地方。它让你一瞥我们在团队中培养的激情和友情。事实上，两名工程师几乎整晚都坐在我的身后，在Visual Studio中设置断点，调试世界上最丑陋的代码，只是因为我们不愿意满足于平庸:我们希望有一个“漂亮”的演示，而不仅仅是一个“ok”的演示。它甚至不是生产代码。伟大的工程在于工艺，而工艺始于微小的细节。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><p id="b0f2" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">创造你自己的东西？加入<a class="ae kk" href="https://links.usejournal.com/slack-community" rel="noopener ugc nofollow" target="_blank"> Journal slack社区</a>寻求像你一样的创作者的支持。</p></div></div>    
</body>
</html>
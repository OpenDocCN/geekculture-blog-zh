<html>
<head>
<title>Same-same but different: Detecting product similarities by their e-commerce titles and images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">相同-相同但不同:通过电子商务标题和图片检测产品相似性</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/same-same-but-different-detecting-product-similarities-by-their-e-commerce-titles-and-images-5ea10021f522?source=collection_archive---------13-----------------------#2021-06-16">https://medium.com/geekculture/same-same-but-different-detecting-product-similarities-by-their-e-commerce-titles-and-images-5ea10021f522?source=collection_archive---------13-----------------------#2021-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><p id="a0f0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">作者:</strong> <a class="ae jk" href="https://www.linkedin.com/in/itamar-zaltsman/" rel="noopener ugc nofollow" target="_blank">伊塔马尔·扎尔茨曼</a>，<a class="ae jk" href="https://www.linkedin.com/in/karishma-shah-7b1b1786/" rel="noopener ugc nofollow" target="_blank">卡里什马·沙阿</a>，<a class="ae jk" href="https://www.linkedin.com/in/roy-yanovski/" rel="noopener ugc nofollow" target="_blank">罗伊·亚诺夫斯基</a></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/bfd231b1dce8e05a2f3c00f48558f6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxL6YBt97ZToEg1WPaqUwA@2x.jpeg"/></div></div></figure><p id="17ce" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这项工作是作为数据科学课程的期末项目完成的。我们选择了一个卡格尔竞赛(<a class="ae jk" href="https://www.kaggle.com/c/shopee-product-matching/" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/shopee-product-matching/</a>)作为我们这个项目的挑战。下面的文章描述了数据集、我们的工作流程和我们遇到的挑战，还包括我们的最佳解决方案和我们实现它的方式。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h1 id="c40b" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">介绍</h1><p id="dd0d" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">电子商务是一个不断增长的行业，已经成为许多人消费习惯中值得注意的一部分。网上购物的优点是购物快捷方便，还能接触到各种各样的卖家和产品。但这种丰富也可能是一个缺点，因为很难做出决定并在众多选项中导航。许多网站试图提供过滤和比较工具来改善这种体验，但许多人仍然会感到失落，并可能由于数据过载造成的混乱而最终不购买。<br/>产品匹配可用于比较产品，并查找某些产品。消费者可能希望比较产品，看看他们是否找到了一个好的交易，未来的应用程序可能会在网上搜索在商店/街上发现后拍摄的产品。</p><p id="0030" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们的数据集有以下特征:<br/> -一个唯一的ID(‘posting _ ID’)。<br/> -产品的图像(“图像”)。<br/> -基于图像的相位*(‘image _ Phash’)。<br/> -产品的标题(“标题”)。<br/>归属于某些产品的类别(“标签组”)。<br/> * Phash(感知哈希)是一种算法，可生成代表特定图像的短字符序列。它可以被称为图像的一种“指纹”。更多关于图像哈希的内容可以在这里找到:<a class="ae jk" href="https://people.cs.umass.edu/~liberato/courses/2020-spring-compsci590k/lectures/09-perceptual-hashing/" rel="noopener ugc nofollow" target="_blank">https://people . cs . umass . edu/~ libera to/courses/2020-spring-compsci 590k/lectures/09-perceptual-hashing/</a><br/>数据集包含<strong class="io hj">34250个</strong>样本，属于<strong class="io hj">11014个</strong>独特产品。班级人数范围在<strong class="io hj">2–51</strong>之间，平均班级人数为<strong class="io hj"> 3 </strong>。</p><p id="4cee" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们的目标:<br/>根据给定的某个产品的图片和标题来检测相似的产品。<br/>*在phash功能没有取得巨大成功后，我们决定将重点放在图片和标题上，作为我们产品的特色。</p><h1 id="28c5" class="jx jy hi bd jz ka la kc kd ke lb kg kh ki lc kk kl km ld ko kp kq le ks kt ku bi translated">探测</h1><p id="9b3d" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">数据集包含<strong class="io hj">32412</strong>个唯一图像、<strong class="io hj">28735</strong>个唯一相位和<strong class="io hj">33117</strong>个唯一标题。这意味着我们在每个特性上都有一些副本(尽管在所有特性上都没有完全的副本)。</p><p id="d139" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">图片</strong></p><p id="0b9b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看随机产品(一组带有相同标签的样品)是什么样子的:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/8c9f4b59e9c7cfdceedf01b10689a6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JEu9RBWdWnCB9_X8etZzuQ.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Seven sample images that belong to the same class.</figcaption></figure><p id="7c32" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如我们在上面看到的，我们面临的一个挑战是，来自同一类别的产品有着非常不同的形象。<br/>接下来，我们想看看图像的形状。我们发现有<strong class="io hj"> 824 </strong>种不同的形状，都是RGB (3通道)图像，但有许多不同的长度和宽度。最常见的形状是640 X 640 ( <strong class="io hj"> 12，259 </strong>个样本)，83.4%<strong class="io hj">的图像具有5种最常见形状中的一种。</strong></p><p id="d4c5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">标题</strong></p><p id="0a36" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">让我们看看标题。我们将展示我们用于图像演示的类的不同标题。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lk"><img src="../Images/36547b33ed6c3e966ffe680c40f3e46f.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*HXbWFe9w6zQVtGGbL4gz4A.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Seven different sample titles that belong to the same class.</figcaption></figure><p id="84a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如我们在上面看到的，我们面临的另一个挑战是这些标题是用不同的语言写的，而且不全是英文。因此，我们使用google translator API来检测语言，并在必要时将其转换为英语。</p><p id="ae9a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">接下来，我们看了标题长度(字数)的分布:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es ll"><img src="../Images/30b01c3cbec50ba8ebeb7c4fe855f249.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*Xo5t8ti8rfho25HXLG1C8A.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Title counts by different lengths.</figcaption></figure><p id="7975" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">可以看出，大多数标题的长度为2-20个单词，峰值大约为7-8个单词。</p><h1 id="6d2a" class="jx jy hi bd jz ka la kc kd ke lb kg kh ki lc kk kl km ld ko kp kq le ks kt ku bi translated">预处理</h1><p id="1948" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">我们有两个不同的数据源:图像和文本，所以我们将使用计算机视觉和NLP(自然语言处理)模型来解决这个问题。每个模型将需要不同的预处理步骤，但总的来说，我们重塑了图像，使它们都具有相同的形状，我们将标记标题中的单词。然后，我们将在模型中使用余弦相似性，以便根据相似性对产品进行分类。</p><h1 id="40dd" class="jx jy hi bd jz ka la kc kd ke lb kg kh ki lc kk kl km ld ko kp kq le ks kt ku bi translated">建模</h1><p id="cedc" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">我们选择F1分数作为我们的衡量标准(在Kaggle竞赛中也是如此)。我们的基线得分是<strong class="io hj"> 0.00149 </strong>(通过简单地返回数据集中最大的一个类来计算)。</p><p id="4189" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步——创建基线模型</strong> <br/>我们的基线模型是两个模型的集合，一个用于图像(计算机视觉模型)，一个用于标题(NLP模型)。对于计算机视觉，我们使用来自imagededup库的CNN(卷积神经网络)模型，该模型使用来自Keras的预训练的MobileNet CNN作为模型。它需要将图像调整为224 X 224。对于NLP，我们在解码为unicode和小写单词后创建了一个tf-idf矩阵，并将这两个模型转换为余弦相似度矩阵。然后，我们使用不同的相似性阈值(CNN使用<strong class="io hj"> 0.85 </strong>，tf-idf使用<strong class="io hj"> 0.5 </strong>)来确定匹配，并通过简单地添加他们找到的匹配来组合他们的结果。这一组合导致F1得分为<strong class="io hj"> 0.48 </strong>。</p><p id="3189" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步——使用更复杂的模型来提高性能</strong> <br/>我们再次选择集成两个模型。对于计算机视觉，我们使用了一个连体神经网络，它使用相同的权重，同时串联三个不同的输入向量，以便计算可比较的输出向量，并通过三重损失函数更新权重。它基本上是通过每次将一幅图像与来自相同类别的一幅图像以及来自不同类别的一幅图像进行比较来进行训练的，并且它输出可用于使用简单的K-最近邻算法来计算距离的嵌入。<br/>暹罗网络由三个VGG16预训练网络和一个再训练输出层组成。它需要一个训练测试分裂和图像整形到200 x 200。连体神经网络的输出F1分数为<strong class="io hj"> 0.50 </strong>。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lm"><img src="../Images/2d610d228d50196fc3311d3ded87e258.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BEEqCfanRl2eyb1T5uYKhg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">The general architecture of the Siamese network used for this project.</figcaption></figure><p id="fc43" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这种情况下，我们的NLP模型是difflib库的SequenceMatcher，它以一种非常有趣的方式比较序列(有关更多信息，请参见文档页面:<a class="ae jk" href="https://docs.python.org/3/library/difflib.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/difflib.html</a>)。仅SequenceMatcher给出的F1分数<strong class="io hj">为0.55 </strong>。<br/>然后，我们以如下方式组合连体NN和序列匹配器:如果这三个条件中的一个为真，则选择图像作为匹配:<br/> 1。暹罗网络返回的距离得分低于<strong class="io hj"> 0.95 </strong>。<br/> 2。SequenceMatcher返回一个高于<strong class="io hj"> 0.55 </strong>的相似性分数。<br/> 3。他们的综合得分(距离+(1-相似度))低于<strong class="io hj"> 1.4 </strong>。这些集合导致F1分数为<strong class="io hj"> 0.71 </strong>。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ln"><img src="../Images/1ef4d01140a3bced32b1d0b415431cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CG9fzmYmpxxu_9ZQdAE0ZA.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">A general abstract structure of the final model architecture.</figcaption></figure><p id="117b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用Flask在AWS服务器上提供最终模型。理想情况下，它将接收图像和标题，并为它们创建嵌入，并将它们与现有的数据库进行比较，以输出类似产品的图像和标题。现在，它可以处理数据库中已经存在的产品。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lo"><img src="../Images/a503a3e62fd0e9f2282b685b490982a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eM6be5_K4r99dfIPK-McGA.png"/></div></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lp"><img src="../Images/d67ad854c0adda597deb19a2b71e2c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*p_ytoawgc5cObFCp351L7A.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">A demo of our product matching tool.</figcaption></figure><h1 id="63c9" class="jx jy hi bd jz ka la kc kd ke lb kg kh ki lc kk kl km ld ko kp kq le ks kt ku bi translated">讨论</h1><p id="895c" class="pw-post-body-paragraph im in hi io b ip kv ir is it kw iv iw ix kx iz ja jb ky jd je jf kz jh ji jj hb bi translated">这是一项非常具有挑战性的任务。匹配来自超过<strong class="io hj"> 11，000 </strong>个不同类别的样本，这些类别的标题和图像可能包含高度多样性。鉴于基线如此之低，我们的最终分数<strong class="io hj"> 0.71 </strong>可以被认为是一个不错的分数。话虽如此，但未来仍有进一步改进的空间。我们认为，主要的改进可以来自于NLP部分，方法是尝试使用深度学习模型，如RNN/LSTM模型和像BERT这样的变压器模型。此外，增加数据库和调整模型参数也可以改善暹罗网络的结果。<br/>最重要的是，我们相信这个项目显示了克服产品内差异问题以检测匹配产品的可行性。</p><p id="8f81" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">总之，随着电子商务行业的发展，消费者可以享受到来自不同卖家的各种各样的产品，并享受到比较和点击按钮获得优惠的奢侈。但这也存在信息泛滥的问题，导致完全相反的结果。这是一个经典案例，机器学习可以通过提供工具来提供解决方案，使消费者可以访问大量数据。这个项目可能会被用于创建这样的工具，这将改善用户体验，并进一步发展电子商务行业。</p></div></div>    
</body>
</html>
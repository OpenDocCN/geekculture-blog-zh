<html>
<head>
<title>Automatic Grammar Agreement &amp; Localizable new APIs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动语法协议和可本地化的新API</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/automatic-grammar-agreement-b953cbf5d101?source=collection_archive---------3-----------------------#2021-07-12">https://medium.com/geekculture/automatic-grammar-agreement-b953cbf5d101?source=collection_archive---------3-----------------------#2021-07-12</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><div class=""><h2 id="cd2c" class="pw-subtitle-paragraph ig hi hj bd b ih ii ij ik il im in io ip iq ir is it iu iv iw ix dy translated">WWDC基金会框架中引入的新功能初探</h2></div><figure class="iz ja jb jc fe jd es et paragraph-image"><div role="button" tabindex="0" class="je jf di jg bf jh"><div class="es et iy"><img src="../Images/2a3bed2ac1a457b01e9095132def7ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKCRYzrnFkLivh_f8FtLfA.jpeg"/></div></div><figcaption class="jk jl eu es et jm jn bd b be z dy">Photo by <a class="ae jo" href="https://unsplash.com/@altumcode?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">AltumCode</a> on <a class="ae jo" href="https://unsplash.com/s/photos/developer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c831" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">上个月早些时候，WWDC会议召开了(实际上和去年一样),发布了一系列关于苹果开发生态系统的新公告。虽然其他人(包括我自己)都对新的async / await功能或全新的Xcode cloud感到兴奋，但我认为，基础框架中添加了一个很酷的功能，但被很大一部分iOS开发人员低估了:新的属性字符串API。</p></div><div class="ab cl kl km gq kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hc hd he hf hg"><p id="47df" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">如果在任何时候，你不得不处理某种类型的属性字符串，你可能会知道这不是一件小事。即使是最基本的布局，比如带下划线的标签，也需要一段代码来正确设置UI，这很难阅读和理解。更糟糕的是，如果您的应用程序是多语言的，并且需要本地化字符串，您需要在可本地化的字符串中创建某种具有自定义语法的实用程序来满足您的需求。直到现在，在处理可本地化的属性化字符串时，还缺乏标准化。</p><p id="d09c" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">iOS 15和Swift 5.5在这方面有了巨大的改进，还引入了一个新的语言功能，名为<strong class="jr hk">自动语法协议</strong>。让我们来看看。</p></div><div class="ab cl kl km gq kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hc hd he hf hg"><h2 id="9b31" class="ks kt hj bd ku kv kw kx ky kz la lb lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated"><strong class="ak">归因串</strong></h2><p id="4e88" class="pw-post-body-paragraph jp jq hj jr b js ln ik ju jv lo in jx jy lp ka kb kc lq ke kf kg lr ki kj kk hc bi translated"><strong class="jr hk"> Markdown语法支持</strong></p><p id="35ad" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">我们现在可以用一个具有markdown语法的字符串创建一个属性化的字符串。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><p id="e43c" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">如果您使用SwiftUI，也可以在文本视图中直接使用markdown语法。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><p id="2f9b" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">这种兼容性最酷的一点是，我们可以以更清晰、更易读的方式组合多种格式。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><p id="53ea" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated"><strong class="jr hk">可本地化&amp;插补支持</strong></p><p id="d977" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">如果需要支持多语言，现在可以利用markdown语法初始化属性化字符串。</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><p id="7c38" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">这已经很酷了。但是，我们也可以添加字符串插值到我们的本地化字符串！。例如，如果我们想给我们的用户一个更个性化的欢迎，我们现在可以这样做:</p><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><h2 id="fa27" class="ks kt hj bd ku kv kw kx ky kz la lb lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated">自动语法协议</h2><p id="7a20" class="pw-post-body-paragraph jp jq hj jr b js ln ik ju jv lo in jx jy lp ka kb kc lq ke kf kg lr ki kj kk hc bi translated">想象一下，我们有一个咖啡订单应用程序。在结帐屏幕中，我们希望向用户显示他们的订单，如下所示:</p><pre class="iz ja jb jc fe lu lv lw lx aw ly bi"><span id="3c4c" class="ks kt hj lv b fj lz ma l mb mc">// English<br/>1 small cappuccino - $2.99<br/>2 medium espressos - $4.99</span></pre><p id="84e4" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">但是，如果我们的应用程序也支持西班牙语，我们需要重新排序文本以匹配正确的语法。此外，我们必须管理我们使用的形容词的单数/复数。</p><pre class="iz ja jb jc fe lu lv lw lx aw ly bi"><span id="505c" class="ks kt hj lv b fj lz ma l mb mc">// Spanish<br/>1 capuchino chico - $2.99<br/>2 expresos medianos - $4.99</span></pre><p id="3acc" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">在英语中，无论你指的是一个还是多个项目，你都要说<em class="md"> medium </em>。然而，在西班牙语中，如果你引用一个项目，你可以说<em class="md"> mediano </em>，如果你引用多个项目，你可以说<em class="md"> medianos </em>。此外，在西班牙语中，名词位于形容词之前。所以，如果你的应用程序支持多语言，你必须考虑所有这些。即使是像我们刚刚讨论的小例子。</p><p id="ea7a" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">新特性<strong class="jr hk">自动语法协议</strong>承担了这一责任，并自动完成所有转换。为了在加载可本地化的字符串时应用它，我们必须使用<strong class="jr hk">自动语法协议</strong>的Markdown语法扩展:</p><p id="d857" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">^[……](屈折:真)。我们从^符号开始，后面是方括号。在括号内，我们放入我们想要变音的字符串。最后，我们指出我们希望文本的这一部分在括号之间发生屈折。</p><pre class="iz ja jb jc fe lu lv lw lx aw ly bi"><span id="0581" class="ks kt hj lv b fj lz ma l mb mc">// Localizable.string <br/><br/>"small" = "small";<br/>"medium" = "medium";<br/>"espresso" = "espresso";<br/>"cappuccino" = "cappuccino";<br/>// 1 small cappuccino - $2.99<br/>"^[%lld %@ %@](inflect: true) - **$%@**" = "%1$lld %2$@ %3$@ - **$%%4$@**";<br/><br/>// Localizable.string - Spanish<br/>"small" = "chico";<br/>"medium" = "mediano";<br/>"espresso" = "expresos";<br/>"cappuccino" = "capuchino";<br/>"^[%lld %@ %@](inflect: true) - **$%@**" = "%1$lld %3$@ %2$@ - **$%%4$@**";</span></pre><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><figure class="iz ja jb jc fe jd"><div class="bz dz l di"><div class="ls lt l"/></div></figure><p id="1c41" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">这是一个巨大的改进，尽管我们仍然需要自己翻译文本，但我们不必根据用户配置的语言来改变代码中参数的顺序。</p><p id="a69e" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">此外，iOS 15将提供一个新的设置选项:<strong class="jr hk">称谓</strong>，我们可以用它来指定我们的性别以及我们希望系统如何对待我们。这也将由语法一致特性自动处理。</p><figure class="iz ja jb jc fe jd es et paragraph-image"><div class="es et me"><img src="../Images/c9c75863b5ce732398d1d9a3743639cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*wHvUi25uer9p9TXqZhi3_w.png"/></div></figure><p id="b6c0" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">在西班牙语中，我们使用的名词可能因性别而异。例如，对于Welcome，如果用户是男性，我们应该说Bienvenido，如果用户是女性，我们应该说Bienvenida。</p><p id="974d" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">在iOS 15之前，我们可能需要这样的东西:</p><pre class="iz ja jb jc fe lu lv lw lx aw ly bi"><span id="b06d" class="ks kt hj lv b fj lz ma l mb mc">// Localizable.string - Spanish<br/><br/>"Welcome" = "Bienvenido/a";</span></pre><p id="b52a" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">有了<strong class="jr hk">自动语法协议</strong>，我们可以在语法中使用屈折属性</p><pre class="iz ja jb jc fe lu lv lw lx aw ly bi"><span id="4599" class="ks kt hj lv b fj lz ma l mb mc">// Localizable.string - Spanish<br/><br/>"^[Welcome](inflect: true)" = "Bienvenido";<br/><br/>// Will print: Bienvenido or Bienvenida depending on the user's configuration</span></pre><p id="cdaf" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">请注意，所有这些功能都处于测试阶段，所以，你可能会发现一些不稳定和一些变化在未来。</p><p id="1462" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">如果你想深入研究这个问题，你可以观看<a class="ae jo" href="https://developer.apple.com/videos/play/wwdc2021/10109/" rel="noopener ugc nofollow" target="_blank"> WWDC演讲</a>和阅读<a class="ae jo" href="https://developer.apple.com/documentation/foundation/attributedstring?changes=_2_8#see-also" rel="noopener ugc nofollow" target="_blank">官方文件</a>。</p></div><div class="ab cl kl km gq kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hc hd he hf hg"><p id="cff9" class="pw-post-body-paragraph jp jq hj jr b js jt ik ju jv jw in jx jy jz ka kb kc kd ke kf kg kh ki kj kk hc bi translated">一如既往，如果你有任何问题，可以在下面留言=)</p></div></div>    
</body>
</html>
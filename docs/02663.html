<html>
<head>
<title>Controlled Forms in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中的受控表单</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/controlled-forms-in-react-ae9092433c08?source=collection_archive---------27-----------------------#2021-05-23">https://medium.com/geekculture/controlled-forms-in-react-ae9092433c08?source=collection_archive---------27-----------------------#2021-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="c69c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">受控表单是React类组件内部的表单，它使用状态在内部处理数据。使用输入字段中的value属性和事件处理程序，我们可以更新组件的状态。要开始创建一个受控表单，您需要构建您的类组件，因为我们将使用状态，而且功能组件没有状态。</p><p id="df89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，让我们从构建我们的类组件开始。确保在文件的开头导入React库。此外，确保定义类组件并从React.Component继承它。不要忘记导出默认组件！这将允许我们将这个组件导入到另一个组件中，并正确地呈现它。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7ce4" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="ddeb" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {<br/>}</span><span id="5a43" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="02c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，一个类组件需要一个render方法来呈现任何东西，所以让我们添加一个render方法。render方法必须包含return语句，并且应该只返回一个对象。要返回多个JSX标签，您必须将它们全部包装在一个div标签中，或者如果您不想创建div，您可以使用&lt; &gt;  &gt;作为占位符。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0552" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="ff1d" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {</span><span id="89b8" class="jm jn hi ji b fi js jp l jq jr">  render() {<br/>    return(<br/>      &lt;div&gt;</span><span id="7c70" class="jm jn hi ji b fi js jp l jq jr">      &lt;/div&gt;</span><span id="b378" class="jm jn hi ji b fi js jp l jq jr">    )<br/>  }<br/>}</span><span id="1c3b" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="58d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是在构造函数方法中定义我们的状态。确保在构造函数中包含super()，这样我们就可以从React.Component继承方法。在花括号内，我们可以将初始状态设置为我们想要的任何值。我用text键设置我的状态，并将值设置为一个空字符串。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="10e1" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="aa9e" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {</span><span id="8270" class="jm jn hi ji b fi js jp l jq jr">  constructor() {<br/>    super()<br/>    this.state = {<br/>      text: ''<br/>    }<br/>  }</span><span id="887d" class="jm jn hi ji b fi js jp l jq jr">  render() {<br/>    return(<br/>      &lt;div&gt;</span><span id="5056" class="jm jn hi ji b fi js jp l jq jr">      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="00f0" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="67ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们设置了组件的初始状态，我们就可以开始构建表单了。在return语句中的div标记内，我创建了一个表单标记，其中一个输入类型为text，另一个输入类型为submit。一旦我们建立了表单，我们必须向文本输入添加一个属性，以便输入值绑定到状态中的文本键。我们可以通过使用value={}来实现这一点。在花括号内，我们必须使用this.state.text定义相应的状态。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0947" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="0bac" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {</span><span id="3d89" class="jm jn hi ji b fi js jp l jq jr">  constructor() {<br/>    super()<br/>    this.state = {<br/>      text: ''<br/>    }<br/>  }</span><span id="fafa" class="jm jn hi ji b fi js jp l jq jr">  render() {<br/>    return(<br/>      &lt;div&gt;<br/>        &lt;form&gt;<br/>          &lt;input type="text" value={this.state.text}/&gt;<br/>          &lt;input type="submit"/&gt;<br/>        &lt;/form&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="ff9b" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="5a1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一组是当文本被输入到输入字段时即时更新我们的状态。我们可以通过使用onChange事件来做到这一点。因此，首先让我们构建handleOnChange方法，该方法允许我们在输入字段中键入文本时即时更新状态。我将这个函数创建为一个箭头函数，以便this关键字被正确绑定。handleOnChange必须将事件作为我命名为e的参数，我们必须传入事件，因为这是一个事件处理程序，我们需要获取事件目标的值。目标的值将是输入到输入字段中的任何内容。一旦handleOnChange方法构建完成，我们就可以将它连接到文本输入。通过使用onChange={}事件并以this.handleOnChange的形式传入我们的handleOnChange方法，我们能够立即更新我们的状态，因为当我们在输入字段中键入内容时会发生变化。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e239" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="39c0" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {</span><span id="f747" class="jm jn hi ji b fi js jp l jq jr">  constructor() {<br/>    super()<br/>    this.state = {<br/>      text: ''<br/>    }<br/>  }</span><span id="efc3" class="jm jn hi ji b fi js jp l jq jr">  handleOnChange = (e) =&gt; {<br/>    this.setState({<br/>      text: e.target.value}<br/>    )<br/>  }</span><span id="ab7b" class="jm jn hi ji b fi js jp l jq jr">  render() {<br/>    return(<br/>      &lt;div&gt;<br/>        &lt;form&gt;<br/>          &lt;input type="text" value={this.state.text} onChange=            {this.handleOnChange}/&gt;<br/>          &lt;input type="submit"/&gt;<br/>        &lt;/form&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="3cab" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="1171" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">处理完onChange事件后，我们可以继续处理onSubmit事件。该事件将允许我们获取现在已修改的状态，并呈现它或在现在已修改的状态上运行方法。我们首先构建handleOnSubmit函数。该函数也将事件作为参数。传入该事件后，我们可以对该事件调用preventDefault()，这样当我们提交表单时页面就不会刷新。然后，我们必须通过在表单标记中使用onSubmit={}将表单连接到handleOnSubmit方法。然后，我们将handleOnSubmit方法作为this.handleOnSubmit传递给OnSubmit事件。如果您想在提交表单后清除输入字段和状态，我们可以再次使用this.setState，方法是在构造器中以完全相同的方式重新定义状态，键为文本，值为空字符串。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="00c8" class="jm jn hi ji b fi jo jp l jq jr">import React from 'react'</span><span id="56b4" class="jm jn hi ji b fi js jp l jq jr">class Component extends React.Component {</span><span id="625d" class="jm jn hi ji b fi js jp l jq jr">  constructor() {<br/>    super()<br/>    this.state = {<br/>      text: ''<br/>    }<br/>  }</span><span id="938d" class="jm jn hi ji b fi js jp l jq jr">  handleOnChange = (e) =&gt; {<br/>    this.setState({<br/>      text: e.target.value}<br/>    )<br/>  }</span><span id="d76a" class="jm jn hi ji b fi js jp l jq jr">  handleOnSubmit = (e) =&gt; {<br/>    e.preventDefault()<br/>    alert('Text was just submitted: ' + this.state.text)<br/>    this.setState({<br/>      text: ''}<br/>    )<br/>  }</span><span id="3c06" class="jm jn hi ji b fi js jp l jq jr">  render() {<br/>    return(<br/>      &lt;div&gt;<br/>        &lt;form onSubmit={this.handleOnSubmit}&gt;<br/>          &lt;input type="text" value={this.state.text} onChange=            {this.handleOnChange}/&gt;<br/>          &lt;input type="submit"/&gt;<br/>        &lt;/form&gt;<br/>      &lt;/div&gt;<br/>    )<br/>  }<br/>}</span><span id="cb86" class="jm jn hi ji b fi js jp l jq jr">export default Component</span></pre><p id="bfb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，这就是你如何建立一个可控的形式。同样，我们使用受控的表单和状态来处理组件内部的数据。组件内的状态充当由组件呈现的输入元素的数据源。使用value属性和事件处理程序，我们可以根据输入到输入字段中的内容来反映状态变化。这就是为什么一个表单是可控的。</p><p id="8b3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果不使用受控表单，我们将不得不使用存储在DOM中的表单，并使用对DOM节点的引用来从DOM中检索值。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Predicting the Amount Spent By Customers Using ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ML预测客户的消费金额</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/predicting-the-amount-spent-by-customers-using-ml-df4dddf5c1df?source=collection_archive---------13-----------------------#2021-05-04">https://medium.com/geekculture/predicting-the-amount-spent-by-customers-using-ml-df4dddf5c1df?source=collection_archive---------13-----------------------#2021-05-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/40d1d97f92ebb9e9012ce5cbae9bd911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pKa0FOqTx49ut05k.jpg"/></div></div></figure><div class=""/><div class=""><h2 id="e237" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh dx translated">建立了一个机器学习模型，使用线性回归来预测客户在电子商务中的年消费额</h2></div><p id="32df" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">在摆弄了泰坦尼克号的数据集后，我决定研究一个更具时代感的主题。我选择的数据集是关于一个电子商务客户的。它基本上包含了许多客户的数据，比如网站上的平均会话时长、在网站上花费的时间、会员资格时长以及每年花费的金额。我真的很喜欢处理这个数据集，因为电子商务近年来增长了很多。现在让我们来看看数据集:</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ke"><img src="../Images/90083e71361ed68694e598fcbcefb392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTPmTKCVqNurRZ-LZmnwAA.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx">Graph 1: Head()</figcaption></figure><p id="131b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">该数据集包含8列和500行。在做了一些分析后，我发现会员资格的长短是对顾客每年消费金额影响最大的特征。在那之后，我开始绘制一些图表来更好地观察这种关系。</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es kn"><img src="../Images/ec87cb9d00216e330c45613cf2cf1abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z6mnlcCq8DGk4DY_umouDg.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx">Graph 2 : Length of membership x Yearly Amount Spent</figcaption></figure><p id="1a50" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">联合图显示了会员资格的长短和每年花费的数量之间的正相关关系。这意味着会员资格越长，消费金额越高。现在很明显，线性回归将是这个数据集的一个好选择！</p><h2 id="13f0" class="ko kp ht bd kq kr ks kt ku kv kw kx ky jr kz la lb jv lc ld le jz lf lg lh li bi translated">分割数据</h2><p id="f84d" class="pw-post-body-paragraph ji jj ht jk b jl lj iu jn jo lk ix jq jr ll jt ju jv lm jx jy jz ln kb kc kd hb bi translated">我开始导入一些新的库来帮助分割数据，并将特性分配到两个变量中</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lo"><img src="../Images/1fc5bcd7ddc0702343734c4140ca00ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FE81XKMlUsBPxd8_xtEIig.png"/></div></div></figure><p id="a978" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">现在，我准备将数据分为“训练”和“测试”数据，来训练我的模型，看看它是否能很好地预测。对于这一部分，我使用了来自<em class="lp"> Sklearn: </em>的<em class="lp"> train_test_split </em>方法</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lq"><img src="../Images/7eb6bb45141884587edad6dde6062358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7PW-IYHBPsNlT9c1tcSezA.png"/></div></div></figure><h2 id="ef08" class="ko kp ht bd kq kr ks kt ku kv kw kx ky jr kz la lb jv lc ld le jz lf lg lh li bi translated">创建模型</h2><p id="1184" class="pw-post-body-paragraph ji jj ht jk b jl lj iu jn jo lk ix jq jr ll jt ju jv lm jx jy jz ln kb kc kd hb bi translated">基本的线性回归公式是<strong class="jk hu"> Y = A + B*X </strong>。这意味着模型的目的是计算出A和B的值，以便预测Y(每年花费的金额)，只要我给出X值(其他特征)。现在让我们建立模型并训练它:</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lr"><img src="../Images/b510fbe4844a862a4f2ccd497460ebc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_cYKMBJyMbDsEeY54aMWA.png"/></div></div></figure><h2 id="0c7a" class="ko kp ht bd kq kr ks kt ku kv kw kx ky jr kz la lb jv lc ld le jz lf lg lh li bi translated"><strong class="ak">使用测试数据并评估结果</strong></h2><p id="6087" class="pw-post-body-paragraph ji jj ht jk b jl lj iu jn jo lk ix jq jr ll jt ju jv lm jx jy jz ln kb kc kd hb bi translated">使用测试数据后，我决定绘制一个图表来查看预测值和真实值之间的关系。来看看他们长得像不像！</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ls"><img src="../Images/c4545c402407907c172d28bab5051e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-3VV6FaSnUt_hw2XEjuDA.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx">Graph 3 : Lineplot Predict values x True values</figcaption></figure><p id="cb13" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">真好！这些值有很好的相关性！这意味着模型预测的Y值足够好！</p><p id="b977" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">是时候引入一些度量来评估模型了。我决定导入这些指标:</p><ul class=""><li id="d071" class="lt lu ht jk b jl jm jo jp jr lv jv lw jz lx kd ly lz ma mb bi translated"><strong class="jk hu">误差平方和(SSE) </strong>:对所有残差求和并求平方</li><li id="a094" class="lt lu ht jk b jl mc jo md jr me jv mf jz mg kd ly lz ma mb bi translated"><strong class="jk hu">均方误差(MSE)</strong>:SSE的平均值</li><li id="8dfd" class="lt lu ht jk b jl mc jo md jr me jv mf jz mg kd ly lz ma mb bi translated"><strong class="jk hu">均方误差的Sqrt(RMSE)</strong>:均方误差的Sqrt</li><li id="3210" class="lt lu ht jk b jl mc jo md jr me jv mf jz mg kd ly lz ma mb bi translated"><strong class="jk hu"> R2分数:</strong>解释了Y和X之间的差异</li></ul><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mh"><img src="../Images/be9879de8bc5d6c2b63fe9e06c75af28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*baLLhobMdJ26LpF7UJsWTw.png"/></div></div></figure><p id="d884" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">R2是最容易理解的。在这个模型中，R2的值是0.98，这意味着我们的线性回归能够解释每年花费金额和其他特征之间98%的差异。该值的基准是0.7。一个非常高的R2值，比如0.98，可能有很多原因，比如不真实的数据或有偏见的数据。</p><h2 id="f4cd" class="ko kp ht bd kq kr ks kt ku kv kw kx ky jr kz la lb jv lc ld le jz lf lg lh li bi translated">这种模式有什么帮助？</h2><p id="4bfa" class="pw-post-body-paragraph ji jj ht jk b jl lj iu jn jo lk ix jq jr ll jt ju jv lm jx jy jz ln kb kc kd hb bi translated">在开始时，我说过“会员资格的长度”是更能影响每年消费金额的特征，因此，电子商务可以专注于扩展会员资格的行动，或者使更多的客户成为会员。但是，其他功能呢？值得为它们努力吗？</p><p id="6009" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">为了更好地理解这些关系，我打印出了模型的系数:</p><figure class="kf kg kh ki fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mi"><img src="../Images/001677978874a1119c99683b125425a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nMGsRBwI5qonmOKTpEt4zw.png"/></div></div></figure><p id="a5b8" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hb bi translated">这意味着什么？基本上，我们可以这样理解,“App上的时间”每增长一个单位,“每年花费的金额”就增加38美元。同样，会员资格是增加最多的原因，但是，也许专注于应用程序也能带来好的结果，也许改进应用程序比增加会员资格更便宜！</p><blockquote class="mj"><p id="6789" class="mk ml ht bd mm mn mo mp mq mr ms kd dx translated">你可以在Github查看这个完整的笔记本。</p></blockquote></div></div>    
</body>
</html>
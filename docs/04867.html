<html>
<head>
<title>This simple stunt lets me release a speedy Angular application.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个简单的特技让我发布了一个快速的角度应用程序。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/this-simple-stunt-lets-me-release-a-speedy-angular-application-741d5803a44a?source=collection_archive---------18-----------------------#2021-07-05">https://medium.com/geekculture/this-simple-stunt-lets-me-release-a-speedy-angular-application-741d5803a44a?source=collection_archive---------18-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/118cab467c7d238a613f9f7ecb402c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hcx68hqmmMkV0a2A"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Photo by <a class="ae hv" href="https://unsplash.com/@karolkas?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Karol Kasanicky</a> on <a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="9695" class="pw-subtitle-paragraph iw hx hy bd b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn dx translated">每一个。单身。时间。</h2></div><p id="2dbe" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如何确保您的Angular应用程序在每次部署时都做好了生产准备？</p><blockquote class="kk"><p id="0155" class="kl km hy bd kn ko kp kq kr ks kt kj dx translated">你能做些什么来确保你永远不会部署一个慢角度的应用程序？</p></blockquote><p id="e633" class="pw-post-body-paragraph jo jp hy jq b jr ku ja jt ju kv jd jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">如何在Angular项目中使用Lighthouse包，以确保每次部署时都能取得好成绩？</p><p id="be2e" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">嗯…</p><blockquote class="kk"><p id="4529" class="kl km hy bd kn ko kp kq kr ks kt kj dx translated"><strong class="ak">先说个故事</strong> …</p></blockquote><p id="92c8" class="pw-post-body-paragraph jo jp hy jq b jr ku ja jt ju kv jd jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">…关于一家名为LeanTech的蓬勃发展的初创公司，其Angular应用服务于数百万用户。</p><p id="7c8a" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">LeanTech有一个由5名资深开发人员组成的团队，他们非常了解Angular。因为事情正在蓬勃发展🤑他们决定雇佣一个名叫Joe的初级Angular开发者。</p><p id="2b42" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Joe是一名新的开发人员，对Angular了解不多。他太傻了，在Angular应用程序的<code class="du kz la lb lc b">index.html</code>文件的<code class="du kz la lb lc b">&lt;head&gt;</code>部分添加了3个不同的脚本标签。😮</p><p id="6701" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来发生了什么？</p><p id="5bed" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">服务于数百万用户的Angular应用程序现在要多花3秒钟来加载。由于开发人员从未使用过生产应用程序，直到一位愤怒的用户报告了这个问题，才过了几天。😠</p><blockquote class="kk"><p id="2674" class="kl km hy bd kn ko kp kq kr ks kt kj dx translated"><strong class="ak">那么，你如何避免这样的情况呢？</strong></p></blockquote><p id="e2af" class="pw-post-body-paragraph jo jp hy jq b jr ku ja jt ju kv jd jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">每次部署Angular应用程序时，您如何确保您的生产代码得到了适当的优化？</p><p id="5746" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇短文中，我将向您展示如何永远不要再部署一个缓慢的角度应用程序。</p><p id="20f9" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我将向您展示如何在Angular应用程序投入生产之前测试其速度和性能。确保您的Angular应用程序每次都能提供出色的用户体验。</p><blockquote class="kk"><p id="24ed" class="kl km hy bd kn ko kp kq kr ks kt kj dx translated">我们将使用一个名为Lighthouse的工具来自动测试我们的Angular应用程序的性能。</p></blockquote><p id="63f8" class="pw-post-body-paragraph jo jp hy jq b jr ku ja jt ju kv jd jw jx kw jz ka kb kx kd ke kf ky kh ki kj hb bi translated">你可以用不同的方式。</p><p id="d8dd" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Lighthouse是Google创建的一个分析网页性能的应用程序。</p><p id="271a" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它支持谷歌Chrome浏览器，但也可以作为NPM软件包、浏览器扩展甚至命令行界面安装。</p><p id="5a78" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">传言谷歌用Lighthouse来监控网页性能。如果你的网页太慢，你的排名将会输给更快的网站，这意味着如果你的Angular应用程序需要良好的SEO排名(例如，一个电子商务网站)，那么你应该在部署之前检查性能得分，以确保你是绿色的。</p><p id="a64d" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">撇开SEO不谈，验证Angular应用程序的性能是一个很好的实践，不管它的目的是什么，所以这适用于你，不管SEO与否。</p><p id="e2cc" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你对Lighthouse如何工作的细节感兴趣，你可以在这里阅读更多的<a class="ae hv" href="https://github.com/GoogleChrome/lighthouse/blob/master/docs/architecture.md" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="1ff0" class="ld le hy bd lf lg lh li lj lk ll lm ln jf lo jg lp ji lq jj lr jl ls jm lt lu bi translated">如何在您的CI渠道中进行快速灯塔检查？快速肮脏的方法。</h1><p id="f46f" class="pw-post-body-paragraph jo jp hy jq b jr lv ja jt ju lw jd jw jx lx jz ka kb ly kd ke kf lz kh ki kj hb bi translated">那么，在Angular应用程序上运行性能测试的最快方法是什么呢？</p><p id="e0e7" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><a class="ae hv" href="https://developers.google.com/web/tools/lighthouse/#cli" rel="noopener ugc nofollow" target="_blank">灯塔词</a>。</p><p id="1051" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是如何安装它与NPM。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="2820" class="mi le hy lc b fi mj mk l ml mm">npm install -g lighthouse</span></pre><p id="5652" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">或者你更愿意用纱线。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="f3ad" class="mi le hy lc b fi mj mk l ml mm">yarn global add lighthouse</span></pre><p id="526d" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一旦安装完毕，以下是使用方法。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="2135" class="mi le hy lc b fi mj mk l ml mm">lighthouse &lt;angular-app-url&gt;</span></pre><p id="1cea" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当您运行这个命令时，它将运行一个性能测试，并将结果保存在一个HTML文件中，如下所示。</p><figure class="ma mb mc md fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mn"><img src="../Images/66e98f6173b244fb9bc39dee8674dd44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vARcvxTfvO5eSAKD.png"/></div></div></figure><h1 id="a9ff" class="ld le hy bd lf lg lh li lj lk ll lm ln jf lo jg lp ji lq jj lr jl ls jm lt lu bi translated">使用Lighthouse包在你的Angular应用上运行一个<a class="ae hv" href="https://developers.google.com/speed/pagespeed/insights/" rel="noopener ugc nofollow" target="_blank"> Pagespeed Insights </a>测试</h1><p id="8c94" class="pw-post-body-paragraph jo jp hy jq b jr lv ja jt ju lw jd jw jx lx jz ka kb ly kd ke kf lz kh ki kj hb bi translated">但是，难道没有更自动化和可伸缩的方法来检查您的Angular应用程序的性能吗？</p><p id="6688" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当然有。</p><p id="4042" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在您的Angular应用程序中，首先安装Lighthouse包。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="bf51" class="mi le hy lc b fi mj mk l ml mm">npm install --include=dev lighthouse</span></pre><p id="d420" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">或者纱线。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="b19b" class="mi le hy lc b fi mj mk l ml mm">yarn add lighthouse --dev</span></pre><p id="7305" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">接下来，我们将在Angular应用程序的根目录下创建一个脚本。我将这个文件命名为<code class="du kz la lb lc b">lighthouse.js</code>。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="eae3" class="mi le hy lc b fi mj mk l ml mm">const lighthouse = require('lighthouse');<br/>const chromeLauncher = require('chrome-launcher');<br/><br/>(async () =&gt; {<br/>  const chrome = await chromeLauncher.launch({chromeFlags: ['--headless']});<br/>  const options = {logLevel: 'info', output: 'html', onlyCategories: ['performance'], port: chrome.port};<br/>  const runnerResult = await lighthouse('http://localhost:4200', options);<br/><br/>  console.log('Report is done for', runnerResult.lhr.finalUrl);<br/><br/>  const performanceScore = runnerResult.lhr.categories.performance.score * 100;<br/>  console.log('Performance score was', performanceScore);<br/><br/>  await chrome.kill();<br/><br/>  if (performanceScore &lt; 80) {<br/>    throw("Performance score to low for production release.");<br/>  }<br/>})();</span></pre><p id="f74b" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后我们将添加一个<code class="du kz la lb lc b">postbuild</code>脚本来检查我们最新的构建。</p><pre class="ma mb mc md fd me lc mf mg aw mh bi"><span id="caa0" class="mi le hy lc b fi mj mk l ml mm">"scripts": {<br/>    ....<br/>    "postbuild": "ng serve &amp; node lighthouse.js &amp;&amp; exit"<br/>  },</span></pre><p id="fdd0" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">那么我们刚才做了什么？</p><ol class=""><li id="2292" class="mo mp hy jq b jr js ju jv jx mq kb mr kf ms kj mt mu mv mw bi translated">我们创建了一个脚本，用Lighthouse库测试我们的应用程序。</li><li id="c64b" class="mo mp hy jq b jr mx ju my jx mz kb na kf nb kj mt mu mv mw bi translated">我们在每次构建后运行脚本。</li><li id="3d76" class="mo mp hy jq b jr mx ju my jx mz kb na kf nb kj mt mu mv mw bi translated">如果性能指标小于80，我们的<code class="du kz la lb lc b">postbuild</code>步骤就会失败。</li></ol><figure class="ma mb mc md fd hk er es paragraph-image"><a href="https://school.danielk.tech/course/unleash-your-angular-testing-skills?utm_source=medium&amp;utm_medium=banner&amp;utm_campaign=unleash_testing_skills"><div class="er es nc"><img src="../Images/f1b6577fb74e9686aa28b76134fcd343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIckqGEatusFxMIp0LnzNw.png"/></div></a></figure><h1 id="6c5c" class="ld le hy bd lf lg lh li lj lk ll lm ln jf lo jg lp ji lq jj lr jl ls jm lt lu bi translated">结论</h1><p id="8711" class="pw-post-body-paragraph jo jp hy jq b jr lv ja jt ju lw jd jw jx lx jz ka kb ly kd ke kf lz kh ki kj hb bi translated">我的朋友，这是对你的Angular应用程序进行性能检查的一种快捷方式。并确保您发布一个优化的Angular应用程序…每。单身。时间。</p><p id="a889" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当然，剥猫皮的方法不止一种。您可以创建一个定制的Webpack配置，并使用lighthouse Webpack插件来检查您的应用程序。</p><p id="7847" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">或者，您可以将Lighthouse添加到您的CI构建流程中，并仅在您决定部署时运行性能测试。</p><p id="17d6" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你可以选择什么对你最好。</p><p id="045b" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是不管你决定选择哪种方式，我已经给了你简单的步骤，告诉你如何永远不要再部署一个缓慢的角度应用程序。</p><p id="ffb2" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您喜欢这篇文章，并认为它很有用，请点击👏按钮，关注我，获取更多类似本文的精彩文章。</p><p id="21fb" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hz">关注我:</strong> <a class="ae hv" href="https://github.com/dkreider" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，<a class="ae hv" href="https://dkreider.medium.com/" rel="noopener">媒体</a>，<a class="ae hv" href="https://danielk.tech" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><figure class="ma mb mc md fd hk er es paragraph-image"><div class="er es nd"><img src="../Images/4e2819befbfd109cdfe5ea3fd13447fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/0*xdoyBXrqhQQkzto7.png"/></div></figure></div><div class="ab cl ne nf gp ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hb hc hd he hf"><p id="5598" class="pw-post-body-paragraph jo jp hy jq b jr js ja jt ju jv jd jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="nl">原载于</em><a class="ae hv" href="https://danielk.tech/home/angular-and-pagespeed-insights" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://danielk . tech</em></a><em class="nl">。</em></p></div></div>    
</body>
</html>
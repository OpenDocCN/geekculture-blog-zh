<html>
<head>
<title>Using CSS variables for Dynamic Brand theming</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CSS变量进行动态品牌主题化</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-css-variables-for-dynamic-brand-theming-323cd7cd4879?source=collection_archive---------32-----------------------#2021-06-20">https://medium.com/geekculture/using-css-variables-for-dynamic-brand-theming-323cd7cd4879?source=collection_archive---------32-----------------------#2021-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bcc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最近，我开发了一个电子商务结账页面生成器(无代码工具)，商家可以根据他们的品牌改变主题。商家可以为按钮、主体等各种元素配置他们的品牌颜色和次要颜色。该配置将使用API获取，并在呈现时应用于结帐页面。我探索了各种方法，比如SASS/LESS/Stylus变量、CSS-in-JS库和应用主题的CSS变量。经过深入的探索，我最终使用了CSS变量。在本文中，我将解释每种方法的优缺点，以及我是如何使用CSS变量的。</p><h1 id="d557" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">SASS/LESS/Stylus变量:</h1><p id="05be" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">CSS预处理程序是脚本语言，允许开发者使用变量、函数、混合等编写干巴巴的风格。这些枯燥的样式在编译时会被转换成原始的CSS样式。如果我们在编译时知道所有与主题相关的信息，我们可以很容易地将它们映射到这些变量并实现主题化。由于收银台必须允许商家在运行时动态改变主题，我们不能采用这种方法。</p><h1 id="2eef" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">CSS-in-JS库:</h1><p id="95ac" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">市面上有很多CSS-in-Js库，比如<a class="ae kg" href="https://styled-components.com/docs/advanced#theming" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">styled-components</strong></a><strong class="ih hj"/><a class="ae kg" href="https://emotion.sh/docs/theming" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">emotion</strong></a><strong class="ih hj"/><a class="ae kg" href="https://glamorous.rocks/advanced/#theming" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">laminary</strong></a>等。这些提供了广泛的主题化支持。然而，这些库需要<code class="du kh ki kj kk b">&lt;ThemeProvider /&gt;</code>，它必须包装在应用程序上，以便提供主题上下文。供应商锁定是使用这种方法的另一个缺点。未来我们将无法轻松地切换到不同的方法。由于我们已经习惯了传统的CSS方法，学习曲线也很高。</p><h1 id="ba2d" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">CSS变量:</h1><p id="6cc8" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">CSS变量(也称为自定义属性)允许我们使用Javascript在运行时动态更改值。我们可以使用<code class="du kh ki kj kk b">var()</code>在样式表的引用中使用一个变量。您可以在CSS或javascript中指定CSS变量的值。<a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties#browser_compatibility" rel="noopener ugc nofollow" target="_blank">很多最新的浏览器</a>版本都支持CSS变量。由于CSS变量受原生CSS支持，而且学习曲线也很低，所以我更喜欢将CSS变量用于我的主题化系统。</p><p id="9c52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们创建一个简单的结帐页面，包含送货地址部分、付款部分和购物车部分。商家将能够为这些部分配置<strong class="ih hj"> brandColor、secondaryColor </strong>和<strong class="ih hj"> bodyBackgroundColor </strong>。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/2a1255b4793336eac050a6a1b38b7fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*REYqE6-M69FmLcBB.png"/></div></div></figure><h2 id="7c00" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">步骤1 —映射变量以检出元素</strong></h2><p id="d5b4" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">让我们将每个变量映射到各自的checkout元素。</p><ol class=""><li id="8784" class="ll lm hi ih b ii ij im in iq ln iu lo iy lp jc lq lr ls lt bi translated"><strong class="ih hj">品牌颜色</strong> -用于主要按钮、标志和边框颜色</li><li id="f643" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><strong class="ih hj"> secondaryColor </strong> —用于应用优惠券输入组</li><li id="12c1" class="ll lm hi ih b ii lu im lv iq lw iu lx iy ly jc lq lr ls lt bi translated"><strong class="ih hj"> bodyBackgroundColor </strong> -这是主容器的背景色。</li></ol><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/c42b0fe8af394b19b91fd0205bb4d727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q5HIW6bZoPgvhAci.png"/></div></div></figure><h2 id="493a" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">第二步——在样式表中使用CSS变量。</strong></h2><p id="4584" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">要将一个CSS变量赋给一个属性，我们必须使用<code class="du kh ki kj kk b">var()</code>。</p><p id="3763" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看使用<code class="du kh ki kj kk b">brandColor</code>变量的选择器。这个变量的值将在运行时使用javascript设置。</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="b823" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kh ki kj kk b">secondaryColor</code>变量用于应用优惠券按钮。</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="a537" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du kh ki kj kk b">bodyBackgroundColor</code>应用于应用程序的主容器。</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="35ad" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">步骤3 —创建商户配置JSON </strong></h2><p id="113e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们的主题构建器配置将通过服务器的API公开。JSON的配置看起来会像这样</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="58ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了演示，让我们用静态JSON模拟服务器响应。<code class="du kh ki kj kk b">getMerchantConfig</code>函数将返回一个使用<code class="du kh ki kj kk b">merchantId</code>参数解析商户配置的承诺。</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="e568" class="kx je hi bd jf ky kz la jj lb lc ld jn iq le lf jr iu lg lh jv iy li lj jz lk bi translated"><strong class="ak">步骤4 —在Javascript中设置CSS变量的值</strong></h2><p id="e84e" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">现在，让我们看看Javascript中的变量是如何设置的。因为变量在样式表中使用，所以让我们在根元素中设置变量。</p><pre class="km kn ko kp fd mb kk mc md aw me bi"><span id="1db9" class="kx je hi kk b fi mf mg l mh mi">const root = document.querySelector(':root');</span><span id="1c20" class="kx je hi kk b fi mj mg l mh mi">root.style.setProperty('--brandColor', merchant.brandColor);</span><span id="dd16" class="kx je hi kk b fi mj mg l mh mi">root.style.setProperty('--secondaryColor', merchant.secondaryColor);</span><span id="3db8" class="kx je hi kk b fi mj mg l mh mi">root.style.setProperty('--bodyBackgroundColor', merchant.bodyBackgroundColor);</span></pre><p id="8504" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们必须为商家获取主题配置。假设商家1是活跃的。我们必须通过传递merchantId <code class="du kh ki kj kk b">merchant1</code>来调用<code class="du kh ki kj kk b">getMerchantConfig</code>函数。</p><pre class="km kn ko kp fd mb kk mc md aw me bi"><span id="830f" class="kx je hi kk b fi mf mg l mh mi">const setTheme = async () =&gt; {</span><span id="1930" class="kx je hi kk b fi mj mg l mh mi">  <strong class="kk hj">const merchant = await getMerchantConfig('merchant1');</strong></span><span id="e0c2" class="kx je hi kk b fi mj mg l mh mi">  const root = document.querySelector(':root');</span><span id="3a8f" class="kx je hi kk b fi mj mg l mh mi">  root.style.setProperty('--brandColor', merchant.brandColor);</span><span id="26de" class="kx je hi kk b fi mj mg l mh mi">  root.style.setProperty('--secondaryColor',     merchant.secondaryColor);</span><span id="ade2" class="kx je hi kk b fi mj mg l mh mi">  root.style.setProperty('--bodyBackgroundColor', merchant.bodyBackgroundColor);</span><span id="52bb" class="kx je hi kk b fi mj mg l mh mi">};</span><span id="7895" class="kx je hi kk b fi mj mg l mh mi">setTheme();</span></pre><p id="7524" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终的Js代码将如下所示。</p><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="d608" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就这样，我们结束了😎。你可以在<a class="ae kg" href="https://codepen.io/mathumithapalani/pen/OJpBGjL?editors=1111" rel="noopener ugc nofollow" target="_blank">代码笔</a>中看到工作演示。您可以通过将不同的商品传递给<code class="du kh ki kj kk b">getMerchantConfig</code>函数来进行操作。您也可以尝试配置其他属性，如字体大小、字体系列等。</p><div class="mk ml ez fb mm mn"><a href="https://codepen.io/mathumithapalani/embed/OJpBGjL?editors=1111" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hj fi z dy ms ea eb mt ed ef hh bi translated">CodePen Embed -动态品牌主题</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">const getmerchant config =(merchant id)= &gt; { const merchant configs =[{ id:' merchant 1 '，brandColor: '#800080'…</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">codepen.io</p></div></div></div></a></div><h1 id="a111" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论:</h1><p id="8ebd" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">使用CSS变量可以大大简化主题化。没有供应商锁定。CSS变量受原生CSS支持，并具有<a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties#browser_compatibility" rel="noopener ugc nofollow" target="_blank">出色的浏览器兼容性</a>。最适合我的特点了。CSS变量比主题化有更多的潜力。它减少了大量重复的任务。你可以试一试。我在这里附上一些好的资源。</p><p id="8fb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kg" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties#basic_usage" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/CSS/Using _ CSS _ custom _ properties # basic _ usage</a></p><p id="fadf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kg" href="https://electerious.medium.com/the-power-of-css-variables-6c4e4ebaf279" rel="noopener">https://electerious . medium . com/the-power-of-CSS-variables-6 C4 E4 ebaf 279</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>Creating a CRUD shopping service with Quarkus, Hibernate Reactive ORM Panache and PostgreSQL using Active Record Pattern</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Quarkus、Hibernate反应式ORM Panache和PostgreSQL创建CRUD购物服务</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/creating-a-crud-shopping-service-with-quarkus-hibernate-orm-panache-and-postgresql-using-active-41a755693f12?source=collection_archive---------3-----------------------#2021-06-06">https://medium.com/geekculture/creating-a-crud-shopping-service-with-quarkus-hibernate-orm-panache-and-postgresql-using-active-41a755693f12?source=collection_archive---------3-----------------------#2021-06-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/640fe5be748cc4c7ccd849b3467aaeb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oad3qmVPLGEQX51AlslILw.jpeg"/></div></div></figure><div class=""/><p id="bb0e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当有了<strong class="is hu"> Hibernate ORM </strong> mapper可用时，在quarkus中创建一个基于JPA的CRUD应用程序是一个相当无缝的过程。Hibernate ORM是事实上的标准<strong class="is hu"> JPA </strong>实现，而<strong class="is hu"> Quarkus </strong>提供了一个名为<strong class="is hu"> Panache </strong>的扩展，使得在反应式上下文中运行时不同的映射变得更加简单。本文给出了几个例子，说明如何使用活动记录模式将这些部分集成在一起。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><figure class="jw jx jy jz fd hk er es paragraph-image"><div class="er es jv"><img src="../Images/ce7ac1b0824d01cdc66b46c24cdc4c14.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*d9VDqITcsyUkTcncECeJBA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">quarkus.io</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><blockquote class="ke kf kg"><p id="4f50" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hb bi translated">活动记录模式是一种访问<a class="ae kl" href="https://en.wikipedia.org/wiki/Database" rel="noopener ugc nofollow" target="_blank">数据库</a>中数据的方法。一个<a class="ae kl" href="https://en.wikipedia.org/wiki/Database_table" rel="noopener ugc nofollow" target="_blank">数据库表</a>或<a class="ae kl" href="https://en.wikipedia.org/wiki/View_(database)" rel="noopener ugc nofollow" target="_blank">视图</a>被包装成一个<a class="ae kl" href="https://en.wikipedia.org/wiki/Class_(computer_science)" rel="noopener ugc nofollow" target="_blank">类</a>。因此，一个<a class="ae kl" href="https://en.wikipedia.org/wiki/Object_(computer_science)" rel="noopener ugc nofollow" target="_blank">对象</a>实例被绑定到表中的一行。</p></blockquote><p id="0693" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下发现基于Quarkus社区的这篇扩展文章。</p><p id="6668" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kl" href="https://quarkus.io/guides/hibernate-orm-panache" rel="noopener ugc nofollow" target="_blank">quar kus——简化的HIBERNATE ORM，外观华丽</a></p><h1 id="ec18" class="km kn ht bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">先决条件</h1><ul class=""><li id="6a9f" class="lk ll ht is b it lm ix ln jb lo jf lp jj lq jn lr ls lt lu bi translated">Quarkus ≥1.13.6 .最终</li><li id="837f" class="lk ll ht is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">一种数据库系统</li><li id="627e" class="lk ll ht is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">Java 8+</li><li id="2b09" class="lk ll ht is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">龙目岛≥ 1.18.18</li><li id="3b55" class="lk ll ht is b it lv ix lw jb lx jf ly jj lz jn lr ls lt lu bi translated">Maven ≥ 3.6.2</li></ul><p id="183a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，先决条件是添加以下扩展。我们将使用基于反应的扩展，它利用了Vert.x事件循环线程池。</p><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="b803" class="mf kn ht mb b fi mg mh l mi mj">$ ./mvnw quarkus:add-extension -Dextensions="quarkus-hibernate-reactive-panache,quarkus-reactive-pg-client,quarkus-resteasy-reactive-jsonb"</span></pre></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="5a7a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在开始之前，一些简短的UML符号描述了所涉及的实体。</p><figure class="jw jx jy jz fd hk er es paragraph-image"><div class="er es mk"><img src="../Images/f5c7eac4ae544df8e37e842d0147f538.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*ZHqcGzQDNLFFdhw1yteNYA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">UML notation for our entities</figcaption></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="0796" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们开始设置我们的购物车服务，它基本上利用了包含一组处理产品的购物项目的购物车。具有适当hibernate注释映射的产品如下所示。</p><h1 id="da95" class="km kn ht bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">宣称派头产品实体</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="63b3" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">声明华丽的购物车实体</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="5d0f" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">声明Panache购物车项目实体</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="406b" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">声明产品API</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="15e2" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">声明购物车API</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="f070" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">配置应用程序</h1><figure class="jw jx jy jz fd hk"><div class="bz dy l di"><div class="ml mm l"/></div></figure></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="16d9" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">运行应用程序</h1><p id="0ce9" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb ms jd je jf mt jh ji jj mu jl jm jn hb bi translated">我们需要运行PostgresSQL数据库</p><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="4490" class="mf kn ht mb b fi mg mh l mi mj">$ docker run -d --rm --name my_reative_db -e POSTGRES_USER=user -e POSTGRES_PASSWORD=password -e POSTGRES_DB=my_db -p 5432:5432 postgres:10.5</span></pre><p id="7a11" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用实时编码预览运行quarkus应用程序</p><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="0803" class="mf kn ht mb b fi mg mh l mi mj">$ ./mvnw compile quarkus:dev</span></pre></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="6074" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">卷曲示例</h1><p id="62cd" class="pw-post-body-paragraph iq ir ht is b it lm iv iw ix ln iz ja jb ms jd je jf mt jh ji jj mu jl jm jn hb bi translated">获取所有购物车</p><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="a18b" class="mf kn ht mb b fi mg mh l mi mj">$ curl -X GET "<a class="ae kl" href="http://localhost:8080/v1/carts" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/v1/carts</a>"</span></pre><p id="174f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将产品添加到购物车</p><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="9fe5" class="mf kn ht mb b fi mg mh l mi mj">$ curl -X PUT "http://localhost:8080/v1/carts/1/1"</span></pre></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="0140" class="km kn ht bd ko kp mn kr ks kt mo kv kw kx mp kz la lb mq ld le lf mr lh li lj bi translated">购物车REST API的响应</h1><pre class="jw jx jy jz fd ma mb mc md aw me bi"><span id="ae87" class="mf kn ht mb b fi mg mh l mi mj">[<br/>  {<br/>    "cartItems": [<br/>      {<br/>        "product": {<br/>          "createdAt": "2021-06-06T08:45:48Z",<br/>          "description": "description",<br/>          "id": 1,<br/>          "title": "Product1",<br/>          "updatedAt": "2021-06-06T08:45:48Z"<br/>        },<br/>        "quantity": 1<br/>      }<br/>    ],<br/>    "cartTotal": 1,<br/>    "id": 1,<br/>    "name": "MyCart"<br/>  }<br/>]</span></pre><p id="a7b7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用主动模式和Panache可以证明一些好处，但是，根据应用程序的性质，人们可能更喜欢存储库模式。需要其他实体参与的更复杂的关系可能表明这种方法更反模式。更多的例子和请求可以在GitHub repo中找到。</p><p id="acc2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae kl" href="https://github.com/dvddhln/quarkus-reactive-crud-hibernate-active-pattern" rel="noopener ugc nofollow" target="_blank">在这里找到GitHub源码项目</a></p><p id="173e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">祝你好运！</p></div></div>    
</body>
</html>
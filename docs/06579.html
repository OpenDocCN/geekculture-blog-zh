<html>
<head>
<title>Train a custom YOLOv4 object detector on Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Windows上训练自定义YOLOv4对象检测器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/train-a-custom-yolov4-object-detector-on-windows-fe5332b0ca95?source=collection_archive---------5-----------------------#2021-08-24">https://medium.com/geekculture/train-a-custom-yolov4-object-detector-on-windows-fe5332b0ca95?source=collection_archive---------5-----------------------#2021-08-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="349c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">(初学者教程)</h2></div><h1 id="107a" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">我在YouTube上的视频！</h1><figure class="jp jq jr js fd jt"><div class="bz dy l di"><div class="ju jv l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="d0ee" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">在本教程中，我们将使用YOLOv4和Darknet在我们的Windows系统上训练一个用于遮罩检测的自定义对象检测器</h1><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/aad06281903a5e3cf39c526992276179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A7j2XV3HvL2J0sxO.png"/></div></div></figure><h1 id="b538" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">按照这10个步骤使用YOLOv4训练一个物体检测器</h1><p id="4082" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">(但首先✅Subscribe到我的YouTube频道👉🏻<a class="ae ll" href="https://bit.ly/3Ap3sdi" rel="noopener ugc nofollow" target="_blank">https://bit.ly/3Ap3sdi</a>😁😜)</p><ol class=""><li id="fea5" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk lt lu lv lw bi translated"><a class="ae ll" href="#a863" rel="noopener ugc nofollow">在桌面上创建<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>和<strong class="kr hj"> <em class="lx">训练</em> </strong>文件夹</a></li><li id="e90c" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#4b62" rel="noopener ugc nofollow">打开命令提示符，导航到“<strong class="kr hj"> yolov4 </strong>”文件夹</a></li><li id="d978" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#fcad" rel="noopener ugc nofollow">创建并复制<strong class="kr hj">darknet.exe</strong>文件</a></li><li id="93a2" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#4e42" rel="noopener ugc nofollow">创建&amp;将我们训练需要的文件(即<strong class="kr hj"> obj </strong>数据集、<strong class="kr hj"> yolov4-custom.cfg </strong>、<strong class="kr hj"> obj.data </strong>、<strong class="kr hj"> obj.names </strong>、<strong class="kr hj"> process.py </strong>)复制到你的<strong class="kr hj"><em class="lx">yolov 4</em></strong>dir</a></li><li id="df16" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#3531" rel="noopener ugc nofollow">将<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>目录下的“<strong class="kr hj"> yolov4-custom.cfg </strong>”、“<strong class="kr hj"> obj.data </strong>”、“<strong class="kr hj"> obj.names </strong>”、“<strong class="kr hj"> process.py </strong>”文件和<strong class="kr hj">obj</strong>文件夹从<strong class="kr hj"><em class="lx">yolov 4</em></strong>目录下复制到<strong class="kr hj"> <em class="lx"> darknet </em> </strong>目录下【T55</a></li><li id="ee16" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#e074" rel="noopener ugc nofollow">运行<strong class="kr hj"> process.py </strong> python脚本创建<strong class="kr hj">train . txt</strong>&amp;<strong class="kr hj">test . txt</strong>文件</a></li><li id="824c" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#b7d5" rel="noopener ugc nofollow">下载预先训练好的<strong class="kr hj"> YOLOv4 </strong>重量</a></li><li id="e784" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#acc4" rel="noopener ugc nofollow">训练探测器</a></li><li id="5fcb" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#bc40" rel="noopener ugc nofollow">检查性能</a></li><li id="36ab" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk lt lu lv lw bi translated"><a class="ae ll" href="#23a6" rel="noopener ugc nofollow">测试您的自定义对象检测器</a></li></ol><h1 id="6124" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~开始吧！！~~~~~~~~~~~~~~</h1><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/d40eb91af7c30e483b314e4a277f086d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*7kyWKERkO2yFnN99.gif"/></div></figure><h1 id="a863" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">1)创建“yolov4”和“training”文件夹</h1><p id="1a7d" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">在桌面上创建一个名为<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>的文件夹。接下来，在 <strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>文件夹内创建另一个名为<strong class="kr hj"><em class="lx">training</em></strong><em class="lx">的文件夹。这是我们将保存我们训练过的权重的地方(这个路径在我们稍后将上传的<strong class="kr hj"> <em class="lx"> obj.data </em> </strong>文件中提到)</em></p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es me"><img src="../Images/b72c7fbb8f6185259c6d9483a92b3ff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/0*uj54UjXnFyNYxYzh.png"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="4b62" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">2)打开命令提示符并导航到“yolov4”文件夹</h1><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="8e0d" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">Navigate to C:\Users\zizou\Desktop\yolov4 folder</strong>. <br/><strong class="mg hj">NOTE:</strong> Replace zizou here with your Username</span><span id="e83f" class="mk iy hi mg b fi mp mm l mn mo"><strong class="mg hj">cd C:\Users\zizou\Desktop\yolov4</strong></span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/224384c73b5abfe8578654770b08b2be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sqFf9FWRcKz5lShE.png"/></div></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="fcad" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">3)创建并复制darknet.exe文件</h1><p id="46db" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">创建你的<strong class="kr hj"> <em class="lx"> darknet </em> </strong>文件夹，包含【darknet.exe】文件到<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>文件夹。要了解如何使用CMake创建包含darknet.exe文件的darknet文件夹，请访问<a class="ae ll" href="https://techzizou007.medium.com/yolov4-darknet-installation-and-usage-on-your-system-windows-linux-8dec2cea6e81" rel="noopener"> <strong class="kr hj">本博客</strong> </a>。按照所有的步骤在Windows上安装YOLO。</p><p id="b752" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">这一步可能有点乏味，但这是整个过程中最困难的部分。下面剩下的训练过程相当简单。因此，请确保您仔细按照上面文章中的所有步骤来创建darknet，并在您的系统上安装和配置CUDA和cuDNN。你会在上面提到的博客的A部分找到详细解释的所有步骤。你也可以在上面提到的博客的YouTube视频部分下面查看我的YOLO Windows安装视频。</p><p id="d074" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">上述过程完成后，将我们从中获取的<strong class="kr hj"><em class="lx">darknet-master</em></strong>文件夹复制到你桌面上的<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>文件夹。为简单起见，将<strong class="kr hj"><em class="lx">darknet-master</em></strong>文件夹重命名为<strong class="kr hj"> <em class="lx"> darknet </em> </strong>。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es mt"><img src="../Images/1b69da7c6493e610faed5a01881f1e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/0*j_ZaxZXc7w4vysK_.png"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="4e42" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">4)创建并复制以下文件，我们需要这些文件来训练自定义检测器</h1><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="f0f5" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">a. Labeled Custom Dataset<br/>b. Custom cfg file<br/>c. obj.data and obj.names files<br/>d. process.py file (to create train.txt and test.txt files for training)</strong></span><span id="4887" class="mk iy hi mg b fi mp mm l mn mo">I have uploaded my custom files for mask detection on my <a class="ae ll" href="https://github.com/techzizou/yolov4-custom-training_LOCAL" rel="noopener ugc nofollow" target="_blank"><strong class="mg hj">GitHub</strong></a><strong class="mg hj">. </strong>I am working with 2 classes i.e. “with_mask” and “without_mask”.</span></pre><h2 id="1bb7" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">标注数据集</h2><p id="b624" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">输入图像示例(<strong class="kr hj">Image1.jpg</strong>)</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es nh"><img src="../Images/39cc6515e2117ccb47da9af5d416fcc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/0*aVIB6Ypg_JP5gizc.jpeg"/></div></figure><p id="f241" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">您可以使用任何软件进行贴标，如<a class="ae ll" href="https://github.com/tzutalin/labelImg#labelimg" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hj">贴标机</strong> </a>工具。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/f0315f038959fd7bd8e9b9c98bb78984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uWsuNAGhAvUE_6wO.png"/></div></div></figure><p id="8ac0" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">我使用一个叫做<strong class="kr hj"> OpenLabeling </strong>的开源标签工具，它有一个非常简单的UI。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/b28063e85253c8c588b1a80e1abb7eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*zgtVzgxjFUi8hgo1.gif"/></div></figure><p id="602d" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">点击下面的链接，了解更多关于贴标过程和其他软件的信息:</p><p id="7f0e" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><a class="ae ll" rel="noopener" href="/analytics-vidhya/image-dataset-labeling-annotation-bec3390eda2d"> <strong class="kr hj">影像数据集标注条</strong> </a></p><p id="3f24" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">注:</strong>垃圾进=垃圾出。选择和标记图像是最重要的部分。尽量找质量好的图片。数据的质量在很大程度上决定了结果的质量。</p><p id="dc07" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">标有file的输出YOLO格式如下所示。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ni"><img src="../Images/e38db0220adfb965eb4f39d690b76f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5UEuleKKmAOlFpp7.png"/></div></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="596e" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">4(a)创建带标签的自定义数据集“obj”文件夹，并将其复制到“yolov4”文件夹</h1><p id="062f" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">把所有输入的图像”。jpg "文件及其对应的YOLO格式标注"。txt "文件放在名为<strong class="kr hj"> obj </strong>的文件夹中。将其复制到<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>文件夹中。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es nj"><img src="../Images/3277c537fff7403fb9e23657bb0489d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/0*suy-psyzBI6UTFss.png"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="8578" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">4(b)创建您的自定义配置文件，并将其复制到“yolov4”文件夹中</h1><p id="7336" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">从<strong class="kr hj"> <em class="lx"> darknet/cfg </em> </strong>目录<em class="lx">，</em>下载<strong class="kr hj"><em class="lx">yolov 4-custom . CFG</em></strong>文件，并对其进行修改，复制到<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>目录。</p><p id="254a" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">你也可以从官方<a class="ae ll" href="https://www.github.com/AlexeyAB/darknet" rel="noopener ugc nofollow" target="_blank"> AlexeyAB Github </a>下载定制配置文件。</p><p id="5038" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">您需要在您的自定义配置文件中进行以下更改:</strong></p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es nk"><img src="../Images/6b206bc68297ec482dbc51f1fe047b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/0*IJrG7BFaqlUzd3rA.png"/></div></figure><ul class=""><li id="19da" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated">将行批更改为批=64</li><li id="c4a7" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将线细分改为细分=16 <strong class="kr hj">或</strong>细分=32 <strong class="kr hj">或</strong>细分=64(阅读本节后的注释以了解更多关于这些值的信息)</li><li id="2377" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">设置网络大小宽度=416高度=416或32的任意倍数</li><li id="540d" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将行max_batches更改为(类*2000，但不小于训练图像数，且不小于6000)，例如，如果训练3个类，max_batches=6000</li><li id="ae0a" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将生产线步骤更改为max_batches的80%和90%，即步骤=4800，5400</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es nm"><img src="../Images/feee88e6bbe49278329dfa367ac3150a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4rELd2t5StZD6c8q.png"/></div></div></figure><ul class=""><li id="9190" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated">在每个[yolo]层之前的<strong class="kr hj"> 3 </strong> <strong class="kr hj">【卷积】</strong>中，将[filters=255]更改为filters=(classes + 5)x3，请记住，它只需是每个[yolo]层之前的最后一个[卷积]。</li><li id="0171" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">在每个<strong class="kr hj">3【yolo】</strong>层中，将线条类别=80改为你的对象数量。</li></ul><p id="b97a" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">因此，如果classes=1，那么它应该是filters=18。如果classes=2，则编写filters=21。</p><p id="0711" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">一旦你理解了训练过程的基本原理，你也可以调整其他参数值，如学习率、角度、饱和度、曝光和色调。对于新手来说，以上改动应该足够了。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="1b12" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">注意:什么是细分？</h2><ul class=""><li id="cfed" class="lm ln hi kr b ks kt kv kw ky nn lc no lg np lk nl lu lv lw bi translated">这是我们分成的许多小批量的数量。</li><li id="99dc" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">Batch=64 -&gt;一次迭代加载64幅图像。</li><li id="5fc8" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">细分=8 -&gt;将批次分为8个小批次，因此每个小批次有64/8 = 8个图像，这8个图像被发送进行处理。该过程将被执行8次，直到该批完成，并且新的迭代将从64个新图像开始。</li><li id="95b8" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">如果您使用的是低内存的GPU，请为细分设置一个较高的值(32或64)。这显然需要更长的时间来训练，因为我们正在减少加载的图像数量以及小批量的数量。</li><li id="14f2" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">如果您有一个高内存的GPU，设置一个较低的细分值(16或8)。这将加速训练过程，因为每次迭代加载更多的图像。</li></ul></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="a0f5" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">4(c)创建你的“obj.data”和“obj.names”文件，并将它们复制到yolov4文件夹中</h1><h2 id="8cd3" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">对象数据</h2><p id="68fd" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated"><strong class="kr hj"> <em class="lx"> obj.data </em> </strong>文件有:</p><ul class=""><li id="cb5f" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated">班级的数量。</li><li id="ee23" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">我们后面要创建的<strong class="kr hj"> <em class="lx"> train.txt </em> </strong>和<strong class="kr hj"> <em class="lx"> test.txt </em> </strong>文件的路径。</li><li id="8b59" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">路径为"<strong class="kr hj"><em class="lx"/></strong>obj . names "文件，其中包含了类的名称。</li><li id="02b1" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">保存训练权重的<strong class="kr hj"> <em class="lx">训练</em> </strong>文件夹的路径。</li></ul><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="243a" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">classes = 2<br/>train = data/train.txt<br/>valid = data/test.txt<br/>names = data/obj.names<br/>backup = ../training</strong></span></pre><h2 id="c6da" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">对象名称</h2><p id="5303" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">包含对象的名称，每个名称占一行。确保分类的顺序与标记图像时使用的class_list.txt文件中的顺序相同，以便每个分类的索引id与标记的YOLO文本文件中提到的相同。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es nq"><img src="../Images/9d741dec56ecd95365438e5661eb9cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/0*AjZGu6zmq6tj38xC.png"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="2c3a" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">4(d)将<process.py>脚本文件复制到你的yolov4文件夹</process.py></h1><p id="2f41" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">(将所有图像文件分成2部分。90%用于训练，10%用于测试)</p><p id="2181" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">这个<strong class="kr hj"> <em class="lx"> process.py </em> </strong>脚本创建了文件<strong class="kr hj"><em class="lx">train . txt</em></strong>&amp;<strong class="kr hj"><em class="lx">test . txt</em></strong>其中<strong class="kr hj"> <em class="lx"> train.txt </em> </strong>文件具有指向90%图像的路径，而<strong class="kr hj"> <em class="lx"> test.txt </em> </strong>具有指向10%图像的路径。</p><p id="6714" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">可以从我的<a class="ae ll" href="https://github.com/techzizou/yolov4-custom-training_LOCAL" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hj"> GitHub </strong> </a> <strong class="kr hj">下载<strong class="kr hj"> <em class="lx"> process.py </em> </strong>脚本。</strong></p><p id="1dd4" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">* *重要提示:“<em class="lx">process . py”</em>脚本只有。jpg "格式写在里面，所以其他格式如"。png“，”。jpeg”，甚至是”。JPG”(大写)不会被承认。如果您使用任何其他格式，请在<em class="lx"> process.py </em>脚本中进行相应的更改。</strong></p><figure class="jp jq jr js fd jt"><div class="bz dy l di"><div class="nr jv l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="75cf" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">现在我们已经上传了所有的文件，我们桌面上的<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>文件夹应该是这样的:</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es ns"><img src="../Images/6604b2457fd1383c596d9cd60e628528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/0*m3j6LZzrdPMkLqAf.png"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="3531" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">5)将所有文件从'<code class="du nt nu nv mg b">yolov4'</code>目录复制到' yolov4/darknet '目录</h1><p id="2dea" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">你可以通过文件浏览器手动完成所有这些步骤。</p><p id="1fc1" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">首先，清理<strong class="kr hj"> <em class="lx">数据</em> </strong>和<strong class="kr hj"> <em class="lx"> cfg </em> </strong>文件夹，除了<strong class="kr hj"><em class="lx"/></strong>文件夹内的<strong class="kr hj">标签</strong>文件夹，这是在检测盒上写标签名称所需要的。因此，只需从<strong class="kr hj"> <em class="lx"> data </em> </strong>文件夹中删除除<strong class="kr hj"> <em class="lx"> labels </em> </strong>文件夹之外的所有文件，然后，完全清理<strong class="kr hj"> <em class="lx"> cfg </em> </strong>文件夹，因为我们已经在<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong>主文件夹中有了我们的自定义配置文件。</p><p id="99bf" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">接下来，复制所有文件:</p><ul class=""><li id="b985" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated">将<strong class="kr hj"> yolov4-custom.cfg </strong>复制到<strong class="kr hj"> <em class="lx"> darknet/cfg </em> </strong>目录下。</li><li id="5597" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将<strong class="kr hj"> obj.names </strong>、<strong class="kr hj"> obj.data </strong>和<strong class="kr hj"> obj </strong>文件夹复制到<strong class="kr hj"> <em class="lx"> darknet/data </em> </strong>目录下。</li><li id="303c" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将<strong class="kr hj"> process.py </strong>复制到<strong class="kr hj"> <em class="lx"> darknet </em> </strong>目录下。</li></ul><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ki"><img src="../Images/e63d996d61910ffd8f37272b67176bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZZzDjErVxCT3F_m-.png"/></div></div></figure><p id="0361" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">或</strong></p><p id="dda1" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">使用命令提示符和以下命令来完成此操作。当前工作目录是<strong class="kr hj">C:\ Users \ zizou \ Desktop \ yolov 4 \ darknet</strong></p><p id="374d" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">清理<em class="lx">数据</em>和<em class="lx"> cfg </em>文件夹。</strong></p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="3420" class="mk iy hi mg b fi ml mm l mn mo">#change dir to data folder and clean it. Delete all files and folders except the labels folder <br/><strong class="mg hj">cd data/ <br/>FOR %I IN (*) DO IF NOT %I == labels DEL %I <br/>cd ..</strong>  </span><span id="bfb7" class="mk iy hi mg b fi mp mm l mn mo">#delete the cfg dir <br/><strong class="mg hj">rmdir /s cfg</strong> <br/>#Are you sure (Y/N)? press y and enter  </span><span id="3ad4" class="mk iy hi mg b fi mp mm l mn mo">#create a new cfg folder <br/><strong class="mg hj">mkdir cfg</strong></span></pre><p id="1cd1" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">5(a)复制<strong class="kr hj"> <em class="lx"> obj </em> </strong>文件夹，使其现在位于<strong class="kr hj"> /darknet/data/ </strong>文件夹中</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="57a7" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">xcopy ..\obj data\obj</strong></span><span id="a58e" class="mk iy hi mg b fi mp mm l mn mo"># In the following prompt, press D for Directory</span></pre><p id="2dac" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj"> *在提示符下，按D键进入目录</strong></p><p id="4611" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">5(b)复制您的<strong class="kr hj"><em class="lx">yolov 4-custom . CFG</em></strong>文件，使其现在位于<strong class="kr hj"> /darknet/cfg/ </strong>文件夹中</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="71b2" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">copy ..\yolov4-custom.cfg cfg</strong></span><span id="1017" class="mk iy hi mg b fi mp mm l mn mo">5(c) Copy the <strong class="mg hj"><em class="lx">obj.names</em></strong> and <strong class="mg hj"><em class="lx">obj.data</em></strong> files so that they are now in <strong class="mg hj">/darknet/data/</strong> folder</span></pre><p id="3db8" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">5(c)复制<strong class="kr hj"> <em class="lx"> obj.names </em> </strong>和<strong class="kr hj"> <em class="lx"> obj.data </em> </strong>文件，使它们现在位于<strong class="kr hj"> /darknet/data/ </strong>文件夹中</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="6290" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">copy ..\obj.names data<br/>copy ..\obj.data  data</strong></span></pre><p id="1f58" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">5(d)将<strong class="kr hj"> <em class="lx"> process.py </em> </strong>文件复制到当前<strong class="kr hj"> <em class="lx"> darknet </em> </strong>目录下</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="7a3f" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">copy ..\process.py .</strong></span></pre></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="e074" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">6)运行process.py python脚本，在数据文件夹中创建train.txt &amp; test.txt文件</h1><p id="6601" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">当前工作目录是<strong class="kr hj">C:\ Users \ zizou \ Desktop \ yolov 4 \ darknet</strong></p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="d03b" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">python process.py</strong></span></pre><p id="12cb" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">列出<strong class="kr hj"> <em class="lx">数据</em> </strong>文件夹的内容，检查<strong class="kr hj">train . txt</strong>&amp;<strong class="kr hj">test . txt</strong>文件是否已经创建。</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="e29d" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">dir data</strong></span></pre><p id="1b34" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">上面的<strong class="kr hj"> process.py </strong>脚本创建了两个文件<strong class="kr hj"> train.txt </strong>和<strong class="kr hj"> test.txt </strong>，其中<strong class="kr hj"> train.txt </strong>有指向90%图像的路径，而<strong class="kr hj"> test.txt </strong>有指向10%图像的路径。这些文件如下所示。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es nw"><img src="../Images/776b6d48198c847266cd2b404ff35233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yuFWduz-x673CUt0.png"/></div></div></figure><h1 id="b7d5" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">7)将预先训练好的YOLOv4权重下载复制到“yolov4\darknet”目录下。</h1><p id="cd83" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">当前工作目录是<strong class="kr hj">C:\ Users \ zizou \ Desktop \ yolov 4 \ darknet</strong></p><p id="35f8" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">这里我们用迁移学习。我们没有从头开始训练模型，而是使用预先训练的YOLOv4权重，这些权重已经被训练到137个卷积层。从这里 下载YOLOv4预训练权重文件<a class="ae ll" href="https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hj">，并将其复制到您的<strong class="kr hj"> <em class="lx"> darknet </em> </strong>文件夹中。</strong></a></p><p id="324a" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><a class="ae ll" href="https://github.com/AlexeyAB/darknet/releases/download/darknet_yolo_v3_optimal/yolov4.conv.137" rel="noopener ugc nofollow" target="_blank"> <strong class="kr hj"> yolov4.conv.137预训练权重文件</strong> </a></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="acc4" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">8)培训</h1><h2 id="bb36" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">训练您的定制检测器</h2><p id="7e46" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">当前工作目录是<strong class="kr hj">C:\ Users \ zizou \ Desktop \ yolov 4 \ darknet</strong></p><p id="5cdd" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">为了获得最佳结果，如果可能的话，当平均损失小于0.05或者至少持续低于0.3时，应该停止训练，否则训练模型，直到平均损失暂时没有任何显著变化。</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="3714" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector train data/obj.data cfg/yolov4-custom.cfg yolov4.conv.137 -dont_show -map</strong></span><span id="881e" class="mk iy hi mg b fi mp mm l mn mo">#The <strong class="mg hj">map</strong> parameter here gives us the <strong class="mg hj">M</strong>ean <strong class="mg hj">A</strong>verage <strong class="mg hj">P</strong>recision. The higher the <strong class="mg hj">mAP</strong> the better it is for object detection. You can remove the <strong class="mg hj">-dont_show</strong> parameter to see the progress chart of mAP-loss against iterations.</span></pre><p id="697b" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">你可以访问官方的AlexeyAB Github页面，它给出了关于何时停止训练的详细解释。点击下面的链接跳转到该部分。</p><p id="2f21" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><a class="ae ll" href="https://github.com/AlexeyAB/darknet/#user-content-when-should-i-stop-training" rel="noopener ugc nofollow" target="_blank"> AlexeyAB GitHub什么时候停止训练？</a></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="3f01" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">重新开始训练(以防训练没有结束，训练过程中断)</h2><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es nx"><img src="../Images/ccd49581fd59ea0dc0dac49e63c43220.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/0*2ONLpZJafMvitj44.jpeg"/></div></figure><p id="1691" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">如果训练过程因某种原因中断或停止，您不必再次从头开始训练您的模型。你可以从你停止的地方重新开始训练。使用上次保存的重量。在<strong class="kr hj"> <em class="lx"> yolov4 </em> </strong> dir内的 <strong class="kr hj"> training </strong>文件夹中，每100次迭代将权重保存为<strong class="kr hj">yolov 4-custom _ last . weights</strong><em class="lx">。(我们在“obj.data”文件中作为备份给出的路径)。</em></p><p id="ea67" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">因此，要重新开始训练，请运行以下命令:</strong></p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="42e0" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector train data/obj.data cfg/yolov4-custom.cfg ../training/yolov4-custom_last.weights -dont_show -map</strong></span></pre></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="bc40" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">9)检查性能</h1><h2 id="9493" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">查看培训图表</h2><p id="cce8" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">您可以通过查看chart.png文件中的<strong class="kr hj"> <em class="lx">来检查所有训练过的砝码的性能。然而，<strong class="kr hj"><em class="lx">chart.png</em></strong>文件仅在训练没有中断的情况下显示结果，即，如果您没有断开连接或丢失会话。如果从保存的点重新开始训练，这将不起作用。</em></strong></p><p id="e405" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">打开<strong class="kr hj"> <em class="lx">暗网</em> </strong>目录下的<strong class="kr hj">chart.png</strong>文件。</p><p id="7f54" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">如果这不起作用，还有其他方法来检查你的表现。其中之一是通过检查训练权重的地图。</p><h2 id="b02b" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">检查地图(平均精度)</h2><p id="04eb" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">您可以检查每1000次迭代保存的所有权重的贴图，例如:- yolov4-custom_4000.weights、yolov4-custom_5000.weights、yolov4-custom_6000.weights等等。这样，您可以找出哪个权重文件给你最好的结果。地图越高越好。</p><p id="1840" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">运行以下命令来检查特定已保存权重文件的映射，其中<strong class="kr hj"> xxxx </strong>是其迭代编号。(例如:- 4000，5000，6000，…)</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="f00c" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector map data/obj.data cfg/yolov4-custom.cfg ../training/yolov4-custom_xxxx.weights -points 0</strong></span></pre></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="23a6" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">10)测试您的自定义对象检测器</h1><h2 id="c242" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">对自定义配置文件进行更改，将其设置为测试模式</h2><ul class=""><li id="fc3c" class="lm ln hi kr b ks kt kv kw ky nn lc no lg np lk nl lu lv lw bi translated">将行批更改为批=1</li><li id="b2be" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">将线细分改为细分=1</li></ul><p id="7102" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">您可以手动完成，也可以简单地运行下面的代码</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="6334" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">cd cfg<br/>sed -i 's/batch=64/batch=1/' yolov4-custom.cfg<br/>sed -i 's/subdivisions=32/subdivisions=1/' yolov4-custom.cfg<br/>cd ..</strong></span></pre><p id="8ec8" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><strong class="kr hj">注意:</strong>根据您在cfg文件中的设置，在上面的命令中将第一个细分值设置为16 / 32 / 64。此外，要在Windows中使用“sed”或其他Unix命令，您需要使用Cygwin或GnuWin32安装它们。</p><h2 id="99a3" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">对图像运行检测器</h2><p id="ea6a" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">将图像上传到桌面上名为<strong class="kr hj"> <em class="lx"> mask_test_images </em> </strong>的文件夹中。</p><p id="686b" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">使用此命令对图像运行您的自定义检测器。(阈值标志设置对象检测所需的最低精度)</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="2cfa" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector test data/obj.data cfg/yolov4-custom.cfg ../training/yolov4-custom_best.weights ../../mask_test_images/image1.jpg -thresh 0.3</strong></span></pre><p id="ad19" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">其输出保存为<strong class="kr hj"> <em class="lx"> darknet </em> </strong>文件夹中的<strong class="kr hj">predictions.jpg</strong>。您可以将其复制到任何输出文件夹，并用不同的名称保存。我将它作为<strong class="kr hj"> output_image.jpg </strong>保存在<strong class="kr hj"><em class="lx">mask _ test _ images</em></strong>文件夹本身中。</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="71dc" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">copy predictions.jpg ..\..\mask_test_images\output_image.jpg</strong></span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="er es ny"><img src="../Images/2abecff971deb50e3fe178df7c5d4413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Li_ybQ7V3jVQqWpJ.jpg"/></div></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="7630" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">对视频运行检测器</h2><p id="7faa" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">将视频上传到桌面上名为<strong class="kr hj"><em class="lx">mask _ test _ videos</em></strong>的文件夹中。</p><p id="1a8b" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">使用此命令对视频运行您的自定义检测器。(thresh标志设置对象检测所需的最低精度)。这会将输出视频保存在与“<strong class="kr hj"> output.avi </strong>”相同的文件夹中。</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="8540" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector demo data/obj.data cfg/yolov4-custom.cfg ../training/yolov4-custom_best.weights ../../mask_test_videos/test.mp4 -thresh 0.5 -i 0 -out_filename ../../mask_test_videos/output.avi</strong></span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/ed06fe44c05df3f06f63051d080d3dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*tNFojUQpXdnLzOX-.gif"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h2 id="df22" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">在实时网络摄像头上运行检测器</h2><p id="e6e6" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">运行下面的代码。</p><pre class="jp jq jr js fd mf mg mh mi aw mj bi"><span id="ba93" class="mk iy hi mg b fi ml mm l mn mo"><strong class="mg hj">darknet.exe detector demo data/obj.data cfg/yolov4-custom.cfg ../training/yolov4-custom_best.weights -thresh 0.5</strong></span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/effa9dacfa73d9a1a62ac05bc64e54f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*t0Ph4lYvyCqiTl2c.gif"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="634c" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">注意:</h1><p id="c88b" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">我收集的用于遮罩检测的数据集主要包含特写图像。你可以在网上搜索更多的长镜头图片。有很多网站可以下载有标签和无标签的数据集。我在数据集来源下面给出了一些链接。我也给出了一些掩膜数据集的链接。其中一些有超过10，000张图片。</p><p id="8678" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">虽然我们可以对我们的训练配置文件进行某些调整和更改，或者通过增强为每种类型的对象类向数据集添加更多图像，但我们必须小心，以免导致过度拟合，从而影响模型的准确性。</p><p id="5e79" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated">对于初学者，你可以简单地使用我上传到GitHub上的配置文件。我还上传了我的掩模图像数据集和YOLO格式的文本文件，这可能不是最好的，但会给你一个如何使用YOLO训练你自己的自定义探测器模型的良好开端。你可以找到一个质量更好的带标签的数据集或者一个不带标签的数据集，以后自己标注。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/1f52e2396dc2672f835f6d527a16a50d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*5ZFcxh-eT988T-7y.gif"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="329b" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">GitHub链接</h1><p id="0fcc" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">我已经在下面的GitHub链接上传了在Windows中训练一个定制的YOLOv4探测器所需的所有文件。</p><p id="60c7" class="pw-post-body-paragraph kp kq hi kr b ks lo ij ku kv lp im kx ky mq la lb lc mr le lf lg ms li lj lk hb bi translated"><a class="ae ll" href="https://github.com/techzizou/yolov4-custom-training_LOCAL" rel="noopener ugc nofollow" target="_blank">yolov 4-custom-training _ LOCAL _ MACHINE</a></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="bb90" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">带标签的数据集(obj.zip)</h1><p id="d0db" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated"><a class="ae ll" href="https://www.kaggle.com/techzizou/labeled-mask-dataset-yolo-darknet" rel="noopener ugc nofollow" target="_blank">标记的屏蔽数据集</a></p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="4814" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">关于这个的YouTube视频！</h1><figure class="jp jq jr js fd jt"><div class="bz dy l di"><div class="ju jv l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="2750" class="ix iy hi bd iz ja kd jc jd je ke jg jh io kf ip jj ir kg is jl iu kh iv jn jo bi translated">信用</h1><h2 id="cf7e" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">参考</h2><ul class=""><li id="7333" class="lm ln hi kr b ks kt kv kw ky nn lc no lg np lk nl lu lv lw bi translated"><a class="ae ll" href="https://github.com/AlexeyAB/darknet" rel="noopener ugc nofollow" target="_blank"> Alexey AB GitHub </a></li><li id="5734" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://github.com/pjreddie/darknet" rel="noopener ugc nofollow" target="_blank"> pjreddie Github </a></li><li id="46f4" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://github.com/theAIGuysCode/YOLOv4-Cloud-Tutorial" rel="noopener ugc nofollow" target="_blank">代码Github </a></li><li id="3d79" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://arxiv.org/abs/2004.10934" rel="noopener ugc nofollow" target="_blank">纸质YOLOv4 </a></li><li id="c73e" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank"> pjreddie站点</a></li></ul><h2 id="aa09" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">数据集源</h2><p id="7664" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">您可以从下面提到的网站下载许多对象的数据集。这些网站还包含许多种类的对象的图像以及它们的多种格式的注释/标签，例如YOLO _黑暗网文本文件和帕斯卡_VOC XML文件。</p><ul class=""><li id="86ea" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated"><a class="ae ll" href="https://storage.googleapis.com/openimages/web/index.html" rel="noopener ugc nofollow" target="_blank">通过谷歌打开图像数据集</a></li><li id="a0cb" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://www.kaggle.com/datasets" rel="noopener ugc nofollow" target="_blank"> Kaggle数据集</a></li><li id="ac78" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://public.roboflow.com/" rel="noopener ugc nofollow" target="_blank"> Roboflow公共数据集</a></li><li id="48de" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://www.visualdata.io/discovery" rel="noopener ugc nofollow" target="_blank">可视化数据数据集</a></li></ul><h2 id="fd6b" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">屏蔽数据集源</h2><p id="ed2a" class="pw-post-body-paragraph kp kq hi kr b ks kt ij ku kv kw im kx ky kz la lb lc ld le lf lg lh li lj lk hb bi translated">我将这3个数据集用于我的标记数据集:</p><ul class=""><li id="c3ce" class="lm ln hi kr b ks lo kv lp ky lq lc lr lg ls lk nl lu lv lw bi translated"><a class="ae ll" href="https://github.com/prajnasb/observations" rel="noopener ugc nofollow" target="_blank">般若Github </a></li><li id="4963" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">约瑟夫·尼尔森·罗博弗洛</li><li id="1347" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated"><a class="ae ll" href="https://github.com/X-zhangyang/Real-World-Masked-Face-Dataset" rel="noopener ugc nofollow" target="_blank">X-张洋Github </a></li></ul><h2 id="fc44" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">更多掩膜数据集</h2><ul class=""><li id="606a" class="lm ln hi kr b ks kt kv kw ky nn lc no lg np lk nl lu lv lw bi translated">Prasoonkottarathil ka ggle(20000张图片)</li><li id="e92d" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">ashishjangra 27 ka ggle(12000张图片)</li><li id="eaec" class="lm ln hi kr b ks ly kv lz ky ma lc mb lg mc lk nl lu lv lw bi translated">安德鲁·卡格尔</li></ul><h2 id="5c5e" class="mk iy hi bd iz mu mv mw jd mx my mz jh ky na nb jj lc nc nd jl lg ne nf jn ng bi translated">视频源</h2><ul class=""><li id="7b04" class="lm ln hi kr b ks kt kv kw ky nn lc no lg np lk nl lu lv lw bi translated"><a class="ae ll" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">https://www.pexels.com/</a></li></ul><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es md"><img src="../Images/3415a54ec7dafa33ad3014ea170e2c29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*BOVSHW3ybf6bxFnd.gif"/></div></figure></div></div>    
</body>
</html>
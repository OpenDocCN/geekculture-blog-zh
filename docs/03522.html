<html>
<head>
<title>What the Crypto Market looks like ? — An interactive d3.js Bubble Chart</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">密码市场是什么样的？—交互式d3.js气泡图</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/what-the-crypto-market-looks-like-an-interactive-d3-js-bubble-chart-14a64cd4089e?source=collection_archive---------32-----------------------#2021-06-09">https://medium.com/geekculture/what-the-crypto-market-looks-like-an-interactive-d3-js-bubble-chart-14a64cd4089e?source=collection_archive---------32-----------------------#2021-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/4427dc90a45685c33719539fd533c0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YUYMuLCXaDistny-"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx">Photo by <a class="ae hv" href="https://unsplash.com/@goshua13?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Aragon</a> on <a class="ae hv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="85af" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">数据可视化</strong>是传达数据分析结果的方式。这意味着创造故事，视觉环境，使数据更容易理解。对于我们今天面临的所有大型数据集，它变得越来越重要。</p><p id="c455" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为一名对数据可视化和每一种表示发现的工具都非常感兴趣的数据分析师，我决定深入研究一下著名的JavaScript库<strong class="ix hz"> d3.js </strong>。我最喜欢它的一点是，它允许你按照自己想要的方式创造自己想要的东西。您不会受到库的限制，其他可视化工具可能会有这种情况。</p><p id="722e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我将解释我是如何做这个图表的，并展示一些关于加密市场的结果。</p><p id="c619" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我创建的可视化如下(可在<a class="ae hv" href="https://observablehq.com/d/4af37b5b43cce051" rel="noopener ugc nofollow" target="_blank">观察</a>上获得) :</p><h1 id="b608" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">加密货币市场泡沫图</h1><p id="526c" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated"><strong class="ix hz">2021年6月4日</strong></p><figure class="kw kx ky kz fd hk"><div class="bz dy l di"><div class="la lb l"/></div><figcaption class="hr hs et er es ht hu bd b be z dx">npogeant/observablehq.com</figcaption></figure><p id="4128" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我用HTML，CSS和JavaScript做了这个气泡图，用的是d3.js库，我在最大的交互数据可视化网站<a class="ae hv" href="https://observablehq.com" rel="noopener ugc nofollow" target="_blank"> Observable </a>上导出了我的代码。该网站允许您使用笔记本来创建dataviz。</p><p id="cb46" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我想分析加密货币市场，不是因为我是一个超级密码迷，而是因为这是一个有趣的市场，有很大的变量可以放在图表中。因此，我使用了<a class="ae hv" href="https://coinmarketcap.com" rel="noopener ugc nofollow" target="_blank"> CoinMarketCap </a> API来获取我的数据。基本上，该数据集由2021年6月6日网站上的前100个加密组成。CoinMarketCap根据市值对它们进行排名。你的市值越多，排名就越高。</p><p id="de0e" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们传递到代码…</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h2 id="1804" class="lj ju hy bd jv lk ll lm jz ln lo lp kd jg lq lr kh jk ls lt kl jo lu lv kp lw bi translated">创建气泡图</h2><p id="ed7f" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我不会解释我所做的一切，代码在Observable和我的github的笔记本上，但我会强调它的主要方面。</p><p id="9013" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，我必须处理数据，这是我不得不修改的一个例子:</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="5e6c" class="lj ju hy ly b fi mc md l me mf">market_cap: market_cap.replace(/\,/g, '').replace(/\./g, '').slice(0,-2)</span></pre><p id="4746" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">的确，圆点和逗号是个问题，所以我几乎在每一列都把它们去掉了。</p><p id="fd14" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦数据连接，因为它是一个csv，我必须创建它的层次结构，以便每个节点都可以获得参数，从而可以构建图表。</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="53fe" class="lj ju hy ly b fi mc md l me mf">const root = d3.hierarchy({children: data})<br/> .sum(function(d) { return d['market_cap']; })<br/> .sort(function(a, b) { return b['market_cap'] - a['market_cap']; })</span></pre><p id="7ef9" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的例子中，我用市值变量来表示我的层次结构。</p><p id="21fd" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我创建了svg和所有与节点相关的圆圈(每种货币)。我输入，附加组(g)并使用“转换”属性来放置每个圆。圆圈的大小等于每行的“r”变量(在层次结构中创建)。</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="ef30" class="lj ju hy ly b fi mc md l me mf">const node = svg.selectAll(".node")<br/> .data(pack(root).leaves())<br/> .enter().append("g")<br/>   .attr("class", "node")<br/>   .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })</span><span id="371a" class="lj ju hy ly b fi mg md l me mf"><br/>node.append("circle")<br/>       .data(pack(root).leaves())<br/>      .attr("id", function(d) { return d.id; })<br/>      .attr("r", function(d) { return d.r; })</span></pre><p id="231f" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我通过添加文本来添加标签。第一个是符号变量，第二个是用于创建圆圈的变量，我决定将市值作为图表的初始变量。</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="af0b" class="lj ju hy ly b fi mc md l me mf">node.append("text")<br/>        .attr("class","labels")<br/>        .attr("dy", ".2em")<br/>        .text(function(d) {<br/>            return d.data.symbol ;<br/>        })<br/>        .attr("font-family", "Roboto")<br/>        .attr("font-size", function(d){<br/>            return d.r/5;<br/>        })<br/>        .attr("fill", "white")<br/>        .style("text-anchor", "middle")<br/>  <br/>  node.append("text")<br/>        .attr("class","SecondLabels")<br/>        .attr("dy", "1.8em")<br/>        .text(function(d) {<br/>            return d.data.market_capClean;<br/>        })<br/>        .attr("font-family", "Roboto")<br/>        .attr("font-size", function(d){<br/>            return d.r/7;<br/>        })<br/>        .attr("fill", "white")<br/>        .style("text-anchor", "middle");</span></pre><p id="8bd9" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我还添加了一个以mouseover、mousemove和mouseleave为功能的工具提示。</p><p id="3848" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我希望它是交互式的，允许在泡泡中选择变量。因此，我在svg的不同元素上创建了一个带有一个参数和选择/转换的更新函数。</p><pre class="kw kx ky kz fd lx ly lz ma aw mb bi"><span id="0b80" class="lj ju hy ly b fi mc md l me mf">svg.node().drawData = function updateData(variable) {</span><span id="ca7c" class="lj ju hy ly b fi mg md l me mf">....</span><span id="396b" class="lj ju hy ly b fi mg md l me mf">}</span></pre><p id="5056" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个函数的细节在笔记本中，更新图表数据的变量是通过svg上面的4个单选按钮获得的。</p><p id="1c2d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看图表本身，有趣的是注意到了什么…</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><h2 id="e8dc" class="lj ju hy bd jv lk ll lm jz ln lo lp kd jg lq lr kh jk ls lt kl jo lu lv kp lw bi translated">一些结果</h2><p id="991d" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">加密市场是特殊的，当泡沫由市值组成时，我们直接发现了比特币的优势。大写的第二种货币是以太币，价值是BTC的一半。</p><p id="0e87" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从交易量来看，美元领先是正常的，因为美元是最稳定的货币。比特币和以太坊成交量之间的差异比资本化之间的差异要小得多。</p><p id="5953" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从价格泡沫中，我们注意到了不同的东西。首先，一些硬币是基于比特币的，这解释了为什么比特币不是价格第一的货币。排名第一的是YFI，这是一种由iEarn创造的代币，这是一种发现收益率波动并允许更多流动性的金融工具。</p><p id="ee3b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后的结果来自流通中的硬币供应。我们可以直接发现一枚硬币大大超过了其他硬币:柴犬(SHIB)。这枚硬币几乎和Dogecoin一样，它是一种仅仅基于柴犬形象的代币。这是一个迷因硬币，价格非常低，热情很高，这解释了大量供应的原因。</p></div><div class="ab cl lc ld gp le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="hb hc hd he hf"><p id="f467" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，创建这个图表真的很愉快，我学到了很多东西，也看到了d3是如何构建的。</p><p id="91f8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我希望这是有趣的，你学到了很多东西！</p></div></div>    
</body>
</html>
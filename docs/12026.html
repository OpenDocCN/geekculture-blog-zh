<html>
<head>
<title>How to Speed up Model Training with Snapml</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Snapml加速模型训练</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-speed-up-model-training-with-snapml-b2e24b546fe5?source=collection_archive---------8-----------------------#2022-04-21">https://medium.com/geekculture/how-to-speed-up-model-training-with-snapml-b2e24b546fe5?source=collection_archive---------8-----------------------#2022-04-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4fdb" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用更少的时间训练机器学习模型</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f0f16a69eb672851bba6e4e069e6ea21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a2R9GFLs5jLuC2QgVHU96w.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx"><a class="ae jn" href="https://www.pexels.com/photo/cars-ahead-on-road-593172/" rel="noopener ugc nofollow" target="_blank">Photo by Taras Makarenko from Pexels:</a></figcaption></figure><p id="dcff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">机器学习对解决各种行业的业务问题有着巨大的影响，包括卫生、金融和交通。你可以收集每天创建的大量数据，并为产品推荐和情感分析等特定任务训练机器学习模型。</p><p id="c7cb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">建议您在大型数据集上训练和执行几个机器学习实验，以便拥有有效的机器学习模型。这有其自身的困难，例如需要很长时间来训练模型以达到预期的结果。</p><p id="deb9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本文中，您将了解如何使用snapml python包在短时间内加快训练机器学习模型的过程。</p><p id="0a40" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们开始吧！🚀</p><h1 id="93fb" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">Snapml是什么？</h1><p id="c59c" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">这是IBM开发的一个python包，用于在CPU和GPU计算环境中提供机器学习模型的高速训练。<a class="ae jn" href="https://snapml.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Snampl </a>可以帮助你在机器学习项目中完成以下任务:-</p><ul class=""><li id="d7ee" class="lh li hi jq b jr js ju jv jx lj kb lk kf ll kj lm ln lo lp bi translated">在线对新数据进行训练和再训练。</li><li id="8ec1" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">做大<a class="ae jn" href="https://davis-david.medium.com/alternative-hyperparameter-optimization-techniques-you-need-to-know-part-1-3f68d0448fcd?source=user_profile---------35----------------------------" rel="noopener">参数调谐</a>。</li><li id="621b" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">做出准确的决策和预测。</li><li id="81a3" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">用较少的资源在所有可用的数据上训练模型。</li><li id="4e4d" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">高效处理大数据。</li></ul><p id="f3fb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它还支持不同类型的机器学习模型，如:</p><ul class=""><li id="7ba5" class="lh li hi jq b jr js ju jv jx lj kb lk kf ll kj lm ln lo lp bi translated">广义线性模型(如线性回归)。</li><li id="2254" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">基于树的模型(例如决策树和随机森林)。</li><li id="75ad" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">梯度增压模型(例如增压机)。</li></ul><p id="2e19" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当在云环境中训练模型时，Snapml可以通过加快训练过程在短时间内完成来帮助您降低成本。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lv"><img src="../Images/2c17fa044a0fdd8f71d1439d8a88ff9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4fUKykDrJyjoj0Msu3lfw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">screenshot from <a class="ae jn" href="https://www.zurich.ibm.com/snapml/" rel="noopener ugc nofollow" target="_blank">https://www.zurich.ibm.com/snapml/</a></figcaption></figure><h1 id="09a4" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">如何安装Snapml</h1><p id="8276" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">要安装snapml，请在终端中运行以下命令。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="c1c4" class="mb kl hi lx b fi mc md l me mf">pip install snapml</span></pre><p id="dd87" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong> Snapml目前支持Python 3.7，3.8，3.9。对于macOS用户，目前支持intel(x86_64)架构。</p><h1 id="ad62" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">不带Snapml的训练ML模型</h1><p id="11e7" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在这一部分中，您将首先使用来自<a class="ae jn" rel="noopener" href="/geekculture/scikit-learn-1-0-new-features-in-python-machine-learning-library-d6ffea7b88dc"> scikit-learn库</a>的机器学习算法在大型数据集上训练机器学习模型，并评估在数据集上训练模型所用的总时间。</p><h2 id="8149" class="mb kl hi bd km mg mh mi kq mj mk ml ku jx mm mn kw kb mo mp ky kf mq mr la ms bi translated">导入包</h2><p id="a5db" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">第一步是导入我们将要用来加载数据集、准备数据集和训练机器学习模型的各种重要python包。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="620f" class="mb kl hi lx b fi mc md l me mf"><em class="mt">#import libraris</em></span><span id="01d0" class="mb kl hi lx b fi mu md l me mf"><em class="mt">import</em> numpy <em class="mt">as</em> np<br/><em class="mt">import</em> pandas <em class="mt">as</em> pd</span><span id="9679" class="mb kl hi lx b fi mu md l me mf"><em class="mt">from</em> sklearn.preprocessing <em class="mt">import</em> LabelEncoder<br/><em class="mt">from</em> sklearn.preprocessing <em class="mt">import</em> MinMaxScaler<br/><em class="mt">from</em> sklearn.ensemble <em class="mt">import</em> RandomForestClassifier<br/><em class="mt">from</em> sklearn.model_selection <em class="mt">import</em> cross_val_score</span><span id="465f" class="mb kl hi lx b fi mu md l me mf"><em class="mt">import</em> time<br/><em class="mt">import</em> warnings</span><span id="4a00" class="mb kl hi lx b fi mu md l me mf">warnings.filterwarnings("ignore")<br/>np.random.seed(123)</span></pre><h2 id="e6b6" class="mb kl hi bd km mg mh mi kq mj mk ml ku jx mm mn kw kb mo mp ky kf mq mr la ms bi translated">加载数据集</h2><p id="8274" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">我们将使用银行贷款状态数据集来训练可以对未来贷款状态进行分类的模型。</p><p id="d5d9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从<a class="ae jn" href="https://www.kaggle.com/datasets/zaurbegiev/my-dataset" rel="noopener ugc nofollow" target="_blank">kaggle.com</a>下载数据集。</p><p id="ff82" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要加载数据集，请使用pandas库中的read_csv函数</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="48a9" class="mb kl hi lx b fi mc md l me mf"><em class="mt">#load data</em></span><span id="7ce7" class="mb kl hi lx b fi mu md l me mf">Bank_Dataset = pd.read_csv("../data/credit_train.csv")</span></pre><p id="8ea0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">检查数据集的前几行。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="7818" class="mb kl hi lx b fi mc md l me mf"><em class="mt">#show the first five rows</em></span><span id="ea51" class="mb kl hi lx b fi mu md l me mf">Bank_Dataset.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mv"><img src="../Images/26984b41a5839b3f66c04bd27d8cc5f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4H9BKdFXMF6hiyG-L1Msg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Pandas Dataframe</figcaption></figure><p id="c743" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该数据集有许多显示每个客户获得的贷款详细信息的功能。</p><p id="629d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们检查数据集的形状，以确定其大小。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="6265" class="mb kl hi lx b fi mc md l me mf"># show shape<br/>Bank_Dataset.shape</span></pre><p id="c51f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi">(100514,19)</p><p id="fb90" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">银行贷款状态数据集有超过100，000行数据和19列。这个数据集足够大，可以评估在使用和不使用Snapml的情况下训练模型时的时间差。</p><h2 id="0ac1" class="mb kl hi bd km mg mh mi kq mj mk ml ku jx mm mn kw kb mo mp ky kf mq mr la ms bi translated">准备数据集</h2><p id="d995" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">您需要通过移除不需要的要素、处理缺失值并将所有要素转换为数值来准备数据集。</p><p id="13e5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">(一)移除特征</strong></p><p id="b6c4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这一步中，您将删除贷款ID和客户ID。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="ae4a" class="mb kl hi lx b fi mc md l me mf">#remove ID columns<br/>Bank_Dataset.drop(["Loan ID", "Customer ID"], axis=1, inplace=True)</span></pre><p id="132e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们现在剩下了16个特性和目标列(“贷款状态”)。</p><p id="ac63" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> (b)处理缺失值</strong></p><p id="23bd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">通常，数据集可能会有缺失值，您需要在训练机器学习模型之前处理这些缺失值。下面是检查数据集中每列缺失值数量的代码。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="6222" class="mb kl hi lx b fi mc md l me mf">#check missing values<br/>Bank_Dataset.isnull().sum()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/6948da089df7855587249c3403c324a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jDgo8x6EOTCGB2HH.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Features with the total number of missing values</figcaption></figure><p id="89ba" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们的数据集在所有特性中都有缺失值，包括目标列(“贷款状态”)。</p><p id="140f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下面的代码块将首先使用每个分类列中最常见的值来填充分类列中缺少的值。然后通过使用每个数字列的平均值来填充数字列中缺少的值。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="3c63" class="mb kl hi lx b fi mc md l me mf"># fill missing values for categorical features<br/>Bank_Dataset["Loan Status"].fillna("Fully Paid", inplace=True)<br/>Bank_Dataset["Term"].fillna("Short Term", inplace=True)<br/>Bank_Dataset["Years in current job"].fillna("10+ years", inplace=True)<br/>Bank_Dataset["Home Ownership"].fillna("Home Mortgage", inplace=True)<br/>Bank_Dataset["Purpose"].fillna("Debt Consolidation", inplace=True)</span><span id="73fd" class="mb kl hi lx b fi mu md l me mf"># fill missing values for integers features<br/>intergers_columns = list(<br/>    Bank_Dataset.select_dtypes(include=['floating']).columns)<br/>for column in intergers_columns:<br/>    Bank_Dataset[column].fillna(Bank_Dataset[column].mean(), inplace=True)</span></pre><p id="39e4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> (c)变换数据集</strong></p><p id="bb95" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">处理完数据集中的缺失值后，您需要将数据集转换成数值。</p><p id="e1c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">转换的第一步是使用scikit-learn库中的LabelEncoder方法预处理两个二进制分类列(Term和Loan Status)。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="d624" class="mb kl hi lx b fi mc md l me mf"># preprocess binary categorical columns</span><span id="0c57" class="mb kl hi lx b fi mu md l me mf">le = LabelEncoder()<br/>binary_columns = ["Loan Status", "Term"]<br/>for column in binary_columns:<br/>    Bank_Dataset[column] = le.fit_transform(Bank_Dataset[column])</span></pre><p id="93b1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后，使用pandas库中的<strong class="jq hj"> get_dummies </strong>函数转换多个分类列。此函数将转换数据集中的以下各列。</p><ul class=""><li id="51af" class="lh li hi jq b jr js ju jv jx lj kb lk kf ll kj lm ln lo lp bi translated">房屋所有权</li><li id="1957" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">目的</li><li id="5290" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">目前工作年限</li></ul><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="30d4" class="mb kl hi lx b fi mc md l me mf"># preprocess multiple categorical columns<br/>Bank_Dataset = pd.get_dummies(<br/> Bank_Dataset,<br/> columns=[“Home Ownership”, “Purpose”,“Years in current job”])</span></pre><p id="a738" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> (d)分割特征和目标</strong></p><p id="fd47" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">将数据集拆分为其要素列和目标列。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="ecdc" class="mb kl hi lx b fi mc md l me mf"># split data into target and features<br/>target = Bank_Dataset["Loan Status"].values<br/>features = Bank_Dataset.drop("Loan Status", axis=1)</span></pre><p id="1e08" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> (e)缩放特征</strong></p><p id="8c71" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">变换后的要素具有不同的值范围。您需要通过使用scikit-learn中的MimMaxScaler方法将所有特性归一化到给定的范围0和1。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="9e5c" class="mb kl hi lx b fi mc md l me mf"># scaling the dataset</span><span id="ff90" class="mb kl hi lx b fi mu md l me mf">scaler = MinMaxScaler()<br/>features = scaler.fit_transform(features)</span></pre><h2 id="8753" class="mb kl hi bd km mg mh mi kq mj mk ml ku jx mm mn kw kb mo mp ky kf mq mr la ms bi translated">训练一个机器学习模型</h2><p id="91dc" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">要在没有snapml的情况下训练模型，需要使用以下代码从scikit-learn库中实例化RandomForestclassifer。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="1756" class="mb kl hi lx b fi mc md l me mf">#create a classifier<br/>sklearn_classifier = RandomForestClassifier()</span></pre><p id="c814" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后，在转换后的数据集上训练RandomForestClassifier。我们还会找到训练模型前后的时差。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="bdad" class="mb kl hi lx b fi mc md l me mf"># training classifier</span><span id="9c5f" class="mb kl hi lx b fi mu md l me mf">start_time = time.time()</span><span id="d38f" class="mb kl hi lx b fi mu md l me mf">scores = cross_val_score(sklearn_classifier, features, target, cv=3)</span><span id="f735" class="mb kl hi lx b fi mu md l me mf">print("Training Time: {}".format(time.time() - start_time))<br/>print("Scores: {}".format(scores))</span></pre><p id="c065" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">训练时间:</strong> 55.80186605453491 <br/> <strong class="jq hj">分数:</strong>【0.82122071】0.818827 0.82106614】</p><p id="a2e7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">总的来说，模型性能的准确度约为82%，训练时间为<strong class="jq hj"> 55.80秒</strong>(几乎1分钟)。</p><p id="d137" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们看看如何使用Snapml来加速模型训练。</p><h1 id="e633" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">用Snapml训练ML模型</h1><p id="e973" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">第一步是从snapml包中导入名为RandomForest分类器的监督算法。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="aa03" class="mb kl hi lx b fi mc md l me mf"># add RandomForestClassifier from snapml</span><span id="6105" class="mb kl hi lx b fi mu md l me mf">from snapml import RandomForestClassifier</span></pre><p id="aedf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后实例化分类器。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="b112" class="mb kl hi lx b fi mc md l me mf">snampl_classifier = RandomForestClassifier()</span></pre><p id="7301" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后从snapml训练分类器，评估训练模型前后的时间差。</p><pre class="iy iz ja jb fd lw lx ly lz aw ma bi"><span id="b05a" class="mb kl hi lx b fi mc md l me mf">start_time = time.time()</span><span id="6fed" class="mb kl hi lx b fi mu md l me mf">scores = cross_val_score(snampl_classifier, features, target, cv=3)</span><span id="fce5" class="mb kl hi lx b fi mu md l me mf">print("Training Time with snapml: {}".format(time.time() - start_time))<br/>print("Scores: {}".format(scores))</span></pre><p id="ddfd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">用snapml训练时间:14.426469421387<br/>分数:[0.8106513 0.80947 0.8109181]</p><p id="33f3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">正如你所看到的，使用snapml时的训练时间是<strong class="jq hj"> 14.45秒</strong>，这比使用scikit-learn库训练机器学习模型几乎快<strong class="jq hj"> 4倍</strong>。</p><p id="bf6c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在云环境中训练大规模数据集时，Snapml有很大的潜力，可以节省您的时间和成本。</p><p id="79bb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Snapml支持其他分类模型，您可以在自己的数据集中尝试这些模型，例如:-</p><ul class=""><li id="31cc" class="lh li hi jq b jr js ju jv jx lj kb lk kf ll kj lm ln lo lp bi translated">物流回归</li><li id="2347" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">决策树</li><li id="f4c9" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">支持向量机</li><li id="27a9" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">增压机</li><li id="1e03" class="lh li hi jq b jr lq ju lr jx ls kb lt kf lu kj lm ln lo lp bi translated">成批的树集合。</li></ul><h1 id="4f7d" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">结论</h1><p id="994f" class="pw-post-body-paragraph jo jp hi jq b jr lc ij jt ju ld im jw jx le jz ka kb lf kd ke kf lg kh ki kj hb bi translated">在本文中，您了解了使用大型数据集训练机器学习模型的一些挑战，以及如何使用snampl在短时间内加快训练模型的过程。</p><p id="4374" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">正如我之前所说的，如果您在云环境中训练您的模型，snapml不仅会节省您的时间，还会节省您的金钱。该库将让你有机会执行各种机器学习实验，而不必担心时间不够用。</p><p id="cd38" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你学到了新的东西或者喜欢阅读这篇文章，请与他人分享。在此之前，敬请关注下一篇帖子！</p><p id="e6c3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你也可以在Twitter上找到我<a class="ae jn" href="https://twitter.com/Davis_McDavid?ref=hackernoon.com" rel="noopener ugc nofollow" target="_blank"> @Davis_McDavid </a>。</p><p id="fbd9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">最后一件事:在以下链接中阅读更多类似的文章。</p><div class="mx my ez fb mz na"><a rel="noopener follow" target="_blank" href="/geekculture/top-5-cloud-migration-strategies-you-need-to-know-fb1d92ed3c8a"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">您需要知道的五大云迁移策略</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">如何将您的数据和系统平稳地迁移到云中</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">medium.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no jh na"/></div></div></a></div><div class="mx my ez fb mz na"><a href="https://python.plainenglish.io/how-is-web-crawling-used-in-data-science-a116d883419d" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">数据科学中如何使用Web爬行</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">为您的数据科学项目收集数据的无代码工具</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">python .平原英语. io</p></div></div><div class="nj l"><div class="np l nl nm nn nj no jh na"/></div></div></a></div><div class="mx my ez fb mz na"><a rel="noopener follow" target="_blank" href="/geekculture/top-5-reasons-why-companies-are-moving-to-the-cloud-c3a609332125"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">公司迁移到云的五大原因</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">为什么企业对云的采用增加到了90%</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">medium.com</p></div></div><div class="nj l"><div class="nq l nl nm nn nj no jh na"/></div></div></a></div></div></div>    
</body>
</html>
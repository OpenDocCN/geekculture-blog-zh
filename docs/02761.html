<html>
<head>
<title>Overview of Item-Item Collaborative Filtering Recommendation System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">项目-项目协同过滤推荐系统综述</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/overview-of-item-item-collaborative-filtering-recommendation-system-64ee15b24bb8?source=collection_archive---------20-----------------------#2021-05-25">https://medium.com/geekculture/overview-of-item-item-collaborative-filtering-recommendation-system-64ee15b24bb8?source=collection_archive---------20-----------------------#2021-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="57e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">协同过滤</strong>广泛应用于构建推荐系统。基于记忆的模型主要有两种方法，<strong class="ih hj">基于项目的</strong>和<strong class="ih hj">基于用户的</strong>。在实践中，我们通常会有用户多于条目数量的数据，只有一小部分条目得到频繁评级，这种情况被称为<strong class="ih hj">长尾效应。</strong>长尾效应通常意味着高数据稀疏性，稀疏数据会影响我们模型的准确性。</p><p id="c7f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了解决高稀疏性问题，<strong class="ih hj">基于项目的模型</strong>通常会带来更快的在线学习和更好的推荐。相比之下，基于用户的模型可以更好地检测具有特殊品味的用户。</p><p id="0eb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们将使用基于项目的模型构建一个推荐系统。</p><p id="f7e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">GitHub链接:<a class="ae jd" href="https://github.com/chiang9/Recommendation_system_pyspark/blob/main/Item_based_cf/movielen_item_based_cf.ipynb" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Chiang 9/re commendation _ system _ py spark/blob/main/Item _ based _ cf/movie len _ Item _ based _ cf . ipynb</a></p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="87f2" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">基于项目的协同过滤</h1><p id="6c2a" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">基于项目的协同过滤使用共同评价项目的评价来预测特定项目的评价。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ko"><img src="../Images/86910e411b91d2b9431368b5158ab77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHhGqvPAfH4N4CTlGz3yDA.jpeg"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">Figure 1. item-based collaborative filtering Image by author</figcaption></figure><p id="568d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，我们希望预测用户2对项目2的评分。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es le"><img src="../Images/b5e925b95dea6134d4a62eb5e62b8548.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*pwpD5lhhC_pt3rcCr3rLVA.jpeg"/></div></figure><p id="3297" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了预测评级，</p><ol class=""><li id="8daa" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">找到用户2的共同评定项目，即项目1和项目4</li><li id="2b31" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">计算项目2和项目1、4之间的相似度</li><li id="6560" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">基于相似性和共同评级来计算预测，使得</li></ol><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es lt"><img src="../Images/61878f710a8851f060e40eb463daec24.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/1*z2eA4tLnJ3qIJI4SevuVqA.gif"/></div></figure><p id="2bf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中w是相似度，r是等级值。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lu"><img src="../Images/d96e120f9f704ea3d52828d3cb18fd38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ILyeDF-0lZtwHVHLUsuNA.jpeg"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">Figure 2. process of prediction Image by author</figcaption></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="e83c" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated"><strong class="ak">让我们开始</strong></h1><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es lx"><img src="../Images/0089bd8e520ff8c9e9747ecff34a4703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ee47K0XCI6KaJp37Atpvdg.png"/></div></div></figure><p id="7c9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，我们计算<strong class="ih hj">相似度</strong>。有很多方法可以计算项目之间的相似度，如<strong class="ih hj"> Jaccard相似度、Pearson相关度</strong>…等。</p><p id="43e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们将使用<strong class="ih hj">余弦相似度</strong>。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lv lw l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ly"><img src="../Images/bc0253206cb02e9f0f95087b1d3a2c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p41w5eTcO1qRNAy-3Qky7Q.png"/></div></div></figure><p id="19dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从热图中我们可以看到，由于数据稀疏，数据相似性很低。</p><p id="1bbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将预测用户2对项目3的评价。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lv lw l"/></div></figure><pre class="kp kq kr ks fd lz ma mb mc aw md bi"><span id="94e5" class="me jm hi ma b fi mf mg l mh mi">3.822284928259705</span></pre><p id="a68f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用RMSE来测试我们的模型。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lv lw l"/></div></figure><pre class="kp kq kr ks fd lz ma mb mc aw md bi"><span id="2d1b" class="me jm hi ma b fi mf mg l mh mi">RMSE = 1.0452369678411928</span></pre></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="c2f0" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">建立推荐系统</h1><p id="6c13" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">为了使基于项目的模型成为推荐系统，我们计算特定用户的所有评分。例如，我们想向用户2推荐商品，我们计算所有预测的评分并选择用户2可能喜欢的前n个商品。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="2abf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们将向用户2推荐以下10个项目，然后是预测评级。</p><pre class="kp kq kr ks fd lz ma mb mc aw md bi"><span id="f039" class="me jm hi ma b fi mf mg l mh mi">[(1398, 4.704560704514258),<br/> (861, 4.642353328817946),<br/> (1641, 4.641362312762584),<br/> (1439, 4.603460311402641),<br/> (1123, 4.543079741085078),<br/> (1346, 4.4948279147275025),<br/> (1560, 4.4948279147275025),<br/> (1333, 4.45874227212434),<br/> (774, 4.389151878334362),<br/> (1530, 4.379045803272321)]</span></pre></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="6a2a" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">改进</h1><p id="b42c" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">正如我们从RMSE中看到的，1.045在我们的案例中相对较高，因为评级得分从1到5。在实践中，我们基于项目的模型不足以提供有效的模型。有几种方法可以改进我们的基于项目的模型。</p><h2 id="99b2" class="me jm hi bd jn mj mk ml jr mm mn mo jv iq mp mq jz iu mr ms kd iy mt mu kh mv bi translated">默认投票</h2><p id="daa8" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">关注共同评分的项目(而不是全局)，我们可以分析用户的行为来改变投票的权重。举个例子，</p><ol class=""><li id="b8dc" class="lf lg hi ih b ii ij im in iq lh iu li iy lj jc lk ll lm ln bi translated">减少具有少于50个费率历史的用户的权重</li><li id="f00e" class="lf lg hi ih b ii lo im lp iq lq iu lr iy ls jc lk ll lm ln bi translated">使用一小组共同评分项目的平均值作为默认投票，以延长用户的投票历史</li></ol><h2 id="b159" class="me jm hi bd jn mj mk ml jr mm mn mo jv iq mp mq jz iu mr ms kd iy mt mu kh mv bi translated">案例放大</h2><p id="d5c2" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">放大每一票的权重。我们放大高相似性并惩罚低相似性评级，这样</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es mw"><img src="../Images/58bad27362a1359356f53b67380eca3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:118/1*U_s_iBpvl1GvIyDJxmdCAw.gif"/></div></figure><h2 id="c8a3" class="me jm hi bd jn mj mk ml jr mm mn mo jv iq mp mq jz iu mr ms kd iy mt mu kh mv bi translated">插补增加了CF</h2><p id="03a5" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">当我们面对一个<strong class="ih hj">极度稀疏的</strong>数据集时，我们可以使用一些插补技术来填补缺失数据，例如，线性回归、SVM、朴素贝叶斯等。</p><h2 id="756a" class="me jm hi bd jn mj mk ml jr mm mn mo jv iq mp mq jz iu mr ms kd iy mt mu kh mv bi translated"><strong class="ak">混合动力车型</strong></h2><p id="e972" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">我们可以与其他推荐系统模型结合形成一个混合模型，例如我们可以考虑基于用户模型的预测，并给出一个更好的结果。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h1 id="27dc" class="jl jm hi bd jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki bi translated">结论</h1><p id="e0b9" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在实践中，仅仅实现基于项目的模型是不够的，我们需要根据数据集结合其他策略。在下一篇文章中，我们将增强基于项目的模型。</p><p id="18d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝你有愉快的一天。</p><p id="205f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">了解更多:</strong></p><div class="mx my ez fb mz na"><a href="https://neptune.ai/blog/how-to-test-recommender-system" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">如何测试一个推荐系统——Neptune . ai</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">推荐系统从根本上解决了这个问题——人们想要什么？虽然这是一个广泛的问题，但在…</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">海王星. ai</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no ky na"/></div></div></a></div><div class="mx my ez fb mz na"><a href="https://jchiang1225.medium.com/improve-the-item-item-collaborative-filtering-bf74e18fd7d1" rel="noopener follow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hj fi z dy nf ea eb ng ed ef hh bi translated">改进项目-项目协同过滤</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">改善项目-项目协同过滤的方法…</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">jchiang1225.medium.com</p></div></div><div class="nj l"><div class="np l nl nm nn nj no ky na"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Inspired | Youtube Spam Purge almost Chrome Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">启发| Youtube垃圾邮件清除几乎铬扩展</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/inspired-youtube-spam-purge-almost-chrome-extension-c1b760fa8415?source=collection_archive---------16-----------------------#2021-11-08">https://medium.com/geekculture/inspired-youtube-spam-purge-almost-chrome-extension-c1b760fa8415?source=collection_archive---------16-----------------------#2021-11-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="fd85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我受到了这个<a class="ae jd" href="https://www.youtube.com/watch?v=-vOakOgYLUI&amp;t=776s&amp;ab_channel=ThioJoe" rel="noopener ugc nofollow" target="_blank">视频</a>的启发，度过了一个自由的周末，我想我会以自己的方式尝试一下。因此，考虑到这一点，我想我可以创建一个更容易使用的Chrome扩展。嗯，事情是这样的。</p><p id="fe98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">免责声明:我对JavaScript或Web开发或Chrome扩展开发一无所知。如果你正在寻找可以学习的好的JS代码，这不是它的首席。这只是对我自己的一个挑战，也可能是一个起点，让你实现得更好，可读性更强。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="b398" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">想法</h1><p id="303f" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">所以思路和参考视频里的一样。YouTube正遭受垃圾评论的困扰，看看任何财经视频，比如Graham Stephan的视频。你会发现很多冒名顶替者要求人们在WhatsApp上写下他们最有可能从中获得一些钱。显然，屏蔽用户并不会删除他们之前的评论，所以创作者很难摆脱他们。</p><p id="8082" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果YouTube不想要这个选项，我们可以自己添加吗？嗯，我们当然可以试试。我认为使用Chrome扩展可以直接在YouTube页面上添加一个按钮来删除用户的评论。我认为这种整合在概念上是有意义的。</p><h1 id="d81a" class="jm jn hi bd jo jp kp jr js jt kq jv jw jx kr jz ka kb ks kd ke kf kt kh ki kj bi translated">将按钮添加到YouTube</h1><p id="2f0e" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在设置了文档提供的HelloWorld Chrome扩展之后，是时候开始第一步了。我们甚至可以把按钮添加到YouTube上吗？如果不是，这个想法就没有意义，也没有继续下去的意义。</p><p id="32dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显然，随着下面几行被添加到我们的<code class="du ku kv kw kx b">manifest.json</code>中，我们有了一个运行在每一个YouTube视频页面上的JavaScript。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="c12c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这很有希望，现在我们只需要添加我们的JavaScript。</p><p id="0808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我试图从DOM中找到回复按钮，它在我的控制台上工作，但当我尝试使用我的扩展时就不行了。嗯，评论是事后加载的。通过谷歌搜索，我发现当节点被添加到页面时，我们可以做出反应:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="23fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我可以在添加评论时做出反应，甚至更有希望。我寻找一个特定的元素<code class="du ku kv kw kx b">reply-dialog</code>，并在一个<code class="du ku kv kw kx b">toolbar</code> div中找到了<code class="du ku kv kw kx b">REPLY</code>按钮的位置。所以现在我只需要在那里添加我的按钮。有了这个，我们在YouTube上有了一个按钮，我们可以对它做出反应，这很合适:</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/9fe27b7bdfaedd29a8d441464f87a712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIaZGzzsmaBu30ca-EvjLA.png"/></div></div></figure><h1 id="f49f" class="jm jn hi bd jo jp kp jr js jt kq jv jw jx kr jz ka kb ks kd ke kf kt kh ki kj bi translated">“做点什么！”</h1><p id="8570" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们有按钮，但它什么也不做。好吧，让我们改变一下:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="8a86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击按钮时调用该函数。</p><p id="df8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显然，我们可以向Chrome扩展的主要组件发送消息。所以我们发送用户的频道URL和视频的URL。这可以保存到下一步。</p><p id="abe0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这样，我们就可以在新页面中打开Google登录验证过程。谷歌登录需要一个重定向URL，我们没有。我们没有重定向到的服务器或页面，所以我们只是重定向到YouTube的一个特定URL，并对其做出反应，就像我们对YouTube视频标签的反应一样。这可以工作，不是最好的，但嘿\_(ツ)_/。我选择URL <code class="du ku kv kw kx b"><a class="ae jd" href="https://youtube.com/deleteallcomments" rel="noopener ugc nofollow" target="_blank">https://</a>youtube.com/deleteallcomments</code>,因为它是一个不存在的页面，我们可以通过调整清单来轻松摆脱它。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="aa54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">JavaScript也非常简单，只需向<code class="du ku kv kw kx b">background.js</code>发送一个信号，表明我们有令牌。</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><h1 id="e3e8" class="jm jn hi bd jo jp kp jr js jt kq jv jw jx kr jz ka kb ks kd ke kf kt kh ki kj bi translated">我们什么都有了，开始吧</h1><p id="df26" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我们向我们的<code class="du ku kv kw kx b">background.js</code>发送包含所需数据的消息。我们所能做的就是保存它，显然我们可以创建一个新的标签页来删除页面。这并不太复杂，所以接下来是YouTube集成。我们将所有这3个项目(videoId，userId，youtubeAccessToken)发送到一个新的选项卡，称之为<code class="du ku kv kw kx b">deleting.html</code>，<code class="du ku kv kw kx b">deleting.js</code>。</p><p id="69a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我对web开发一无所知。我不好意思说我花了多长时间才实现了一个进度指标，这个页面看起来仍然像是90年代的东西，也许这已经很慷慨了。但这是题外话，让我们来谈谈有趣的事情。</p><p id="7f2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要获得实际的评论。我不能通过我们想要删除的人的评论来过滤他们，所以我需要从视频中获得所有的评论线索。为此，我展示了一个无限加载指示器，并展示了找到了多少个注释线程。</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lm"><img src="../Images/a95f2cbae1e66393140d4b6d79fbe619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBpTjur4yhH5PS0KPNKxLQ.png"/></div></div></figure><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="22b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请求是分页的，所以我们一个接一个地调用，直到不再有下一页。我们有所有的评论线程，它们也包含回复。这样，我们可以通过选择的<code class="du ku kv kw kx b">userID</code>对它们进行过滤，并列出要删除的评论。</p><p id="2619" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这一点上，我向用户显示了一个进度指示器，因此他们知道注释正在被处理:</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es ln"><img src="../Images/e3c11014a08da49a0286d3038c68912e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOW0xE-yFObP6M0Iy2XPGg.png"/></div></div></figure><p id="de1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，用户可以通过采样来检查是否找到了正确的注释:</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lo"><img src="../Images/e1aded15bc71b5620f80f14f7074fbc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8R-MkphUJP-8adRPgTDXA.png"/></div></div></figure><h1 id="4d4a" class="jm jn hi bd jo jp kp jr js jt kq jv jw jx kr jz ka kb ks kd ke kf kt kh ki kj bi translated">实际删除</h1><p id="e1c3" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这样，唯一需要做的事情就是实现删除所有操作。由于我们创建了一个需要删除的评论列表，我们可以一个接一个地检查它们，调用YouTube的delete API，同时向用户显示进度。</p><figure class="ky kz la lb fd lc er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lp"><img src="../Images/25572a9e49e1ac7dd339a259eaa01e0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGtLX39w-cUq4D9Hmp0x_A.png"/></div></div></figure><p id="308d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以及它在代码中的样子:</p><figure class="ky kz la lb fd lc"><div class="bz dy l di"><div class="ld le l"/></div></figure><p id="9d48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，我们以递归的方式一个接一个地调用请求，直到不再有注释需要删除。此时，我向用户显示一个确认文本并关闭选项卡。</p><h1 id="9976" class="jm jn hi bd jo jp kp jr js jt kq jv jw jx kr jz ka kb ks kd ke kf kt kh ki kj bi translated">改进和发布</h1><p id="31ce" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">这个小程序可能会有很多改进:</p><ol class=""><li id="4ddc" class="lq lr hi ih b ii ij im in iq ls iu lt iy lu jc lv lw lx ly bi translated">我们可以将已经加载的评论保存在存储器中，这样，如果需要删除另一个用户的评论，我们就不需要重新加载所有的评论线程。</li><li id="b042" class="lq lr hi ih b ii lz im ma iq mb iu mc iy md jc lv lw lx ly bi translated">我们可以在频道上搜索多个视频，通过上面提到的缓存，也可以真正缩短时间。</li><li id="c2e7" class="lq lr hi ih b ii lz im ma iq mb iu mc iy md jc lv lw lx ly bi translated">我们还可以添加阻止功能，这样用户就会被阻止，他们所有的评论都会被删除，这样会更快。</li><li id="13a0" class="lq lr hi ih b ii lz im ma iq mb iu mc iy md jc lv lw lx ly bi translated">当然，代码和UI的设计都可以大大改进。</li></ol><p id="e9bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我会这么做吗？不。对我来说，重点是有一个小的周末项目来尝试一些新的和有趣的东西，它为我服务，所以我不会在这个小项目上花更多的时间。这就是为什么它也没有作为一个实际的Chrome扩展发布，我不想要通过谷歌OAuth验证和发布过程的麻烦。然而，如果你认为这个想法值得投资，请随意使用代码或想法。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="2d77" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">源代码</h1><p id="0e92" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">如果你想试试它，或者看看它看起来怎么样，请随意参考我的<a class="ae jd" href="https://github.com/fknives/Youtube-Spam-Purge-Almost-Chrome-Extension" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p><p id="cf70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在去编码；)</p></div></div>    
</body>
</html>
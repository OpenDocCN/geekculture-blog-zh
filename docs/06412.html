<html>
<head>
<title>Using Redis To Cache Data In NodeJS And ExpressJS Server.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Redis缓存NodeJS和ExpressJS服务器中的数据。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-redis-to-cache-data-in-nodejs-and-expressjs-server-f6a7596dd77e?source=collection_archive---------4-----------------------#2021-08-19">https://medium.com/geekculture/using-redis-to-cache-data-in-nodejs-and-expressjs-server-f6a7596dd77e?source=collection_archive---------4-----------------------#2021-08-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/42dcf24e848fdbfe6221c4b2425c33d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8fPAos1GN77yVMlUv7_ZOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">redis image</figcaption></figure><h1 id="e5e6" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">什么是缓存？</h1><ul class=""><li id="e7e9" class="js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated"><strong class="ju hj">缓存</strong>是<strong class="ju hj">本地存储</strong>，用于存储经常使用的数据。</li><li id="75d0" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">缓存是将文件副本存储在缓存或临时存储位置以便可以更快地访问它们的过程。</li></ul></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="cde1" class="iu iv hi bd iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr bi translated">Redis是什么？</h1><ul class=""><li id="610e" class="js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated"><strong class="ju hj"> Redis </strong>代表<strong class="ju hj">远程词典服务器</strong>。</li><li id="eddf" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">Redis是一个开源的内存中键值数据存储，可用作数据库、缓存、消息代理和队列。</li></ul><h1 id="3f89" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">安装Redis服务器:</h1><p id="dee8" class="pw-post-body-paragraph lb lc hi ju b jv jw ld le jx jy lf lg jz lh li lj kb lk ll lm kd ln lo lp kf hb bi translated"><strong class="ju hj">第一步:</strong>从<a class="ae lq" href="https://github.com/dmajkic/redis/downloads" rel="noopener ugc nofollow" target="_blank"> <em class="lr">官方git hub位置</em> </a>下载最新的Redis zip文件。对我来说是Redis-2.4.5-win32-win64.zip。</p><p id="bf99" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated"><strong class="ju hj">第二步:</strong>将redis-2.4.5-win32-win64.zip文件解压到您的首选位置。</p><p id="8488" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated"><strong class="ju hj">第三步:</strong>根据您的操作系统，它将带有两个不同的文件夹，一个用于32位，另一个用于64位。</p><p id="0b0e" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated"><strong class="ju hj">第四步:</strong>转到64bit，在那里你可以找到下面的文件。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/8d8f75952ad90e88902b401062e811a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*3CpFf_IEYQ99Vg5q.png"/></div></figure><p id="7275" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated">第四步:双击redis-server.exe文件，可以看到Redis-server启动并等待连接客户端，如下图。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/56bf6ab75d13bf17c98ca172bd64462a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ncQaGaJ_VAm6ugGo.png"/></div></div></figure><p id="3c4d" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated"><strong class="ju hj">第五步:</strong>现在打开Redis-cli.exe文件到Redis命令行界面。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/4d2d15b55375ee92f3c16fb505e1df32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*e_tSWVuHR_tANKe2.png"/></div></div></figure><p id="7ef3" class="pw-post-body-paragraph lb lc hi ju b jv ls ld le jx lt lf lg jz lu li lj kb lv ll lm kd lw lo lp kf hb bi translated">因为它充当Redis客户端，所以我们一打开这个cli，就可以在Redis服务器中看到客户端连接的消息，如下所示。</p><ul class=""><li id="f2f5" class="js jt hi ju b jv ls jx lt jz me kb mf kd mg kf kg kh ki kj bi translated">安装Redis后，有两种方法可以使用Redis</li></ul><ol class=""><li id="c4b0" class="js jt hi ju b jv ls jx lt jz me kb mf kd mg kf mh kh ki kj bi translated">正在安装Redis-CLI。</li><li id="0382" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf mh kh ki kj bi translated">在服务器应用程序中使用Redis。</li></ol></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="2050" class="iu iv hi bd iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr bi translated">步骤1:-创建基本Express服务器并安装软件包。</h1><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mi mj l"/></div></figure><ul class=""><li id="b404" class="js jt hi ju b jv ls jx lt jz me kb mf kd mg kf kg kh ki kj bi translated">创建Express服务器后，现在安装名为“Axios”的npm包，以便向任何第三方API发出请求。然后导入它。</li></ul><pre class="ly lz ma mb fd mk ml mm mn aw mo bi"><span id="8816" class="mp iv hi ml b fi mq mr l ms mt">npm install axios --save</span></pre><ul class=""><li id="939a" class="js jt hi ju b jv ls jx lt jz me kb mf kd mg kf kg kh ki kj bi translated">现在创建一个路由来处理“/ <strong class="ju hj"> starwar </strong>”路径上的<strong class="ju hj"> GET </strong>方法。</li><li id="0602" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">用户<strong class="ju hj">参数</strong>在访问到<strong class="ju hj">的路径时传递，使用<strong class="ju hj"> Axios </strong>包从第三方获取数据</strong>。</li></ul><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mi mj l"/></div></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="0f9d" class="iu iv hi bd iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr bi translated">步骤:-2使用Redis缓存数据。</h1><ul class=""><li id="f43d" class="js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">安装Redis npm包。</li></ul><pre class="ly lz ma mb fd mk ml mm mn aw mo bi"><span id="bd38" class="mp iv hi ml b fi mq mr l ms mt">npm i redis --save</span></pre><ul class=""><li id="2149" class="js jt hi ju b jv ls jx lt jz me kb mf kd mg kf kg kh ki kj bi translated">我们必须首先导入redis npm包。</li><li id="6dd0" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hj"> Redis </strong>包给了我们<strong class="ju hj"> createClient() </strong>方法，该方法将接受Redis-server端口号，默认情况下是<strong class="ju hj"> 6379 </strong>。</li><li id="d339" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">如果出现任何错误，我们可以使用<strong class="ju hj"> client.on("error "，()= &gt; {})。</strong>中间件记录错误消息。</li><li id="1d93" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">现在，在处理“/starwars”路线时，我们必须使用<strong class="ju hj"> client.setex() </strong>方法将收到的数据缓存到Redis中。</li></ul><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mi mj l"/></div></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="aaa8" class="iu iv hi bd iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn la jp jq jr bi translated"><strong class="ak">步骤:-3添加中间件以检查数据是否存在于缓存中。</strong></h1><ul class=""><li id="7656" class="js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">现在我们必须创建名为<strong class="ju hj"> checkCache，</strong>的中间件，它可以访问req、res和next。</li><li id="1a73" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">在端中间件中，我们可以使用<strong class="ju hj"> client.get() </strong>方法来检查所需数据是否在缓存中。</li><li id="3da9" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">client.get()方法将接受string作为第一个参数，回调函数作为第二个参数。</li><li id="d56e" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">我们可以将需要在缓存中搜索的键的名称作为第一个参数传递。</li><li id="9d96" class="js jt hi ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">最后，我们必须将这个中间件添加到路由处理器中。</li></ul><figure class="ly lz ma mb fd ij"><div class="bz dy l di"><div class="mi mj l"/></div></figure></div></div>    
</body>
</html>
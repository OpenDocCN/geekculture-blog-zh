<html>
<head>
<title>JavaScript Localization: A Step-by-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript本地化:逐步指南</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/javajavascript-localization-a-step-by-step-guide-868c80a586bd?source=collection_archive---------12-----------------------#2022-10-01">https://medium.com/geekculture/javajavascript-localization-a-step-by-step-guide-868c80a586bd?source=collection_archive---------12-----------------------#2022-10-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b84b5f30b56ba6f25400eda75e58bb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1s_dPJPaMD7z2UEvQsNUBw.png"/></div></div></figure><p id="2aed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据Statista的数据，JavaScript是全球软件开发人员最常用的编程语言，超过65%的受访者表示他们在使用HTML/CSS的同时也使用JavaScript。JavaScript本地化的需求不足为奇。</p><p id="9b48" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我们将学习如何通过两种方式实现这一点:基于文件的翻译，其中我们使用Transifex获取这些翻译并在本地应用程序中使用它们，或者Transifex native，这是一个基于云的本地化堆栈，其SDK可以通过CDN安装或使用，并允许我们直接使用Transifex推送和拉取本地化内容，而不需要文件。</p><p id="03b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">许多开发人员使用JavaScript创建网站、web应用程序、移动应用程序和其他东西。随着这些产品或平台规模的增长，他们意识到他们需要本地化。</p><h1 id="d9dd" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是本地化？</h1><p id="ad8f" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated"><a class="ae jo" href="https://www.transifex.com/blog/2021/what-is-localization/" rel="noopener ugc nofollow" target="_blank">本地化</a>是基于特定位置显示内容的过程。例如，如果一个用户在一个讲阿拉伯语的国家，你希望你的网站的内容以阿拉伯语显示给这个用户，这同样适用于其他语言。</p><p id="eafb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这不仅仅是语言的问题。您可以使用本地化来处理其他形式的媒体，如图像，甚至声音，以便您能够使用当地人最熟悉的东西。</p><p id="20ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过进行研究，您可以确定所有潜在的目标受众，然后努力确保您的产品或web内容可以本地化，以便他们可以使用他们的母语访问您的内容。</p><p id="04a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当谈到本地化时，许多开发人员不确定使用哪个库，哪个平台将是最有效的，以及许多其他因素。</p><p id="a805" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本指南中，我们将展示如何使用Transifex本地化JavaScript网站或应用程序，transi fex是一个让您的本地化和国际化工作更加容易的平台！</p><p id="770f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JavaScript本地化有两种方式:</p><ol class=""><li id="40aa" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated"><strong class="is hj">基于文件:</strong>意思是你以文件的形式提取你的内容，上传到<a class="ae jo" href="https://www.transifex.com/blog/2021/what-is-a-translation-management-system/" rel="noopener ugc nofollow" target="_blank">翻译管理系统(TMS) </a>，翻译内容，然后从TMS下载，上传回你的应用/网站，部署修改。</li><li id="0e66" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated"><strong class="is hj">无文件:</strong>直接在你的代码中安装一个“插件”,让TMS同步你的翻译，而不需要你经历上面的过程。</li></ol><p id="16fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个GitHub库上找到教程的代码！</p><h1 id="36d5" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">JavaScript本地化:基于文件的方法</h1><p id="a3b4" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在处理小项目时，您可能不想安装库、使用CDN、完成所有的配置练习等。你可能想在本地做所有的事情，这是完全可行的。</p><p id="e7e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在库发展之前，需要本地化的项目必须咨询个人来帮助翻译内容并从文件中提取内容，从而允许许多类似的文件翻译成不同的本地语言。</p><h1 id="ba20" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">提取您的内容</h1><p id="bcdb" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">让我们开始吧。假设我们有一个像这样的想要本地化的页面:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="6c57" class="lp jq hi ll b fi lq lr l ls lt">```HTML<br/>&lt;!-- ./index.HTML --&gt;</span><span id="8c2b" class="lp jq hi ll b fi lu lr l ls lt">&lt;html lang="en"&gt;<br/>    &lt;head&gt;<br/>        &lt;title&gt;JavaScript Transifex Demo&lt;/title&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        &lt;div class="container"&gt;<br/>            &lt;nav class="navbar"&gt;<br/>                &lt;div class="container"&gt;<br/>                    &lt;div class="logo"&gt;<br/>                        &lt;h1&gt;Local JS&lt;/h1&gt;<br/>                    &lt;/div&gt;<br/>                    &lt;div class="navbar-right"&gt;<br/>                        &lt;select id="localization-switcher" class="locale-switcher"&gt;<br/>                            &lt;option value="en"&gt;English&lt;/option&gt;<br/>                            &lt;option value="fr"&gt;French&lt;/option&gt;<br/>                            &lt;option value="ar"&gt;Arabic (العربية)&lt;/option&gt;<br/>                        &lt;/select&gt;<br/>                    &lt;/div&gt;<br/>                &lt;/div&gt;<br/>            &lt;/nav&gt;<br/>            &lt;div class="content-section"&gt;<br/>                &lt;h1 localization-key="title"&gt;<br/>                    Welcome to this localization demo site<br/>                &lt;/h1&gt;<br/>                &lt;p localization-key="description"&gt;<br/>                    Software localization is the process of adapting software to the culture and language of an end user, from standards of measurement to video and graphic design. It involves translation, design, and UX changes to make software look and feel natural to the target user.<br/>                &lt;/p&gt;<br/>            &lt;/div&gt;<br/>        &lt;/div&gt;<br/>        &lt;script src="./js/script.js"&gt;&lt;/script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;<br/>```</span></pre><p id="c542" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目前，所有内容都被硬编码到页面中。为了执行基于文件的本地化，我们需要将这些内容提取到一个文件中，可能是JSON格式，然后从该文件中检索它。</p><p id="0be3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在语言文件夹中创建一个文件来跟踪不同语言的所有文件:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="dffe" class="lp jq hi ll b fi lq lr l ls lt">```JSON</span><span id="3bc4" class="lp jq hi ll b fi lu lr l ls lt">&lt;!-- ./lang/en.json --&gt;</span><span id="dfe3" class="lp jq hi ll b fi lu lr l ls lt">{</span><span id="51c2" class="lp jq hi ll b fi lu lr l ls lt">    "title": "Welcome to this localization demo site",</span><span id="8541" class="lp jq hi ll b fi lu lr l ls lt">    "description": "Software localization is the process of adapting software to the culture and language of an end user, from standards of measurement to video and graphic design. It involves not only translation but also design and UX changes to make software look and feel natural to the target user."</span><span id="150a" class="lp jq hi ll b fi lu lr l ls lt">}</span><span id="462d" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="79fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们使用一个fetch请求，用这个JSON中的内容替换HTML文件中的静态内容:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="80f1" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="0469" class="lp jq hi ll b fi lu lr l ls lt">&lt;!-- ./js/script.js --&gt;</span><span id="b7fb" class="lp jq hi ll b fi lu lr l ls lt">let translations = {};</span><span id="b689" class="lp jq hi ll b fi lu lr l ls lt">const fetchContent = () =&gt; {</span><span id="14dd" class="lp jq hi ll b fi lu lr l ls lt">    return fetch(`lang/en.json`)</span><span id="fb54" class="lp jq hi ll b fi lu lr l ls lt">        .then((response) =&gt; {</span><span id="b60c" class="lp jq hi ll b fi lu lr l ls lt">            return response.json();</span><span id="6dde" class="lp jq hi ll b fi lu lr l ls lt">        })</span><span id="d571" class="lp jq hi ll b fi lu lr l ls lt">        .then((data) =&gt; {</span><span id="99c2" class="lp jq hi ll b fi lu lr l ls lt">            translations = data;</span><span id="57f8" class="lp jq hi ll b fi lu lr l ls lt">            translatePage();</span><span id="fa31" class="lp jq hi ll b fi lu lr l ls lt">        });</span><span id="ce05" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="4157" class="lp jq hi ll b fi lu lr l ls lt">fetchContent();</span><span id="8c4c" class="lp jq hi ll b fi lu lr l ls lt">const translatePage = () =&gt; {</span><span id="4b48" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="6973" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="5c60" class="lp jq hi ll b fi lu lr l ls lt">        let translation = translations[key];</span><span id="e92f" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="2483" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="9482" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="c653" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="ee50" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在前面的代码中，我们从JSON文件中检索了全部内容。然后，我们使用<strong class="is hj"> `querySelectorAll()` </strong>方法来查找我们在HTML文件中分配的具有<strong class="is hj"> `localization-key` </strong>属性的所有元素，循环查看与我们的对象的<strong class="is hj"> `key` </strong>匹配的属性，然后嵌入数据。</p><p id="7d56" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，我们已经看到了如何使用JavaScript从文件中读取数据。对于基于文件的本地化，Transifex允许我们上传源文件，这是我们的演示内容的英文版本<strong class="is hj"> (`en.json `)。</strong></p><p id="82e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，您还可以获得一个平台，在翻译的帮助下翻译您的内容。之后，我们可以下载翻译后的文件并获取本地化的内容。</p><p id="8c0a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看如何在Transifex上创建一个基于文件的项目，然后上传我们的源内容进行翻译。我们将负责翻译并下载翻译后的内容。</p><h1 id="da5e" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何在Transifex上创建基于文件的项目</h1><p id="fd6f" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">第一步是创建一个Transifex账户。<a class="ae jo" href="https://www.transifex.com/signup/" rel="noopener ugc nofollow" target="_blank">用你的GitHub，Google，或者LinkedIn账号注册</a>，免费15天，开源项目永远免费！</p><p id="452d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建帐户后，您需要创建一个项目。您必须为您的项目命名，并选择“<strong class="is hj">基于文件的</strong>”作为项目类型。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/39362f0c848b62643601bc84ecbf9c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xrNcu13LYdzVnuQ-.png"/></div></div></figure><p id="955f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，您必须指定您的应用程序的主要语言和我们将翻译成的语言。我将使用英语作为本指南的主要语言，法语和阿拉伯语作为我的目标语言。</p><p id="90b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:取消勾选询问您是否想自动添加演示文件的复选框，除非您想先用它来测试Transifex平台。</p><p id="96d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，点击“<strong class="is hj">创建项目</strong>按钮。</p><p id="8fe3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将引导您进入下一页，在这里您可以上传任何支持格式的<a class="ae jo" href="https://docs.transifex.com/formats/introduction" rel="noopener ugc nofollow" target="_blank">源文件。但是我们将使用</a><a class="ae jo" href="https://docs.transifex.com/formats/json" rel="noopener ugc nofollow" target="_blank"> JSON格式</a>。</p><p id="0ae0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建项目后，选择“<strong class="is hj">上传文件</strong>”按钮上传提取的JSON文件:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/24870af4f364cecd678ca33010757f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L4G6TGucIdxtC6Sq.png"/></div></div></figure><p id="df6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，您就可以开始将您的内容翻译到编辑器中了！</p><h1 id="ae78" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">从Transifex下载您的翻译内容</h1><p id="3cbf" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">我们现在可以在成功翻译后下载翻译后的文件，以使用我们的应用程序中的内容。要下载，导航到您项目的语言选项卡，单击该文件，然后选择“<strong class="is hj">仅下载已审核的翻译</strong>”transi fex将允许我们下载您的翻译语言的JSON文件:</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/946483093763fa613bd8784c983b07a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pwYfF9xXZCn09c4-.gif"/></div></div></figure><p id="462f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> &gt;注意</strong>:确保将带有区域名称的文件保存在我们之前创建的“lang文件夹”中，例如`。/lang/ar.json`。</p><h1 id="c1b7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何从本地文件异步加载翻译</h1><p id="f8aa" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">到目前为止，我们已经能够将我们的源文件(` en.json `)翻译成阿拉伯语(` ar.json `)，并且我们已经将这两个文件保存在languages文件夹(` lang `)中。我们以前能够从源文件加载数据。</p><p id="4f0b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们看看如何异步加载我们的翻译:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="f139" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="7ebb" class="lp jq hi ll b fi lu lr l ls lt">const locale = 'ar';</span><span id="79a2" class="lp jq hi ll b fi lu lr l ls lt">let translations = {};</span><span id="32c4" class="lp jq hi ll b fi lu lr l ls lt">document.addEventListener('DOMContentLoaded', () =&gt; {</span><span id="a3ee" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(locale);</span><span id="319c" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="4fe0" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = async (newLocale) =&gt; {</span><span id="bafd" class="lp jq hi ll b fi lu lr l ls lt">    translations = await fetchTranslations(newLocale);</span><span id="a9ab" class="lp jq hi ll b fi lu lr l ls lt">    translatePage();</span><span id="4955" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="e634" class="lp jq hi ll b fi lu lr l ls lt">const fetchTranslations = async (newLocale) =&gt; {</span><span id="bf70" class="lp jq hi ll b fi lu lr l ls lt">    const response = await fetch(`lang/${newLocale}.json`);</span><span id="bfa7" class="lp jq hi ll b fi lu lr l ls lt">    return await response.json();</span><span id="18c5" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="ad3c" class="lp jq hi ll b fi lu lr l ls lt">const translatePage = () =&gt; {</span><span id="cac2" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="4642" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="e7f7" class="lp jq hi ll b fi lu lr l ls lt">        let translation = translations[key];</span><span id="4104" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="75c2" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="4ef9" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="4835" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="339f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码与我们用来从源文件中检索数据的代码非常相似。我们是异步进行的，所以它根据“locale”参数加载内容。让我们再看一遍代码。</p><p id="f33f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们声明了两个变量来指定我们希望基于可用的语言环境检索的语言环境。如我们所见，我们将我们的设置为“ar ”,这是阿拉伯语的语言代码:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="b04e" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="3fd2" class="lp jq hi ll b fi lu lr l ls lt">const locale = 'ar';</span><span id="5e09" class="lp jq hi ll b fi lu lr l ls lt">let translations = {};</span><span id="1b38" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="9f3c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后，我们创建了一个“addEventListener()”,当页面内容准备使用“DOMContentLoaded”事件时，该事件将被触发。在这个“addEventListener()”中，我们调用了“setLocale()”函数并传递了“Locale”变量。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8187" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="7604" class="lp jq hi ll b fi lu lr l ls lt">document.addEventListener('DOMContentLoaded', () =&gt; {</span><span id="66e0" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(locale);</span><span id="0514" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="7a0c" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="e38a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">核心函数是“setLocale()”,它执行两个主要任务:加载给定语言环境的翻译和翻译页面以显示指定语言的本地化内容:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ab44" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="6ed6" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = async (newLocale) =&gt; {</span><span id="e456" class="lp jq hi ll b fi lu lr l ls lt">    translations = await fetchTranslations(newLocale);</span><span id="7d36" class="lp jq hi ll b fi lu lr l ls lt">    translatePage();</span><span id="936f" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="ca6e" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="4e40" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如在“setLocale()”函数中看到的，我们首先获取我们的翻译，正如我们可以看到的，我们使用async/await来获取翻译，然后触发将使用获取的内容加载我们的页面的函数。我们将区域设置传递给“fetchTranslations()”函数，并使用它从区域设置文件中检索内容:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="0bc4" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="1539" class="lp jq hi ll b fi lu lr l ls lt">const fetchTranslations = async (newLocale) =&gt; {</span><span id="154c" class="lp jq hi ll b fi lu lr l ls lt">    const response = await fetch(`lang/${newLocale}.json`);</span><span id="bca1" class="lp jq hi ll b fi lu lr l ls lt">    return await response.json();</span><span id="40e7" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="7ce4" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="58e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，当我们获得内容时，我们现在将该内容传递给我们的页面，因此它使用setLocale函数中的第二个函数出现，该函数是` translatePage()`:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="a048" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="f474" class="lp jq hi ll b fi lu lr l ls lt">const translatePage = () =&gt; {</span><span id="15ee" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="c89e" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="5019" class="lp jq hi ll b fi lu lr l ls lt">        let translation = translations[key];</span><span id="b76a" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="3ace" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="b124" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="a0e0" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><h1 id="5f84" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何实现语言环境切换器</h1><p id="443a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">此时，我们可以加载我们翻译的内容，如果我们有大量的文件，我们所要做的就是更改我们的locale变量的值以匹配翻译的文件，这将获取内容。然而，这不是最好的方法，因为用户将无法访问我们的代码库。我们希望用户能够使用我们的UI在语言之间切换。</p><p id="24e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在HTML代码中添加了一个select标记，它有一个指示语言的下拉列表；现在，让我们编写逻辑，帮助我们从下拉列表中获取值，并将其传递给前面的代码:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="48ac" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="dbce" class="lp jq hi ll b fi lu lr l ls lt">const switcher = document.getElementById('localization-switcher');</span><span id="eddd" class="lp jq hi ll b fi lu lr l ls lt">switcher.onchange = (e) =&gt; {</span><span id="33bd" class="lp jq hi ll b fi lu lr l ls lt">    // Set the locale to the selected option's value</span><span id="876d" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(e.target.value);</span><span id="6887" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="1cc3" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="b415" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们所做的就是通过id获取select标记，然后传递“onChange()”事件，这样我们就可以将locale设置为所选选项的值，如上所示。</p><p id="62cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，假设我们想要使用存储在浏览器中的用户默认区域设置。在这种情况下，我们可以通过navigator JavaScript对象这样做，我们还可以处理错误，这样，如果用户选择了一种没有翻译的语言，我们可以选择将内容保留为特定的语言环境:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ef2a" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="67ba" class="lp jq hi ll b fi lu lr l ls lt">let translations = {};</span><span id="b6d1" class="lp jq hi ll b fi lu lr l ls lt">document.addEventListener('DOMContentLoaded', () =&gt; {</span><span id="584a" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(defaultLocale);</span><span id="fedf" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="5e7b" class="lp jq hi ll b fi lu lr l ls lt">const switcher = document.getElementById('localization-switcher');</span><span id="ce53" class="lp jq hi ll b fi lu lr l ls lt">switcher.onchange = (e) =&gt; {</span><span id="6287" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(e.target.value);</span><span id="9347" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="c7fd" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = async (newLocale) =&gt; {</span><span id="45c0" class="lp jq hi ll b fi lu lr l ls lt">    translations = await fetchTranslations(newLocale);</span><span id="55dc" class="lp jq hi ll b fi lu lr l ls lt">    translatePage();</span><span id="e41d" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="ddcc" class="lp jq hi ll b fi lu lr l ls lt">const fetchTranslations = async (newLocale) =&gt; {</span><span id="5b1d" class="lp jq hi ll b fi lu lr l ls lt">    const response = await fetch(`lang/${newLocale}.json`);</span><span id="cecc" class="lp jq hi ll b fi lu lr l ls lt">    if (!response.ok) {</span><span id="b21b" class="lp jq hi ll b fi lu lr l ls lt">        console.log(`Could not fetch translations for locale ${newLocale}`);</span><span id="7564" class="lp jq hi ll b fi lu lr l ls lt">    }</span><span id="e6fa" class="lp jq hi ll b fi lu lr l ls lt">    return await response.json();</span><span id="53c4" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="5d9d" class="lp jq hi ll b fi lu lr l ls lt">function translatePage() {</span><span id="2f33" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="1ca4" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="6750" class="lp jq hi ll b fi lu lr l ls lt">        let translation = translations[key];</span><span id="1e21" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="c28f" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="4055" class="lp jq hi ll b fi lu lr l ls lt">}</span><span id="73d1" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="e17d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就是基于文件的JavaScript本地化方法。</p><p id="1a4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您想要更简化的解决方案，可以考虑无文件方法。</p><p id="e1d0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:由于我们请求的是一个文件，这个方法在特定浏览器上可能会因为CORS问题而不起作用。最好的解决方案是在本地或远程服务器上运行应用程序。</p><h1 id="9a97" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Javascript本地化:无文件方法</h1><p id="295d" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">无文件方法就是我们所说的“Transifex Native”。这使您能够允许本地化平台直接与您的代码库通信，并自动拉/推内容。您基本上几乎完全摆脱了基于文件的方法所需要的所有步骤。</p><ol class=""><li id="8d98" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated"><a class="ae jo" href="https://www.transifex.com/signup/" rel="noopener ugc nofollow" target="_blank">如果你还没有Transifex账户的话，创建一个。</a></li><li id="f646" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">创建Transifex本地项目</li><li id="142d" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">指定您的应用程序的主要语言以及我们将把它翻译成的语言。</li></ol><p id="7e72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如前所述，英语将是主要语言，法语和阿拉伯语作为我的目标语言。</p><p id="128a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，点击<strong class="is hj">创建项目</strong>按钮，这将引导您进入下一页，在这里您将找到为您的项目创建凭证的说明。</p><p id="df05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在页面底部，单击“<strong class="is hj">立即生成本机凭据</strong>”。将在弹出窗口中显示<strong class="is hj"> API _token_ </strong>和<strong class="is hj"> _secret_ key </strong>。复制两把钥匙并保存好，以备后用。这也将显示我们将在JavaScript文件中使用的配置。</p><figure class="lg lh li lj fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/8fc40af43c68479cd7a7ba54009a5a18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uGwp8t_E6mg0ndUt.png"/></div></div></figure><p id="ad5a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，我们现在可以将内容推送到Transifex，然后对其进行本地化。</p><h1 id="aefd" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何在我们的JavaScript项目中配置Transifex Native</h1><p id="d973" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">使用Transifex native的第一步是配置它。有许多方法可以做到这一点，如在<a class="ae jo" href="https://developers.transifex.com/docs/javascript-sdk-setup" rel="noopener ugc nofollow" target="_blank"> Transifex JavaScript文档中所见。</a></p><p id="c6ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是对于本指南，我们将使用CDN，稍后当我们想要推送我们的内容时，我们将使用Transifex CLI。</p><p id="b509" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将CDN添加到HTML文件中，然后我们就可以在JavaScript文件中直接使用Transifex:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e8f4" class="lp jq hi ll b fi lq lr l ls lt">```HTML</span><span id="cee9" class="lp jq hi ll b fi lu lr l ls lt">&lt;!DOCTYPE html&gt;</span><span id="1631" class="lp jq hi ll b fi lu lr l ls lt">&lt;html lang="en"&gt;</span><span id="9332" class="lp jq hi ll b fi lu lr l ls lt">    &lt;head&gt;</span><span id="31b2" class="lp jq hi ll b fi lu lr l ls lt">        &lt;title&gt;JavaScript Transifex Demo&lt;/title&gt;</span><span id="1c5c" class="lp jq hi ll b fi lu lr l ls lt">    &lt;/head&gt;</span><span id="8fcc" class="lp jq hi ll b fi lu lr l ls lt">    &lt;body&gt;</span><span id="3d3a" class="lp jq hi ll b fi lu lr l ls lt">        // ...</span><span id="e354" class="lp jq hi ll b fi lu lr l ls lt">        &lt;script</span><span id="d8bd" class="lp jq hi ll b fi lu lr l ls lt">            type="text/javascript"</span><span id="3b9a" class="lp jq hi ll b fi lu lr l ls lt">            src="https://cdn.jsdelivr.net/npm/@transifex/native/dist/browser.native.min.js"</span><span id="fddc" class="lp jq hi ll b fi lu lr l ls lt">        &gt;&lt;/script&gt;</span><span id="4912" class="lp jq hi ll b fi lu lr l ls lt">        &lt;script src="./index.js"&gt;&lt;/script&gt;</span><span id="585b" class="lp jq hi ll b fi lu lr l ls lt">    &lt;/body&gt;</span><span id="a089" class="lp jq hi ll b fi lu lr l ls lt">&lt;/html&gt;</span><span id="1f17" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="54ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，我们现在可以使用之前创建项目时获得的密钥来配置我们的JavaScript文件:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="3c0d" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="470c" class="lp jq hi ll b fi lu lr l ls lt">const tx = Transifex.tx;</span><span id="8abc" class="lp jq hi ll b fi lu lr l ls lt">const t = Transifex.t;</span><span id="2c15" class="lp jq hi ll b fi lu lr l ls lt">tx.init({</span><span id="990a" class="lp jq hi ll b fi lu lr l ls lt">    token: 'ADD TOKEN KEY HERE.'</span><span id="179e" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="83a0" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><h1 id="9d33" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何用JavaScript将内容推送到Transifex</h1><p id="35e7" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Transifex现在已经成功地在我们的JavaScript文件中进行了本地配置。</p><p id="dc92" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于基于文件的方法，我们必须将内容JSON文件上传到Transifex，但现在我们希望直接推送我们的内容，而不使用任何外部文件，这可以通过Transifex CLI来完成。</p><p id="5c5d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们首先必须创建一个package.json文件，然后通过运行以下命令安装Transifex CLI依赖项:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="2bce" class="lp jq hi ll b fi lq lr l ls lt">```bash</span><span id="caa0" class="lp jq hi ll b fi lu lr l ls lt">$ npm init -y</span><span id="5979" class="lp jq hi ll b fi lu lr l ls lt">$ npm install @transifex/cli --save</span><span id="a58a" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="50e3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">完成后，我们将看到Transifex CLI已经安装在我们的packe.json文件依赖对象中:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="f7d6" class="lp jq hi ll b fi lq lr l ls lt">```JSON</span><span id="ee82" class="lp jq hi ll b fi lu lr l ls lt">"dependencies": {</span><span id="aecc" class="lp jq hi ll b fi lu lr l ls lt">    "@transifex/cli": "^4.2.2"</span><span id="6a1f" class="lp jq hi ll b fi lu lr l ls lt">}</span><span id="7333" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="1023" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在可以使用“t”功能来推送我们的内容。正如我们在下面看到的，我们还使用了` _ key `[ parameter](https://docs . transi fex . com/JavaScript-SDK/international ize-JavaScript-code # parameters-and-metadata)为每个内容提供了一个键，因此以后很容易获取这些内容:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="c63e" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="ffd9" class="lp jq hi ll b fi lu lr l ls lt">const tx = Transifex.tx;</span><span id="4168" class="lp jq hi ll b fi lu lr l ls lt">const t = Transifex.t;</span><span id="5aa7" class="lp jq hi ll b fi lu lr l ls lt">    tx.init({</span><span id="9a28" class="lp jq hi ll b fi lu lr l ls lt">        token: 'ADD TOKEN KEY HERE',</span><span id="c045" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="7c2e" class="lp jq hi ll b fi lu lr l ls lt">    t('Welcome to this localization demo site', {</span><span id="a95e" class="lp jq hi ll b fi lu lr l ls lt">        _key: 'title',</span><span id="3995" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="874d" class="lp jq hi ll b fi lu lr l ls lt">    t(</span><span id="255a" class="lp jq hi ll b fi lu lr l ls lt">        'Software localization is the process of adapting software to both the culture and language of an end user, from standards of measurement to video and graphic design. It involves not only translation, but also design and UX changes to make software look and feel natural to the target user.',</span><span id="5afd" class="lp jq hi ll b fi lu lr l ls lt">        {</span><span id="6e5e" class="lp jq hi ll b fi lu lr l ls lt">            _key: 'description',</span><span id="f6af" class="lp jq hi ll b fi lu lr l ls lt">        }</span><span id="1bff" class="lp jq hi ll b fi lu lr l ls lt">    );</span><span id="c28a" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="91d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，我们已经初始化了要推送到Transifex进行本地化的内容。现在让我们用`@transifex/cli `库推送内容，该库将收集所有可翻译的字符串，并使用以下命令将它们推送到transifex:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="82ae" class="lp jq hi ll b fi lq lr l ls lt">```</span><span id="081c" class="lp jq hi ll b fi lu lr l ls lt">$ ./node_modules/.bin/txjs-cli push src/ --token=&lt;PROJECT TOKEN&gt; --secret=&lt;PROJECT SECRET&gt;</span><span id="b174" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="055a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">注意</strong>:在上面的命令中，确保添加了令牌和密钥。您还会注意到我们使用了“src/”,这意味着该命令将在“src”文件夹中查找“index.js”文件。</p><p id="76bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">“index.js”文件是包含我们想要推送的内容的文件。确保你把你的HTML、CSS和JavaScript文件放在一个“src”文件夹中，如<a class="ae jo" href="https://github.com/olawanlejoel/JS-localization-transifex/tree/main/Transifex%20Native" rel="noopener ugc nofollow" target="_blank">GitHub库</a>所示</p><h1 id="a379" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何从Transifex获取本地化内容</h1><p id="0154" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">从Transifex中提取内容类似于我们以前从JSON文件中检索数据的方式。唯一显著的区别是我们不再使用fetch API进行数据检索:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1616" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="7d6b" class="lp jq hi ll b fi lu lr l ls lt">const locale = 'ar';</span><span id="7781" class="lp jq hi ll b fi lu lr l ls lt">document.addEventListener('DOMContentLoaded', () =&gt; {</span><span id="eecf" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(locale);</span><span id="6b04" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="8027" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = (newLocale) =&gt; {</span><span id="8dfc" class="lp jq hi ll b fi lu lr l ls lt">    tx.setCurrentLocale(newLocale)</span><span id="f0f8" class="lp jq hi ll b fi lu lr l ls lt">        .then(() =&gt; {</span><span id="439e" class="lp jq hi ll b fi lu lr l ls lt">            translatePage();</span><span id="0fbc" class="lp jq hi ll b fi lu lr l ls lt">        })</span><span id="e58d" class="lp jq hi ll b fi lu lr l ls lt">        .catch((err) =&gt; console.log(err));</span><span id="7adb" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="18a6" class="lp jq hi ll b fi lu lr l ls lt">const translatePage = () =&gt; {</span><span id="1113" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="e465" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="d2cb" class="lp jq hi ll b fi lu lr l ls lt">        let translation = t(key);</span><span id="7ab8" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="a5a7" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="307d" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="5c67" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="3881" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上面的代码中，我们指定了要从中检索本地化内容的语言环境。我们创建了一个函数来检索数据，这是“setLocale()”方法，最后，我们使用“translatePage()”方法来帮助获取基于“key”的每个内容，并将其传递给UI。</p><h1 id="c4f9" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">如何实现语言环境切换器</h1><p id="921c" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">就像我们对基于文件的JavaScript本地化所做的一样，我们也可以对Transifex native做同样的事情，因为我们想要做的只是获取值并将其传递给“setLocale()”方法:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="f3f9" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="bb0d" class="lp jq hi ll b fi lu lr l ls lt">const switcher = document.getElementById('localization-switcher');</span><span id="398a" class="lp jq hi ll b fi lu lr l ls lt">switcher.onchange = (e) =&gt; {</span><span id="2f54" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(e.target.value);</span><span id="8442" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="7095" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="afd4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">到目前为止，我们已经能够使用Transifex native实现本地化；但是，我们也可以选择从浏览器中检测用户的首选语言环境，并将其作为JavaScript `navigator `对象的初始语言环境。我们还可以处理错误，这样，如果传递了一个不可用的区域设置，它将返回任何其他指定的区域设置作为后备:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="5dc0" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="2304" class="lp jq hi ll b fi lu lr l ls lt">const defaultLocale = navigator.language.split('-')[0];</span><span id="637d" class="lp jq hi ll b fi lu lr l ls lt">document.addEventListener('DOMContentLoaded', () =&gt; {</span><span id="f758" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(defaultLocale);</span><span id="5fd3" class="lp jq hi ll b fi lu lr l ls lt">});</span><span id="1743" class="lp jq hi ll b fi lu lr l ls lt">const switcher = document.getElementById('localization-switcher');</span><span id="19c2" class="lp jq hi ll b fi lu lr l ls lt">switcher.onchange = (e) =&gt; {</span><span id="415d" class="lp jq hi ll b fi lu lr l ls lt">    // Set the locale to the selected option[value]</span><span id="a312" class="lp jq hi ll b fi lu lr l ls lt">    setLocale(e.target.value);</span><span id="2f2e" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="d479" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = (newLocale) =&gt; {</span><span id="f7ad" class="lp jq hi ll b fi lu lr l ls lt">    tx.setCurrentLocale(newLocale)</span><span id="7fc1" class="lp jq hi ll b fi lu lr l ls lt">        .then(() =&gt; {</span><span id="673d" class="lp jq hi ll b fi lu lr l ls lt">            translatePage();</span><span id="e378" class="lp jq hi ll b fi lu lr l ls lt">        })</span><span id="e856" class="lp jq hi ll b fi lu lr l ls lt">        .catch((err) =&gt; console.log(err));</span><span id="70bc" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="25a1" class="lp jq hi ll b fi lu lr l ls lt">const translatePage = () =&gt; {</span><span id="1171" class="lp jq hi ll b fi lu lr l ls lt">    document.querySelectorAll('[localization-key]').forEach((element) =&gt; {</span><span id="1bad" class="lp jq hi ll b fi lu lr l ls lt">        let key = element.getAttribute('localization-key');</span><span id="7b5f" class="lp jq hi ll b fi lu lr l ls lt">        let translation = t(key);</span><span id="1b0a" class="lp jq hi ll b fi lu lr l ls lt">        if (translation === key) {</span><span id="4397" class="lp jq hi ll b fi lu lr l ls lt">            console.log(`Translation not found for key: ${key}`);</span><span id="ea85" class="lp jq hi ll b fi lu lr l ls lt">            setLocale(defaultLocale);</span><span id="e9be" class="lp jq hi ll b fi lu lr l ls lt">        }</span><span id="2f9d" class="lp jq hi ll b fi lu lr l ls lt">        element.innerText = translation;</span><span id="6428" class="lp jq hi ll b fi lu lr l ls lt">    });</span><span id="c1a2" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="de09" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><h1 id="2b97" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">处理方向:从右向左和从左向右的语言</h1><p id="841a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">β在结束本指南之前，内容方向是我们在处理本地化时总想实现的一个主要特性。每种语言的内容显示方式不同。例如，英语从左向右显示(` ltr `)，而阿拉伯语从右向左显示(` rtl `)。</p><p id="8cbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">默认情况下，我们的内容以“ltr”格式显示，但是我们可以添加逻辑来处理某些特定语言的方向，这适用于本指南中介绍的两种方法:</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="e077" class="lp jq hi ll b fi lq lr l ls lt">```js</span><span id="37cd" class="lp jq hi ll b fi lu lr l ls lt">const setLocale = async (newLocale) =&gt; {</span><span id="e80e" class="lp jq hi ll b fi lu lr l ls lt">    // ...</span><span id="c27e" class="lp jq hi ll b fi lu lr l ls lt">    document.documentElement.dir = direction(newLocale);</span><span id="3f53" class="lp jq hi ll b fi lu lr l ls lt">};</span><span id="fbe5" class="lp jq hi ll b fi lu lr l ls lt">const direction = (locale) =&gt; {</span><span id="d663" class="lp jq hi ll b fi lu lr l ls lt">    return locale === 'ar' ? 'rtl' : 'ltr';</span><span id="b73d" class="lp jq hi ll b fi lu lr l ls lt">}</span><span id="9844" class="lp jq hi ll b fi lu lr l ls lt">```</span></pre><p id="39cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的代码检查区域设置是否等于“ar ”,并返回指定的方向，这是使用“document.documentElement.dir”实现的。</p><h1 id="9dd8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="f771" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这本JavaScript本地化指南中，我们学习了实现JavaScript本地化的两种主要方法:基于文件的和无文件的。</p><p id="a80e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总而言之，这两种方法都可以完美地工作，但是对于大型项目来说，基于文件的方法变得非常难以管理。因此，使用Transifex Native的最大优势是，正如我们刚刚看到的，翻译不包含在您的代码库中。</p><p id="d1e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我真诚地希望这篇文章是有帮助的，如果你需要更多的信息，请参阅<a class="ae jo" href="https://developers.transifex.com/" rel="noopener ugc nofollow" target="_blank"> Transifex文档</a>。</p><p id="9728" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本帖原载于页面<a class="ae jo" href="https://www.transifex.com/blog/2022/javascript-localization/" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>
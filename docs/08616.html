<html>
<head>
<title>Marketing Automation: Recommendation Systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">营销自动化:推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/marketing-automation-recommendation-systems-ae39d61aa38?source=collection_archive---------5-----------------------#2021-11-08">https://medium.com/geekculture/marketing-automation-recommendation-systems-ae39d61aa38?source=collection_archive---------5-----------------------#2021-11-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0c3b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在信息噪音和信息过剩的时期，通过所有可能的沟通渠道，准确的推荐是增加客户忠诚度和降低客户流失风险的方法之一。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/be89ad14108de5cf5b18b33321a91b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*We6spp1NFWtuBpdF"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@bernardhermant?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Bernard Hermant</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8de6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">推荐系统是我们数字世界的一个重要特征。如今推荐引擎无处不在。我们每天接触的一些最大的品牌都是围绕一个品牌建立的，包括网飞、亚马逊、谷歌和脸书。亚马逊或阿里巴巴上超过三分之一的购买来自产品推荐。那么，什么是推荐引擎，它是如何工作的？</p><h2 id="fcdf" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">什么是推荐引擎？</h2><p id="6842" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">推荐引擎是一组数据科学算法，有助于找到与特定用户或客户最相关的项目。在处理了大量数据后，这些算法可以找到进一步帮助提出建议的模式。</p><p id="bd49" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是一个非常好的定义，但对我来说，真正好的推荐系统还应该考虑时间(发送推荐时？)和沟通渠道(什么样的沟通方式最适合特定的客户？).</p><p id="a2e7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因此，推荐引擎对这些问题的最佳回答是:</p><ul class=""><li id="abcb" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">有什么推荐给用户？</li><li id="8590" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">什么时候推荐给用户？</li><li id="fc48" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">如何为用户推荐？</li></ul><h2 id="819b" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">推荐引擎是如何工作的？</h2><p id="aabd" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">在下图中，你可以看到推荐引擎有一个循环工作流程。在模型创建之后，我们收集它的反馈结果，然后重新训练或改变我们的模型。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ly"><img src="../Images/920bd40f2903c029aa46a2bf7ad2266a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lK2Ck63WU10C3i5C830xgA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Recommendation Engine workflow (Image by Author)</figcaption></figure><h2 id="c4d6" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">如何根据自己的业务需求和技术能力选择推荐引擎？</h2><p id="5c8d" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">我想从一个最简单但对我来说最古老和最常用的方法开始。这种方法不是数据科学算法，而是一种数据挖掘方法。它的名字叫— <strong class="jq hj">关联规则学习。</strong></p><h2 id="0c71" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">关联规则挖掘</h2><p id="3bee" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">关联规则挖掘在大量数据项之间或者在零售或电子商务交易中发现有趣的关联和关系。此规则显示商品或服务集在交易中出现的频率。一个典型的例子是基于市场的分析。</p><p id="a40b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">关联规则挖掘基于三个主要度量:</p><ul class=""><li id="4907" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated"><strong class="jq hj"> Support </strong>表示商品或服务出现在银行本票中的频率。</li><li id="6020" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated"><strong class="jq hj">信心</strong>是一个指标，表明这个规则有多经常是正确的。</li><li id="5c43" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated"><strong class="jq hj"> Lift </strong>显示如果出现物品X，购买物品Y的可能性。</li></ul><p id="a67c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">关联规则分析是</strong>通常基于事务性数据，我们需要的只是下一张表:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lz"><img src="../Images/8a590ee6c54b7540f356a8c956b661ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*LIZElqQuDfJnh_-7PkEwwQ.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Data sample (Image by Author)</figcaption></figure><p id="46a2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们需要将这些数据预处理成以下格式:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ma"><img src="../Images/76fba7cf836df9dc8a1e875e10551179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*dOj71oa8fBUF0H_5aoo9aA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Preprocess sample (Image by Author)</figcaption></figure><p id="98a3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下一步是对我们的数据透视表进行编码，为此我们可以使用如下代码:</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="76f7" class="kk kl hi mc b fi mg mh l mi mj"><strong class="mc hj">def</strong> encode_units(x):<br/>    <strong class="mc hj">if</strong> x &lt;= 0:<br/>        <strong class="mc hj">return</strong> 0<br/>    <strong class="mc hj">if</strong> x &gt;= 1:<br/>        <strong class="mc hj">return</strong> 1<br/><br/>ecode_sample_set = sample_set.applymap(encode_units)</span></pre><p id="23a9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该代码只能应用于样本集。这个算法有很多端到端解决方案的实现。例如:</p><ul class=""><li id="b40a" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated"><a class="ae jn" href="https://pypi.org/project/apyori/" rel="noopener ugc nofollow" target="_blank"> apyori </a></li><li id="a1a9" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated"><a class="ae jn" href="https://pypi.org/project/mlxtend/" rel="noopener ugc nofollow" target="_blank"> mlxtend </a></li></ul><p id="3bea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这些解决方案都很好，但对我来说，对于真实案例，当我们有大量数据时，我们应该使用Spark解决方案。<a class="ae jn" href="https://spark.apache.org/docs/2.2.0/ml-frequent-pattern-mining.html" rel="noopener ugc nofollow" target="_blank"> FP-growth算法</a>是用Pyspark很好的实现。</p><p id="42e4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们应该从结果中得到什么？以下是带有结果表的示例:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mk"><img src="../Images/bbe3d9898203bc355afb086151a6a507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*obmXA7wGsqCp-855Jf3sgw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx"><strong class="bd km">Association rule result </strong>(Image by Author)</figcaption></figure><p id="6c44" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">根据我们的业务任务，我们可以根据任何度量或维度对这个结果进行排序。例如，在检查中最常遇到的产品通常被并排放在商店的货架上，或者在网上商店的推荐中作为附送产品给出。在这种情况下，最常见的位置是在表的顶部，但在底部或中间你可以找到以前可能没有遇到或注意到的相当有趣的组合。</p><h2 id="9f0a" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">我的下一个方法是基于内容的。</h2><p id="9435" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">设计推荐系统的另一种常用方法是基于内容的过滤。</p><p id="e329" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">基于内容的过滤方法基于项目的特征和用户偏好的配置文件。当我们知道一个项目的数据(名称、位置、描述等)时，这种方法是很好的。)，但不是关于用户的。换句话说，这些算法试图推荐与用户过去购买/喜欢/考试或现在在网站上进行的项目相似的项目。​</p><p id="be67" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这种算法的主要问题是——“冷启动”，这意味着我们不能为客户推荐任何东西，直到他/她没有对商品或服务采取任何行动(查看/Ruy/排名/评论)。我们将在接下来的算法中解决这个问题。</p><p id="09e9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这个算法在很多行业都可以很流行，但在我看来，在时尚或者音乐推荐方面最流行。在第一种情况下，我们的数据可以是衣服或鞋子的图像，在第二种情况下，它是一个音轨。</p><p id="37ff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在任何情况下，首先我们应该预处理我们的数据，然后根据某种度量建立相似性矩阵。然后我们可以对它进行排序，找到最相似的项目。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/749a66e8962d8eec09ed0d93c70d09bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*212LUOMi2NQITfUK9egsLA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Workflow (Image by Author)</figcaption></figure><p id="99ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于这些任务中的任何一项，现在都有许多使用深度学习最新进展的实现选项。</p><p id="e09c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于图像预处理，我们可以使用任何预训练的神经网络结构，然后使用迁移学习和微调方法来使神经网络适合我们的数据集。根据您的系统能力，我们可以使用以下<a class="ae jn" href="https://www.mathworks.com/help/deeplearning/ug/pretrained_20b.png" rel="noopener ugc nofollow" target="_blank">架构之一</a>。这个神经网络应该解决下一个任务:</p><ol class=""><li id="0b43" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj mm lq lr ls bi translated">对象检测或语义分割——仅提取衣服或鞋子。</li><li id="ff66" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj mm lq lr ls bi translated">使用提取的图像将其嵌入。</li></ol><p id="0cc1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然后保存所有嵌入，以在将来计算彼此之间的距离或与新的距离。为了解决这个任务，我们可以使用<a class="ae jn" href="https://engineering.fb.com/2017/03/29/data-infrastructure/faiss-a-library-for-efficient-similarity-search/" rel="noopener ugc nofollow" target="_blank"> Faiss </a>。Faiss是一个用于高效相似性搜索的库。</p><p id="6ec2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于文本预处理，我们可以使用BERT方法的任何实现。</p><p id="01d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">对于音频处理，我们可以仅使用python进行简单的信号处理构建，而无需任何深度学习，或者使用CNN/LSTM架构来构建音轨嵌入。</p><p id="ec61" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这个算法两边都适合。买家可以花更少的时间在数字市场中搜索不同产品的页面。卖家可以更好地了解客户偏好，提供更个性化的买家体验，提高销售额，建立品牌忠诚度。</p><h2 id="5cac" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated"><strong class="ak">协同过滤</strong></h2><blockquote class="mn mo mp"><p id="dafd" class="jo jp mq jq b jr js ij jt ju jv im jw mr jy jz ka ms kc kd ke mt kg kh ki kj hb bi translated">下一个方法可能是最著名和最常用的方法之一。这种方法给推荐系统带来了一场革命。<strong class="jq hj">协作过滤</strong>是一种通过从许多用户(协作)收集偏好或品味信息来对用户的兴趣进行自动预测(过滤)的方法。协同过滤方法的基本假设是，如果人A在一个问题上与人B有相同的观点，则A更有可能在一个不同的问题上与随机选择的人有不同的观点。— <a class="ae jn" href="https://en.wikipedia.org/wiki/Collaborative_filtering#:~:text=Collaborative%20filtering%20(CF)%20is%20a%20technique%20used%20by%20recommender%20systems.&amp;text=In%20the%20newer%2C%20narrower%20sense,from%20many%20users%20(collaborating)." rel="noopener ugc nofollow" target="_blank">维基</a></p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mu"><img src="../Images/248a70fee25c96beadd41b2e64870a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*Xe-IeHeYvkb49fgz.gif"/></div><figcaption class="jj jk et er es jl jm bd b be z dx"><a class="ae jn" href="https://en.wikipedia.org/wiki/Recommender_system#/media/File:Collaborative_filtering.gif" rel="noopener ugc nofollow" target="_blank">An example of collaborative filtering based on a rating system</a></figcaption></figure><p id="15d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">协同过滤有几种类型:</strong></p><ul class=""><li id="2e83" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">基于记忆的</li></ul><p id="02f7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这种方法使用用户的评级数据来计算用户或项目之间的相似性。这种方法的典型例子是基于邻居的CF和基于项目/基于用户的top-N推荐。</p><p id="98a4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">基于项目的协作过滤——基于新项目与用户过去评价高的项目的相似性向用户推荐新项目。</p><p id="8fad" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">基于用户的协同过滤——这种方法旨在找到相似的用户，并根据相似用户的喜好向用户提供推荐。用户之间的相似性是使用余弦相似性或皮尔逊相关来计算的，或者您可以根据您的数据使用任何其他相似性度量。</p><p id="b195" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这种方法的主要优点是结果的可解释性，这是当今任何数据科学算法中的一个重要方面，而且它易于创建模型，易于用新数据重新训练。</p><p id="d73c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它也有一些缺点。由于数据量大且稀疏，导致性能下降。添加新项也是一个重新插入结构中所有元素的问题。</p><ul class=""><li id="e4de" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">基于模型的</li></ul><p id="bed8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这种方法中，使用不同的数据挖掘、机器学习算法来开发模型，以预测用户对未评级项目的评级。作为模型最常用的算法是降维方法。像奇异值分解、主成分分析这样的方法根据潜在因素将用户项目矩阵压缩成低维表示。使用这种方法的主要优点是，我们将在低维空间中处理一个小得多的矩阵，而不是拥有一个包含大量缺失值的高维矩阵。维数减少可以用于这里描述的基于用户或基于项目的邻域算法。</p><p id="a4f9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是一些基于模型的方法的层次结构:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mv"><img src="../Images/cfd9c523e6fe7d0d4a5a717791b93b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*kX_hFDpvGhMspLECN7DM6Q.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Hierarchy of model-based approach (Image by Author)</figcaption></figure><p id="41e3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以在<a class="ae jn" href="https://spark.apache.org/docs/2.2.0/ml-collaborative-filtering.html" rel="noopener ugc nofollow" target="_blank"> Pyspark实现</a>中找到一个很好的协同过滤实现。下面是一些例子(Pyspark文档中的<em class="mq">代码)</em>:</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="0b01" class="kk kl hi mc b fi mg mh l mi mj"><strong class="mc hj">from</strong> <strong class="mc hj">pyspark.ml.evaluation</strong> <strong class="mc hj">import</strong> RegressionEvaluator<br/><strong class="mc hj">from</strong> <strong class="mc hj">pyspark.ml.recommendation</strong> <strong class="mc hj">import</strong> ALS<br/><strong class="mc hj">from</strong> <strong class="mc hj">pyspark.sql</strong> <strong class="mc hj">import</strong> Row</span><span id="50a9" class="kk kl hi mc b fi mw mh l mi mj">lines = spark.read.text("sample_movielens_ratings.txt").rdd<br/>parts = lines.map(<strong class="mc hj">lambda</strong> row: row.value.split("::"))<br/>ratingsRDD = parts.map(<strong class="mc hj">lambda</strong> p: Row(userId=int(p[0]), movieId=int(p[1]),<br/>                                     rating=float(p[2]), timestamp=long(p[3])))<br/>ratings = spark.createDataFrame(ratingsRDD)<br/>(training, test) = ratings.randomSplit([0.8, 0.2])</span><span id="cc55" class="kk kl hi mc b fi mw mh l mi mj"><em class="mq"># Build the recommendation model using ALS on the training data</em><br/><em class="mq"># Note we set cold start strategy to 'drop' to ensure we don't get NaN evaluation metrics</em><br/>als = ALS(maxIter=5, regParam=0.01, userCol="userId", itemCol="movieId", ratingCol="rating",<br/>          coldStartStrategy="drop")<br/>model = als.fit(training)</span><span id="c9a3" class="kk kl hi mc b fi mw mh l mi mj"><em class="mq"># Evaluate the model by computing the RMSE on the test data</em><br/>predictions = model.transform(test)<br/>evaluator = RegressionEvaluator(metricName="rmse", labelCol="rating",<br/>                                predictionCol="prediction")<br/>rmse = evaluator.evaluate(predictions)<br/><strong class="mc hj">print</strong>("Root-mean-square error = " + str(rmse))</span><span id="5425" class="kk kl hi mc b fi mw mh l mi mj"><em class="mq"># Generate top 10 movie recommendations for each user</em><br/>userRecs = model.recommendForAllUsers(10)<br/><em class="mq"># Generate top 10 user recommendations for each movie</em><br/>movieRecs = model.recommendForAllItems(10)</span></pre><ul class=""><li id="32d9" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">深度学习</li></ul><p id="f6d7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当然，也不是没有深度学习)近年来，许多神经和深度学习技术被提出。一些算法通过非线性神经架构来推广传统矩阵分解算法，或者利用新的模型类型，如变分自动编码器。</p><p id="728d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里有一些<a class="ae jn" href="https://github.com/fastai/fastbook/blob/master/08_collab.ipynb" rel="noopener ugc nofollow" target="_blank">和<a class="ae jn" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank">快速</a>的例子</a>。</p><p id="7565" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">此外，我们可以使用更复杂的深度学习方法，例如，混合我们所有可能的数据，建立一个超级复杂的神经网络:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/2661aea3d6902e3a7d3b88d128bc624a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_387u-OOnoQT7UnjUTkjw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Example of NN architecture (Image by Author)</figcaption></figure><p id="8bff" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">下面是一些嵌入了用户、项目和项目类型的Keras实现:</p><pre class="iy iz ja jb fd mb mc md me aw mf bi"><span id="c16a" class="kk kl hi mc b fi mg mh l mi mj">item_input = keras.layers.Input(shape=[1],name='Item')<br/>item_embedding = keras.layers.Embedding(n_items + 1, n_latent_factors_item, name='Movie-Embedding')(item_input)<br/>item_vec = keras.layers.Flatten(name='FlattenMovies')(item_embedding)<br/>item_vec = keras.layers.Dropout(0.25)(item_vec)</span><span id="1052" class="kk kl hi mc b fi mw mh l mi mj">user_input = keras.layers.Input(shape=[1],name='User')<br/>user_vec = keras.layers.Flatten(name='FlattenUsers')(keras.layers.Embedding(n_users + 1, n_latent_factors_user,name='User-Embedding')(user_input))<br/>user_vec = keras.layers.Dropout(0.25)(user_vec)</span><span id="e574" class="kk kl hi mc b fi mw mh l mi mj">type_input = keras.layers.Input(shape=[1],name='type')<br/>type_vec = keras.layers.Flatten(name='FlattenType')(keras.layers.Embedding(n_type + 1, n_latent_factors_user_type,name='Type-Embedding')(type_input))<br/>type_vec = keras.layers.Dropout(0.25)(type_vec)</span><span id="9238" class="kk kl hi mc b fi mw mh l mi mj">#concat = keras.layers.merge([movie_vec, user_vec], mode='concat',name='Concat')<br/>concat  = keras.layers.concatenate([item_vec, user_vec, type_vec],name='DotProduct')<br/>concat_dropout = keras.layers.Dropout(0.25)(concat)<br/>dense = keras.layers.Dense(200,name='FullyConnected')(concat)<br/>dropout_1 = keras.layers.Dropout(0.25,name='Dropout')(dense)<br/>dense_2 = keras.layers.Dense(100,name='FullyConnected-1')(concat)<br/>dropout_2 = keras.layers.Dropout(0.25,name='Dropout')(dense_2)<br/>dense_3 = keras.layers.Dense(50,name='FullyConnected-2')(dense_2)<br/>dropout_3 = keras.layers.Dropout(0.25,name='Dropout')(dense_3)<br/>dense_4 = keras.layers.Dense(20,name='FullyConnected-3', activation='relu')(dense_3)</span><span id="3e1d" class="kk kl hi mc b fi mw mh l mi mj">result = keras.layers.Dense(1, activation='relu',name='Activation')(dense_4)<br/>adam = Adam(lr=0.003)<br/>model = keras.Model([user_input, item_input, type_input], result)<br/>model.compile(optimizer=adam,loss= 'mean_absolute_error')Importance of RE</span></pre><p id="0a1d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这只是在推荐系统中使用深度神经网络的一个例子。根据我们的任务，我们可以使用其他架构，例如，使用具有长期记忆能力的循环网络可能更适合预测下一步行动(下一次购买):</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/9b061cd8a7764c3605ad977241a24a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d5inMSXYzXUjf7hCwfdyRA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Architecture schema example (Image by Author)</figcaption></figure><p id="cfc6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以看到，基于模式的方法可以解决各种类型的问题，其他方法也有各自的优缺点:</p><p id="7a1f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">基于模型的算法的优势:</strong></p><ul class=""><li id="96ee" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">基于模型的CF技术解决了基于内存的CF算法的缺点，如可扩展性和稀疏性。</li><li id="cd1a" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">它还提高了预测性能</li></ul><p id="fbef" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">基于模型的算法的缺点:</strong></p><ul class=""><li id="bce7" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">基于模型的CF技术以预测性能为代价提高了可扩展性。</li><li id="3830" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">建模很贵。</li></ul><p id="1d01" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们继续分析<strong class="jq hj">混合推荐系统</strong>。</p><h2 id="afbe" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated"><strong class="ak">混合推荐系统</strong></h2><p id="eae3" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">混合方法可以通过多种方式实现:</p><ul class=""><li id="f3e7" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">分别创建基于内容和基于协作的预测模型，然后将它们的结果组合在一起；</li><li id="b7d8" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">将基于内容的能力优势添加到基于协作的模型中；</li></ul><p id="bb38" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">与仅使用其中一种方法相比，混合方法可以提供更准确的推荐。这些方法还可以解决冷启动和稀疏问题等常见问题。</p><p id="dfac" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">有几种杂交技术:</p><ul class=""><li id="2a41" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">加权:不同推荐组件的分数以数字方式组合。</li><li id="3583" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">切换:推荐系统在组件中进行选择，并应用所选的组件。</li><li id="31dc" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">混合:来自不同模型的推荐被一起呈现给用户/客户以选择推荐。</li><li id="ae2f" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">特征组合:来自不同知识源的特征被组合，并被给予单个推荐算法。</li><li id="9a77" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">特征扩充:用于计算一组特征的模型之一，然后作为输入传递给另一个模型。</li><li id="ca5c" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">级联:模型具有严格的优先级，优先级较低的模型在较高模型的评分中提供推荐关系。</li><li id="4ff8" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">元级:一个算法被应用并产生某种模型，然后它是下一个算法使用的输入。</li></ul><p id="f3e0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">大多数大公司在生产中使用混合方法，它更复杂但更灵活地解决各种各样的任务。</p><p id="8150" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">实现这种方法的最著名的例子是网飞。你可以在这篇<a class="ae jn" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fnetflixtechblog.com%2Fsystem-architectures-for-personalization-and-recommendation-e081aa94b5d8&amp;psig=AOvVaw2a0LfMOlgFnSpJilqljTiu&amp;ust=1636445899192000&amp;source=images&amp;cd=vfe&amp;ved=0CAwQjhxqFwoTCND6uKGqiPQCFQAAAAAdAAAAABAX" rel="noopener ugc nofollow" target="_blank">文章</a>中读到所有细节。</p><p id="8649" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以上只是推荐系统的基本技术和方法的一小部分。如今这种方法变得更加流行:</p><ul class=""><li id="c2b4" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">基于图学习的推荐系统</li><li id="a9a9" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">基于强化学习的推荐系统</li></ul><p id="71ce" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">但是，无论我们使用什么技术和方法，我们都应该记住建立推荐系统的道德因素。</p><h2 id="5e80" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">推荐系统的伦理方面</h2><ul class=""><li id="db5c" class="lk ll hi jq b jr lf ju lg jx mz kb na kf nb kj lp lq lr ls bi translated">数据收集。​​</li><li id="225a" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">用户特征分析。​​</li><li id="810f" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">数据发布。​​</li><li id="f612" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">数据过滤/算法不透明。​​</li><li id="eac9" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">行为操纵。​​</li><li id="7ac2" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">A/B测试。​</li></ul><p id="009c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们应该如何遵守道德标准:</p><ul class=""><li id="0955" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">识别和研究个性化过滤的社会心理影响；​</li><li id="30fd" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">帮助人们理解和规范隐私水平(效仿GDPR和CCPA)；​</li><li id="9250" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">开发一种方法来探测基于用户兴趣提供给用户的信息的主观“有效性”;​</li><li id="86ea" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">与企业信息服务提供商合作，加强道德实践。</li></ul><h2 id="3d83" class="kk kl hi bd km kn ko kp kq kr ks kt ku jx kv kw kx kb ky kz la kf lb lc ld le bi translated">结论</h2><p id="200d" class="pw-post-body-paragraph jo jp hi jq b jr lf ij jt ju lg im jw jx lh jz ka kb li kd ke kf lj kh ki kj hb bi translated">推荐算法和系统在其开发和使用方面已经走过了漫长的道路。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nc"><img src="../Images/4fac0edfb22fa8ebbc22965dcc57eeb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNFOUy38ORQi3g2J7R6G5w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">History of Recommender System (Image by Author)</figcaption></figure><p id="2c90" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它们越来越多地被用于更多的用户/客户/客户互动。</p><ul class=""><li id="60e5" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">根据麦肯锡的数据<a class="ae jn" href="https://www.mckinsey.com/industries/retail/our-insights/how-retailers-can-keep-up-with-consumers" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"/></a>，亚马逊上35%的购买是他们推荐系统的结果。</li><li id="736d" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">据<a class="ae jn" href="http://www.alizila.com/at-alibaba-artificial-intelligence-is-changing-how-people-shop-online/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> Alizila </strong> </a>报道，在2016年11月11日中国全球购物节期间，阿里巴巴利用个性化登陆页面实现了高达20%的转化率增长。</li><li id="078c" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">推荐负责了人们在<a class="ae jn" href="https://www.cnet.com/news/youtube-ces-2018-neal-mohan/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> YouTube </strong> </a>上观看视频的70%时间。</li><li id="fe1e" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">根据麦肯锡的数据，人们在网飞观看的75%来自推荐。</li><li id="e8e2" class="lk ll hi jq b jr lt ju lu jx lv kb lw kf lx kj lp lq lr ls bi translated">根据一位高管撰写的文章，使用推荐系统使网飞每年节省大约10亿美元:</li></ul><blockquote class="mn mo mp"><p id="94e8" class="jo jp mq jq b jr js ij jt ju jv im jw mr jy jz ka ms kc kd ke mt kg kh ki kj hb bi translated">"<em class="hi">每月客户流失的减少既增加了现有用户的终身价值，又减少了我们为替换被取消的会员而需要获得的新用户数量。我们认为个性化和推荐的综合效果每年为我们节省了超过$1B。</em></p></blockquote><ul class=""><li id="81aa" class="lk ll hi jq b jr js ju jv jx lm kb ln kf lo kj lp lq lr ls bi translated">据麦肯锡<a class="ae jn" href="https://www.mckinsey.com/business-functions/marketing-and-sales/how-we-help-clients/clm-online-retailer" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"/></a>称，交叉销售和品类渗透技术使销售额增加了20%，利润增加了30%。</li></ul><p id="5136" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它可以用于个性化营销、在线广告、为客户寻找最佳报价、提供折扣、推荐下一个最佳报价、寻找经常一起购买的物品以进行交叉销售，等等。</p><p id="2d02" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">推荐系统是高效的数据科学解决方案，可以帮助提高客户满意度和保留率，并大幅增加您的业务收入。</p></div></div>    
</body>
</html>
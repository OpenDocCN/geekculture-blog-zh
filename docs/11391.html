<html>
<head>
<title>Dealing with Null values in Pandas Dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理熊猫数据框架中的空值</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/dealing-with-null-values-in-pandas-dataframe-1a67854fe834?source=collection_archive---------3-----------------------#2022-03-20">https://medium.com/geekculture/dealing-with-null-values-in-pandas-dataframe-1a67854fe834?source=collection_archive---------3-----------------------#2022-03-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="40f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">价值观缺失问题在现实世界中非常普遍。例如，假设您正试图从一家公司收集信息。有一个用于<em class="jd">公司地址</em>的字段。许多人希望保护自己的隐私，将此字段留空。如果数据是由pandas加载的，这些空字段将被列为<strong class="ih hj">缺失值</strong>。<code class="du je jf jg jh b">NaN</code>是熊猫中缺省的缺失值。在这篇文章中，让我们看看如何处理它们。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ji"><img src="../Images/5f13bef2b80afd9a69f1ed3435c85fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c9Vbuz9ZTUq18gbT"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx">Photo by <a class="ae jy" href="https://unsplash.com/@benhershey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ben Hershey</a> on <a class="ae jy" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="a203" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">对<code class="du je jf jg jh b">NaN</code>数据的常见操作</h2><ul class=""><li id="1b1e" class="ku kv hi ih b ii kw im kx iq ky iu kz iy la jc lb lc ld le bi translated">当对包含缺失值的序列执行<code class="du je jf jg jh b">mean</code> / <code class="du je jf jg jh b">sum</code> / <code class="du je jf jg jh b">std</code> / <code class="du je jf jg jh b">median</code>时，这些值将被视为零。</li><li id="69a4" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated">执行<code class="du je jf jg jh b">add</code> / <code class="du je jf jg jh b">div</code> / <code class="du je jf jg jh b">sub</code>时，结果为<code class="du je jf jg jh b">NaN</code>。</li><li id="f3ef" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated">如果所有数据都是<code class="du je jf jg jh b">NaN</code>，则<code class="du je jf jg jh b">sum()</code>结果为零。</li></ul><p id="7a5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">pd.Series([np.nan]).sum() #result is zer</code></p><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="a345" class="jz ka hi jh b fi lo lp l lq lr">import pandas as pd<br/>s = pd.Series([1, 2, None, 4])<br/>print(s)<br/>s1 = pd.Series([2, 3, 5, 6])</span><span id="2506" class="jz ka hi jh b fi ls lp l lq lr"># The third value is NA<br/>print(s + s1)</span><span id="d098" class="jz ka hi jh b fi ls lp l lq lr"># sum a series only contains NaN<br/>s2 = pd.Series([None, None])<br/>print(s2.sum())</span></pre><p id="20a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">line 3</code>显示包含一个<code class="du je jf jg jh b">NaN</code>元素的Series对象的总和。<code class="du je jf jg jh b">line 7</code>显示添加两个系列对象，其中一个包含一个<code class="du je jf jg jh b">NaN</code>元素。<code class="du je jf jg jh b">line 11</code>显示只包含<code class="du je jf jg jh b">NaN</code>的a系列求和的结果。</p><h2 id="0343" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">NaN上的Groupby操作</h2><p id="5341" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">如上所述，<code class="du je jf jg jh b">NaN</code>在大多数操作中会被视为零。然而，在<code class="du je jf jg jh b">groupby</code>中，<code class="du je jf jg jh b">NaN</code>被自动排除。</p><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="3a1a" class="jz ka hi jh b fi lo lp l lq lr">import pandas as pd<br/>data = {“key”: [“K0”, “K0”, “K0”, None, None], “val”: [1, 2, 3, 4, 5]}</span><span id="d884" class="jz ka hi jh b fi ls lp l lq lr">group = pd.DataFrame(data).groupby(“key”).mean()<br/>print(group)</span></pre><h1 id="2c3c" class="lw ka hi bd kb lx ly lz kf ma mb mc kj md me mf km mg mh mi kp mj mk ml ks mm bi translated">NaN值的函数运算</h1><h2 id="6323" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated"><code class="du je jf jg jh b">isnull</code>功能</h2><p id="b375" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">为了检查数据是否为<strong class="ih hj"> NA </strong>，<code class="du je jf jg jh b">isnull()</code>返回一个大小相同的布尔值数据帧。当值为<code class="du je jf jg jh b">NaN</code>时，对应位置为真，否则为假</p><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="870c" class="jz ka hi jh b fi lo lp l lq lr">import pandas as pd<br/>s = pd.Series([1, 2, None, 4])<br/>print(“The original series object.”)<br/>print(s)<br/>print(“The result after calling isnull”)<br/>print(s.isnull())</span></pre><p id="ef8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如<code class="du je jf jg jh b">isnull()</code>的输出所示，它是一个与原始对象长度相同的布尔值序列对象。</p><h2 id="3a60" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">菲尔纳函数</h2><p id="6293" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">pandas提供了一个非常有用的函数来填充缺失值，<code class="du je jf jg jh b">fillna()</code></p><p id="1929" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正常情况下，<code class="du je jf jg jh b">fillna()</code>只要传递一个静态描述值就足够解决问题了。</p><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="3f29" class="jz ka hi jh b fi lo lp l lq lr">improt pandas as pd<br/>s = pd.Series([1, 2, None, 4])<br/>s.fillna(6)</span></pre><p id="d2aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，当您处理时间序列数据时，用最后一个非缺失值填充缺失值是非常常见的。</p><ul class=""><li id="6669" class="ku kv hi ih b ii ij im in iq mn iu mo iy mp jc lb lc ld le bi translated"><code class="du je jf jg jh b">fillna(method='ffill')</code>从下一个值中填充缺少的值。</li><li id="698f" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><code class="du je jf jg jh b">fillna(method='bfill')</code>从最后一个值或最后一个非缺失值开始填充缺失值。</li><li id="fb2b" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><code class="du je jf jg jh b">ffill</code>相当于<code class="du je jf jg jh b">fillna(method='ffill')</code>。</li><li id="eec1" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><code class="du je jf jg jh b">bfill</code>相当于<code class="du je jf jg jh b">fillna(method='bfill')</code>。</li></ul><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="8535" class="jz ka hi jh b fi lo lp l lq lr">import pandas as pd<br/>s = pd.Series([1,2,None,None,5,6])<br/>print(“The original value”)<br/>print(s.values)<br/>print(“Fill the value by forward method”)<br/>print(“The None value is filled by the last seen value \”2\””)<br/>s1 = s.fillna(method=”ffill”)<br/>print(s1.values)</span></pre><p id="9fe6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我们用最后看到的值<code class="du je jf jg jh b">2</code>填充这些<code class="du je jf jg jh b">NaN</code>值。</p><h2 id="5afa" class="jz ka hi bd kb kc kd ke kf kg kh ki kj iq kk kl km iu kn ko kp iy kq kr ks kt bi translated">丢弃<code class="du je jf jg jh b">NaN</code>数据</h2><p id="c4e4" class="pw-post-body-paragraph if ig hi ih b ii kw ik il im kx io ip iq lt is it iu lu iw ix iy lv ja jb jc hb bi translated">NaN数据上最常用的函数，为了从数据帧中删除一个<code class="du je jf jg jh b">NaN</code>值，我们使用了<code class="du je jf jg jh b">dropna()</code>函数。该函数删除具有<code class="du je jf jg jh b">NaN</code>值的数据行/列。</p><ul class=""><li id="c0e9" class="ku kv hi ih b ii ij im in iq mn iu mo iy mp jc lb lc ld le bi translated"><code class="du je jf jg jh b">dropna()</code> -删除至少有一个<code class="du je jf jg jh b">NaN</code>值的行。</li><li id="331b" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><code class="du je jf jg jh b">dropna(how = 'all')</code> -删除所有值都为<code class="du je jf jg jh b">NaN</code>的行。</li><li id="ebeb" class="ku kv hi ih b ii lf im lg iq lh iu li iy lj jc lb lc ld le bi translated"><code class="du je jf jg jh b">dropna(axis = 1)</code> -删除至少有一个<code class="du je jf jg jh b">NaN</code>值的列。</li></ul><pre class="jj jk jl jm fd lk jh ll lm aw ln bi"><span id="7706" class="jz ka hi jh b fi lo lp l lq lr">import pandas as pd</span><span id="dd2c" class="jz ka hi jh b fi ls lp l lq lr">d = {</span><span id="1d36" class="jz ka hi jh b fi ls lp l lq lr">"a": [1, 2, 3, None],</span><span id="a3b9" class="jz ka hi jh b fi ls lp l lq lr">"b": [1, None, 3, None],</span><span id="c7fd" class="jz ka hi jh b fi ls lp l lq lr">"c": [1, 2, 3, None],</span><span id="ebc9" class="jz ka hi jh b fi ls lp l lq lr">"d": [1, 2, 3, None]</span><span id="cdc7" class="jz ka hi jh b fi ls lp l lq lr">}<br/></span><span id="c02b" class="jz ka hi jh b fi ls lp l lq lr">df = pd.DataFrame(d)<br/>print("The original DataFrame")<br/>print(df)</span><span id="ed06" class="jz ka hi jh b fi ls lp l lq lr">print("-----------------------------")</span><span id="7938" class="jz ka hi jh b fi ls lp l lq lr">df1 = df.dropna()<br/>print("Rows with index 1 and 3 are dropped.")<br/>print(df1)</span><span id="4649" class="jz ka hi jh b fi ls lp l lq lr">print("-----------------------------")</span><span id="2fb0" class="jz ka hi jh b fi ls lp l lq lr">print("Rows with index 3 are dropped, whose values are all NA")<br/>df2 = df.dropna(how='all')<br/>print(df2)</span><span id="692d" class="jz ka hi jh b fi ls lp l lq lr">print("-----------------------------")</span><span id="3951" class="jz ka hi jh b fi ls lp l lq lr">df['e'] = df['a'].fillna(1) + 1<br/>print("Column a b c d are dropped")<br/>df3 = df.dropna(axis=1)<br/>print(df3)</span></pre><p id="9867" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">line 13</code>显示了如何删除至少包含一个<code class="du je jf jg jh b">NaN</code>元素的行。</p><p id="2f7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">line 19</code>展示了如何删除所有元素都是<code class="du je jf jg jh b">NaN</code>的行。</p><p id="b695" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">line 25</code>显示了如何删除至少包含一个<code class="du je jf jg jh b">NaN</code>元素的列。</p></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><p id="de02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">空值在现实世界中很常见。处理空值将有助于我们在进行繁重操作时优化性能，并使数据帧更加健壮。下次见，再见！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Front-End Development Without node_modules</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">没有节点模块的前端开发</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/front-end-development-without-node-modules-ff64cf7d511d?source=collection_archive---------7-----------------------#2021-02-03">https://medium.com/geekculture/front-end-development-without-node-modules-ff64cf7d511d?source=collection_archive---------7-----------------------#2021-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2272" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">曾几何时，我们可以简单地将一个HTML和一个脚本文件放入FTP服务器，很快就有了一个工作网站，然后就可以收工了。</p><p id="5b1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，我们不得不经历重重困难，只为在正确的地方得到正确的东西。假设爱丽丝想用她的周末做一个简单的待办应用程序或任何她喜欢的小创意。首先，她必须安装一大堆10k npm软件包文件。然后，她花了几个小时搜索如何让本周的js bundler使用最新的typescript和最新的趋势UI框架。当事情不工作或那些文章刚刚过时时，会很沮丧。一旦她实际上开始为她的小有趣的应用程序建立第一个功能，周末几乎已经过去了！</p><p id="dba0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是事情正在改变…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b19b88b5b9f0e6e885c7ee829fcc27c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zmd0RSHU7MxLepJABKnn9w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Does Alice have to stay late on Sunday night to enjoy making her little fun app? (photo: <a class="ae jt" href="https://www.pexels.com/@paras?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Paras Katwal</a>)</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="6bb8" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">1.一点背景知识:CommonJS和ES模块</h1><p id="8907" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">使用NodeJS，我们都熟悉CommonJS，这是NodeJS加载依赖代码的标准(read: legacy)方式。在安装一个模块之后，比如说<code class="du le lf lg lh b">lodash</code>，我们可以通过使用<code class="du le lf lg lh b">require('lodash')</code>将它加载到我们的代码中。NodeJS从一开始就是这样处理依赖关系代码的:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="d42b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ECMAScript 2015 (ES6)推出了ES Module——一个官方的、标准化的JavaScript模块系统。到这里花了一段时间。如今，<a class="ae jt" href="https://caniuse.com/es6-module" rel="noopener ugc nofollow" target="_blank">各大浏览器</a>和NodeJS ( <a class="ae jt" href="https://nodejs.medium.com/announcing-core-node-js-support-for-ecmascript-modules-c5d6dc29b663" rel="noopener">从v13.2.0 </a>开始)默认发货支持ES模块。ES模块具有静态分析、树抖动和异步的优点。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="2a7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在NodeJS中，要启用ES模块，我们有两种选择:使用<strong class="ih hj">。mjs </strong>扩展或设置<strong class="ih hj">包中的<code class="du le lf lg lh b">"type": "module"</code>. JSON</strong>。虽然大多数开发工具都理解ES模块，但是仍然有许多不兼容的地方。例如，TypeScript仍然不支持输出到。mjs文件。或者Vercel <a class="ae jt" href="https://github.com/vercel/next.js/issues/9607" rel="noopener ugc nofollow" target="_blank">与es模块</a>不兼容。所以仍然需要一些transpilers和变通方法。希望这种情况会很快改变。</p><p id="6e39" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">NodeJS中的许多包已经附带了es模块文件。但是很多包都不是。在撰写本文时，在npm 上的<a class="ae jt" href="https://www.npmjs.com/browse/depended" rel="noopener ugc nofollow" target="_blank">前10个依赖包中，只有</a><a class="ae jt" href="https://www.npmjs.com/package/tslib" rel="noopener ugc nofollow" target="_blank"> tslib </a>通过将<code class="du le lf lg lh b">"exports"</code>包含在<em class="lk"> package.json </em>中来支持<a class="ae jt" href="https://github.com/microsoft/tslib/blob/e7a115533a28b90e48139e77462e0b5812983847/package.json#L25" rel="noopener ugc nofollow" target="_blank"> ES模块文件</a>。许多其他顶级软件包仍然不提供es模块:lodash，moment，react，request，axios，chalk，commander，express...这对于NodeJS来说实际上不是问题，因为NodeJS允许使用<a class="ae jt" href="https://nodejs.org/api/esm.html#esm_interoperability_with_commonjs" rel="noopener ugc nofollow" target="_blank"> import来处理ES模块和CommonJS格式</a>。</p><p id="40e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是浏览器没有这个特权。想在浏览器中导入自己喜欢的节点模块怎么办？嗯，你得走运。在撰写本文时，<a class="ae jt" href="https://reactjs.org/docs/getting-started.html#add-react-to-a-website" rel="noopener ugc nofollow" target="_blank">React在浏览器中入门的推荐方式</a>是在<code class="du le lf lg lh b">&lt;script&gt;</code>标签中包含UMD版本，并使用全局变量<code class="du le lf lg lh b">window.ReactDOM</code>:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="c122" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有爱丽丝的ES模块。</p><h1 id="3575" class="kb kc hi bd kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku lp kw kx ky bi translated">2.Skypack</h1><p id="8dee" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Skypack是一项出色的CDN服务，transpiles node将其打包，以便能够在浏览器中很好地工作。它得到了扫雪队的支持。只需将包<strong class="ih hj"> name@version </strong>放在<strong class="ih hj"> cdn.skypack.dev </strong>之后，就可以开始了:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="4d8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是管用！当然，你可能会问，我们可以进口“T21”牌lodash-es 。但是许多包裹没有它们的二重身。或者它们不经常更新。这里，<a class="ae jt" href="https://skypack.dev" rel="noopener ugc nofollow" target="_blank"> skypack.dev </a>来帮忙了。</p><p id="7c5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管如此，它仍然存在一些问题。由于不清楚的原因，一些版本不工作。游览<a class="ae jt" href="https://cdn.skypack.dev/react@16" rel="noopener ugc nofollow" target="_blank">cdn.skypack.dev/react@16</a>时，改为React版本17。但是未来是光明的。Alice现在可以开始在她的应用程序上工作，而不用花费她周末的大部分时间来配置本周的js bundler …</p><p id="40ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lk">边注</em> </strong> : <em class="lk">我也把自己的版本放在了</em><a class="ae jt" href="https://espkg.vercel.app/react@16" rel="noopener ugc nofollow" target="_blank"><em class="lk">espkg.vercel.app/react@16</em></a><em class="lk">。你可以使用</em><a class="ae jt" href="https://espkg.vercel.app" rel="noopener ugc nofollow" target="_blank"><em class="lk">espkg . vercel . app</em></a><em class="lk">作为替代，直到Skypack修复问题。其他的包也可以，比如espkg.vercel.app/lodash@4的</em><a class="ae jt" href="https://espkg.vercel.app/lodash@4" rel="noopener ugc nofollow" target="_blank"><em class="lk"/></a><em class="lk">(给它一点构建的时间，然后响应会被Vercel缓存)。</em></p><h1 id="bccc" class="kb kc hi bd kd ke ll kg kh ki lm kk kl km ln ko kp kq lo ks kt ku lp kw kx ky bi translated">3.积雪场</h1><p id="b026" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">好吧，我撒了点谎。<em class="lk"> TypeScript </em>在浏览器中直接不起作用。你仍然需要更多的工作。这就是<a class="ae jt" href="https://snowpack.dev" rel="noopener ugc nofollow" target="_blank"> Snowpack </a>的真正威力:最小配置和远程包。你甚至不需要安装<em class="lk"> node_modules </em>就可以开始使用你的小程序。只需运行两个安装命令:</p><pre class="je jf jg jh fd lq lh lr ls aw lt bi"><span id="38ee" class="lu kc hi lh b fi lv lw l lx ly">yarn global add snowpack<br/>snowpack init</span></pre><p id="fc10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这会给你一个空骨架<strong class="ih hj"> snowpack.config.js </strong>。然后在<code class="du le lf lg lh b">packageOptions</code>下增加单线配置<code class="du le lf lg lh b">source: 'remote'</code>:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="86e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已！现在运行<code class="du le lf lg lh b">snowpack dev</code>，开始添加你的<strong class="ih hj">index.html</strong>和<strong class="ih hj"> myscript.ts </strong>(没错，就是<em class="lk">打字稿</em>):</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="b0a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是管用！🎉看马，没有<em class="lk"> node_modules！</em>没有<em class="lk"> package.json！我们甚至免费得到了<em class="lk">打字稿</em>和<em class="lk">热重装</em>。耶！</em></p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="07a7" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">概述</h1><p id="57a0" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">示例代码可以在这里下载:<a class="ae jt" href="https://gist.github.com/olvrng/e9729d550cb5c2e023ed0c1f8290978f" rel="noopener ugc nofollow" target="_blank">gist.github.com/olvrng</a>。在<a class="ae jt" href="https://www.snowpack.dev/reference/configuration" rel="noopener ugc nofollow" target="_blank"> snowpack.config.js </a>上还有你可能需要的其他配置。让我们把那个留到下一天。现在开始修补你的应用程序，把你宝贵的时间花在最有价值的功能上吧！🚀🚀</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="96f7" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">附言</h1><p id="25b3" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">哦，不过爱丽丝想少用<a class="ae jt" href="http://lesscss.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"/></a>。别担心，只是一个单行配置…我发誓！她可以添加一个文件<strong class="ih hj"> mystyle.less </strong>和多一行<strong class="ih hj"> snowpack.config.js </strong>。一切都会好的。嗯，这次她一定要记得跑<code class="du le lf lg lh b">yarn add snowpack-plugin-less</code>！只是这次...</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="0cac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您的阅读！还有别忘了我的小页面<a class="ae jt" href="https://espkg.vercel.app/" rel="noopener ugc nofollow" target="_blank"> espkg.vercel.app </a>。</p><p id="3789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lk">先前发表于</em><a class="ae jt" href="https://olvrng.github.io/w/2021.02.02.snowpack/" rel="noopener ugc nofollow" target="_blank"><em class="lk">olvrng . github . io</em></a><em class="lk">。</em></p></div></div>    
</body>
</html>
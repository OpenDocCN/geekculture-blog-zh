<html>
<head>
<title>Handle eBay Marketplace Account Deletion Notifications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理易贝市场帐户删除通知</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/handle-ebay-marketplace-account-deletion-notifications-98843ac4589e?source=collection_archive---------16-----------------------#2021-08-18">https://medium.com/geekculture/handle-ebay-marketplace-account-deletion-notifications-98843ac4589e?source=collection_archive---------16-----------------------#2021-08-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/08cef844463905ca91dfd9b7f067d69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oGpWDAUjO2ycuLrQ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@craft_ear?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jan Tinneberg</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2adb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">也许你得到了和我一样的信息:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/28280c20e87e2b9a67d51b6c8c21106b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ddxGFsaeD4bFGYeAo1tEg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://developer.ebay.com/marketplace-account-deletion" rel="noopener ugc nofollow" target="_blank">https://developer.ebay.com/marketplace-account-deletion</a></figcaption></figure><h1 id="6e7e" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak"> <em class="kw">那么，为什么这个真的很重要呢？</em>T3】</strong></h1><blockquote class="kx ky kz"><p id="14c2" class="iv iw la ix b iy iz ja jb jc jd je jf lb jh ji jj lc jl jm jn ld jp jq jr js hb bi translated">回调URL应该立即用HTTP状态代码确认每个易贝市场帐户删除/关闭通知，表明响应成功。200 OK、201 Created、202 Accepted和204 No Content都是可接受的。对于任何没有回复易贝市场账户删除/关闭通知的回拨网址，易贝将重新发送通知到回拨网址，直到它被确认。在24小时内收到来自回调URL的多个未确认通知后，回调URL被标记为关闭，易贝将向开发者发送一封警告电子邮件，告知回调URL没有响应。收到电子邮件后，开发人员将有30天的时间来解决他们的回拨URL确认易贝市场帐户删除/关闭通知的问题。<strong class="ix hj">如果问题没有在30天内解决，开发商将被标记为不合规。</strong></p></blockquote><p id="3dec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你读了最后一句了吗？<br/> <strong class="ix hj">如果你明白了，你就知道，这能毁了你的整个生意！</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/1a1e90ad7d208f8b4d46b361bf2a8000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GbDIkZMwr2n5u-hL"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@bendavisual?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Benjamin Davies</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e6b0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我不会在这里详述，我只想建议使用<a class="ae iu" href="https://aws.amazon.com/lambda/?nc1=h_ls" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>，因为这是迄今为止处理易贝通知最简单的方法。</p><p id="a797" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我不是Lambda专家，也不是NodeJS专家，我很乐意完成这项工作，其他的我不在乎，因为我的主要语言是PHP)<br/>但是这样的事情用NodeJS很容易，https://github.com/eBay/event-notification-nodejs-sdk<a class="ae iu" href="https://github.com/eBay/event-notification-nodejs-sdk" rel="noopener ugc nofollow" target="_blank">易贝也提供了一个新的通知SDK</a></p><p id="cb71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用Lambda给你带来的好处是没有自己的服务器，在维护和监控方面，你可以承受所有的压力，当然，Lambda需要一些成本，但这些成本是一个笑话，<a class="ae iu" href="https://aws.amazon.com/lambda/pricing/?loc=ft" rel="noopener ugc nofollow" target="_blank">自己看</a>。</p><p id="7494" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，在您的本地dev env中，以下是实现这一点的步骤:</p><ul class=""><li id="1d47" class="lf lg hi ix b iy iz jc jd jg lh jk li jo lj js lk ll lm ln bi translated">npm初始化</li><li id="ae51" class="lf lg hi ix b iy lo jc lp jg lq jk lr jo ls js lk ll lm ln bi translated">npm安装事件-通知-节点js-sdk</li></ul><p id="f900" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以在这之后，你实际上拥有了你需要的一切。</p><p id="8434" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们从ebay SDK中获取<a class="ae iu" href="https://github.com/eBay/event-notification-nodejs-sdk/blob/main/examples/example.js" rel="noopener ugc nofollow" target="_blank">示例，并将其转换为Lambda函数:</a></p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="251a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">是的，请不要怪我复制粘贴代码；-) <br/>如果你想在易贝每次发送东西的时候得到一个延迟通知，可以随时更新配置并启用它。如果您想以任何其他方式处理易贝数据，请随意修改一切以满足您的需求。</p><p id="840e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您应该“压缩”这个index.js和“node_modules”:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/00357b68055e0a2422778ff25f29f016.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*CvKWWddNoTB_V-RcOTN3Jg.png"/></div></figure><p id="4e13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">转到AWS Lambda，创建一个新的“函数”并选择“HTTP-API”并上传您的zip。之后，您应该添加“API-Gateway”作为触发器，这样您将获得一个HTTPS端点，您可以使用它从外部访问您的函数。</p><p id="e4eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你不是一个开发者，这是我的框架压缩文件，但是你仍然需要配置“index.js ”,当然还要在你的易贝开发者账户中设置所有的东西。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/98eca643f729b13cba6f78b86a04d289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HP5x8T3nTF9FdDampF7F-w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">sorry, it´s german</figcaption></figure><p id="55ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事实上，就是这样。您应该通过测试挑战URL来测试您的端点:</p><blockquote class="kx ky kz"><p id="4535" class="iv iw la ix b iy iz ja jb jc jd je jf lb jh ji jj lc jl jm jn ld jp jq jr js hb bi translated"><a class="ae iu" href="https://xxxxxxxx.execute-api.eu-central-1.amazonaws.com/default/ebay-account-deletions?challenge_code=123" rel="noopener ugc nofollow" target="_blank">https://xxxxxxxx . execute-API . eu-central-1 . Amazon AWS . com/default/ebay-account-deletions？challenge_code=123 </a></p></blockquote><p id="a846" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望你会得到这样的结果:</p><blockquote class="kx ky kz"><p id="6798" class="iv iw la ix b iy iz ja jb jc jd je jf lb jh ji jj lc jl jm jn ld jp jq jr js hb bi translated">{<br/>" challenge response ":" 5fe 38234682368903 fbd5a 529599 e9 f 5 "<br/>}</p></blockquote><p id="d878" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果没有，请检查您的函数的CloudWatch-Logs，您应该会在这里看到任何类型的错误。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/f1fc9c57a5bf138c037360c1076f64ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*21SX3MEyMbIyqhVj"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@mrthetrain?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Hoehne</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a125" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">有一件非常重要的事情，你需要知道！</strong></p><p id="45b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我在这个我不太熟悉的异步javascript世界中捕捉异常有困难，我不知道如何帮助自己，<strong class="ix hj">所以我在这里修改了eBays SDK代码的一些部分；(</strong></p><p id="9bf2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">即使在阅读了<a class="ae iu" href="https://itnext.io/error-handling-with-async-await-in-js-26c3f20bc06a" rel="noopener ugc nofollow" target="_blank">这篇漂亮的文章</a>之后，我也无法捕捉到这里的异常，我认为它应该可以工作。</p><p id="1615" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我很确定，如果你在javascript方面的知识比我好，你将能够在不修改eBays SDK代码的情况下处理这个问题；)</p><p id="d3f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论如何，<a class="ae iu" href="https://github.com/michabbb/event-notification-nodejs-sdk/commits/michabbb-patch-1/" rel="noopener ugc nofollow" target="_blank">请看我在这个分支</a>中的提交，看看，我改了什么。</p><p id="51e1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我之所以做出这样的更改，是因为在调用“EventNotificationSDK.process”时，我无法捕捉到“validator.js”中的验证错误。因此，如果您知道如何正确捕捉错误和异常，请告诉我！</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/e7375d6a878f3e6a0d66d08986c02d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*klYM-wXRU7VvTF6y"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@timmossholder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tim Mossholder</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4b30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我知道，如果你以前从未使用过Lambda，这种东西会让你很困惑，但是现在有大量的教程，创建一个Lambda函数——真的——只需点击几下，非常简单。</p><p id="5add" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">试试看！</p><p id="b201" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽管这篇文章很琐碎，但我仍然希望它能帮助一些人，因为我知道自己很难找到关于易贝的有价值的信息。</p><p id="2ade" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你是一个PHP开发人员，像我一样，你经常要处理易贝API，请随意查看GitHub 上的<a class="ae iu" href="https://github.com/michabbb?tab=repositories" rel="noopener ugc nofollow" target="_blank">我的库，也许你会在那里找到有用的东西；)</a></p></div></div>    
</body>
</html>
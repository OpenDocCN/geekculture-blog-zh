<html>
<head>
<title>An Introduction to Python List Comprehension with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫对Python列表理解的介绍</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/python-list-comprehension-with-pandas-6514557babc6?source=collection_archive---------2-----------------------#2021-12-12">https://medium.com/geekculture/python-list-comprehension-with-pandas-6514557babc6?source=collection_archive---------2-----------------------#2021-12-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="bad2" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">什么是列表理解？</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/32f97eff3d0f1659a53badd70da840a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jz3C1Mbb_IcU6xcc09bWnA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://pixabay.com/users/gdj-1086657/" rel="noopener ugc nofollow" target="_blank">GDJ</a> from <a class="ae jn" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank">pixabay</a></figcaption></figure><p id="ff5a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">List comprehension是Python中一个强大的工具，使用它，以一种令人难以置信的简洁方式，我们可以把来自其他iterables的列表放在一起，如果需要的话，可以应用复杂的逻辑。对我们来说幸运的是，这个工具也可以很好地用于我们的数据项目，因为大多数时候熊猫系列对象的基本构建块之一是NumPy数组。</p><p id="109b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在，理解数组、NumPy数组和Python列表只是相似，而不是完全相同的东西是非常重要的。与传统数组相比，列表提供了更大的灵活性(在许多情况下，您需要预先声明大小和存储的数据类型)，NumPy数组包含了有助于数据处理和数据科学的功能。和往常一样，我强烈建议您浏览一下关于<a class="ae jn" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html" rel="noopener ugc nofollow" target="_blank"> NumPy数组</a>的文档，并作为一般的计算机科学学习练习，熟悉一下低级语言中数组的经典结构<a class="ae jn" href="https://www.geeksforgeeks.org/arrays-in-c-cpp/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="2ee9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">然而，幸运的是，在pandas中工作时，一个系列中的数据存储在一个NumPy数组中，我们可以非常灵活地在列表和数组之间来回转换，使得数据操作变得非常容易。</p><p id="d89b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们来看看最基本的数据帧创建:我们使用一个字典，其中键是未来的列名，值是我们将用作数据本身的元素列表:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kk"><img src="../Images/d1f395ebc513b73c4120ec82e64b7004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WvtC13Ub6ZkOSEY7"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="78c7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们也可以插入一个新列，在列表中提供新数据:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/5e7258d2ceb03e9d391398c461ac2938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9DMiWpQofn8XxEak"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="cae0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我们需要一个序列中的数据作为一个列表，调用Python的list方法来处理这个序列将会给我们一个列表，没有问题:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es km"><img src="../Images/74ef4c7b7756b5f40c20d08c52017ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pRgbjZFIu7Y5mQQ0"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><h2 id="4b21" class="kn ko hi bd kp kq kr ks kt ku kv kw kx jx ky kz la kb lb lc ld kf le lf lg lh bi translated"><strong class="ak">列表理解</strong></h2><p id="a2ee" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lk jz ka kb ll kd ke kf lm kh ki kj hb bi translated">Python的列表理解本质上是一种更短的，你可能会说更python化的语法，用于从iterable创建列表。举个最基本的例子，假设你有一个整数列表(L1 ),你想有一个L1整数平方值的新列表(L2)。最基本的解决方案是使用一个循环来完成这项工作:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ln"><img src="../Images/e523607f02ee778dda828b5e4dffed82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*umoLfnWnMMVI7syj"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="59ce" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我看来，列表理解提供了一种更优雅的方式来做到这一点:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lo"><img src="../Images/b397d6fa4f52dfab403653caed7eb168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uAMiAatiBIm1uxBE"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="b9f5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">语法一开始可能有点模糊，但是相当简单:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lp"><img src="../Images/aacb061284704be00bc43fb0836e0d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*6zeen4vDhoZ13Y3i_VRbww.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Picture by Author</figcaption></figure><p id="5312" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当你在表达式中应用condition时，它会变得有点粗糙，但并不太糟糕:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lq"><img src="../Images/78edc8a7d7935c53b05eea05fde7af33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JUG_yMMQGSDp3Ua9"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="2119" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这一细分更清楚地表明:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lr"><img src="../Images/a59643097cc79be22ed7cfb191765d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*E5eZvn0i0u6ePVOosa5-pg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Picture by Author</figcaption></figure><p id="46bd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">现在我们已经掌握了list comprehension语法是如何构造的，是时候看看数据框架的一些应用了！</p><blockquote class="ls lt lu"><p id="5ab4" class="jo jp lv jq b jr js ij jt ju jv im jw lw jy jz ka lx kc kd ke ly kg kh ki kj hb bi translated">如果你想让我保持咖啡因创造更多这样的内容，请考虑支持我，只要一杯咖啡。</p></blockquote><figure class="iy iz ja jb fd jc er es paragraph-image"><a href="https://buymeacoffee.com/zoltanguba2"><div class="er es lz"><img src="../Images/42de2d890e13d488021d94ea1a1b9877.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*SMZM9K5hha91xzFtSBS88Q.png"/></div></a></figure><h2 id="d0c0" class="kn ko hi bd kp kq kr ks kt ku kv kw kx jx ky kz la kb lb lc ld kf le lf lg lh bi translated"><strong class="ak">重命名列</strong></h2><p id="05d0" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lk jz ka kb ll kd ke kf lm kh ki kj hb bi translated">在Pandas中更改列名很容易——无论是在数据加载期间还是稍后使用rename()方法。当你有很多问题时，问题就来了。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ma"><img src="../Images/1368a14ea711dd9c3933d1d4e4e01a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2kcgAZ1XXaNdRZy4"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="58b0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，这是来自Kaggle 的IBM HR Analytics员工流失&amp;性能数据集，35列并不多，但是如果您想要重命名全部或大部分列，那么编写包含所有old_name:new_name对的字典肯定会很乏味。</p><p id="8157" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">假设您特别不喜欢长列名，并决定所有列名的最大字符数应为10，如果原来的名称比这短，它们应该保持不变:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mb"><img src="../Images/1bf227f29140df94a78daa8ab78933b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ouxgeUjciwq9jpsN"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="6a64" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这确实不是一个特别明智的修改，但是很好地说明了这一点:通过一行简单的代码和理解的使用，我们修改了长度要求所必需的所有列名。</p><p id="c5a5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">要在实践中看到条件语句，假设我们决定，如果字符数是偶数，我们只需要任何列名的前10个字符:否则，我们用列名的长度替换列名:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mc"><img src="../Images/3193a41bad543a72e0fbb7276e8a6c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xWAuI95ThtPySblu"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="c6e6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里需要注意的是，我们必须确保为新列名生成的新列表必须与旧名称列表的长度相匹配:如果我们在上面的示例中只返回偶数长度的列，我们会得到一个错误:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es md"><img src="../Images/b5930a8bc5d1b8a8776f8527f7b82e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4D7L68muX6bZekzo"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="3ac6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">还要注意，如果不想在条件语句中包含else子句，可以将if语句放在iterable 子句中item的“<em class="lv">之后，而不是之前。</em></p><h2 id="3ef2" class="kn ko hi bd kp kq kr ks kt ku kv kw kx jx ky kz la kb lb lc ld kf le lf lg lh bi translated"><strong class="ak">修改列值</strong></h2><p id="c747" class="pw-post-body-paragraph jo jp hi jq b jr li ij jt ju lj im jw jx lk jz ka kb ll kd ke kf lm kh ki kj hb bi translated">更改系列中的数据与更改列名的方式非常相似，您可能希望采取的唯一额外预防措施是考虑系列中的数据类型:尽管这不是必须的，但在大多数情况下，您最有可能使用字符串列名，但对于数据框架中的实际数据，类型可能无处不在。</p><p id="fe78" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们继续使用IBM的流失数据，让我重复使用基于<em class="lv"> EducationField </em>添加额外列的示例—如果我们有“技术学位”，我们希望返回“工程师”，否则返回“不是工程师”:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/3af8c6434ed3c7ee7b98ec4360135e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SUmf2D7HAL7YzEnD"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="b329" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们也可以重用<em class="lv"> is_engineer </em>函数:如果你想应用复杂的逻辑，调用理解中的函数是完全可以的，甚至是实用的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/4204a4b3268e9fbe4187fac2c7534cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6gLWO25kag0tPMLk"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Screenshot by Author</figcaption></figure><p id="298c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">当然，这不是一个超级复杂的逻辑，但是很容易看到，列表理解行变得更加清晰，并且对逻辑的任何维护都可以在函数定义本身中与数据更改命令分开进行。</p></div><div class="ab cl mg mh gp mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="hb hc hd he hf"><p id="ebdf" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">列表理解是任何Python开发人员的武器库中的一个强大工具，在您的数据项目中使用时，它也同样强大。如果您想了解更多，请查看<a class="ae jn" href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions" rel="noopener ugc nofollow" target="_blank">文档</a>——我相信您会的！否则你为什么会读这篇文章？</p></div></div>    
</body>
</html>
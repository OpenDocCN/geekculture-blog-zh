# 我应该何时重构 React 组件？

> 原文：<https://medium.com/geekculture/how-many-lines-of-code-until-i-need-to-refactor-a-react-component-c1b8d16f5a5b?source=collection_archive---------10----------------------->

## 在一定数量的行中，组件是否变得过大？

![](img/753f26f9272bdb93903064de530b549a.png)

在我目前工作的代码库中，我最近被要求修复应用程序某个部分的一个 bug。当我在寻找导致意外行为的原因时，我找到了一个包含 1700 多行代码的 React 组件。

我花了大量时间试图消化这个组件，并找出几十个函数和不同变量中的哪一个可能会影响我的一点代码。整个过程中，我真的希望这个庞大的文件被分解成更小、更分散的组件，这让我开始思考。很明显，这个文件需要重构，但是什么时候它变得不可持续了呢？有没有一个确切的时刻，我可以指出重构应该发生在哪里？

## 没有硬性的截止

不幸的是，没有一个确切的数字可以让你的代码变得难以处理。像这样说会很好:“正好在 300 行代码处，你必须重构！”但不幸的是，它比这更微妙，将因情况而异。

您应该问自己的是，您添加到代码中的任何内容是否与组件的整体功能无关。

例如，假设您的组件正在显示一堆客户评价，这些评价是从其他地方输入的，并且是从您的数据库中提取的。您的应用程序的原始功能只是获取这些证词数据，并以列表格式显示出来。它基本上只是这个数据的一个容器，包含一些简单的必要的 JSX 来呈现证明。

然而，随着时间的推移，这一部分变得更加复杂。您添加了允许用户回复评价、对其进行评级的功能，并且您还显示了每个给出评价的人的照片。您希望让用户能够按最近、按产品、按人口统计、按位置等进行排序。

突然间，这个小小的容器应用程序现在有了过滤和排序的功能，它有一个文本框来输入新的评论，每个评价现在都有一个用户名和一个与之相关的个人资料图片，等等。

同样，你可能会说，现在很明显这需要重构，但是这种重构应该更早发生。具体在哪里？

## 精确定位重构时刻

当你的组件正在执行一个不是为它而创建的功能，或者一个子组件可以更好地处理的功能时，重构就必须开始了。是的，如果您现在将每个小功能或小图形分解成自己的组件，这可能看起来有点过了，但是让它滑动正是您最终得到一个 2000 行的文件的方式，这是一个尝试和导航的噩梦。

在我们上面的例子中，第二条推荐显示的不仅仅是简单的文本，它应该成为自己的推荐卡。该卡将有文本，个人资料图片，评级等作为其道具，所有与证词卡相关的代码将完全包含在自己的组件中。这就是你如何在你的应用中正确地分离关注点。这看起来好像有很多工作要做，但我向你保证，从长远来看，你会很高兴你付出了努力，因为无论如何，你都必须这样做。与花一周时间试图记住一个 2000 行文件中的几行代码做什么，以及它们控制的应用程序中的哪些 DOM 元素相比，慢慢地将功能分解成子组件要容易得多。

## 外卖食品

*   您必须重构的代码没有确切的数字，但是如果您的组件超过 500 行，那么您很有可能找到更适合作为子组件的部分。
*   一旦一个为特定目的而创建的组件(例如容器)开始具有更复杂的功能，你应该花几分钟思考这个组件的职责，并确保它们都真正属于它。看看把你的父组件分解成更小的子组件是否会更简洁有效。
*   通过花时间回顾旧代码来避免技术债务，并在 bug 或问题发生之前进行重构。积极主动，不要被动。
*   随着时间的推移，您将掌握决定何时进行重构的诀窍。
<html>
<head>
<title>Iterating Through a Hash Where the First Key is an Array…of Hashes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">遍历一个散列，其中第一个键是散列的数组</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/iterating-through-a-hash-where-the-first-key-is-an-array-of-hashes-3b17f5071f4?source=collection_archive---------47-----------------------#2021-06-17">https://medium.com/geekculture/iterating-through-a-hash-where-the-first-key-is-an-array-of-hashes-3b17f5071f4?source=collection_archive---------47-----------------------#2021-06-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ab40e5ac9982eea5540dd543801ac45c.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/1*DBGdHlkB6DVjBy62d3TANQ.gif"/></div><figcaption class="im in et er es io ip bd b be z dx">How it can feel working with hashes</figcaption></figure><p id="4c22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本周早些时候，我参加了一次技术面试，在面试中，我没有在规定的时间内完成编码挑战，但之后花了一些时间来解决它，并最终解决了它。我已经在这篇文章中修改了这个问题，所以它不是呈现的那个问题，但是需要相同的步骤来解决。两位面试官非常棒——他们给人以鼓励和支持，显然也喜欢他们工作的公司。我认为没有什么比员工真正的快乐和反馈更能证明一个公司的文化了。</p><p id="4206" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在处理这个问题时，我面临的挑战是忘记了如何在散列和数组中选择键/值。刚刚完成了一个API调用，它要求我遍历散列，我对自己的空白感到沮丧。然而，一切都是学习的经历，只会让我们成为更强的程序员。使用Ruby解决了这个问题。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><p id="6261" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">这是一个场景:</strong></p><p id="037e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你正在决定接下来几个月你应该为生日礼物预算多少钱。你有一个基本预算，知道哪些月份的生日比其他月份多。如果某个月有很多生日，你会增加预算。您的列表如下所示:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="6d00" class="ke kf hi ka b fi kg kh l ki kj">base_budget = 100<br/>birthdays = {<br/>  birthday_count: [<br/>  {month: "April", type: "add", factor: "50"}, <br/>  {month: "May", type: "add", factor: "10.5"}, <br/>  {month: "June", type: "none"}, <br/>  {month: "July", type: "multiply", factor: "2"}<br/>  ]<br/>}</span></pre><p id="7401" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基于这些信息，编写一个方法，该方法将接受基本预算、生日列表以及该列表中的月份。根据提供的月份，基本预算将根据类型和系数而变化。例如，对于7月份，我们预计基本预算100将乘以2。</p><p id="6f28" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">分解问题:</strong></p><p id="7774" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从目前的情况来看，我们可以得出结论，我们的方法接受三个参数。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="a5d0" class="ke kf hi ka b fi kg kh l ki kj">def adjust_birthday_budget(base_budget, birthdays, month)</span><span id="58c7" class="ke kf hi ka b fi kk kh l ki kj">end</span></pre><p id="c001" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们还知道birthdays有一个键:birthday_count，其中有一个我们想要访问的散列数组。让我们一步一步来。首先，让我们确保我们可以访问:生日_计数的内容。我们怎样才能让程序<em class="kl">通读每一项并把它还给我们</em>？如果你猜测迭代，你是正确的。跳到<a class="ae km" href="https://www.replit.com" rel="noopener ugc nofollow" target="_blank"> Repl.it </a>，复制并粘贴基本预算和生日数据，并尝试以下操作:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="02ed" class="ke kf hi ka b fi kg kh l ki kj">birthdays[:birthday_count].each do |bc|<br/>   puts bc<br/>end</span></pre><p id="25f2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">点击“run ”,您应该会看到以下输出:</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/63e99bbb54a7a3e529441426b6245ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m31PnF-mf6aNx9gpkYeT7g.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx">We have successfully pulled the data from the birthday_count array</figcaption></figure><p id="cf75" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该方法的下一部分要求我们访问:birthday_count数组中每个散列的单个键和值。如果我们能够从生日[:birthday_count]中提取出我们想要的初始信息，那么我们如何着手提取:month、:type和:factor键呢？分别尝试以下方法:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="c17d" class="ke kf hi ka b fi kg kh l ki kj">birthdays[:birthday_count].each do |bc|<br/>   puts bc[:month]<br/>end<br/># =&gt; April, May, June, July</span><span id="b371" class="ke kf hi ka b fi kk kh l ki kj">birthdays[:birthday_count].each do |bc|<br/>   puts bc[:type]<br/>end<br/>#=&gt; add, add, none, multiply</span><span id="2732" class="ke kf hi ka b fi kk kh l ki kj">birthdays[:birthday_count].each do |bc|<br/>   puts bc[:factor]<br/>end<br/>#=&gt; 50, 10, , 2</span></pre><p id="7249" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">呜！我们成功地提取了键的<em class="kl">值</em>。所以现在的问题是，我们到底该怎么处理这一切？！</p><p id="48c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们重温一下手头的问题。我们希望值为100的基本预算根据提交给该方法的相应月份的类型和因素的值而受影响或不受影响。</p><p id="11af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">换句话说，如果月份设置为4月，我们希望预算增加50，因为类型设置为加法。听起来我们需要一个if/else语句！</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="4cf1" class="ke kf hi ka b fi kg kh l ki kj">if bc[:month] == month <br/>  if bc[:type] == "multiply"<br/>    new_base_budget = base_budget * bc[:factor].to_f<br/>  elsif bc[:type] == "add"<br/>    new_base_budget = base_budget + bc[:factor].to_f<br/>  else<br/>    new_base_budget = base_budget<br/>  end<br/>puts new_base_budget<br/>end</span></pre><p id="4173" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在这里说的是，如果key:month等于我们传入的参数(base_budget，birthdays，“July”)，并且<em class="kl">如果</em>那个月的:type键的值被设置为“multiply”，对基本预算做如下计算。因为我们知道如何访问:factor的值，所以我们可以通过使用代码“bc[:factor]”来乘以base_budget。哦等等！因子的值被设置为字符串。我们可以用<a class="ae km" href="https://www.rubydoc.info/stdlib/core/String:to_i" rel="noopener ugc nofollow" target="_blank">。to_i </a>方法将其改为整数。但是，如果这些值中有一个是小数呢？而不是<strong class="is hj">。to_i </strong>，我们可以用<strong class="is hj">。to_f </strong>。“f”代表float，表示非整数(即小数)。</p><p id="d1ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们写下如果:type键的值被设置为addition，我们希望程序做什么的条件。否则，基本预算不会发生任何变化。base_budget的新逻辑存储在一个变量“new_base_budget”中。这个条件语句结束后，我们返回new_base_budget值。让我们把它们放在一起。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="af83" class="ke kf hi ka b fi kg kh l ki kj">base_budget = 100<br/>birthdays = {<br/>  birthday_count: [<br/>  {month: "April", type: "add", factor: "50"}, <br/>  {month: "May", type: "add", factor: "10.5"}, <br/>  {month: "June", type: "none"}, <br/>  {month: "July", type: "multiply", factor: "2"}<br/>  ]<br/>}</span><span id="76f4" class="ke kf hi ka b fi kk kh l ki kj"><strong class="ka hj">def</strong> adjust_birthday_budget(base_budget, birthdays, month)<br/> birthdays[:birthday_count].each <strong class="ka hj">do</strong> |bc|<br/>  <strong class="ka hj">if</strong> bc[:month] == month <br/>    <strong class="ka hj">if</strong> bc[:type] == "multiply"<br/>      new_base_budget = base_budget * bc[:factor].to_f<br/>    <strong class="ka hj">elsif</strong> bc[:type] == "add"<br/>      new_base_budget = base_budget + bc[:factor].to_f<br/>    <strong class="ka hj">else</strong><br/>      new_base_budget = base_budget<br/>    <strong class="ka hj">end</strong><br/>  puts new_base_budget<br/>  <strong class="ka hj">end<br/> end<br/>end<br/></strong>=&gt;#side note: you don't need the 'puts' but for Repl.it I did have to use it to see the output in the terminal. If there is no 'puts', a <em class="kl">return</em> is implicitly implied. </span></pre><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ks"><img src="../Images/95112669c8a2cb7491f9c7b9fb195a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UC6AVrEAsiZu8tzp-7iKSQ.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx">Try it out in Repl.it! Play around with the different months and see the results in the terminal.</figcaption></figure><p id="7691" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你知道了，但是，我们还没有完成。问题已经成功解决，但是解决方案是否可以重构？在阅读了Ruby的<a class="ae km" href="https://www.rubyguides.com/2019/10/ruby-ternary-operator/" rel="noopener ugc nofollow" target="_blank">三元运算符</a>之后，我认为这是可能的。以下是我如何重构上述解决方案:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="e295" class="ke kf hi ka b fi kg kh l ki kj"><strong class="ka hj">def</strong> adjust_birthday_budget(base_budget, birthdays, month)<br/> birthdays[:birthday_count].each <strong class="ka hj">do</strong> |bc|<br/>   bc[:month] == month &amp;&amp; bc[:type] == "multiply" <strong class="ka hj">?</strong><br/>   base_budget *= bc[:factor].to_f <strong class="ka hj">:</strong> base_budget<br/>   bc[:month] == month &amp;&amp; bc[:type] == "add" <strong class="ka hj">?</strong><br/>   base_budget += bc[:factor].to_f <strong class="ka hj">: </strong>base_budget<br/> <strong class="ka hj">end</strong><br/>   puts base_budget<br/><strong class="ka hj">end</strong></span><span id="449c" class="ke kf hi ka b fi kk kh l ki kj">adjust_birthday_budget(base_budget, birthdays, "July")</span></pre><p id="bde0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这花了我一些时间和精力去解决，所以解释语法可能会在另一篇文章中完成。然而，如果您将它插入Repl.it，您将看到它与前面的解决方案工作相同。</p><p id="d3a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你有它的朋友！我希望这是有帮助的，并且我总是乐于接受反馈，因为我真的希望这些帖子对其他程序员有帮助和教育意义。对于像我一样的所有有抱负的软件工程师/开发人员，如果你在编码面试中无法解决问题，不要气馁。坚持练习，永远不要停止学习。</p><p id="c285" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢阅读~</p></div></div>    
</body>
</html>
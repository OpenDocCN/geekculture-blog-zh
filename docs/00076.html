<html>
<head>
<title>Making relative path to file to work</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使文件的相对路径起作用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/making-relative-path-to-file-to-work-d5d0f1da67bf?source=collection_archive---------0-----------------------#2020-04-02">https://medium.com/geekculture/making-relative-path-to-file-to-work-d5d0f1da67bf?source=collection_archive---------0-----------------------#2020-04-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="a220" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">而不用担心当前的工作目录(Python)。</h2></div><p id="0d43" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在之前的文章中，我描述了我配置日志的方法。其中一个缺陷是，如果我想使用相对于路径的<em class="ju">来记录配置文件，我应该从同一个文件夹运行我的应用程序/脚本。</em></p><p id="d2a2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">注意:</strong>日志配置文件不特殊。当你使用<em class="ju">相对</em>路径到<em class="ju">任何</em>文件时，问题就出现了。</p><p id="103b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我写了一个小的实用函数来克服这个限制。您可以从任何工作目录运行您的应用程序/脚本，这个函数会将cwd固定到预期的目录，这样<em class="ju">相对</em>路径就会起作用。更多详情见下文。</p><p id="8237" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">源代码你可以在这里找到<a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"/>。它是我的<a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils" rel="noopener ugc nofollow" target="_blank"> AlexBerUtils </a> s项目的一部分。</p><p id="0763" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以从PyPi安装AlexBerUtils:</p><p id="614f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du jv jw jx jy b">python3 -m pip install -U alex-ber-utils</code></p><p id="724b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于如何安装的更多详细说明，请参见此处的。</p><p id="fa68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个用法示例:</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="ke kf l"/></div></figure><p id="e57b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我建议您在完成基本的日志记录配置后，将这段代码片段(因为，这个函数使用logger否则，你会丢失这些消息)，但是在你使用任何<em class="ju">相对</em>路径之前。它可以是<em class="ju">到记录配置文件的相对</em>路径，或者例如到<code class="du jv jw jx jy b">.env</code>文件的路径。</p><p id="fad5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您的代码应该如下所示:</p><figure class="jz ka kb kc fd kd"><div class="bz dy l di"><div class="ke kf l"/></div></figure><h1 id="a6f6" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated"><code class="du jv jw jx jy b">fixabscwd</code>是如何运作的？</h1><p id="74f4" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">基本上，它在<code class="du jv jw jx jy b">__main__</code>模块中寻找<code class="du jv jw jx jy b">__file__</code>属性，从那里获取目录并为其设置cwd(通过调用<code class="du jv jw jx jy b">os.chdir</code>)。</p><p id="9606" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果在REPL或IPython笔记本中调用这个函数，它什么也不做。</p><p id="89f5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个函数没有从冻结的python脚本(使用py2exe冻结)中测试过，但是它应该可以工作(不做任何事情)。</p><p id="2a84" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">尽情享受吧！</p></div><div class="ab cl ld le gp lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="hb hc hd he hf"><h1 id="2faa" class="kg kh hi bd ki kj lk kl km kn ll kp kq io lm ip ks ir ln is ku iu lo iv kw kx bi translated">另请参见:</h1><ul class=""><li id="169b" class="lp lq hi iz b ja ky jd kz jg lr jk ls jo lt js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/importer.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">importer</em></a></code> <em class="ju"> </em>模块或者<a class="ae jt" rel="noopener" href="/analytics-vidhya/how-to-write-easily-customizable-code-8b00b43406b2">如何编写轻松可定制的代码？</a></li><li id="721b" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块中的<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L12" rel="noopener ugc nofollow" target="_blank"><em class="ju">fixabscwd()</em></a><em class="ju"> </em></code>功能或者<a class="ae jt" rel="noopener" href="/@alex_ber/making-relative-path-to-file-to-work-d5d0f1da67bf">制作文件的相对路径来工作</a>。</li><li id="fe5c" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块或<a class="ae jt" href="https://alex-ber.medium.com/make-path-to-file-on-windows-works-on-linux-402ed3624f66" rel="noopener">中的<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L237" rel="noopener ugc nofollow" target="_blank"><em class="ju">fix_retry_env</em></a><em class="ju">() </em></code>函数在Windows上生成文件路径在Linux上有效。</a></li><li id="29be" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/parsers.py" rel="noopener ugc nofollow" target="_blank"> <em class="ju">解析器</em> </a> <em class="ju"> </em>模块或<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-parser-module-429ed1457718">描述一个最老的AlexBerUtils项目</a></li><li id="9ca6" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/ymlparsers.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">ymlparser</em></a><em class="ju"/>模块或者<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-ymlparsers-module-88221edf16a6">模块的低级API模块对其他模块的描述</a></li><li id="a5ae" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/init_app_conf.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">init_app_conf</em></a>模块，或者<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-major-init-app-conf-module-1a5d9fb3998c">我的专业init _ app _ con模块</a></li><li id="afbd" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/deploys.py" rel="noopener ugc nofollow" target="_blank"> <em class="ju">部署</em> </a>模块，或者<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-deploys-module-26c5599f1b15">我的部署模块</a></li><li id="7174" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/emails.py" rel="noopener ugc nofollow" target="_blank"> <em class="ju">电子邮件</em> </a> <em class="ju"> </em>模块，或者<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-emails-module-3ad36a4861c5">我的电子邮件模块</a></li><li id="1476" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/processinvokes.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">processinvokes</em></a><em class="ju"/>模块，或<a class="ae jt" rel="noopener" href="/analytics-vidhya/my-processinvokes-module-de4d301518df">我的processinvokes模块</a></li><li id="69b2" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/stdlogging.py" rel="noopener ugc nofollow" target="_blank"> stdLogging </a>模块，或<a class="ae jt" href="https://alex-ber.medium.com/stdlogging-module-d5d69ff7103f" rel="noopener"> My stdLogging模块</a></li></ul><h1 id="7deb" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">另请参见:</h1><ul class=""><li id="d2d2" class="lp lq hi iz b ja ky jd kz jg lr jk ls jo lt js lu lv lw lx bi translated"><a class="ae jt" rel="noopener" href="/analytics-vidhya/integrating-pythons-logging-and-warnings-packages-7ffd6f65e02d">集成Python的日志和警告包</a>。</li><li id="f5bc" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块中的<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L12" rel="noopener ugc nofollow" target="_blank"><em class="ju">fixabscwd()</em></a><em class="ju"> </em></code>功能或<a class="ae jt" rel="noopener" href="/@alex_ber/making-relative-path-to-file-to-work-d5d0f1da67bf">制作工作文件的相对路径</a>。</li><li id="0d78" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块中的<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L237" rel="noopener ugc nofollow" target="_blank"><em class="ju">fix_retry_env</em></a><em class="ju">() </em></code>功能或者<a class="ae jt" href="https://alex-ber.medium.com/make-path-to-file-on-windows-works-on-linux-402ed3624f66" rel="noopener">在Windows上制作文件路径在Linux上工作。</a></li><li id="b782" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L263" rel="noopener ugc nofollow" target="_blank">FixRelCwd()</a></code>功能在<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块或<a class="ae jt" href="https://alex-ber.medium.com/making-more-yo-relative-path-to-file-to-work-fbf6280f9511" rel="noopener">模块中制作多到相对路径的文件才能工作</a></li><li id="3378" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">mains</em></a></code> <em class="ju"> </em>模块中的<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/mains.py#L295" rel="noopener ugc nofollow" target="_blank">GuardedWorkerException()</a></code>函数或者来自另一个进程的<a class="ae jt" href="https://alex-ber.medium.com/exception-propagation-from-another-process-bb09894ba4ce" rel="noopener">异常传播</a></li><li id="2f44" class="lp lq hi iz b ja ly jd lz jg ma jk mb jo mc js lu lv lw lx bi translated"><code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/files.py#L9" rel="noopener ugc nofollow" target="_blank">join_files()</a></code>功能在<code class="du jv jw jx jy b"><a class="ae jt" href="https://github.com/alex-ber/AlexBerUtils/blob/master/alexber/utils/files.py" rel="noopener ugc nofollow" target="_blank"><em class="ju">files </em></a></code>模块或<a class="ae jt" href="https://alex-ber.medium.com/join-files-cc5e38e3c658" rel="noopener">模块中加入文件</a>。</li></ul></div></div>    
</body>
</html>
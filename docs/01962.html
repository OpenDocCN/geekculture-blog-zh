<html>
<head>
<title>Deploy single-spa to AWS Fargate (Docker)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将单一spa部署到AWS Fargate (Docker)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/deploy-single-spa-to-aws-fargate-docker-5ee71549274b?source=collection_archive---------8-----------------------#2021-04-30">https://medium.com/geekculture/deploy-single-spa-to-aws-fargate-docker-5ee71549274b?source=collection_archive---------8-----------------------#2021-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/96fc1ee098d1f9966b111baa9a449355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3jSSR2x-m7c87tsVlZ2EA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Architecture Diagram</figcaption></figure><h1 id="210c" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">概述</strong></h1><p id="1ad2" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在过去的几周里，我一直在寻求挑战自己，构建一些需要一点故障排除，但仍然与当今世界相关的东西，甚至可能是web开发的未来。这时候我偶然发现了<a class="ae kq" href="https://single-spa.js.org/" rel="noopener ugc nofollow" target="_blank">单温泉</a>。现在首先，你可能会说，那是什么，命名为单个spa是不是有点多余，它扩展为单页应用程序？我们会在最后回到这个话题，为了真正理解这个名字的由来，你首先需要使用这个框架。</p><p id="3585" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在我看来，Single SPA已经改变了我对web开发的看法，从一个静态的构建块转变为更多的乐高积木的流体连接。<a class="ae kq" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank"> React </a>在2013年改变了web开发的格局，javascript文件的JSX被编译成传统的HTML/CSS块，这使得你的web应用可以正常工作。这介绍了:</p><ul class=""><li id="aff9" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated">一种更快速的网络开发形式</li><li id="bdb8" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">易于编写干净/简洁的代码</li><li id="7ed5" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">允许开发人员轻松地增加逻辑的复杂性。</li></ul><p id="c1e9" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">所以，你可能知道，我认为React很酷。然而，尽管React使web开发变得更加容易，但它只是一个里程碑。Web dev随着像single spa这样的新想法和概念不断发展，开始再次改变景观。单个spa具有强大的能力，能够抢先对微前端的概念做出反应。想象一下，构建三个完全不同的React项目，目的是让它们像一个项目一样运行在一个web页面上，但是独立开发。这正是单一水疗中心背后的理念。</p><p id="8cd9" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">单一spa的工作理念是我们有一个头部外壳，在它下面是我们的微型前端。这是一个强大的工具，尤其是当您开始考虑集中操作时，比如身份验证。现在，我们可以在shell级别上共享一个一致的身份验证模式，同时让开发团队能够完全控制彼此隔离的应用程序的开发。</p><p id="63eb" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">但是，正如我所说的，说得够多了，要明白我们必须建设，那就让我们建设吧。</p><h1 id="dcd8" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">车间</h1><h2 id="96a8" class="lk iv hi bd iw ll lm ln ja lo lp lq je kd lr ls ji kh lt lu jm kl lv lw jq lx bi translated">克隆和验证您的微前端</h2><p id="d280" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我们要做的第一件事是提取我们将在本实验中使用的代码库。我们可以通过将以下repo克隆到一个安全的工作区来实现这一点:</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="dae6" class="lk iv hi md b fi mh mi l mj mk">git clone <a class="ae kq" href="https://github.com/oconpa/single-spa-on-Fargate.git" rel="noopener ugc nofollow" target="_blank">https://github.com/oconpa/single-spa-on-Fargate.git</a></span></pre><p id="add9" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在这个项目中，您应该可以找到四个子文件夹，标题为:</p><ul class=""><li id="6a20" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated">历史</li><li id="5dcb" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">navshell</li><li id="5d45" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">科学</li><li id="f408" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">壳</li></ul><p id="8c11" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">我们将要部署的项目是一个大学网站的概念验证。该网站将有一个主页，一个科学网页，和一个历史网页。历史和科学页面完全由他们自己的独立团队管理，而navbar和外壳则由大学进行顶层管理。这个想法是，每个开发团队应该对他们的页面有自己独立的控制，但总体上他们必须坚持大学的模式(外壳)。</p><p id="9a23" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在将我们的应用程序部署到我们的集群之前，我们应该首先验证它们是否能够工作。让我们先测试一下我们的navshell。我们可以通过进入该文件夹，下载相关的包，并运行一个本地独立服务器来实现。</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="0c25" class="lk iv hi md b fi mh mi l mj mk">cd navshell<br/>npm install<br/>npm run start:standalone</span></pre><p id="71cd" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">如果运行上述命令没有收到任何错误，您现在应该能够在端口8080上点击您的本地主机，以查看类似于下面显示的视图。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/54390786d45ae29c4f4d3a271f2d3024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cP1EHJZ3UNg4T3ex9yp93w.png"/></div></div></figure><p id="823e" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">太棒了，我们现在可以渲染我们的基本导航条了。要验证科学和历史页面的工作情况，请对这两个子文件夹重复上述步骤，检查端口8080以确保它们能够正确呈现。</p><p id="bd61" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">一旦您验证了所有网站的工作，我们现在可以继续部署他们。</p><h2 id="5c16" class="lk iv hi bd iw ll lm ln ja lo lp lq je kd lr ls ji kh lt lu jm kl lv lw jq lx bi translated">部署您的微前端</h2><p id="64cf" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">我现在将向您展示如何为navbar部署微前端。在这一部分结束时，你必须对历史和科学页面重复这些步骤。</p><p id="020a" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">首先，因为我们正在使用docker，所以我们需要检查我们是否安装了它，您可以在您的终端中使用以下命令来检查:</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="2747" class="lk iv hi md b fi mh mi l mj mk">docker --version</span></pre><p id="ee26" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">如果安装了docker，该命令应该返回一个版本，否则从<a class="ae kq" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">这里</a>安装。</p><p id="81b5" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">一旦安装完毕，你需要登录到<a class="ae kq" href="https://aws.amazon.com/console/" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj"> AWS控制台</strong> </a>并导航到<strong class="ju hj">弹性容器注册(ECR) </strong>服务。在那里，选择左边的存储库选项，然后<strong class="ju hj">创建存储库。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/0d5e4eafb1380396f8d041adb789f605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ks8nv63q6Tmf8d3wLT5irQ.png"/></div></div></figure><p id="5563" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">给你的存储库起一个你自己选择的名字，我选择了【navbar &gt;】创建存储库。</p><p id="7c6e" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">现在，您的存储库应该已创建，并可从ECR存储库页面查看。准备就绪后，选择新创建的存储库，并选择服务右上角的<strong class="ju hj">查看推送命令</strong>(见下文)。</p><blockquote class="mn mo mp"><p id="3065" class="js jt mq ju b jv kr jx jy jz ks kb kc mr kt kf kg ms ku kj kk mt kv kn ko kp hb bi translated">确保您安装了AWS cli <a class="ae kq" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank">并配置了</a>和来与您的AWS帐户对话。</p></blockquote><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/d59ca7cba10949b18b75b466c7861dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mxFFTxHWDQwtMcECMJ0_fw.png"/></div></div></figure><p id="0271" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在本地终端中运行这些命令来构建docker并将您的映像上传到ECR。</p><p id="c3f0" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">一旦映像在<strong class="ju hj"> ECR </strong>中，我们现在可以设置我们的<strong class="ju hj"> Fargate集群，</strong>但是首先，我们需要设置我们的负载平衡器。我们的负载平衡器将用于向互联网公开我们的集群，我们将为我们的每个集群执行此操作。</p><p id="b692" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">导航到<strong class="ju hj"> EC2服务</strong>。</p><p id="18cd" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在那里，滚动到左侧菜单的最底部，你会在<strong class="ju hj">负载平衡下找到<strong class="ju hj">负载平衡器</strong>。</strong></p><p id="66d9" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">然后，您需要选择<strong class="ju hj">创建负载平衡器&gt;应用程序负载平衡器。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/12bb512bbbd4f508727eaa98de4eb538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yUbuxLzQZMh4edjaLPV6kQ.png"/></div></div></figure><p id="5fa9" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">为您的负载平衡器命名，并选择您选择的VPC下所有可用的子网。负载平衡器必须面向互联网并监听端口80 (HTTP)。<strong class="ju hj">下一个</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/d0531d334c88987ba11efb42d015a24f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFnmLd_flsJz9Jc5d5be9A.png"/></div></div></figure><p id="4bc7" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在<strong class="ju hj">配置安全设置</strong>页面，点击<strong class="ju hj">下一步。</strong></p><p id="bbf6" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">创建一个新的安全组，确保它对端口80 (HTTP)开放，然后<strong class="ju hj">下一个</strong>。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/d9ce61a5b93549d23f3697c6480898ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3x_TDQE4XpkwZILsGlLdw.png"/></div></div></figure><p id="5d52" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">对于<strong class="ju hj">配置路由</strong>，选择以下选项:</p><ul class=""><li id="8077" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated"><strong class="ju hj">名字</strong>自定义名字，我放NavBar。</li><li id="64b1" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">目标类型</strong> : IP</li></ul><p id="b929" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj">点击下一步。</strong></p><p id="3266" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">第五步:注册目标，<strong class="ju hj">点击下一步</strong></p><p id="e0f7" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj">然后创建。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/687c3357f737da25a87fbbdaebfe7e3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*775wSD44I_Q5NkQgfonl_w.png"/></div></div></figure><p id="0e5c" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">创建负载平衡器后，导航回<strong class="ju hj"> ECS </strong>，创建我们的集群。</p><p id="2fa2" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">从那里选择<strong class="ju hj">创建集群&gt;仅联网&gt;下一步。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/70ede4d733bebaee8db741499cdfb99a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3a8dvMq7bhltf52gBC5Xg.png"/></div></div></figure><p id="22c6" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">给你的集群起个名字，我给我的navbar-cluster &gt; <strong class="ju hj">创建</strong>。</p><blockquote class="mn mo mp"><p id="2639" class="js jt mq ju b jv kr jx jy jz ks kb kc mr kt kf kg ms ku kj kk mt kv kn ko kp hb bi translated">如果失败，请再次尝试创建群集。</p></blockquote><p id="3056" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">太棒了，我们已经创建了第一个集群，现在让我们创建一个任务定义；这将指向我们的docker映像，并告诉我们的集群我们正在旋转什么。</p><p id="8717" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在<strong class="ju hj"> ECS </strong>的左侧菜单中，选择<strong class="ju hj">任务定义&gt;创建新的任务定义。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/751dae4ecb39abe2a8be92cce2325f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1oYSztGSe9LMpHl1t9Hqw.png"/></div></div></figure><p id="5212" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在<strong class="ju hj">上选择发射类型兼容性，</strong>选择<strong class="ju hj"> FARGATE &gt;下一步。</strong></p><p id="30b6" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">对于<strong class="ju hj">配置任务和容器定义</strong>你必须给你的任务定义一个唯一的名字，我给了我的navbar-task。</p><p id="e45d" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">然后为任务大小选择:</p><ul class=""><li id="4f7a" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated">任务内存(GB) : 0.5GB</li><li id="7c94" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">任务CPU (vCPU) : 0.25 vCPU</li></ul><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/5b97989dd3622f0a31caf91363f27dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mG02diUYh7o1MbeLneaIg.png"/></div></div></figure><p id="df39" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">然后<strong class="ju hj">在容器定义&gt;下添加容器。</strong></p><p id="8580" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">然后，您应该会看到右侧出现一个弹出菜单。您只需填写以下字段:</p><ul class=""><li id="8395" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated"><strong class="ju hj">容器名</strong>:我给了navbar-container。</li><li id="78c4" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">图片</strong>:这将是您在本实验开始时在ECR中创建的存储库的URL。例如，应该沿着143681329876.dkr.ecr.us-east-1.amazonaws.com/navbar.的路线寻找</li><li id="65ec" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">端口映射</strong> : 80。</li></ul><p id="f055" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">一旦完成，选择<strong class="ju hj">添加&gt;创建</strong>。</p><p id="d516" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">完成任务定义后，返回任务定义以查看新创建的定义。选择此<strong class="ju hj">定义&gt;动作&gt;创建服务。</strong></p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/d90f999f341b48ce27c754e34c8e9dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dk9dGEPorKKI4r13k6Pizw.png"/></div></div></figure><p id="de89" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">快到了，我保证😊。</p><p id="4770" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">创建服务是我们在集群中执行任务的方式，它向集群传达我们希望它包含的内容。</p><p id="8e29" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">当指向<strong class="ju hj">步骤1:配置服务</strong>的<strong class="ju hj">创建服务</strong>页面时，输入以下内容:</p><ul class=""><li id="a08c" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated"><strong class="ju hj">发射类型</strong> : Fargate</li><li id="e61e" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated">集群:我们之前制作的集群，在我的例子中是navbar-cluster</li><li id="880f" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">服务名</strong>:给你的服务一个自定义名，我给我的navbar-service</li><li id="cf18" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">任务数量</strong> : 1</li></ul><p id="e021" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">然后<strong class="ju hj">下一步</strong></p><p id="294b" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">对于<strong class="ju hj">配置网络</strong>，选择以下选项:</p><ul class=""><li id="50da" class="kw kx hi ju b jv kr jz ks kd ky kh kz kl la kp lb lc ld le bi translated"><strong class="ju hj">集群VPC </strong>:选择相同的VPC作为你的负载均衡器，我选择默认。</li><li id="2715" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">子网</strong>:我选择全部</li><li id="f620" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">负载平衡器类型</strong>:应用负载平衡器</li><li id="d8cd" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">负载平衡器名称</strong>:从下拉列表中选择您创建的负载平衡器</li><li id="71a7" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">容器名称:端口</strong>:选择你的navbar容器<strong class="ju hj">选择添加到负载均衡器</strong></li><li id="8eb7" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">生产监听端口:</strong>从下拉列表中选择80:HTTP</li><li id="d9b5" class="kw kx hi ju b jv lf jz lg kd lh kh li kl lj kp lb lc ld le bi translated"><strong class="ju hj">目标组名称:</strong>从下拉列表中选择您使用负载平衡器创建的目标组</li></ul><p id="70e3" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj">下一步。</strong></p><p id="aec0" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在设置自动缩放上，点击<strong class="ju hj">下一步。</strong></p><p id="3233" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj">创造服务。</strong></p><p id="fa99" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">如果您查看navbar服务中运行的任务，几分钟后它应该变成绿色(正在运行)，这意味着它已成功部署。您可以通过点击负载平衡器DNS来测试网站。如果你回到下面的页面，这意味着它的工作。</p><figure class="ly lz ma mb fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/b1e1e48c0d725d4d4d0eea072e8cd120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1tpVUrk2LK_bieLEosvHg.png"/></div></div></figure><p id="e9ec" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated"><strong class="ju hj"> <em class="mq">重要</em> </strong>:你现在已经成功部署了三个微前端中的第一个。现在，在继续之前，回去对科学和历史重复上述步骤。</p><h1 id="0875" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">加载您的shell(本地)</h1><p id="aac9" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">到目前为止，您应该已经在云上的Fargate集群中启动了所有的微前端。现在让我们在本地启动我们的shell并使用大学网站。</p><p id="2a85" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">为此，您必须返回到shell子文件夹中的克隆repo。</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="7f7f" class="lk iv hi md b fi mh mi l mj mk">cd shell</span></pre><p id="7ede" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">在您选择的代码编辑器中打开该文件夹，因为我们需要将负载平衡器端点添加到shell中。在文件<strong class="ju hj"> src &gt; index.ejs </strong>中，您应该在第52–57行看到以下内容:</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="e63c" class="lk iv hi md b fi mh mi l mj mk">"@University/root-config": "//localhost:9000/University-root-config.js",<br/>   "@University/nav": "http://&lt;ADD NAVBAR LOAD BALANCER HERE&gt;/asset-manifest.js",<br/>   "@University/history": "http://&lt;ADD HISTORY LOAD BALANCER HERE&gt;/asset-manifest.js",<br/>   "@University/science": "http://&lt;ADD SCIENCE LOAD BALANCER HERE&gt;/asset-manifest.js"<br/>}</span></pre><p id="7624" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">要连接您的shell，您必须将您在上一节中创建的三个负载平衡器添加到这个文件中，替换它所说的添加特定负载平衡器的位置。</p><p id="5649" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">添加负载平衡器端点后，您必须首先下载相关的依赖项，然后在本地运行应用程序。</p><pre class="ly lz ma mb fd mc md me mf aw mg bi"><span id="28a0" class="lk iv hi md b fi mh mi l mj mk">npm install<br/>npm start</span></pre><p id="a02f" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">这将在端口9000上启动一个本地服务器，它将呈现您已经部署的集群中的所有页面。</p><blockquote class="mn mo mp"><p id="33c6" class="js jt mq ju b jv kr jx jy jz ks kb kc mr kt kf kg ms ku kj kk mt kv kn ko kp hb bi translated">注意:如果在尝试加载应用程序时遇到CORS问题，或者网站无法加载，请尝试将此扩展添加到您的浏览器(<a class="ae kq" href="https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf?hl=en" rel="noopener ugc nofollow" target="_blank">此处</a>)中，然后在重新加载页面之前将其打开。</p></blockquote><h1 id="42ed" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="846c" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在本文的开始，我提到了single-spa(单页应用程序)的名字。所以现在你已经使用了它，你可能开始理解它背后的命名约定。</p><p id="3605" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">React本身是一个单页面应用程序，因为从用户的角度来看，整个网站在第一次加载后就会加载到浏览器中。微前端的想法为React SPA增加了另一层single，因此创造了单一SPA的整体体验。</p><p id="d67f" class="pw-post-body-paragraph js jt hi ju b jv kr jx jy jz ks kb kc kd kt kf kg kh ku kj kk kl kv kn ko kp hb bi translated">我希望你喜欢这个研讨会，现在开始考虑这个框架可以用在你自己的个人项目中的什么地方。请继续关注更多的帖子，因为我将继续探索这个框架的局限性，以及我可以在它的基础上构建什么功能。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Using Vault Agent with Docker compose</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将存储库代理与Docker合成一起使用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-vault-agent-with-docker-compose-f410d033026f?source=collection_archive---------0-----------------------#2021-07-01">https://medium.com/geekculture/using-vault-agent-with-docker-compose-f410d033026f?source=collection_archive---------0-----------------------#2021-07-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="aeb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">感谢</em><a class="ae je" rel="noopener" href="/@kseniiaryuma"><em class="jd">Kseniia Ryuma</em></a><em class="jd">为金库代理缓存部分</em></p><p id="5d06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我发现<a class="ae je" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"> Docker compose </a>对于本地应用程序栈的测试和演示来说是一个非常有用的工具。对于最近的一个项目，我找不到使用docker compose和<a class="ae je" href="https://www.vaultproject.io/docs/agent" rel="noopener ugc nofollow" target="_blank"> Vault agent </a>的好例子，所以我决定写一个并在这里分享。在这篇文章中，我们将看到如何在Docker compose中运行Vault Agent，用数据库和静态密码为Nginx编写模板化的html文件</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/96b716dab19e829cdf1b6cb103e35191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nnm77iKhKhQi0I96"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">We will see how all of these tools can work together</figcaption></figure><p id="88ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我假设读者已经熟悉HashiCorp Vault和docker compose。作为先决条件，请确保安装了Docker、Docker compose、Vault CLI ( <a class="ae je" href="https://learn.hashicorp.com/tutorials/vault/getting-started-install" rel="noopener ugc nofollow" target="_blank">安装vault </a>)和jq ( <a class="ae je" href="https://stedolan.github.io/jq/download/" rel="noopener ugc nofollow" target="_blank">下载jq </a>)。</p><p id="0c8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个演示项目的repo是:<a class="ae je" href="https://gitlab.com/kawsark/vault-agent-docker" rel="noopener ugc nofollow" target="_blank">kaw sark/vault-agent-docker</a>。根目录包含一个<em class="jd"> docker-compose.yml </em>文件，该文件提供以下服务:Vault服务器(开发模式)、nginx、Vault代理和Postgres。请克隆repo并运行docker compose up来启动上述服务。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="e746" class="ka kb hi jw b fi kc kd l ke kf">git clone <a class="ae je" href="https://gitlab.com/kawsark/vault-agent-docker" rel="noopener ugc nofollow" target="_blank">https://gitlab.com/kawsark/vault-agent-docker</a><br/>cd vault-agent-docker<br/>docker-compose up</span></pre><p id="57c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在可以在<a class="ae je" href="http://localhost:8200" rel="noopener ugc nofollow" target="_blank"> http://localhost:8200 </a>上访问保险库。Vault的根令牌是“root”(不带引号)。nginx应用程序可以在<a class="ae je" href="http://localhost:8080." rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>上访问，它将显示默认的nginx网页，直到我们执行如下所述的配置步骤1和2。</p><h2 id="a27a" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">1.Vault:配置策略和密码引擎</h2><p id="ff03" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在另一个终端中，请运行以下命令为nginx应用程序创建一个策略，并配置两个Secrets引擎。如果您想走捷径，只需从存储库根目录执行<code class="du le lf lg jw b">./00-secrets.sh</code>脚本。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="e727" class="ka kb hi jw b fi kc kd l ke kf"><strong class="jw hj"># Please ensure you are in the repo root directory<br/># Run ./scripts/00-secrets.sh OR use the commands below</strong></span><span id="44f7" class="ka kb hi jw b fi lh kd l ke kf"># Setup VAULT_ADDR and VAULT_TOKEN<br/>export VAULT_ADDR=http://localhost:8200<br/>export VAULT_TOKEN=root</span><span id="8636" class="ka kb hi jw b fi lh kd l ke kf"># Write a Policy:<br/>vault policy write nginx nginx.hcl</span><span id="25b1" class="ka kb hi jw b fi lh kd l ke kf"># Enable the kv Secrets engine and store a secret<br/>vault secrets enable -version=2 kv<br/>vault kv put kv/nginx app=nginx username=nginx password=sup4s3cr3t</span><span id="6704" class="ka kb hi jw b fi lh kd l ke kf"># Enable the postgres Secrets Engine <br/>vault secrets enable -path=postgres database</span><span id="d31b" class="ka kb hi jw b fi lh kd l ke kf">vault write postgres/config/products \<br/>    plugin_name=postgresql-database-plugin \<br/>    allowed_roles="*" \<br/>    connection_url="postgresql://{{username}}:{{password}}<a class="ae je" href="http://twitter.com/db" rel="noopener ugc nofollow" target="_blank">@db</a>:5432?sslmode=disable" \<br/>    username="postgres" \<br/>    password="password"</span><span id="52b9" class="ka kb hi jw b fi lh kd l ke kf"># Create a Role for nginx<br/>vault write postgres/roles/nginx \<br/>  db_name=products \<br/>  creation_statements="CREATE ROLE \"{{name}}\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}'; \<br/>  GRANT SELECT ON ALL TABLES IN SCHEMA public TO \"{{name}}\"" \<br/>  default_ttl="30s" \<br/>  max_ttl="24h"</span></pre><p id="04b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果上面的设置成功，您应该能够读取静态和动态的秘密，如下所示。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="59af" class="ka kb hi jw b fi kc kd l ke kf"># Test reading a static secret<br/><strong class="jw hj">vault kv get kv/nginx/static</strong><br/>====== Metadata ======<br/>Key              Value<br/>---              -----<br/>created_time     2021-06-30T14:48:54.9808961Z<br/>deletion_time    n/a<br/>destroyed        false<br/>version          1</span><span id="3ec6" class="ka kb hi jw b fi lh kd l ke kf">====== Data ======<br/>Key         Value<br/>---         -----<br/>app         nginx<br/>password    sup4s3cr3t<br/>username    nginx</span><span id="51c0" class="ka kb hi jw b fi lh kd l ke kf"><br/># Test reading a dynamic secrets Database secret<br/><strong class="jw hj">vault read postgres/creds/nginx</strong><br/>Key                Value<br/>---                -----<br/>lease_id           postgres/creds/nginx/jLb7anWBjAWkIdYxYKdsDTGG<br/>lease_duration     30s<br/>lease_renewable    true<br/>password           T1MboM1OBjZ7nz-5qPjD<br/>username           v-token-nginx-yxbrxy61ShDeZXph7GgU-1625064446</span></pre><h2 id="7f93" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak"> 2。保险库:配置认证方法</strong></h2><p id="cbff" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">请运行以下命令从存储库根目录设置适当的身份验证方法。它将安装Auth方法，为nginx应用程序创建一个角色，然后导出角色ID和秘密ID供nginx使用。如果您想走捷径，只需从存储库根目录执行<code class="du le lf lg jw b">./02-approle.sh</code>脚本。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="8e8a" class="ka kb hi jw b fi kc kd l ke kf"><strong class="jw hj"># Please ensure you are in the repo root directory<br/># Run ./scripts/01-approle.sh OR use the commands below</strong></span><span id="2b5e" class="ka kb hi jw b fi lh kd l ke kf"># Enable AppRole and create a role:<br/>vault auth enable approle<br/>vault write auth/approle/role/nginx token_policies="nginx"</span><span id="b1c9" class="ka kb hi jw b fi lh kd l ke kf"># Write out a Role ID and Secret ID<br/>vault read -format=json auth/approle/role/nginx/role-id \<br/>  | jq -r '.data.role_id' &gt; vault-agent/nginx-role_id</span><span id="6fb9" class="ka kb hi jw b fi lh kd l ke kf">vault write -format=json -f auth/approle/role/nginx/secret-id \<br/>  | jq -r '.data.secret_id' &gt; vault-agent/nginx-secret_id</span><span id="5b7e" class="ka kb hi jw b fi lh kd l ke kf"># Restart the vault-agent-demo container<br/>docker restart vault-agent-demo</span></pre><p id="4ccf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在您的浏览器上访问<a class="ae je" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>，您应该能够看到nginx应用程序显示一个由Vault提供的动态Postgres数据库凭证，如下所示。也可以尝试访问<a class="ae je" href="http://localhost:8080/kv" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/kv</a>。html来查看示例静态秘密值。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es li"><img src="../Images/8d3881791ee6a29b789f108b67a80f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqI9owr-iGrv188FJvtHXA.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Example dynamic credential read</figcaption></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es lj"><img src="../Images/a4ee17c6e0669d1841815919bce52500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftDTjimqz4ogKN_Im3exYQ.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Example static credential read</figcaption></figure><p id="c487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其余步骤显示了用于上述演示的存储库代理和Docker-compose配置元素。</p><h2 id="2595" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">2.存储库代理:<strong class="ak">编写配置文件</strong></h2><p id="f463" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在这种情况下，我们已经编写了一个示例存储库代理配置文件供您审阅:<em class="jd">Vault-agent/nginx-Vault-agent . HCl</em>文件。它指定了如何使用auto-auth节中的AppRole来验证nginx容器:</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="3c73" class="ka kb hi jw b fi kc kd l ke kf">auto_auth {<br/>  method {<br/>    type = "approle"</span><span id="7e6f" class="ka kb hi jw b fi lh kd l ke kf">    config = {<br/>        role_id_file_path = "/vault-agent/nginx-role_id"<br/>        secret_id_file_path = "/vault-agent/nginx-secret_id"<br/>        remove_secret_id_file_after_reading = false<br/>    }  }</span><span id="ea9f" class="ka kb hi jw b fi lh kd l ke kf">sink {<br/>    type = "file"<br/>    config = { path = "/vault-agent/token" } } <br/>}</span></pre><p id="4706" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它还包括两个<code class="du le lf lg jw b">template</code>节，告诉Vault Agent如何以应用程序友好的方式呈现秘密。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="ca2f" class="ka kb hi jw b fi kc kd l ke kf"># Render Database secret<br/>template {<br/>  source = "/vault-agent/postgres.tpl"<br/>  destination = "/usr/share/nginx/html/index.html"<br/>}</span><span id="2a9a" class="ka kb hi jw b fi lh kd l ke kf"># Render KV secret<br/>template {<br/>  source = "/vault-agent/kv.tpl"<br/>  destination = "/usr/share/nginx/html/kv.html"<br/>}</span></pre><p id="8ad7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按照上面的模板节，HTML文件将呈现在<code class="du le lf lg jw b">/usr/share/nginx/html</code>目录中，由nginx web服务器提供服务。</p><h2 id="95a0" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak"> 3。Vault-agent:编写一个模板文件</strong></h2><p id="c45c" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我们包含了两个模板文件，<em class="jd"> kv.hcl </em>和<em class="jd"> postgres.hcl </em>，它们分别告诉vault agent如何从密钥/值和数据库机密引擎呈现机密。以下是需要注意的主要事项:</p><ul class=""><li id="369e" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated">从顶部的秘密路径开始，例如:<code class="du le lf lg jw b">{{ with secret "postgres/creds/nginx" -}}</code>用于数据库秘密。</li><li id="07aa" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">然后使用<code class="du le lf lg jw b">.Data.&lt;keyword&gt;</code>格式访问机密。比如<code class="du le lf lg jw b">{{ .Data.password }}</code>。对于键/值秘密引擎版本2，您需要使用关键字<code class="du le lf lg jw b">.Data.data</code>，因为秘密实际上存储在路径:<code class="du le lf lg jw b">&lt;kv-mount&gt;/data</code>下。比如:<code class="du le lf lg jw b">{{ .Data.data.password }}</code>。</li><li id="695a" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">如果您不确定关键字，请使用Vault CLI检查返回的内容。比如:<code class="du le lf lg jw b">vault read postgres/creds/nginx</code>或者<code class="du le lf lg jw b">vault read kv/data/nginx/static</code>。</li></ul><h2 id="16eb" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated"><strong class="ak"> 4。Docker-compose:用应用程序挂载一个共享卷</strong></h2><p id="5eed" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">使用Docker-compose的共享卷允许我们确保vault-agent可以在应用程序可以访问的公共目录中呈现机密。对于本演示，本地目录<code class="du le lf lg jw b">./nginx</code>是为vault-agent和nginx安装的，如下所示</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="870b" class="ka kb hi jw b fi kc kd l ke kf">volumes:<br/>      - ./nginx:/usr/share/nginx/html</span></pre><p id="8d86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下图显示了完整的工作流程。nginx会立即获取共享目录中发布的任何更新。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ly"><img src="../Images/44564109f37056599b1388ceb57efad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PiVMVYtmJtC45OAq"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Workflow for Vault agent</figcaption></figure><h2 id="1112" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">(可选)测试存储库代理缓存</h2><p id="16dc" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Vault agent还可以为应用程序提供本地代理和<a class="ae je" href="https://www.vaultproject.io/docs/agent/caching" rel="noopener ugc nofollow" target="_blank">缓存功能</a>。<em class="jd"> nginx-vault-agent.hcl </em>文件包含一个<code class="du le lf lg jw b">listener</code>和一个<code class="du le lf lg jw b">cache</code>块来实现这个功能。侦听器在端口8200上启动，该端口映射到docker合成文件中的本地主机端口18200。在另一个终端中，发出以下命令来测试Vault Agent缓存行为。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="f82e" class="ka kb hi jw b fi kc kd l ke kf">unset VAULT_TOKEN<br/>export VAULT_ADDR=<a class="ae je" href="http://localhost:18200" rel="noopener ugc nofollow" target="_blank">http://localhost:18200</a><br/>vault kv get kv/nginx/static<br/>vault read postgres/creds/nginx</span><span id="ab73" class="ka kb hi jw b fi lh kd l ke kf"># Run the command a few times<br/>vault read postgres/creds/nginx<br/>vault read postgres/creds/nginx</span></pre><p id="8f21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有几个有趣的项目需要强调:</p><ul class=""><li id="b94d" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated"><strong class="ih hj">认证:</strong>我们不需要设置<code class="du le lf lg jw b">VAULT_TOKEN</code>环境变量，因为我们在<em class="jd"> nginx-vault-agent.hcl </em>文件中指定了<code class="du le lf lg jw b">use_auto_auth_token = true</code>。</li><li id="e8b9" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated"><strong class="ih hj">缓存:</strong>存储库代理保持更新数据库租约。因此，如果您重新运行<code class="du le lf lg jw b">vault read postgres/creds/nginx</code>，Vault agent将继续返回相同的凭证，直到达到最大TTL，或者缓存被显式清除。发出<code class="du le lf lg jw b">docker logs vault-agent-demo</code>查看更新和缓存响应条目:</li></ul><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="bc6c" class="ka kb hi jw b fi kc kd l ke kf">docker logs vault-agent-demo<br/>2021-07-13T14:41:34.336Z [DEBUG] cache.leasecache: <strong class="jw hj">returning cached response</strong>: path=/v1/postgres/creds/nginx<br/>2021-07-13T14:41:46.812Z [DEBUG] cache.leasecache: <strong class="jw hj">secret renewed</strong>: path=/v1/postgres/creds/nginx</span></pre><ul class=""><li id="d1a4" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated"><strong class="ih hj">缓存清除:</strong>使用下面的命令，通过<a class="ae je" href="https://www.vaultproject.io/docs/agent/caching#cache-clear" rel="noopener ugc nofollow" target="_blank">缓存清除API端点</a>清除缓存。</li></ul><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="d87e" class="ka kb hi jw b fi kc kd l ke kf"># Setup environment to work with VAULT_AGENT<br/>unset VAULT_TOKEN<br/>export VAULT_ADDR=<a class="ae je" href="http://localhost:18200" rel="noopener ugc nofollow" target="_blank">http://localhost:18200</a></span><span id="ebae" class="ka kb hi jw b fi lh kd l ke kf"># Read database creds<br/>vault read postgres/creds/nginx<br/>Key                Value<br/>---                -----<br/><strong class="jw hj">lease_id           postgres/creds/nginx/cN8VAqQg9xVAFNQBF4LNHWM5</strong><br/>lease_duration     30s<br/>lease_renewable    true<br/>password           ZUjZAa8n7R7hR41-X9aC<br/>username           v-approle-nginx-zUR1sxuxg2a03wzgzvxb-1626183920</span><span id="9a4f" class="ka kb hi jw b fi lh kd l ke kf"># Copy the lease id from above<br/>curl --request POST \<br/>       --data '{ "type": "lease", "value": "<strong class="jw hj">postgres/creds/nginx/cN8VAqQg9xVAFNQBF4LNHWM5</strong>" }' \<br/>       $VAULT_ADDR/agent/v1/cache-clear</span><span id="1598" class="ka kb hi jw b fi lh kd l ke kf"># Re-issue the read command to see different credentials<br/>vault read postgres/creds/nginx<br/>Key                Value<br/>---                -----<br/>lease_id           postgres/creds/nginx/whRBAl2gCRprtWNxILIrw2Dr<br/>lease_duration     30s<br/>lease_renewable    true<br/>password           -5fx1FiT0tRSISzAUOZF<br/>username           v-approle-nginx-vW6CId8X99LUkurp7Klf-1626187012</span></pre><h2 id="fe48" class="ka kb hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">清除</h2><p id="4a0b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">要清理，运行<code class="du le lf lg jw b">./scripts/cleanup.sh</code>脚本，或者使用下面的命令。</p><pre class="jg jh ji jj fd jv jw jx jy aw jz bi"><span id="0978" class="ka kb hi jw b fi kc kd l ke kf"><strong class="jw hj"># Please ensure you are in the repo root directory<br/># Run ./scripts/cleanup.sh OR use the commands below</strong></span><span id="ea9c" class="ka kb hi jw b fi lh kd l ke kf">docker-compose down<br/>rm -f ./vault-agent/*role_id<br/>rm -f ./vault-agent/*secret_id<br/>rm -f ./vault-agent/token<br/>rm -f ./nginx/index.html<br/>rm -f ./nginx/kv.html</span></pre><h1 id="eb21" class="lz kb hi bd kg ma mb mc kk md me mf ko mg mh mi kr mj mk ml ku mm mn mo kx mp bi translated">摘要</h1><p id="7399" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Vault代理可用于代表应用程序委派身份验证和机密检索任务。这篇文章提供了用Docker Compose实现这一点所需的各种配置位。我希望这是您构建展示Vault与Docker集成的酷项目的起点。请在下面留下任何反馈。</p></div></div>    
</body>
</html>
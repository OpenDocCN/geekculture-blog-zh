<html>
<head>
<title>Flutter for Single-Page Scrollable Websites with Navigator 2.0 — Part 3: Scroll to Page</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Navigator 2.0下的单页滚动网站——第三部分:滚动到页面</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-3-scroll-to-page-30b6c43bd41?source=collection_archive---------7-----------------------#2021-07-18">https://medium.com/geekculture/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-3-scroll-to-page-30b6c43bd41?source=collection_archive---------7-----------------------#2021-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3d18dd2862e77bb0d4b7931e8e8cc7c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eajxj6aGWwdHI8hxJqPNkw.png"/></div></div></figure><p id="b0c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本系列的第二部分<a class="ae jo" href="https://ulusoyca.medium.com/flutter-navigator-2-0-for-authentication-and-bootstrapping-part-1-introduction-d7b6dfdd0849" rel="noopener">，</a>中，我们讨论了使用<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/ListView/ListView.builder.html" rel="noopener ugc nofollow" target="_blank">ListView</a></code>构建一个<strong class="is hj">单页可滚动网站</strong> (SPSW)，该网站的各个部分是延迟构建的(按需)，并且具有相同的高度。在本文中，示例应用程序将与之前的应用程序非常相似，只有一点不同:在<code class="du jp jq jr js b">ColorSections</code>小部件中，我们将使用<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>，而不是<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/ListView/ListView.builder.html" rel="noopener ugc nofollow" target="_blank">ListView</a></code>。</p><p id="d898" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您没有读过前面的文章，我强烈建议您从本系列的第一部分开始，因为在这一部分中不会提到常见小部件的实现细节。</p><ul class=""><li id="4472" class="jt ju hi is b it iu ix iy jb jv jf jw jj jx jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-1-introduction-c219b471bbec" rel="noopener">第1部分:简介</a></li><li id="b9d5" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-2-scroll-to-position-4c09cbc9d975" rel="noopener">第2部分:滚动到位置</a></li><li id="58c7" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><strong class="is hj">第3部分:滚动到第</strong>页</li><li id="b181" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-4-ensure-visible-145eba88d742" rel="noopener">第4部分:确保可见</a></li><li id="a78e" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-5-scroll-to-index-c38ed06ddf08" rel="noopener">第5部分:滚动至索引</a></li><li id="e089" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-6-navigation-16b4f5a1981f" rel="noopener">第六部分:导航</a></li><li id="431f" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated"><a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-7-query-params-deb0acfe09fa" rel="noopener">第7部分:查询参数</a></li></ul><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/90a8b0e9cbc1a03818db02f951941404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDR8DTLVzW7tiuo6gFr_HA.png"/></div></div></figure><h1 id="d5ae" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">颜色部分</h1><p id="8fdd" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated"><code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code> widget是一个可滚动的列表，它的子控件具有相同的大小，默认情况下等于视窗大小。列表中的每个项目称为一个页面。</p><p id="ce4c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>扩展了<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/ScrollController-class.html" rel="noopener ugc nofollow" target="_blank">ScrollController</a></code>。允许使用<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/animateToPage.html" rel="noopener ugc nofollow" target="_blank">animateToPage</a></code>、<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/jumpToPage.html" rel="noopener ugc nofollow" target="_blank">jumpToPage</a></code>、<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/nextPage.html" rel="noopener ugc nofollow" target="_blank">nextPage</a></code>、<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/previousPage.html" rel="noopener ugc nofollow" target="_blank">previousPage</a></code>方法设置<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>中哪个页面可见。我们可以使用它的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>属性来设置相对于视窗大小的页面大小。</p><p id="75d8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>小部件视为<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/ListView/ListView.builder.html" rel="noopener ugc nofollow" target="_blank">ListView</a></code>，但它更适合相同大小的项目。我们将使用<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView/PageView.builder.html" rel="noopener ugc nofollow" target="_blank">builder</a></code>构造函数在<em class="lp">垂直</em>滚动方向<em class="lp">慵懒</em>构建一个<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>。默认情况下，<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code> widget在滚动手势结束时将视口锁定到某个页面。我们将通过将它的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView/pageSnapping.html" rel="noopener ugc nofollow" target="_blank">pageSnapping</a></code>属性设置为<code class="du jp jq jr js b">false</code>来禁用这个特性。</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/aac1ea475fb9c72c59b2831339876b6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zungAHhOIPGby6P_l0qnxg.gif"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx">page snapping on</figcaption></figure><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/9fb604e0855d8f0eb867501e2487409e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*wuTfIuHQiDyknttTbLhRXw.gif"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx">page snapping off</figcaption></figure><h2 id="0a17" class="lx kn hi bd ko ly lz ma ks mb mc md kw jb me mf la jf mg mh le jj mi mj li mk bi translated">收听颜色代码更新</h2><p id="b60e" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated">一旦<code class="du jp jq jr js b">ColorSections</code>小部件被插入到树中，我们就开始监听<code class="du jp jq jr js b">colorCodeNotifier</code>更新。此时，<code class="du jp jq jr js b">initState</code>方法被调用，<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>没有任何客户端，因为<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>尚未布局。</p><p id="5771" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们接收到更新时，如果<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>被附加到<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>，并且更新的来源是<strong class="is hj">而不是</strong>滚动，我们向<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/animateToPage.html" rel="noopener ugc nofollow" target="_blank">animateToPage</a></code>方法提供页面索引号，该方法以编程方式滚动到目标索引。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/12db95055b13c1d1585b34d426647664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gl1PpaIKn9wf-9q_Z6wl0Q.gif"/></div></div></figure><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="e681" class="lx kn hi bd ko ly lz ma ks mb mc md kw jb me mf la jf mg mh le jj mi mj li mk bi translated">通知颜色代码</h2><p id="5b85" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated">当用户滚动时，我们希望随着第一个可见的颜色代码部分(<code class="du jp jq jr js b">trailingIndex</code>)的改变，更新<code class="du jp jq jr js b">colorCodeNotifier</code>监听器。</p><p id="0b21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们接收到一个<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/UserScrollNotification-class.html" rel="noopener ugc nofollow" target="_blank">UserScrollNotification</a></code>时，我们从<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>中获取当前的页面索引，并为相应的页面索引设置一个新的<code class="du jp jq jr js b">colorCode</code>值。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/09ca6f19ec422c8b00ba538d569387de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5sjQsNrMFRrwtZ9d7-02mA.gif"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx">Scrolling with trackpad</figcaption></figure><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="69cd" class="lx kn hi bd ko ly lz ma ks mb mc md kw jb me mf la jf mg mh le jj mi mj li mk bi translated">调整浏览器窗口的大小</h2><p id="e585" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated">在我们的用例中，我们将每个页面的高度设置为等于视口高度。当调整浏览器窗口大小时，我们希望确保即使在浏览器允许的最小高度下也能显示页面内容。我们将使用<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>属性来设置页面的最小高度。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/f98ab3b7d02cd07b8641eb9ef05a9032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*F__W4OQdfZ-mcNtHlw_Adw.gif"/></div></div></figure><p id="e7fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">属性<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>在<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>中被声明为<code class="du jp jq jr js b">final</code>，所以我们不能动态设置它的值。我们将用一个<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" rel="noopener ugc nofollow" target="_blank">LayoutBuilder</a></code>类包装<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>，以便能够根据新的大小约束为<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>创建新的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>。</p><blockquote class="mn mo mp"><p id="32bb" class="iq ir lp is b it iu iv iw ix iy iz ja mq jc jd je mr jg jh ji ms jk jl jm jn hb bi translated">…框架在布局时调用<a class="ae jo" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder/builder.html" rel="noopener ugc nofollow" target="_blank">构建器</a>函数，并提供父小部件的约束。当父对象约束子对象的大小，而不依赖于子对象的固有大小时，这很有用。<a class="ae jo" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" rel="noopener ugc nofollow" target="_blank">布局附属建筑</a>的最终尺寸将匹配其子建筑的尺寸。</p></blockquote><p id="324f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将根据以下公式计算可用大小的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>:</p><ul class=""><li id="b68c" class="jt ju hi is b it iu ix iy jb jv jf jw jj jx jn jy jz ka kb bi translated">我们首先决定足以显示页面内容的最小高度。在本例中，我们将其设置为800像素。</li><li id="d804" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated">第一次布局微件时，以及当父微件通过不同的布局约束时，将调用<a class="ae jo" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder-class.html" rel="noopener ugc nofollow" target="_blank"> LayoutBuilder </a>的<a class="ae jo" href="https://api.flutter.dev/flutter/widgets/LayoutBuilder/builder.html" rel="noopener ugc nofollow" target="_blank"> builder </a>函数。每次调用这个方法时，我们都需要构造一个新的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>。</li><li id="9bce" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated">如果<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>可以布局的可用高度大于<code class="du jp jq jr js b">_minPageHeight</code>，那么<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>等于1，使得页面高度等于视口高度。</li><li id="6b00" class="jt ju hi is b it kc ix kd jb ke jf kf jj kg jn jy jz ka kb bi translated">如果可用高度小于<code class="du jp jq jr js b">_minPageHeight</code>，我们通过将<code class="du jp jq jr js b">_minPageHeight</code>除以可用高度来计算<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>。例如，如果视窗高度等于400像素，我们需要将<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>设置为2，这样页面高度将为800像素。</li></ul><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="69c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是<code class="du jp jq jr js b">ColorsSection</code>小部件的完整代码:</p><figure class="ki kj kk kl fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="0ccd" class="lx kn hi bd ko ly lz ma ks mb mc md kw jb me mf la jf mg mh le jj mi mj li mk bi translated">调整大小的问题</h2><p id="2ad4" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated">当<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>设置为小于或等于1时，我们实际上没有任何问题。然而，从颤振稳定版本2.2.0开始，我在使用大于1的<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>时遇到了问题。</p><ul class=""><li id="eea9" class="jt ju hi is b it iu ix iy jb jv jf jw jj jx jn jy jz ka kb bi translated"><strong class="is hj"> <em class="lp">剪去第一页和最后一页</em> </strong></li></ul><p id="2204" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code> widget痴迷于将内容对齐到视口的中心。当<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>大于1时，它计算要加到<code class="du jp jq jr js b">minScrollContent</code>并从<code class="du jp jq jr js b">maxScrollContent</code>中减去的<code class="du jp jq jr js b"><a class="ae jo" href="https://github.com/flutter/flutter/blob/2.2.0/packages/flutter/lib/src/widgets/page_view.dart#L370" rel="noopener ugc nofollow" target="_blank">_initalPageOffset</a></code>值，以将内容对齐中心。这个决定导致第一页和最后一页被剪切。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/895b6faf0a53212d55c3e50e84265e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*F-Xi7c4GgVIS5TLPIY58Iw.gif"/></div></div></figure><ul class=""><li id="a552" class="jt ju hi is b it iu ix iy jb jv jf jw jj jx jn jy jz ka kb bi translated"><strong class="is hj"> <em class="lp">偏移后更新页面索引</em> </strong></li></ul><p id="566e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了从<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController-class.html" rel="noopener ugc nofollow" target="_blank">PageController</a></code>中获取当前的页面索引，我们访问<code class="du jp jq jr js b">page</code>属性，并将其取整。由于某种原因，页面直到某个偏移值才会更新。</p><p id="22e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在下面的记录中，您可以注意到当<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>为1时，页面索引被正确显示。随着浏览器高度变小，我们将<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageController/viewportFraction.html" rel="noopener ugc nofollow" target="_blank">viewportFraction</a></code>设置为大于1。在录像中，当前页面索引小于1，尽管<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>实际上显示的是第1个索引。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/58027e8aa0a9b91ee25400abba6c1f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*NoQm_XF35HwIUqREImDaZQ.gif"/></div></div></figure><p id="bbda" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，这两个问题可能是预期的行为或错误。如果你有解决方案，请写在评论中，否则我会错过一些东西。</p><h1 id="a0e8" class="km kn hi bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">结论</h1><p id="0e4c" class="pw-post-body-paragraph iq ir hi is b it lk iv iw ix ll iz ja jb lm jd je jf ln jh ji jj lo jl jm jn hb bi translated">在本文中，我们探索了如何使用一个<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/PageView-class.html" rel="noopener ugc nofollow" target="_blank">PageView</a></code>小部件构建单页可滚动网站的各个部分。<a class="ae jo" href="https://ulusoyca.medium.com/flutter-for-single-page-scrollable-websites-with-navigator-2-0-part-4-ensure-visible-145eba88d742" rel="noopener">在这个系列的第四部分</a>，我们将学习如何在一个<code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/SingleChildScrollView-class.html" rel="noopener ugc nofollow" target="_blank">SingleChildScrollView</a></code> + <code class="du jp jq jr js b"><a class="ae jo" href="https://api.flutter.dev/flutter/widgets/Column-class.html" rel="noopener ugc nofollow" target="_blank">Column</a></code>中同时建造所有的部分。</p><p id="c272" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以通过右键单击项目源代码中的<code class="du jp jq jr js b"><a class="ae jo" href="https://github.com/ulusoyca/Flutter-ShareWhatYouKnow/blob/develop/003-single-page-scrollable-website/lib/003-02-scroll-to-page/main_003_02.dart" rel="noopener ugc nofollow" target="_blank">main_003.02.dart</a></code>文件来运行这个示例应用程序。如果你喜欢这篇文章，请按下拍手按钮，并<strong class="is hj">启动</strong>示例应用程序的<a class="ae jo" href="https://github.com/ulusoyca/Flutter-ShareWhatYouKnow" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p><figure class="ki kj kk kl fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/7ed12a2da035c2f3a7a04c632b7c65eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xq9FuQ7QWrflJMq1rcswCA.png"/></div></div></figure></div></div>    
</body>
</html>
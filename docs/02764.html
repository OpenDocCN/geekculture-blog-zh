<html>
<head>
<title>Gutenberg Hacks — RichText example made simple with custom formatting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Gutenberg Hacks — RichText示例通过自定义格式变得简单</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/gutenberg-hacks-richtext-made-simple-with-examples-70c9ffae706a?source=collection_archive---------23-----------------------#2021-05-25">https://medium.com/geekculture/gutenberg-hacks-richtext-made-simple-with-examples-70c9ffae706a?source=collection_archive---------23-----------------------#2021-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0d6d15526872cdc8d7628951af08150c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AN6pgFVETsCkPWXUyaKGzg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">This is how I start the day</figcaption></figure><p id="50fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本指南中，我将向您展示如何尽可能简单地在您的块中使用<code class="du js jt ju jv b">RichText</code>组件。忘记设置“source”或“selector”属性的需要，只需简单的字符串属性就可以了！</p><p id="66f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">本指南的插件代码全部推送到<a class="ae jw" href="https://github.com/franky-adl/gtg-demo/tree/richtext-block-demo" rel="noopener ugc nofollow" target="_blank">我的Github repo </a>(注意你应该在richtext-block-demo分支)。一如既往地阅读我的回购中的完整代码；我在这里只强调重要的部分。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="1237" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">了解你的街区</h1><p id="fee3" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated"><code class="du js jt ju jv b">RichText</code>组件允许开发人员在块编辑器中现场编辑文本行，为我们提供各种格式选项(如粗体、斜体、上标、下标等)。我们还可以将组件的容器设置为任何块级元素，比如一个<code class="du js jt ju jv b">div</code>、<code class="du js jt ju jv b">h2</code>或<code class="du js jt ju jv b">p</code>标签。</p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="1dff" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">让我们深入研究代码</h1><p id="57a1" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">这次我将把这个演示块做成一个简单的卡片，带有副标题、标题和内容文本。</p><pre class="lh li lj lk fd ll jv lm ln aw lo bi"><span id="bdec" class="lp kf hi jv b fi lq lr l ls lt">  attributes: {<br/>    subheading: {<br/>      type: 'string',<br/>    },<br/>    heading: {<br/>      type: 'string',<br/>    },<br/>    content: {<br/>      type: 'string',<br/>    }<br/>  },</span></pre><p id="b80a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">正确导入并从<code class="du js jt ju jv b">props.attributes</code>析构每个属性后，在编辑函数中添加<code class="du js jt ju jv b">RichText</code>组件，如下所示:</p><pre class="lh li lj lk fd ll jv lm ln aw lo bi"><span id="b0e1" class="lp kf hi jv b fi lq lr l ls lt">    return (<br/>      &lt;div {...blockProps}&gt;<br/>        &lt;RichText<br/>          tagName='h3'<br/>          className='card-subheading'<br/>          value={subheading}<br/>          onChange={(newVal) =&gt; setAttributes({subheading: newVal})}<br/>          placeholder="Subheading Goes Here"<br/>        /&gt;<br/>        &lt;RichText<br/>          tagName='h1'<br/>          className='card-heading'<br/>          value={heading}<br/>          onChange={(newVal) =&gt; setAttributes({heading: newVal})}<br/>          placeholder="Heading Goes Here"<br/>        /&gt;<br/>        &lt;RichText<br/>          tagName='div'<br/>          className='card-content'<br/>          multiline='p'<br/>          value={content}<br/>          onChange={(newVal) =&gt; setAttributes({content: newVal})}<br/>          placeholder="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."<br/>        /&gt;<br/>      &lt;/div&gt;<br/>    );</span></pre><p id="672e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">关于RichText组件可以采用的可用属性的完整列表，请阅读此<a class="ae jw" href="https://github.com/WordPress/gutenberg/blob/HEAD/packages/block-editor/src/components/rich-text/README.md" rel="noopener ugc nofollow" target="_blank">链接</a>中的更多内容。<code class="du js jt ju jv b">h3</code>和<code class="du js jt ju jv b">h1</code> <code class="du js jt ju jv b">RichText</code>组件非常标准，注意我们在内容组件中有一个额外的<code class="du js jt ju jv b">multiline</code>属性设置为<code class="du js jt ju jv b">p</code>。这意味着当我们点击这个组件中的<code class="du js jt ju jv b">Enter</code>时，下一行的文本将被包裹在<code class="du js jt ju jv b">p</code>标签中，而不是添加一个换行符的默认行为。</p><p id="eeb5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">记住在保存功能中使用<code class="du js jt ju jv b">RichText.Content</code>而不是相同的<code class="du js jt ju jv b">RichText</code>标签。</p><p id="adf7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在块编辑器中，我们的块应该如下所示:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/2e85a7b4a9a54370f0de365ccb5d3ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcHp8uhX15bOEWhDXN2b3w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">screencap of the ‘GTG Demo Block(RichText)’ block</figcaption></figure><p id="4c96" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">填充文本输入，我们可以在前端得到像这样酷的东西:</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/35aca46f3c4da09be7813f8487ba9d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64jifEGhpCwkFpXdC7yZqg.png"/></div></div></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="4869" class="ke kf hi bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">为RichText组件添加额外的格式选项</h1><p id="f8ab" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf le jh ji jj lf jl jm jn lg jp jq jr hb bi translated">您可能想知道，“格式选项中的下划线图标在哪里？”我也不知道为什么。尽管这个按钮已经不在了，但你仍然可以通过按下<code class="du js jt ju jv b">Ctrl+U</code>或<code class="du js jt ju jv b">Cmd+U</code>来给选中的文本加下划线，这取决于你使用的是Windows还是Mac。但是这里是你如何添加缺少下划线格式选项的方法。</p><p id="4310" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我结合了来自官方指南的<a class="ae jw" href="https://developer.wordpress.org/block-editor/how-to-guides/format-api/1-register-format/" rel="noopener ugc nofollow" target="_blank">和这个Github回购文件</a>的<a class="ae jw" href="https://gist.github.com/phpbits/69e96d64cdb29005c9c1e41569eacb1c" rel="noopener ugc nofollow" target="_blank">的实现。只需将这段代码添加到您的editor.js(调用<code class="du js jt ju jv b">registerBlockType</code>的js文件)中:</a></p><pre class="lh li lj lk fd ll jv lm ln aw lo bi"><span id="7cc0" class="lp kf hi jv b fi lq lr l ls lt">const UnderlineButton = ( props ) =&gt; {<br/>  return (<br/>    &lt;RichTextToolbarButton<br/>      icon="editor-underline"<br/>      title="Underline"<br/>      onClick={ () =&gt; {<br/>        props.onChange(<br/>          toggleFormat( props.value, {<br/>            type: formatName<br/>          } ) <br/>        );<br/>      } }<br/>      isActive={ props.isActive }<br/>    /&gt;<br/>  );<br/>};<br/> <br/>registerFormatType( formatName, {<br/>  title: 'Underline',<br/>  tagName: 'u',<br/>  className: null,<br/>  edit: UnderlineButton,<br/>} );</span></pre><p id="4ce4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下划线按钮现在会出现在每一个富文本工具栏上(图片标题、按钮、段落等)！</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/ca53a64720fc91f4e31d8e4f72bc493b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzo-f6I6238aw0s4htUgiw.png"/></div></div></figure></div></div>    
</body>
</html>
<html>
<head>
<title>Loose Coupling with Chain of Responsibility</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与责任链的松散耦合</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/loose-coupling-with-chain-of-responsibility-bf0937028276?source=collection_archive---------48-----------------------#2021-06-07">https://medium.com/geekculture/loose-coupling-with-chain-of-responsibility-bf0937028276?source=collection_archive---------48-----------------------#2021-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a3d1caeb2fb6efefa5a63e46a954f191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E3svbKOsQqOAiBIB.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Source: <a class="ae iu" href="https://services.eiu.com/" rel="noopener ugc nofollow" target="_blank">https://services.eiu.com/</a></figcaption></figure><p id="8f57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di"> L </span>让我们来谈谈行为设计模式之一，责任链模式。责任链模式的主要目标是在应用程序设计中实现松散耦合。在这种模式中，当发送者发送一个请求时，该请求将通过一个由多个对象组成的链，这些对象将尝试处理该请求。</p><p id="517a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">想想主席、秘书和委员会成员。由于他们的职位不同，他们拥有不同类型的权限。所以，如果你想设计一个基于权限层次的系统，你可以很容易地使用这种设计模式。</p><p id="b5d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您知道Java <em class="kc">记录器</em>使用<em class="kc">责任链模式</em>吗？。让我们试试<em class="kc">记录器类</em>来看一个例子。<em class="kc">记录器</em>类有几个级别，如</p><ul class=""><li id="7529" class="kd ke hi ix b iy iz jc jd jg kf jk kg jo kh js ki kj kk kl bi translated">严峻的</li><li id="13f8" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">警告</li><li id="48a9" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">信息</li><li id="60ed" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">配置</li><li id="a914" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">很好</li><li id="a012" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">好的</li><li id="915c" class="kd ke hi ix b iy km jc kn jg ko jk kp jo kq js ki kj kk kl bi translated">好的</li></ul><p id="ebd9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">(<em class="kc">重度</em>最高，<em class="kc">精细</em>最低)。</p><p id="1ad5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在在这里，我已经将级别设置为<code class="du kr ks kt ku b">INFO</code>。看输出。它将打印我设置的所有日志消息。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="46df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><pre class="kv kw kx ky fd lb ku lc ld aw le bi"><span id="aebe" class="lf lg hi ku b fi lh li l lj lk">May 26, 2021 4:34:47 PM loger.LoggerExample main<br/>INFO: Info level</span><span id="3e36" class="lf lg hi ku b fi ll li l lj lk">May 26, 2021 4:34:47 PM loger.LoggerExample main<br/>WARNING: Warning level</span><span id="a1a0" class="lf lg hi ku b fi ll li l lj lk">May 26, 2021 4:34:47 PM loger.LoggerExample main<br/>SEVERE: Severe level</span></pre><p id="b4f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们将级别设置为<code class="du kr ks kt ku b">WARNING</code>，您将会看到，它会打印出警告和严重警告这两条消息。</p><pre class="kv kw kx ky fd lb ku lc ld aw le bi"><span id="df4b" class="lf lg hi ku b fi lh li l lj lk">May 26, 2021 4:35:49 PM loger.LoggerExample main<br/>WARNING: Warning level</span><span id="a782" class="lf lg hi ku b fi ll li l lj lk">May 26, 2021 4:35:50 PM loger.LoggerExample main<br/>SEVERE: Severe level</span></pre><p id="f6a1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">相应地，如果您将级别设置为<code class="du kr ks kt ku b">SEVERE</code>，它将只打印<code class="du kr ks kt ku b">SEVERE</code>级别</p><pre class="kv kw kx ky fd lb ku lc ld aw le bi"><span id="fba8" class="lf lg hi ku b fi lh li l lj lk">May 26, 2021 4:36:54 PM loger.LoggerExample main<br/>SEVERE: Severe level</span></pre></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="a54d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我向你展示一下责任链是如何实施的。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/41975d64cb9976aee4d85cfeae184b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ifEi-S5dNzwTYACE.jpg"/></div><figcaption class="iq ir et er es is it bd b be z dx">Example UML class and sequence diagram of the Chain of Responsibility design pattern. (Source: <a class="ae iu" href="https://en.wikipedia.org/" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/</a> )</figcaption></figure><p id="1896" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了实现责任链模式，我们需要一个Handler类、ConcreteHandler类和一个Client类。</p><p id="c924" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">处理人:</p><p id="044a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">handler类可以声明为接口或抽象。而且，它是所有ConcreteHandler类的超类。</p><p id="cbed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">混凝土处理器:</p><p id="62cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这些是处理请求的类。如果ConcreteHandler不能处理请求。它将请求转发给下一个后继者(下一个ConcreteHandler)。与处理程序、抽象或接口不同，这些类有处理请求的代码。</p><p id="a4bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">客户端:将请求传递给对象链。</p><p id="f272" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们来举个例子。还记得“<a class="ae iu" href="https://hasithas.medium.com/introduction-to-prototype-design-pattern-1ec1a3480772" rel="noopener">原型设计模式介绍</a>”示例中的“John Bee”吗，因为John Bee有一个无人机送货系统，现在他想为他的客户提供“黑色星期五”购物折扣。</p><p id="f0c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">超过250美元的每笔交易享受10%的折扣，超过500美元的每笔交易享受30%的折扣，超过1000美元的每笔交易享受50%的折扣。</p><p id="e38b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，让我们创建订单详细信息类。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="a3ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，就像在UML图中一样，让我们首先创建Handler类。这可能是一个<em class="kc">接口</em>或者一个<em class="kc">抽象</em>类。因为处理程序应该知道后继者，所以让我们创建一个名为<code class="du kr ks kt ku b">successor</code>的处理程序对象，并为它实现一个名为<code class="du kr ks kt ku b">setSuccessor()</code>的<em class="kc">设置器</em>方法和<code class="du kr ks kt ku b">getDiscount()</code>方法。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="8f5c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们来创建处理请求的ConcreteHandler类(计算折扣的折扣类)。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="a974" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们创建多个订单，看看这个设计模式如何处理它们。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><pre class="kv kw kx ky fd lb ku lc ld aw le bi"><span id="1dd7" class="lf lg hi ku b fi lh li l lj lk">Total price of products: 250.0 USD<br/>Discount: 10%<br/>Discount price: 225.0 USD</span><span id="ca85" class="lf lg hi ku b fi ll li l lj lk">Total price of products: 450.0 USD<br/>Discount: 10%<br/>Discount price: 405.0 USD</span><span id="77e3" class="lf lg hi ku b fi ll li l lj lk">Total price of products: 500.0 USD<br/>Discount: 30%<br/>Discount price: 350.0 USD</span><span id="85bb" class="lf lg hi ku b fi ll li l lj lk">Total price of products: 600.0 USD<br/>Discount: 30%<br/>Discount price: 420.0 USD</span><span id="3555" class="lf lg hi ku b fi ll li l lj lk">Total price of products: 1000.0 USD<br/>Discount: 50%<br/>Discount price: 500.0 USD</span><span id="1fcb" class="lf lg hi ku b fi ll li l lj lk">Total price of products: 1200.0 USD<br/>Discount: 50%<br/>Discount price: 600.0 USD</span></pre><p id="188a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如你所看到的，它工作得很好，你得到了一个解耦的代码。此外，为了启动这个链，我实现了一个名为<em class="kc"> Discount </em>的类。这与设计模式无关，仅用于传递后继者。我这样做是因为万一“FirstDicount”被更改了。</p><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="8f11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">还要记住，客户端可以将请求发送给任何处理程序，而不仅仅是第一个处理程序，并且客户端不知道哪个处理程序处理请求。如果你正在寻找完整的实现，请访问我的Github简介。我已经上传到这里了。</p><div class="lu lv ez fb lw lx"><a href="https://github.com/Hasitha-Su/Krish-LP-Training.git" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">hasit ha-Su/Krish-LP-培训</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">通过在GitHub上创建一个帐户，为Hasitha-Su/Krish-LP-Training开发做出贡献。</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">github.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml io lx"/></div></div></a></div><h2 id="dd70" class="lf lg hi bd mm mn mo mp mq mr ms mt mu jg mv mw mx jk my mz na jo nb nc nd ne bi translated">参考</h2><figure class="kv kw kx ky fd ij"><div class="bz dy l di"><div class="nf la l"/></div></figure></div></div>    
</body>
</html>
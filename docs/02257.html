<html>
<head>
<title>Introduction to Hierarchical Time Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分层时间序列介绍</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/introduction-to-hierarchical-time-series-c8fe5da149f6?source=collection_archive---------12-----------------------#2021-05-08">https://medium.com/geekculture/introduction-to-hierarchical-time-series-c8fe5da149f6?source=collection_archive---------12-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5a8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">时间序列是一个在一段时间内跟踪样本的数据集，关于该序列的大多数文章都是在特定/特定的聚合级别上工作的。但是在现实世界和许多应用中，有多个时间序列是分层组织的。相关数据集有几个级别，基于地理、分支或其他特征，当我们试图观察信息，同时关注更细粒度的级别时，挑战就开始了。在这种情况下，分层时间序列是一个英雄。</p><p id="06ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是什么是层次时间序列呢？</p><p id="4423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">HTS是一个时间序列的集合，遵循一个层次聚集结构。让我们想想电晕案例的数量，并从worlddometer网站上看到关于它的基本数据。故障显而易见。例如，地区和国家。它可以由城市或州来扩展。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/7b4b8c8ab5ae566d5c7f123402fcee85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*Uh4Oy-ydMA_GO881tO330w.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure 1 The number of Corona cases</figcaption></figure><p id="f1e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">按区域和目的划分的旅游需求也是分级时间序列的另一个例子。最简单的例子就是地理分裂。层次时间序列背后的逻辑是什么？顶层是数据最集中的级别。正如我们所看到的，顶层分为两个系列，第二层又分为两个系列(图3)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/9dec59a0d3e49bcb70c0ff5af275f968.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*hZv0-fJpeVKGlgKJe4kxjg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure 2 Example for two-level hierarchical tree diagram</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/12de9b7ea16a0202318cde443debca1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*CDJTBX9oEFolwPizb103Sg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx"><strong class="bd jr">Figure 3</strong> A two-level hierarchical tree diagram.</figcaption></figure><p id="a233" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">y_t代表总序列t=1的第<em class="js"> t </em>级观测值，…..，t。</p><p id="6edb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">y_j，t表示对应于节点j的序列的第<em class="js"> t </em>次预测</p><p id="820a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，y_B，t表示对应于级别1的节点B的系列的第t个观察值。</p><p id="ca0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的级数总数是<em class="js"> 1+2+2+2=7 </em>，而最底层的级数是<em class="js"> 2+2=4 </em>。系列的总数必须大于底层系列的数量。</p><p id="d6c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们集中在底层，看看方程。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/1eefc5061cdf3d67fe2a383e4a7156b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*OVK-yHQuBDoMlGZ2gXFQ_A.png"/></div></figure><p id="f857" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们也有</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ju"><img src="../Images/404ecd686ae60dea8b8be52b0fa1a056.png" data-original-src="https://miro.medium.com/v2/resize:fit:186/format:webp/1*nOGJacf7-Ib2trk8j5KeYw.png"/></div></figure><p id="252b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的方程和这些方程可以更有效地表示使用矩阵符号。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/cc046f6384c27ec12a66fd7bf6ba3f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*kqZzfq8EBQRKRGD4r0oX1Q.png"/></div></div></figure><p id="9927" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分层时间序列预测有一些主要方法，如自下而上、自上而下、中间向外。这些方法首先通过分别预测每个时间序列来开发基本预测，然后根据其固有的层次结构来协调这些基本预测。</p><p id="eaa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自下而上的方法</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/22521e244a8db83b5c8116030970c72d.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*1flYTDA-TehWdC9QGJpl9A.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure 4 Example for the bottom-up approach</figcaption></figure><p id="3596" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自下而上的方法计算底层时间序列的基本预测，然后为上层时间序列汇总这些预测。自下而上的方法计算底层时间序列的基本预测，然后为上层时间序列汇总这些预测。</p><p id="f167" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们首先为每个底层系列生成h步预测:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kb"><img src="../Images/058b4ec6d120ccc6bb57a3fbec0b3263.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*EYnl7aNN69sLD5UINd6kdw.png"/></div></figure><p id="a361" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将这些相加，我们得到了该系列其余部分的h步连贯预测:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kc"><img src="../Images/8596b55ffa970ddc915cf2167aac5696.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*dKtMVLfW471KhbJq5rc_BQ.png"/></div></figure><p id="57b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用这种方法，我们不会因为聚合而丢失信息，但是它在高度聚合的数据上表现很差。另一个缺点是缺少系列之间的关系，例如不同国家之间的关系。</p><p id="a1ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">自上而下的方法</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/324dcb054633acfd4384ab28595a0372.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*acn-4OenCU4fqA391SDu7w.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure 5 Example for a top-down approach</figcaption></figure><p id="d5de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">自上而下的方法只计算根时间序列的基本预测，然后根据较低级别时间序列的历史比例分解它们。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/5d7f901e3d77c023526db77a0c6f0d67.png" data-original-src="https://miro.medium.com/v2/resize:fit:134/format:webp/1*Td7vAcT1mpBVj4Lfevg48A.png"/></div></figure><p id="bbe4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是一组分解比例，规定如何分配总系列的预测，以获得结构底层每个系列的预测。</p><p id="4069" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的例子中，使用我们得到的比例，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/44e894211d90ea34111523b9969453ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:170/format:webp/1*KdqJyqBY0UkW6wq7kH84Xg.png"/></div></figure><p id="5f1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个比例p_j反映了底层序列y_j，T在t=1，…，T期间相对于总总量y_t的历史比例的平均值</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kf"><img src="../Images/3d2588aa9847d739397f7e6303d6433b.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*VMSpS2ptLwfTbVFNB8HOGw.png"/></div></figure><p id="437f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种方法是最简单可靠的高层预报方法。但是我们在较低的层次上有较低的精确度。</p><p id="fb18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">中盘出局法</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/665c74b82146a8dd1d0dda9d0d598f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*7U_7yK9QGg9KYFsk7oRoJw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure 6 Example for middle-out approach</figcaption></figure><p id="f67e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">中间向外方法结合了自底向上和自顶向下两种方法，可用于至少有三个级别的层次结构。在这种方法中，我们选择中间级别并直接对其进行预测，其他预测是针对该级别的所有系列生成的。对于中层以上的序列，连贯的预测是使用自下而上的方法通过向上聚合“中层”预测而生成的。</p><p id="48e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考</p><p id="8a2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://towardsdatascience.com/introduction-to-hierarchical-time-series-forecasting-part-i-88a116f2e2" rel="noopener" target="_blank"><em class="js">https://towards data science . com/introduction-to-hierarchy-time-series-forecasting-part-I-88a 116 f2e 2</em></a></p><p id="e121" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://robjhyndman.com/publications/hierarchical/" rel="noopener ugc nofollow" target="_blank"><em class="js">https://robjhyndman.com/publications/hierarchical/</em></a></p><p id="b156" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0242099" rel="noopener ugc nofollow" target="_blank"><em class="js">https://journals.plos.org/plosone/article?id = 10.1371/journal . pone . 0242099</em></a></p><p id="8501" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://otexts.com/fpp2/reconciliation.html" rel="noopener ugc nofollow" target="_blank"><em class="js">https://otexts.com/fpp2/reconciliation.html</em></a></p><p id="dec7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kh" href="https://forecasters.org/wp-content/uploads/gravity_forms/7-2a51b93047891f1ec3608bdbd77ca58d/2014/07/Athanasopoulos_George_ISF2014.pdf" rel="noopener ugc nofollow" target="_blank"><em class="js">https://forecasts . org/WP-content/uploads/gravity _ forms/7-2 a51b 93047891 f1ec 3608 bdbd 77 ca 58d/2014/07/Athanasopoulos _ George _ ISF 2014 . pdf</em></a></p></div></div>    
</body>
</html>
<html>
<head>
<title>How to use WebView in SwiftUI and Detect the URL?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在SwiftUI中使用WebView并检测网址？</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-use-webview-in-swiftui-and-also-detect-the-url-21d4fab2a9c1?source=collection_archive---------4-----------------------#2022-09-11">https://medium.com/geekculture/how-to-use-webview-in-swiftui-and-also-detect-the-url-21d4fab2a9c1?source=collection_archive---------4-----------------------#2022-09-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f139e60ce0ff3156054f82898d326ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWCzier35_-R34Arh2D_fg.png"/></div></div></figure><p id="cf53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇博客中，你将学习如何通过使用<strong class="is hj"> UIViewRepresentable </strong>来使用<strong class="is hj"> WebView </strong>进入<strong class="is hj"> SwiftUI </strong>，你还将学习如何检测哪个url被打开进入WebView。</p><p id="7b20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建全新的SwiftUI项目，然后跟随博客。</p><h2 id="a18a" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第一步</h2><p id="266c" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">在<strong class="is hj"> ContentView </strong>中创建<strong class="is hj">show webview</strong><strong class="is hj">@ State</strong>属性，用于呈现<strong class="is hj"> fullScreenCover </strong>。还要创建一个示例按钮，该按钮将切换<strong class="is hj"> showWebView </strong>属性。然后使用<strong class="is hj">全屏</strong>打开应用内的<strong class="is hj"> WebView </strong>。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="b7e0" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第二步</h2><p id="6872" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">现在，首先导入<strong class="is hj"> WebKit </strong>。</p><p id="b63e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后创建一个新的结构，用UIViewRepresentable协议继承这个结构，并实现两个必要的方法</p><blockquote class="ku kv kw"><p id="1781" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated">make uiview(Context:Context)-&gt; wk webview和</p><p id="1867" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated">update uiview(_ webView:wk webView，context: Context)</p></blockquote><p id="7a90" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> makeUIView </strong>方法用于创建视图，而<strong class="is hj"> updateUIView </strong>方法用于更新视图。</p><p id="aa89" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">还要在这个<strong class="is hj">结构</strong>中创建两个属性。url用于从父视图获取URL，而<strong class="is hj"> showWebView </strong>用于将<strong class="is hj"> fullScreenCover </strong>值绑定到那个<strong class="is hj"> WebView </strong>以消除<strong class="is hj"> fullScreenCover </strong>。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="0da5" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第三步</h2><p id="fc2e" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">之后使用<strong class="is hj"> fullScreenCover </strong>中的<strong class="is hj"> WebView </strong>并传递URL，绑定<strong class="is hj"> showWebView </strong>。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="bd41" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">之后运行代码，点击“<strong class="is hj">打开WebView </strong>”按钮，你会看到网站将在你的应用程序中打开。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/716f357c2b0ff256b0338d893b63d1e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gITaieHWt1viIOPwinw8ng.png"/></div></div></figure><h2 id="5e10" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第四步</h2><p id="3683" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">为了检测在WebView中打开了哪个url，我们需要实现WebKit<strong class="is hj">WKNavigationDelegate</strong>。</p><p id="58ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们需要在<strong class="is hj"> WebView </strong>结构中创建一个类。</p><p id="a173" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建一个WebViewCoordinator类，并用<strong class="is hj"> NSObject </strong>和<strong class="is hj"> WKNavigationDelegate继承它。</strong>创建我们之前创建的WebView属性。使用<strong class="is hj"> init </strong>在类内初始化。</p><p id="6e4e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在实现下面的WKNavigationDelegate方法来检测WebView中当前打开了哪个URL。</p><blockquote class="ku kv kw"><p id="aad9" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated"><strong class="is hj">func</strong>webView(_ webView:WKWebView，decidePolicyFor navigation action:WKNavigationAction，decision handler:<strong class="is hj">@ escaping</strong>(WKNavigationActionPolicy)-&gt;Void</p></blockquote><p id="89f8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过编写<strong class="is hj">navigation action . request . URL？。absoluteString，</strong>我们可以检查WebView内部打开了哪个URL。</p><h2 id="ea69" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">重要事项:</h2><blockquote class="ku kv kw"><p id="ea53" class="iq ir kx is b it iu iv iw ix iy iz ja ky jc jd je kz jg jh ji la jk jl jm jn hb bi translated"><strong class="is hj">每当WebView中的URL发生变化时，就会调用该方法。</strong></p></blockquote><p id="7876" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在该方法中，获取在WebView中打开的URL，然后将其与urlToMatch进行比较，如果两个URL匹配，则关闭WebView。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="988c" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第五步</h2><p id="7f19" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">通过实现另一个函数makeCoordinator()来使用WebViewCoordinator类。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="972b" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">第六步</h2><p id="ba29" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">最后，将该协调器的上下文提供给WKWebView并运行代码。当您打开WebView方法中的另一个链接时，WebViewCoordinator将运行并检测URL。</p><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h1 id="3073" class="lc jp hi bd jq ld le lf ju lg lh li jy lj lk ll kb lm ln lo ke lp lq lr kh ls bi translated">完整代码:</h1><figure class="ko kp kq kr fd ij"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="3d40" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望你喜欢这个博客。感谢你阅读这篇文章。</p><h2 id="4347" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">订阅模式</h2><div class="lt lu ez fb lv lw"><a href="https://www.patreon.com/abbasgujjar" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hj fi z dy mb ea eb mc ed ef hh bi translated">米（meter的缩写））阿巴斯正在创建IOS开发者| Patreon</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">立即成为M.Abbas的赞助人:获得世界上最大会员的独家内容和体验…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">www.patreon.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk io lw"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Simplest Mountebank Setup using JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用JavaScript的最简单的Mountebank设置</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/simplest-mountebank-setup-using-javascript-ccde1b7ef07?source=collection_archive---------10-----------------------#2022-10-08">https://medium.com/geekculture/simplest-mountebank-setup-using-javascript-ccde1b7ef07?source=collection_archive---------10-----------------------#2022-10-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ea3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mountebank工具广泛用于为我们不想使用实际API的较低环境设置模拟API。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/fe75cb8d9b82301f6a470b36fd12cb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yl2OmcXOnFDpuk6BVeHPbw.png"/></div></div></figure><p id="9b6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">这里是如何，最基本的安装程序可以做- </strong></p><ul class=""><li id="a2a9" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">使用添加了mountebank依赖项的<code class="du jy jz ka kb b">package.json</code>创建一个空项目。</li><li id="3543" class="jp jq hi ih b ii kc im kd iq ke iu kf iy kg jc ju jv jw jx bi translated">添加用于启动mountebank实例的启动脚本。参考以下链接，了解如何配置命令<code class="du jy jz ka kb b">mb start</code>。</li></ul><div class="kh ki ez fb kj kk"><a href="https://www.mbtest.org/docs/commandLine" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">mountebank -命令行</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">启动mountebank的命令行参数</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">www.mbtest.org</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky jn kk"/></div></div></a></div><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/84407a99048b00e69e7d28baadfd8d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fArrxTJOV_2MZVKN9CQEg.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">sample package.json</figcaption></figure><ul class=""><li id="ae2e" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">创建一个<code class="du jy jz ka kb b">imposters.ejs</code>文件，它将成为mountebank查找请求谓词及其响应的入口点。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es le"><img src="../Images/29f6c2125a52fe52ba5b2b843de149b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*36twsa5QoYkNnsjj8ZgneA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">sample imposters.ejs</figcaption></figure><p id="9807" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的冒名顶替文件中，我们指定了-</p><ol class=""><li id="bb52" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc lf jv jw jx bi translated"><strong class="ih hj">端口</strong>:来自这个指定端口的请求将被mountebank监听和处理。</li><li id="e262" class="jp jq hi ih b ii kc im kd iq ke iu kf iy kg jc lf jv jw jx bi translated"><strong class="ih hj">协议</strong>:将被监听和处理的请求协议。</li><li id="3008" class="jp jq hi ih b ii kc im kd iq ke iu kf iy kg jc lf jv jw jx bi translated"><strong class="ih hj">存根</strong>:不同请求的请求谓词和响应可以作为这个数组的一部分添加。</li><li id="9d84" class="jp jq hi ih b ii kc im kd iq ke iu kf iy kg jc lf jv jw jx bi translated"><strong class="ih hj">谓词</strong>:满足这些特定谓词(条件)的请求将得到相应的响应。</li><li id="a1ce" class="jp jq hi ih b ii kc im kd iq ke iu kf iy kg jc lf jv jw jx bi translated"><strong class="ih hj"> responses </strong>:满足指定谓词的请求将由该键下定义的响应提供服务。</li></ol><p id="14ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有关这些密钥的更多信息，请访问-</p><div class="kh ki ez fb kj kk"><a href="https://www.mbtest.org/docs/api/predicates" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">江湖骗子谓词</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">在没有谓词的情况下，网络上的测试加倍，存根总是匹配的，并且从来没有…</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">www.mbtest.org</p></div></div><div class="kt l"><div class="lg l kv kw kx kt ky jn kk"/></div></div></a></div><p id="e602" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到响应是从文件<code class="du jy jz ka kb b">dummyApi.js</code>中注入的，如下所示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/828f750879632ce5588300a528d08b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N9FgiA83KAvx5rcSb1OYRw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">dummyApi.js</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/99c8a845c19ffdfa043d74a40a0b4191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tR1nabc0r5NmZebpRHe6vw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">success.json</figcaption></figure><p id="2e9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在javascript文件中，我们注入了<code class="du jy jz ka kb b">success.json</code>响应，并用该响应调用由mountebank 提供的<strong class="ih hj">回调方法。</strong></p><p id="68bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回调方法将这个响应返回给调用者。</p><p id="2ac4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于<code class="du jy jz ka kb b">inject</code>函数参数的信息可在以下位置找到-</p><div class="kh ki ez fb kj kk"><a href="http://www.mbtest.org/docs/api/injection" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">江湖骗子注入</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">使用自定义JavaScript脚本扩展mountebank</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">www.mbtest.org</p></div></div><div class="kt l"><div class="lj l kv kw kx kt ky jn kk"/></div></div></a></div><p id="e5ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，当我们执行<code class="du jy jz ka kb b">yarn start</code>并尝试访问mountebank正在监听的端点<code class="du jy jz ka kb b"><a class="ae lk" href="http://localhost:4545/dummy" rel="noopener ugc nofollow" target="_blank">http://localhost:4545/dummy</a></code>时，它<strong class="ih hj">应该会返回我们已经为这个特定GET请求配置的成功响应</strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/aa79876f5711aa817104cd46151ffce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7z4i1KYtJLSyLDJX78f7Q.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">The mock API call</figcaption></figure></div><div class="ab cl lm ln gp lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="hb hc hd he hf"><p id="186b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们可以通过这些简单的步骤用javascript设置mountebank。通过阅读mountebank文档并根据我们的需要进行调整，可以在这个基本设置的基础上做很多事情。</p><p id="46a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是上面项目的github链接，你可以随意克隆它并做自己的实验</p><div class="kh ki ez fb kj kk"><a href="https://github.com/yogeshnikam671/mountebank-first" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">GitHub-yogeshnikam 671/Mountebank-first:Mountebank POC</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">github.com</p></div></div><div class="kt l"><div class="lt l kv kw kx kt ky jn kk"/></div></div></a></div></div></div>    
</body>
</html>
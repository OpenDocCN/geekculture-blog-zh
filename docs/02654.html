<html>
<head>
<title>Create a Twitter Clone With Supabase — Part 4: Using Storage and Postgres Stored Procedures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Supabase创建Twitter克隆—第4部分:使用存储和Postgres存储过程</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-a-twitter-clone-with-supabase-part-4-using-storage-and-postgres-stored-procedures-7e2342eede3?source=collection_archive---------18-----------------------#2021-05-23">https://medium.com/geekculture/create-a-twitter-clone-with-supabase-part-4-using-storage-and-postgres-stored-procedures-7e2342eede3?source=collection_archive---------18-----------------------#2021-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c0cbb0e216ecdf489ebfa3ae7ce04671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Dee7-OVXWs56ci1X.png"/></div></div></figure><p id="2fe4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">欢迎来到用React和<a class="ae jo" href="https://supabase.io" rel="noopener ugc nofollow" target="_blank"> Supabase </a>创建Twitter克隆的第4部分！如果您继续学习，到本系列结束时，您将已经部署了一个全功能的应用程序，它允许用户:</p><ol class=""><li id="9a1b" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">在推特上发布他们的想法，</li><li id="c150" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">上传头像并更改其个人资料，</li><li id="7125" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">当有新的推文时被通知，并且；</li><li id="58d1" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">当有人喜欢他们的推文时得到通知。</li></ol><p id="6777" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第三部分中，我们做得更漂亮了，增加了一个导航条和一个编辑个人资料页面。</p><p id="b09e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在第4部分中，我们将:</p><ul class=""><li id="00b0" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">通过让用户上传一张图片作为他们的头像到Supabase存储器来完成编辑个人资料页面。</li><li id="644d" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">在Supabase中为用户的推文创建一个<code class="du ke kf kg kh b">tweets</code>和<code class="du ke kf kg kh b">favorites</code>表，并使用<code class="du ke kf kg kh b">react-query</code>库显示它们。</li></ul><h1 id="e149" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">让用户上传他们的头像</h1><p id="b715" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">该部分的更改在<a class="ae jo" href="https://github.com/horizon0708/react-twitter-clone-follow-along/commit/4d99437bcfcda6073aeff6a0f34d65d3408d3d29" rel="noopener ugc nofollow" target="_blank">提交</a>中。抱歉，这是个大承诺🙏。我会在下面附上一些重要的片段。这个部分将使用Supabase的便捷存储器让用户上传他们的头像到我们的网站。</p><ol class=""><li id="d548" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">我们需要在Supabase中创建一个<a class="ae jo" href="https://gist.github.com/horizon0708/21ad56716b14bac21bf2d1f4ce5bab8d" rel="noopener ugc nofollow" target="_blank">桶</a></li><li id="f7dd" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">我们需要让用户将图像上传到bucket，并将文件名保存到我们的profiles表中。</li><li id="6e2e" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">我们需要能够从桶中获取图像，并使用保存的文件名显示它。</li></ol><p id="8250" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您一直在遵循本指南，那么您已经在第1部分<a class="ae jo" href="https://gist.github.com/horizon0708/21ad56716b14bac21bf2d1f4ce5bab8d" rel="noopener ugc nofollow" target="_blank">中使用Supabase的用户管理启动SQL </a>完成了！如果还没有，可以在SQL查询编辑器中运行下面的代码片段。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="4304" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您也可以通过用户界面轻松做到这一点，方法是转到存储部分，然后单击“New bucket”按钮。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/54ec790f1f8a2960adff9407c333ca09.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*suqUgtnayC6A4NClbje87Q.png"/></div></figure><p id="b29d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上传一个用户的文件到Supabase超级简单。你需要做的就是:</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="cfb6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只要不与现有文件冲突，文件名可以是您想要的任何内容。通过使用类型为 <code class="du ke kf kg kh b"><a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file" rel="noopener ugc nofollow" target="_blank">file</a></code> <a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file" rel="noopener ugc nofollow" target="_blank"> </a>的<code class="du ke kf kg kh b"><a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file" rel="noopener ugc nofollow" target="_blank">input</a></code> <a class="ae jo" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/file" rel="noopener ugc nofollow" target="_blank">元素，可以通过用户的文件浏览器选择要上传的文件。在git commit中，我将输入按钮放在了一个<code class="du ke kf kg kh b">Button</code>组件中，使其看起来有所不同。</a></p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="2f11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这看起来像这样。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/9ea5f22eca5710e0f59d7ac81078c7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*N3l0A3O4mdW_gMswjreOUQ.png"/></div></figure><p id="7cd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">每当用户选择一幅图像时，<code class="du ke kf kg kh b">onChange</code>回调就会被<code class="du ke kf kg kh b">ChangeEvent&lt;HTMLInputElement&gt;</code>调用。所以我选择每当用户选择一张图片时就上传并显示该文件。该逻辑被提取到<code class="du ke kf kg kh b">useUpload </code>钩子中。在钩子内部，我用<code class="du ke kf kg kh b">event.target.files[0]</code>获取文件，然后把它发送到Supabase。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="97ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ke kf kg kh b">Key</code>的值是结果文件名，以bucket名称为前缀。如<code class="du ke kf kg kh b">avatars/my-image.png</code>。当用户提交表单时，我将<code class="du ke kf kg kh b">Key</code>的值作为<code class="du ke kf kg kh b">avatar_url</code>保存在<code class="du ke kf kg kh b">profiles</code>表中。现在我们需要向用户展示这些图像。</p><h2 id="c478" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jb ma mb kw jf mc md la jj me mf le mg bi translated">下载和显示图像</h2><p id="3458" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">有两种方式向用户显示保存的图像。</p><p id="9ba8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一种方法是给用户一个预先签名的URL。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="bfb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另一种方法是将对象作为blob下载，然后从blob创建一个URL。我在我的项目中选择了这种方式。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><h2 id="9867" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jb ma mb kw jf mc md la jj me mf le mg bi translated">设置<code class="du ke kf kg kh b">Cache-Control</code>曾经被破坏</h2><p id="85d6" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">当我开始写这篇博文时，supabase的一个bug不能为S3对象设置<code class="du ke kf kg kh b">Cache-Control</code>头。这导致对象的<code class="du ke kf kg kh b">Cache-Control </code> d值默认为<code class="du ke kf kg kh b">no-cache</code>，使得浏览器从不缓存图像。例如，当我们渲染下面的列表时，我们会一次又一次地下载每张图片。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/09fa755dd227aeead13b21561bc07339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*xHT7iURGTX_mVWufPCJMig.png"/></div></figure><p id="f3f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我发现这个问题的时候，我提出了一个问题，并且Supabase的开发者很快就解决了这个问题。缓存控制将在1.11.14中正确设置！🎉</p><h2 id="b757" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jb ma mb kw jf mc md la jj me mf le mg bi translated">之前使用react-query的解决方法</h2><p id="6ee1" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">当这个错误还没有被修复时，我使用了react-query的缓存功能来缓存应用程序中的图像。如果<code class="du ke kf kg kh b">path</code>匹配，下面的代码片段将缓存并返回承诺(<code class="du ke kf kg kh b">fetchAvatar</code>)在一个小时内返回的内容(通过<code class="du ke kf kg kh b">staleTime</code>设置)。如果你感兴趣，你可以在react-query的文档中阅读更多关于通过键<a class="ae jo" href="https://react-query.tanstack.com/guides/query-keys" rel="noopener ugc nofollow" target="_blank">进行缓存的内容。</a></p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="f1ad" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从Supabase 1 . 11 . 14版本开始，浏览器会尊重我们的缓存，因为<code class="du ke kf kg kh b">Cache-Control</code>会被正确设置(默认为<code class="du ke kf kg kh b">max-age=3600</code>)，所以实际上不需要上述解决方法。</p><h1 id="1454" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">让用户发微博</h1><p id="7862" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">随着档案的工作，是时候让我们转移到主要事件:推文！该部分的更改在<a class="ae jo" href="https://github.com/horizon0708/react-twitter-clone-follow-along/commit/4d99437bcfcda6073aeff6a0f34d65d3408d3d29" rel="noopener ugc nofollow" target="_blank">该提交</a>中。</p><p id="f085" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我一直保持tweets表非常简单。一条推文将包含以下字段:</p><ul class=""><li id="bee1" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">id</code> —大整数，主键(自动生成)</li><li id="3c80" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">createdAt</code> — timestampz(自动生成)</li><li id="f506" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">content</code>正文</li><li id="3117" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">userId</code> — UUID，<code class="du ke kf kg kh b">profiles</code>表的外键</li></ul><p id="37ce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我创建了一个收藏夹表。收藏夹包含以下字段</p><ul class=""><li id="4517" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">id</code> —大整数，主键(自动生成)</li><li id="5ab2" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">inserted_at</code> — timestampz(自动生成)</li><li id="67fd" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">tweetId</code>—<code class="du ke kf kg kh b">tweets</code>表的大整型外键</li><li id="9b1b" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><code class="du ke kf kg kh b">userId</code> — UUID，<code class="du ke kf kg kh b">profiles</code>表的外键</li></ul><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/aa879232398767caddc1455abef96e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdCm8cu_UIzrb62NSPg5kw.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx">made with <a class="ae jo" href="https://dbdiagram.io/home" rel="noopener ugc nofollow" target="_blank">dbdiagram</a></figcaption></figure><p id="e428" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我已经用Supabase UI制作了两个表和一些测试数据。我们现在需要将数据提供给我们的前端。</p><h1 id="bdb2" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">前端需要什么？</h1><p id="3170" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我们来看一个推文看看，前端需要哪些数据。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/55f52abf33b2115c9647ec7bfa40967c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*ROLhmUWNODttkZz1MFynSA.png"/></div></figure><p id="3cd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一条推文需要:</p><ul class=""><li id="71fd" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">用户的头像</li><li id="9291" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">用户名</li><li id="3ed6" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">当推文被创建时</li><li id="39bd" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">推文的内容</li><li id="d9c0" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">有多少人喜欢这条推文</li><li id="7c89" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">(如果已登录)用户是否收藏了它</li></ul><p id="7442" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可能看起来像一个类型脚本类型</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="133c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">获取tweet作者的个人资料非常简单，只是一个<code class="du ke kf kg kh b">JOIN</code>。但是我们如何获得一系列喜欢这条推文的用户呢？我已经启动了Supabase的SQL查询编辑器，并开始创建一个查询。在这个<a class="ae jo" href="https://dba.stackexchange.com/questions/173831/convert-right-side-of-join-of-many-to-many-into-array" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>答案的帮助下🙏我有一个查询功能。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="d0c8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">像<a class="ae jo" href="https://www.postgresql.org/docs/9.5/functions-aggregate.html" rel="noopener ugc nofollow" target="_blank"> json_agg </a>和<code class="du ke kf kg kh b"><a class="ae jo" href="https://www.postgresql.org/docs/9.4/functions-json.html" rel="noopener ugc nofollow" target="_blank">json_build_object</a></code>这样的Postgres函数在Supabase中是可用的，所以使用这些函数，上面的查询给了我们一个tweets列表</p><ul class=""><li id="4f8f" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">身份证明（identification）</li><li id="5400" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">内容</li><li id="c13b" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">创建日期</li><li id="4ff8" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">favorited _ users，JSON中收藏用户的数组</li><li id="5068" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">tweet_author，在JSON中写推文的用户</li></ul><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/f5d3f4a16e1da8337acf030ba775ffc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGYklhFZmgoiwzV1rCFPTw.png"/></div></div><figcaption class="mj mk et er es ml mm bd b be z dx">What the above query returns in the SQL query editor</figcaption></figure><p id="8d82" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们有了一个有效的查询，我们需要一种从React应用程序调用这个查询的方法。对我们来说很方便的是，Supabase允许你从前端调用Postgres函数。所以我们来做一个Postgres函数。</p><h2 id="ea8b" class="lt kj hi bd kk lu lv lw ko lx ly lz ks jb ma mb kw jf mc md la jj me mf le mg bi translated">创建Postgres函数</h2><p id="e42f" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我们现在需要将上述查询包装在一个函数中。我已经添加了<code class="du ke kf kg kh b">u_id</code>作为函数的可选参数。当这个被提供时，它将根据用户的id过滤推文。当我们导航到用户的个人资料页面时，这将用于显示用户的推文。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="9fc7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您成功地创建了函数，您可以看到我们函数的文档是在“API”部分的“存储过程”下自动生成的。</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/f53c5fa1668df5cb093c072f67e9cf96.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*axWuzIEbgnjvnBNOzG2enQ.png"/></div><figcaption class="mj mk et er es ml mm bd b be z dx">Docs automatically available under Stored Procedures😍</figcaption></figure><p id="7f4f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">调用这些方法非常简单</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="d835" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我的提交中，我对响应做了一点点转换(比如判断当前用户是否收藏了该tweet ),以获得前端所需的数据。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="d3b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后使用<code class="du ke kf kg kh b">react-query</code>将该结果提供给<code class="du ke kf kg kh b">TweetCard</code>组件。</p><figure class="ll lm ln lo fd ij"><div class="bz dy l di"><div class="lp lq l"/></div></figure><p id="6096" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">产生了一个推文列表！</p><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/354183444bacb067dc060f8de79be4bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*FQ9wDUQzP612cxyY_1ALAQ.png"/></div></figure><h1 id="4b6d" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">下一步是什么？</h1><p id="0548" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我们今天就讲到这里。在下一部分，我们将让用户:</p><ul class=""><li id="68b2" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">帖子和最喜欢的推文</li><li id="15e2" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">使用Supabase的实时功能，当用户喜欢我们的推文时会得到通知</li></ul><p id="d934" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在推特(@詹姆士_ HJ _金)上关注我，这样你就不会错过新的更新。像往常一样，如果有什么不清楚的地方，请随时在Twitter上问我。</p></div></div>    
</body>
</html>
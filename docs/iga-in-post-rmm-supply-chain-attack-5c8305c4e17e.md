# 身份管理平台:后 RMM 供应链攻击的薄弱环节？

> 原文：<https://medium.com/geekculture/iga-in-post-rmm-supply-chain-attack-5c8305c4e17e?source=collection_archive---------23----------------------->

![](img/f0620d9411d1cae34cf057596ccbd98a.png)

Photo by [Markus Spiske](https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

## RMM 供应链攻击后重新评估集中供应和服务帐户

[最近的](https://us-cert.cisa.gov/ncas/current-activity/2021/07/04/cisa-fbi-guidance-msps-and-their-customers-affected-kaseya-vsa)勒索软件攻击使用受损的远程监控和管理(RMM)平台来访问恶意可执行文件并将其推送到端点，这迫使安全团队重新评估这种具有非常大爆炸半径的集中式平台。这些问题再次表明，各组织需要转向以零信任原则设计的基础设施。其中一个集中式解决方案是身份管理平台，用于管理传统和现代目标系统(如活动目录、应用程序数据库)中的帐户生命周期。身份治理和管理(IGA)平台中的帐户生命周期管理功能通常利用具有帐户管理权限的服务帐户来供应和更新目标系统中的帐户，如多个应用程序用于身份验证和/或授权存储库的活动目录、核心目录和数据库。如果相应的服务帐户遭到破坏，这可能会导致相当大的爆炸半径。

大多数身份治理平台没有被设计成安全地存储服务帐户细节。大多数本地平台仅支持使用存储在本地数据库中的凭据(使用共享密钥加密)对目标系统进行基于密码的身份验证。

无法消除通过身份治理平台集中配置功能的相关风险，但同时，可以通过在短期内实施一些基本的安全措施，并在长期内结合平台现代化和重新架构来降低风险。

# 安全认证和授权

数字化转型导致需要 IGA 平台支持的目标系统类型发生了重大变化。此外，这些平台现代化也提供了引入新功能的机会。IGA 平台应该尽可能利用这种转变来提高身份验证和授权的安全性。

## 提高密码安全性

尽管口令被轻视，但它仍然是应用程序支持的最流行的认证机制。重要的是要确保实施足够的控制措施来保护密码，并在密码遭到破坏时降低其有效性。大多数组织通常为服务帐户制定单独的密码策略，以强制使用复杂的密码，从而减少猜测密码的机会。服务帐户特别容易受到自动攻击(如暴力、凭据填充、密码喷洒)，因为一些控制措施(如因尝试失败而锁定(由于拒绝服务攻击)、MFA/CAPTCHA(由于自动化用例)无法使用。必须对登录日志、审计日志进行额外监控，以确保检测到此类自动攻击。

如果支持，请确保所有密码都自动存储并定期轮换。IGA 平台可以与特权访问管理平台或密钥库/HSM 集成，以确保定期执行此类操作，从而降低密码一旦泄露的有效性。

## 最小特权原则

[最低特权原则](https://en.wikipedia.org/wiki/Principle_of_least_privilege)如果与其他方法结合使用，可以显著降低与服务帐户泄漏相关的爆炸半径。建议根据需要支持的特定使用情形，尽可能使用访问受限的服务帐户来集成每个目标系统。由于目标系统中可用的授权模型的限制，这并不总是可能的。在这种情况下，将使用备用体系结构(见下文)的较高特权帐户的供应(如创建和删除用户)与使用受限访问帐户的简单用例(如将用户分配到组、帐户协调)分开可能会有所帮助。

下一代 IGA 平台的一个关键要点是，需要在目标平台的整个生命周期内强制实施最低特权，以确保与所用服务帐户相关的爆炸半径受到限制。

## 现代化认证

尽管多因素身份认证方法有了显著增长，但由于需要在自动化中使用服务帐户，它对服务帐户的影响非常有限。同时，可以使用一些新旧认证机制来提高认证过程的安全性。

实施安全控制，如限制来自特定源 IP 地址的身份验证，或使用不同的网络接口进行特权身份验证，并进行适当的网络分段，可以降低使用泄漏凭据的能力。

应该始终到位的基本卫生措施之一是使用 TLS 或等效方法对目标系统进行身份验证，以减少通过嗅探泄漏凭据。除了使用相互认证 TLS(MTL)进行认证之外，还可以使用 HSM/KeyVault 作为私有密钥存储，从而消除在 IGA 基础设施中存储密码的需要。

如果可能，使用机器身份或服务角色(通常在公共云和私有云基础架构上可用)向目标系统验证 IGA 平台，以消除密码需求。除此之外，对于高特权使用情况，外部管理的有限持续时间 JWT 令牌可用于认证，以减少集中存储密码和限制所生成令牌的使用持续时间的需要。

## 替代建筑

大多数现代 IGA 产品使用集中供应模式，依赖 IGA 团队来开发目标系统到板载系统的连接器。这种依赖性导致应用程序的启动非常缓慢。

组织已经开发了替代架构，例如标准事件/供应签名消息(SCIM？)通过发布/订阅渠道推送到目标应用程序，从而消除/减少对 IGA 团队的依赖。这些方法与强大的治理相结合，确保应用程序可以通过标准接口以自己的速度与集中式系统集成。这种分布式体系结构具有减少集中存储目标系统密码的需求的额外好处，并且还提供分段以减小影响半径。

除此之外，在可能情况下，组织应该将服务帐户管理和相关身份验证/授权的最佳实践标准化，作为应用程序安全准则的一部分，以确保正在开发的现代应用程序在默认情况下对于服务帐户是安全的。

# 提高平台安全性

在过去几年中，身份治理和管理(IGA)平台一直在不断发展。除了组织内部将传统平台迁移到云和 SaaS 的主要推动因素，目标系统的前景也在慢慢发生变化。重要的是重新评估 IGA 战略、实施和运作，以确保它能够支持未来的要求。

## 基本卫生( [V.L.A.D.R](/jhash/enterprise-cloud-security-introduction-970a63f50914#47a9)

确保安装了所有安全修补程序来解决漏洞。验证是否按照政策收集和监控所有日志，以确保不打印密码，并识别异常行为(例如，大量帐户的更改、使用服务帐户的大量失败登录)。审查恢复能力以确保数据和文件备份是安全的，从而避免服务帐户通过备份的潜在泄漏。确保数据库对静态和动态存储的数据进行加密。除此之外，如果支持，将数据库中的配置数据(如目标系统 id/密码)与运营数据(如事件、用户数据)分开，以确保商业智能(BI)和报告系统不能访问配置数据和运营数据。如果支持，请确保管理应用程序部署有单独的 URL 和网络控制，以减少因潜在漏洞或错误配置而向最终用户泄露配置数据的可能性。实施强身份认证和其他控制，以限制最终用户和管理员对配置数据的访问。通过强大的身份验证和网络访问控制来保护有限帐户对配置 API(如果可用)的访问，从而通过自动化降低大规模更改的可能性。

## 评估身份治理平台

审查在当前 IGA 平台中存储服务帐户凭据的安全功能，以确保其符合组织和行业内的最新最佳实践。确保身份治理平台支持 OpenID Connect、mTLS 等替代身份认证协议，并与密码库、硬件安全模块(HSM)等外部平台集成，以减少本地存储密码的需求。对于具有配置功能的 IDaaS(身份即服务)平台，请评估对 BYOK 功能的支持，以便对存储在服务提供商处的密码进行额外控制，或者查看基于内部部署的配置组件，该组件无需将密码推送到 IDaaS 平台。

评估现有断路器的身份治理，以确保识别出大量变更的任何特定触发因素，并传递给人工审查。如果需要，应在运营流程中构建额外的功能，以识别此类场景并提醒/阻止在计划窗口之外发生的此类大规模变更。

## 加强服务帐户管理

由于对服务帐户的使用和变化的影响缺乏深入了解，组织内有一种不“搞乱”服务帐户的趋势。务必确保将服务帐户生命周期确定为优先事项，并实施适当的控制和流程，以确保持续监控服务帐户所有权，并定期手动或根据实际使用情况审查相关权限，以符合最低权限原则。

现代身份治理和管理平台已成为组织内身份生命周期自动化和安全的重要组成部分。这是以特权帐户相关的风险为代价的，可以通过实施安全卫生和(如果需要)现代化平台来减轻风险。
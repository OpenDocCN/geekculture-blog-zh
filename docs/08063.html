<html>
<head>
<title>Track a High Speed Moving Object with TrackNet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用跟踪网跟踪高速运动的物体</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/track-a-tennis-ball-with-computer-vision-4f8d2f9c0412?source=collection_archive---------2-----------------------#2021-10-13">https://medium.com/geekculture/track-a-tennis-ball-with-computer-vision-4f8d2f9c0412?source=collection_archive---------2-----------------------#2021-10-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/dd9b9d4ec6199254e6dbfcf464652a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CKXKRyqOFE55hgmR.jpg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image Source: <a class="ae iu" href="https://www.hawkeyeinnovations.com/" rel="noopener ugc nofollow" target="_blank">Hawk-Eye</a></figcaption></figure><p id="40db" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi jt translated">令人惊讶的是，如今的技术可以改变游戏的流程。球门线技术、VAR和鹰眼都是现代技术在职业体育中应用的例子。这些技术的最终目标是防止人为失误，促进裁判的公正判罚。</p><p id="aae5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">计算机视觉已经走过了漫长的道路，它为球员、教练和球迷提供了各种有前途的工具来进一步改善他们的比赛。例如，<strong class="ix hj">在网球比赛中，优秀选手与杰出选手的区别在于他们处理不同轨迹的能力。</strong></p><p id="89ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">于是，看对方自动跟踪球并投射出轨迹的片子会更好。这可以让你更好地了解对手在不同情况下处理不同球的能力，并有希望在比赛中找到弱点进行攻击。</p><p id="51b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">本文介绍了跟踪高速微小物体的CNN——TrackNet。</strong></p><p id="95aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就个人而言，TrackNet是将计算机视觉融入体育运动的一个很好的例子，作者提出的方法既聪明又简单。</p><p id="728b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为预览，下面的视频是TrackNet[1]对我打网球的一个短片的结果。正如你所看到的，检测是相当准确的，跟踪球<strong class="ix hj">即使当它被遮挡。</strong></p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/333ce9f0b234ab220f422ef5a58ffac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/1*Rs3C_ter8SpVE1jDj3acXw.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx">Prediction of TrackNet.</figcaption></figure><h1 id="4e04" class="kh ki hi bd kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated">轨道网</h1><blockquote class="lf lg lh"><p id="6995" class="iv iw li ix b iy iz ja jb jc jd je jf lj jh ji jj lk jl jm jn ll jp jq jr js hb bi translated">国立交通大学在2019年第16届IEEE高级视频和信号监控国际会议(AVSS)上介绍并发表了这篇论文</p></blockquote><p id="0cdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TrackNet是一个基于热图的深度学习网络，不仅可以从单帧中识别网球，还可以从连续帧中学习飞行模式，这使得模型能够精确估计球的位置，即使球被球员或物体遮挡。</p><p id="f9dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">track net的精度、召回率和F1-measure分别为99.7%、97.3%和98.5% </strong>，显著高于传统的图像处理方法Archana算法[2]。</p><h2 id="b128" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated">资料组</h2><p id="fe07" class="pw-post-body-paragraph iv iw hi ix b iy ma ja jb jc mb je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">主要数据集来自2017年世界大学生夏季运动会网球男单决赛的转播视频。这些视频经过编辑，检索了20，844个与比赛相关的帧，从发球到得分。</p><blockquote class="lf lg lh"><p id="a42b" class="iv iw li ix b iy iz ja jb jc jd je jf lj jh ji jj lk jl jm jn ll jp jq jr js hb bi translated">向作者致敬，他们设法手工标记了超过20，000个帧，以从头开始训练模型。</p></blockquote><p id="14d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每个框架都贴有以下标签:</p><ol class=""><li id="16d2" class="mf mg hi ix b iy iz jc jd jg mh jk mi jo mj js mk ml mm mn bi translated"><strong class="ix hj">帧名</strong>:帧文件的名称。</li><li id="2065" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj">可见性等级</strong>:每一帧中球的可见性。0)表示球在框架外，1)表示球在框架内，2)表示球在框架内，但人眼无法定位。</li><li id="6726" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj"> (X，Y) </strong>:网球在像素坐标中的坐标。由于网球的高移动速度，球可能会显示模糊，如图1所示。在这种情况下，球轨迹的最新位置被认为是位置。</li><li id="a354" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj">轨迹模式</strong>:球的运动类型，分为0)飞行，1)击球，2)弹跳。</li></ol><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/0493697670b19e0f28e74c0514a4d35b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBAEE_dWgE7oyFFNaJgYig.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Figure 1. The coordinate of the ball, which is at the latest position of the ball’s trace, is marked with red.</figcaption></figure><p id="6e71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了防止过度配合，9个不同的网球场设置(粘土、草地、硬地等。)被记录以生成额外的16，118帧，并且以相同的方式被标记。这有助于模型通用化，并在许多不同的设置中执行得更好。</p><p id="3a9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">事实是位于网球中心的放大2D高斯分布的热图</strong>。高斯分布的方差指的是网球图像的直径，作者假设其大约为10个像素。高斯热图的等式可以写成:</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es mu"><img src="../Images/9205e88de4cc9c99694de79a2ebeabcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*eR3fMIBUnwOBGY9pTBxQrg.png"/></div></figure><ul class=""><li id="ffd9" class="mf mg hi ix b iy iz jc jd jg mh jk mi jo mj js mv ml mm mn bi translated">第一部分表示以(x_o，y_o)为中心的具有方差的高斯分布</li><li id="af12" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mv ml mm mn bi translated">第二部分将热图缩放到范围[0，255]</li></ul><p id="4330" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">图3显示了高斯热图的一个例子。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/2f41e59c419695d8e4d781bbb017cd22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LnEGUX8QX3RdiHz2Bx5GVQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Figure 3. Gaussian distribution at the center of the ball.</figcaption></figure><h2 id="ba94" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated"><strong class="ak">模型架构</strong></h2><p id="a873" class="pw-post-body-paragraph iv iw hi ix b iy ma ja jb jc mb je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">TrackNet由卷积神经网络(CNN)和反卷积神经网络组成，如图2所示。输入是多个连续的帧。作者提出，拥有一个以上的输入帧可以通过学习轨迹模式来改进识别移动对象的模型。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/729c9a09464ccdb49c3c54cc683c9ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lr-7-XRsChqfjmXl7BmK6w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Figure 2. TrackNet Architecture.</figcaption></figure><p id="ade7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">利用VGG16进行特征提取，利用DeconvNet进行空间定位。</p><p id="fb7c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">softmax图层之后的输出表示网球的预测热图，其尺寸与输入图像相同，但具有256个通道。每个通道代表范围从[0，255]的灰度值。<strong class="ix hj">预测的热图</strong>用softmax激活进一步处理，以从可能的256个灰度值输出深度k的概率分布。选择概率最高的通道作为该像素的热图值。</p><p id="68f4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">然后，实施阈值128，以将灰度预测转换成二进制热图</strong>。</p><p id="af2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后用<strong class="ix hj"> <em class="li">休梯度法</em> </strong>通过检查帧内是否只有一个网球来过滤有效帧。<strong class="ix hj">如果检测到一个网球，则返回该帧的中心点。</strong></p><blockquote class="lf lg lh"><p id="5f43" class="iv iw li ix b iy iz ja jb jc jd je jf lj jh ji jj lk jl jm jn ll jp jq jr js hb bi translated">这个中心点被保存，以后用于跟踪球的位置。</p></blockquote><h2 id="cef5" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated">失败</h2><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es my"><img src="../Images/82d1171448ef5f34c3218eed27fd0421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*pM5VajGUVT4SfwxQZ1pL2Q.png"/></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/c1d6de574d3a2f778abdd67f1698c79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*GsTXUZLF1y2JgvB45BVolg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Loss equation of TrackNet.</figcaption></figure><p id="9148" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">二元交叉熵<em class="li"> H_Q(P) </em>用于训练模型，其中</p><ul class=""><li id="ee33" class="mf mg hi ix b iy iz jc jd jg mh jk mi jo mj js mv ml mm mn bi translated">G(i，j)是高斯热图</li><li id="e6b4" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mv ml mm mn bi translated">Q(i，j，k)是高斯热图的二进制形式</li><li id="8d1a" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mv ml mm mn bi translated">P(i，j，k)是紧接softmax层之后的输出</li></ul><h2 id="a285" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated">结果和讨论</h2><p id="c1d1" class="pw-post-body-paragraph iv iw hi ix b iy ma ja jb jc mb je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">作者总共测试了四种模型来评估TrackNet的性能:</p><ol class=""><li id="b1c8" class="mf mg hi ix b iy iz jc jd jg mh jk mi jo mj js mk ml mm mn bi translated"><strong class="ix hj">阿尔卡纳:</strong>单帧输入+图像处理技术</li><li id="fbdf" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj"> TrackNet模型一:</strong>单帧输入+ CNN</li><li id="4e23" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj"> TrackNet模式二:</strong>连续三帧输入+ CNN</li><li id="cb80" class="mf mg hi ix b iy mo jc mp jg mq jk mr jo ms js mk ml mm mn bi translated"><strong class="ix hj"> TrackNet Model II': </strong>连续三帧输入+ CNN +预训练权重</li></ol><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es na"><img src="../Images/0e4984a51b45614592de8f3452fd734f.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*qPx3KUO13XmEfWKG1IuCtg.png"/></div></figure><p id="6cb6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">TrackNet在精度、召回率和F1-measure方面明显优于Archana的算法，分别达到95.7%、89.6%和92.5%。同样，很明显，使用<strong class="ix hj">三个连续帧比使用单个帧</strong>获得更高的结果。这进一步验证了作者的观点，即多帧为高速移动物体的模型提供了更多可训练的洞察力。</p><p id="ae8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">定位误差</strong></p><p id="7adc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">定位误差是作者定义的另一个度量，用于测量预测误差的适当规格。作者将定位误差定义如下，</p><blockquote class="nb"><p id="8720" class="nc nd hi bd ne nf ng nh ni nj nk js dx translated">网球的平均直径是5个像素，并且球的单位尺寸内的预测误差不会引起轨迹识别的误导。</p><p id="e18c" class="nc nd hi bd ne nf ng nh ni nj nk js dx translated">因此，我们将定位误差(PE)规格定义为5个像素，以指示球是否被准确检测到。PE大于5个像素的检测属于错误预测。</p></blockquote><p id="532b" class="pw-post-body-paragraph iv iw hi ix b iy nl ja jb jc nm je jf jg nn ji jj jk no jm jn jo np jq jr js hb bi translated">定位误差通过模型预测和地面实况之间的<strong class="ix hj">欧几里德距离</strong>计算。</p><p id="1c9d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以看到，总体而言，TrackNet模型II(多帧)比TrackNet模型I(单帧)做出低定位误差预测的概率更高。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es nq"><img src="../Images/a1b885db9801dc591d7c6b7c54751a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*NxyCBXR4pjwKri_PAgmo3w.png"/></div></figure><h2 id="d951" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated">结论</h2><p id="30a7" class="pw-post-body-paragraph iv iw hi ix b iy ma ja jb jc mb je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated"><strong class="ix hj">综上</strong>，<strong class="ix hj"> TrackNet是利用计算机视觉跟踪高速运动物体的有效方法。TrackNet的最大优势之一是它克服了模糊和残留图像的问题，甚至可以通过学习其轨迹模式来检测被遮挡的球。</strong></p></div><div class="ab cl nr ns gp nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="hb hc hd he hf"><h2 id="468a" class="lm ki hi bd kj ln lo lp kn lq lr ls kr jg lt lu kv jk lv lw kz jo lx ly ld lz bi translated">资源</h2><p id="8a8b" class="pw-post-body-paragraph iv iw hi ix b iy ma ja jb jc mb je jf jg mc ji jj jk md jm jn jo me jq jr js hb bi translated">git上提供了代码和论文，供您探索跟踪器并在您的视频上实现。</p><p id="bebd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">轨道网代码:<a class="ae iu" href="https://nol.cs.nctu.edu.tw:234/open-source/TrackNet" rel="noopener ugc nofollow" target="_blank">https://nol.cs.nctu.edu.tw:234/open-source/TrackNet</a></p><p id="04ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">论文:<a class="ae iu" href="https://arxiv.org/abs/1907.03698" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1907.03698</a></p><p id="2432" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">参考文献</strong></p><p id="634d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[1]俞，“跟踪网络:深度学习网络从广播视频中跟踪网球”，硕士论文，由和关指导，国立交通大学，2018年4月。</p><p id="5b50" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[2]阿尔恰纳和吉塔..(2015).广播网球视频中基于轨迹的目标检测与跟踪。计算机科学。58.225–232.10.1016/2015 . 08 . 060</p></div></div>    
</body>
</html>
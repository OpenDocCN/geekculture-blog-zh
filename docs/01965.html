<html>
<head>
<title>Building a Rich-Text Editor for Modern Publishers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为现代出版商构建富文本编辑器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/building-a-rich-text-editor-for-modern-publishers-cff7db6dc2e9?source=collection_archive---------11-----------------------#2021-04-30">https://medium.com/geekculture/building-a-rich-text-editor-for-modern-publishers-cff7db6dc2e9?source=collection_archive---------11-----------------------#2021-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ca1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">深入了解一个灵活的富文本编辑器的制作，它将作为我正在构建的新博客平台Blogody的一个组成部分发布。选择最适合现代出版商的编辑器技术是一条崎岖不平的道路。偷偷预览最后的结果…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a200ae0c291b75a8b3b5fbbe0f5c2d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YJoBbZ5NBII-W_-q.png"/></div></div></figure><p id="beb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你像这个数字时代的大多数人一样，你每天都在使用文本编辑器，更有可能是每隔一分钟就使用一次。只是给你朋友的一条短信，给你同事的一封电子邮件，或者给你老板的一份文件:大多数电子文本都是用编辑器编写的。</p><p id="07cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编辑器的无处不在可能会让你认为你在处理相当简单的技术，但事实远非如此。流畅、自然的编辑器体验只能由一种非常先进的技术来创造，这种技术考虑了所有可能的用户交互，同时保持极快的速度和惊人的响应。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/5a0127eecb2c598cf3aff593c440c9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ir6mWUvPfAKo-38c.jpg"/></div></div></figure><p id="1e70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于网络编辑来说更是如此，他们需要处理不同的浏览器技术，缓解他们的怪癖，补偿缓慢的网络速度，并默默地掌握所有复杂的状态和用户交互。</p><p id="4371" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现代作家和出版商需要一个编辑器来生成干净的、语义有意义的文档，让他们专注于写作和文章写作。这个行业最好的编辑是那些不太死板，但是仍然使用一些约束的人，这些约束对于特定的用例来说并不觉得是约束。这些编辑器巧妙地弥合了明确和僵化的降价编辑器和成熟的所见即所得编辑器之间的差距。</p><h1 id="3630" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">面向web的富文本编辑器</h1><p id="e3cc" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">为网络选择合适的编辑技术并不容易。由于浏览器本身理解JavaScript，所以编辑器应该用这种语言编写，或者在像React这样的框架中使用JavaScript。虽然有许多开源编辑器框架可用，但在2021年构建一个伟大的有意义的编辑器需要投入多少工作，这仍然让我感到惊讶。</p><p id="313a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于<a class="ae kt" href="https://www.https://www.blogody.com" rel="noopener ugc nofollow" target="_blank"> Blogody </a>，我要求框架包含原始的构建模块<em class="ku">和</em>定制编辑器以精确匹配主要目标群体的能力:现代内容出版商和作家。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/52f751fd3aa5e1a0aa4f43356f2b5150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mNrAY-T7heUncVqv.jpg"/></div></div></figure><p id="e879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我从Ghost的<a class="ae kt" href="https://github.com/TryGhost/Admin/tree/main/lib/koenig-editor" rel="noopener ugc nofollow" target="_blank">knig编辑器</a>开始，因为它是开源的。它使用<a class="ae kt" href="https://github.com/bustle/mobiledoc-kit" rel="noopener ugc nofollow" target="_blank"> Mobiledoc </a>连接<a class="ae kt" href="https://emberjs.com" rel="noopener ugc nofollow" target="_blank"> EmberJS </a>。我也打算使用React Mobiledoc变体，但是nig编辑器与EmberJS和Ghost的NodeJS管理接口耦合得太紧了。我想，把它雕刻出来比重新开始需要更多的工作。从零开始还让我有更多的自由从一开始就选择更好的技术堆栈。</p><p id="8d03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为<a class="ae kt" href="https://www.blogody.com" rel="noopener ugc nofollow" target="_blank"> Blogody </a>是用React构建的，所以更明智的选择是寻找一个原生React编辑器框架。这就是我了解<a class="ae kt" href="https://github.com/ianstormtaylor/slate" rel="noopener ugc nofollow" target="_blank"> Slate </a>的方式，它是由瑞士著名在线报纸<a class="ae kt" href="https://www.republik.ch/" rel="noopener ugc nofollow" target="_blank">Republic</a>的一位全栈开发者推荐给我的。Slate看起来非常有前途，有着清晰的原则、充满活力的开源社区和出色的React集成。受Republik团队成功故事的启发，我花了一个多月的时间构建了一个基于Slate的新编辑器。</p><p id="f3ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我仍然认为Slate具有最好的React接口，但它在一些意想不到的方面被证明是缺乏的:当你需要为原始元素构造合理的边界时，你没有得到太多的工具。例如，如果你想确保一个图片元素后面总是跟着一个段落，你必须在一个所谓的<a class="ae kt" href="https://docs.slatejs.org/concepts/11-normalizing" rel="noopener ugc nofollow" target="_blank">规格化器</a>函数中自己定义。虽然这是可能的，但您很快就会发现，您需要从头开始开发一个内容模式，这不是一个周末就能轻松完成的事情。更让我吃惊的是:在一台快速的台式电脑上粘贴长文档会使用户界面冻结超过7秒钟。就在那时，我对石板失去了耐心。</p><p id="af47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您需要为自己的项目选择一个编辑器框架，下面的建议可以节省我很多时间:</p><blockquote class="kv kw kx"><p id="793d" class="if ig ku ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><em class="hi">在您决定采用哪种技术之前，请使用苛刻的测试数据进行一些简单的最终用户测试。对于一个编辑来说，复制&amp;粘贴大量文本，高速书写文本等。看看在压力下这项技术是否还能打动你。</em></p></blockquote><h1 id="6b59" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">进入ProseMirror</h1><p id="23d2" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">有了这些发现，我发现自己又回到了原点。缓慢的编辑器是获得无缝React集成的代价吗？有没有我还没发现的替代品？</p><p id="475f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在四处寻找时，我偶然发现了一篇关于<a class="ae kt" href="https://prosemirror.net" rel="noopener ugc nofollow" target="_blank"> ProseMirror </a>的文章，这是另一个广受好评的编辑器框架，用于<a class="ae kt" href="https://open.nytimes.com/building-a-text-editor-for-a-digital-first-newsroom-f1cb8367fc21" rel="noopener ugc nofollow" target="_blank"> New Your Times </a>的数字新闻室。开源了一个更传统但有用的论坛社区，完全由创作者和大师维护。这个项目得到了一些知名公司的支持，所以引起了我的注意。第一次最终用户测试显示了惊人的性能特征。上面提到的例子在Slate中用了7秒钟，在ProseMirror中用了150毫秒就完成了——这立刻让我兴奋不已。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lb"><img src="../Images/ed929bb155af175be9d694f67776bb3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Wvea_h2oX4_es0Sf.png"/></div></div></figure><p id="3db4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ProseMirror只有一个问题。我怎么可能将ProseMirror集成到Blogody React应用程序中？我发现的所有ProseMirror-React样板实现看起来都非常复杂，我几乎不明白它们在做什么:React和ProseMirror之间的状态通信既不直接也不容易。</p><p id="fd46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在ProseMirror论坛社区的一些人的帮助下，我开始尝试做一个简单的React桥。第一步真的很难，我经常想退出那个实验。我需要多少时间来完成简单的事情，比如集成一个简单的段落反应组件？</p><p id="0560" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">虽然我学到了很多关于ProseMirror乐高积木和你可以连接的精心设计的界面的知识，但当我突然想到一个绝妙的主意时，我几乎放弃了ProseMirror:</p><blockquote class="kv kw kx"><p id="978b" class="if ig ku ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><em class="hi">让ProseMirror处理原始元素，如段落、图形等。使用它的原生JavaScript框架，只对交互式覆盖元素使用React，比如悬停栏或下拉菜单。</em></p></blockquote><p id="9097" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这种清晰的概念区分，我能够更快地取得进展，并确保ProseMirror良好的性能特征，同时能够将编辑器集成到主React应用程序中。</p><p id="a222" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">再过一个月回头看，我确信这最终是正确的选择。ProseMirror在处理基本编辑器元素方面非常有效，它很容易通过插件方法进行扩展，并通过灵活的模式设计系统确保文档的完整性。此外，它允许我通过我定制的React桥用复杂的React覆盖组件修改它。</p><p id="3b27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">渴望看到一些演示结果吗？开始了。</p><h1 id="affb" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">悬停工具栏</h1><p id="335a" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">我一直是上下文工具栏的粉丝，这些工具栏提供了此时此刻有意义的编辑选择。只需选择一些文本，嵌入式格式工具栏就会打开:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/f9de693553bc6cb799fefba9b0dbcc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4B8TMPx7tXFL10x0.gif"/></div></div></figure><p id="0dbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">侧菜单允许您插入块级内容，如水平线或图像。如下图所示，每一行都会出现一个加号按钮:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/fa39153715b9bb22f5a3f5000b1edac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eLc_m2huwlms_pZi.gif"/></div></div></figure><h1 id="c1d4" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">侧菜单</h1><p id="723e" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">侧菜单允许您插入块级内容，如水平线或图像。如下图所示，每一行都会出现一个加号按钮:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/774cb91c186d788b8aa0a539eab82bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_2REwiOPpMJuDtth.gif"/></div></div></figure><h1 id="070d" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">快捷键</h1><p id="9272" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">Blogody编辑器的早期设计目标之一是让键盘成为一流的输入法。虽然每个动作都可以用鼠标调用，但键盘也是一个不错的选择。</p><ul class=""><li id="ea79" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> + <code class="du ln lo lp lq b">b</code>切换选择<strong class="ih hj">粗体</strong>。</li><li id="42d9" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> + <code class="du ln lo lp lq b">i</code>切换选择<em class="ku">斜体。</em></li><li id="5512" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> + <code class="du ln lo lp lq b">`</code>切换选择<code class="du ln lo lp lq b">inline code</code>。</li><li id="ec2b" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> <code class="du ln lo lp lq b">Shift</code> + <code class="du ln lo lp lq b">1...3</code>将文本块更改为某一级别的标题。</li><li id="4c3e" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> <code class="du ln lo lp lq b">Shift</code> + <code class="du ln lo lp lq b">8</code>在有序列表中包装选择。</li><li id="7ee5" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">Ctrl</code> <code class="du ln lo lp lq b">Shift</code> + <code class="du ln lo lp lq b">9</code>在项目符号列表中换行。</li></ul><h1 id="1acc" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">输入规则</h1><p id="6153" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">您也可以使用受降价启发的输入规则。按下<code class="du ln lo lp lq b">/</code>即可打开侧菜单，您可以用箭头键移动当前选择，用<code class="du ln lo lp lq b">Enter</code>确认或用<code class="du ln lo lp lq b">Esc</code>离开。</p><p id="ff27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面的截屏演示了在不离开键盘的情况下构建文本是多么容易:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/49d96abcf3b893ff5a17ac3ee18864bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CHEIWfGOkLRWIQuE.gif"/></div></div></figure><ul class=""><li id="fcb5" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">#</code>后跟一个空格，作为标题行的开始。</li><li id="c306" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">##</code>后跟一个空格，以此行开始一个子标题。</li><li id="8dcf" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">###</code>后跟一个空格，使该行成为子标题。</li><li id="fd3c" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">-</code>或<code class="du ln lo lp lq b">*</code>后跟一个空格，创建一个项目符号列表。</li><li id="2390" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">1.</code>后跟一个空格，创建一个有序列表。</li><li id="fac0" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">&gt;</code>后跟一个空格，创建一个引号。</li><li id="97eb" class="le lf hi ih b ii lr im ls iq lt iu lu iy lv jc lj lk ll lm bi translated"><code class="du ln lo lp lq b">```</code>创建一个代码块。</li></ul><h1 id="7173" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Unsplash小工具</h1><p id="1f70" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">ProseMirror React桥还可以实现更复杂的功能。我已经与Unsplash合作，能够将免版税的图像拾取器集成到Blogody编辑器中:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ld"><img src="../Images/34e799d48d5086bc6cc57a7702804a50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sKLlCIVAFFi4I-kd.gif"/></div></div></figure><h1 id="bb2c" class="jq jr hi bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">摘要</h1><p id="0d85" class="pw-post-body-paragraph if ig hi ih b ii ko ik il im kp io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated">Blogody的richt-text编辑器非常适合现代网络，将帮助作家和出版商专注于为他们的观众制作令人惊叹的内容。该编辑器由ProseMirror提供支持，非常稳定和快速。使用新开发的用于Blogody的React bridge，甚至像Unsplash图像拾取器这样的复杂小部件也可以轻松集成，并且您可以期待在未来的<a class="ae kt" href="https://www.blogody.com/news" rel="noopener ugc nofollow" target="_blank"> Blogody版本</a>中出现更多引人注目的功能。</p><blockquote class="kv kw kx"><p id="c6d4" class="if ig ku ih b ii ij ik il im in io ip ky ir is it kz iv iw ix la iz ja jb jc hb bi translated"><a class="ae kt" href="https://www.blogody.com/landing" rel="noopener ugc nofollow" target="_blank"> <em class="hi">你想提前使用我正在创建的全新博客平台Blogody吗？只需在新的Blogody登录页面注册，成为第一批收到通知的人！</em> </a></p></blockquote></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="0635" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ku">原载于2021年4月30日https://www.jamify.org</em><em class="ku"/><a class="ae kt" href="https://www.jamify.org/2021/04/30/building-a-rich-text-editor-for-modern-publishers/" rel="noopener ugc nofollow" target="_blank"><em class="ku">。</em></a></p></div></div>    
</body>
</html>
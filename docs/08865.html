<html>
<head>
<title>Draw Path with Animation in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android中用动画绘制路径</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/draw-path-with-animation-in-android-21934e29a10d?source=collection_archive---------4-----------------------#2021-11-17">https://medium.com/geekculture/draw-path-with-animation-in-android-21934e29a10d?source=collection_archive---------4-----------------------#2021-11-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3a1459d66ed7d2c1fac4901ae3bb725f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*M4cX5aAkwfcjEMry1J-BOA.gif"/></div></div></figure><p id="1400" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几天前，我需要画一张图，画出从起点到终点的路径，这让我开始思考如何实现这个目标。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es jo"><img src="../Images/6ff088fc0a9ea192562d8b20bdf94c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/1*ljo5j_c06BFKF4XG7AXOkg.gif"/></div></figure><p id="5628" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">找了很久之后，我找到了这个图书馆。</p><div class="jt ju ez fb jv jw"><a href="https://github.com/swapnil1104/CurveGraphView" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">GitHub-swap nil 1104/CurveGraphView:一个高度可定制和高性能的定制视图，用于呈现…</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">一个高度可定制和高性能的自定义视图来呈现曲线图形。在一个图形中添加多个折线图…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">github.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/95ce24d7dc5743571b7df214af98835b.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/0*GBBi9SjBEk_OlRfr.gif"/></div><figcaption class="km kn et er es ko kp bd b be z dx"><a class="ae kq" href="https://github.com/swapnil1104/CurveGraphView" rel="noopener ugc nofollow" target="_blank">https://github.com/swapnil1104/CurveGraphView</a></figcaption></figure><p id="7054" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如何使用此库:</p><p id="5a4b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第一步</strong>:在Gradle文件中添加库</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="a88c" class="kw kx hi ks b fi ky kz l la lb">dependencies {<br/>    implementation 'com.github.swapnil1104:CurveGraphView:{current_lib_ver}'<br/>}</span></pre><p id="ab36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二步:</strong>定义配置</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="8533" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步</strong>:创建点地图</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="616a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤4 </strong>:使用点创建图形数据</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="49b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第五步</strong>:在曲线图视图中添加图形数据</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><p id="14cf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是这个库的限制是当你想要创建一个<strong class="is hj">贝塞尔曲线的时候，你不能控制中点。比如你想在哪个方向以什么角度弯曲你的曲线。</strong></p><p id="e601" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当你打开CurveViewGraph类时，你会看到下面的代码。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="acce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这告诉我们中点在x的起点和y的终点。</p><p id="702c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以现在第二个选项是自定义视图。让我们开始在画布上创建一个路径，然后添加动画。</p><p id="565d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1 </strong>:创建自定义视图类扩展视图类。</p><p id="708f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二步:</strong>定义油漆</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="0ed7" class="kw kx hi ks b fi ky kz l la lb">private val linePaint = Paint(<em class="ll">ANTI_ALIAS_FLAG</em>).<em class="ll">apply </em><strong class="ks hj">{<br/>    </strong><em class="ll">style </em>= Paint.Style.<em class="ll">STROKE<br/>    strokeWidth </em>= 14f<br/>    <em class="ll">color </em>= Color.parseColor("#E02E2E")<br/><strong class="ks hj">}</strong></span></pre><p id="c178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步:</strong>我把我的视图宽度分成10个部分来得到坐标。然后计算x轴和y轴。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="bc32" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这样我就创造了路径。</p><p id="189e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤4 </strong>:提供我们正在绘制的画布的宽度和高度。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="8a20" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<code class="du lm ln lo ks b"><strong class="is hj">onSizeChanged</strong></code>方法计算大小，并调用init()创建路径。</p><p id="2de8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第五步:</strong>在画布上绘制路径</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="4e28" class="kw kx hi ks b fi ky kz l la lb">override fun onDraw(canvas: Canvas) {<br/>    super.onDraw(canvas)<br/>    canvas.drawPath(path, linePaint)<br/>}</span></pre><p id="1178" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤6 </strong>:在布局XML文件中定义该视图。</p><figure class="jp jq jr js fd ij"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="a023" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行应用程序，你会看到一个没有动画的图形。</p><p id="b507" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第七步</strong>:添加动画，获取路径长度</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="662b" class="kw kx hi ks b fi ky kz l la lb">val measure = PathMeasure(path, false)<br/>length = measure.<em class="ll">length</em></span></pre><p id="b72d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第八步</strong>:创建路径效果</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="4a8b" class="kw kx hi ks b fi ky kz l la lb">private fun createPathEffect(pathLength: Float, phase: Float, offset: Float): PathEffect? {<br/>    return DashPathEffect(<br/>            <em class="ll">floatArrayOf</em>(pathLength, pathLength),<br/>            (phase * pathLength).<em class="ll">coerceAtLeast</em>(offset)<br/>    )<br/>}</span></pre><p id="f4ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">DashPathEffect分阶段创建路径。间隔数组必须包含偶数个条目。phase是intervals数组中的偏移量。</p><p id="1f04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">params:intervals-ON和OFF距离的数组<br/>phase-偏移到intervals数组中</p><p id="3537" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第9步</strong>:设定相位</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="0782" class="kw kx hi ks b fi ky kz l la lb">fun setPhase(phase: Float) {<br/>    Logger.d("CurveGraphDrawable", "setPhase called with:$phase")<br/>    linePaint.<em class="ll">pathEffect </em>= createPathEffect(length, phase, 0.0f)<br/>    invalidate() <em class="ll">//will call onDraw<br/></em>}</span></pre><p id="5448" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第十步:使用物体动画制作工具制作动画</p><pre class="jp jq jr js fd kr ks kt ku aw kv bi"><span id="cdd2" class="kw kx hi ks b fi ky kz l la lb">val animator = ObjectAnimator.ofFloat(this, "phase", 1.0f, 0.0f)<br/>animator.<em class="ll">duration </em>= 3000<br/>animator.start()</span></pre><p id="defc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以点击查看完整的自定义类代码<a class="ae kq" href="https://gist.github.com/karishmaagr/27ca192a163dad37d40622542a9b549e" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="7934" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在运行应用程序，你会看到一个带动画的图表。你可以根据自己的需要进行实验。</p></div><div class="ab cl le lf gp lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="hb hc hd he hf"><h1 id="fc40" class="lp kx hi bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="b3ab" class="pw-post-body-paragraph iq ir hi is b it mm iv iw ix mn iz ja jb mo jd je jf mp jh ji jj mq jl jm jn hb bi translated">主要动机是了解动画如何在道路上工作。即使当你使用任何开源库来创建一个图形时，也要从内部检查它做了什么，你可能不需要添加整个库，只需要一小块代码就可以了。</p><p id="0d22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">希望这篇文章对你有帮助。做实验，和我分享你实现了什么。</p><p id="dee4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你有任何反馈，请给我回信，地址是<em class="ll">karishma.agr1996@gmail.com。</em>非常感谢您的鼓掌帮助他人找到这篇文章😃。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/a3a507a7508141e4159bf9fe4167b3cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*_bbYwoN-6Vrr4gzJ.gif"/></div></figure></div></div>    
</body>
</html>
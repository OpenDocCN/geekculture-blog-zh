<html>
<head>
<title>End to End(E2E) Testing for Web Apps with Cypress.io</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Cypress.io对Web应用进行端到端(E2E)测试</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/end-to-end-e2e-testing-for-web-apps-with-cypress-io-f45aba0a5fd8?source=collection_archive---------12-----------------------#2021-10-31">https://medium.com/geekculture/end-to-end-e2e-testing-for-web-apps-with-cypress-io-f45aba0a5fd8?source=collection_archive---------12-----------------------#2021-10-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/d3a719a3300dd611c2b69e8c37a731c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdDsYroMlzoTpGrWSGwAYQ.png"/></div></div></figure><p id="2335" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们都知道为应用程序编写测试是一种痛苦。😆</p><p id="dfc5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Cypress是一个最近发布的前端测试工具，它非常容易与你的web应用集成，不仅可以创建端到端的测试，还可以创建单元测试和集成测试。</p><ul class=""><li id="76c2" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">E2E测试从头到尾测试整个特定应用程序的工作流程。</li><li id="8ac4" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">单元测试测试一小段代码(特定的功能)。</li><li id="8253" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">集成测试测试集成的组件行为。</li></ul><p id="7415" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它是一个纯粹基于Javascript的工具，可以用于在浏览器上运行的任何东西。</p><p id="f012" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自动等待、时间旅行、录制测试工作流视频的能力、代码发生变化时的自我刷新、网络流量控制、跨浏览器测试、简单设置是cypress中存在的一些很酷的特性。</p><p id="52d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们将cypress集成到简单的react应用程序中。</p><p id="e2df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，使用NPM或Yarn命令将cypress安装到应用程序中。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="b0ab" class="km kn hi ki b fi ko kp l kq kr">NPM: npm install cypress --save </span><span id="f621" class="km kn hi ki b fi ks kp l kq kr">Yarn: yarn add cypress </span></pre><p id="98cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以通过查看package.json文件来验证安装</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/9ad79cd01e2c63977720b3925b828676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PG0iygAh2IuSsbJiI76xCQ.jpeg"/></div></div></figure><p id="484b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，您可以安装start-server-and-test npm包，它有助于首先启动web应用程序，然后运行测试。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="c6b4" class="km kn hi ki b fi ko kp l kq kr">npm i start-server-and-test --save</span></pre><p id="faa0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在进行任何配置更改之前，使用下面的命令打开Cypress测试运行器。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="be0a" class="km kn hi ki b fi ko kp l kq kr">npx cypress open</span></pre><p id="ac98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">成功执行该命令将在项目文件夹中创建一个名为cypress的文件夹，一些子文件夹作为fixtures、integration、plugins和support作为初始目录。</p><p id="40d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">前后的文件夹结构。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/acf40e8bdbe21fd4fd84e1b965c93035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b59B6PqJSpl7nLTrbJ6puA.png"/></div></div></figure><p id="b1df" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它还打开了Cypress测试运行器，如下图所示，带有一些示例测试。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/16743d40becd0d379c9a410d9a961ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jjlgkQFdcgGrzRUytGTVQ.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/66f6abc46b338d6fce435218f1b8059f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyNxhh_ezMOk759yBElR4A.png"/></div></div></figure><p id="672e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">cypress测试运行程序试图找到用户机器上所有兼容的浏览器。</p><p id="fa98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除非safari和IE浏览器不支持这两种浏览器，否则您可以选择任何浏览器在任何特定的浏览器中执行测试。</p><p id="6c0a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将配置其余的配置。让我们创建一个脚本命令，通过启动应用服务器，使用cypress仪表板执行cypress测试。为此，我们需要使用之前安装的启动服务器和测试包。</p><p id="8101" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在package.json文件脚本部分，您需要做一些修改，如下图所示。除了我设置的名字，你可以随意设置任何命令名。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/43c83b2c451ea23a92538f336b6f56e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtCTOkGHV-9-xVdDN09myw.png"/></div></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8f6a" class="km kn hi ki b fi ko kp l kq kr">"cy:open": "npx cypress open",</span><span id="9cfd" class="km kn hi ki b fi ks kp l kq kr">"cypress": "start-server-and-test start http://localhost:3000 cy:open",</span></pre><p id="e9b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将使用URL<a class="ae jo" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank">http://localhost:3000</a>启动应用服务器，稍后打开Cypress测试运行器进行测试执行。</p><p id="bfde" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了这个命令之外，您还可以在terminal/cmd中包含以下代码行来执行cypress测试，而不是打开Cypress测试运行程序。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="cec1" class="km kn hi ki b fi ko kp l kq kr">"cy:run": "npx cypress run",</span><span id="90db" class="km kn hi ki b fi ks kp l kq kr">"cy:ci": "start-server-and-test start http://localhost:3000 cy:run"</span></pre><p id="17af" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在对package.json脚本部分进行了所有修改之后，它将如下所示。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/65ef4ecc7b452bc13745e1dc905f311d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*t3NN1w0sRhyFQSUWscV6LQ.png"/></div></figure><p id="ce22" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们为我创建的简单react应用程序创建一些cypress测试。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/b490ebbc4c49d79bf3f3665f4e628531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k9O6zlT9euHe0OXR2wRpag.png"/></div></div></figure><p id="e678" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用户单击注册按钮而没有在输入字段中输入值，将会在注册表单中显示错误消息。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/d2f2e5abcc0a4bf38dd1308dd5dcb70c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ItCSnkUlyA-ruCZhNOwDew.png"/></div></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lb"><img src="../Images/2b1801dc7dc017d28b85807a2735c28e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U9yE5HYCUC83iQ3FsMSdzA.png"/></div></div></figure><p id="988d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">成功提交包含完整详细信息的注册表将显示一条成功消息。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div class="er es lc"><img src="../Images/a510fd63c713fc845b03e1a862e99024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*0eqUKXadSWRPfXac6lgfIQ.png"/></div></figure><p id="03bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在集成文件夹中创建一个cypress测试文件。</p><p id="4afd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为这是一个简单的注册表单，所以将在integration文件夹中创建cypress测试文件registerForm.spec.js。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/3e39b7808a1ee9dc045f5cfbb5d80389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19Cw9XyKhUehaiWhHW8XJQ.png"/></div></div></figure><p id="8839" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们在那个文件中写一些测试。</p><p id="88e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们需要使用<strong class="is hj"> describe() </strong>方法指定测试套件名称。</p><p id="c8c9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这个测试套件中，可以包含我们希望使用<strong class="is hj"> it() </strong>方法覆盖的任意数量的测试场景。</p><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="30e0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> cy.visit() </strong> —帮助导航到特定的URL/页面。但是请记住，cypress只支持一个测试中的同源。不能使用cy.visit重定向到两个不同的域。</p><p id="1d4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> cy.get() </strong> —用于获取元素(捕获dom中的特定HTML元素)</p><p id="ffca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的测试用于加载页面，并验证表单是否正确加载了表单中必要的表单元素。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/44433d781d1a0a1e87fcdfc7fa0a1356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mpykVz_FvWK-UKaQ11-mZA.gif"/></div></div></figure><p id="b3b1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们来看看如何做一个断言。</p><p id="f778" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">断言将有助于验证场景，如元素是可见的，在某些条件为真后立即启用，或者在元素中有特定的CSS类、状态变化或属性。</p><p id="22d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们想象一下上面的测试案例，一旦页面被加载，我们验证了一个特定的表单有一个输入名字的输入字段。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="0e08" class="km kn hi ki b fi ko kp l kq kr">//verify that first name input field is rendered correctly in the resgiration form with placeholder as expected. <br/>cy.get('input[id="first-name"]').should('have.attr', 'placeholder', 'First Name');</span></pre><p id="52c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">。</strong> -是最常用的断言方法。</p><p id="4072" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">参考资料:</p><ul class=""><li id="4d65" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><a class="ae jo" href="https://www.toolsqa.com/cypress/cypress-assertions/#:~:text=Assertions%20enable%20you%20to%20validate,cases%20should%20have%20assertion%20steps" rel="noopener ugc nofollow" target="_blank">https://www . tools QA . com/cypress/cypress-Assertions/#:~:text = Assertions % 20 enable % 20 you % 20 to % 20 validate，cases % 20 should % 20 have % 20 assertion % 20 steps</a>。</li><li id="0ca0" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://cheatography.com/aiqbal/cheat-sheets/cypress-io/" rel="noopener ugc nofollow" target="_blank">https://cheatography.com/aiqbal/cheat-sheets/cypress-io/</a></li></ul><p id="bd7f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以参考cypress cheat sheet URL来获取更多可用的关键字。</p><p id="073f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下测试将有助于验证以下场景。</p><ul class=""><li id="f21e" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">验证注册表单是否正确加载了所有输入字段和按钮。</li><li id="ed82" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">验证正确的表单提交将显示成功消息。</li><li id="2e0e" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">不完成注册表单就验证表单提交将向用户显示相关的错误消息。</li></ul><figure class="kd ke kf kg fd ij"><div class="bz dy l di"><div class="le lf l"/></div></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/ab794981430b7f04b2f2c2f765ca4b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Kw4XWGzyj8G9TtoOvW0M3g.gif"/></div></div></figure><p id="dab0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文的目的是给出对cypress框架的一些基本理解，并动手为您的web应用程序编写cypress测试。</p></div></div>    
</body>
</html>
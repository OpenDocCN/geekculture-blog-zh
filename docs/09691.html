<html>
<head>
<title>Java Bundles For The Win ! — An Introduction To OSGI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">赢得胜利的Java包！OSGI简介</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/java-bundles-for-the-win-an-introduction-to-osgi-f4ebc487bce6?source=collection_archive---------9-----------------------#2021-12-23">https://medium.com/geekculture/java-bundles-for-the-win-an-introduction-to-osgi-f4ebc487bce6?source=collection_archive---------9-----------------------#2021-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8cab6bd4719ce82cd1121f3b14f10d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M-YwTPlgtpo2oN-E"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@ryanmwan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ryan W</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0260" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您是Java生态系统的新手，您可能不会听说过OSGI。但是不用担心，在本文中，我将让您对OSGI的基础知识及其用例有一个坚实的理解。</p><p id="dacd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">OSGI，简称<strong class="ix hj"> <em class="jt">开放服务网关倡议</em> </strong>是Java中用于<strong class="ix hj"> <em class="jt">模块化</em> </strong>和<strong class="ix hj"> <em class="jt">动态</em> </strong>应用开发的标准。那么在这里，模块化和动态是什么意思呢？模块化意味着“由不同部分组成”，动态意味着“易于不断变化、活动”，因此作为一个整体，我们可以说它是一个由不断变化和活动的、不同的小组件组成的框架。</p><p id="a049" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">OSGI标准定义了一个规范，将单个Java应用程序分成更小的组件，称为“捆绑包”,可以单独安装、删除、启动或更新，但OSGI计划最有趣的一点是，所有这些都可以在不重启应用程序的情况下完成。因此，您可以热部署(在运行中部署组件)您的java组件，而无需停止和重新启动整个应用程序，这通常会花费很多时间。</p><p id="8c48" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们假设您创建一个应用程序作为一个单独的jar文件并部署它。然后，如果您想从项目中删除一个包，并将另一个包的新版本添加到项目中，您只需在代码级别进行更改，然后重新编译并将整个项目打包为一个全新的jar。然后，您必须停止正在运行的应用程序，并再次重新部署它。但是，如果您已经使用了基于模块化OSGI的方法，那么您可以简单地“取消部署”特定的包，并在原始应用程序已经运行的情况下添加所需包的新版本！</p><h2 id="d84d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">束</h2><p id="a401" class="pw-post-body-paragraph iv iw hi ix b iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">OSGI规范中的原子实体是我上面提到的<strong class="ix hj">包</strong>。bundle是紧密耦合的类和配置文件的集合。或者简单地说，包是一个<strong class="ix hj"> jar </strong>文件和一个名为MANIFEST的配置文件的组合。包含OSGI特定元数据的MF。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/2b01f6adc0ddedbfb03bbafe1ea2b12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*hYcFLpdU7dgfTRFHu9FN_Q.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Bundle vs Jar</figcaption></figure><p id="db03" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">清单。MF文件包含OSGI运行时将jar注册为包所需的元数据。显化。MF文件指定了包的命名、包的版本以及最重要的包使用的导入和导出。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/c8beed436c50781d0f3264e02b9d7aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYOWO_IPi4iF3mAtZPdOMA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">A simple MANIFEST.MF</figcaption></figure><p id="a120" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面我已经给出了一个简单的例子。MF文件看起来像。bundle name是bundle/component的名称，这可以是一个简单的人类可识别的名称，但是bundle-SymbolicName对于每个Bundle必须是唯一的<strong class="ix hj">并且不能重复。OSGI运行时使用它来唯一区分每个包。通常使用组id和工件id的组合来生成这个SymbolicName。</strong></p><p id="703b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里给出的另外两个重要字段是包激活器和导入包。在Bundle-Activator字段中，我们需要给出作为Bundle入口点的类的名称。这意味着当某个包启动时应该执行/运行的类。您可以将它与普通Java应用程序中的<strong class="ix hj">public void main(String[]args)</strong>方法进行比较，因此这个Bundle-Activator类是应用程序首次开始在OSGI环境中运行时将被执行的类。</p><p id="b69d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Import-Package字段定义了需要由特定包导入的外部包/包。假设有3个名为example.rashmin.A、example.rashmin.B和example.rashmin.C的包，如果包A将另外两个包作为“依赖包”,那么它的Import-Package字段将类似于下面的内容。</p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="9ba0" class="ju jv hi lb b fi lf lg l lh li">Import-Package: example.rashmin.B, example.rashmin.C, org.osgi.framework</span></pre><p id="341c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">类似于这个Import-Package字段，还有另一个Export-Package字段，它指定我们需要在我们的包中导出哪些包，以供其他包显式使用。我将在以后的文章中谈到这一点。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><h2 id="414c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">OSGI实现</h2><p id="582c" class="pw-post-body-paragraph iv iw hi ix b iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">现在我们对OSGI的基础有了一个简单的了解。让我们讨论不同的OSGI实现。因为OSGI只是一个规范，所以需要具体实现来将那些规范和标准带入现实生活。目前市场上有几种流行的OSGI实现。</p><ol class=""><li id="d428" class="lq lr hi ix b iy iz jc jd jg ls jk lt jo lu js lv lw lx ly bi translated">日食春分</li><li id="93fa" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">阿帕奇菲利克斯</li><li id="3cd8" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">克诺弗勒鱼OSGI</li></ol><h2 id="558c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">日食春分</h2><p id="5ae7" class="pw-post-body-paragraph iv iw hi ix b iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">在这篇文章中我将谈到<a class="ae iu" href="https://www.eclipse.org/equinox/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> <em class="jt">【日食春分】</em> </strong> </a> <strong class="ix hj"> <em class="jt"> </em> </strong>的实现。它实现了OSGI规范的所有最新规范，也用作参考实现。让我们用Equinox框架做一个小演示吧！</p><p id="287d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以从<a class="ae iu" href="https://download.eclipse.org/equinox/" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj"> <em class="jt">这个</em></strong></a><strong class="ix hj"><em class="jt"/></strong>链接下载春分框架。您可以下载最新版本或以前的版本。确保下载名为equinox-SDK-x.xx.zip的文件。您可以通过以下命令下载它</p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="3c58" class="ju jv hi lb b fi lf lg l lh li">wget http://www.eclipse.org/downloads/download.php\?file\=/equinox/drops/R-Neon-201606061100/equinox-SDK-Neon.zip</span></pre><p id="8a14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下载完zip文件后，解压它，你会看到里面有几个文件夹和文件。现在你必须创建一个单独的文件夹，并将下面的文件从<unzip_location> /plugins目录复制到其中。</unzip_location></p><ol class=""><li id="fe85" class="lq lr hi ix b iy iz jc jd jg ls jk lt jo lu js lv lw lx ly bi translated">org.eclipse.osgi_XXX.jar</li><li id="0737" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">org . eclipse . equinox . console _ XXX . jar</li><li id="d20f" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">org . Apache . Felix . gogo . runtime _ XXX . jar</li><li id="d67b" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">org . Apache . Felix . gogo . shell _ XXX . jar</li></ol><p id="1d4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后在这个名为<strong class="ix hj">configuration，</strong>的新文件夹中创建一个文件夹，并在其中创建一个config.ini文件，内容如下。</p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="2b39" class="ju jv hi lb b fi lf lg l lh li">osgi.bundles=file\:org.eclipse.equinox.console_&lt;YOUR_VERSION&gt;.jar@start,file:\org.apache.felix.gogo.runtime_&lt;YOUR_VERSION&gt;.jar@start,file:\org.apache.felix.gogo.shell_&lt;YOUR_VERSION&gt;.jar@start</span></pre><p id="de1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我的例子中，config.ini文件如下所示</p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="6de9" class="ju jv hi lb b fi lf lg l lh li">osgi.bundles=file\:org.eclipse.equinox.console_1.1.200.v20150929-1405.jar@start,file:\org.apache.felix.gogo.runtime_0.10.0.v201209301036.jar@start,file:\org.apache.felix.gogo.shell_0.10.0.v201212101605.jar@start</span></pre><p id="7eb7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，你的文件夹结构应该是这样的。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es me"><img src="../Images/705d5bb4cf50b6e8ac21c30712e8c637.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*VUErvB39F2cfgoTmOam4Lg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Folder Structure</figcaption></figure><p id="5ae5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">完成后，您可以从终端进入您的<myosgidir>并输入以下命令。</myosgidir></p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="f6c8" class="ju jv hi lb b fi lf lg l lh li">java -jar org.eclipse.osgi_&lt;YOUR_VERSION&gt;.jar -console</span></pre><p id="6ab2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">终端应该如下所示。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/094e223e75ca5c156204d73070eb9acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*AUUcaIg_fyi9JPW1BPRUPg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">OSGI Terminal</figcaption></figure><p id="f30a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该终端中使用了一组equinox专用命令。您可以从Equinox官方文档中进一步了解这些命令。</p><p id="6c71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以输入<strong class="ix hj"> <em class="jt"> ss </em> </strong>查看您所有激活的捆绑包。</p><figure class="kv kw kx ky fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/0748e675f33d9d70407558b274b810ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*qck9WvVUMfTZRhCwubSdow.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">All bundles</figcaption></figure><p id="1a6e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，您可以看到我们复制的所有四个罐子都在这里。</p><p id="916e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你看一下这篇文章。您可能会注意到两个重要的列，id和state。</p><p id="1c20" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Id 是OSGI运行时给每个安装包的唯一Id。我们可以通过这个id很容易地引用这些包，来启动、停止或删除它们。然后另一列<strong class="ix hj"> State </strong>描述了该特定束的当前状态。这可以描述包生命周期的任何阶段，如<strong class="ix hj">安装、解决、启动、激活、停止或卸载。</strong></p><h2 id="9591" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">捆绑包生命周期</h2><p id="2eb3" class="pw-post-body-paragraph iv iw hi ix b iy kp ja jb jc kq je jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">在OSGI框架中，每个OSGI包都经历一个特定的生命周期，所有这些生命周期阶段都有状态。</p><ol class=""><li id="661a" class="lq lr hi ix b iy iz jc jd jg ls jk lt jo lu js lv lw lx ly bi translated">已安装—软件包安装完成。</li><li id="a37b" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">RESOLVED — OSGI运行时已经解析了它的所有依赖项</li><li id="b814" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">启动——调用包的入口点，包正在启动</li><li id="53de" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">活动—软件包已成功启动并正在运行</li><li id="fa06" class="lq lr hi ix b iy lz jc ma jg mb jk mc jo md js lv lw lx ly bi translated">停止/卸载是不言自明的。</li></ol><p id="4757" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以通过OSGI控制台来控制一个包的这些状态，</p><pre class="kv kw kx ky fd la lb lc ld aw le bi"><span id="31e6" class="ju jv hi lb b fi lf lg l lh li">osgi &gt; install file:home/user/service1.jar<br/>osgi &gt; start 5<br/>osgi &gt; stop 5<br/>osgi &gt; uninstall 5</span></pre><p id="59a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">(5是捆绑包的示例OSGI id。)</p><p id="e590" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以利用所有这些。你可以做一个有清单的罐子。MF文件并打包成一个包，通过OSGI控制台随时安装/启动/停止它。</p></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="f64f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我简要介绍了Java中的OSGI。在下一篇文章中，我将制作一个简单的OSGI包，并将其部署在OSGI框架中。</p><p id="f0aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望大家看了文章都有所收获。如果你喜欢就关注一下。干杯。</p><div class="mh mi ez fb mj mk"><a href="https://www.linkedin.com/in/rashmin95/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">Ravindu Rashmin -软件工程师- WSO2 | LinkedIn</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">在世界上最大的职业社区LinkedIn上查看Ravindu Rashmin的个人资料。Ravindu列出了7个工作…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">www.linkedin.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my io mk"/></div></div></a></div><p id="485c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">资源</strong></p><div class="mh mi ez fb mj mk"><a href="https://en.wikipedia.org/wiki/OSGi" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">OSGi -维基百科</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">OSGi联盟，以前被称为开放服务网关倡议，是一个开放标准组织，成立于…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">en.wikipedia.org</p></div></div><div class="mt l"><div class="mz l mv mw mx mt my io mk"/></div></div></a></div><div class="mh mi ez fb mj mk"><a href="https://www.eclipse.org/equinox/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">equinox | Eclipse基金会</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">从代码的角度来看，Equinox是OSGi核心框架规范的一个实现，这是一组包…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">www.eclipse.org</p></div></div><div class="mt l"><div class="na l mv mw mx mt my io mk"/></div></div></a></div><div class="mh mi ez fb mj mk"><a href="https://www.osgi.org/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hj fi z dy mp ea eb mq ed ef hh bi translated">OSGi工作组Eclipse基金会</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">新闻查看所有提交的新闻事件查看所有提交的事件成为成员查看所有成员</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">www.osgi.org</p></div></div><div class="mt l"><div class="nb l mv mw mx mt my io mk"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Fine-tuning BERT with 5 lines of code!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用5行代码微调BERT！</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/fine-tuning-bert-with-5-lines-of-code-78803a51c14b?source=collection_archive---------18-----------------------#2021-07-08">https://medium.com/geekculture/fine-tuning-bert-with-5-lines-of-code-78803a51c14b?source=collection_archive---------18-----------------------#2021-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bd73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，让我们试着了解如何在Kaggle竞赛之一“灾难推文预测”中微调预训练模型(BERT)。到本文结束时，您将能够在自己的数据集上使用BERT。</p><p id="c883" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以让我们开始吧！</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8d7d496c01780865ba5b91e950c21046.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*sAgyrydQOmBJFjY-CJZNYw.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Google-BERT</figcaption></figure><p id="619b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据理解:<br/> </strong>在这个数据集中我们有tweets和它们对应的标签比如0和1。如果推文属于灾难，那么它被标记为1，否则为0。因此，在模型训练之后，我们的模型应该能够预测推文是否属于灾难。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/b06b74dd029d14809d54e3bd0263c681.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*UV9x_bnEaPzjJLsWB8kjBw.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Data</figcaption></figure><p id="0f41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但在训练之前，让我们也对文本做一些常规的预处理，如删除停用词、标点符号等。</p><h2 id="d3af" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">文本预处理:</strong></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kl"><img src="../Images/8b690478741cf80ac549c3c633bcc3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCOYhHYu_Z4a7jBXYnkktw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">Text Processing</figcaption></figure><p id="1575" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我将两列分成X和y，然后执行预处理步骤，如删除停用词、标点符号和文本的词条化。预处理后，我做了训练和测试分裂。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kq"><img src="../Images/9ba089949886bde203c0b69b9266b271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lkx9EWqIxjNqQxg4JV0pEw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">train and test split</figcaption></figure><h2 id="277c" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">使用预先训练的模型标记器:</strong></h2><p id="03c6" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">这是最重要的一步，到目前为止，我们还没有将原始文本转换成模型可以理解的数值。为了将我们的原始文本转换成数值，我们需要使用一个<strong class="ih hj">预训练模型记号赋予器</strong>，记住记号赋予器对于不同的模型是不同的，这里我们使用“<strong class="ih hj">distilt Bert记号赋予器fast </strong>用于“<strong class="ih hj">distilt Bert-base-un cased</strong>”预训练模型。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kw"><img src="../Images/5da0d282c4a9858207f48678796e3cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dh_RiOjeXBmrXMrtuFi4zw.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">tokenizer</figcaption></figure><p id="64f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在创建了tokenizer对象之后，我们只需要将原始文本传递给tokenizer对象。</p><p id="8bec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意:</strong> tokenizer只接受列表格式的输入文本序列。</p><h2 id="8b61" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">导入预训练模型:</strong></h2><p id="c03b" class="pw-post-body-paragraph if ig hi ih b ii kr ik il im ks io ip iq kt is it iu ku iw ix iy kv ja jb jc hb bi translated">导入模型很简单，我们只需要从transformers库中导入' TFDistilBertForSequenceClassification '(因为我们的任务是序列分类)，并使用<strong class="ih hj"> from_pretrained加载预训练的模型。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kx"><img src="../Images/683fed82bf18b8ceedf1c9e51e1eafbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3wLJcGYkf5N9SyvhGmnTjA.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">model</figcaption></figure><h2 id="e4d8" class="jq jr hi bd js jt ju jv jw jx jy jz ka iq kb kc kd iu ke kf kg iy kh ki kj kk bi translated"><strong class="ak">模特培训:</strong></h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ky"><img src="../Images/727ba791963f0a24cf1ea4d590e65d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NMnF11m5hh-k7zDLA5b0g.jpeg"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">training</figcaption></figure><p id="54d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们正在编译我们的模型，使用损失函数来计算损失，使用优化器来更新权重。之后，我们将我们的火车数据和相应的标签传递给。通过指定时期和批量大小来拟合()。</p><p id="e290" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用这种方法，我在这次比赛中以0.82的分数获得了564/3000的排名。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kz"><img src="../Images/670246d76da91b2a7acd3728e7819991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37lLbFfSd7wRbi15Ph6CIg.jpeg"/></div></div></figure><p id="ad73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在BERT之前，我尝试了其他架构，如LSTM和GRU，但这些模型仅达到70%的验证准确性。</p></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="08af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客到此为止！谢谢你</p></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="199e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在这里找到我的Kaggle笔记本和数据集:</p><div class="lh li ez fb lj lk"><a href="https://www.kaggle.com/manojgadde/beginner-bert-fine-tuning-disaster-tweets" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hj fi z dy lp ea eb lq ed ef hh bi translated">初学者:伯特|微调|灾难推文🤗</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用自然语言处理中的数据应对灾难…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">www.kaggle.com</p></div></div><div class="lt l"><div class="lu l lv lw lx lt ly jj lk"/></div></div></a></div></div><div class="ab cl la lb gp lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="hb hc hd he hf"><p id="b928" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的另一篇博客是关于“我如何利用深度学习帮助我的乡村农民”</p><div class="lh li ez fb lj lk"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/how-i-helped-my-village-farmer-using-deep-learning-ecb1f8d5533c"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hj fi z dy lp ea eb lq ed ef hh bi translated">我如何使用深度学习帮助我的乡村农民！</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">1.项目创意，它是如何开始的？</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">medium.com</p></div></div><div class="lt l"><div class="lz l lv lw lx lt ly jj lk"/></div></div></a></div></div></div>    
</body>
</html>
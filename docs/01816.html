<html>
<head>
<title>Mock API Responses With a Chrome Extension Called OhMyMock</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用名为OhMyMock的Chrome扩展模拟API响应</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/mock-api-responses-with-a-chrome-extension-called-ohmymock-875ac5d85999?source=collection_archive---------2-----------------------#2021-04-25">https://medium.com/geekculture/mock-api-responses-with-a-chrome-extension-called-ohmymock-875ac5d85999?source=collection_archive---------2-----------------------#2021-04-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3fe1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天大多数网站通过调用(REST)API来检索数据。这也意味着当前端开发人员承担创建新特性的任务时，他们很可能在工作中依赖这些API。这很好，不一定是个问题，但是如果API很慢或不稳定，它肯定不会促进开发。</p><p id="3d11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将讨论如何通过嘲讽将API从等式中去掉。不仅仅是嘲讽，而是<em class="jd">用一个叫做<a class="ae je" href="https://chrome.google.com/webstore/detail/oh-my-mock/egadlcooejllkdejejkhibmaphidmock" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">OhMyMock</strong></a>的新Chrome扩展来嘲讽简单的方式</em>。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><h1 id="6f49" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">OhMyMock</h1><p id="b59e" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Chrome扩展很酷的一点是，它们可以在浏览器中做任何事情。OhMyMock利用了这一点，并使用存储和网络流量监控特性来模拟API调用。</p><p id="cc28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，<strong class="ih hj"> OhMyMock </strong>是如何模仿API的呢？这很简单，第一次进行API调用时<strong class="ih hj"> OhMyMock </strong>会让调用通过，API服务于请求。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es kp"><img src="../Images/86be9fc222ebeaa500568dfef9fe8c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*W6TFVUahTkg5v_bba3bWkg.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx">If no cache is available, the response is served by the API and cached by OhMyMock</figcaption></figure><p id="ff6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是<strong class="ih hj"> OhMyMock </strong>会缓存响应。下一次当同样的请求出现时<strong class="ih hj"> OhMyMock </strong>将介入并服务它。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lb"><img src="../Images/175682512fc143804023cb7f3bd23b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*Do3bQaB51qW3OfFEaX1Dvw.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx">Response served by OhMyMock</figcaption></figure><h1 id="bb32" class="jm jn hi bd jo jp lc jr js jt ld jv jw jx le jz ka kb lf kd ke kf lg kh ki kj bi translated">OhMyMock演练</h1><p id="5484" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">虽然OhMyMock的用户界面非常直观，但我还是会带你浏览一下。第一步当然是安装<a class="ae je" href="https://chrome.google.com/webstore/detail/oh-my-mock/egadlcooejllkdejejkhibmaphidmock" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">OhMyMock</strong></a>(<a class="ae je" href="https://github.com/scaljeri/oh-my-mock" rel="noopener ugc nofollow" target="_blank">source</a>)并点击浏览器中的新扩展图标</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es lh"><img src="../Images/c85f6f7a610256e8657a216ef0496c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*lJUTvOOogJ7Wva7VzePIDQ.png"/></div><figcaption class="kx ky et er es kz la bd b be z dx">OhMyMock icon</figcaption></figure><p id="74e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将触发<strong class="ih hj"> OhMyMock </strong>窗口</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es li"><img src="../Images/b86da41c018d81a930030887d78c42b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLqs7n5Rl2gcLU078gpadg.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Initial view of the OhMyMock popup</figcaption></figure><p id="1d2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初这个页面是空的，但是这里需要注意的是标题中的url。域名作为一个上下文，这里显示的所有模拟都属于它。因此，如果你切换到另一个领域，你将不会再看到<em class="jd">medium.com</em>模仿，但只有那些新的领域。让我们来看看它的运行情况，启用<strong class="ih hj"> OhMyMock </strong>并点击你可能会得到这样的结果</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es li"><img src="../Images/c25d6be2b1350fe7c5710008bec0cb08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlunbT2fo1EteiG5RzEpxA.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">A list of stored responses of API calls made by medium.com</figcaption></figure><p id="866c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，每个新存储的响应都被禁用，这意味着<strong class="ih hj"> OhMyMock </strong>不会使用它们，模仿也不会发生。但是如果你点击每一行末尾的play按钮，<strong class="ih hj"> OhMyMock </strong>就会开始模仿那个特定的请求<strong class="ih hj">。也可以从头开始创建模拟，如果API还不存在的话，这会很方便。这可以通过右下角的加号按钮来完成。</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es ln"><img src="../Images/d866f0fa931cbe82da195ecaceeffc40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5gRMyjoSpRcIgx09Lt6KVg.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Activated mock for <strong class="bd jo">/users</strong></figcaption></figure><p id="26ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">若要停止模仿，请点按“停止”或“删除”按钮。</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><p id="c6d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要查看响应详细信息，请单击行本身</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es li"><img src="../Images/0217657819c30198a4a78c9cbfe27717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpF8vvfjzPWYRV8EYYp04w.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Details of a cached request</figcaption></figure><p id="bf5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此视图的顶部，您可以看到哪些状态代码可用，以及哪一个处于活动状态。带有绿色边框的是活动的，该模拟的详细信息如下所示。因此，如果调用了<strong class="ih hj"> /users </strong> API，OhMyMock将用状态码200及其相应的响应和头进行响应。后面的加号按钮允许您创建新的状态代码。每个状态代码都有自己的响应和标题。如果你喜欢，它们也可以被修改！</p></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><p id="428a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">OhMyMock 提供的每个mock都是由一段javascript创建的，如果您单击“<em class="jd">mock with code</em>”按钮，也可以修改这段JavaScript</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lo"><img src="../Images/377614d850e76eaf2aa2da1bfcdce38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rm2wxzRNbXUFIcIojJf1uQ.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Dynamic/conditional mocking</figcaption></figure><p id="6f27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，你可以超越静态嘲笑，做任何你需要做的魔术。您将可以访问几个对象，其中一个包含所有的模拟细节</p><ul class=""><li id="ff9c" class="lp lq hi ih b ii ij im in iq lr iu ls iy lt jc lu lv lw lx bi translated"><strong class="ih hj">模拟响应</strong> —响应数据(<em class="jd">字符串</em>)</li><li id="75ff" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj"> mock.headers </strong> —响应头(<em class="jd">记录&lt;字符串，字符串&gt;T20】)</em></li><li id="3bc4" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj">模拟延迟</strong> —模拟响应的延迟，单位为毫秒(<em class="jd">数字</em>)</li><li id="d1a4" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj"> mock.statusCode </strong> —响应的状态码(<em class="jd">号</em>)</li></ul><p id="7ba3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，<strong class="ih hj"> mock.response </strong>保存缓存的响应，但如果将其更改为<strong class="ih hj"> mock.response = "yolo" </strong>，<strong class="ih hj"> </strong>模拟响应将为“yolo”。</p><p id="c73d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个是<strong class="ih hj">请求</strong>，它包含关于正在进行的请求的信息</p><ul class=""><li id="cace" class="lp lq hi ih b ii ij im in iq lr iu ls iy lt jc lu lv lw lx bi translated"><strong class="ih hj"> request.url </strong> —请求的URL(<em class="jd">字符串</em>)</li><li id="4947" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj">请求.方法</strong> —获取、发布、删除或更新(<em class="jd">字符串</em>)</li><li id="f0bd" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj">请求体</strong> —请求体(<em class="jd">未知</em>)</li><li id="49af" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj"> request.headers </strong> —请求头(<em class="jd">记录&lt;字符串，字符串&gt; </em>)</li></ul><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lo"><img src="../Images/377614d850e76eaf2aa2da1bfcdce38a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rm2wxzRNbXUFIcIojJf1uQ.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Dynamic/Condition mocking</figcaption></figure><p id="781b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果需要，您甚至可以在这里进行Fetch或XMLHttpRequest。但是如果您这样做了，请确保返回一个承诺(或使用await)来解析上面提到的模拟对象！！</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es lo"><img src="../Images/e7ac6d826acbf2e9c21bfa2c3d010a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Et6o1d7d2st0NcRzwR-Bsw.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">Dynamic mocking with asynchronous code</figcaption></figure></div><div class="ab cl jf jg gp jh" role="separator"><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk jl"/><span class="ji bw bk jj jk"/></div><div class="hb hc hd he hf"><p id="19d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是你还可以做更多的事情。你可能已经注意到左上角的菜单按钮。如果单击，您会看到以下菜单</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es md"><img src="../Images/222bee86c3f1b3b176ce78b13d211b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mr_mgBu3O1SxZGIONAGaWQ.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">OhMyMock menu</figcaption></figure><ul class=""><li id="a837" class="lp lq hi ih b ii ij im in iq lr iu ls iy lt jc lu lv lw lx bi translated"><strong class="ih hj">重置状态</strong> —移除当前域的所有模仿或清除所有内容(所有域)</li><li id="bb83" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj">探索状态</strong> —探索跨域的所有模仿。在这里，您可以将来自另一个域的响应克隆到当前域中。例如，如果您有一个只发生在产品中的bug，这可能很方便。只需缓存生产API调用，并将它们克隆回您的开发领域！</li><li id="f80b" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj"> JSON导出</strong> —将mocks导出为JSON文件。可以方便地备份您的模拟，或者如果您需要在工作中与同事分享一些东西。</li><li id="0821" class="lp lq hi ih b ii ly im lz iq ma iu mb iy mc jc lu lv lw lx bi translated"><strong class="ih hj"> JSON导入</strong> —导入JSON模拟文件</li></ul><h1 id="c836" class="jm jn hi bd jo jp lc jr js jt ld jv jw jx le jz ka kb lf kd ke kf lg kh ki kj bi translated">捐助</h1><p id="6672" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">如果您认为缺少了什么，请随意创建一个<a class="ae je" href="https://github.com/scaljeri/oh-my-mock/issues" rel="noopener ugc nofollow" target="_blank">特征请求</a>！！所有代码都可以在GitHub 上公开获得。如果您想了解更多，一个很好的起点是<a class="ae je" href="https://scaljeri.github.io/oh-my-mock/" rel="noopener ugc nofollow" target="_blank">演示测试页面</a>。该页面支持<strong class="ih hj"> OhMyMock </strong>支持的所有请求类型。注意GitHub上的页面没有后端，所以你需要在这里模仿！！</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es me"><img src="../Images/e126b83b00f1968cf43ea9b91d899684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p3fESz8DjBViaiY9yzPI5w.png"/></div></div><figcaption class="kx ky et er es kz la bd b be z dx">OhMyMock Test / demo page</figcaption></figure><p id="6b38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这大概是我现在能想到的。我很乐意听到你对这个工具的体验，所以不要犹豫，请在下面发表评论或给我发邮件。</p><p id="56c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干杯</p></div></div>    
</body>
</html>
<html>
<head>
<title>Practical implementation of Collaborative filtering — Recommender system</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">协同过滤推荐系统的实际实现</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/practical-implementation-of-collaborative-filtering-recommender-system-937e380a7d51?source=collection_archive---------20-----------------------#2021-06-27">https://medium.com/geekculture/practical-implementation-of-collaborative-filtering-recommender-system-937e380a7d51?source=collection_archive---------20-----------------------#2021-06-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="bd32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种类型的推荐系统正在许多地方使用，如网飞、Youtube、亚马逊、谷歌、Spotify、谷歌新闻、Twitter、脸书、Linked In等等。</p><p id="85e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">什么是随处可见的推荐系统？</p><p id="2b29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推荐系统有几种类型？</p><p id="3699" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它们之间有什么区别？</p><p id="46d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些答案可以在我之前关于推荐系统的<a class="ae jd" href="https://yamini-blog.medium.com/recommender-system-a83668653d95" rel="noopener">文章中找到(点击这里即可)。</a></p><p id="ee62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在协同过滤中有两种方法，并且可以使用基于记忆或基于模型的两种方法中的任何一种来实现。这两种方法是:</p><ol class=""><li id="4bf0" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">基于用户的协同过滤:在这种方法中，推荐是基于相似的用户兴趣和品味。</li><li id="e7c2" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">基于项目的协同过滤:在这种方法中，推荐是基于项目之间的相似性进行的。</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/e286fcbffd1d2d132c8a039029f7057f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emvVLvZYaWBzGRbIC_L0TA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">Representation of collaborative filtering</figcaption></figure><p id="14a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">协同过滤背后的要点是，它找到相似的用户，并向输入用户或主要用户或一个用户推荐相同类型的东西，以供查看或使用该项目或产品或服务。在上面的例子中，当一个婴儿喜欢三种产品气球、音乐(钢琴、鼓、任何其他乐器)、鸟(娱乐玩具或真实的)时，那么当其他婴儿喜欢其中两种产品时，第一个婴儿喜欢，显然第一个婴儿喜欢的第三种产品是值得推荐的。</p><blockquote class="ki"><p id="a0ad" class="kj kk hi bd kl km kn ko kp kq kr jc dx translated"><strong class="ak">“协同过滤基于相似的用户兴趣、偏好或选择来推荐产品，这些产品将根据用户的个人喜好和购物模式来定制。”</strong></p></blockquote><p id="76f6" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">这种类型的过滤有许多优点。许多行业和公司正在使用它来推荐他们的产品和服务，这将有助于提高业务的用户体验和安全性。</p><p id="c018" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例一。基于内存实现用户-用户协同过滤。</strong></p><p id="16b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我将使用相同的电影和评级数据集进行预测</p><ol class=""><li id="770a" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">在收集输入电影及其由输入用户给出的评级之后，将来自电影数据集中的正确电影id添加到输入电影中。</li><li id="3498" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">现在找出已经观看和评价了与输入电影中相同的电影的用户。</li><li id="a35d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">创建子组数据框，其中与输入用户相似的用户用用户id进行索引。</li><li id="9953" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">接下来，让我们找到这样的用户群，他们与输入用户有更多共同的电影，并且以向输入用户给出好的推荐的排序格式。</li><li id="4922" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">在这里，我使用皮尔逊相关来寻找用户的相似性矩阵</li><li id="0a20" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">找到不同用户相对于输入用户的皮尔逊相关系数。</li><li id="d607" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">不同用户与输入用户的所有关联都存储在与用户标识相关的数据帧中</li><li id="010d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">从所获得的与输入用户的最高相似性用户中获取所选或最高用户的所有电影的评级。</li><li id="e950" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">通过将相似性指数乘以所选用户或顶级用户对电影的评级，可以知道加权评级。</li><li id="5d5f" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">然后用所有用户I的索引电影id对两列相似性指数和加权评级特征求和，..e，两个特征的加权和。它们的电影id是从所选择的用户获得的。</li><li id="deb8" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">最后，通过将顶级用户评级(总和)除以顶级用户相似性指数(总和)来获得加权平均分数。对这些值进行排序，以找出向输入用户推荐的最佳电影。</li><li id="87f9" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">可以从所有电影数据集中提取所选电影的所有其他细节，以向输入用户提供丰富的体验，其中包含做出观看选择的良好细节。这个最后的数据帧可以在代码下面找到。</li></ol><pre class="jt ju jv jw fd kx ky kz la aw lb bi"><span id="e3cd" class="lc ld hi ky b fi le lf l lg lh">#2.Finding the users<br/>ratings_df[ratings_df[‘movieId’].isin(inputMovies[‘movieId’].tolist())]</span><span id="b616" class="lc ld hi ky b fi li lf l lg lh"># 3.Using gropuby for indexing the data with similar user id's<br/>userSubsetGroup = userSubset.groupby(['userId'])</span><span id="3881" class="lc ld hi ky b fi li lf l lg lh">#example to find one such user<br/>userSubsetGroup.get_group(37)</span><span id="a868" class="lc ld hi ky b fi li lf l lg lh">#4.Sorting it so users with movie more in common with the input user will have priority<br/>userSubsetGroup = sorted(userSubsetGroup,  key=lambda x: len(x[1]), reverse=True)</span><span id="51e3" class="lc ld hi ky b fi li lf l lg lh">#6.finding pearson correlation between users and input user<br/>#Store the Pearson Correlation in a dictionary, where the key is the user Id and the value is the coefficient<br/>pearsonCorrelationDict = {}<br/>#For every user group in our subset<br/>for name, group in userSubsetGroup:<br/>    #Let's start by sorting the input and current user group so the values aren't mixed up later on<br/>    group = group.sort_values(by='movieId')<br/>    inputMovies = inputMovies.sort_values(by='movieId')<br/>    #Get the N for the formula<br/>    nRatings = len(group)<br/>    #Get the review scores for the movies that they both have in common<br/>    temp_df = inputMovies[inputMovies['movieId'].isin(group['movieId'].tolist())]<br/>    #And then store them in a temporary buffer variable in a list format to facilitate future calculations<br/>    tempRatingList = temp_df['rating'].tolist()<br/>    #Let's also put the current user group reviews in a list format<br/>    tempGroupList = group['rating'].tolist()<br/>    #Now let's calculate the pearson correlation between two users, so called, x and y<br/>    Sxx = sum([i**2 for i in tempRatingList]) - pow(sum(tempRatingList),2)/float(nRatings)<br/>    Syy = sum([i**2 for i in tempGroupList]) - pow(sum(tempGroupList),2)/float(nRatings)<br/>    Sxy = sum( i*j for i, j in zip(tempRatingList, tempGroupList)) - sum(tempRatingList)*sum(tempGroupList)/float(nRatings)<br/>    <br/>    #If the denominator is different than zero, then divide, else, 0 correlation.<br/>    if Sxx != 0 and Syy != 0:<br/>        pearsonCorrelationDict[name] = Sxy/sqrt(Sxx*Syy)<br/>    else:<br/>        pearsonCorrelationDict[name] = 0</span><span id="6341" class="lc ld hi ky b fi li lf l lg lh"># To check the output of correlation<br/>pearsonCorrelationDict.items()</span><span id="96d9" class="lc ld hi ky b fi li lf l lg lh"># 8.selected users ratings of all movies<br/>topUsersRating=topUsers.merge(ratings_df, left_on='userId', right_on='userId', how='inner')<br/>topUsersRating.head()</span><span id="2ad7" class="lc ld hi ky b fi li lf l lg lh">#10.Applies a sum to the topUsers after grouping it up by userId<br/>tempTopUsersRating = topUsersRating.groupby('movieId').sum()[['similarityIndex','weightedRating']]<br/>tempTopUsersRating.columns = ['sum_similarityIndex','sum_weightedRating']<br/>tempTopUsersRating.head()</span><span id="fcbf" class="lc ld hi ky b fi li lf l lg lh">#11.Now we have the weighted average<br/>recommendation_df['weighted average recommendation score'] = tempTopUsersRating['sum_weightedRating']/tempTopUsersRating['sum_similarityIndex']<br/>recommendation_df['movieId'] = tempTopUsersRating.index<br/>recommendation_df.head()</span><span id="8ced" class="lc ld hi ky b fi li lf l lg lh">#12.Final dataframe with recommended movie deatils from the selected users <br/>movies_df.loc[movies_df['movieId'].isin(recommendation_df.head(10)['movieId'].tolist())]</span></pre><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lj"><img src="../Images/f5adb6fbdfa17584819a0910212fc824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*ctQF73cWTT1ixS51VQCevQ.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx">Final recommended movies from user-based filtering by memory-based approach</figcaption></figure><p id="e390" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例二。基于模型的实现基于项目的协同过滤。</strong></p><p id="b2a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种类型的过滤或方法使用项目和机器学习模型作为基础来获得并向用户提供推荐。</p><p id="7bf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我使用了KNN模型，当一个用户观看了某种类型的电影和某些流派时，我会给出推荐。</p><p id="416a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对上述内容的建议如下所示:</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lk"><img src="../Images/36c1c20dba695744e188bd9cc1e93b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9ZKoffcwBazthYubsyM7Q.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">The final recommendations made for users who watched movies with certain genres</figcaption></figure><p id="0f98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">欲了解更多基于电影的详细代码和预测，请访问Github repo中的Jupyter笔记本。<a class="ae jd" href="https://github.com/Yamini-DS/Data-science-projects-ally/tree/master/IMDB%20movie%20recommendation%20system" rel="noopener ugc nofollow" target="_blank">点击这里查看。</a></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ll"><img src="../Images/47d60a76de3fd10a482c015d207f373e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jyTDltNkAAl9lCQP"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx">Photo by <a class="ae jd" href="https://unsplash.com/@nick__?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">nicontents .</a> on <a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="lm ln lo"><p id="ba81" class="if ig lp ih b ii ij ik il im in io ip lq ir is it lr iv iw ix ls iz ja jb jc hb bi translated">你生命中的每一次奋斗都把你塑造成了今天的你。感谢今天，为明天做好准备。唯一不可能的旅程是你没有开始的旅程。所以只管去做，去创造。</p></blockquote><p id="b8da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你学到了一些东西，请给我一些支持，让我知道，并与有用的人分享。如果您有任何疑问或任何事情，请在评论框中告诉我。给世界带来一些光明。祝你有愉快的一天。🥰🕊🤍</p></div></div>    
</body>
</html>
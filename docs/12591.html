<html>
<head>
<title>Create a custom analytics server in 30 minutes with Python &amp; AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和AWS在30分钟内创建一个自定义分析服务器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-a-custom-analytics-server-in-30-minutes-with-python-aws-c126f5496b73?source=collection_archive---------11-----------------------#2022-05-20">https://medium.com/geekculture/create-a-custom-analytics-server-in-30-minutes-with-python-aws-c126f5496b73?source=collection_archive---------11-----------------------#2022-05-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/cc83e3f33fd5babc578e69fa69c49568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i98wPtPQaqiFNuzn"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Source: <a class="ae iu" href="https://unsplash.com/photos/zBLtU0zbJcU" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="239a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有时候，谷歌分析并不是最好的解决方案。</p><p id="95bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当我在创建<a class="ae iu" href="http://productsage.io" rel="noopener ugc nofollow" target="_blank"> ProductSage </a>的时候，我只想知道用户在我的网站上搜索了什么。使用谷歌分析的行话，我试图跟踪“自定义事件”。</p><p id="77e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是GA并不适合我的用例——我在另一个项目中使用了它的定制事件特性，这个过程变得不必要的困难。这一次，我想要一些快速简单的东西，没有处理GA的不直观的API，缓慢更新的服务器和混乱的web界面的包袱。平心而论，GA确实是免费的，但这是以我的时间(和心理健康，似乎)为代价的。</p><p id="dded" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我决定，对于ProductSage，我将使用AWS Lambda和DynamoDB来创建一个简单的分析服务器，成本几乎为0美元。以下是如何在30分钟或更短时间内完成设置的方法。</p><h1 id="1ae4" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">它是如何工作的</h1><p id="0936" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">DynamoDB是由AWS提供的非关系型(NoSQL)数据库服务。没有固定结构的项目存储在表中。</p><p id="16b8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">AWS Lambda让您可以在线运行代码，而无需关心任何与服务器相关的事情。你所需要做的就是把你的代码上传到Lambda函数中，它就会在云上运行！</p><p id="e948" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是两个部分的结合:</p><ul class=""><li id="def2" class="kw kx hi ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated"><strong class="ix hj">步骤1 </strong>:客户端应用程序通过一个API向你的Lambda函数发送数据。</li><li id="fa34" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><strong class="ix hj">第二步</strong> : Lambda函数访问你的DynamoDB表，并将数据存入其中。</li></ul><p id="860d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就是这样！解释完了，让我们一起创建服务器。</p><h1 id="0d9d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">辅导的</h1><h2 id="ae16" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated"><strong class="ak">创建DynamoDB表</strong></h2><p id="adaa" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">转到AWS控制台上的DynamoDB服务。点击侧边栏中的“表格”部分后，点击右侧橙色的“创建表格”按钮。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/f79be30680c32e5eadf2d5eb5212c6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vBMt96QX3uYeKxVp"/></div></div></figure><p id="3b23" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输入一个表名(由您决定)并输入“id”作为您的分区键。</p><p id="3bc2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让其余的选项保持原样，然后单击底部的“创建表格”按钮。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/e73f644d56f876976c13130ab11117f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JEwshT03jSvOSk_D"/></div></div></figure><p id="460d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">等待AWS完成创建您的表，它就准备好了！</p><h2 id="a905" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">创建Lambda函数</h2><p id="d9f1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">转到AWS控制台上的AWS Lambda服务，然后单击右侧橙色的“创建函数”按钮。</p><p id="bba5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输入函数名并选择Python 3.9作为运行时。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/1d3a32840a0a1958af32bf577f7c79dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pVLbNTUqgVVNvbJj"/></div></div></figure><p id="de6e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于这个Lambda函数将用于将数据插入到我们的DynamoDB表中，因此该函数需要访问DynamoDB服务。</p><p id="073f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要告诉AWS这一点，可以通过进入微小的“IAM控制台”链接来创建一个新的执行角色。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/d4a7dfd9705b637f00dcf86e6ff69a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RGz8mAka2zR-7s-I"/></div></div></figure><p id="8aa2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">选择“Lambda”并单击下一步。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/3fadf96e90fc1ec95605a89c77c0ad00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N01YqJOd2SoOA0d2"/></div></div></figure><p id="e042" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检查“AmazonDynamoDBFullAccess”策略。这将允许您的Lambda函数访问DynamoDB。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/1041c18dd53d1c2885aaea663400e157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zniW5GlQ9YegqYKS"/></div></div></figure><p id="b5a4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">写一个合适的名字，然后点击“创建角色”！请注意，执行角色是可重用的。所以如果你想在将来创建另一个类似的Lambda函数，你可以重用这个角色。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/0dfb835f0a1f47ea989d2ab6b0b65e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_s1V3VkhN_o3_fAK"/></div></div></figure><p id="2ead" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建后，使用AWS控制台上的代码编辑器将以下代码键入<em class="mi"> lambda_function.py </em>中。</p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="69d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">单击“部署”，您的功能就准备好了！除了一件事…</p><h2 id="5496" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated"><strong class="ak"> API端点</strong></h2><p id="c5a9" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我们需要通过创建一个链接到这个函数的API来使客户端应用程序可以访问它。别担心，这只需要一分钟。</p><p id="d2cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在同一个Lambda界面中，在“配置”下，转到“函数URL”，然后点击“创建函数URL”。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/b9c4cf32d1e3580e8c4afdce83237972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CkkLD7XAKb_0AbK1"/></div></div></figure><p id="872e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为“认证类型”选择“无”，然后选中“配置跨来源…”。我们将保持其他一切不变，然后单击“保存”按钮创建URL。</p><p id="2f42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，在生产中，您应该将“允许来源”字段更改为您的网站URL。这确保只有您的网站可以向分析服务器发送数据。</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/266ff11359a97019a83d7ea3c623e850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AyY3AfKZLCs19x4B"/></div></div></figure><p id="65f0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，为了确保一切正常，使用下面的cURL命令测试您的API。</p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="bf07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了使用Python提取您的分析数据，这里有一个示例代码:</p><figure class="lz ma mb mc fd ij"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="faba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">恭喜你。你的分析服务器是完整的🥳🥳🥳</p><h2 id="848c" class="lk ju hi bd jv ll lm ln jz lo lp lq kd jg lr ls kh jk lt lu kl jo lv lw kp lx bi translated">了解更多信息的资源</h2><ul class=""><li id="3d32" class="kw kx hi ix b iy kr jc ks jg ml jk mm jo mn js lb lc ld le bi translated"><a class="ae iu" href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-urls.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/lambda/latest/DG/lambda-URLs . html</a></li><li id="b19a" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><a class="ae iu" rel="noopener" href="/brainstation23/break-the-ice-with-dynamodb-5302e7456d2a">https://medium . com/brain station 23/破冰与动力db-5302e7456d2a </a></li><li id="3b89" class="kw kx hi ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><a class="ae iu" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb.html" rel="noopener ugc nofollow" target="_blank">https://boto 3 . Amazon AWS . com/v1/documentation/API/latest/reference/services/dynamo db . html</a></li></ul></div></div>    
</body>
</html>
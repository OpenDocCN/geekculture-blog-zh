<html>
<head>
<title>CodeIgniter 4 Tutorial part 1 ~ RESTful API JWT Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CodeIgniter 4教程第1部分~ RESTful API JWT认证</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/codeigniter-4-tutorial-restful-api-jwt-authentication-d5963d797ec4?source=collection_archive---------0-----------------------#2022-05-18">https://medium.com/geekculture/codeigniter-4-tutorial-restful-api-jwt-authentication-d5963d797ec4?source=collection_archive---------0-----------------------#2022-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/875e92a4132848f8d5386591e5ed598f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iQ_EjHJd9yWZ6o3n.png"/></div></div></figure><p id="b1c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">朋友们，你们好，这次我们将讨论带JWT认证的Restful API。在之前的Codeigniter 4教程中，我们讨论了使用Codeigniter 4 登录和注册<a class="ae jo" href="https://temanngoding.com/tutorial-codeigniter-4-login-dan-register/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c1cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们继续之前，我们将讨论什么是API和JWT。</p><h1 id="ffd2" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">喜欢看视频的可以访问我的视频here Rest Api登录并注册Codeigniter 4:</h1><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="af61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">API代表应用程序接口，API是允许应用程序交换数据的接口。更清楚地说，API是程序员可以用来构建软件和应用程序的函数集合。</p><p id="161f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">JWT代表JSON Web Token，它是一个开放标准(RFC 7519 ),定义了一种紧凑的自包含方式，以JSON对象的形式在各方之间安全地传输信息。JWT通常用于授权、信息交换等。</p><p id="4d19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们将创建应用程序。</p><h1 id="6fe6" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤1:安装CodeIgniter 4</h1><p id="bf8b" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">通过编写器安装:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="28bd" class="ld jq hi kz b fi le lf l lg lh">composer create-project codeigniter4/appstarter ci-4-jwt</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/33cece78926a5b89c6a4e45b020d740e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*L0nElP9ubpXASq39.png"/></div></div></figure><h1 id="1e41" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤2:更改CodeIgniter环境</h1><p id="96b6" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">环境。CodeIgniter默认为production，这是一个为应用程序增加安全性的安全特性。接下来，我们将env文件的名称改为。给你的环境添加一个句号。重命名后，打开。env文件，我们将更改一些命令。</p><p id="09a6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">。包封/包围（动词envelop的简写）</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="f017" class="ld jq hi kz b fi le lf l lg lh">CI_ENVIRONMENT = development</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/4df6f3a4e9054a9d52ac6cf074db7c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nfMHV7gCy85OB6hj.png"/></div></div></figure><h1 id="dcf9" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤3:配置数据库</h1><p id="ac74" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">设置完env之后，它将配置数据库。您可以在中配置它。在本教程中，我们将在app/Config/Database.php中配置它。</p><p id="ef0f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Config/database . PHP</em></strong>。</p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><h1 id="a0ee" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤4:建模和迁移</h1><p id="cb0a" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">模型-表示数据库表的类。</p><p id="bdb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">迁移——类似于数据库的版本控制，允许我们更改数据库模式并与您的团队共享。</p><p id="ac37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在终端或CMD中运行以下命令来创建模型:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="65b0" class="ld jq hi kz b fi le lf l lg lh">php spark make:model UserModel</span></pre><p id="8152" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在app/Models/UserModel.php中打开创建的模型，在文件中可以看到配置选项，可以阅读文档了解更多关于配置选项的信息。现在我们将更新配置:</p><p id="9284" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Models/user model . PHP</em></strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><p id="e5d1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建模型后，我们将创建迁移文件。</p><p id="a8d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在终端或CMD中运行以下命令来创建迁移:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="c6ed" class="ld jq hi kz b fi le lf l lg lh">php spark make:migration AddUser</span></pre><p id="9148" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">打开在app/Database/Migrations/中创建的迁移文件，并粘贴以下代码:</p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/3c6cc604503fa0758931118f9b24ca32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f9skP3H6vf5qzofZ.png"/></div></div></figure><p id="f244" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过执行<code class="du ln lo lp kz b">migrate</code>命令运行迁移:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="8f18" class="ld jq hi kz b fi le lf l lg lh">php spark migrate</span></pre><h1 id="dbcb" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤5:安装JWT软件包</h1><p id="0458" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">然后我们将使用composer安装jwt包:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="d975" class="ld jq hi kz b fi le lf l lg lh">composer require firebase/php-jwt</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/9af04689dcb70c9d4a6a793d280e7d2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/0*Cy-m7GKU1tc-Cn-W.png"/></div></figure><p id="319e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装jwt包后，将JWT_SECRET添加到。环境。文件</p><p id="20b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lk">。env </em> </strong></p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="8f46" class="ld jq hi kz b fi le lf l lg lh">#--------------------------------------------------------------------<br/># JWT<br/>#--------------------------------------------------------------------<br/>JWT_SECRET = 'JWT SECRET KEY SAMPLE HERE'</span></pre><h1 id="f9e2" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤6:创建控制器</h1><p id="3d73" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">控制器是负责接收请求和返回响应的人。</p><p id="ed99" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在终端或CMD中运行该命令创建一个控制器:<br/> <br/>运行该命令后，会在app/Controllers中创建一个文件。打开文件并输入以下代码:</p><p id="f8f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Controllers/log in . PHP</em></strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><p id="77e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Controllers/register . PHP</em></strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><p id="f09b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Controllers/user . PHP</em></strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><h1 id="ea3c" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤7:创建控制器过滤器</h1><p id="f91a" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">过滤器控制器是一个类，它允许我们在一个动作执行之前或之后执行它。</p><p id="b8b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们现在将创建一个过滤器，用于检查请求是否被允许以及是否有授权。在终端或CMD中运行以下命令:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="e84e" class="ld jq hi kz b fi le lf l lg lh">php spark make:filter AuthFilter</span></pre><p id="a593" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">运行该命令后，它将在app/Filters中创建一个文件。打开该文件并输入以下代码:</p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><p id="5c25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建过滤器后，我们必须将其添加到app/Config/Filters.php中的过滤器配置中。</p><p id="6a6c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">app/Config/filters . PHP</em></strong></p><figure class="kn ko kp kq fd ij"><div class="bz dy l di"><div class="ll ks l"/></div></figure><h1 id="9a81" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤8:注册路由</h1><p id="0a36" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">打开app/Config/Routes.php中的配置文件并注册该路由:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="c5b5" class="ld jq hi kz b fi le lf l lg lh">$routes-&gt;group("api", function ($routes) {<br/>    $routes-&gt;post("register", "Register::index");<br/>    $routes-&gt;post("login", "Login::index");<br/>    $routes-&gt;get("users", "User::index", ['filter' =&gt; 'authFilter']);<br/>});</span></pre><h1 id="a9ee" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">步骤9:运行应用程序</h1><p id="43ff" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated">既然我们已经完成了上述步骤，现在我们将运行应用程序。要运行该应用程序，请运行以下命令:</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="d360" class="ld jq hi kz b fi le lf l lg lh">php spark serve</span></pre><h1 id="2de7" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">截图:</h1><p id="527b" class="pw-post-body-paragraph iq ir hi is b it kt iv iw ix ku iz ja jb kv jd je jf kw jh ji jj kx jl jm jn hb bi translated"><strong class="is hj"><em class="lk">/API/寄存器</em> </strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/ec63ee0a3be0612dace9583979e51898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4CqflxLeae2bhoobxnEJQ.jpeg"/></div></div></figure><p id="0144" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">/API/登录</em> </strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/f2574a6a268f74b13b98dfc42aec0d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mSYZxz7PSLMWmsMiT_T1nw.jpeg"/></div></div></figure><p id="3f17" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lk">/API/用户</em> </strong></p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/a0e0c2dd1235189e14f1322e7b91e1d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Leru42BQUJ_dJ1z0oD55yw.jpeg"/></div></div></figure><p id="837c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我可以传达的指南，希望它对我所有的朋友都有用。谢谢你访问我的博客。</p><p id="63c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不要忘记访问其他教程:</p><p id="99ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://temanngoding.com/menghilangkan-public-dan-index-php-dari-url-codeigniter-4/" rel="noopener ugc nofollow" target="_blank">从Codeigniter URL 4中删除公共和Index.php</a></p><p id="dfab" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://temanngoding.com/tutorial-codeigniter-4-login-dan-register/" rel="noopener ugc nofollow" target="_blank"> Codeigniter 4教程~登录注册</a></p><h1 id="4d86" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">谢谢你。</h1></div></div>    
</body>
</html>
<html>
<head>
<title>JavaScript Reducing Arrays. Reduce() Method.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript简化数组。Reduce()方法。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/javascript-reducing-arrays-reduce-method-a211e9b82804?source=collection_archive---------22-----------------------#2021-07-07">https://medium.com/geekculture/javascript-reducing-arrays-reduce-method-a211e9b82804?source=collection_archive---------22-----------------------#2021-07-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a93f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在日常的编程工作中，我们经常使用列表(数组)。有时，我们希望找到满足特定条件的元素，一个<a class="ae jd" href="https://roxvemm2014.medium.com/javascript-filtering-arrays-filter-method-ac582e4594e2" rel="noopener"><strong class="ih hj"/></a>方法是一个很好的选择，其他时候我们可能希望根据一些逻辑来转换给定数组的元素，然后我们可以应用<a class="ae jd" href="https://roxvemm2014.medium.com/javascript-mapping-arrays-map-method-a650c014fe7" rel="noopener"> <strong class="ih hj"> Map() </strong> </a>方法。当我们想要创建一个单独的汇总值或者将一个元素列表(数组)简化为一个单独的值时，该怎么办呢？</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c602afc31795e8293a234f4b9c45e6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RwL07Fj07Jw7NXyu"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Photo by <a class="ae jd" href="https://unsplash.com/@romankraft?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roman Kraft</a> on <a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3033" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本教程中，我们将学习如何使用一个<strong class="ih hj"> Reduce() </strong>内置的本地JavaScript方法来聚合一个结果或得出一个奇异值。该值可以是字符串、数字、布尔值甚至是对象等。</p><p id="a6c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，让我们尝试通过应用基本的普通JavaScript /a <em class="ju"> for循环</em>方法来解决以下问题。</p><p id="ca15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你会得到一组数字:</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="ea48" class="ka kb hi jw b fi kc kd l ke kf">let arrayOfNumbers = [1, 2, 3, 4, 5, 6, 7];</span></pre><p id="a725" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要将该数组的所有元素相加，以获得单个汇总值。预期结果是<code class="du kg kh ki jw b">1 + 2 + 3 + 4 + 5 + 6 + 7 = 28.</code></p><p id="fda8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解决这类问题的一个常见方法是，我们首先声明一个新变量，在我们的例子中，它将是一个累加器，并将其值设置为0。然后，我们遍历给定的数组，并将当前元素添加到累加器变量中，每下一次迭代，我们存储在累加器变量中的值都会增加当前元素的值。最后，当循环结束时，我们返回一个累加值。</p><p id="8bf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是这个问题的伪代码和代码本身。试试吧！复制并粘贴到您的控制台。</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="d715" class="ka kb hi jw b fi kc kd l ke kf">function sum (numbers) {<br/>// declare a new var and set it to 0<br/>let accumulator = 0;</span><span id="181c" class="ka kb hi jw b fi kj kd l ke kf">// iterate over an array<br/>for (var i = 0; i &lt; numbers.length; i++) {</span><span id="2783" class="ka kb hi jw b fi kj kd l ke kf">// add the current element of the array to that new var till the end // of loop </span><span id="e669" class="ka kb hi jw b fi kj kd l ke kf">accumulator = accumulator + numbers[i];<br/>    }</span><span id="fddb" class="ka kb hi jw b fi kj kd l ke kf">// return this accumulated value<br/>return accumulator;<br/>}</span><span id="8ad6" class="ka kb hi jw b fi kj kd l ke kf">let arrayOfNumbers = [1, 2, 3, 4, 5, 6, 7];<br/>let result = sum (arrayOfNumbers);<br/>console.log(result);// output -&gt; 28 </span></pre><p id="9761" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">控制台中的输出如下:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kk"><img src="../Images/27dc8cef21a9b4b9f6d44d8deb7aeaeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*YBpBAy58wFvU-0wWso37xA.png"/></div></figure><p id="71ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是手动添加数组所有元素的一个非常基本的方法，但是正如你可能看到的，它只适用于这种非常特殊的情况！例如，如果我只想添加前N个元素，或者数组的长度会改变，我就必须重写代码。这正是<strong class="ih hj"> Reduce() </strong>方法派上用场的时候！</p><p id="6c35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">和往常一样，让我们在<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> MDN Web Docs </strong> </a>看看这个方法和语法的官方定义:</p><blockquote class="kl km kn"><p id="31e3" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj"> Reduce() </strong>方法对数组的每个元素执行一个reducer函数(您提供的),产生一个输出值。</p><p id="6cc4" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">reducer函数有四个参数:</p><p id="c6ca" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">1.蓄电池</p><p id="2544" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">2.现值</p><p id="3d3e" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">3.当前索引</p><p id="daa2" class="if ig ju ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated">4.源阵列</p></blockquote><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="5999" class="ka kb hi jw b fi kc kd l ke kf">// Arrow function<br/>reduce((accumulator, currentValue) =&gt; { ... } )<br/>reduce((accumulator, currentValue, index) =&gt; { ... } )<br/>reduce((accumulator, currentValue, index, array) =&gt; { ... } )<br/>reduce((accumulator, currentValue, index, array) =&gt; { ... }, initialValue)</span><span id="560b" class="ka kb hi jw b fi kj kd l ke kf">// Callback function<br/>reduce(callbackFn)<br/>reduce(callbackFn, initialValue)</span><span id="0660" class="ka kb hi jw b fi kj kd l ke kf">// Inline callback function<br/>reduce(function callbackFn(accumulator, currentValue) { ... })<br/>reduce(function callbackFn(accumulator, currentValue, index) { ... })<br/>reduce(function callbackFn(accumulator, currentValue, index, array){ ... })<br/>reduce(function callbackFn(accumulator, currentValue, index, array) { ... }, initialValue)</span></pre><p id="5b71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，有了这个关于<strong class="ih hj"> Reduce() </strong>方法的理论知识，让我们用这个方法来解决上面的问题。</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="c499" class="ka kb hi jw b fi kc kd l ke kf">let arrayOfNumbers = [1, 2, 3, 4, 5, 6, 7];</span><span id="8957" class="ka kb hi jw b fi kj kd l ke kf">let reducerFunction = (accumulator, currentValue) =&gt; accumulator + currentValue;</span><span id="be2f" class="ka kb hi jw b fi kj kd l ke kf">let result = arrayOfNumbers.reduce(reducerFunction)<br/>console.log(result); // output -&gt; 28; </span></pre><p id="732b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的代码可能看起来有点笨拙，所以让我们缩短它，并按照官方文档的建议使用箭头函数表达式:</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="7296" class="ka kb hi jw b fi kc kd l ke kf">let arrayOfNumbers = [1, 2, 3, 4, 5, 6, 7];</span><span id="453e" class="ka kb hi jw b fi kj kd l ke kf">let sum = arrayOfNumbers.reduce ((accumulator, currentValue) =&gt; accumulator + currentValue, 0);</span><span id="a10c" class="ka kb hi jw b fi kj kd l ke kf">console.log(sum); // output -&gt; 28;</span></pre><p id="2401" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">或者使用内联回调函数:</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="92e1" class="ka kb hi jw b fi kc kd l ke kf">let arrayOfNumbers = [1, 2, 3, 4, 5, 6, 7];</span><span id="6010" class="ka kb hi jw b fi kj kd l ke kf">let sum = arrayOfNumbers.reduce (function (accumulator, currentValue) {return accumulator + currentValue}, 0);</span><span id="928f" class="ka kb hi jw b fi kj kd l ke kf">console.log(sum);// output -&gt; 28;</span></pre><p id="56d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">无论您选择什么语法，上面提到的所有样式的输出都是一样的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kr"><img src="../Images/6ca0622421a0639421dba9b0d17f27e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*iG4xzEAZ_m9Y8136hpdkBw.png"/></div></figure><p id="72ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里发生了什么事？我们在源或输入数组<code class="du kg kh ki jw b">arrayOfNumbers</code>上调用<strong class="ih hj"> Reduce() </strong>方法，并向其传递两个参数:在本例中定义为箭头函数表达式的回调函数<code class="du kg kh ki jw b">(accumulator, currentValue) =&gt; accumulator + currentValue </code>和一个可选的初始值或设置为<code class="du kg kh ki jw b">0</code>的累加器。然后，方法依次对源数组的每个元素执行回调函数(1，2，3，4 … 7)，每次传入累加器的当前值和当前元素。在每次迭代之后，回调函数都会更新累加器的值，就像我们之前在这行代码<code class="du kg kh ki jw b">accumulator = accumulator + numbers[i]</code>中看到的那样，然后累加器的这个更新值作为第一个参数传递给回调函数，以此类推，直到源数组结束。当输入数组中没有剩余的内容时，累加器的最终值被返回，与我在开始时发布的例子中的<code class="du kg kh ki jw b">return accumulator </code>相同。</p><p id="b63d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">初始化开始值是可选的，正如在<a class="ae jd" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce" rel="noopener ugc nofollow" target="_blank">文档</a>中所述，但是省略它可能会导致一些你并不真正期望的事情！如果没有初始起始值，那么数组中的第一个元素被用作起始值/初始累加器值。看看下面两个例子:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/4030227ddca3717ad8b3e49b62843e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Ea490NtkGBPh32hEizwGw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/2e23e8f42c423e327f9bfdbc986af8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SVpMAsX8T7EdPwfbMd9Mw.png"/></div></div></figure></div><div class="ab cl ku kv gp kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="hb hc hd he hf"><p id="6ea4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经学习了如何在基本类型上应用和使用<strong class="ih hj"> Reduce() </strong>方法，现在让我们深入并演示如何在对象上使用这个方法。</p><p id="d77e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有一队超级英雄(用一个对象数组表示)，我们需要确定哪个英雄是最快的。对于所有超级英雄的粉丝，我向你们保证以下数据是有效的，并且来自这个<a class="ae jd" href="https://marvel.fandom.com/wiki/Natalia_Romanova_(Earth-616)" rel="noopener ugc nofollow" target="_blank">网站</a>！让我们来看看谁是最快的——“钢铁侠”、“黑寡妇”或“绿巨人”🍾 🙌 🎉！！！</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="c2ed" class="ka kb hi jw b fi kc kd l ke kf">let listOfHeroes = [<br/>{<br/>"Name":"Anthony Edward 'Tony' Stark",<br/>"CurrentAlias":"Iron Man",<br/>"Intelligence":6,<br/>"Strength":6,<br/>"Speed":5,<br/>"Durability":6,<br/>"EnergyProjection":6,<br/>"FightSkills":4<br/>},</span><span id="b870" class="ka kb hi jw b fi kj kd l ke kf">{<br/>"Name":"Natalia Alianovna 'Natasha' Romanova",<br/>"CurrentAlias":"Black Widow",<br/>"Intelligence":3,<br/>"Strength":3,<br/>"Speed":2,<br/>"Durability":3,<br/>"EnergyProjection":3,<br/>"FightSkills":6<br/>},</span><span id="fbdf" class="ka kb hi jw b fi kj kd l ke kf">{<br/>"Name":"Dr. Robert Bruce Banner",<br/>"CurrentAlias":"Hulk",<br/>"Intelligence":6,<br/>"Strength":7,<br/>"Speed":3,<br/>"Durability":7,<br/>"EnergyProjection":5,<br/>"FightSkills":4<br/>}]</span></pre><p id="da7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">确定任何数组中最大值的常用方法是假设一个值(例如，给定数组中的第一个值)是最大值，然后从第二个元素开始迭代数组，并将每个元素与默认的最大值进行比较。如果当前值大于默认的最大值，则重新分配。一旦我们知道了最大值是多少，我们就可以在初始数组上运行第二个<em class="ju"> for循环</em>来确定哪个索引(或者我们的英雄对象)匹配这个最大值，然后返回英雄对象。让我们通过使用普通的JavaScript和循环的<em class="ju">来解决这个问题。下面是代码和输出:</em></p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="24b3" class="ka kb hi jw b fi kc kd l ke kf">function fastestHeroe(array) {<br/>// assume the first element in this array is the largest one<br/>let speedFast = array[0].Speed;</span><span id="a8b3" class="ka kb hi jw b fi kj kd l ke kf">// iterate over the array starting from the second element and till the end of this array<br/>for (var i = 1; i &lt; array.length; i++) {</span><span id="da50" class="ka kb hi jw b fi kj kd l ke kf">// if the current element is more than the assumed largest/first then assign this current element to speedFast var<br/>if (array[i].Speed &gt; speedFast) {<br/>speedFast = array[i].Speed;<br/>}}</span><span id="c44f" class="ka kb hi jw b fi kj kd l ke kf">// iterate over the array<br/>for (var j = 0; j &lt; array.length; j++) {</span><span id="8446" class="ka kb hi jw b fi kj kd l ke kf">// if a value of “Speed” key is equal to the found largest one then return the current obj</span><span id="78ec" class="ka kb hi jw b fi kj kd l ke kf">if (array[j].Speed === speedFast) {<br/>return array[j];</span><span id="26d1" class="ka kb hi jw b fi kj kd l ke kf">}}}</span></pre><p id="d0bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你运行这个代码，它应该返回“托尼”斯塔克，因为他的“速度”值是5，这比“黑寡妇”和“绿巨人”都多。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lb"><img src="../Images/1db7d27c6311f0a28a013ea151eeeea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUKPh3oDtqRmnU24IH-vWQ.png"/></div></div></figure><p id="2211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们演示如何用<strong class="ih hj"> Reduce() </strong>方法解决同样的问题:</p><pre class="jf jg jh ji fd jv jw jx jy aw jz bi"><span id="d906" class="ka kb hi jw b fi kc kd l ke kf">var fastest = listOfHeroes.reduce(function (accumulator, hero) {return (accumulator.Speed || 0) &gt; hero.Speed ? accumulator : hero;}, {});</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lc"><img src="../Images/c19a7fe0c7c61155291b2c9dadcf4404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrwEoaj_rK33RcaKHbOYAQ.png"/></div></div></figure><p id="bcf5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Reduce() </strong>方法的输出与我们在实现<em class="ju"> for循环</em>方法后得到的输出相同。</p><p id="6e74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了！我们只花了几行代码来减少对象的初始数组，以确定哪个hero是最快的，而不是普通JavaScript/for loop方法中的多行代码和两个循环。</p><p id="cd85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至于这场<strong class="ih hj"> Reduce() </strong>方法vs<em class="ju">for loop</em>比赛的获胜者，“托尼”斯塔克是最快的超级英雄，因为他的速度是5，比这个超能力网格中的任何人都快。恭喜“托尼”！💯</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ld"><img src="../Images/0e1766c049015ffe40a4732596594f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nV8hI7FoXnstxSSP"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Photo by <a class="ae jd" href="https://unsplash.com/@marjan_blan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marjan Blan | @marjanblan</a> on <a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b7ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总的来说，当我们想从输入数组中的每个元素获取一些信息并将这些信息收集到最终的信号汇总值(累加器)中时，可以使用<strong class="ih hj"> Reduce() </strong>方法。这里我们需要考虑三个主要方面:源数组或者我们要缩减的数组；回调函数或缩减器，它定义了需要完成什么样的操作；累加器变量的初始初始值。<strong class="ih hj"> Reduce() </strong>函数遍历源数组，每次都调用reducer回调函数，后者返回累加器的更新值。</p><p id="2b0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，我们仍然可以像上面演示的那样使用<em class="ju"> for循环</em>来完成同样的工作，但是使用本机内置的<strong class="ih hj"> Reduce() </strong>函数使我们不必编写循环机制、编写多行重复代码、在变量的累加器类型中声明和累加变量，然后在最后返回这个累加器。</p><p id="f4a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你觉得这些信息有用，请随时关注我。希望您喜欢这篇关于JavaScript中Reduce()方法的简短指导，请保持关注！</p></div></div>    
</body>
</html>
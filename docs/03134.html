<html>
<head>
<title>Accessibility in iOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">iOS中的可访问性</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/accessibility-in-ios-ce09f6df992b?source=collection_archive---------6-----------------------#2021-06-01">https://medium.com/geekculture/accessibility-in-ios-ce09f6df992b?source=collection_archive---------6-----------------------#2021-06-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ee5c" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">带画外音</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/a39733a734dfb622b9725824903f0efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-n5Aj8YTJASngvK6Cvr6NA.png"/></div></div></figure><h2 id="175c" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">介绍</h2><blockquote class="kh ki kj"><p id="9dc1" class="kk kl km kn b ko kp ij kq kr ks im kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">VoiceOver是一个屏幕阅读器，可以与应用程序中的对象进行交互，因此用户即使看不到它，也可以驱动界面。确保应用程序中的用户界面元素是可访问的和有用的。<br/>——<a class="ae lh" href="https://developer.apple.com/accessibility/ios/" rel="noopener ugc nofollow" target="_blank">苹果</a></p></blockquote><p id="94ec" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">尽管Apple在您的应用程序中提供了许多默认的辅助功能元素，如标准UIKit控制和视图，但更复杂的视图可能会导致VoiceOver与您的视图组件不兼容。因此，在构建VO时，确保牢记用户体验是很重要的；不管是通过接口生成器还是协议实现。</p><p id="5540" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">VoiceOver的目的是将来自应用程序界面的信息传达给残疾用户，以便帮助他们有效地使用应用程序。</p><h2 id="caeb" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">提示和技巧</h2><p id="3e9e" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated">在进入UIAccessibility的各种组件之前，让我们先来看一些初步的提示和技巧，它们将帮助您在设备上方便地使用和测试VoiceOver功能:</p><ul class=""><li id="d73f" class="ln lo hi kn b ko kp kr ks ju lp jy lq kc lr lg ls lt lu lv bi translated"><strong class="kn hj">辅助功能快捷方式</strong> : <em class="km">设置&gt;辅助功能&gt;一般:辅助功能快捷方式</em> <br/>选择VoiceOver可以三次点击侧面按钮来切换功能的开/关。</li><li id="cc9d" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><strong class="kn hj">画外音速度</strong> : <em class="km">设置&gt;无障碍&gt;画外音&gt;语速:并调整。<br/>或<br/>切换辅助功能转盘(双指扭转运动)&gt;导航至语速&gt;用一个手指上下滑动以调整语速</em></li><li id="42c4" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><strong class="kn hj">原生应用参考</strong>:我个人喜欢参考某些iOS应用，以确保我实现的VO行为与苹果的设计模式相似。我参考的一些应用有:<br/> -设置<br/> -应用商店<br/> -消息<br/> -地图<br/> -音乐</li><li id="1254" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><strong class="kn hj">A11y</strong>:“accessibility”的缩写，来源于通过用中间字母的数量代替中间字母来缩短长单词。在“a”和“y”之间有11个字母，所以“accessibility”变成了a11y—<a class="ae lh" href="https://www.boia.org/blog/what-is-a11y" rel="noopener ugc nofollow" target="_blank">https://www.boia.org/blog/what-is-a11y</a></li></ul><h1 id="d110" class="mb jk hi bd jl mc md me jp mf mg mh jt io mi ip jx ir mj is kb iu mk iv kf ml bi translated">目录</h1><p id="ed9d" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated"><strong class="kn hj">ui Accessibility<br/></strong><em class="km">—is Accessibility element<br/></em><em class="km">—Accessibility label</em><br/><em class="km">—Accessibility value<br/>—Accessibility hint<br/>—Accessibility trait<br/>—UIAccessibility element<br/></em>—<em class="km">UIAccessibilityCustomAction<br/>—uiaccessibilitypostonification<br/></em><strong class="kn hj"/></p><h1 id="2ac2" class="mb jk hi bd jl mc md me jp mf mg mh jt io mi ip jx ir mj is kb iu mk iv kf ml bi translated">ui可访问性</h1><blockquote class="kh ki kj"><p id="6ef1" class="kk kl km kn b ko kp ij kq kr ks im kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated">一组方法，提供有关应用程序用户界面中视图和控件的可访问性信息。<br/>——<a class="ae lh" href="https://developer.apple.com/documentation/objectivec/nsobject/uiaccessibility" rel="noopener ugc nofollow" target="_blank">苹果</a></p></blockquote><p id="6a3f" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">标准UIKit控件和视图实现了<code class="du mm mn mo mp b">UIAccessibility</code>方法，默认情况下辅助应用程序可以访问它们。然而，当创建定制视图和控制器时，您可能需要创建一个<code class="du mm mn mo mp b">UIAccessibilityElement</code>实例来与辅助功能接口。</p><h2 id="ab9d" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated"><em class="mq"> UIAccessibilityElement </em></h2><p id="16b3" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated">一个实现<code class="du mm mn mo mp b">UIAccessibility</code>非正式协议的类。这允许您将属性和方法设置为可由辅助应用程序访问。</p><p id="4a02" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">以下是UIAccessibilityElement实例的示例。确保父视图可以通过父视图的<code class="du mm mn mo mp b">accessibilityElements</code>属性访问accessibility元素。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="b6b1" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">第3行将突出显示的框架设置为标题和副标题框架的并集。</p><p id="030f" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">现在让我们更深入地了解一些常见的可访问性属性</p><ul class=""><li id="9183" class="ln lo hi kn b ko kp kr ks ju lp jy lq kc lr lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">isAccessibilityElement</code> <em class="km">:布尔值，表示该元素是否为辅助应用程序可以访问的辅助功能元素。</em> <br/>当不希望辅助应用程序访问视图中的子元素时，可以将子元素<code class="du mm mn mo mp b"><em class="km">isAccessibilityElement</em></code> <em class="km"> </em>设置为false，或将视图<code class="du mm mn mo mp b"><em class="km">isAccessibilityElement</em></code> <em class="km"> </em>设置为true。<br/>如果视图<code class="du mm mn mo mp b"><em class="km">isAccessibilityElement</em></code> <em class="km"> </em>为真，辅助应用将无法访问子视图。</li><li id="8788" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityLabel</code> <em class="km">:本地化字符串中标识可访问性元素的简洁标签。<br/> </em>该属性的默认值是<code class="du mm mn mo mp b">nil</code>，除非该元素是一个UIKit控件，在这种情况下，该值是一个从控件标题派生的标签。如果控件是图像，即UIButton中的图像，则该标签应设置为图像描述的内容，如果图像是播放/暂停图标，则该标签应设置为“播放”或“暂停”。标签也不应该包含控件的类型，例如一个按钮——“播放按钮”。这是因为accessibilityTrait应该包含该信息和/或accessibilityHint。</li><li id="aad0" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityValue</code> <em class="km">:包含accessibility元素值的本地化字符串。当辅助功能元素具有静态标签和动态值时，设置此属性以返回值。<br/> </em>即具有标签“Email”的UITextField，但是用户在文本字段内的文本作为可访问性值。</li><li id="7964" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityHint</code> <em class="km">:本地化字符串，包含对accessibility元素执行操作的结果的简要描述。<br/> </em>该属性的默认值为<code class="du mm mn mo mp b">nil</code>，除非该元素是UIKit控件，在这种情况下，该值是系统提供的从控件类型派生的提示。<br/>设置这个属性可以让用户更清楚他们的行为会导致什么结果。<br/>遵循苹果公司提供的<a class="ae lh" href="https://developer.apple.com/documentation/objectivec/nsobject/1615093-accessibilityhint" rel="noopener ugc nofollow" target="_blank">这些指南</a>来设置辅助功能提示。</li><li id="a210" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityTrait</code> <em class="km">:最能表征可及性元素的可及性特征的组合。<br/> </em>如果你实现了一个定制的控件或者视图，你需要选择所有最能表征对象的可访问性特征，并通过执行一个or操作将它们和它的超类的特征(也就是用<code class="du mm mn mo mp b">super.accessibilityTraits</code>)结合起来。<br/>点击查看可用的<a class="ae lh" href="https://developer.apple.com/documentation/uikit/uiaccessibility/uiaccessibilitytraits" rel="noopener ugc nofollow" target="_blank">辅助功能列表。</a></li></ul><p id="f7f3" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated"><code class="du mm mn mo mp b">accessibilityLabel</code>和<code class="du mm mn mo mp b">accessibilityValue</code>由逗号<strong class="kn hj">、</strong>分隔，而<code class="du mm mn mo mp b">accessibilityHint</code>和<code class="du mm mn mo mp b">accessibilityLabel &amp;&amp; accessibilityValue</code>由句号<strong class="kn hj">分隔。</strong>这使得VO读出文本的方式大不相同。与a11y标签和值相比，在读出a11y提示之前总是有更长的暂停。</p><h2 id="e2ff" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated"><em class="mq">UIAccessibilityCustomAction</em></h2><p id="51d7" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated"><em class="km">与内置动作一起显示的自定义动作数组。</em></p><p id="9229" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">当有多个操作可用时，使用自定义操作。用户可以上下滑动来切换动作。</p><p id="1fc7" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated"><strong class="kn hj">💡</strong>如果您有一个带有一个预期动作的自定义视图，考虑覆盖自定义视图的<code class="du mm mn mo mp b">accessibilityActivate()</code>方法，当用户用一个手指双击元素时，该方法被触发。稍后我将在<strong class="kn hj">可访问性方法&amp;属性</strong>中介绍这一点。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="76e8" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">上面，我们已经将accessibilityCustomActions的作用域设置为call和email动作。当用户上下滑动动作时，<code class="du mm mn mo mp b">name</code>将是VO读取的内容，而<code class="du mm mn mo mp b">selector</code>方法将是用户激活它时触发的内容。</p><p id="5e6e" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">当VO检测到一个元素上有基于<code class="du mm mn mo mp b">accessibilityCustomActions</code>属性的自定义动作时，VO会添加可用的<em class="km">动作。向上或向下滑动以选择自定操作。然后，双击激活。</em>"文本为accessibilityHint。</p><blockquote class="kh ki kj"><p id="56d8" class="kk kl km kn b ko kp ij kq kr ks im kt ku kv kw kx ky kz la lb lc ld le lf lg hb bi translated"><strong class="kn hj">很高兴知道<em class="hi">💡</em> </strong>:启用VO的用户可以用两个手指在屏幕上做出“Z”的手势，作为后退/退出动作。只需覆盖视图控制器上的<code class="du mm mn mo mp b"><em class="hi">accessibilityPerformEscape()</em></code>方法进行进一步的定制——使用术语“进一步的定制”,因为视图控制器默认具有该功能！</p></blockquote><h2 id="7b02" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">uiaccessibilitypostonnotification</h2><p id="7c81" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated"><em class="km">向辅助应用发布通知。</em></p><p id="7b6c" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">当您的视图组件频繁变化或出现或消失时，请调用<code class="du mm mn mo mp b">UIAccessibility.post(notification:argument:)</code>。</p><p id="7f85" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">点击查看通知列表<a class="ae lh" href="https://developer.apple.com/documentation/uikit/uiaccessibility/notification" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="iy iz ja jb fd mt mp mu mv aw mw bi"><span id="6c88" class="jj jk hi mp b fi mx my l mz na">UIAccessibility.post(notification: .announcement, argument: "some text")</span></pre><p id="88f5" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">一旦上面的行被触发，VO将读取“一些文本”。</p><h1 id="4356" class="mb jk hi bd jl mc md me jp mf mg mh jt io mi ip jx ir mj is kb iu mk iv kf ml bi translated">辅助功能方法和属性</h1><ul class=""><li id="d187" class="ln lo hi kn b ko li kr lj ju nb jy nc kc nd lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityIncrement()</code> | <code class="du mm mn mo mp b">accessibilityDecrement()</code> <em class="km">:告诉accessibility元素增加或减少其内容的值。<br/> </em> ⚠️元素必须有一个<code class="du mm mn mo mp b">adjustable</code>的accessibilityTrait，方法才能被触发。<br/>这可以在UISliders中看到</li><li id="19a9" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityPerformEscape()</code> <em class="km">:关闭模态视图，返回动作成功或失败。</em></li><li id="4093" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityActivate()</code> <em class="km">:告诉元素激活自身，并报告操作的成功或失败。</em></li><li id="045a" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityFrameInContainerSpace</code> <em class="km">:辅助功能元素的框架，在其容器视图的坐标空间中。<br/> </em>使用该属性设置一个元素的框架矩形，该元素的框架矩形可能会受到其容器视图的影响。<br/>即<code class="du mm mn mo mp b">titleLabel.frame.union(subtitleLabel.frame)<br/></code>使用框架，因为你需要屏幕上的坐标，而不是与父视图相关的坐标。点击阅读更多关于框架和边界<a class="ae lh" href="https://github.com/RinniSwift/Computer-Science-with-iOS/blob/main/ui.md#frame-vs-bounds" rel="noopener ugc nofollow" target="_blank">的差异。<br/> ⚠️有时a11y帧显示不正确，请查看在<code class="du mm mn mo mp b">viewDidLayoutSubviews()</code>方法中设置<em class="km">accessibilityframeincainerspace</em>。</a></li><li id="2fbf" class="ln lo hi kn b ko lw kr lx ju ly jy lz kc ma lg ls lt lu lv bi translated"><code class="du mm mn mo mp b">accessibilityViewIsModal</code> <em class="km">:一个布尔值，指示VoiceOver是否忽略视图中作为元素同级的辅助功能元素。<br/> </em> ⚠️重要提示:有时当一个视图控制器没有完全呈现时，VO可以检测到当前呈现的视图控制器之外的元素。只需将该属性设置为true，这将使VO只访问当前视图控制器中的元素。</li></ul><h2 id="8170" class="jj jk hi bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated"><strong class="ak">参考文献</strong></h2><p id="58a8" class="pw-post-body-paragraph kk kl hi kn b ko li ij kq kr lj im kt ju lk kw kx jy ll la lb kc lm le lf lg hb bi translated"><a class="ae lh" href="https://developer.apple.com/accessibility/ios/" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/accessibility/ios/</a><br/><a class="ae lh" href="https://developer.apple.com/documentation/objectivec/nsobject/uiaccessibility" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/documentation/objectic/nsobject/ui accessibility</a><br/><a class="ae lh" href="https://developer.apple.com/videos/play/wwdc2018/226" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/videos/play/wwdc2018/226</a><br/><a class="ae lh" href="https://developer.apple.com/videos/play/wwdc2016/202" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/videos/play/wwdc2016/202</a><br/><a class="ae lh" href="https://developer.apple.com/videos/frameworks/accessibility/" rel="noopener ugc nofollow" target="_blank">https://developer . apple . com/videos/frameworks/accessibility/</a></p></div><div class="ab cl ne nf gp ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="hb hc hd he hf"><p id="bc3b" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">有多余的时间吗？看看这个GitHub回购:<br/><a class="ae lh" href="https://github.com/RinniSwift/Computer-Science-with-iOS" rel="noopener ugc nofollow" target="_blank">IOs版计算机科学</a> ⭐️</p><p id="4d4f" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">📌在LinkedIn和GitHub上找到我。😃</p><p id="57d4" class="pw-post-body-paragraph kk kl hi kn b ko kp ij kq kr ks im kt ju kv kw kx jy kz la lb kc ld le lf lg hb bi translated">请在下面的评论区留下你发现的任何可访问性提示和技巧！</p></div></div>    
</body>
</html>
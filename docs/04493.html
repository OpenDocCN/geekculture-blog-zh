<html>
<head>
<title>Dynamic Scoped CSS in Vue</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue中的动态范围CSS</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/dynamic-scoped-css-in-vue-7f8c5f4a32ba?source=collection_archive---------33-----------------------#2021-06-28">https://medium.com/geekculture/dynamic-scoped-css-in-vue-7f8c5f4a32ba?source=collection_archive---------33-----------------------#2021-06-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c8795054efa1401ec0403d9e1e64c0f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RlCnQHUDJ-LL0QrL2Yqnw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Dynamic scoped css in Vue</figcaption></figure><p id="42eb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️注:</strong>本教程的原版可以在我的网站<a class="ae js" href="https://www.spencermarx.com/posts/dynamic-scoped-css-in-vue" rel="noopener ugc nofollow" target="_blank">这里</a>找到。<br/> ⭐️⭐️ <strong class="iw hj">补充说明</strong> : <strong class="iw hj"> </strong>你是初级开发者吗？如果是，那就来看看我的公司<a class="ae js" href="https://aclarify.com/" rel="noopener ugc nofollow" target="_blank"> Aclarify </a>！我们提供带薪学徒计划，帮助你学习训练营和大学没有教你的基本软件工程元素。你将和我们一起工作3个月，从事真正的有报酬的项目，为你在软件行业的全职工作做准备。</p><p id="3e4c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你曾经使用过Vue单文件组件(sfc ),你可能会同意我的观点，它们太棒了。将HTML、Javascript(或Typescript)和CSS都放在一个地方使得构建和组织组件变得如此容易。</p><p id="6e44" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在下面的沙箱中，看一下这些SFC组件之一的基本示例:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx">Basic Vue SFC</figcaption></figure><p id="64db" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">怎么样？这么干净有条理！如果我打开了一个关于<code class="du jz ka kb kc b">HelloWorld.vue</code>组件的bug，<strong class="iw hj">，如果我们使用普通的Javascript/Typescript、Vue和CSS，我可能只需要在一个地方</strong>(<code class="du jz ka kb kc b">HelloWorld.vue</code>文件)中查找，而不是至少两个。我只想说，我是你的粉丝🚀</p><h1 id="3824" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">使用Vue单个文件组件的作用域样式</h1><p id="87ff" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">SFCs的一个我最喜欢的特性是能够将<code class="du jz ka kb kc b">&lt;style&gt;</code>标签中定义的样式限定在组件内的html模板中。这意味着，如果我想在不影响DOM中其他<code class="du jz ka kb kc b">&lt;h3&gt;</code>元素的情况下对组件中的<code class="du jz ka kb kc b">&lt;h3&gt;</code>元素进行独特的样式设计，我可以做到这一点，而不用担心<a class="ae js" href="https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity" rel="noopener ugc nofollow" target="_blank"> CSS特异性</a>。通过在SFC中的<code class="du jz ka kb kc b">&lt;style&gt;</code>标签上设置<code class="du jz ka kb kc b">scoped</code>属性，我可以简单地编写…</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="84fb" class="lk ke hi kc b fi ll lm l ln lo">h3 {<br/>  color: red;<br/>}</span></pre><p id="0b89" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">…并且确信这种风格只会影响这个组件中包含的<code class="du jz ka kb kc b">&lt;h3&gt;</code>元素，并且只影响这个组件。</p><p id="c89f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">作用域样式的好处不仅仅适用于一般的“html”标签，也适用于所提供的任何类型的CSS。这在编写UI库时特别有用，因为你可以确信你不会有任何冲突的样式规则。看看上面相同沙箱中的作用域样式组件:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx">Scoped Styles in Vue SFCs</figcaption></figure><p id="67f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">很酷吧？我认为单文件Vue组件和作用域样式允许开发人员处理绝大多数UI样式需求。然而，仍然存在一些场景，这些令人敬畏的特性有所欠缺，最终无法帮助我们。</p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="2521" class="kd ke hi bd kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la bi translated">Vue的作用域样式的问题是</h1><p id="5965" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">使用Vue SFCs的开发人员界面是静态的。这意味着<strong class="iw hj">我无法在SFC </strong>的 <code class="du jz ka kb kc b"><strong class="iw hj">&lt;style&gt;</strong></code> <strong class="iw hj">标签部分动态生成CSS。就像我说的，大多数时候，这没什么大不了的。通常只需在<code class="du jz ka kb kc b">&lt;style&gt;</code>标签中定义所有CSS，并在运行时使用Javascript/Typescript动态地将类分配给模板就足够了(例如，当用户单击按钮时向元素添加一个类)。</strong></p><p id="b1c5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，如果您需要在运行时动态定义整个样式表呢？也许你需要让用户完全控制你的应用程序中的一部分屏幕，或者你需要让一个页面的风格完全由每个客户端配置……使用Vue SFCs提供给我们的<code class="du jz ka kb kc b">&lt;style&gt;</code>标签这是不可能的。</p><p id="395d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">那么，我们如何在运行时动态地设计应用程序的一部分呢？</p><h1 id="be64" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">解决方案</h1><p id="d1d5" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">动态范围样式可以通过将问题分成两部分来实现:</p><p id="96d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">1.我们如何在运行时加载动态CSS？</p><p id="7987" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.<strong class="iw hj">作用域</strong> —我们如何确保我们加载的CSS只适用于给定的组件及其后代？</p><h2 id="3c8f" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">动态CSS</h2><p id="c2a6" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">通常你会发现大多数网站和网络应用在运行时使用样式表链接来加载CSS。然而，偶尔也可能会在DOM上遇到<code class="du jz ka kb kc b">&lt;style&gt;</code>元素。<strong class="iw hj">使用像Vue这样的前端框架，凭借其以编程方式生成元素的能力，我们可以获取一个字符串，并将其作为文本内容注入到</strong> <code class="du jz ka kb kc b"><strong class="iw hj">&lt;style&gt;</strong></code> <strong class="iw hj">标签</strong>中。这意味着我们可以在✅运行时从数据库、用户输入或其他地方以字符串的形式加载CSS</p><h2 id="3742" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">范围样式</h2><p id="cfd1" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">什么是“作用域样式？”在Vue的上下文中，作用域样式是"<em class="mo">CSS[应用于]当前组件的元素。"很好，所以我们只需要确保我们注入到标签中的CSS只影响组件中的元素。我们可以通过利用CSS特异性来实现这一点，方法是在我们编写的任何规则前添加一个唯一的选择器。为了保证选择器是真正惟一的，我们可以使用一个通用惟一标识符(即一个<a class="ae js" href="https://en.wikipedia.org/wiki/Universally_unique_identifier" rel="noopener ugc nofollow" target="_blank"> UUID </a>)字母数字字符串作为组件根的选择器。像这样:</em></p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="ffe4" class="lk ke hi kc b fi ll lm l ln lo">// The UUID corresponds to the wrapper id of our component<br/>#509b1685-cc80-47c3-8099-fd2dd9e6b35c h3 {<br/>  color: red;<br/>}</span></pre><p id="7984" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有了这个，我们应该可以放心地将样式动态添加到页面上，而不用担心它们会影响组件✅之外的DOM上的其他元素</p></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="fd8e" class="kd ke hi bd kf kg lw ki kj kk lx km kn ko ly kq kr ks lz ku kv kw ma ky kz la bi translated">示例问题上下文</h1><p id="c30d" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">对于本教程的剩余部分，我们将假设我们有以下要求:</p><h2 id="c0cb" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">解决方案要求:</h2><p id="c810" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">1.使用Vue，我们必须创建一个组件，它接受配置好的降价，并将所述降价转换成html。</p><p id="8cea" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2.Markdown组件应该接受动态范围样式的<code class="du jz ka kb kc b">string</code>类型属性，并将这些样式应用于组件呈现的最终html。</p><p id="3372" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">3.文本区域字段应该将动态范围样式<code class="du jz ka kb kc b">string</code>传递给Markdown组件，允许对markdown html进行即时范围样式更新。</p><h1 id="4287" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">实施</h1><p id="405f" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">很好，现在我们已经列出了我们的需求，并且理解了实现动态范围样式的一般方法，让我们写一些代码。</p><h2 id="b207" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤1:设置项目</h2><p id="56b2" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">让我们从快速启动一个Nuxt项目开始。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="0f9e" class="lk ke hi kc b fi ll lm l ln lo">$ npx create-nuxt-app dynamic-scoped-styles</span></pre><p id="f387" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">请随意配置您的项目不同于我的。我有以下选择:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/e87c6a9fc34979dd65d4dcabcbf1c45f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMs2dfg74VpiEo-5rAEH4w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Nuxt setup configs</figcaption></figure><p id="4b27" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后<code class="du jz ka kb kc b">cd</code>进入你的新Nuxt项目。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="6745" class="lk ke hi kc b fi ll lm l ln lo">$ cd dynamic-scoped-styles</span></pre><p id="e0e9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在让我们测试我们的模板项目，以确保它的工作。运行…</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="4d78" class="lk ke hi kc b fi ll lm l ln lo">$ npm run dev</span></pre><p id="4d7e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">希望Nuxt编译完成后，您会看到以下内容:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/faeab1e4e94fbfe1a0ed47250d0bded6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y7ws2W7I7Uc-4oWLqJvE4g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Initial project view</figcaption></figure><h2 id="97d8" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤2:添加降价组件</h2><p id="50a9" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">既然我们已经建立了我们的项目，让我们把我们的降价组件放在一起。</p><p id="2c3a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">首先让我们创建一个名为<code class="du jz ka kb kc b">Markdown.js</code>的新文件。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="eb89" class="lk ke hi kc b fi ll lm l ln lo">$ touch components/Markdown.js</span></pre><p id="c4ac" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后安装我们的markdown编译器。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="6e03" class="lk ke hi kc b fi ll lm l ln lo">$ npm install marked</span></pre><p id="2df3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">太好了！是时候写出我们降价部分的开头了。</p><p id="a4e3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mo">注意:在此之前，我想强调一下，我们并没有使用单个文件组件作为降价组件。由于我们稍后需要动态生成一个</em> <code class="du jz ka kb kc b"><em class="mo">&lt;style&gt;</em></code> <em class="mo">元素，我们将利用Vue实例的</em> <code class="du jz ka kb kc b"><em class="mo">render()</em></code> <em class="mo">函数属性提供给我们的Vue的</em> <code class="du jz ka kb kc b"><em class="mo">createElement()</em></code> <em class="mo">方法。</em></p><p id="9866" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好了，现在来看代码！我们将使用名为<code class="du jz ka kb kc b">content</code>的<code class="du jz ka kb kc b">string</code>类型<code class="du jz ka kb kc b">prop</code>来设置我们的降价组件。这个prop将接受来自父<code class="du jz ka kb kc b">pages/index.vue</code>页面组件的字符串，然后使用我们刚才下载的<code class="du jz ka kb kc b">marked</code>编译器将字符串转换为<code class="du jz ka kb kc b">html</code>，并将所述html注入到一个<code class="du jz ka kb kc b">&lt;div&gt;</code>元素中。</p><p id="8d40" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面是最终结果:</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="b44c" class="lk ke hi kc b fi ll lm l ln lo">// components/Markdown.js</span><span id="bdb8" class="lk ke hi kc b fi mr lm l ln lo">import Vue from 'vue'<br/>import marked from 'marked'</span><span id="7135" class="lk ke hi kc b fi mr lm l ln lo">export default Vue.extend({<br/>  name: 'Markdown',<br/>  props: {<br/>    content: {<br/>      type: String,<br/>      required: true,<br/>    },<br/>  },<br/>  computed: {<br/>    markdownHtml() {<br/>      return marked(this.content)<br/>    },<br/>  },<br/>  render(createElement) {<br/>    return createElement('div', {<br/>      domProps: {<br/>        innerHTML: this.markdownHtml,<br/>      },<br/>    })<br/>  },<br/>})</span></pre><h2 id="36bf" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤3:将我们的Markdown组件添加到主“pages/index.vue”组件中</h2><p id="9729" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">既然我们已经准备好开始我们的Markdown组件，让我们让它显示在浏览器中。</p><p id="ae35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">打开您的<code class="du jz ka kb kc b">pages/index.vue</code>，清除默认模板<code class="du jz ka kb kc b">html</code>以及除<code class="du jz ka kb kc b">.container</code>之外的所有样式，然后添加新的降价组件。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="87bc" class="lk ke hi kc b fi ll lm l ln lo">&lt;!-- pages/index.vue --&gt;</span><span id="9df4" class="lk ke hi kc b fi mr lm l ln lo">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;div&gt;<br/>      &lt;Markdown :content="content" /&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="d9fd" class="lk ke hi kc b fi mr lm l ln lo">&lt;script&gt;<br/>import Markdown from '~/components/Markdown.js'<br/>export default {<br/>  components: {<br/>    Markdown,<br/>  },<br/>  data() {<br/>    return {<br/>      content: `# Header 1\n\n## Header 2`,<br/>    }<br/>  },<br/>}<br/>&lt;/script&gt;</span><span id="ebf9" class="lk ke hi kc b fi mr lm l ln lo">&lt;style&gt;<br/>.container {<br/>  margin: 0 auto;<br/>  min-height: 100vh;<br/>  display: flex;<br/>  justify-content: center;<br/>  align-items: center;<br/>  text-align: center;<br/>}<br/>&lt;/style&gt;</span></pre><p id="9fed" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您会注意到，现在，我添加了一个名为<code class="du jz ka kb kc b">content</code>的<code class="du jz ka kb kc b">data()</code>属性，它作为<code class="du jz ka kb kc b">content</code>属性被传递给我们的<code class="du jz ka kb kc b">&lt;Markdown/&gt;</code>组件。我们最终会删除它，但现在让我们测试一切，以确保它的工作！</p><p id="0c71" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">确保您的服务器正在运行，并导航到您的浏览器…您应该会看到以下内容:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/35e8dd83bfdb4b2167532ea3c01cf6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZZsN0ddySUE58F4O7aR4Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Initial markdown component view</figcaption></figure><h2 id="712f" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤4:向主<code class="du jz ka kb kc b">'pages/index.vue'</code>组件添加文本区域，用于控制markdown内容和css</h2><p id="e441" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">让我们开始让事情变得更有活力。是时候添加基于用户的降价内容了。</p><p id="74d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">将您的<code class="du jz ka kb kc b">pages/index.vue</code>更新为:</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="0da0" class="lk ke hi kc b fi ll lm l ln lo">&lt;!-- pages/index.vue --&gt;</span><span id="9075" class="lk ke hi kc b fi mr lm l ln lo">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;form class="texteditor"&gt;<br/>      &lt;section&gt;<br/>        &lt;h2&gt;Content Editor&lt;/h2&gt;<br/>        &lt;textarea<br/>          id="markdown-text"<br/>          v-model="content"<br/>          name="markdown-content"<br/>          cols="30"<br/>          rows="10"<br/>        &gt;&lt;/textarea&gt;<br/>      &lt;/section&gt;<br/>      &lt;section&gt;<br/>        &lt;h2&gt;Style Editor&lt;/h2&gt;<br/>        &lt;textarea<br/>          id="markdown-text"<br/>          v-model="style"<br/>          name="markdown-content"<br/>          cols="30"<br/>          rows="10"<br/>        &gt;&lt;/textarea&gt;<br/>      &lt;/section&gt;<br/>    &lt;/form&gt;<br/>    &lt;div class="markdown-section"&gt;<br/>      &lt;h2&gt;Resulting Markdown&lt;/h2&gt;<br/>      &lt;Markdown :content="content" :raw-css="css" /&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="00f2" class="lk ke hi kc b fi mr lm l ln lo">&lt;script&gt;<br/>import Markdown from '~/components/Markdown.js'<br/>export default {<br/>  components: {<br/>    Markdown,<br/>  },<br/>  data() {<br/>    return {<br/>      content: '',<br/>      css: '',<br/>    }<br/>  },<br/>}<br/>&lt;/script&gt;</span><span id="841d" class="lk ke hi kc b fi mr lm l ln lo">&lt;style&gt;<br/>.container {<br/>  margin: 0 auto;<br/>  min-height: 100vh;<br/>  display: grid;<br/>  grid-template-columns: 1fr 1fr;<br/>  column-gap: 10px;<br/>}</span><span id="dee8" class="lk ke hi kc b fi mr lm l ln lo">.container:only-child {<br/>  padding: 0 10px;<br/>}</span><span id="f8f9" class="lk ke hi kc b fi mr lm l ln lo">.texteditor {<br/>  display: grid;<br/>  grid-template-columns: 1fr 1fr;<br/>  column-gap: 5px;<br/>}</span><span id="90a0" class="lk ke hi kc b fi mr lm l ln lo">.texteditor textarea {<br/>  height: 100%;<br/>  width: 100%;<br/>  border: 2px solid rgba(230, 230, 230, 1);<br/>  padding: 5px;<br/>  outline: none;<br/>}<br/>&lt;/style&gt;</span></pre><p id="b16f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好吧，这是怎么回事？</p><p id="7e01" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创造了新元素:</strong> <code class="du jz ka kb kc b"><strong class="iw hj">&lt;form&gt;</strong></code> <strong class="iw hj">和</strong> <code class="du jz ka kb kc b"><strong class="iw hj">&lt;textarea&gt;</strong></code> <strong class="iw hj">元素</strong></p><p id="4c8b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们添加了一个带有两个<code class="du jz ka kb kc b">&lt;textarea&gt;</code>元素的<code class="du jz ka kb kc b">&lt;form&gt;</code>来捕捉用户输入。</p><p id="1cc8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创造了新的</strong> <code class="du jz ka kb kc b"><strong class="iw hj">data()</strong></code> <strong class="iw hj">道具:</strong><code class="du jz ka kb kc b"><strong class="iw hj">content</strong></code><strong class="iw hj"/><code class="du jz ka kb kc b"><strong class="iw hj">css</strong></code></p><p id="d6b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><code class="du jz ka kb kc b">&lt;form&gt;</code>中的<code class="du jz ka kb kc b">&lt;textarea&gt;</code>元素使用了两个v-model (Vue对双绑定数据的简写)属性:<code class="du jz ka kb kc b">content</code>，这是之前在<code class="du jz ka kb kc b">data()</code>中静态设置的，以及<code class="du jz ka kb kc b">css</code>，这是一个新的字符串属性，我们将使用它将样式传递到Markdown组件中。</p><p id="79b8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️更新款式</strong></p><p id="3511" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们更新了样式并添加了几个新规则来实现几组嵌套列。</p><p id="37f8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">太好了，测试时间到了！打开浏览器，在“内容编辑器”中添加一些markdown。您应该看到最右边的“Resulting Markdown”部分根据您的输入更新了编译后的html。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/4c735f45c2de4983e8934bf21cc66fdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwGqKOPCZV9Dzc9TetriLA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Initial textareas view</figcaption></figure><p id="4d03" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">厉害！干得漂亮🤜🤛是时候装配我们的动态范围CSS了！</p><h2 id="343e" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤5:向我们的Markdown组件添加动态范围的css</h2><p id="ef49" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">首先，我们需要再安装一个包来生成唯一的id。我们将使用一个叫做<code class="du jz ka kb kc b">uuid</code>的通用包。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="f45b" class="lk ke hi kc b fi ll lm l ln lo">$ npm install uuid</span></pre><p id="f601" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">酷，现在跳回<code class="du jz ka kb kc b">components/Markdown.js</code>并更新文件，看起来像这样:</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="0f32" class="lk ke hi kc b fi ll lm l ln lo">// components/Markdown.js</span><span id="6204" class="lk ke hi kc b fi mr lm l ln lo">import Vue from 'vue'<br/>import marked from 'marked'<br/>import { v4 as uuid } from 'uuid'</span><span id="1807" class="lk ke hi kc b fi mr lm l ln lo">export default Vue.extend({<br/>  name: 'Markdown',<br/>  props: {<br/>    content: {<br/>      type: String,<br/>      required: true,<br/>    },<br/>    rawCss: {<br/>      type: String,<br/>      required: true,<br/>    },<br/>  },<br/>  data() {<br/>    return { wrapperId: uuid() }<br/>  },<br/>  computed: {<br/>    markdownHtml() {<br/>      return marked(this.content)<br/>    },<br/>    compiledCss() {<br/>      if (this.rawCss &amp;&amp; this.rawCss.length &gt; 0) {<br/>        const prefixedCss = this.prefixCss(this.rawCss)<br/>        return prefixedCss<br/>      }<br/>      return ''<br/>    },<br/>  },<br/>  methods: {<br/>    prefixCss(css) {<br/>      let id = `#${this.wrapperId}`<br/>      let char<br/>      let nextChar<br/>      let isAt<br/>      let isIn<br/>      const classLen = id.length</span><span id="72e4" class="lk ke hi kc b fi mr lm l ln lo">// makes sure the id will not concatenate the selector<br/>      id += ' '</span><span id="6932" class="lk ke hi kc b fi mr lm l ln lo">// removes comments<br/>      css = css.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g, '')</span><span id="a91c" class="lk ke hi kc b fi mr lm l ln lo">// makes sure nextChar will not target a space<br/>      css = css.replace(/}(\s*)@/g, '}@')<br/>      css = css.replace(/}(\s*)}/g, '}}')</span><span id="15f8" class="lk ke hi kc b fi mr lm l ln lo">for (let i = 0; i &lt; css.length - 2; i++) {<br/>        char = css[i]<br/>        nextChar = css[i + 1]</span><span id="2f16" class="lk ke hi kc b fi mr lm l ln lo">if (char === '@' &amp;&amp; nextChar !== 'f') isAt = true<br/>        if (!isAt &amp;&amp; char === '{') isIn = true<br/>        if (isIn &amp;&amp; char === '}') isIn = false</span><span id="8391" class="lk ke hi kc b fi mr lm l ln lo">if (<br/>          !isIn &amp;&amp;<br/>          nextChar !== '@' &amp;&amp;<br/>          nextChar !== '}' &amp;&amp;<br/>          (char === '}' ||<br/>            char === ',' ||<br/>            ((char === '{' || char === ';') &amp;&amp; isAt))<br/>        ) {<br/>          css = css.slice(0, i + 1) + id + css.slice(i + 1)<br/>          i += classLen<br/>          isAt = false<br/>        }<br/>      }</span><span id="7473" class="lk ke hi kc b fi mr lm l ln lo">// prefix the first select if it is not `<a class="ae js" href="http://twitter.com/media" rel="noopener ugc nofollow" target="_blank">@media</a>` and if it is not yet prefixed<br/>      if (css.indexOf(id) !== 0 &amp;&amp; css.indexOf('@') !== 0) css = id + css<br/>      return css<br/>    },<br/>  },<br/>  render(createElement) {<br/>    const styleElement = createElement('style', {<br/>      domProps: {<br/>        innerHTML: this.compiledCss,<br/>      },<br/>    })</span><span id="c00a" class="lk ke hi kc b fi mr lm l ln lo">const markdownElement = createElement('div', {<br/>      attrs: { id: this.wrapperId },<br/>      domProps: {<br/>        innerHTML: this.markdownHtml,<br/>      },<br/>    })</span><span id="db96" class="lk ke hi kc b fi mr lm l ln lo">return createElement('div', {}, [markdownElement, styleElement])<br/>  },<br/>})</span></pre><p id="b60b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">好了，深呼吸，🧘‍♀️🧘‍♂️，更新都很简单。我们来分解一下。</p><p id="b855" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创造了新道具:</strong> <code class="du jz ka kb kc b"><strong class="iw hj"><em class="mo">rawCss</em></strong></code></p><p id="9bfe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们需要从来自父组件的<code class="du jz ka kb kc b">&lt;textarea&gt;</code>中获取CSS。于是我们设置了一个<code class="du jz ka kb kc b">string</code>类型的新道具叫做<code class="du jz ka kb kc b">rawCss</code>。</p><p id="d67e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创造了一个新的</strong> <code class="du jz ka kb kc b"><strong class="iw hj">data()</strong></code> <strong class="iw hj">道具:</strong> <code class="du jz ka kb kc b"><strong class="iw hj">wrapperId</strong></code></p><p id="6fc1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们添加了一个名为<code class="du jz ka kb kc b">wrapperId</code>的新<code class="du jz ka kb kc b">data()</code>道具，它使用<code class="du jz ka kb kc b">uuid</code>库来生成一个通用的唯一id。</p><p id="fb23" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创造了一种新方法:</strong> <code class="du jz ka kb kc b"><strong class="iw hj">prefixCss()</strong></code></p><p id="a1b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这确实是大多数“作用域css”奇迹发生的地方。<code class="du jz ka kb kc b">prefixCSS()</code>方法接受css字符串，并用包装器<code class="du jz ka kb kc b">&lt;div&gt;</code>的惟一<code class="du jz ka kb kc b">wrapperId</code>为其中的每条规则添加前缀，这给了我们“作用域css”的特异性。</p><p id="4471" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️创建了一个新的计算道具:`<em class="mo"> compiledCss </em> ` </strong></p><p id="610e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了使用新的<code class="du jz ka kb kc b">rawCss</code>属性对用户输入的变化做出反应，我们添加了一个名为<code class="du jz ka kb kc b">compiledCss</code>的计算属性。在这里，我们将利用<code class="du jz ka kb kc b">prefixCss()</code>方法和我们独特的<code class="du jz ka kb kc b">wrapperId</code>。</p><p id="2911" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> ⭐️更新了</strong> <code class="du jz ka kb kc b"><strong class="iw hj">render()</strong></code> <strong class="iw hj">功能</strong></p><p id="3232" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面的修改已经准备好了，我们只需要在我们原来的markdown html旁边创建一个<code class="du jz ka kb kc b">&lt;style&gt;</code>元素，带有前缀css和分配给根包装器<code class="du jz ka kb kc b">&lt;div&gt;</code>元素的唯一的<code class="du jz ka kb kc b">wrapperId</code>。</p><p id="ad80" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">没那么糟吧？好的，再走一小步，我们就可以开始了！😎</p><h2 id="07ef" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">步骤5:更新<code class="du jz ka kb kc b">`pages<em class="mt">/index</em>.<em class="mt">vue</em>`</code>以将CSS传递给Markdown组件</h2><p id="a755" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">回到您的<code class="du jz ka kb kc b">pages/index.vue</code>组件，并确保将您的<code class="du jz ka kb kc b">css</code>道具(在<code class="du jz ka kb kc b"><em class="mo">data</em>()</code>中)传递到您更新的降价组件。</p><pre class="jt ju jv jw fd lg kc lh li aw lj bi"><span id="06b9" class="lk ke hi kc b fi ll lm l ln lo">&lt;!-- pages/index.vue --&gt;</span><span id="1a3a" class="lk ke hi kc b fi mr lm l ln lo">&lt;template&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;form class="texteditor"&gt;<br/>      &lt;section&gt;<br/>        &lt;h2&gt;Content Editor&lt;/h2&gt;<br/>        &lt;textarea<br/>          id="markdown-text"<br/>          v-model="content"<br/>          name="markdown-content"<br/>          cols="30"<br/>          rows="10"<br/>        &gt;&lt;/textarea&gt;<br/>      &lt;/section&gt;<br/>      &lt;section&gt;<br/>        &lt;h2&gt;Style Editor&lt;/h2&gt;<br/>        &lt;textarea<br/>          id="markdown-text"<br/>          v-model="css"<br/>          name="markdown-content"<br/>          cols="30"<br/>          rows="10"<br/>        &gt;&lt;/textarea&gt;<br/>      &lt;/section&gt;<br/>    &lt;/form&gt;<br/>    &lt;div class="markdown-section"&gt;<br/>      &lt;h2&gt;Resulting Markdown&lt;/h2&gt;<br/>      &lt;Markdown :content="content" :raw-css="css" /&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span><span id="e0ae" class="lk ke hi kc b fi mr lm l ln lo">&lt;script&gt;<br/>import Markdown from '~/components/Markdown.js'<br/>export default {<br/>  components: {<br/>    Markdown,<br/>  },<br/>  data() {<br/>    return {<br/>      content: '',<br/>      css: '',<br/>    }<br/>  },<br/>}<br/>&lt;/script&gt;</span><span id="6f33" class="lk ke hi kc b fi mr lm l ln lo">&lt;style&gt;<br/>.container {<br/>  margin: 0 auto;<br/>  min-height: 100vh;<br/>  display: grid;<br/>  grid-template-columns: 1fr 1fr;<br/>  column-gap: 10px;<br/>}</span><span id="5eb3" class="lk ke hi kc b fi mr lm l ln lo">.container:only-child {<br/>  padding: 0 10px;<br/>}</span><span id="7384" class="lk ke hi kc b fi mr lm l ln lo">.texteditor {<br/>  display: grid;<br/>  grid-template-columns: 1fr 1fr;<br/>  column-gap: 5px;<br/>}</span><span id="6ab7" class="lk ke hi kc b fi mr lm l ln lo">.texteditor textarea {<br/>  height: 100%;<br/>  width: 100%;<br/>  border: 2px solid rgba(230, 230, 230, 1);<br/>  padding: 5px;<br/>  outline: none;<br/>}<br/>&lt;/style&gt;</span></pre><p id="46b4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在回到你的浏览器吧！尝试在最左边的“内容编辑器”列中输入一些markdown，并在中间的“样式编辑器”中输入一些针对您的markdown的有效CSS，您应该会看到“结果Markdown”列更新了您应用的内容和样式。</p><p id="a10b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mo">注意:样式不会影响我们“结果减价”之外的任何元素，因此我们的动态CSS是“限定范围的！”</em> 🥳</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/4eac043e8c07e3858eedc6c7e7800ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oHtgTakeeu4xgspMoGAAg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Dynamic scoped styles in vue final view</figcaption></figure><p id="80b1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">干得好！我希望你在这里学到了一些东西！</p><h2 id="be70" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">感谢阅读！</h2><p id="eee5" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">感谢您的阅读，请不要犹豫，通过电子邮件或上述github repo联系我！🙏</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="mu jy l"/></div><figcaption class="iq ir et er es is it bd b be z dx">Time to celebrate!</figcaption></figure><h2 id="ebb2" class="lk ke hi bd kf mb mc md kj me mf mg kn jf mh mi kr jj mj mk kv jn ml mm kz mn bi translated">最终代码</h2><p id="98f5" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">点击查看完整代码<a class="ae js" href="https://github.com/spencermarx/tutorial-dynamic-scoped-css-in-vue" rel="noopener ugc nofollow" target="_blank">！如果您有任何建议或问题，请随时在回购上提出问题！</a></p></div></div>    
</body>
</html>
<html>
<head>
<title>TypeScript Builtin Types. Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TypeScript内置类型。第二部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/typescript-builtin-types-part-ii-2059803be7f6?source=collection_archive---------17-----------------------#2021-03-14">https://medium.com/geekculture/typescript-builtin-types-part-ii-2059803be7f6?source=collection_archive---------17-----------------------#2021-03-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">又来了！在我的<a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">上一篇文章</a>中，我们浏览了<code class="du je jf jg jh b">Partial&lt;T&gt;</code>、<code class="du je jf jg jh b">Required&lt;T&gt;</code>、<code class="du je jf jg jh b">Readonly&lt;T&gt;</code>和<code class="du je jf jg jh b">Pick&lt;T, K&gt;</code>类型，今天我们继续用新工具加强我们的武器库。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ji"><img src="../Images/c029eda3d2c942dd4eb0fdbf2f491096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BTykdkge3U0oq8k0fDditA.jpeg"/></div></div></figure><p id="f1dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开始吧！第一个是<code class="du je jf jg jh b">Record&lt;K, T&gt;</code>:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="bd64" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">K extends keyof any</code>实际上是指<code class="du je jf jg jh b">K</code>可以是<code class="du je jf jg jh b">string</code>、<code class="du je jf jg jh b">number</code>或<code class="du je jf jg jh b">symbol</code>，<code class="du je jf jg jh b">[P in K]: T</code>是指每个属性都应该是<code class="du je jf jg jh b">T</code>。</p><p id="bd1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我记得我第一次面对<code class="du je jf jg jh b">Record&lt;T, K&gt;</code>时，我已经定义了一个变量为<code class="du je jf jg jh b">object</code>，并收到了eslint错误:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="2f00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，我可以禁用这条规则，但我决定找出为什么<code class="du je jf jg jh b">object</code>难以使用。<code class="du je jf jg jh b">object</code>当我们不知道变量的结构时可以使用type，或者它可以是动态的，如在键值映射中，否则强烈建议为变量定义<code class="du je jf jg jh b">interface</code>或<code class="du je jf jg jh b">type</code>。那么，<code class="du je jf jg jh b">object</code>和<code class="du je jf jg jh b">Record&lt;K, T&gt;</code>有什么区别呢？让我给你看一个例子:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="243a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们初始化了一个<code class="du je jf jg jh b">object</code>，我们就不能向它添加新的属性。但是对于<code class="du je jf jg jh b">Record&lt;string, unknown&gt;</code>来说，这是完全合法的，因为它的定义表明它包含未知类型的属性，并且属性的键是字符串。这就是为什么<code class="du je jf jg jh b">Record&lt;K, T&gt;</code>比较好用的原因。</p><p id="a913" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当然，语句<code class="du je jf jg jh b">Record&lt;string, unknown&gt;</code>很庞大，我建议您为它创建一个类型别名:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="5a73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我保留了<code class="du je jf jg jh b">T</code>类型参数，以防对象具有相同类型的属性，比如在键值映射中。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="d382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，我们需要复习一下关于联合类型的知识。</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="2ab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">const u1: number | string</code>意味着<code class="du je jf jg jh b">u1</code>可以是<code class="du je jf jg jh b">number</code>或者<code class="du je jf jg jh b">string</code>，我们不知道它在编译时的确切类型。你可能注意到了<code class="du je jf jg jh b">|</code>运算符类似于逻辑or运算符<code class="du je jf jg jh b">||</code>，有着相同的含义。引入联合类型是因为JavaScript是一种非类型化语言，它的一些函数/方法可以根据某些条件返回不同的类型，比如<code class="du je jf jg jh b">Array.find</code>方法:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="4cca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它返回匹配谓词的第一个元素，如果没有找到匹配，则返回<code class="du je jf jg jh b">undefined</code>。</p><p id="3b0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">Exclude&lt;T, U&gt;</code>帮助我们处理类型联合。它从<code class="du je jf jg jh b">T</code>中排除了<code class="du je jf jg jh b">U</code>的可能类型。以下是来自官方打字文档的一些例子:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="16aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看它是如何工作的:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="2a71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个条件类型，它的工作方式类似于代码中的条件语句。<code class="du je jf jg jh b">T extends U</code>是一个谓词，如果谓词为<code class="du je jf jg jh b">true</code>则返回<code class="du je jf jg jh b">never</code>，否则返回<code class="du je jf jg jh b">T</code>。让我们来看看类型转换的所有步骤，并弄清楚它是如何工作的:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="640f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">引用自<a class="ae jd" href="https://www.typescriptlang.org/docs/handbook/basic-types.html#never" rel="noopener ugc nofollow" target="_blank">文档</a>:<em class="kd">“</em><code class="du je jf jg jh b"><em class="kd">never</em></code><em class="kd">类型表示从不出现的值的类型。”。这就是为什么我们在最后一步移除了<code class="du je jf jg jh b">never</code>。它类似于布尔逻辑像<code class="du je jf jg jh b">a | false</code>，在OR语句<code class="du je jf jg jh b">false</code>中不影响任何东西，可以去掉。</em></p><p id="00b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上<code class="du je jf jg jh b">Exclude&lt;T, U&gt;</code>在日常生活中并不常用。但它被用于下一种类型，这就是为什么理解它是如何工作的如此重要。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="9b6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一个是<code class="du je jf jg jh b">Extract&lt;T, U&gt;</code>，和<code class="du je jf jg jh b">Exclude&lt;T, U&gt;</code>很像。让我们简要地回顾一下类型转换的所有步骤:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="db00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见,<code class="du je jf jg jh b">Extract&lt;T, U&gt;</code>做了相反的转换。它保留来自<code class="du je jf jg jh b">T</code>的可以分配给<code class="du je jf jg jh b">U</code>的类型，其他类型被删除。如果我们把<code class="du je jf jg jh b">Extract&lt;T, U&gt;</code>和<code class="du je jf jg jh b">Exclude&lt;T, U&gt;</code>连在一起，我们就得到了<code class="du je jf jg jh b">T</code>。这两种类型很容易混淆，它们执行相似但相反的转换，并且它们的拼写非常相似。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="8c9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是今天的主菜<code class="du je jf jg jh b">Omit&lt;T, K&gt;</code>。</p><figure class="jj jk jl jm fd jn er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ke"><img src="../Images/a97e404dd2f3b15b33f329cfc6041aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cE4d5eIvQAlAZgcdDCx8pg.png"/></div></div></figure><p id="142a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设您正在编写一个简单的CRUD应用程序。实体看起来像这样:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="460e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于<code class="du je jf jg jh b">create</code>函数，我们不需要字段<code class="du je jf jg jh b">id</code>、<code class="du je jf jg jh b">createdAt</code>和<code class="du je jf jg jh b">updatedAt</code>，因为实体尚未创建。这些字段应该在<code class="du je jf jg jh b">create</code>方法本身中设置。那么，我们如何为<code class="du je jf jg jh b">create</code>函数参数定义类型呢？在<a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">上一篇文章</a>中我们学习了如何使用<code class="du je jf jg jh b">Pick&lt;T,K&gt;</code>，我们需要像这样的东西，但它应该排除属性，而不是选择。这是<code class="du je jf jg jh b">Omit&lt;T,K&gt;</code>:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="484e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了<code class="du je jf jg jh b">id</code>、<code class="du je jf jg jh b">createdAt</code>和<code class="du je jf jg jh b">updatedAt</code>之外，<code class="du je jf jg jh b">UserEntity</code>的所有属性都可以在<code class="du je jf jg jh b">userData</code>中访问。让我们弄清楚它是如何工作的:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="b97b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du je jf jg jh b">Exclude</code>过滤属性键，<code class="du je jf jg jh b">Pick</code>从原始类型<code class="du je jf jg jh b">T</code>中提取过滤后的属性。让我们为<code class="du je jf jg jh b">UserEntity</code>完成所有这些转换:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><p id="59a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，今天我们学习了如何处理<code class="du je jf jg jh b">Record&lt;K, T&gt;</code>、<code class="du je jf jg jh b">Exclude&lt;T, U&gt;</code>、<code class="du je jf jg jh b">Extract&lt;T, U&gt;</code>和<code class="du je jf jg jh b">Omit&lt;T, K&gt;</code>。你可能对所有这些排除、省略、挑选和提取的东西感到困惑。下面的表格可以帮助你记住这个主题，把它保存在某个地方:</p><figure class="jj jk jl jm fd jn"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="0433" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下一部分，我们将讨论<code class="du je jf jg jh b">NonNullable&lt;T&gt;</code>、<code class="du je jf jg jh b">Parameters&lt;T&gt;</code>、<code class="du je jf jg jh b">ConstructorParameters&lt;T&gt;</code>和<code class="du je jf jg jh b">ReturnType&lt;T&gt;</code>。</p><p id="8aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下次见，servus！</p><ul class=""><li id="060e" class="kf kg hi ih b ii ij im in iq kh iu ki iy kj jc kk kl km kn bi translated"><a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536"> TypeScript内置类型部分I. ( </a> <code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Partial</a></code> <a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Required</a></code> <a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Readonly</a></code> <a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">，</a> <code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536">Pick</a></code> <a class="ae jd" rel="noopener" href="/geekculture/typescript-bultin-types-part-i-b39d702bb536"> ) </a></li><li id="0413" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc kk kl km kn bi translated"><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"> TypeScript内置类型第二部分。(</a><code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Record</a></code><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"/><code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Exclude</a></code><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"/><code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Extract</a></code><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6"/><code class="du je jf jg jh b"><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">Omit</a></code><a class="ae jd" rel="noopener" href="/geekculture/typescript-builtin-types-part-ii-2059803be7f6">)</a></li><li id="5c72" class="kf kg hi ih b ii ko im kp iq kq iu kr iy ks jc kk kl km kn bi translated"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener"> TypeScript内置类型第三部分。(</a> <code class="du je jf jg jh b"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">NonNullable</a></code> <a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du je jf jg jh b"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">Parameters</a></code> <a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du je jf jg jh b"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">ReturnType</a></code> <a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">，</a> <code class="du je jf jg jh b"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">ConstructorParameters</a></code>， <code class="du je jf jg jh b"><a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener">InstanceType</a></code> <a class="ae jd" href="https://luckylibora.medium.com/typescript-builtin-types-part-iii-e2b75107c482" rel="noopener"> ) </a></li></ul></div></div>    
</body>
</html>
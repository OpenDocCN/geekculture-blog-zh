<html>
<head>
<title>All About Decision Trees Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于决策树的所有内容第2部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/all-about-decision-trees-part-2-99fa9bc23cf5?source=collection_archive---------52-----------------------#2021-07-05">https://medium.com/geekculture/all-about-decision-trees-part-2-99fa9bc23cf5?source=collection_archive---------52-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/1fb5cf2be4a59226141b9fd84939441b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*2tj1YxVim7_sovD1bp-SaQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Credits- <a class="ae iq" href="https://ldapwiki.com/wiki/Classification%20and%20Regression%20Trees" rel="noopener ugc nofollow" target="_blank">ldapwiki.com</a></figcaption></figure><p id="a8c0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在<a class="ae iq" href="https://gaurav-kumar.medium.com/all-about-decision-trees-part-i-cfa148c75631" rel="noopener"> <strong class="it hj">的第一部分</strong>的<strong class="it hj">中，我讨论了分类树和一些与决策树相关的术语。</strong></a></p><p id="b883" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我请求你在阅读这篇文章之前先浏览一下那篇文章。</p><p id="7b71" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在本文中，我们将了解<strong class="it hj">回归树</strong>以及如何使用它们进行预测。</p><p id="2dbf" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在<strong class="it hj">回归树</strong>中，目标变量是连续的数值数据。</p><p id="859d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">让我们用一个例子来理解回归树的<strong class="it hj">工作方式</strong>:</p><p id="c33c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">假设我们得到了许多学生每天平均学习时间的数据以及他们在考试中得到的分数。</p><p id="66f5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">所以，Avg之间的模式。学习时间和分数是这样的:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jp"><img src="../Images/cd4974cf1c162e92ac9070fe8bf67798.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*8V5Iqw2cAVuvsAlfDU5OBQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx">When trend is linear</figcaption></figure><p id="21b1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，我们可以清楚地看到，每天学习很多的学生更有可能取得好成绩，所以如果我们得到一个新的学生数据(粉红色的点)，那么基于他的平均成绩。学习时间我们可以通过如下所示的数据点画一条直线来预测他/她在未来考试中可能获得的分数:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ju"><img src="../Images/5c26f26b02de57dc6ed3a407961069bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*WPaEXBqWOK4eEVqnW2Q9Fg.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Prediction in case of Linear Trend</figcaption></figure><p id="0c04" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">实际上，我们能够做到这一点是因为数据遵循线性趋势，即当学习时间增加时，总分数也增加。</p><p id="3adb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是，如果数据遵循非线性趋势呢？如下图所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jv"><img src="../Images/8642ea2eb5c9f39a74ed89d87c5ce574.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*_oW7iXfd7SZpaa6mnVhOIA.png"/></div><figcaption class="im in et er es io ip bd b be z dx">When trend is non linear</figcaption></figure><p id="eebd" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">上图显示了学生在考试前一周的学习时间的表现。所以，那些学习非常努力、夜以继日的学生也不能取得好成绩，可能是因为睡眠不足会导致记忆力丧失。此外，学习不多的学生表现不好，这是显而易见的。</p><p id="d149" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">所以，看着这个图，我们可以清楚地看到，如果我们试图拟合一条直线，我们将无法正确地预测许多新数据点的值。所以，在这种情况下<strong class="it hj">回归树</strong>会变得很方便。</p><p id="5755" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在回归树的情况下，我们试图找到最佳的阈值来区分各组，如下所示。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jw"><img src="../Images/ca91300a8acc3264fa3e76928ef195e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*zGJwVmsYFEGjt9zNxuh2bA.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Regression Tree with Thresholds</figcaption></figure><p id="1314" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，如果我们得到一个新的数据点，其学习时间超过9小时，但少于24小时，那么他将来可能得到的总分数将是该范围内所有数据点的平均值。</p><p id="8849" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但现在问题来了，如何为我们的树决定这些完美的阈值？</p><p id="9a70" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">为此，取每对数据点的平均值，然后以此作为阈值，为我们的阈值预测的平均值和数据点的实际值计算<strong class="it hj"> RSS(残差平方和)</strong>。</p><p id="06e1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，我将只以第一对为例，因为我不能显示所有对的图像及其阈值。</p><p id="9362" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">注意:-我已经将上图的第一个数据点移至稍微靠左的位置，以便更容易显示平均线。</strong></p><p id="abeb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，现在让我们考虑前两个值的平均值作为阈值，并根据它来分离数据点。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jx"><img src="../Images/4039ce0b3a04ae6e786bf02f8a343dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*LZg8ZtOuAVG7G6Mt4_5o4Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Taking Threshold of first pair of values.</figcaption></figure><p id="6a3d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">根据该阈值，它正确预测第一个数据点的值，而它预测所有其他数据点的平均值，如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jy"><img src="../Images/ea6163412fb519599cf894233b9bd7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*VCyOn06xQLeeqJE1_BdGnw.png"/></div></figure><p id="0d7d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，为了测量我们的阈值预测到实际值的远近，我们需要一个度量来测量它的性能。</p><p id="b7d9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，在回归树的情况下，<strong class="it hj">【残差平方和】</strong>用于计算每个阈值的性能，如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jz"><img src="../Images/2f8eb007ec99f58cb82c2f37cb76f1bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*tqi90s-3F_CppGeKu-zq5Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Calculating residual sum of squares</figcaption></figure><p id="32b3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> RSS(残差平方和):- </strong>平均值与预测值之差的平方和。</p><p id="1544" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">以与上述相同的方式，计算所有其他对的阈值，然后比较它们的RSS，选择具有最小RSS的阈值作为最佳阈值。</p><p id="2449" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">下图显示了如何选择最佳阈值:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/9906054d3fd797ed2c51d84e653656e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*WhDiKCbSeXvchG53R1QixA.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Visualization of how best threshold is chosen</figcaption></figure><p id="cd52" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，当我们得到第一个阈值时，再次取对的平均值，再次重复上述所有步骤以得到另一个阈值，但唯一的区别是第一个阈值划分了它之前和之后的所有数据点，因此两部分的阈值分别计算如下:</p><div class="jq jr js jt fd ab cb"><figure class="kb ij kc kd ke kf kg paragraph-image"><img src="../Images/b3a5a0e76444d3dee6d7c4d1b872ebf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*HeBSqloRPx9IktmxDbtOug.png"/></figure><figure class="kb ij kh kd ke kf kg paragraph-image"><img src="../Images/389a773d54667b197572d58f3cea74d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*sQU-q8-1XomV-L2uh8ItRA.png"/></figure></div><p id="d1de" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，以这种方式，计算阈值以对数据进行分类的过程继续进行，但是可能我们的决策树模型开始记忆训练数据(过度拟合),如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/21cd6560e343b4e21bb7e9b83026c832.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*7_16ADLeMqstMxbL9LnqJA.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Overfitted Regression tree</figcaption></figure><p id="4073" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，为了避免这种过度拟合的情况，可以设置一个标准，即只有在至少4或5个数据点出现之前和之后的那些阈值才有效(在我们的情况下，只有很少的数据，但实际上对于大数据，该值通常取为20)。因此，根据这一条件，我们的最终阈值如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es jw"><img src="../Images/ca91300a8acc3264fa3e76928ef195e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*zGJwVmsYFEGjt9zNxuh2bA.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Final thresholds for study hour column</figcaption></figure><p id="59be" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">到目前为止，我们已经讨论了如何在列中找到最佳值来拆分树，如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/c78f9ea728d7c36bdccb85dd401c5c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*XZZypY6cSvY1HrunASp5Jw.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Final Regression tree</figcaption></figure><p id="f23a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">注意:-如果我们使用“学习时间&lt; 24”开始划分，结果将是相同的，您可以自己尝试。</strong></p><p id="bf3b" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是，如果我们有多个列呢？我们将如何决定哪一列最适合位于根节点？</p><p id="263a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">假设我们有如下所示的数据:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/5a6927f25ead27d8bcda481c30edf323.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*cRN6YNI8pcwVf-j3pg1U_Q.png"/></div></figure><p id="4bf2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">注:- </strong>表中数据并非真实数据，仅供举例，由本人创建:)</p><p id="31e6" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在这种情况下，我们将考虑每一列，并且将针对我们的目标列(标记为<strong class="it hj"/>)计算每种情况的RSS。</p><p id="c971" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们已经看到，当独立列是数字时，如'<strong class="it hj">学习时间</strong>或'<strong class="it hj">睡眠时间</strong>，阈值是如何计算的。</p><p id="500a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是如果我们有一个像上面所示的'<strong class="it hj"> Gender </strong>'这样的分类列呢？</p><p id="5eea" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在这种情况下，阈值可以是'<strong class="it hj"> M '或' F' </strong>,如下所示:</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/dfe71bf3620d51a2362f5a24f580a4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*5Aeir9Hw8ymxL4dvXlE_aw.png"/></div><figcaption class="im in et er es io ip bd b be z dx">Choosing threshold for categorical column</figcaption></figure><p id="845e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，取所有'<strong class="it hj"> M </strong>数据点和所有'<strong class="it hj"> F </strong>数据点的平均值，相对于该平均值计算RSS，并将选择'<strong class="it hj"> M </strong>和'<strong class="it hj"> F </strong>中具有较小<strong class="it hj"> RSS </strong>的一个。</p><p id="ca2c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">因此，最终根节点将是具有最少RSS的列。</p><p id="6195" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，对于分支节点，我已经在“<strong class="it hj">关于决策树</strong>的第1部分中介绍过，通过比较RSS和考虑根节点的条件来执行相同的程序。</p><p id="d1c8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">快乐学习！！！:)</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><p id="6c26" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">参考文献:</strong></p><p id="7a11" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><a class="ae iq" href="https://www.youtube.com/channel/UCtYLUTtgS3k1Fg4y5tAhLbw" rel="noopener ugc nofollow" target="_blank">Josh Starmer的stat quest</a></p></div></div>    
</body>
</html>
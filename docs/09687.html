<html>
<head>
<title>Deploying a Monero miner to Kubernetes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Monero矿工部署到Kubernetes</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/deploying-a-monero-miner-to-kubernetes-d03e5bfcd4d9?source=collection_archive---------5-----------------------#2021-12-23">https://medium.com/geekculture/deploying-a-monero-miner-to-kubernetes-d03e5bfcd4d9?source=collection_archive---------5-----------------------#2021-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="bf68" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在几分钟内将XMRig miner映像部署到Kubernetes集群的简单指南</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/7b21ae9f12759f2952802e0185565195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YeGS3bZjnzP-TZCp-2axdw.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Vector by <a class="ae jn" href="https://www.vecteezy.com/" rel="noopener ugc nofollow" target="_blank">Vecteezy</a></figcaption></figure><h1 id="7e05" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">XMRig是什么？</h1><p id="36fe" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">很高兴你问了。官网显示如下定义:</p><blockquote class="lc ld le"><p id="7305" class="kg kh lf ki b kj lg ij kl km lh im ko li lj kr ks lk ll kv kw lm ln kz la lb hb bi translated">高性能，开源，跨平台RandomX，KawPow，CryptoNight和AstroBWT统一CPU/GPU miner和RandomX基准测试。</p></blockquote><p id="4120" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">用简单的英语来说，<a class="ae jn" href="https://xmrig.com/miner" rel="noopener ugc nofollow" target="_blank"> XMRig </a>是一种加密货币矿工，支持<a class="ae jn" href="https://www.getmonero.org/" rel="noopener ugc nofollow" target="_blank"> Monero </a> (XMR)，以及其他硬币。它速度很快，而且和你家用电脑的CPU配合得很好。开发人员社区非常活跃，文档也非常丰富和有用。这也是我选择XMRig而不是其他采矿应用的原因。</p><p id="d17d" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">在这个简单的指南中，您将了解如何为Monero部署一个定制的XMRig miner映像作为一个独立的Docker容器，或者部署到一个Kubernetes集群。我保证你会学得开心！</p><h1 id="466d" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">先决条件</h1><ul class=""><li id="fa3e" class="lo lp hi ki b kj kk km kn kp lq kt lr kx ls lb lt lu lv lw bi translated"><a class="ae jn" href="https://getmonero.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Monero钱包</a>和一个<a class="ae jn" href="http://moneropools.com/" rel="noopener ugc nofollow" target="_blank">采矿池</a></li><li id="4529" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated">码头工人</li><li id="7dc7" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated">库伯内特星团</li></ul><h1 id="325b" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">入门指南</h1><p id="9ab7" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><strong class="ki hj">步骤1: </strong>克隆GitHub repo:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="5e9d" class="mh jp hi md b fi mi mj l mk ml">git clone https://github.com/rcmelendez/xmrig-docker.git</span></pre><p id="b10d" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj">第二步:</strong>编辑<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/config.json" rel="noopener ugc nofollow" target="_blank">config.json</a></code>文件。提供你的游泳池，钱包地址，和硬币给我。如果你觉得慷慨，将<code class="du mm mn mo md b">donate-level</code>设置为大于0:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="f450" class="mh jp hi md b fi mi mj l mk ml">"coin": "XMR",<br/>"url": "gulf.moneroocean.stream:10128",<br/>"user": "43BFSy88EBK7pstEvSkxp2BpnDYj2xP4PG4sf1MSywj2EDdF1WYyTysRGZFAh639zyKyZYzshQwQ4CELq9d76wob3zwfGuc",<br/>"donate-level": 0,</span></pre><p id="cf18" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">有关所有可用选项，请访问<a class="ae jn" href="https://xmrig.com/docs/miner/config" rel="noopener ugc nofollow" target="_blank"> XMRig配置文件</a>文档。</p><p id="9dcf" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj">步骤3: </strong>将映像部署为独立的Docker容器或Kubernetes集群:</p><h2 id="c515" class="mh jp hi bd jq mp mq mr ju ms mt mu jy kp mv mw ka kt mx my kc kx mz na ke nb bi translated">码头工人</h2><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="8b33" class="mh jp hi md b fi mi mj l mk ml">docker run -dit --rm \<br/>  --volume "$(pwd)"/config.json:/xmrig/etc/config.json:ro \<br/>  --volume "$(pwd)"/log:/xmrig/log \<br/>  --name xmrig rcmelendez/xmrig \<br/>  xmrig --config=/xmrig/etc/config.json</span></pre><p id="e1df" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">如果您喜欢用<strong class="ki hj"> Docker编写</strong>，根据需要编辑<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/docker-compose.yml" rel="noopener ugc nofollow" target="_blank">docker-compose.yml</a></code>清单并运行:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="ac49" class="mh jp hi md b fi mi mj l mk ml">docker-compose up -d</span></pre><h2 id="0281" class="mh jp hi bd jq mp mq mr ju ms mt mu jy kp mv mw ka kt mx my kc kx mz na ke nb bi translated">库伯内特斯</h2><p id="0664" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated"><strong class="ki hj">步骤1: </strong>为我们的XMRig应用程序创建一个<em class="lf">名称空间</em>(可选但推荐):</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="a9e4" class="mh jp hi md b fi mi mj l mk ml">kubectl create ns xmrig</span></pre><p id="f755" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj">步骤2: </strong>从<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/config.json" rel="noopener ugc nofollow" target="_blank">config.json</a></code>文件在新的名称空间<code class="du mm mn mo md b">xmrig</code>中创建一个<em class="lf">配置图</em>:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="9b09" class="mh jp hi md b fi mi mj l mk ml">kubectl create configmap xmrig-config --from-file config.json -n xmrig</span></pre><p id="3388" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj">第三步:</strong>编辑<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/xmrig.yaml" rel="noopener ugc nofollow" target="_blank">xmrig.yaml</a></code>文件。您可能想要修改的内容包括:</p><ul class=""><li id="9d6b" class="lo lp hi ki b kj lg km lh kp nc kt nd kx ne lb lt lu lv lw bi translated"><code class="du mm mn mo md b">replicas</code>:需要运行的pod数量。</li><li id="f743" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated"><code class="du mm mn mo md b">image:tag</code>:要查看所有可用版本，请前往Docker Hub repo的<a class="ae jn" href="https://hub.docker.com/r/rcmelendez/xmrig/tags" rel="noopener ugc nofollow" target="_blank">标签</a>标签。</li><li id="20a1" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated"><code class="du mm mn mo md b">resources</code>:为<code class="du mm mn mo md b">cpu</code>和<code class="du mm mn mo md b">memory</code>请求/限制设置合适的值。</li><li id="099b" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated"><code class="du mm mn mo md b">affinity</code>:清单将只为每个节点调度一个pod，如果这不是期望的行为，请移除<code class="du mm mn mo md b">affinity</code>块。</li></ul><p id="76d6" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated"><strong class="ki hj">步骤4: </strong>一旦您对上面的清单感到满意，就创建一个<em class="lf">部署</em>:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="f9bd" class="mh jp hi md b fi mi mj l mk ml">kubectl -f apply xmrig.yaml</span></pre><h1 id="df67" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">记录</h1><p id="c4c4" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">默认情况下，这个Docker映像将容器日志发送到<code class="du mm mn mo md b">stdout</code>。要查看日志，请运行:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="9aeb" class="mh jp hi md b fi mi mj l mk ml">docker logs xmrig</span></pre><p id="dd87" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">对于Kubernetes，执行:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="c389" class="mh jp hi md b fi mi mj l mk ml">kubectl logs -n xmrig &lt;pod-name&gt;</span></pre><h2 id="690f" class="mh jp hi bd jq mp mq mr ju ms mt mu jy kp mv mw ka kt mx my kc kx mz na ke nb bi translated">持续日志记录</h2><p id="112c" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">容器本质上是无状态的，所以当它们关闭时，它们的日志将会丢失。如果希望日志持久化，请在<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/config.json" rel="noopener ugc nofollow" target="_blank">config.json</a></code>文件中启用XMRig syslog输出:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="f1da" class="mh jp hi md b fi mi mj l mk ml">"syslog": true,<br/>"log-file": "/xmrig/log/xmrig.log",</span></pre><p id="fc42" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">并对主机上的目录授予完全权限:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="1035" class="mh jp hi md b fi mi mj l mk ml">chmod 777 "$(pwd)"/log</span></pre><p id="29aa" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">然后使用Docker <a class="ae jn" href="https://docs.docker.com/storage/bind-mounts/" rel="noopener ugc nofollow" target="_blank">绑定挂载</a>或Kubernetes <a class="ae jn" href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/" rel="noopener ugc nofollow" target="_blank">持久卷</a>将日志文件保存在主机上。上面的<code class="du mm mn mo md b">docker run</code>命令和<code class="du mm mn mo md b"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker/blob/main/docker-compose.yml" rel="noopener ugc nofollow" target="_blank">docker-compose.yml</a></code>文件已经包含了这个映射。</p><h1 id="affd" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">确认</h1><p id="a437" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">pod或容器运行后，检查日志。需要几分钟时间来显示“<em class="lf">已接受</em>股票为绿色:</p><pre class="iy iz ja jb fd mc md me mf aw mg bi"><span id="fd0b" class="mh jp hi md b fi mi mj l mk ml">[2021-12-18 11:54:07.289]  cpu      accepted (1/0) diff 41037 (248 ms)</span></pre><p id="4cf5" class="pw-post-body-paragraph kg kh hi ki b kj lg ij kl km lh im ko kp lj kr ks kt ll kv kw kx ln kz la lb hb bi translated">以上消息表示第一次分享被接受！然后你可以去你的游泳池的网站(在我的情况下是<a class="ae jn" href="https://moneroocean.stream/" rel="noopener ugc nofollow" target="_blank"> MoneroOcean </a>)，输入你的钱包地址，你就可以确认那些股份了。请耐心等待，游泳池也需要一些时间来更新您的号码。</p><h1 id="99f5" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">放弃</h1><p id="71f8" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">这些都不能被认为是财务建议。自己做研究，挖掘自己喜欢的加密货币。我是一名技术爱好者，具备Docker和Kubernetes的基础知识。这个项目的灵感来自我开始了解加密货币世界的好奇心和不断提高我的技术技能的动力。我或者你会因为使用XMRig而变得富有吗？我不这么认为。会很好玩吗？是啊。你会学吗？很多！</p><h1 id="9256" class="jo jp hi bd jq jr js jt ju jv jw jx jy io jz ip ka ir kb is kc iu kd iv ke kf bi translated">包扎</h1><p id="432e" class="pw-post-body-paragraph kg kh hi ki b kj kk ij kl km kn im ko kp kq kr ks kt ku kv kw kx ky kz la lb hb bi translated">到目前为止，您应该已经成功地使用Kubernetes集群或者作为一个独立的Docker容器来挖掘Monero了。如果你有任何问题或意见，请告诉我，我会帮助你的。快乐的莫内罗矿业！</p></div><div class="ab cl nf ng gp nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="hb hc hd he hf"><h1 id="6301" class="jo jp hi bd jq jr nm jt ju jv nn jx jy io no ip ka ir np is kc iu nq iv ke kf bi translated">参考</h1><ul class=""><li id="0769" class="lo lp hi ki b kj kk km kn kp lq kt lr kx ls lb lt lu lv lw bi translated"><a class="ae jn" href="https://xmrig.com/miner" rel="noopener ugc nofollow" target="_blank"> XMRig </a></li><li id="08d8" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated"><a class="ae jn" href="https://www.getmonero.org/" rel="noopener ugc nofollow" target="_blank">莫内罗</a></li><li id="3c37" class="lo lp hi ki b kj lx km ly kp lz kt ma kx mb lb lt lu lv lw bi translated"><a class="ae jn" href="https://github.com/rcmelendez/xmrig-docker" rel="noopener ugc nofollow" target="_blank"> GitHub回购</a></li></ul></div></div>    
</body>
</html>
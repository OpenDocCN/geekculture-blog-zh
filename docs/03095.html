<html>
<head>
<title>Vald. A highly scalable distributed fast approximate nearest neighbor dense vector search engine.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">瓦尔德。一个高度可扩展的分布式快速近似最近邻密集向量搜索引擎。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/vald-a-highly-scalable-distributed-fast-approximate-nearest-neighbour-dense-vector-search-engine-af1946a4a37?source=collection_archive---------24-----------------------#2021-05-31">https://medium.com/geekculture/vald-a-highly-scalable-distributed-fast-approximate-nearest-neighbour-dense-vector-search-engine-af1946a4a37?source=collection_archive---------24-----------------------#2021-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es im"><img src="../Images/d1fa9286d505c7653cc9db8d2e417a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QcffuhOd18AK8MW0oIBNkw.png"/></div></div></figure><h2 id="bbb6" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">数据检索的状态</h2><p id="be8d" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq hb bi translated">如今，对信息检索的需求越来越基于文本和各种类型的数据，包括文本、图像、视频和音频。这些技术每年都变得越来越先进。数据的类型和解释方法也在多样化。目前，这些技术在许多领域都有帮助，例如推荐搜索，它包括用户在上下文中的行为，以及图像搜索，它使用图像特征向量来执行类似的搜索。随着这些技术和内容的发展，这些技术的规模每年都在增加。用传统的基于规则的搜索引擎有效地搜索这些数据并不容易。纯文本搜索已经过时了。除了图像搜索之外，文本搜索方法也变得流行，其中使用自然语言处理来处理查询，该自然语言处理准确地解释文本的含义并返回接近有意义的搜索结果。在另一个领域，通过生成图像特征和文本特征的组合，通过图像和文本的多模态搜索变得可用。如上所述，如今可以使用深度学习技术将各种各样的数据表示为向量。因此，向量搜索引擎作为一种与模型无关的搜索技术已经成为一项重要的技术。在这篇博客中，我想介绍一种使用矢量搜索技术中使用的近似最近邻(ANN)搜索的产品。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="67ea" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">什么是近似最近邻(ANN)</h2><p id="634f" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq hb bi translated">在解释ANN之前，我们先来看看kNN(k-最近邻)。很多专家已经解释过kNN了，所以我在这里简单解释一下。kNN和ANN一样是寻找最相似向量的方法之一。这是一种搜索k个与查询最近邻的数据的方法。但是，这种方法存在数据量和性能方面的问题。在kNN中返回精确邻居的代价是要搜索的数据量随着数据数量的增加而增加，这需要大量的计算时间。这就是为什么ANN作为另一种方法出现了。人工神经网络是一种搜索近似邻域或近似邻域中的数据的方法。实现ANN的方法有很多，但最常见的是基于图形或树的实现。基于图的人工神经网络不会搜索所有的图边。相反，它通过设置阈值来搜索其中的一部分，以防止随着数据数量的增加计算时间成比例地增加。</p><p id="23d3" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">人工神经网络方法是计算最近大数据的向量相似性的有效方法。</p></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="f728" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">使用向量的近似最近邻搜索的现状</h2><p id="ce36" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq hb bi translated">许多公司都在研究向量近似最近邻搜索，如雅虎日本的NGT、脸书的Faiss、Spotify的are和微软的SPTAG。这些库是开源项目。你可以在GitHub上查看它们。迄今为止，最平衡和表现最好的引擎是雅虎日本的NGT。每个基准测试的结果可以在<a class="ae kw" href="http://ann-benchmarks.com/index.html" rel="noopener ugc nofollow" target="_blank"> ANN-Benchmarks </a>中找到。</p><div class="kx ky ez fb kz la"><a href="https://github.com/yahoojapan/NGT" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">Yahoo日本/NGT</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">用于索引高维数据的邻域图和树NGT提供了命令和库来执行…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">github.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo iw la"/></div></div></a></div><div class="kx ky ez fb kz la"><a href="https://github.com/facebookresearch/faiss" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">facebookresearch/faiss</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">Faiss是一个用于高效相似性搜索和密集向量聚类的库。它包含算法搜索…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">github.com</p></div></div><div class="lj l"><div class="lp l ll lm ln lj lo iw la"/></div></div></a></div><div class="kx ky ez fb kz la"><a href="https://github.com/spotify/annoy" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">Spotify/骚扰</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">是一个带有Python绑定的C++库，用来搜索空间中的点…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">github.com</p></div></div><div class="lj l"><div class="lq l ll lm ln lj lo iw la"/></div></div></a></div><div class="kx ky ez fb kz la"><a href="https://github.com/microsoft/SPTAG" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">微软/SPTAG</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">SPTAG(空间划分树和图)是一个大规模矢量近似最近邻搜索场景的库…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">github.com</p></div></div><div class="lj l"><div class="lr l ll lm ln lj lo iw la"/></div></div></a></div><h2 id="7387" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">关于NGT</h2><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="is it di iu bf iv"><div class="er es ls"><img src="../Images/accf019ab99d138a894cf5763e6501a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lrhxF9cYGEDrDm1dXy8C1A.png"/></div></div></figure><p id="2718" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">NGT是由雅虎日本的研究员<a class="ae kw" href="https://github.com/masajiro" rel="noopener ugc nofollow" target="_blank"> @masajiro </a>开发的。NGT使用“图形和树”设计进行快速近似k-最近邻搜索。NGT有一个名为NGTD的服务器实现。它通过REST和gRPC接口提供了NGT的矢量搜索功能。</p><div class="kx ky ez fb kz la"><a href="https://github.com/yahoojapan/ngtd" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">Yahoo日本/ngtd</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">NGTD为NGT提供服务功能。NGTD支持gRPC和HTTP协议，所以你可以用…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">github.com</p></div></div><div class="lj l"><div class="lt l ll lm ln lj lo iw la"/></div></div></a></div><p id="1465" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">NGT是一个平衡的引擎，支持高性能和高精度的向量近似最近邻搜索。由于将索引保存在内存中的性质，它需要大量内存。特别是在多模态数据中，每个矢量数据的维数往往很高。因此，可以使用的索引数量受限于服务器的最大内存容量。</p><p id="672d" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">还有一个问题。假设NGTD服务器拥有大量的索引。在这种情况下，用户必须精确地控制复杂的矢量索引工作流，例如插入、搜索、删除、更新、图形索引的提交命令，以及提交操作期间的系统锁定。所以数据量随着提交处理时间的增加而增加，通过用户的API锁定动作变得更加频繁。</p><p id="6edc" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">从这些事情中，我们意识到NGT/NGTD有其局限性，集群化的NGTD项目的设计开始了。然而，它不能避免这些问题和不便，因为仅仅通过分配不能降低操作成本。我们审查并重新设计了整个现有系统，以改善它。</p><p id="2649" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">这就是为什么我们开发了一个名为“Vald”的分布式密集向量近似最近邻搜索引擎。</p><div class="kx ky ez fb kz la"><a href="https://vald.vdaas.org" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">瓦尔德</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">Vald是一个高度可扩展的分布式快速近似最近邻密集向量搜索引擎。Vald旨在…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">vald.vdaas.org</p></div></div><div class="lj l"><div class="lu l ll lm ln lj lo iw la"/></div></div></a></div></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="a616" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">Vald是什么？</h2><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es lv"><img src="../Images/869757e41594e991c82b86b88f1f46cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*uf78kgFIL_L-Zv50J_eq4w.png"/></div></figure><p id="1842" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">Vald是一个高度可扩展的分布式快速近似最近邻密集向量搜索引擎，具有水平扩展功能，基于微服务架构设计，与Kubernetes有很高的亲和力。Vald是一个OSS项目，任何人都可以使用GitHub很容易地对它做出贡献。Vald最初是基于NGTD开发的，以支持雅虎日本规模的使用大数据的人工神经网络搜索。它的设计和开发满足了许多要求，如稳定性、灾难恢复能力和性能要求，这就是为什么它经常受到日本大型It公司Yahoo Japan的测试。</p><h2 id="f935" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">1.云-原生向量相似性搜索引擎</h2><ul class=""><li id="c042" class="lw lx hi jy b jz ka kd ke jj ly jn lz jr ma kq mb mc md me bi translated">Vald可以在容器环境中方便地使用。</li><li id="2752" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">如果某人有大量数据，我们在Kubernetes上支持Vald，这是一个高度可扩展的矢量引擎。我们也支持helm包管理器&amp; helm-operator用户可以很容易地使用它们进行部署。请检查我们的文档。</li><li id="87f6" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/tutorial/get-started/" rel="noopener ugc nofollow" target="_blank">舵展开</a></li><li id="b9cd" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/tutorial/using-backup-with-scylladb/" rel="noopener ugc nofollow" target="_blank">全功能部署(针对专家用户)</a></li><li id="addc" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/user-guides/configuration/" rel="noopener ugc nofollow" target="_blank">舵配置文件</a></li><li id="69a9" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/user-guides/operations/" rel="noopener ugc nofollow" target="_blank">舵操作员文档</a></li><li id="2b1e" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">如果有人想像使用单服务器ANN引擎一样使用NGTD，我们支持独立的最小部署。请检查我们的文档。</li><li id="f846" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/tutorial/vald-agent-standalone-on-k8s/" rel="noopener ugc nofollow" target="_blank"> Kubernetes环境</a></li><li id="fc89" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated"><a class="ae kw" href="https://vald.vdaas.org/docs/tutorial/vald-agent-standalone-on-docker/" rel="noopener ugc nofollow" target="_blank"> Docker环境</a></li></ul><h2 id="767e" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">2.高度可扩展</h2><ul class=""><li id="c817" class="lw lx hi jy b jz ka kd ke jj ly jn lz jr ma kq mb mc md me bi translated">Vald是为Kubernetes环境设计的。可伸缩性是Kubernetes集群大小。如果集群规模Vald可以使用越来越多的内存(矢量索引)容量，用户可以快速扩展他们的Kubernetes。</li><li id="e870" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">Vald拥有分布式矢量存储算法和基于计算资源的平衡算法，并支持集群范围的优化内存控制</li></ul><h2 id="df30" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">3.高度可定制</h2><ul class=""><li id="e766" class="lw lx hi jy b jz ka kd ke jj ly jn lz jr ma kq mb mc md me bi translated">所有Vald组件都可以使用YAML文件和环境变量进行配置。</li><li id="25fc" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">用户可以自定义许多参数，如grpc MsgBufferSize等</li><li id="a388" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">Vald架构根据领域特性进行了很好的划分，用户可以很容易地定制Vald组件，并且很容易添加新的数据库支持</li><li id="c663" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">我们在入口和出口都有一个过滤器组件</li><li id="e09b" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">使用入口过滤器组件，用户可以很容易地操纵传入的数据。例如，使用张量流向量维度填充将blob数据转换成向量</li><li id="e113" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">使用Egress-Filter组件，用户可以轻松地操作传出的搜索结果。人工神经网络搜索结果是近似的。有时这会给推荐准确性带来问题。Vald有出口过滤器，用户可以很容易地修改人工神经网络搜索结果。</li></ul><h2 id="4e33" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">4.自动矢量索引管理</h2><ul class=""><li id="cf91" class="lw lx hi jy b jz ka kd ke jj ly jn lz jr ma kq mb mc md me bi translated">自动将索引数据备份到多个位置，如AWS S3、Google云存储、Cassandra、MySQL、本地卷。</li><li id="0778" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">从备份位置自动恢复索引。</li><li id="c937" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">自动提交索引以获得无阻塞矢量搜索体验。</li><li id="820c" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">自动重新平衡索引复制以实现稳定性。</li></ul><h2 id="dde5" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">5.多语言支持</h2><ul class=""><li id="06a4" class="lw lx hi jy b jz ka kd ke jj ly jn lz jr ma kq mb mc md me bi translated">支持的语言有Go，Python，Java，Node，Clojure。</li><li id="d990" class="lw lx hi jy b jz mf kd mg jj mh jn mi jr mj kq mb mc md me bi translated">我们也有原型文件，许多语言可以使用它们的gRPC库连接到Vald。</li></ul></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><h2 id="6ef3" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">最后</h2><p id="bcf5" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg jj kh ki kj jn kk kl km jr kn ko kp kq hb bi translated">感谢您花时间阅读这篇博文。您可以从这里开始尝试Vald。</p><div class="kx ky ez fb kz la"><a href="https://vald.vdaas.org/docs/tutorial/get-started/" rel="noopener  ugc nofollow" target="_blank"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hj fi z dy lf ea eb lg ed ef hh bi translated">Vald |开始使用</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">Vald是一个高度可扩展的分布式快速近似最近邻密集向量搜索引擎。Vald的设计和…</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">vald.vdaas.org</p></div></div><div class="lj l"><div class="mk l ll lm ln lj lo iw la"/></div></div></a></div><p id="5a3b" class="pw-post-body-paragraph jw jx hi jy b jz kr kb kc kd ks kf kg jj kt ki kj jn ku kl km jr kv ko kp kq hb bi translated">我们将在未来发布更多关于Vald的内容，包括如何使用它和改进您的搜索引擎，请期待下一篇帖子。</p></div></div>    
</body>
</html>
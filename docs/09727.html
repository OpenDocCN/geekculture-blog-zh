<html>
<head>
<title>Certificate Generation(MSP/ TLS) In Hyperledger Fabric Blockchain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hyperledger Fabric区块链中的证书生成(MSP/ TLS)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/certificate-generation-msp-tls-in-hyperledger-fabric-blockchain-ef7aef7bcc44?source=collection_archive---------7-----------------------#2021-12-25">https://medium.com/geekculture/certificate-generation-msp-tls-in-hyperledger-fabric-blockchain-ef7aef7bcc44?source=collection_archive---------7-----------------------#2021-12-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/></div><div class="ab cl if ig gp ih" role="separator"><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik il"/><span class="ii bw bk ij ik"/></div><div class="hb hc hd he hf"><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es im"><img src="../Images/1215482039d1019ad41da2d9cc2019e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2ueRXEugGhf4aF68oei3g.jpeg"/></div><figcaption class="iu iv et er es iw ix bd b be z dx">Security Key</figcaption></figure><h1 id="9ccc" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">介绍</h1><p id="b3ca" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">在本文中，我们将看到为组织(同行、用户、管理员)和订购者生成MSP/TLS证书。将看到如何使用<strong class="jy hj">密码</strong>和<strong class="jy hj">认证机构生成证书。</strong></p><h1 id="c615" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">观众</h1><p id="e9ad" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">Hyperledger结构操作员，管理员。这是一篇为MSP和TLS生成结构网络证书的实践操作文章。对于初学者，我想建议请通过一些基本概念的超帐织物。</p><blockquote class="ku kv kw"><p id="c0ef" class="jw jx kx jy b jz ky kb kc kd kz kf kg la lb kj kk lc ld kn ko le lf kr ks kt hb bi translated">注意:本文不推荐给HLF初学者。</p></blockquote><h1 id="52d8" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">先决条件</h1><ol class=""><li id="8c93" class="lg lh hi jy b jz ka kd ke kh li kl lj kp lk kt ll lm ln lo bi translated">基本了解<strong class="jy hj"> Hyperledger Fabric区块链</strong>。</li><li id="f36e" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt ll lm ln lo bi translated">基本了解PKI系统，SSL，TLS证书。</li><li id="124d" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt ll lm ln lo bi translated">基本的外壳命令、外壳脚本等。</li></ol><h1 id="a69a" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">系统需求</h1><ol class=""><li id="b2cc" class="lg lh hi jy b jz ka kd ke kh li kl lj kp lk kt ll lm ln lo bi translated">卷曲。</li><li id="db34" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt ll lm ln lo bi translated">Openssl。</li><li id="9a99" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt ll lm ln lo bi translated">Docker —版本17.06.2或更高版本</li><li id="76f6" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt ll lm ln lo bi translated">Docker Compose —版本1.28.5或更高版本</li></ol><h1 id="5380" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">设置步骤</h1><ul class=""><li id="437e" class="lg lh hi jy b jz ka kd ke kh li kl lj kp lk kt lu lm ln lo bi translated">下载/安装Hyperledger Fabric二进制文件和CA。</li><li id="3dc6" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">使用密码工具生成证书</li><li id="6cac" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">结构CA服务器的设置。</li><li id="eaa7" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">使用证书颁发机构(CA)生成证书</li><li id="adb0" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">清理干净。</li><li id="40bc" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">总结。</li></ul><h1 id="8245" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">下载Fabric二进制文件。</h1><p id="5eb0" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">首先，下载HLF二进制文件。按照以下说明下载。更多信息，可以访问HLF官方<a class="ae lv" href="https://hyperledger-fabric.readthedocs.io/en/release-2.2/install.html" rel="noopener ugc nofollow" target="_blank"> doc这里</a></p><p id="4f93" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated"><strong class="jy hj">语法</strong>。</p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="ba91" class="mb iz hi lx b fi mc md l me mf">curl <strong class="lx hj">-</strong>sSL https:<strong class="lx hj">//</strong>bit<strong class="lx hj">.</strong>ly<strong class="lx hj">/</strong>2ysbOFE <strong class="lx hj">|</strong> bash <strong class="lx hj">-</strong>s <strong class="lx hj">--</strong> <strong class="lx hj">&lt;</strong>fabric_version<strong class="lx hj">&gt;</strong> <strong class="lx hj">&lt;</strong>fabric<strong class="lx hj">-</strong>ca_version<strong class="lx hj">&gt;</strong></span></pre><p id="b32d" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated"><em class="kx">安装:</em>复制以下命令并粘贴到终端中。</p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="62d3" class="mb iz hi lx b fi mc md l me mf">curl <strong class="lx hj">-</strong>sSL https:<strong class="lx hj">//</strong>bit<strong class="lx hj">.</strong>ly<strong class="lx hj">/</strong>2ysbOFE <strong class="lx hj">|</strong> bash <strong class="lx hj">-</strong>s <strong class="lx hj">--</strong> 2.2.4 1.5<strong class="lx hj">.</strong>2</span></pre><p id="3adc" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">下载后，可以看到面料样品里面的<strong class="jy hj"> <em class="kx"> bin </em> </strong>目录。这个目录包含HLF二进制文件。如下验证您的二进制版本。为了简单起见，我将所有二进制文件复制到<strong class="jy hj"> /usr/local/bin </strong>目录中，因此我们不需要导出bin路径。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/c6b600eb83307682e518ce7ecdb92a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6D2AXd9xZJkX6v2d1VnBsQ.png"/></div></div></figure><blockquote class="ku kv kw"><p id="7ca2" class="jw jx kx jy b jz ky kb kc kd kz kf kg la lb kj kk lc ld kn ko le lf kr ks kt hb bi translated">这里，我使用的是<strong class="jy hj"> fabric 2.2.4 </strong>版本和用于<strong class="jy hj"> CA 1.5.2 </strong></p></blockquote><h1 id="69be" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">隐原</h1><ul class=""><li id="3a9e" class="lg lh hi jy b jz ka kd ke kh li kl lj kp lk kt lu lm ln lo bi translated"><code class="du ml mm mn lx b"><strong class="jy hj">cryptogen</strong></code>是生成Hyperledger结构证书和密钥的实用工具。不建议在<strong class="jy hj">生产网络中使用。</strong></li><li id="2195" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">Cryptoyamlgen提供了以下命令</li><li id="c5ec" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated"><strong class="jy hj">帮助:</strong>为密码工具提供帮助。</li><li id="3ec2" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated"><strong class="jy hj">生成:</strong>命令用于为已有的网络文件生成证书。</li><li id="1c32" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated"><strong class="jy hj"> showtemplate:显示模板</strong>命令以YAML格式显示网络模板。</li><li id="a677" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated"><strong class="jy hj">版本:</strong>显示密码二进制版本。</li><li id="59df" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated"><strong class="jy hj">扩展:</strong>扩展现有的网络配置文件，并向其中添加额外的组织。</li></ul><p id="8113" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">让我们使用cryptogen showtemplate命令创建一个网络文件，如下所示。</p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="e5a1" class="mb iz hi lx b fi mc md l me mf">cryptogen showtemplate &gt; mynetwork.yaml</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/0251160e5a733bd598a0e70bd1d2cbd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hdrQgRnG4WwsO309L-VFw.png"/></div></div></figure><p id="f6c2" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">在这里，我们可以看到我们的网络文件已经生成，它包含一个单独的订购者和两个组织配置。</p><blockquote class="ku kv kw"><p id="2c8c" class="jw jx kx jy b jz ky kb kc kd kz kf kg la lb kj kk lc ld kn ko le lf kr ks kt hb bi translated">注意:您可以随意修改mynetwork.yaml文件，并查看生成的证书的变化。我不打算解释网络文件的内容。</p></blockquote><h2 id="1066" class="mb iz hi bd ja mo mp mq je mr ms mt ji kh mu mv jm kl mw mx jq kp my mz ju na bi translated">让我们为该网络配置生成证书。</h2><p id="d144" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">现在我们使用<em class="kx"> cryptogen generate </em>命令为组织、订购者生成证书。</p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="f44c" class="mb iz hi lx b fi mc md l me mf">cryptogen generate --config=./mynetwork.yaml</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/d38c71edf9eb9d8198895aa36c1eb405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-2IeN4FriUdZOaqVcRseTg.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">Orderer certificates</figcaption></figure><p id="3039" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">在上图中，我们可以看到<strong class="jy hj">订单MSP </strong>生成，<strong class="jy hj">订单管理</strong>生成。</p><p id="b234" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated"><strong class="jy hj">让我们看看订单管理员的CA证书。</strong></p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="5847" class="mb iz hi lx b fi mc md l me mf">openssl x509 -in crypto-config/ordererOrganizations/example.com/users/Admin@example.com/msp/cacerts/ca.example.com-cert.pem -text</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/30ad5a2b0c7890d6f3dfa53f02d57b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xi-2yyP0LCcFAPK716A_GQ.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">CA-certificate</figcaption></figure><p id="7a09" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated"><strong class="jy hj">让我们看看订购者管理的TLS证书。</strong></p><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="f4bd" class="mb iz hi lx b fi mc md l me mf">openssl x509 -in crypto-config/ordererOrganizations/example.com/users/Admin@example.com/tls/ca.crt -text</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/b97d6d3067feaa3698650286438f4adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Jq_MckX2C6gEsY_UH4QAw.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">TLS-certificate</figcaption></figure><p id="badc" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">密码工具为我们做了很多工作。它创建了MSP和TLS证书。</p><p id="27e1" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">同样，它创建了Org1和Org2、MSP和TLS证书。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/e5b543f949b0b78946fa1d5707cb1931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8LHne-ZgmECzzKSaAhnCIg.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">Org1 AND Org2 MSP, TLS</figcaption></figure><h1 id="3e64" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">认证机构(CA)</h1><p id="e7f9" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">在区块链，每个希望与网络互动的演员都需要一个身份。正是CA提供了可验证的数字身份。</p><ul class=""><li id="6f1e" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">CA-admin/bootstrap identity创建身份证书请求。</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es im"><img src="../Images/bf412ecf30d04f0735e389202bcc9351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJx9zUWt5BeBd2iR9McnuQ.png"/></div><figcaption class="iu iv et er es iw ix bd b be z dx">Image source: Hyperledger Fabric official doc</figcaption></figure><ul class=""><li id="87a8" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">CA颁发数字证书，其中包含身份的私钥和公钥。(在cryptogen材料中，我们可以看到管理员用户有一些私有和公共密钥问题)</li><li id="06bb" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">类似地，我们必须向CA注册所有的对等用户、管理员和用户。(在cryptogen的情况下，该工具做了一切，这里我们必须手动生成)</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div class="er es ne"><img src="../Images/e734b2575f19a4326c076f892824143d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*Yw3z99pmOiWFL4AvhSJsPQ.png"/></div><figcaption class="iu iv et er es iw ix bd b be z dx">Image Source: Hyperledger Fabric official doc</figcaption></figure><ul class=""><li id="9edd" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">注册后，我们需要让他们注册以获得数字证书，并为我们的区块链网络构建MSP、TLS目录。</li></ul><p id="4e74" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated"><strong class="jy hj">托管/部署CA </strong></p><ul class=""><li id="1336" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">这里，我在本地主机上部署CA。您可以将其部署在生产/测试虚拟机中。</li><li id="bef0" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">克隆下面的存储库。</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="6343" class="mb iz hi lx b fi mc md l me mf"><strong class="lx hj">git clone </strong><a class="ae lv" href="https://github.com/cmjagtap/HLF-Certification-Generation" rel="noopener ugc nofollow" target="_blank"><strong class="lx hj">https://github.com/cmjagtap/HLF-Certification-Generation</strong></a></span></pre><ul class=""><li id="3840" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">使用以下命令部署并启动CA。</li></ul><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/549ae32a55d850fe82b6dfce4c556722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4zDyrZgJ3AJyQpmsgh5Fw.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">CA-deployment</figcaption></figure><h2 id="6f53" class="mb iz hi bd ja mo mp mq je mr ms mt ji kh mu mv jm kl mw mx jq kp my mz ju na bi translated">让我们为org1生成证书。</h2><p id="34b4" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">我们使用<strong class="jy hj"> fabric-ca-client </strong>二进制文件与CA-server进行交互。</p><p id="c12f" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">首先，我们必须注册CA的引导标识。</p><ul class=""><li id="9d7f" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">脚本<strong class="jy hj">1 _ register identities . sh</strong>用于注册CA-bootstrap身份并注册org1的身份。</li><li id="3785" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">导出<strong class="jy hj"> FABRIC_CA_CLIENT_HOME，</strong>该环境变量充当引导标识的MSP。</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="f7a6" class="mb iz hi lx b fi mc md l me mf">mkdir -p crypto-config-ca/peerOrganizations/org1.example.com</span><span id="dadd" class="mb iz hi lx b fi nf md l me mf">export FABRIC_CA_CLIENT_HOME=${PWD}/crypto-config-ca/peerOrganizations/org1.example.com</span><span id="06e3" class="mb iz hi lx b fi nf md l me mf">enrollCAAdmin() {</span><span id="4a7a" class="mb iz hi lx b fi nf md l me mf">fabric-ca-client enroll -u https://admin:adminpw@localhost:7054 --caname ca.org1.example.com --csr.names C=IN,ST=MH,L=Pune,O=org1,OU=peer  --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem<br/>}</span></pre><ul class=""><li id="40d6" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">然后我们使用带有x509证书的一些额外参数的<em class="kx"> enroll </em>命令。</li></ul><blockquote class="ku kv kw"><p id="7cf0" class="jw jx kx jy b jz ky kb kc kd kz kf kg la lb kj kk lc ld kn ko le lf kr ks kt hb bi translated">你可以在<a class="ae lv" href="https://hyperledger-fabric-ca.readthedocs.io/en/release-1.4/clientcli.html#fabric-ca-client-s-cli" rel="noopener ugc nofollow" target="_blank">官网</a>上探索，fabric-ca-client命令。</p></blockquote><ul class=""><li id="4ddc" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">登记所有的身份，我们需要组织。</li><li id="9941" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">在这里，我使用的是单一对等体和管理员身份</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="39b6" class="mb iz hi lx b fi mc md l me mf">registerIdentities() {</span><span id="4544" class="mb iz hi lx b fi nf md l me mf">fabric-ca-client register --caname ca.org1.example.com --id.name peer0 --id.secret peer0pw --id.type peer --csr.names C=IN,ST=MH,L=Pune,O=$orgname,OU=peer  --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem</span><span id="281a" class="mb iz hi lx b fi nf md l me mf">fabric-ca-client register --caname ca.org1.example.com --id.name org1admin --id.secret org1adminpw --id.type admin --csr.names C=IN,ST=MH,L=Pune,O=$orgname,OU=admin  --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem</span><span id="880a" class="mb iz hi lx b fi nf md l me mf">}</span></pre><p id="a3b4" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">执行脚本后，您将看到下面的输出。</p><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/5c91176c0415afcb6067ac92b7d39d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l0AM0jvl9Dpzn-3I_LnAUw.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">Register Identities</figcaption></figure><p id="750e" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">我们可以看到我们的身份被注册了。</p><p id="00dd" class="pw-post-body-paragraph jw jx hi jy b jz ky kb kc kd kz kf kg kh lb kj kk kl ld kn ko kp lf kr ks kt hb bi translated">让我们为peer0，admin生成MSP和TLS</p><ul class=""><li id="63d4" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">脚本<strong class="jy hj"> 2_generateMSP.sh </strong>用于生成peer0的MSP、admin和peer0的TLS。</li><li id="874e" class="lg lh hi jy b jz lp kd lq kh lr kl ls kp lt kt lu lm ln lo bi translated">MSP和TLS的生成看起来是一样的。但是，在注册TLS时，我们必须添加一个额外的标志— <strong class="jy hj">注册。配置文件tls </strong>。</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="1951" class="mb iz hi lx b fi mc md l me mf">fabric-ca-client enroll -u https://peer0:peer0pw@localhost:7054 --caname ca.org1.example.com -M ${PWD}/crypto-config-ca/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp  --csr.names C=IN,ST=MH,L=Pune,O=org1,OU=peer  --csr.hosts peer0.org1.example.com --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem</span><span id="7ce4" class="mb iz hi lx b fi nf md l me mf">fabric-ca-client enroll -u https://peer0:peer0pw@localhost:7054 --caname ca.org1.example.com -M ${PWD}/crypto-config-ca/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls --enrollment.profile tls  --csr.names C=IN,ST=MH,L=Pune,O=org1,OU=peer  --csr.hosts peer0.org1.example.com --csr.hosts localhost --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem</span></pre><ul class=""><li id="8e46" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">注册组织1管理员</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="7888" class="mb iz hi lx b fi mc md l me mf">fabric-ca-client enroll -u https://org1admin:org1adminpw@localhost:7054 --caname ca.org1.example.com -M ${PWD}/crypto-config-ca/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp  --csr.names C=IN,ST=MH,L=Pune,O=org1,OU=admin  --tls.certfiles ${PWD}/fabric-ca/org1/tls-cert.pem</span></pre><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/685c62e9427c353cbe193fb3b4369ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNvo-7PTGQtID5GtIt3dzw.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">MSP generation</figcaption></figure><figure class="in io ip iq fd ir er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/3585194e569b33b83991a2f5302360e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJrh1Q7LJU6TR7MH-i5_uA.png"/></div></div><figcaption class="iu iv et er es iw ix bd b be z dx">Peer0 signcert</figcaption></figure><blockquote class="ku kv kw"><p id="eb8f" class="jw jx kx jy b jz ky kb kc kd kz kf kg la lb kj kk lc ld kn ko le lf kr ks kt hb bi translated">注意:我们必须手动生成MSP和TLS请求。这里，我对MSP和TLS都使用单个CA，您可以托管另一个CA来生成TLS。</p></blockquote><ul class=""><li id="2ea5" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">同样，我们必须为所有组织和订购者生成MSP、TLS证书。</li></ul><h1 id="d745" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">打扫</h1><ul class=""><li id="60a3" class="lg lh hi jy b jz ka kd ke kh li kl lj kp lk kt lu lm ln lo bi translated">执行以下命令删除CA-docker容器及其卷</li></ul><pre class="in io ip iq fd lw lx ly lz aw ma bi"><span id="21ba" class="mb iz hi lx b fi mc md l me mf">docker-compose -f ca-org1.yaml down -v</span></pre><ul class=""><li id="07d6" class="lg lh hi jy b jz ky kd kz kh nb kl nc kp nd kt lu lm ln lo bi translated">删除生成的加密配置目录。</li></ul><h1 id="588f" class="iy iz hi bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">摘要</h1><p id="83d5" class="pw-post-body-paragraph jw jx hi jy b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt hb bi translated">我们已经看到，cryptogen工具如何工作，并帮助我们建立一个更快的测试HLF网络。此外，我们还研究了HLF CA，并完成了为组织生成MSP和TLS的注册流程。</p></div></div>    
</body>
</html>
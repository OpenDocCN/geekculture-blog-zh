<html>
<head>
<title>Implementing LeNet architecture using the research paper</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用研究论文实施LeNet架构</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/implementing-lenet-architecture-using-the-research-paper-d780acf02e1e?source=collection_archive---------28-----------------------#2021-06-01">https://medium.com/geekculture/implementing-lenet-architecture-using-the-research-paper-d780acf02e1e?source=collection_archive---------28-----------------------#2021-06-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a09f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阅读研究论文可能非常具有挑战性。这种语言本身很难理解，更糟糕的是，它可能包含一些方程式和算法，看起来像是某种莫名其妙的手稿。别担心，我会保护你的(很明显！).我们将看看LeNet(特别是LeNet-5)CNN架构，并使用其研究论文从头开始实现它。</p><h1 id="fd76" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><span class="l kb kc kd bm ke kf kg kh ki di">我</span> <strong class="ak">简介</strong></h1><p id="3aee" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">LeNet是第一个推广卷积神经网络概念的CNN架构之一。它的最终版本LeNet-5是由人工智能巨头Yann LeCun，Yoshua Bengio，Leon Bottou和Patrick Haffner在1998年推出的。该研究论文名为“基于梯度的学习应用于文档识别”。点击可以阅读<a class="ae ko" href="http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf" rel="noopener ugc nofollow" target="_blank">原文。我强烈建议你浏览一下报纸。</a></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es kp"><img src="../Images/52585aa37d62bbcaba5b7e734df629a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYmEkw5m8ryKmjg2qQjHuw.jpeg"/></div></div></figure><h1 id="9ad7" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">LeNet的影响</strong></h1><p id="c8d4" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">LeNet被认为是所有convnets之父。它是在1989年提出的，经过多年的研究，最终版本在1998年以LeNet-5的名称发布。它被用来识别每天数百万张支票上的手写数字。</p><p id="ad4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当时，深度学习领域非常休眠，没有人再对神经网络感兴趣。神经网络研究的所有资金都被切断了，那段灰暗的时期被称为人工智能冬天。但是LeNet-5的成功再次启动了深度学习领域的研究。人们开始对神经网络感兴趣，并开始意识到它的潜力。LeNet是第一个将反向传播算法用于实际应用的神经网络架构。</p><p id="b53c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们今天认为理所当然的所有概念，如反向传播、共层和共网等。因为LeNet而成为焦点。在某种意义上，我们可以说现代深度学习时代的灵感和真正的基础都来自于LeNet。</p><h1 id="de78" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">建筑</strong></h1><p id="cdd3" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">LeNet-5的架构非常简单。它由3个卷积层(1个输入层)、2个汇集层和3个密集层(1个输出层)组成。它接受一个28x28的图像作为输入，并给出一个大小为10的列表的输出，该列表由每个类别的概率组成。</p><p id="2f91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为LeNet主要用于识别手写数字，所以它可以识别数字0-9。因此，模型的输出中有10个类。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lb"><img src="../Images/8ffdead10cde081d682e136f130c020c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkA-lprl9STk-Hb1BjJ1wQ.jpeg"/></div></div></figure><p id="73b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">激活功能:</strong> Tanh</p><p id="7898" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">集中:</strong>平均集中</p><p id="028d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">内核大小</strong> : 5x5</p><p id="20ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步幅:</strong> 1，1</p><p id="1cc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">填充:</strong> 0，0</p><h1 id="9a9b" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">代号</strong></h1><p id="4562" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在本教程中，我们将使用Pytorch库。你可以使用任何你选择的深度学习库。</p><figure class="kq kr ks kt fd ku"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="le lf et er es lg lh bd b be z dx">importing the torch library</figcaption></figure><p id="7bf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经导入了火炬库。<strong class="ih hj"> <em class="li"> torch.nn </em> </strong>拥有构建架构所需的所有层和激活功能。</p><figure class="kq kr ks kt fd ku"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="le lf et er es lg lh bd b be z dx">defining the network</figcaption></figure><p id="01a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们正在建立我们的神经网络。因为Pytorch是建立在OOPs概念之上的，我们需要为我们的神经网络定义一个类。</p><p id="3241" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">__init__(self)构造函数将帮助我们在一个地方定义卷积层、线性层、池层和激活函数。一旦完成了层的定义，我们将继续实现我们的向前传递。</p><p id="e4d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了实现向前传递，我们需要定义一个forward()函数。函数名必须是“forward ”,这一点很重要，因为这是Pytorch隐式使用的名称。</p><figure class="kq kr ks kt fd ku"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="le lf et er es lg lh bd b be z dx">testing the output</figcaption></figure><p id="02cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将测试我们的模型，看看它是否产生了预期的输出。我们定义了一个1x32x32尺寸的数组，其中1是通道，32x32是图像的高x宽。由于这个图像是用随机数生成的，所以会很嘈杂。事实上，我们也可以使用任何大小为32x32的真实图像。<strong class="ih hj"> <em class="li"> model = LeNet() </em> </strong>将创建我们模型的一个实例。<strong class="ih hj"> <em class="li"> x = model(x) </em> </strong>将我们的图像馈送给模型，模型应该生成一个大小为10的数组。</p><figure class="kq kr ks kt fd ku"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="le lf et er es lg lh bd b be z dx">printing the size and values of the output</figcaption></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="er es lj"><img src="../Images/747daf8243ffddcafce32b9657ceb905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Bs21AD2IKIrsB1AIephBQ.png"/></div></div></figure><p id="f26c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到我们的模型生成了一个大小为10的数组。在打印数组时，我们看到它是一个包含10个输出概率的张量。张量只不过是数组的一般形式。一个整数，二维数组，三维数组或者任何一个n维数组都可以称为张量。在这种情况下，它是一个1x10张量。</p><p id="f370" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是本教程的完整代码。</p><figure class="kq kr ks kt fd ku"><div class="bz dy l di"><div class="lc ld l"/></div><figcaption class="le lf et er es lg lh bd b be z dx">the complete code</figcaption></figure><h1 id="d0cf" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">后续步骤</h1><p id="45a1" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">在这段代码中，我们只定义了LeNet-5的架构。我鼓励你从这个代码中创建一个成熟的培训管道。</p><ol class=""><li id="5e38" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated">向此代码添加训练循环</li><li id="6a3d" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">使用MNIST手写数字数据集进行训练</li><li id="b911" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">从头开始训练网络</li><li id="def6" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">创建一个实时数字分类工具</li></ol><p id="6a2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成上面提到的步骤会让你大量接触深度学习的应用方面，希望你会在这个过程中学到很多。</p><h1 id="ea69" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">遗言！</h1><p id="1ede" class="pw-post-body-paragraph if ig hi ih b ii kj ik il im kk io ip iq kl is it iu km iw ix iy kn ja jb jc hb bi translated">我希望你喜欢这篇教程，并学会了如何用代码实现一篇研究论文。LeNet不仅仅是一个神经网络，它也是像我们这样的新手进入应用研究领域的入门。让我们花一分钟时间来欣赏一下这个看似简单的模型是如何一劳永逸地改变了深度学习领域的。</p></div></div>    
</body>
</html>
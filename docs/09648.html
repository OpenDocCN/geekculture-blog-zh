<html>
<head>
<title>Will it rain tomorrow in Australia ? : An end-to-end and a novice implementation of Decision Tree and Random Forest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">澳大利亚明天会下雨吗？:决策树和随机森林的端到端和新手实现</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/will-it-rain-tomorrow-in-australia-65d0eb1ab42?source=collection_archive---------12-----------------------#2021-12-21">https://medium.com/geekculture/will-it-rain-tomorrow-in-australia-65d0eb1ab42?source=collection_archive---------12-----------------------#2021-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/f2d1bf22d291ebfd44c2a6011ce4ee9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aRPh8cHPeJmj6MZPO9Ry2w.jpeg"/></div></div></figure><h1 id="7e6a" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">概观</h1><p id="51ba" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">决策树和随机森林是机器学习实现领域中最常用的算法。此外，它们在分类和回归问题上做得最好。这篇博文是这两种算法的端到端实现，但是是新手实现。</p><h1 id="fae4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">目标</h1><p id="4c88" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">假设澳大利亚气象部门希望根据历史数据预测明天是否会下雨。这个预测要么是肯定的——会下雨，要么是否定的——不会下雨。</p><p id="2458" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">通常，即使不是这方面的专家，我们也知道如果</p><ul class=""><li id="6473" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated">这是一个雨季</li><li id="8380" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">当我们看到天空中的乌云时</li><li id="76c9" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">当我们有高温时</li><li id="c632" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">位置</li><li id="7fb7" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">蒸发</li></ul><p id="b73d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">等等。</p><p id="2ef5" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">我们将使用这些特性来解决这个分类问题。</p><h1 id="73c4" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">资料组</h1><p id="c1f2" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我们使用了公开可用的<a class="ae lf" href="https://www.kaggle.com/jsphyg/weather-dataset-rattle-package" rel="noopener ugc nofollow" target="_blank"> Kaggle数据集</a>，它拥有从2008年到2017年10年的天气数据的近15万条记录。我们数据集包含以下字段—</p><ul class=""><li id="fd84" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated"><em class="lg">日期</em> —不言自明</li><li id="0cde" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">位置</em> —我们有数据的城市</li><li id="0775" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">最小温度和最大温度</em> —一天中的最低和最高温度</li><li id="8ef5" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">降雨量</em> —当天记录的降雨量</li><li id="cfd2" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">蒸发量</em>——24小时至上午9点的所谓A级蒸发皿蒸发量(毫米)</li><li id="cedc" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">日照</em> —一天中日照充足的小时数。</li><li id="7ab5" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">wind gustdir</em>——24小时至午夜最强阵风的方向</li><li id="ae82" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">风速</em>——24小时至午夜最强阵风的速度(km/h)</li><li id="6f8c" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">上午9点风</em>——上午9点的风向</li><li id="3d13" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">下午3点风向</em>——下午3点的风向</li><li id="3f64" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">风速上午9点</em>——上午9点前10分钟的平均风速(千米/小时)</li><li id="aabf" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">风速上午3点</em>——下午3点前10分钟内的平均风速(千米/小时)</li><li id="b87a" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">上午9点的湿度</em> —上午9点的湿度(百分比)</li><li id="42c4" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">下午3点的湿度</em> —下午3点的湿度(百分比)</li><li id="3f8c" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">压力上午9点</em> —大气压力(hpa)在上午9点降低到平均海平面</li><li id="6de8" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">压力下午3点</em>——大气压力(hpa)在下午3点降低到平均海平面</li><li id="d957" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">上午9点的云</em>——上午9点被云遮住的天空部分。这是用“奥克塔”来衡量的，奥克塔是八分之一的单位。它记录了天空的八分之几被云遮住了。0表示天空完全晴朗，而8表示天完全阴沉。</li><li id="abe3" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">下午3点的云</em>——下午3点被云遮住的天空比例(单位为“八分之一”)。有关这些值的描述，请参见Cload9am</li><li id="646a" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">上午9点—上午9点的温度(摄氏度)</li><li id="b2bb" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg">下午三点</em> —下午三点的温度(摄氏度)</li><li id="c75a" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg"> RainToday </em> -Boolean: 1如果24小时到上午9点的降雨量(mm)超过1mm，否则为0</li><li id="e0e0" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><em class="lg"> RainTomorrow </em> —下一天的降雨量，单位为毫米，用于创建响应变量RainTomorrow。一种对“风险”的衡量。</li></ul><h1 id="a500" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">功能方法</h1><p id="ae8e" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">作为一名数据科学家，首先必须了解数据集中所有可用的特征，它们是如何影响明天降雨的预测的。此外，当数据科学家投身于问题实现时，他/她必须—</p><ul class=""><li id="8d50" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated">对数据执行描述性分析，以了解数据集中可用的各种要素</li><li id="3eb3" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">执行数据清理以处理数据集中缺失的值</li><li id="43ee" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">分析现有数据/特征的模式和对目标列的影响，即RainTomorrow</li><li id="bbab" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">执行标签编码</li><li id="17bd" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">使用默认参数训练决策树分类器算法，并针对训练、测试和验证数据评估模型性能</li><li id="d131" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">使用超参数调整提高模型性能</li><li id="4eb1" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">使用默认参数训练RandomForestClassifier算法并评估模型性能</li><li id="77ae" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">使用超参数调整提高模型性能</li></ul><h1 id="3a35" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">步伐</h1><p id="804f" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">作为实施的一部分，必须遵循以下步骤—</p><ul class=""><li id="4f4e" class="kr ks hi jq b jr km jv kn jz kt kd ku kh kv kl kw kx ky kz bi translated">设置开发环境，安装并导入所需的库</li><li id="4783" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">下载数据集</li><li id="4e7c" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">执行探索性数据分析</li><li id="b6d0" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">为培训准备数据—处理缺失值、标签编码、标准化等。</li><li id="898b" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">为培训、测试和验证拆分数据</li><li id="7673" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">训练决策树分类器并评估模型性能</li><li id="9391" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated">训练RandomForestClassifier并评估模型性能</li></ul><h1 id="c494" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">使用的技术和库</h1><ul class=""><li id="beb3" class="kr ks hi jq b jr js jv jw jz lh kd li kh lj kl kw kx ky kz bi translated"><strong class="jq hj"> <em class="lg">编程语言</em> </strong> — Python3</li><li id="e267" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> <em class="lg">数据科学库</em> </strong> — pandas、numpy、matplotlib、seaborn</li><li id="d4a3" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> <em class="lg">机器学习库</em> </strong> — sklearn</li><li id="af02" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> <em class="lg">运行环境</em> </strong> — Google Colab和Kaggle笔记本</li><li id="8f1d" class="kr ks hi jq b jr la jv lb jz lc kd ld kh le kl kw kx ky kz bi translated"><strong class="jq hj"> <em class="lg">训练算法</em> </strong> —决策树分类器和随机森林分类器</li></ul><h1 id="7ac7" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">笔记本—完成逐步执行</h1><p id="db53" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我的<a class="ae lf" href="https://www.kaggle.com/aashaymaheshwari/predict-rain-tomorrow-in-australia/notebook" rel="noopener ugc nofollow" target="_blank"> Kaggle笔记本</a>上有完整的分步执行。</p><h1 id="a7c5" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">总结</strong></h1><h2 id="859d" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated"><strong class="ak">带有默认参数的决策树分类器</strong></h2><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/ed0c32d966244ca8be529fc98762c853.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*m8LOSVqrEAKCDFj26vjbvw.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">Performance of DecisionTreeClassifier with default parameters</figcaption></figure><p id="b00d" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">上述案例是一个<strong class="jq hj">过度拟合案例，因为采油树使用了最大深度并记忆了数值，未能以77 %的低精度预测测试和验证数据集</strong></p><figure class="lz ma mb mc fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/739fbec6056031ab2d005ad6cd0b3bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I4C4-VZSxVGhrREt97jTzw.png"/></div></div><figcaption class="md me et er es mf mg bd b be z dx">The decision tree we got</figcaption></figure><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/b0d24f2184deb84a23023fe3ca13c7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*SkKgf_ZmFm3lEYwMLcTvCA.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">Feature importance</figcaption></figure><h2 id="eecc" class="lk ir hi bd is ll lm ln iw lo lp lq ja jz lr ls je kd lt lu ji kh lv lw jm lx bi translated">最大深度为<strong class="ak"> = </strong> 4的决策树分类器</h2><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/67c8566eecf977d57f2cf0ca180ce34d.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*qW8Jfa-zg09EEdluvJajtA.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">Performance of model with hyperparameter tuning</figcaption></figure><p id="b315" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">对于新的预测，上述性能明显更好，因为训练数据、测试数据和验证数据的准确性几乎相同</p><figure class="lz ma mb mc fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/2913984960e64766892f69d8a8f9b009.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*VKcYQzXZMph8LeAbQIo6Dg.png"/></div><figcaption class="md me et er es mf mg bd b be z dx">Confusion matrix</figcaption></figure><h1 id="1a0d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="83dd" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">使用决策树，我们能够以83%的准确率进行预测。这个笔记本还有一个RandomForest的实现，我想请你看一下。</p><p id="896b" class="pw-post-body-paragraph jo jp hi jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl hb bi translated">sklearn最了解超参数的价值，但它有时在特定用例中失败，并让数据科学家来调整超参数。决策树和随机森林总是有过度拟合的风险。</p><h1 id="a2de" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">更新</h1><p id="167b" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">我会尽量更新笔记本的版本，增加更多的型号评测细节。</p></div></div>    
</body>
</html>
<html>
<head>
<title>How to Read Data From Excel File Using Apache POI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Apache POI从Excel文件中读取数据</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-read-data-from-excel-file-using-apache-poi-95b8a4aa3909?source=collection_archive---------1-----------------------#2021-04-10">https://medium.com/geekculture/how-to-read-data-from-excel-file-using-apache-poi-95b8a4aa3909?source=collection_archive---------1-----------------------#2021-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fa5ad55c2447ac6cb7c305314ac86c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkLVt58dZ529qXV55m3egQ.png"/></div></div></figure><p id="e376" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在测试自动化中，根据您的需要，有几种框架可供选择来在您的项目中实现。其中之一是数据驱动的框架。在这个框架中，测试数据存储在单个数据源或数据源组合中，如。csv，。xls。xlsx、数据库、直接来自google sheets等等。这样，您应该有一个实用程序来从这些数据源中提取或读取数据。在本文中，我们将讨论如何从excel文件中读取数据，特别是使用。xlsx扩展名。</p><p id="4068" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从…读取数据。xlsx文件，我们将使用由<a class="ae jo" href="https://poi.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Poi </a>提供的poi-ooxml。要将它添加到您的maven项目中，请检查他们的<a class="ae jo" href="https://mvnrepository.com/artifact/org.apache.poi/poi-ooxml" rel="noopener ugc nofollow" target="_blank"> maven资源库</a>。下面是我们将使用的类，链接到它们的文档。</p><ol class=""><li id="e93d" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/xssf/usermodel/XSSFWorkbook.html" rel="noopener ugc nofollow" target="_blank">T5】xssf workbookT7】</a></li><li id="18a1" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/xssf/usermodel/XSSFSheet.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> XSSFSheet </strong> </a></li><li id="7290" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/Row.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">行</strong> </a></li><li id="27ff" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/Cell.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">单元格</strong> </a></li><li id="4832" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/CellType.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> CellType </strong> </a>(这是一个枚举)</li><li id="7b1d" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated"><a class="ae jo" href="https://poi.apache.org/apidocs/dev/org/apache/poi/ss/usermodel/DataFormatter.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj">数据格式器</strong> </a></li></ol><p id="9db6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里有一个简单的方法来读取excel表中的所有数据。全部读取，意味着空单元格也包括在内。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="31e6" class="km kn hi ki b fi ko kp l kq kr">public static String[][] getDataFromSheet(String workbookLocation, String workSheetName) throws IOException {</span><span id="2041" class="km kn hi ki b fi ks kp l kq kr">    XSSFWorkbook workbook = new XSSFWorkbook(System.<em class="kt">getProperty</em>("user.dir") + "/" + workbookLocation);<br/>    XSSFSheet workSheet = workbook.getSheet(workSheetName);<br/><br/>    int noOfRows = workSheet.getLastRowNum() + 1;<br/>    int noOfColumns = workSheet.getRow(0).getLastCellNum();<br/>    String[][] dataTable = new String[noOfRows][noOfColumns];<br/><br/>    for (int i = workSheet.getFirstRowNum(); i &lt; workSheet.getLastRowNum() + 1; i++) {<br/>        Row row = workSheet.getRow(i);<br/>        for (int j = row.getFirstCellNum(); j &lt; row.getLastCellNum(); j++) {<br/>            Cell cell = row.getCell(j);<br/>            dataTable[i][j] = cell.getStringCellValue();<br/>        }<br/>    }<br/><br/>    workbook.close();<br/>    return dataTable;<br/>}</span></pre><p id="6a99" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们创建了一个XSSFWorkbook对象，并将其命名为<strong class="is hj"> <em class="kt"> workbook </em> </strong>。向其构造函数传递。xlsx文件。请注意，XSSFWorkbook构造函数抛出了IOException。<strong class="is hj"> <em class="kt">工作簿</em> </strong>对象是我们的表示。xlsx文件，包含我们将从中读取数据的excel表。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1038" class="km kn hi ki b fi ko kp l kq kr">XSSFWorkbook workbook = new XSSFWorkbook(System.<em class="kt">getProperty</em>("user.dir") + "/" + workbookLocation);</span></pre><p id="55d9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">其次，使用可通过<strong class="is hj"> <em class="kt">工作簿</em> </strong>对象访问的<strong class="is hj"> getSheet() </strong>方法，我们传递excel工作表的名称以从我们的<strong class="is hj"> <em class="kt">工作簿</em> </strong>中获取XSSFSheet，并将其命名为<strong class="is hj"> <em class="kt">工作表。</em></strong><strong class="is hj"><em class="kt">工作表</em> </strong>代表我们的excel表。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="75ef" class="km kn hi ki b fi ko kp l kq kr">XSSFSheet workSheet = workbook.getSheet(workSheetName);</span></pre><p id="0824" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第三，我们创建了一个二维字符串数组，并将其命名为<strong class="is hj"> <em class="kt"> dataTable。</em> </strong>注意我们如何设置<strong class="is hj"> <em class="kt">数据表</em> </strong>的大小来匹配excel表格的大小。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="b33e" class="km kn hi ki b fi ko kp l kq kr">int noOfRows = workSheet.getLastRowNum() + 1;<br/>int noOfColumns = workSheet.getRow(0).getLastCellNum();<br/>String[][] dataTable = new String[noOfRows][noOfColumns];</span></pre><p id="0f5e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于<strong class="is hj"><em class="kt">nooforus，</em> </strong>我们使用了<strong class="is hj"> getLastRowNum()。</strong>该方法返回工作表中最后一行的从零开始的索引，包括空行。假设我们有10行，这将返回9，这就是为什么我们增加了1。</p><p id="9c0b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于<strong class="is hj"> <em class="kt"> noOfCoumns </em> </strong>，我们通过将0传递给<strong class="is hj"> <em class="kt"> getRow() </em> </strong>方法来获取<strong class="is hj"> <em class="kt">工作表</em> </strong>中的第一行。<strong class="is hj"> <em class="kt"> getRow() </em> </strong>返回一个<strong class="is hj">行</strong>对象。然后我们得到该行最后一个单元格的编号。<strong class="is hj"> <em class="kt"> getLastCellNum()，</em> </strong>根据文档，它已经给最后一个单元格的索引加了1，这就是为什么我们没有像在<strong class="is hj"> <em class="kt"> noOfRows中那样加1。</em>T57】</strong></p><p id="ca31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">第四，我们从我们的<strong class="is hj"> <em class="kt">工作表</em> </strong>中读取数据，并将其保存到<strong class="is hj"> <em class="kt"> </em> </strong>到<strong class="is hj"> <em class="kt">数据表中。</em> </strong></p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="44dd" class="km kn hi ki b fi ko kp l kq kr">for (int i = workSheet.getFirstRowNum(); i &lt; workSheet.getLastRowNum() + 1; i++) {<br/>    Row row = workSheet.getRow(i);<br/>    for (int j = row.getFirstCellNum(); j &lt; row.getLastCellNum(); j++) {<br/>        Cell cell = row.getCell(j);<br/>        dataTable[i][j] = <em class="kt">getCellValueAsString</em>(cell);<br/>    }<br/>}</span></pre><p id="f916" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在这里做的只是迭代我们的<strong class="is hj"> <em class="kt">工作表</em> </strong>的每一行。然后在每一行上，我们再次迭代以获得每个单元格的值，并将其保存到我们的<strong class="is hj"> <em class="kt">数据表</em> </strong>。注意方法调用<strong class="is hj"><em class="kt">getCellValueAsString</em>(单元格)。这是我们需要创造的另一种方法。这将只检查单元格中值的类型，并将值作为字符串返回。我们可以像下面这样做。</strong></p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1045" class="km kn hi ki b fi ko kp l kq kr">dataTable[i][j] = cell.getStringCellValue();</span></pre><p id="4311" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果工作表只包含字符串值，这是可以的。但是例如单元格包含一个数字，它会抛出一个异常。</p><p id="1e43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是我们的<strong class="is hj"><em class="kt">getCellValueAsString</em>()</strong>方法的代码。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="dddd" class="km kn hi ki b fi ko kp l kq kr">private static String getCellValueAsString(Cell cell) {<br/>    CellType cellType = cell.getCellType();<br/>    String val = "";<br/><br/>    switch (cellType) {<br/>        case <em class="kt">STRING</em>:<br/>            val = cell.getStringCellValue();<br/>            break;<br/><br/>        case <em class="kt">NUMERIC</em>:<br/>            DataFormatter dataFormatter = new DataFormatter();<br/>            val = dataFormatter.formatCellValue(cell);<br/>            break;<br/><br/>        case <em class="kt">BOOLEAN</em>:<br/>            val = String.<em class="kt">valueOf</em>(cell.getBooleanCellValue());<br/>            break;<br/><br/>        case <em class="kt">BLANK</em>:<br/>            break;<br/>    }<br/>    return val;<br/>}</span></pre><p id="dd93" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，当我们从工作簿中读取完数据后。我们关闭工作簿并返回数据表。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="c0ec" class="km kn hi ki b fi ko kp l kq kr">workbook.close();<br/>return dataTable;</span></pre><p id="97c2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们尝试使用我们的<strong class="is hj"> getDataFromSheet() </strong>方法从Excel文件中读取数据。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/9f3b836792cc64f5730261e3e9270dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTxiUCP1O7QoxruEc0NtJw.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Sample Data in our excel sheet.</figcaption></figure><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/d5e429a73b04b0ade29b14eddec65ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iRn-Gh5b9hmFFibiHwpAqw.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Sample code using the getDataFromSheet() method</figcaption></figure><p id="e219" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图显示了我们如何使用<strong class="is hj"> getDataFromSheet() </strong>方法。我们传递了excel文件的路径和数据将来自的工作表的名称。下图显示了我们从excel文件中读取的打印数据。</p><figure class="kd ke kf kg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es la"><img src="../Images/475697369723861a1d704343fc63ee13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTNXCCyyAyf-Q0cYKoMtdQ.png"/></div></div></figure><p id="c495" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们用来显示数据的打印方法的代码。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="b6e3" class="km kn hi ki b fi ko kp l kq kr">public static void printData(String[][] table) {<br/>    for (String[] strings : table) {<br/>        for (String string : strings) {<br/>            if (string.equals("")) {<br/>                System.<em class="kt">out</em>.print("&lt;empty cell&gt;");<br/>            } else {<br/>                System.<em class="kt">out</em>.print(string);<br/>            }<br/>            System.<em class="kt">out</em>.print(" | ");<br/>        }<br/>        System.<em class="kt">out</em>.println(" ");<br/>    }<br/>}</span></pre><p id="15cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们创建的<strong class="is hj"> getDataFromSheet() </strong>方法是一个简单直接的解决方案，可以满足我们从excel文件中读取数据的需求。既然您已经熟悉了这些类、一些方法，并且已经知道要检查哪些文档。根据你的需要创建你的更复杂的方法起初会是一个挑战，但是一旦你开始动手，它就会变得轻松。</p><p id="179a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi">🍻 🍻 🍻</p></div></div>    
</body>
</html>
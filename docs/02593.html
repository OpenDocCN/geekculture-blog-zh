<html>
<head>
<title>Walk Through: Google Map Platform 101 in Android — Ktx Update</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">漫游:Android中的谷歌地图平台101—Ktx更新</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/walk-through-google-map-platform-101-in-android-7c72a4dd40e3?source=collection_archive---------5-----------------------#2021-05-21">https://medium.com/geekculture/walk-through-google-map-platform-101-in-android-7c72a4dd40e3?source=collection_archive---------5-----------------------#2021-05-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a9b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将使用Codelab中的练习。然而，它的说明是<strong class="ih hj">而不是</strong>用户友好的，你可能在开始时得到一个空白屏幕。</p><p id="560c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👹:什么D！他#$！</p><p id="e6ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">日志目录:</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="fb69" class="jr js hi jg b fi jt ju l jv jw">E/Google Maps Android API: <strong class="jg hj">Authorization failure.</strong>  Please see https://developers.google.com/maps/documentation/android-api/start for how to correctly set up the map.<br/>E/Google Maps Android API: In the Google Developer Console (https://console.developers.google.com)<br/>    <strong class="jg hj">Ensure that the "Google Maps Android API v2" is enabled.</strong><br/>    <strong class="jg hj">Ensure that the following Android Key exists:</strong><br/>     API Key: {GOOGLE_MAPS_API_KEY}<br/>     Android Application (&lt;cert_fingerprint&gt;;&lt;package_name&gt;): YOUR_SHA1;com.homan.huang.mapdemo</span></pre><p id="eaf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">放心吧！我会帮你解决这个问题。我们开始吧。</p><h1 id="f2db" class="jx js hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">— ===菜单=== —</h1><p id="c534" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated"><strong class="ih hj">👊1.</strong> <a class="ae jh" href="#5245" rel="noopener ugc nofollow"> <strong class="ih hj">生成API密钥</strong> </a> <strong class="ih hj"> <br/>💰2.</strong> <a class="ae jh" href="#3ad7" rel="noopener ugc nofollow"> <strong class="ih hj">启用计费</strong> </a> <strong class="ih hj"> <br/>🔗3.</strong> <a class="ae jh" href="#854e" rel="noopener ugc nofollow"> <strong class="ih hj">链接API键到地图项目</strong> </a> <strong class="ih hj"> <br/> ✒️4.</strong> <a class="ae jh" href="#8ff6" rel="noopener ugc nofollow"> <strong class="ih hj">启动项目</strong></a><strong class="ih hj"><br/></strong>✔<strong class="ih hj">…………..</strong>💯<a class="ae jh" href="#869d" rel="noopener ugc nofollow"> <em class="ji">谷歌云支持</em> </a> <strong class="ih hj"> <br/> 🖍 5。</strong> <a class="ae jh" href="#12cd" rel="noopener ugc nofollow"> <strong class="ih hj">插入标记</strong> </a> <strong class="ih hj"> <br/>🎱 6.</strong> <a class="ae jh" href="#6083" rel="noopener ugc nofollow"> <strong class="ih hj">自定义标记</strong> </a> <strong class="ih hj"> <br/>🎳 7.</strong> <a class="ae jh" href="#1047" rel="noopener ugc nofollow"> <strong class="ih hj">标记簇→重叠标记组</strong> </a> <strong class="ih hj"> <br/>🎨 8.</strong> <a class="ae jh" href="#e2cb" rel="noopener ugc nofollow"> <strong class="ih hj">在地图上绘制</strong> </a> <strong class="ih hj"> <br/>📷 9.</strong> <a class="ae jh" href="#fc97" rel="noopener ugc nofollow"> <strong class="ih hj">摄像机控制</strong> </a> <strong class="ih hj"> <br/>🚀 10.</strong> <a class="ae jh" href="#8250" rel="noopener ugc nofollow"> <strong class="ih hj"> KTX升级</strong> </a> <strong class="ih hj"> <br/> </strong>🤐<strong class="ih hj"> 11。</strong> <a class="ae jh" href="#ecdd" rel="noopener ugc nofollow"> <strong class="ih hj">秘密升级</strong> </a></p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="5245" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">👊1.生成API键…… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><blockquote class="ll lm ln"><p id="214b" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">谷歌云平台:<a class="ae jh" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/</a></p></blockquote><p id="fef1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建一个项目:<code class="du jd je jf jg b"><strong class="ih hj">Map Demo</strong></code></p><p id="e35b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加API:<code class="du jd je jf jg b"><strong class="ih hj">Maps Static API</strong></code><strong class="ih hj"/><code class="du jd je jf jg b"><strong class="ih hj">Maps SDK for Android</strong></code><code class="du jd je jf jg b"><strong class="ih hj">Places</strong></code></p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es lr"><img src="../Images/202b927e87de795160c595f2894f4817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2KaPmWlzHynsK_07tv8GQ.png"/></div></div></figure><p id="a50d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据我的测试，这些API在我第一次运行时得到响应。</p><blockquote class="ll lm ln"><p id="f481" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">资格证书</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es lz"><img src="../Images/46df1376a95ff62ab283aa940c87e352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*OZ3r8BElrrHLi-kUM3ICSg.png"/></div></figure><blockquote class="ll lm ln"><p id="a98e" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">创建凭据</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es ma"><img src="../Images/816fe1e94b81b7c69083809f7049ab68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*cGl521UzfJTCPGWTJcmCew.png"/></div></figure><blockquote class="ll lm ln"><p id="591d" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">API密钥</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mb"><img src="../Images/9ad8c8bb2864a570cfdbe712b53eb355.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*mZXNkxhhbGSPgqhbSECpZw.png"/></div></figure><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mc"><img src="../Images/79124e18e383619189850ea407f668d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*PNPHnDo9Ec2aXTXPgPX-rw.png"/></div></figure><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es md"><img src="../Images/afe949b4ef03c56cd4ed2ea4c90b4a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*qLDMdNCgLRG-Sz_X8O3syQ.png"/></div></figure><blockquote class="ll lm ln"><p id="8919" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">限制到地点API</p></blockquote><p id="723e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编辑→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es me"><img src="../Images/e604e454c8f02c9a61523bf390072a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*zD6LDpZLmwRP_hhGhlR9lg.png"/></div></figure><p id="0010" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">集合名称→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mf"><img src="../Images/f78b6e66a43334b11eb73dc6e0b5a16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*oi6KoHh_jYydYG4Hr_ev5w.png"/></div></figure><p id="6dc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">设置限制→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mg"><img src="../Images/afe019e6fe4b3573e5e20e89059b5e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*OWnM4cHViGCLFo8r0T3FFQ.png"/></div></figure><p id="6bde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">选择→您启用的所有地图API</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mh"><img src="../Images/f6615153a573c7b220b684d95393fac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*ud-j24eDcAx-JbFBGk4itg.png"/></div></figure><p id="78b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">保存→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mi"><img src="../Images/149c29091c180ce32782cf440e2bf28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*t03erPPg29wtIComlCbe_A.png"/></div></figure><blockquote class="ll lm ln"><p id="b383" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">在线测试API密钥</p></blockquote><p id="f8c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请将您的密钥添加到此链接</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="9339" class="jr js hi jg b fi jt ju l jv jw">https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=-33.8670522,151.1957362&amp;radius=500&amp;types=food&amp;name=harbour&amp;key=<strong class="jg hj">YOUR_API_KEY</strong></span></pre><p id="69a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一次，我有了这样的信息:</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="1467" class="jr js hi jg b fi jt ju l jv jw">{<br/>    error_message: "You must <strong class="jg hj">enable Billing</strong> on the Google Cloud Project at https://console.cloud.google.com/project/_/billing/enable Learn more at https://developers.google.com/maps/gmp-get-started",<br/>    html_attributions: [ ],<br/>    results: [ ],<br/>    status: "REQUEST_DENIED"<br/>}</span></pre></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="3ad7" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">💰2.E <strong class="ak">启用计费</strong> …… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><blockquote class="ll lm ln"><p id="e595" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">项目-地图演示:计费</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mj"><img src="../Images/be2768aa23df5603c383259025106a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*ib3c6WXFPE1iHa6ByxQuDA.png"/></div></figure><p id="1fd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您已经有一个计费账户，您可以跳过下一步，跳到“<a class="ae jh" href="#8f91" rel="noopener ugc nofollow"> <strong class="ih hj">链接一个计费账户</strong></a><strong class="ih hj">”</strong>。</p><blockquote class="ll lm ln"><p id="2a28" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">管理账单账户→</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mk"><img src="../Images/db71612fea344d2efed3e571f72fefce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*Bat5HuHhnKR0xhEAWAwhZA.png"/></div></figure><p id="29ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建帐户→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mk"><img src="../Images/beb6f1aa1fb36326ad07dc260fb9c163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*TyM76PIvgKea3o8LycaaBQ.png"/></div></figure><p id="8c6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建新的付费账户→</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es ml"><img src="../Images/75ec693fbcea80c8f0338a89a8b56dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*9H6DbJKOSbkZTqQt1xWMAA.png"/></div></figure><p id="094a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您可以添加您的付款类型。之后，让我们回到计费。</p><blockquote class="ll lm ln"><p id="8f91" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">链接计费账户→</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mm"><img src="../Images/5935d675834ea647b1c7455bad3d19c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*u574EhyWXgWKRgbRnL_EuA.png"/></div></figure><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mn"><img src="../Images/6a0d8cfee956b7ffda39b3e8574cf5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*SjH2N16pDEv66NxNItOKrg.png"/></div></figure><p id="3410" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你的账单准备好了。让我们再次运行测试链接。你会的，</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mo"><img src="../Images/3263c6fa4bc7216c2385ddfd16a07ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJXtdzcu3zIPvZmthLx0nQ.png"/></div></div></figure><p id="9e46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不再有错误！</p><p id="fddf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">✌️，你已经准备好创建你的Android项目了。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="854e" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🔗3.将API键链接到地图项目…… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="3547" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在我限制API密钥之前，我需要一个<strong class="ih hj">包名</strong>和<strong class="ih hj"> SHA-1指纹</strong>。让我们为谷歌地图打开一个新项目。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mp"><img src="../Images/c1cde26ed0ecbdbe29c3f525d19a0961.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*1Y61RyZNc7DjeeVTNkuEOg.png"/></div></figure><blockquote class="ll lm ln"><p id="55da" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">查看<strong class="ih hj"><em class="hi">Google _ maps _ API . XML</em></strong></p></blockquote><p id="8c01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在调试文件夹下，你会找到一个文件，<strong class="ih hj"><em class="ji">Google _ maps _ API . XML .</em></strong></p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mq"><img src="../Images/119a7ad4d09da030835e3e13da867ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*u9SqyxroxiJM5IRj5OVTbQ.png"/></div></figure><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mr"><img src="../Images/31e9b298970897966008ba30f3994486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*Xd6W0GYFvMi1TDoiYZs0Aw.png"/></div></figure><p id="487a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你的包裹名称和SHA-1已经准备好了。</p><blockquote class="ll lm ln"><p id="bd5e" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">将密钥限制在您的包中</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ms"><img src="../Images/c378ded7f815fe4728173e3b3abb0c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJVuhzkwaSkcqXcScSJWbg.png"/></div></div></figure><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es me"><img src="../Images/e604e454c8f02c9a61523bf390072a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*zD6LDpZLmwRP_hhGhlR9lg.png"/></div></figure><p id="22f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用限制:</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mt"><img src="../Images/ffa04c2c276a5d34921579cc921dc0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*le8V6lskZcWc1N-iH42sRQ.png"/></div></figure><p id="fb4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我会选择安卓应用。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mu"><img src="../Images/3050ace71789dde26529653e81a7c107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*PfscDUxrF4soXC8nIS4N_g.png"/></div></figure><p id="5f9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">粘贴安卓包名和SHA-1 →</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mv"><img src="../Images/e8b3efc25abcdcb5125b6af263c5a9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*LO0ktEE9W4bCp9PGFcHoHQ.png"/></div></figure></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><blockquote class="ll lm ln"><p id="db8c" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">格拉德。组件</p></blockquote><p id="2472" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">启用视图绑定。</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="f5a8" class="jr js hi jg b fi jt ju l jv jw">android <strong class="jg hj">{<br/>...<br/></strong>    buildFeatures <strong class="jg hj">{<br/>        </strong>viewBinding <strong class="jg hj">true<br/>    }<br/>}</strong></span></pre><p id="edd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并将这些行插入到<strong class="ih hj">依赖关系{} </strong>，</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="ab0b" class="jr js hi jg b fi jt ju l jv jw">implementation <strong class="jg hj">'com.google.android.gms:play-services-maps:17.0.1'<br/></strong>implementation <strong class="jg hj">'com.google.android.gms:play-services-location:18.0.0'<br/></strong>implementation <strong class="jg hj">'com.google.code.gson:gson:2.8.6'</strong></span></pre><p id="f449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同步。</p><blockquote class="ll lm ln"><p id="7ca3" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">将您的密钥隐藏在<strong class="ih hj"> local.properties </strong>中</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es mw"><img src="../Images/b182d758657851cd2d8b3dc22584c0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*7Owqa6k8MVVvzOZdUM9p4Q.png"/></div></figure><blockquote class="ll lm ln"><p id="ce71" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">格拉德。模块-读取local.properties</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="161f" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">// get property from local.properties<br/></em><strong class="jg hj">def </strong>getProps(String propName) {<br/>    <strong class="jg hj">def </strong>propsFile = rootProject.file(<strong class="jg hj">'local.properties'</strong>)<br/>    <strong class="jg hj">if </strong>(propsFile.exists()) {<br/>        <strong class="jg hj">def </strong>props = <strong class="jg hj">new </strong>Properties()<br/>        props.load(<strong class="jg hj">new </strong>FileInputStream(propsFile))<br/>        <strong class="jg hj">return </strong>props[propName]<br/>    } <strong class="jg hj">else </strong>{<br/>        <strong class="jg hj">return ""</strong>;<br/>    }<br/>}</span><span id="7172" class="jr js hi jg b fi mx ju l jv jw">android <strong class="jg hj">{<br/>    ...<br/><br/>    </strong>defaultConfig <strong class="jg hj">{<br/>        ...<br/><br/>        </strong><em class="ji">//AndroidManifest -- [ Variable: Value ]<br/>        </em>manifestPlaceholders = [ <strong class="jg hj">mapKey</strong>: getProps(<strong class="jg hj">'MAPS_API_KEY'</strong>) ]</span></pre><blockquote class="ll lm ln"><p id="4c45" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated"><strong class="ih hj"> AndroidManifest.xml </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="b573" class="jr js hi jg b fi jt ju l jv jw">&lt;<strong class="jg hj">uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" </strong>/&gt;<br/>&lt;<strong class="jg hj">uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" </strong>/&gt;<br/>&lt;<strong class="jg hj">uses-permission android:name="android.permission.INTERNET" </strong>/&gt;<br/>&lt;<strong class="jg hj">uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" </strong>/&gt;<br/>&lt;<strong class="jg hj">uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" </strong>/&gt;<br/><br/><br/><br/>&lt;application<br/>    android:allowBackup="true"<br/>    android:icon="@mipmap/ic_launcher"<br/>    android:label="@string/app_name"<br/>    android:roundIcon="@mipmap/ic_launcher_round"<br/>    android:supportsRtl="true"<br/>    android:theme="@style/Theme.MapDemo"&gt;<br/><em class="ji"><br/>    </em>&lt;<strong class="jg hj">meta-data<br/>            android:name="com.google.android.geo.API_KEY"<br/>            android:value="${mapKey}"<br/>            /&gt;<em class="ji"><br/></em></strong><em class="ji"><br/>        </em>&lt;activity<br/>            android:name="<strong class="jg hj">.ui.MapsActivity</strong>"<br/>            android:label="@string/title_activity_maps"&gt;<br/>            &lt;intent-filter&gt;<br/>                &lt;action android:name="android.intent.action.MAIN" /&gt;<br/><br/>                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br/>            &lt;/intent-filter&gt;<br/>        &lt;/activity&gt;<br/>    &lt;/application&gt;<br/><br/>&lt;/manifest&gt;</span></pre></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="8ff6" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">✒️4.启动项目…… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><blockquote class="ll lm ln"><p id="f38b" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">res/layout/activity_maps.xml</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="04cc" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">&lt;?</em><strong class="jg hj">xml version="1.0" encoding="utf-8"</strong><em class="ji">?&gt;<br/></em>&lt;<strong class="jg hj">FrameLayout <br/>    xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    tools:context="ui.MapsActivity"</strong>&gt;<br/><br/>    &lt;<strong class="jg hj">fragment<br/>        class="com.google.android.gms.maps.SupportMapFragment"<br/>        android:id="@+id/map_fragment"<br/>        android:layout_width="match_parent"<br/>        android:layout_height="match_parent" </strong>/&gt;<br/><br/>&lt;/<strong class="jg hj">FrameLayout</strong>&gt;</span></pre><p id="d952" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你的<code class="du jd je jf jg b"><strong class="ih hj"><em class="ji">SupportMapFragment</em></strong></code>下面有红线，请降低gradle中<code class="du jd je jf jg b"><strong class="ih hj">play-services-maps</strong></code>的版本。</p><h2 id="fc40" class="jr js hi bd jy my mz na kc nb nc nd kg iq ne nf kk iu ng nh ko iy ni nj ks nk bi translated">🚁—我不喜欢这个实验室的文件夹结构。所以我把它改成了MVVM风格。</h2><blockquote class="ll lm ln"><p id="970d" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/ <strong class="ih hj"> MapsActivity.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="9f0d" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">// check manifests for permissions<br/></em><strong class="jg hj">private val </strong><em class="ji">REQUIRED_PERMISSIONS </em>= <em class="ji">arrayOf</em>(<br/>    Manifest.permission.<em class="ji">INTERNET</em>,<br/>    Manifest.permission.<em class="ji">ACCESS_FINE_LOCATION</em>,<br/>    Manifest.permission.<em class="ji">ACCESS_COARSE_LOCATION</em>,<br/>    Manifest.permission.<em class="ji">ACCESS_NETWORK_STATE</em>,<br/>    Manifest.permission.<em class="ji">WRITE_EXTERNAL_STORAGE<br/></em>)<br/><br/><strong class="jg hj">class </strong>MapsActivity : AppCompatActivity(), OnMapReadyCallback {<br/><br/>    <strong class="jg hj">private lateinit var mMap</strong>: GoogleMap<br/>    <strong class="jg hj">private lateinit var binding</strong>: ActivityMapsBinding<br/><br/>    <strong class="jg hj">private val places</strong>: List&lt;Place&gt; <strong class="jg hj">by </strong><em class="ji">lazy </em><strong class="jg hj">{<br/>        </strong>PlacesReader(<strong class="jg hj">this</strong>).read()<br/>    <strong class="jg hj">}<br/><br/>    </strong><em class="ji">// app permission<br/>    </em><strong class="jg hj">private val reqMultiplePermissions </strong>= registerForActivityResult(<br/>        ActivityResultContracts.RequestMultiplePermissions()<br/>    ) <strong class="jg hj">{ </strong>permissions <strong class="jg hj">-&gt;<br/>        </strong>permissions.<strong class="jg hj">entries</strong>.<em class="ji">forEach </em><strong class="jg hj">{<br/>            </strong><em class="ji">lgd</em>(<strong class="jg hj">"mainAct: Permission: ${it</strong>.<strong class="jg hj">key} = ${it</strong>.<strong class="jg hj">value}"</strong>)<br/>            <strong class="jg hj">if </strong>(!<strong class="jg hj">it</strong>.<strong class="jg hj">value</strong>) {<br/>                <em class="ji">// toast<br/>                msg</em>(<strong class="jg hj">this</strong>, <strong class="jg hj">"Permission: ${it</strong>.<strong class="jg hj">key} denied!"</strong>, 1)<br/>                finish()<br/>            }<br/>        <strong class="jg hj">}<br/>    }</strong></span></pre><p id="2446" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用Google Maps在旧金山找到一个演示地点。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es nl"><img src="../Images/c78e16eb6dc46f1ef60c1bfb5f15db30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*m2m2Rp_vK06rMGCSXCtH5Q.png"/></div></figure><p id="102d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，您可以用您的位置替换悉尼。</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="a0c6" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">override fun </strong>onMapReady(googleMap: GoogleMap) {<br/>    <strong class="jg hj">mMap </strong>= googleMap<br/><br/>    <em class="ji">// Add a marker in Sydney and move the camera<br/>    </em><strong class="jg hj">val </strong>sf = LatLng(37.75, -122.45)<br/>    <strong class="jg hj">mMap</strong>.addMarker(MarkerOptions()<br/>        .position(sf)<br/>        .title(<strong class="jg hj">"Marker in San Francisco"</strong>))<br/>    <strong class="jg hj">mMap</strong>.moveCamera(CameraUpdateFactory.newLatLng(sf))<br/>    <strong class="jg hj">mMap</strong>.animateCamera(CameraUpdateFactory.zoomIn())<br/>    <strong class="jg hj">mMap</strong>.animateCamera(CameraUpdateFactory.zoomTo(13f), 2000, <strong class="jg hj">null</strong>)<br/><br/>}</span></pre><p id="02fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">onCreate():</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="b7fa" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">override fun </strong>onCreate(savedInstanceState: Bundle?) {<br/>    <strong class="jg hj">super</strong>.onCreate(savedInstanceState)<br/><br/>    <strong class="jg hj">binding </strong>= ActivityMapsBinding.inflate(<em class="ji">layoutInflater</em>)<br/>    setContentView(<strong class="jg hj">binding</strong>.<em class="ji">root</em>)<br/><br/>    <em class="ji">// check app permissions<br/>    </em><strong class="jg hj">reqMultiplePermissions</strong>.launch(<em class="ji">REQUIRED_PERMISSIONS</em>)<br/><br/>    <em class="ji">// Obtain the SupportMapFragment and get notified when the map is ready to be used.<br/>    </em><strong class="jg hj">val </strong>mapFragment = <em class="ji">supportFragmentManager<br/>        </em>.findFragmentById(R.id.<em class="ji">map_fragment</em>) <strong class="jg hj">as </strong>SupportMapFragment<br/>    mapFragment.getMapAsync(<strong class="jg hj">this</strong>)<br/>    mapFragment.getMapAsync <strong class="jg hj">{ </strong>googleMap <strong class="jg hj">-&gt;<br/>        </strong>addMarkers(googleMap)<br/>    <strong class="jg hj">}<br/></strong>}</span></pre><p id="2cc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🐟快跑！</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nm"><img src="../Images/df42e18f3776fde550e120933b654284.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/1*bqFyMXuLvt3upbxDfP4RKA.gif"/></div></div></figure><p id="e84f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有好的空白屏幕！</p><p id="2de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在Logcat中搜索错误:</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nn"><img src="../Images/1771f0d6c6f918150b6306bc8416a6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETkJe-rV-jama9UK6OoLxg.png"/></div></div></figure><blockquote class="ll lm ln"><p id="869d" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">💯谷歌云支持…… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es no"><img src="../Images/b81a1d3c07c21d268a926a0e0e71fe3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*9U3Q1v16-QIQ3lE-KnCtbQ.png"/></div></figure><p id="5a66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不确定这是服务器的问题还是我的设置的问题。所以我和谷歌云支持聊了聊。我建议你选择聊天也是因为一个真实的人会实时帮助你。</p><p id="9b91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">❌是第一个让我添加谷歌地图Javascript API的人。这家伙一定是个新手，他给了我一些糟糕的建议。所以我尝试添加尽可能多的API来解决这个问题。不，一点用都没有。</p><p id="139e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">✔️I又和谷歌支持聊了聊。这个人研究了我的案子10分钟。他告诉我API key有读取问题，让我直接替换<strong class="ih hj"><em class="ji">androidmanifest . XML</em></strong>中的key。成功了。但是，将普通密钥放在清单中并不是一个好主意。</p><blockquote class="ll lm ln"><p id="5bcb" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">搜索问题</p></blockquote><p id="9b5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我感谢谷歌云支持的帮助。之后，我仍然需要找到一个解决方案来保护密钥。最后，我发现这是一个<strong class="ih hj">双引号</strong>问题。API键是<strong class="ih hj">而不是字符串类型</strong>。是一条短信。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es np"><img src="../Images/53acea515fba06e97bd1b6941870bb92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*tXQQzGxaJwvXn11AdRBrVg.png"/></div><figcaption class="nq nr et er es ns nt bd b be z dx">local.properties</figcaption></figure><p id="43bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我删除了<strong class="ih hj"><em class="ji">local . properties</em></strong>中的双引号之后，我得到了这个:</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es nm"><img src="../Images/191238eb5d7705a8fe5faac650110a6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*A6_a44uot1je-7G0lE3TkA.png"/></div></figure><h2 id="b96b" class="jr js hi bd jy my mz na kc nb nc nd kg iq ne nf kk iu ng nh ko iy ni nj ks nk bi translated">🎊放松，问题解决了。</h2></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="12cd" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🖍 5.插入标记… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="77b4" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">标记数据位置:<a class="ae jh" href="https://github.com/googlecodelabs/maps-platform-101-android/blob/main/starter/app/src/main/res/raw/places.json" rel="noopener ugc nofollow" target="_blank"> places.json </a></p><p id="a6ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您需要将该文件下载到<strong class="ih hj"> res/raw </strong>文件夹中。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es nu"><img src="../Images/4a73c6844cbd97a83d53d27f04c2f6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*3vJo7s4_UjINHKxwE_Dxdw.png"/></div></figure><p id="df59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Codelab提供了位置包:</p><blockquote class="ll lm ln"><p id="375d" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">place/ <strong class="ih hj"> Place.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="a52d" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">data class </strong>Place(<br/>    <strong class="jg hj">val name</strong>: String,<br/>    <strong class="jg hj">val latLng</strong>: LatLng,<br/>    <strong class="jg hj">val address</strong>: String,<br/>    <strong class="jg hj">val rating</strong>: Float<br/>)</span></pre><blockquote class="ll lm ln"><p id="a136" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">place/ <strong class="ih hj"> PlaceReader.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="2344" class="jr js hi jg b fi jt ju l jv jw">class <strong class="jg hj">PlacesReader</strong>(private val context: Context) {<br/><br/>    private val gson = Gson()<br/><br/>    private val inputStream: InputStream<br/>        get() = context.<em class="ji">resources</em>.openRawResource(R.raw.<em class="ji">places</em>)<br/><br/>    <strong class="jg hj">fun read()</strong>: List&lt;Place&gt; {<br/>        val itemType = object : TypeToken&lt;List&lt;PlaceResponse&gt;&gt;() {}.<em class="ji">type<br/>        </em>val reader = InputStreamReader(inputStream)<br/>        return <strong class="jg hj">gson.fromJson&lt;List&lt;PlaceResponse&gt;&gt;(reader, itemType).<em class="ji">map </em>{<br/>            it.<em class="ji">toPlace</em>()<br/>        }</strong><br/>    }<br/>}</span></pre><blockquote class="ll lm ln"><p id="ea10" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">place/<strong class="ih hj">place response . kt</strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="54e2" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">data class PlaceResponse(</strong><br/>    val geometry: Geometry,<br/>    val name: String,<br/>    val vicinity: String,<br/>    val rating: Float<br/>) {<br/><br/>    <strong class="jg hj">data class Geometry(</strong><br/>        val location: GeometryLocation<br/>    )<br/><br/>    <strong class="jg hj">data class GeometryLocation</strong>(<br/>        val lat: Double,<br/>        val lng: Double<br/>    )<br/>}<br/><br/>fun <strong class="jg hj">PlaceResponse.toPlace()</strong>: Place = Place(<br/>    name = name,<br/>    latLng = LatLng(geometry.location.lat, geometry.location.lng),<br/>    address = vicinity,<br/>    rating = rating<br/>)</span></pre><blockquote class="ll lm ln"><p id="db14" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated"><strong class="ih hj"> ui/MapsActivity.kt </strong></p></blockquote><p id="6092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加一个新变量—位置</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="ecb4" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">private val places</strong>: List&lt;Place&gt; <strong class="jg hj">by </strong><em class="ji">lazy </em><strong class="jg hj">{<br/>    </strong>PlacesReader(<strong class="jg hj">this</strong>).read()<br/><strong class="jg hj">}</strong></span><span id="a43e" class="jr js hi jg b fi mx ju l jv jw">override fun onCreate(savedInstanceState: Bundle?) {<br/>    super.onCreate(savedInstanceState)<br/><br/>    binding = ActivityMapsBinding.inflate(<em class="ji">layoutInflater</em>)<br/>    setContentView(binding.<em class="ji">root</em>)<br/><br/>    <em class="ji">// Obtain the SupportMapFragment and get notified when the map is ready to be used.<br/>    </em>val mapFragment = <em class="ji">supportFragmentManager<br/>        </em>.findFragmentById(R.id.<em class="ji">map</em>) as SupportMapFragment<br/>    <br/>    <em class="ji">// add marker from places.json<br/>    </em>mapFragment.getMapAsync { googleMap -&gt;<br/>        <strong class="jg hj">addMarkers(googleMap)</strong><br/>    }<br/>}</span><span id="6f37" class="jr js hi jg b fi mx ju l jv jw">/**<br/> * Adds marker representations of the places list on the provided GoogleMap object<br/> */<br/>private fun <strong class="jg hj">addMarkers</strong>(googleMap: GoogleMap) {<br/>    places.forEach { place -&gt;<br/>        val marker = googleMap.addMarker(<br/>            <strong class="jg hj">MarkerOptions()</strong><br/>                .title(place.name)<br/>                .position(place.latLng)<br/>        )<br/>    }<br/>}</span></pre><blockquote class="ll lm ln"><p id="95af" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">🚵运行并检查标记</p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es nv"><img src="../Images/bbd296d3f45cb7174de5caacdcf3509b.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*_Y1vB6ieLF90wb14VDV75Q.png"/></div></figure><p id="eac4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">非洲？它不起作用。这个Codelab给了我们一个可怕的代码例子。</p><blockquote class="ll lm ln"><p id="696e" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">处理</p></blockquote><p id="9b89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我需要设置目的地，放大并添加标记。它错过了两个步骤:设置目的地和放大。在<strong class="ih hj"> onCreate() </strong>中的修复将是，</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="e290" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">val </strong>mapFragment = <em class="ji">supportFragmentManager<br/>    </em>.findFragmentById(R.id.<em class="ji">map_fragment</em>) <strong class="jg hj">as </strong>SupportMapFragment<br/><strong class="jg hj">mapFragment.getMapAsync(this)</strong><br/>mapFragment.getMapAsync <strong class="jg hj">{ </strong>googleMap <strong class="jg hj">-&gt;<br/>    </strong>addMarkers(googleMap)<br/><strong class="jg hj">}</strong></span></pre><p id="1edb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🏄再次运行。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nm"><img src="../Images/86319c4f075725155abb544df30a9fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/1*WWpyO3yj4L5d2MAL_d_qXA.gif"/></div></div></figure><p id="4d55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完美！</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="6083" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🎱 6.自定义标记… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="1950" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">在本节中，我们需要将标记图像更改为<a class="ae jh" href="https://github.com/googlecodelabs/maps-platform-101-android/blob/main/starter/app/src/main/res/drawable/ic_directions_bike_black_24dp.xml" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ji">自行车图像</em> </strong> </a>。</p><blockquote class="ll lm ln"><p id="3ffa" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated"><strong class="ih hj">RES/layout/marker _ info _ contents . XML</strong></p></blockquote><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es nw"><img src="../Images/224bc59a2f1b21632f6dd7b5c30778bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*SvUbbJqNOvDXsuohCvAjfg.png"/></div></figure><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="8d9a" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">&lt;?</em><strong class="jg hj">xml version="1.0" encoding="utf-8"</strong><em class="ji">?&gt;<br/></em>&lt;<strong class="jg hj">LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:orientation="vertical"<br/>    android:layout_width="wrap_content"<br/>    android:layout_height="wrap_content"<br/>    android:gravity="center_horizontal"<br/>    android:padding="8dp"</strong>&gt;<br/><br/>    &lt;<strong class="jg hj">TextView<br/>        android:id="@+id/tv_title"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:textColor="@android:color/black"<br/>        android:textSize="18sp"<br/>        android:textStyle="bold"<br/>        tools:text="Title"</strong>/&gt;<br/><br/>    &lt;<strong class="jg hj">TextView<br/>        android:id="@+id/tv_address"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:textColor="@android:color/black"<br/>        android:textSize="16sp"<br/>        tools:text="123 Main Street"</strong>/&gt;<br/><br/>    &lt;<strong class="jg hj">TextView<br/>        android:id="@+id/tv_rating"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:textColor="@android:color/black"<br/>        android:textSize="16sp"<br/>        tools:text="Rating: 3"</strong>/&gt;<br/><br/>&lt;/<strong class="jg hj">LinearLayout</strong>&gt;</span></pre><p id="7afe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你有一个新的布局。接下来你需要什么？</p><p id="60ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">适配器！</p><blockquote class="ll lm ln"><p id="7ab9" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/adapter/<strong class="ih hj">markerinfowindowadapter . kt</strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="ceec" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">class </strong>MarkerInfoWindowAdapter(<br/>    <strong class="jg hj">private val context</strong>: Context<br/>) : GoogleMap.InfoWindowAdapter {<br/><br/>    <strong class="jg hj">lateinit var binding</strong>: MarkerInfoContentsBinding<br/><br/>    <strong class="jg hj">override fun </strong>getInfoContents(marker: Marker?): View? {<br/>        <em class="ji">// 1. Get tag<br/>        </em><strong class="jg hj">val </strong>place = marker?.<em class="ji">tag </em><strong class="jg hj">as? </strong>Place ?: <strong class="jg hj">return null<br/><br/>        </strong><em class="ji">// 2. Inflate view and set title, address, and rating<br/>        </em><strong class="jg hj">binding </strong>= MarkerInfoContentsBinding.inflate(<br/>            LayoutInflater.from(<strong class="jg hj">context</strong>) )<br/><br/>        <strong class="jg hj">binding</strong>.<strong class="jg hj">tvTitle</strong>.<em class="ji">text </em>= place.<strong class="jg hj">name<br/>        binding</strong>.<strong class="jg hj">tvAddress</strong>.<em class="ji">text </em>= place.<strong class="jg hj">address<br/>        binding</strong>.<strong class="jg hj">tvRating</strong>.<em class="ji">text </em>= <strong class="jg hj">"Rating: %.2f"</strong>.<em class="ji">format</em>(place.<strong class="jg hj">rating</strong>)<br/><br/>        <strong class="jg hj">return binding</strong>.<em class="ji">root<br/>    </em>}<br/><br/>    <strong class="jg hj">override fun </strong>getInfoWindow(marker: Marker?): View? {<br/>        <em class="ji">// Return null to indicate that the<br/>        // default window (white bubble) should be used<br/>        </em><strong class="jg hj">return null<br/>    </strong>}<br/>}</span></pre><blockquote class="ll lm ln"><p id="c883" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">添加自行车图标</p></blockquote><p id="17a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下载<a class="ae jh" href="https://github.com/googlecodelabs/maps-platform-101-android/blob/main/starter/app/src/main/res/drawable/ic_directions_bike_black_24dp.xml" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ji">自行车图片</em></strong></a><em class="ji">→</em><br/>RES/drawable:<em class="ji"/><strong class="ih hj"><em class="ji">IC _ directions _ bike _ black _ 24dp . XML</em></strong></p><p id="2868" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个矢量文件。所以我们需要一个工具来将vecort XML转换成位图数据。</p><blockquote class="ll lm ln"><p id="bc92" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">工具— <strong class="ih hj"> BitmapHelper.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="a1d0" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">object </strong>BitmapHelper {<br/>    <em class="ji">/**<br/>     * Demonstrates converting a </em><strong class="jg hj"><em class="ji">[Drawable]</em></strong><em class="ji"> to a </em><strong class="jg hj"><em class="ji">[BitmapDescriptor]</em></strong><em class="ji">, for use as a marker icon.<br/>     * Taken from ApiDemos on GitHub: https://github.com/googlemaps/android-samples/blob/master/ApiDemos/kotlin/app/src/main/java/com/example/kotlindemos/MarkerDemoActivity.kt<br/>     */<br/>    </em><strong class="jg hj">fun </strong>vectorToBitmap(context: Context, @DrawableRes id: Int, @ColorInt color: Int): BitmapDescriptor {<br/>        <strong class="jg hj">val </strong>vectorDrawable = ResourcesCompat.getDrawable(context.<em class="ji">resources</em>, id, <strong class="jg hj">null</strong>)<br/>        <strong class="jg hj">if </strong>(vectorDrawable == <strong class="jg hj">null</strong>) {<br/>            Log.e(<strong class="jg hj">"BitmapHelper"</strong>, <strong class="jg hj">"Resource not found"</strong>)<br/>            <strong class="jg hj">return </strong>BitmapDescriptorFactory.defaultMarker()<br/>        }<br/>        <strong class="jg hj">val </strong>bitmap = Bitmap.createBitmap(<br/>            vectorDrawable.<em class="ji">intrinsicWidth</em>,<br/>            vectorDrawable.<em class="ji">intrinsicHeight</em>,<br/>            Bitmap.Config.<em class="ji">ARGB_8888<br/>        </em>)<br/>        <strong class="jg hj">val </strong>canvas = Canvas(bitmap)<br/>        vectorDrawable.setBounds(0, 0, canvas.<em class="ji">width</em>, canvas.<em class="ji">height</em>)<br/>        DrawableCompat.setTint(vectorDrawable, color)<br/>        vectorDrawable.draw(canvas)<br/>        <strong class="jg hj">return </strong>BitmapDescriptorFactory.fromBitmap(bitmap)<br/>    }<br/>}</span></pre><blockquote class="ll lm ln"><p id="99e3" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/<strong class="ih hj">maps activity . kt</strong>→自行车图标</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="f1ee" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">private lateinit var bicycleIcon: BitmapDescriptor</strong></span><span id="7895" class="jr js hi jg b fi mx ju l jv jw">override fun onCreate(savedInstanceState: Bundle?) {<br/>    super.onCreate(savedInstanceState)<br/><br/>    binding = ActivityMapsBinding.inflate(<em class="ji">layoutInflater</em>)<br/>    setContentView(binding.<em class="ji">root</em>)<br/><br/>    <em class="ji">// check app permissions<br/>    </em>reqMultiplePermissions.launch(<em class="ji">REQUIRED_PERMISSIONS</em>)<br/><br/><strong class="jg hj">    val color = getColor(this, R.color.<em class="ji">colorPrimary</em>)<br/>    bicycleIcon = BitmapHelper.vectorToBitmap(<br/>        this, R.drawable.<em class="ji">ic_directions_bike_black_24dp</em>, color)<br/></strong>...<br/>}</span><span id="fd13" class="jr js hi jg b fi mx ju l jv jw">private fun addMarkers(googleMap: GoogleMap) {<br/>    places.<em class="ji">forEach </em>{ place -&gt;<br/>        val marker = googleMap.addMarker(<br/>            MarkerOptions()<br/>                .title(place.name)<br/>                .position(place.latLng)<br/>                <strong class="jg hj">.icon(bicycleIcon)</strong><br/>        )<br/>    }<br/>}</span></pre><p id="0871" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🗽看起来不错。我们跑吧！</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nm"><img src="../Images/f58ab5eb6bd1f1d6cffdeed56c234160.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/1*F_TxbvprSP4VMk4KAsV44w.gif"/></div></div></figure><p id="ef59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很好！没有错误！</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="1047" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🎳 7.标记簇→Gro<strong class="ak">up overlap</strong>ed Markers……→<a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="143f" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">重叠图标视图在屏幕上看起来很糟糕。这就是为什么我们需要标记集群，它会给我们一个整洁干净的外观。</p><blockquote class="ll lm ln"><p id="a158" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">格拉德。组件</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="a605" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">//region Google Map<br/></em>implementation 'com.google.android.gms:play-services-maps:17.0.1'<br/>implementation 'com.google.android.gms:play-services-location:18.0.0'<br/>implementation 'com.google.code.gson:gson:2.8.6'<strong class="jg hj"><br/>implementation 'com.google.maps.android:android-maps-utils:1.1.0'<br/></strong><em class="ji">//endregion</em></span></pre><blockquote class="ll lm ln"><p id="7762" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">三个步骤</p></blockquote><p id="e3b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实现集群有三个简单的步骤。</p><ol class=""><li id="6d59" class="nx ny hi ih b ii ij im in iq nz iu oa iy ob jc oc od oe of bi translated">实现<code class="du jd je jf jg b">ClusterItem</code>接口。</li><li id="cb4c" class="nx ny hi ih b ii og im oh iq oi iu oj iy ok jc oc od oe of bi translated">子类化<code class="du jd je jf jg b">DefaultClusterRenderer</code>类。</li><li id="1c6e" class="nx ny hi ih b ii og im oh iq oi iu oj iy ok jc oc od oe of bi translated">创建一个<code class="du jd je jf jg b">ClusterManager</code>并添加物品。</li></ol><blockquote class="ol"><p id="fd87" class="om on hi bd oo op oq or os ot ou jc dx translated">让我们按照步骤来。</p></blockquote><blockquote class="ll lm ln"><p id="fbd7" class="if ig ji ih b ii ov ik il im ow io ip lo ox is it lp oy iw ix lq oz ja jb jc hb bi translated">1️⃣.地点→集群项目</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="224b" class="jr js hi jg b fi jt ju l jv jw">data class Place(<br/>    val name: String,<br/>    val latLng: LatLng,<br/>    val address: String,<br/>    val rating: Float<br/>): ClusterItem {<br/><strong class="jg hj">    override fun getPosition(): LatLng = latLng<br/><br/>    override fun getTitle(): String = name<br/><br/>    override fun getSnippet(): String = address<br/></strong>}</span></pre><blockquote class="ll lm ln"><p id="6b0c" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">2️⃣.添加一个新类:place/<a class="ae jh" href="https://github.com/googlecodelabs/maps-platform-101-android/blob/main/solution/app/src/main/java/com/google/codelabs/buildyourfirstmap/place/PlaceRenderer.kt" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">place renderer</strong></a><strong class="ih hj">。kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="8b11" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">class </strong>PlaceRenderer(<br/>    <strong class="jg hj">private val context</strong>: Context,<br/>    map: GoogleMap,<br/>    clusterManager: ClusterManager&lt;Place&gt;<br/>) : DefaultClusterRenderer&lt;Place&gt;(context, map, clusterManager) {<br/><br/>    <em class="ji">/**<br/>     * The icon to use for each cluster item<br/>     */<br/>    </em><strong class="jg hj">private val bicycleIcon</strong>: BitmapDescriptor = <em class="ji">run </em><strong class="jg hj">{<br/>        val </strong>color = ContextCompat.getColor(<br/>            <strong class="jg hj">context</strong>,<br/>            R.color.<em class="ji">colorPrimary<br/>        </em>)<br/>        BitmapHelper.vectorToBitmap(<br/>            <strong class="jg hj">context</strong>,<br/>            R.drawable.<em class="ji">ic_directions_bike_black_24dp</em>,<br/>            color<br/>        )<br/>    <strong class="jg hj">}<br/><br/>    </strong><em class="ji">/**<br/>     * Before the cluster item (the marker) is rendered.<br/>     * Assign location on map.<br/>     */<br/>    </em><strong class="jg hj">override fun </strong>onBeforeClusterItemRendered(<br/>        item: Place,<br/>        markerOptions: MarkerOptions<br/>    ) {<br/>        markerOptions.title(item.<strong class="jg hj">name</strong>)<br/>            .position(item.<strong class="jg hj">latLng</strong>)<br/>            .icon(<strong class="jg hj">bicycleIcon</strong>)<br/>    }<br/><br/>    <em class="ji">/**<br/>     * After the cluster item (the marker) is rendered.<br/>     * Properties location on map.<br/>     */<br/>    </em><strong class="jg hj">override fun </strong>onClusterItemRendered(<br/>        clusterItem: Place, <br/>        marker: Marker<br/>    ) {<br/>        marker.<em class="ji">tag </em>= clusterItem<br/>    }<br/>}</span></pre><p id="4217" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我去掉<strong class="ih hj">懒</strong>，在Kotlin 1.5上是不行的。</p><blockquote class="ll lm ln"><p id="a1c0" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">3️⃣.ui/ <strong class="ih hj"> MapsActivity.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="80e7" class="jr js hi jg b fi jt ju l jv jw">override fun <strong class="jg hj">onCreate</strong>(savedInstanceState: Bundle?) {<br/>    ...<br/>    val mapFragment = supportFragmentManager<br/>        .findFragmentById(R.id.map_fragment) as SupportMapFragment<br/>    mapFragment.getMapAsync(this)<br/>    mapFragment.getMapAsync { googleMap -&gt;<strong class="jg hj"><br/></strong>        <strong class="jg hj">addClusteredMarkers(googleMap)</strong></span><span id="c761" class="jr js hi jg b fi mx ju l jv jw">        <em class="ji">// add zoom control bar<br/>        </em>googleMap.<em class="ji">uiSettings</em>.<strong class="jg hj"><em class="ji">isZoomControlsEnabled</em></strong><em class="ji"> </em>= true<strong class="jg hj"><br/>    }<br/></strong>}</span></pre><p id="2efa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一句台词就够了。我还添加了<strong class="ih hj">缩放控制条</strong>，这样你就可以在模拟器中放大或缩小。</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="5b6a" class="jr js hi jg b fi jt ju l jv jw">/**<br/> * Adds markers to the map with clustering support.<br/> */<br/>private fun <strong class="jg hj">addClusteredMarkers</strong>(googleMap: GoogleMap) {<br/>    // Create the ClusterManager class and set the custom renderer.<br/>    val <strong class="jg hj">clusterManager</strong> = ClusterManager&lt;Place&gt;(this, googleMap)<br/>    <strong class="jg hj">clusterManager</strong>.renderer =<br/>        PlaceRenderer(<br/>            this,<br/>            googleMap,<br/>            clusterManager<br/>        )<br/>    <br/>    // Set custom info window adapter<br/>    <strong class="jg hj">clusterManager</strong><br/>        .markerCollection<br/>        .setInfoWindowAdapter(MarkerInfoWindowAdapter(this))<br/>    <br/>    // Add the places to the ClusterManager.<br/>    <strong class="jg hj">clusterManager</strong>.addItems(places)<br/>    <strong class="jg hj">clusterManager</strong>.cluster()<br/>    <br/>    // Set ClusterManager as the OnCameraIdleListener so that it<br/>    // can re-cluster when zooming in and out.<br/>    googleMap.setOnCameraIdleListener {<br/>        <strong class="jg hj">clusterManager</strong>.onCameraIdle()<br/>    }<br/>}</span></pre><p id="d95d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">集群管理器</strong>是一个繁忙的管理器，它处理每一个调用。</p><p id="6ac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">✈️Run！</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es pa"><img src="../Images/05fd9c23eb4114caf49b9e801ec7d235.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/1*bd7awFCWPPbgxoghvydfzg.gif"/></div></figure></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="e2cb" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🎨 8.在地图上画图… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="277a" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">让我们在地图上找点乐子。首先要有一个点击监听器。</p><blockquote class="ll lm ln"><p id="a1bb" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/ <strong class="ih hj"> MapsActivity.kt </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="4e26" class="jr js hi jg b fi jt ju l jv jw">private fun <strong class="jg hj">addClusteredMarkers</strong>(googleMap: GoogleMap) {<br/>    <em class="ji">...</em><br/><br/><strong class="jg hj">    clusterManager.setOnClusterItemClickListener { item -&gt;<br/>        addCircle(googleMap, item)<br/>        return@setOnClusterItemClickListener false<br/>    }<br/><br/></strong>    <em class="ji">// Set ClusterManager as the OnCameraIdleListener so that it<br/>    // can re-cluster when zooming in and out.<br/>    </em>googleMap.setOnCameraIdleListener {<br/>        clusterManager.onCameraIdle()<br/>    }<br/>}</span></pre><blockquote class="ll lm ln"><p id="58db" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">addCircle()</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="2b6e" class="jr js hi jg b fi jt ju l jv jw">//region circle function<br/>private var <strong class="jg hj">circle</strong>: Circle? = null<br/>    <br/>/**<br/> * Adds a [Circle] around the provided [item]<br/> */<br/>private fun <strong class="jg hj">addCircle</strong>(googleMap: GoogleMap, item: Place) {<br/>    circle?.remove()<br/>    circle = googleMap.addCircle(<br/>        CircleOptions()<br/>            .center(item.latLng)<br/>            .radius(1000.0)<br/>            .fillColor(ContextCompat.getColor(<br/>                this, R.color.colorPrimaryTranslucent))<br/>            .strokeColor(ContextCompat.getColor(<br/>                this, R.color.colorPrimary))<br/>    )<br/>}<br/>//endregion</span></pre><p id="83c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单击模拟器，这样就可以用1000米画一个圆。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es pb"><img src="../Images/a9ad44e84456ab7bc5e251417e7a0e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*FkVfCDaMrHX3HEPdSavY4Q.png"/></div></div></figure><p id="8236" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您也可以添加折线和多边形。我可能会在单独的文章中展示它们。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="fc97" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">📷 9.相机控制… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="420c" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">让我们注意到点击收听者有一个清晰的视角，没有圆圈。</p><blockquote class="ll lm ln"><p id="925f" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/ <strong class="ih hj"> MapsActivity.kt </strong></p></blockquote><p id="1368" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">addClusteredMarkers():</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="ed01" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">// clusterManager.setOnClusterItemClickListener { item -&gt;<br/>//            addCircle(googleMap, item)<br/>//            return@setOnClusterItemClickListener false<br/>//        }</em></span></pre><p id="18c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">onCreate():</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="3492" class="jr js hi jg b fi jt ju l jv jw">mapFragment.getMapAsync { googleMap -&gt;<br/>    addClusteredMarkers(googleMap)<br/>    <br/>    // add zoom control bar<br/>    googleMap.uiSettings.isZoomControlsEnabled = true<br/>    <br/><strong class="jg hj">    // Ensure all places are visible in the map.<br/>    googleMap.setOnMapLoadedCallback {<br/>        val bounds = LatLngBounds.builder()<br/>        places.forEach { bounds.include(it.latLng) }<br/>        googleMap.moveCamera(<br/>            CameraUpdateFactory.newLatLngBounds(bounds.build(), 20))<br/>    }</strong><br/>}</span></pre><p id="9347" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此设置会将地图中心移动到标记的位置。</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es pc"><img src="../Images/cc38b7126f86bb0309718972ca60b28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*ddd0kdeF2ijlKVzdnS0WtQ.png"/></div></figure><blockquote class="ll lm ln"><p id="acf1" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated"><strong class="ih hj">半透明</strong>效果<strong class="ih hj">运动中的</strong></p></blockquote><p id="51b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">addClusteredMarkers()</p><p id="238d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该效果要求所有簇在摄影机移动时降低alpha值。当摄像机停止时，一切都会恢复正常。</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="d871" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">// Camera moving, alpha ==&gt; translucent.<br/></em>googleMap.setOnCamera<strong class="jg hj">MoveStarted</strong>Listener <strong class="jg hj">{<br/>    </strong>clusterManager.<em class="ji">markerCollection</em>.<em class="ji">markers</em>.<em class="ji">forEach </em><strong class="jg hj">{ it</strong>.<em class="ji">alpha </em>= 0.3f <strong class="jg hj">}<br/>    </strong>clusterManager.<em class="ji">clusterMarkerCollection</em>.<em class="ji">markers</em>.<em class="ji">forEach </em><strong class="jg hj">{ it</strong>.<em class="ji">alpha </em>= 0.3f <strong class="jg hj">}<br/>}<br/><br/></strong>googleMap.setOn<strong class="jg hj">CameraIdle</strong>Listener <strong class="jg hj">{<br/>    </strong><em class="ji">// Camera stops ==&gt; alpha = 1<br/>    </em>clusterManager.<em class="ji">markerCollection</em>.<em class="ji">markers</em>.<em class="ji">forEach </em><strong class="jg hj">{ <br/>        it</strong>.<em class="ji">alpha </em>= 1.0f <strong class="jg hj">}<br/>    </strong>clusterManager.<em class="ji">clusterMarkerCollection</em>.<em class="ji">markers</em>.<em class="ji">forEach </em><strong class="jg hj">{ <br/>        it</strong>.<em class="ji">alpha </em>= 1.0f <strong class="jg hj">}<br/><br/>    </strong><em class="ji">// Call clusterManager.onCameraIdle() <br/>    // Stop ==&gt; reclustering<br/>    </em>clusterManager.onCameraIdle()<br/><strong class="jg hj">}</strong></span></pre><p id="3881" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">🛫Run.</p><figure class="jj jk jl jm fd ls er es paragraph-image"><div class="er es pd"><img src="../Images/a0327a357b356806b6c75c12e61396d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*nThoQWw9d_RZLyE76Nru0A.gif"/></div></figure><p id="3a78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变暗了。工作正常！</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="8250" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🚀 10.KTX升级…… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="35a4" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">Kotlin是Android的官方语言。我们用它的Ktx库吧。</p><blockquote class="ll lm ln"><p id="bc7b" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">分级模块</p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="bc2f" class="jr js hi jg b fi jt ju l jv jw">dependencies {<br/>    // ...<br/><br/>    <strong class="jg hj">// Maps SDK for Android KTX Library<br/>    implementation 'com.google.maps.android:maps-ktx:3.0.0'<br/><br/>    // Maps SDK for Android Utility Library KTX Library<br/>    implementation 'com.google.maps.android:maps-utils-ktx:3.0.0'<br/><br/>    // Lifecycle Runtime KTX Library<br/>    implementation 'androidx.lifecycle:lifecycle-runtime-ktx:2.3.1'</strong><br/>}</span></pre><p id="29c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同步。</p><blockquote class="ll lm ln"><p id="22a6" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">ui/ <strong class="ih hj"> MapsActivity.kt </strong></p></blockquote><ul class=""><li id="f465" class="nx ny hi ih b ii ij im in iq nz iu oa iy ob jc pe od oe of bi translated"><strong class="ih hj"> addMarkers(): </strong></li></ul><p id="1493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原创→</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="3359" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">places</strong>.<em class="ji">forEach </em><strong class="jg hj">{ </strong>place <strong class="jg hj">-&gt;<br/>    val </strong>marker = googleMap.addMarker(<br/>        MarkerOptions()<br/>            .title(place.<strong class="jg hj">name</strong>)<br/>            .position(place.<strong class="jg hj">latLng</strong>)<br/>            .icon(<strong class="jg hj">bicycleIcon</strong>)<br/>    )<br/><strong class="jg hj">}</strong></span></pre><p id="52f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Ktx →</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="de37" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">places</strong>.<em class="ji">forEach </em><strong class="jg hj">{ </strong>place <strong class="jg hj">-&gt;<br/>    val </strong>marker = googleMap.<em class="ji">addMarker </em><strong class="jg hj">{<br/>        </strong>title(place.<strong class="jg hj">name</strong>)<br/>        position(place.<strong class="jg hj">latLng</strong>)<br/>        icon(<strong class="jg hj">bicycleIcon</strong>)<br/>    <strong class="jg hj">}<br/>    </strong><em class="ji">// Set place as the tag on the marker object<br/>    // so it can be referenced within<br/>    // MarkerInfoWindowAdapter<br/>    </em>marker.<em class="ji">tag </em>= place<br/><strong class="jg hj">}</strong></span></pre><p id="0c3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MarkerOption变成了lambda。</p><ul class=""><li id="6e7e" class="nx ny hi ih b ii ij im in iq nz iu oa iy ob jc pe od oe of bi translated"><strong class="ih hj"> addCircle(): </strong></li></ul><p id="bb8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原创→</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="968d" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">circle</strong>?.remove()<br/><strong class="jg hj">circle </strong>= googleMap.addCircle(<br/>    <strong class="jg hj">CircleOptions()</strong><br/>        .center(item.<strong class="jg hj">latLng</strong>)<br/>        .radius(1000.0)<br/>        .fillColor(ContextCompat.getColor(<strong class="jg hj">this</strong>, <br/>            R.color.<em class="ji">colorPrimaryTranslucent</em>))<br/>        .strokeColor(ContextCompat.getColor(<strong class="jg hj">this</strong>, <br/>            R.color.<em class="ji">colorPrimary</em>))<br/>)</span></pre><p id="bcdf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Ktx →</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="fe30" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj">circle</strong>?.remove()<br/><strong class="jg hj">circle </strong>= googleMap.<em class="ji">addCircle </em><strong class="jg hj">{<br/>    </strong>center(item.<strong class="jg hj">latLng</strong>)<br/>    radius(1000.0)<br/>    fillColor(ContextCompat.getColor(<br/>        <strong class="jg hj">this@MapsActivity</strong>, R.color.<em class="ji">colorPrimaryTranslucent</em>))<br/>    strokeColor(ContextCompat.getColor(<br/>        <strong class="jg hj">this@MapsActivity</strong>, R.color.<em class="ji">colorPrimary</em>))<br/><strong class="jg hj">}</strong></span></pre><p id="534f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的，CircleOptions也缩小成了lambda。</p><blockquote class="ll lm ln"><p id="5588" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">生命周期Ktx</p></blockquote><p id="9f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将代码从onMapReady()中分离出来:</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="89dc" class="jr js hi jg b fi jt ju l jv jw">override fun onMapReady(googleMap: GoogleMap) {<br/>    <strong class="jg hj">setToSF</strong>(googleMap)<br/>}<br/><br/>private fun<strong class="jg hj"> setToSF</strong>(googleMap: GoogleMap) {<strong class="jg hj"><br/>   </strong> mMap = googleMap<br/><br/>    <em class="ji">// Add a marker in Sydney and move the camera<br/>    </em>val sf = LatLng(37.75, -122.45)<br/>    mMap.addMarker(MarkerOptions()<br/>        .position(sf)<br/>        .title("Marker in San Francisco"))<br/>    mMap.moveCamera(CameraUpdateFactory.newLatLng(sf))<br/>    mMap.animateCamera(CameraUpdateFactory.zoomIn())<br/>    mMap.animateCamera(CameraUpdateFactory.zoomTo(12f), 2000, null)<strong class="jg hj"><br/>}</strong></span></pre><p id="b700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">onCreate():</p><p id="5e73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">原创→</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="5632" class="jr js hi jg b fi jt ju l jv jw">val mapFragment = supportFragmentManager<br/>    .findFragmentById(R.id.map_fragment) as SupportMapFragment</span><span id="2a18" class="jr js hi jg b fi mx ju l jv jw">mapFragment.getMapAsync(this)<br/>mapFragment.getMapAsync { googleMap -&gt;<br/>    addClusteredMarkers(googleMap)<br/>    <br/>    // add zoom control bar<br/>    googleMap.uiSettings.isZoomControlsEnabled = true<br/>    <br/>    // Ensure all places are visible in the map.<br/>    googleMap.setOnMapLoadedCallback {<br/>        val bounds = LatLngBounds.builder()<br/>        places.forEach { bounds.include(it.latLng) }<br/>        googleMap.moveCamera(<br/>            CameraUpdateFactory.newLatLngBounds(bounds.build(), 20))<br/>    }<br/>}</span></pre><p id="047f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Ktx →</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="c465" class="jr js hi jg b fi jt ju l jv jw">val mapFragment = supportFragmentManager<br/>    .findFragmentById(R.id.map_fragment) as SupportMapFragment</span><span id="12b0" class="jr js hi jg b fi mx ju l jv jw"><strong class="jg hj"><em class="ji">lifecycleScope</em>.launchWhenCreated</strong> <strong class="jg hj">{<br/>    <em class="ji">// Get map<br/>    </em>val googleMap = mapFragment.awaitMap()<br/><br/>    <em class="ji">// Wait for map to finish loading<br/>    </em>googleMap.awaitMapLoad()<br/></strong><br/>    <em class="ji">// set location in San Francisco<br/>    </em>setToSF(googleMap)<br/><br/>    <em class="ji">// Ensure all places are visible in the map<br/>    </em>val bounds = LatLngBounds.builder()<br/>    places.<em class="ji">forEach </em>{ bounds.include(it.latLng) }<br/>    googleMap.moveCamera(<br/>        CameraUpdateFactory.newLatLngBounds(<br/>            bounds.build(), 20))<br/>    googleMap.<em class="ji">uiSettings</em>.<em class="ji">isZoomControlsEnabled </em>= true<br/>    addClusteredMarkers(googleMap)<br/><strong class="jg hj">}</strong></span></pre><p id="ed79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有的异步函数都聚集在一起，在lifecycleScope中运行。</p><p id="8eac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们跑吧。Ktx修改应该不会改变过去的结果。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="ecdd" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🤐<strong class="ak"> 11。秘密升级</strong> …… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="3088" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">secrets插件可以节省我们从secret文件导入值的大量工作，比如<strong class="ih hj"><em class="ji">local . properties</em></strong>。</p><blockquote class="ll lm ln"><p id="e032" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated">gradle .模块</p></blockquote><p id="4acf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">插件→</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="de02" class="jr js hi jg b fi jt ju l jv jw">plugins <strong class="jg hj">{<br/>    ...<br/>    </strong>id <strong class="jg hj">'com.google.secrets_gradle_plugin' </strong>version <strong class="jg hj">'0.6'<br/>}</strong></span></pre><p id="1327" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">秘密→</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="3b8a" class="jr js hi jg b fi jt ju l jv jw"><strong class="jg hj"><em class="ji">//// get property from local.properties<br/>//def getProps(String propName) {<br/>//    def propsFile = rootProject.file('local.properties')<br/>//    if (propsFile.exists()) {<br/>//        def props = new Properties()<br/>//        props.load(new FileInputStream(propsFile))<br/>//        return props[propName]<br/>//    } else {<br/>//        return "";<br/>//    }<br/>//}</em></strong><em class="ji"><br/><br/></em><strong class="jg hj"><em class="ji">secrets {<br/>    propertiesFileName 'local.properties'<br/>    ignoreList.add("sdk.*")<br/>}</em></strong></span><span id="8bd5" class="jr js hi jg b fi mx ju l jv jw">android <strong class="jg hj">{<br/>    </strong>compileSdkVersion 30<br/>    buildToolsVersion <strong class="jg hj">"30.0.3"<br/><br/>    </strong>defaultConfig <strong class="jg hj">{<br/>        </strong>applicationId <strong class="jg hj">"com.homan.huang.mapdemo"<br/>        </strong>minSdkVersion 19<br/>        targetSdkVersion 30<br/>        versionCode 1<br/>        versionName <strong class="jg hj">"1.0"<br/><br/>        </strong><em class="ji">//AndroidManifest -- [ Variable: Value ]<br/><br/>       </em><strong class="jg hj"><em class="ji">//manifestPlaceholders = [mapKey: getProps('MAPS_API_KEY')]</em></strong></span></pre><blockquote class="ll lm ln"><p id="171d" class="if ig ji ih b ii ij ik il im in io ip lo ir is it lp iv iw ix lq iz ja jb jc hb bi translated"><strong class="ih hj"> local.properties </strong></p></blockquote><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="b92a" class="jr js hi jg b fi jt ju l jv jw"><em class="ji">#MAPS_API_KEY=blahblahblah<br/></em><strong class="jg hj">mapKey</strong>=<strong class="jg hj">blahblahblah</strong></span></pre><p id="d322" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我重命名了密钥名称，以匹配清单中的名称。</p><pre class="jj jk jl jm fd jn jg jo jp aw jq bi"><span id="510e" class="jr js hi jg b fi jt ju l jv jw">&lt;<strong class="jg hj">meta-data<br/>    android:name="com.google.android.geo.API_KEY"<br/>    android:value="${mapKey}"</strong></span></pre><p id="1330" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">👍快跑。一切都会一样。</p></div><div class="ab cl kz la gp lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="hb hc hd he hf"><h1 id="a2ba" class="jx js hi bd jy jz lg kb kc kd lh kf kg kh li kj kk kl lj kn ko kp lk kr ks kt bi translated">🤗恭喜你。你已经完成了101地图… → <a class="ae jh" href="#f2db" rel="noopener ugc nofollow">菜单</a></h1><p id="5dd2" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">如果你能听懂我的话，请给我鼓掌。</p></div></div>    
</body>
</html>
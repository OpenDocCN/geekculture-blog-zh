<html>
<head>
<title>Introduction to Node.js with MongoDB — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MongoDB node . js简介—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/introduction-to-node-js-with-mongodb-part-2-97542a3d5f47?source=collection_archive---------61-----------------------#2021-07-05">https://medium.com/geekculture/introduction-to-node-js-with-mongodb-part-2-97542a3d5f47?source=collection_archive---------61-----------------------#2021-07-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f517" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在简介的第1部分中，我们介绍了使用Node.js创建数据库、创建新集合、将一个或多个文档插入集合以及搜索一个或多个文档的安装和基本演练。今天，我们将继续我们的旅程，看看其余的CRUD功能。你可以在这里下载今天博客<a class="ae jd" href="https://github.com/celestialheathen/node-mongo-project" rel="noopener ugc nofollow" target="_blank">的启动代码</a>。</p><p id="9c59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据库目前从MongoDB Shell看起来是这样的。提醒一下，数据库的名称是mydb，它包含一个名为pets的集合，到目前为止它有四个文档(如下所示):</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ed8bdcbff7af40969d689fe986485eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luZW5IJaf57eWMStxq411g.png"/></div></div></figure><p id="a10b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要删除一个文档，我们将在Shell中使用db.pets.remove({ query })，在Node.js中，我们将使用deleteOne()和deleteMany()方法来完成此操作。注意deleteOne()删除第一个匹配结果，如果集合包含多个匹配的文档，其余的不会受到影响。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/841780fe9806117a3b2febdce67dea32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdmBhDSJ86_UBDTJOvrb2A.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/0cb76d642e93b1889c16f308efda3cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAg2fWH_dx3z3kkE7ABqFA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Amber is successfully deleted from our database</figcaption></figure><p id="7387" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要删除多个符合查询条件的文档，我们可以使用deleteMany()方法。我们可以直接将查询对象作为参数传入方法，而不是创建查询对象:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c4a818f3a741aa074403f213866af7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F7ftuyzLb4ndEqXmdqKFzQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/783739c19732090f62c5abed9d85a0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVblbw9f9YR9shMWIP-ymw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">We are left with only 1 document after deleteMany({ wild: true})</figcaption></figure><p id="8bfb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">类似地，为了更新一个或多个文档，我们使用updateOne()和updateMany()。如果您还记得我们前一篇博客中的命令，为了只更新一个特定的字段或者向文档中添加一个新的字段，我们将使用$set operator。如果没有它，更新操作将替换整个文档。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/76a70c718ba4e488a6f138c205ecfbaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CAkzh3-0Z9gaKlsgFYepg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Using the #set operator to update a field</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/08c4b6ac64837559aac8182e7af664aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KLoXMJcio9TgumKe1inPTA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">The whole document is replaced if $set operator is not used</figcaption></figure><p id="2487" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Node.js中，$set操作符的功能相同。假设我们要给琥珀添加一个性别字段:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/98f0e6fefa60f27fe41a3a9f5f10de43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*solQpoJn87oTvgou6HF6ZQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/ae3b6513217c58c78f5f0440ae014428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-wI97h3K14nwPY30u0Fww.png"/></div></div></figure><p id="bdad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们想为Mochi更新Wild字段，从false到true:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/450052409a52c7baddf392fb52b83888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*br7osJy1CzIb_PH8azB-Pw.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/b6b6621e06f60f99ddab85f978be11f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*plBHTV8PsZvBXPWOVTf0VQ.png"/></div></div></figure><p id="ac74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">updateMany()将使用新值更新所有符合查询条件的文档。例如，如果我们想将“类型”字段从“猫”改为“猫”,我们可以这样做:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/a7e63f39a5e4f63c7d0316da42a80f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_rXaXBajSJmpbQCmjowVQ.png"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/cbf5735ad1b980db7ac27ce352c45081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xFqlke4ayPZKpojuXYcZow.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">hunter is not updated since he does not have a type field</figcaption></figure><p id="e7a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了演示sort()方法，我在我们的集合中插入了几只不同名字的猫。还把亨特和安珀从收藏中拿走了。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/18038f3d2afd1019ef385bcb9182d647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g2Y2qSHpdtcIBME5WzV-uw.png"/></div></div></figure><p id="8465" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要按特定字段(如名称)进行升序排序，我们可以使用带参数的排序方法:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/798c1d6a62c2e1ab2d3a37f63e503181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DICcRB8AkCi2PUxLSygnCw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">The Console shows the sorted cats</figcaption></figure><p id="081f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了降序排序，我们需要做的就是使用{ name: -1 }作为我们的参数:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/7d51ec53da9e9382da2c41239a000ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9QkzE7ivFdkrBWSxwoIywA.png"/></div></div></figure><p id="99d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要删除整个集合，我们可以简单地使用drop()方法。假设我们想放弃宠物系列:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/647126ada978d15bfea823136a4851bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88N12BD2Y6LsfE3JaxrF-g.png"/></div></div></figure><p id="6094" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了证明集合已经被删除，如果我们从MongoDB Shell中运行show collections，不出所料，什么都没有显示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/7a24b70d4fa2dcbedef2380a586cf577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jTiUo55nvovh_BdVz4BVjw.png"/></div></div></figure><p id="2eda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们现在运行show dbs，mydb将不可见，因为它不包含任何集合。如果它有任何其他收藏(除了宠物)，它仍然会显示。</p><p id="0128" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，要完全删除数据库，我们可以使用dropDatabase()方法。可以想象，数据库中的任何收藏或文档都将被永久自动删除。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1f57f84e1d3b61956355065c36a7737e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KP3WbDiUmmGJ72u-a4h-ZQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Db deleted and we did not get any error messages</figcaption></figure><p id="61b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们关于MongoDB和Node.js的2部分系列的结论。希望您有机会使用这里的一些命令。今天博客的代码可以在这里下载。下次见，编码快乐！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ju"><img src="../Images/05e1dc57e9c8331912e8f79651c7b4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YfC5QqSVVum5mWuK.jpg"/></div></figure></div></div>    
</body>
</html>
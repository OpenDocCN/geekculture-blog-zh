<html>
<head>
<title>Uploading Files to SharePoint Site Via React, Django REST API: A Hack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过React将文件上传到SharePoint站点</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/uploading-files-to-sharepoint-site-via-react-django-rest-api-a-hack-186dd5390483?source=collection_archive---------15-----------------------#2021-06-09">https://medium.com/geekculture/uploading-files-to-sharepoint-site-via-react-django-rest-api-a-hack-186dd5390483?source=collection_archive---------15-----------------------#2021-06-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/87860f349a6b1c83fc4ca731fada7898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*9gBFrfIE4o7a97aa6sVg7w.png"/></div></figure><p id="7a90" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最近，我在做一个项目，需要将文件上传到微软团队的SharePoint文件夹中。要将文件上传到SharePoint文件夹，用户需要提供身份验证凭据以获得身份验证，并能够访问网站以上传文件。但是，不使用通过REST API传递凭证来上传的传统方法来实现相同类型的上传的方法是将OneDrive与团队的SharePoint位置同步的想法。</p><ol class=""><li id="4527" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated"><strong class="io hj">将团队的SharePoint网站与OneDrive同步:</strong></li></ol><p id="1275" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">团队SharePoint站点可能意味着在本地创建一个存储库，即站点的文件和文件夹可以通过文件资源管理器进行管理。通过文件资源管理器执行的任何操作或更改都直接反映在团队站点中(因此，我们可以上传、删除或更改站点位置，而无需真正打开SharePoint位置进行记录)。这可以减轻我们的负担，因为我们不必每次都登录浏览器。</p><p id="5838" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">要同步网站，打开share point网站并点击位于<br/>的同步按钮。考虑一下，我们有一个名为<strong class="io hj"> Share Point文件上传</strong>的团队，由两个<strong class="io hj">渠道组成:1 .通用&amp; 2。上传</strong>。通过单击<br/> 1打开工作组的SharePoint网站。<strong class="io hj"> '…' <br/> </strong> 2。<strong class="io hj">点击在SharePoint中打开<br/> 3。点击工具栏中的“同步”。</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jt"><img src="../Images/f0c9804ac85c32028640f9abe8bf09ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nXD_gXgPBRXazwU6aI6eGQ.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx"><strong class="bd kg">The Site Folder is Syncing</strong></figcaption></figure><p id="498c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这里的目的是将文件夹上传到<strong class="io hj">上传通道</strong>，即<strong class="io hj">我们同步上传文件夹。</strong>我们在文件浏览器中看到，上传通道的一个目录在<strong class="io hj">公司名称父目录下同步为:</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es kh"><img src="../Images/7093b0c88fa5ca9b46fa7958d2125805.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*Y8xn0PMgBoHn0o96TfgUig.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx"><strong class="bd kg">Synced folder to the above SharePoint site</strong></figcaption></figure><p id="6b11" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，任何上传到此<strong class="io hj">分享点上传-上传</strong>文件夹的文件将直接上传到站点文件夹。现在我们构建一个<strong class="io hj">应用程序(React + Django REST) </strong>，通过<strong class="io hj">“SharePoint文件上传—上传”</strong>文件夹将文件上传到SharePoint站点。</p><blockquote class="ki kj kk"><p id="484a" class="im in kl io b ip iq ir is it iu iv iw km iy iz ja kn jc jd je ko jg jh ji jj hb bi translated"><strong class="io hj">设置Django REST后端:</strong></p></blockquote><ol class=""><li id="ae52" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">首先，需要创建一个虚拟环境，要创建虚拟环境请查看<a class="ae kp" href="https://andrewroblesdev.medium.com/creating-a-django-project-inside-a-virtual-environment-8e9b874e1a03" rel="noopener">这篇文章</a>。创建一个文件夹<strong class="io hj"> my-app </strong>，即包含前端和django文件。</li><li id="8844" class="jk jl hi io b ip kq it kr ix ks jb kt jf ku jj jp jq jr js bi translated">在建立虚拟环境之后，我们需要安装其他依赖项。因此，接下来激活虚拟环境，pip安装以下内容:</li></ol><pre class="ju jv jw jx fd kv kw kx ky aw kz bi"><span id="5efc" class="la lb hi kw b fi lc ld l le lf">pip install django<br/>pip install djangorestframework<br/>pip install django-cors-headers<br/>pip install djangorestframework-bulk</span></pre><p id="7f47" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="kl">我们启用</em> <code class="du lg lh li kw b"><strong class="io hj"><em class="kl">cors-headers</em></strong></code> <em class="kl">，因为我们通过不同的端口发送请求。我们导入</em> <code class="du lg lh li kw b"><strong class="io hj"><em class="kl">djangorestframework-bulk</em></strong></code> <em class="kl">来为将要创建的视图集注册路线。</em></p><p id="30de" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3.我们通过创建一个名为<code class="du lg lh li kw b"><strong class="io hj">backend</strong></code> <strong class="io hj"> </strong>的项目和一个名为<code class="du lg lh li kw b"><strong class="io hj">fileuploaderapp</strong></code> <strong class="io hj"> </strong>的django应用程序来创建Django项目，使用如下代码:</p><pre class="ju jv jw jx fd kv kw kx ky aw kz bi"><span id="600a" class="la lb hi kw b fi lc ld l le lf">django-admin startproject backend<br/>python manage.py startapp fileuploaderapp</span></pre><p id="31ba" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">创建应用程序后的文件夹结构如下所示:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lj"><img src="../Images/dd7fda0039f8a50df620e4ab32360ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*rzuO6CpbrSLySg1N7DfJDw.png"/></div></figure><p id="22af" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们修改<code class="du lg lh li kw b"><strong class="io hj">backend/settings.py</strong></code>,将创建的应用程序包含在项目中，并添加一些中间件和其他更改，如下所示:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="c903" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在settings.py中，我们将媒体根目录映射到本地目录中另一个名为<code class="du lg lh li kw b">DocumnetStore</code>的文件夹。上传的文件也在此存储中保存一份副本。</p><p id="86da" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们通过创建一个<code class="du lg lh li kw b"><strong class="io hj">ViewSet</strong></code> <strong class="io hj"> </strong>来修改文件<code class="du lg lh li kw b"><strong class="io hj">fileuploaderapp/views.py</strong></code>用于上传目的<br/> <strong class="io hj">这里定义了3个方法:<br/> 1 .上传::</strong> <code class="du lg lh li kw b"><strong class="io hj">create</strong></code> <strong class="io hj"> <br/> </strong>该方法在用户提交要上传的文件时启动。在这种方法中，我们提供了sharepoint同步文件夹，在该文件夹中上传的文件等同于上传到实际sharepoint网站的文件。<strong class="io hj">2<br/>。上传文件后立即删除::</strong> <code class="du lg lh li kw b"><strong class="io hj">delete</strong></code> <strong class="io hj"> <br/> </strong>此方法处理从SharePoint站点删除文件。当点击上传文件的<strong class="io hj">取消图标</strong>时调用该方法。<br/> <strong class="io hj"> 3。用于在上传摘要中打开上传的文件::</strong><code class="du lg lh li kw b"><strong class="io hj">list</strong></code><strong class="io hj"><br/></strong>File system storage类是一个文件存储API，用于处理本地文件系统中的基本文件存储。这从本地创建的<code class="du lg lh li kw b">DocumentStore</code>中读取文件内容并返回作为响应，该动作被用户观察为:当上传的芯片被点击时，导致再次下载文件。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="4222" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在为我们的API定义一个端点，它将基于API调用的方法调用上面定义的视图集的方法。通过用相应的URL和路由模式注册已定义的视图集来定义端点。为此，在<code class="du lg lh li kw b"><strong class="io hj">fileuploaderapp</strong></code> <strong class="io hj"> </strong>文件夹中创建一个文件<code class="du lg lh li kw b"><strong class="io hj">urls.py </strong></code>。我已经将路由字符串命名为<strong class="io hj">‘upload’</strong>，这将是API端点的一部分。创建的<code class="du lg lh li kw b"><strong class="io hj">fileuploaderapp/urls.py</strong></code>，我们在其中定义了视图集的端点模式，看起来像:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="4e55" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我在项目文件夹(<code class="du lg lh li kw b"><strong class="io hj">backend\urls.py</strong></code>)的urls.py中注册了app ( <code class="du lg lh li kw b"><strong class="io hj">fileuploaderapp</strong></code> ) url routes。打开<code class="du lg lh li kw b"><strong class="io hj">backend\urls.py</strong></code> <strong class="io hj"> </strong>并进行修改，使其最终看起来为:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="302e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们通过导航到后端文件夹运行django服务器:</p><p id="1f5e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du lg lh li kw b">python manage.py runserver</code></p><p id="7426" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在<a class="ae kp" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000/ </a>可以看到django服务器正在运行。</p><blockquote class="ki kj kk"><p id="96e9" class="im in kl io b ip iq ir is it iu iv iw km iy iz ja kn jc jd je ko jg jh ji jj hb bi translated"><strong class="io hj">设置React前端:</strong></p></blockquote><p id="9923" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">首先是React应用程序的设置。运行以下命令:</p><pre class="ju jv jw jx fd kv kw kx ky aw kz bi"><span id="4af3" class="la lb hi kw b fi lc ld l le lf">npx create-react-app my-app<br/>cd my-app<br/>npm start</span></pre><p id="2795" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在这个项目中主要使用了<a class="ae kp" href="https://material-ui.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> React材质的UI </strong> </a>组件来构建UI元素。浏览<code class="du lg lh li kw b"><strong class="io hj">localhost:8000</strong></code>，起始页看起来像左图，<br/>然后在组件文件夹<br/>中创建一个名为<code class="du lg lh li kw b"><strong class="io hj">FileUploader.js</strong></code> <strong class="io hj"> </strong>的组件React App的文件夹结构看起来像右图。</p><div class="ju jv jw jx fd ab cb"><figure class="lm ij ln lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/0139fc1b8b35735a6056fddb6ceb5991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1470/format:webp/1*VJ3ifWn37E_4FOQ0EVBk1w.png"/></div></figure><figure class="lm ij ls lo lp lq lr paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/418bcc29da250315915788b7474ffd88.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*1GezLqN_1hRnuUJkzmtXHg.png"/></div></figure></div><p id="06ed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，安装构建应用程序所需的npm包，如axios、material-ui/core、js-file-download、material-ui/icons、material-ui-dropzone(我已经提到了几乎所有的模块，但是在运行代码时，如果您发现任何模块未找到错误，请npm安装它，如果我错误地遗漏了任何模块)。</p><p id="d628" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在创建的FileUploader组件中，我使用了来自<code class="du lg lh li kw b">material-ui-dropzone</code>的<code class="du lg lh li kw b">DropzoneDialog</code>，文件看起来像这样:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="6bed" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，将这个组件包含在项目文件夹的<code class="du lg lh li kw b">App.js</code>中。然后<code class="du lg lh li kw b">App.js</code>文件看起来像这样:</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="923f" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，在这之后，让我们通过命令<code class="du lg lh li kw b">npm start</code>启动React应用程序，并浏览到<a class="ae kp" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> React应用程序</a>，发现您的应用程序成功运行。现在，我们看到，通过单击“上传”按钮，我们可以</p><ol class=""><li id="f4f5" class="jk jl hi io b ip iq it iu ix jm jb jn jf jo jj jp jq jr js bi translated">上传文件</li><li id="c042" class="jk jl hi io b ip kq it kr ix ks jb kt jf ku jj jp jq jr js bi translated">此外，我们一上传就可以删除它们</li><li id="2fa6" class="jk jl hi io b ip kq it kr ix ks jb kt jf ku jj jp jq jr js bi translated">打开上传的文件。</li></ol><p id="b480" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">应用程序的工作可以通过以下方式证明:</p><p id="5d8e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意:在录制视频时，我没有暴露我的文件浏览器。但是一旦用户点击上传按钮，文件浏览器会自动打开，选择要上传的文件:</strong></p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/27035beb98847b394da91ac8dc471818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*cuXhxB1-r31kZ1C4ZQupqQ.gif"/></div><figcaption class="kc kd et er es ke kf bd b be z dx"><strong class="bd kg">Uploading Files From the File Explorer(The File explorer wasn’t recorded to maintain the privacy of other files but on click of button the explorer opens)</strong></figcaption></figure><p id="dc6e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">上传的文件(111.png，12.png)会上传到Teams文件夹:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/3925372e96273207a3a5e7b1e3474653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*001vtlKBBW1M-YkJNKskPQ.gif"/></div><figcaption class="kc kd et er es ke kf bd b be z dx"><strong class="bd kg">The Uploaded Files found in the Teams Folder</strong></figcaption></figure><p id="24f6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当我们在SharePoint online浏览器中打开它时，它显示为:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lu"><img src="../Images/750d3652ec0a0fdb0223f57e1a9f5ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1xwGSKXS4ukSpxxtyb_-A.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx"><strong class="bd kg">Files Uploaded to the SharePoint Cloud</strong></figcaption></figure><p id="472d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这种方法是对将文件上传到SharePoint站点的传统方法的一种攻击。希望这篇文章可以帮助寻找这种需求的人。</p><p id="fd52" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">注意:这里我使用了一个团队SharePoint文件夹的例子。但是，这种将文件夹同步到在线站点位置的方法可以适用于任何在线文件存储系统，如果它可以映射到本地的同步驱动器的话。</strong></p><p id="e424" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">要直接从GITHUB克隆App，可以访问我的资源库:<br/> </strong> <a class="ae kp" href="https://github.com/SrinidhiKulkarni28/App-to-uplaod-File-to-SharePoint-site-via-Syncing-/tree/master" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> <em class="kl">我的GitHub资源库</em> </strong> </a></p><p id="efd2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">感谢读者耐心阅读本文。嗯…..这篇文章结果很长…但是我希望你喜欢它！</strong></p><p id="935d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">祝读者未来一切顺利！！不要忘记…学习！..微笑！..成长！重复！</strong></p></div></div>    
</body>
</html>
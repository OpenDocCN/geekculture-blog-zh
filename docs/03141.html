<html>
<head>
<title>Make a running tracker with Geolocation API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用地理定位API制作一个运行中的跟踪器</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/make-a-running-tracker-with-geolocation-api-8b2ac541196e?source=collection_archive---------13-----------------------#2021-06-01">https://medium.com/geekculture/make-a-running-tracker-with-geolocation-api-8b2ac541196e?source=collection_archive---------13-----------------------#2021-06-01</a></blockquote><div><div class="dt gx gy gz ha hb"/><div class="hc hd he hf hg"><div class=""/><p id="c0e1" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">利用Web API和Javascript释放手机的能量</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="es et je"><img src="../Images/1993225fa56bbd286a549c5a5a9497ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHVq9tkZ_K7mG-FoZyRNkA.jpeg"/></div></div><figcaption class="jq jr eu es et js jt bd b be z dy">Photo by <a class="ae ju" href="https://unsplash.com/@ventiviews?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Cameron Venti</a> on <a class="ae ju" href="https://unsplash.com/s/photos/jogging?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5657" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi jv translated">定位服务是移动设备的一项重要功能。在享受定向服务、网购时查看最近的库存等所有优势的同时，我总是担心我的数据被收集了多少以及有多详细。使用VPN或关闭定位服务不足以完全保护我们的身份，还会带来很多麻烦。</p><p id="1990" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">今天，我们将探索如何使用Web API来访问地理位置，并摆脱被技术提供商跟踪。</p><p id="868e" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">长话短说，让我们看看我们的最终产品。这个演示是在iPhone X上的Safari中运行的。或者如果你等不及了，在你的手机上试试<a class="ae ju" href="https://ng-the-engineer.github.io/running-tracker/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>。👈</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="ke kf l"/></div></figure><p id="a519" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">如果你不能加载应用，请点击查看浏览器兼容性<a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API#browser_compatibility" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jf jg jh ji fe jj es et paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="es et kg"><img src="../Images/a14ae29fc4c87065f92fe82c7aad2407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gvauXJrK_v6Rd_XNeGMukQ.png"/></div></div></figure></div><div class="ab cl kh ki gq kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hc hd he hf hg"><h1 id="e6eb" class="ko kp hj bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">目录</h1><ol class=""><li id="920e" class="lm ln hj ii b ij lo in lp ir lq iv lr iz ls jd lt lu lv lw bi translated">如何获取地理位置</li><li id="e99a" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">跟踪公式</li><li id="c652" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">地图视图</li><li id="f9e4" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">地图平铺</li><li id="dc78" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">更新地图</li><li id="f12a" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">开始/暂停按钮</li><li id="124e" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">日志查看器</li><li id="a90e" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">给部件接线</li><li id="aa9c" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">综述</li></ol></div><div class="ab cl kh ki gq kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hc hd he hf hg"><p id="6895" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi jv translated">实时地理定位是这个应用的核心。我们将首先学习位和字节的编排。接下来，我们将探索如何通过摆弄配置来进行实际使用。</p><p id="f195" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">地图视图是应用程序的核心展示。我们将浏览地图的设置，绘制跟踪路径和当前位置。</p><p id="ff75" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">为了简化实验，我们将构建一个实时日志查看器来更深刻地理解其中的机制。</p><p id="717b" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">最后，为了性能和可维护性，我们将构建一个基于事件的机制来粘合各个部分。</p><h1 id="46b5" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">如何获取地理位置？</h1><p id="490e" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">我们将利用<code class="dv mk ml mm mn b">Geolocation.watchPosition()</code> <a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/watchPosition" rel="noopener ugc nofollow" target="_blank"> API </a>来请求GPS数据。这个函数被实现为一个观察者模式。当<code class="dv mk ml mm mn b">watchPosition()</code>已经执行时，它将继续监听新的事件。我们在第一个论证中接收事件，即<code class="dv mk ml mm mn b">success</code>。如果API无法定位坐标，它将调用第二个参数<code class="dv mk ml mm mn b">error</code>。<code class="dv mk ml mm mn b">success</code>和<code class="dv mk ml mm mn b">error</code>都被期望作为回调函数来处理个别情况。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><p id="1664" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">如果浏览器支持地理定位API[第2行]，我们将通过传递参数<code class="dv mk ml mm mn b">success</code>、<code class="dv mk ml mm mn b">error</code>和<code class="dv mk ml mm mn b">trackOptions</code>来启动<code class="dv mk ml mm mn b">watchPosition()</code>。我们一会儿将讨论<code class="dv mk ml mm mn b">trackOptions</code>。</p><h1 id="d76f" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">跟踪公式</h1><p id="4d5d" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">这是采样频率和数据精度之间的折衷。默认情况下，它允许无限的响应时间来获得精确的数据。这种设置有利于要求高精度和等待时间的应用。跑步者希望我们的跑步跟踪器以合理的频率记录新的坐标，例如每2-5秒记录一次。较低的数据精度是可以接受的，因为我们关心的是整个路径而不是单个点。因此，我们专门将<code class="dv mk ml mm mn b">trackOptions</code>配置为频率优先于精度。</p><p id="e9e2" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><code class="dv mk ml mm mn b">trackOptions</code>包括参数<code class="dv mk ml mm mn b"><a class="ae ju" href="https://w3c.github.io/geolocation-api/#dom-positionoptions-enablehighaccuracy" rel="noopener ugc nofollow" target="_blank">enableHighAccuracy</a></code>、<code class="dv mk ml mm mn b"><a class="ae ju" href="https://w3c.github.io/geolocation-api/#maximumage-member" rel="noopener ugc nofollow" target="_blank">maximumAge</a></code>和<code class="dv mk ml mm mn b"><a class="ae ju" href="https://w3c.github.io/geolocation-api/#timeout-member" rel="noopener ugc nofollow" target="_blank">timeout</a></code>。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><p id="e647" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><code class="dv mk ml mm mn b">enableHighAccuracy</code>是用于在<code class="dv mk ml mm mn b"><strong class="ii hk">more accurate and use more power</strong></code>和<code class="dv mk ml mm mn b"><strong class="ii hk">less accurate and use less power</strong></code>之间切换模式的布尔值。我们将在教程中启用它，因为功耗不是我们主要关心的问题。</p><p id="e277" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><code class="dv mk ml mm mn b">timeout</code>决定了获得新位置的频率。<code class="dv mk ml mm mn b">timeout</code>的默认值是无穷大，意味着当设备成功获得新坐标时，它将返回。在我们的例子中，我们将覆盖这个值为5秒，以体验一个急切更新的路径和距离表。</p><p id="aec1" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">如果新坐标在超时时不可用，它将使用缓存的值。参数<code class="dv mk ml mm mn b">maximumAge</code>保证坐标不会太过时。如果缓存值比<code class="dv mk ml mm mn b">maximumAge</code>旧，它将寻找新的读数。在我们的例子中，我们使用30秒作为<code class="dv mk ml mm mn b">maximumAge</code>来保持用户体验的流畅。</p><h1 id="a064" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">地图视图</h1><p id="687a" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">为了远离旨在收集地理位置数据和用户身份的技术，我在这个项目中使用了开源库leaflet.js。fleet . js在浏览器中生成地图视图，从手机中的GPS芯片接收地理信息层。没有地理位置数据被发送到任何后端服务器。</p><p id="1fc7" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我们将创建一个全屏地图视图[第6行]，导入<code class="dv mk ml mm mn b">leaflet.css</code>【第9行】<code class="dv mk ml mm mn b">leaflet.js</code>【第16行】，以及我们的自定义逻辑<code class="dv mk ml mm mn b">tracker.js</code>【第30行】<code class="dv mk ml mm mn b">tracker.css</code>【第22行】。然后，添加一个用<code class="dv mk ml mm mn b">id='tracker'</code>指定的<code class="dv mk ml mm mn b">&lt;div&gt;</code>[第28行]作为跟踪器的占位符。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><p id="ea29" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">当应用程序(字面意思是URL)加载后，用户将看到一个显示默认地图的登录页面。我将在教程中使用伦敦中心，但你可以换到任何你想去的地方。<code class="dv mk ml mm mn b">L</code>对象是传单功能入口。我们可以将视图与我们刚刚定义的id为<code class="dv mk ml mm mn b">tracker</code>的div关联起来。接下来，我们将焦点定位到伦敦中心，并传递缩放级别13，显示更少的细节，但覆盖范围更广。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h1 id="b3a6" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">地图平铺</h1><p id="8f7a" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">为了在地图上显示地理区域，我们需要一个地图提供者。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mp kf l"/></div></figure><p id="7051" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">我们将使用<a class="ae ju" href="https://www.mapbox.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ii hk"> Mapbox </strong> </a>，因为它为小批量使用提供了<a class="ae ju" href="https://www.mapbox.com/pricing/" rel="noopener ugc nofollow" target="_blank">免费层服务</a>。要使用它，</p><ol class=""><li id="e8d6" class="lm ln hj ii b ij ik in io ir mq iv mr iz ms jd lt lu lv lw bi translated">注册一个<a class="ae ju" href="https://www.mapbox.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ii hk">地图框</strong> </a>账号，</li><li id="f4ba" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">创建一个API_KEY，作用域为网站的URL。</li><li id="3569" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">复制下面的代码，并用您的代码替换<code class="dv mk ml mm mn b">YOUR_API_KEY</code>。</li></ol><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h1 id="4aca" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">更新地图</h1><p id="4b6a" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">当新地理位置事件出现时，我们将重复三个步骤:</p><ol class=""><li id="5303" class="lm ln hj ii b ij ik in io ir mq iv mr iz ms jd lt lu lv lw bi translated">将路径段延伸到新位置</li><li id="487e" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">重新定位当前标记</li><li id="fc72" class="lm ln hj ii b ij lx in ly ir lz iv ma iz mb jd lt lu lv lw bi translated">刷新测距仪</li></ol><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et mt"><img src="../Images/5469083397cd4604279e7ed1a6d7b7ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/1*SWzlNj3aATh0Jjjny3clWw.gif"/></div></figure><p id="be5b" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">为了确保这些步骤按顺序进行，也为了代码简洁，我们使用<code class="dv mk ml mm mn b">Promise</code>将这三个步骤组织成一个函数链。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h2 id="9fb0" class="mu kp hj bd kq mv mw mx ku my mz na ky ir nb nc lc iv nd ne lg iz nf ng lk nh bi translated">绘制新线段</h2><p id="95ea" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">要初始化第一个路径段，小心传递一个 <code class="dv mk ml mm mn b"><strong class="ii hk">latlng</strong></code> <strong class="ii hk">数组</strong>到<code class="dv mk ml mm mn b"><a class="ae ju" href="https://leafletjs.com/reference-1.7.1.html#polyline" rel="noopener ugc nofollow" target="_blank">L.polyline()</a></code>【第8行】的<strong class="ii hk">数组。接下来，我们将把默认的伦敦地图视图锁定在我们检测到的第一个坐标，并通过<code class="dv mk ml mm mn b">map.setView()</code>【第15行】放大到15级。然后我们用<code class="dv mk ml mm mn b">map.fitBounds()</code>调整到舒适的视野【16线】。</strong></p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h2 id="0f4c" class="mu kp hj bd kq mv mw mx ku my mz na ky ir nb nc lc iv nd ne lg iz nf ng lk nh bi translated">刷新测距仪</h2><p id="31e2" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">血糖仪累计线段的距离，并用id <code class="dv mk ml mm mn b">distance-box</code>更新<code class="dv mk ml mm mn b">&lt;div&gt;</code>。我们将以geoDatasource.com提供的公式为基础。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h1 id="f0b9" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">开始/暂停按钮</h1><p id="0609" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">如果用户准备好开始旅行，我们将创建一个开关来开始跟踪。<code class="dv mk ml mm mn b">watchPosition()</code>开始监视，直到网页关闭。如果用户想休息一下，不在地图上绘制位置，他/她可以关闭它。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et ni"><img src="../Images/2e70262ab3c5f237ef1c6d22586c64c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*8hRXVrUJwsWnk3d11Apg8w.png"/></div></figure><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><h1 id="f43c" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">日志查看器</h1><p id="480b" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">当我开始做这个项目的时候，很多时间都在测试，我在镇上到处跑，在慢跑的时候买了它。我使用半透明叠加效果创建了一个日志查看器，用于故障排除和配置调整。我保留了这个功能，因为它看起来很棒，当我们扩展更多功能时，它会很有帮助。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et nj"><img src="../Images/bdd35d8f3043545e6ac83736cb44577c.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*rCuy1QxazfiseiWW6Adb7g.gif"/></div></figure><h1 id="ab10" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">给部件接线</h1><p id="14b2" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">我们已经得到了<code class="dv mk ml mm mn b">success</code>回调函数，当地理位置被接收时，它将被触发。我们还有管理地图上图形工作的<code class="dv mk ml mm mn b">updateMap</code>功能。是时候把两者结合起来了。</p><p id="d84b" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">最直接的方法是在<code class="dv mk ml mm mn b">success</code>函数中调用<code class="dv mk ml mm mn b">updateMap</code>。然而，有两个缺点。首先，在多任务浏览器环境中，较长的函数链更容易因响应速度较慢而受损。第二，在维护意识上改变的灵活性较差。</p><p id="2a3a" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">因此，我们将采用<a class="ae ju" href="https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events" rel="noopener ugc nofollow" target="_blank">事件驱动的方式</a>来解耦。</p><h2 id="2c58" class="mu kp hj bd kq mv mw mx ku my mz na ky ir nb nc lc iv nd ne lg iz nf ng lk nh bi translated">出版者</h2><p id="69f1" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated"><code class="dv mk ml mm mn b">success</code>回调函数充当<code class="dv mk ml mm mn b">dispatchEvent()</code>【第22行】的发布者。发布者负责将事件放入由某人提供服务的队列中，但它不关心这个人是谁。因此,<code class="dv mk ml mm mn b">success</code>功能是轻量级的且响应迅速。</p><h2 id="5490" class="mu kp hj bd kq mv mw mx ku my mz na ky ir nb nc lc iv nd ne lg iz nf ng lk nh bi translated">订户</h2><p id="fb27" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">附在id为<code class="dv mk ml mm mn b">tracker</code>的<code class="dv mk ml mm mn b">&lt;div&gt;</code>上的订户通过将第一个事件发送到<code class="dv mk ml mm mn b">updateMap()</code>(第26行)来服务队列。</p><figure class="jf jg jh ji fe jj"><div class="bz dz l di"><div class="mo kf l"/></div></figure><p id="1750" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">这种方法的美妙之处在于将负载分布到队列中，并使<code class="dv mk ml mm mn b">success</code>和<code class="dv mk ml mm mn b">updateMap</code>函数免于过载。</p><figure class="jf jg jh ji fe jj es et paragraph-image"><div class="es et nk"><img src="../Images/b63dee63a6861d9b7bd8477457e022c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/1*-1VCfxHc4_XynI_b36v58g.gif"/></div></figure><p id="2a93" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">去慢跑你兴奋吗？在你离开之前，让我们结束吧。</p><h1 id="c85a" class="ko kp hj bd kq kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll bi translated">综述</h1><p id="df9d" class="pw-post-body-paragraph ig ih hj ii b ij lo il im in lp ip iq ir mh it iu iv mi ix iy iz mj jb jc jd hc bi translated">今天，我们已经完成了一个基本但完整的解决方案，来构建一个在浏览器中运行的追踪器web应用程序。虽然我们的目的更多的是探索Web API，但我们可以立即享受到好处，摆脱云提供商的跟踪，在不暴露个人身份的情况下实时使用地图，最重要的是，它是免费的，有趣的。</p><p id="d5cd" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">如果你想免费将手机变成物联网设备，Web地理定位API确实是一个很好的起点。</p><p id="e1fa" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">大多数流行的浏览器广泛支持Android和iOS上的web地理定位API，如果我们处理地理问题，这比原生SDK有优势。缺点是只有纬度和经度可用，尽管其他属性如方向和速度也在接口中定义。</p><p id="40a0" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">令人印象深刻的是，当我在测试期间试图关闭移动数据时，该API在低/无互联网连接的情况下工作。但是，它受到实时地图API的限制，当我的位置在当前图块之外时，它无法更新地图图块。如果我们用离线地图解决方案取代地图API，这将是一个令人兴奋的探索。</p></div><div class="ab cl kh ki gq kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hc hd he hf hg"><p id="83ac" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">感谢你阅读❤️.我希望你喜欢这个分享。</p><p id="3cce" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><a class="ae ju" href="https://ng-the-engineer.github.io/running-tracker/index.html" rel="noopener ugc nofollow" target="_blank">演示</a>🏃</p><p id="d218" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated"><a class="ae ju" href="https://github.com/ng-the-engineer/running-tracker" rel="noopener ugc nofollow" target="_blank">完整的源代码</a>🔥</p><p id="2247" class="pw-post-body-paragraph ig ih hj ii b ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd hc bi translated">如果你对我的另一篇文章感兴趣，请访问我在Medium上的博客。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Pipes In Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角形管道</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/pipes-in-angular-547c28f0e236?source=collection_archive---------4-----------------------#2022-05-28">https://medium.com/geekculture/pipes-in-angular-547c28f0e236?source=collection_archive---------4-----------------------#2022-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7894" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">了解内置管道，在Angular中创建自定义管道和过滤管道</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/17ff9501795692f522cbbb6b46406243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4VAGJqIfGp2J3Amn.jpg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Understanding built-in pipes and creating custom pipes in Angular</figcaption></figure><p id="114e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Angular中的管道用于转换数据，而不会直接影响保存数据的属性。</p><p id="eb34" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们可以转换字符串、货币金额、日期和其他数据进行显示。管道是在模板表达式中使用的简单函数，用于接受输入值并返回转换后的值。</p><p id="b5d0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们可以使用内置管道，也可以创建自定义管道。</p><h1 id="be5b" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated">内置管道</h1><p id="0b05" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">一些内置管道包括:</p><ul class=""><li id="3b44" class="lg lh hi jp b jq jr jt ju jw li ka lj ke lk ki ll lm ln lo bi translated"><code class="du lp lq lr ls b"><em class="lt">uppercase</em></code> <em class="lt"> </em>(将字符串转换成大写)</li><li id="e547" class="lg lh hi jp b jq lu jt lv jw lw ka lx ke ly ki ll lm ln lo bi translated"><code class="du lp lq lr ls b"><em class="lt">lowercase</em></code> <em class="lt"> </em>(将字符串转换成大写)</li><li id="5899" class="lg lh hi jp b jq lu jt lv jw lw ka lx ke ly ki ll lm ln lo bi translated"><code class="du lp lq lr ls b"><em class="lt">date</em></code> <em class="lt"> </em>(将日期格式化成不同的类型)</li><li id="a33f" class="lg lh hi jp b jq lu jt lv jw lw ka lx ke ly ki ll lm ln lo bi translated"><code class="du lp lq lr ls b"><em class="lt">Async</em></code>(订阅一个<code class="du lp lq lr ls b">Observable</code>或<code class="du lp lq lr ls b">Promise</code>，并返回其发出的最新值)</li></ul><p id="0f80" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们用一个例子来理解它们:</p><pre class="iy iz ja jb fd lz ls ma mb aw mc bi"><span id="920a" class="md kk hi ls b fi me mf l mg mh">&lt;p&gt;{{ userName | uppercase }}&lt;/p&gt;<br/>&lt;p&gt;{{ userCountry | lowercase }}&lt;/p&gt;</span></pre><p id="b595" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们所要做的就是写下管道符号|后跟管道名称,就像大写或小写一样。</p><p id="a165" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里用户名和用户国家是角度组件中定义的属性，并保存一些数据。</p><p id="a1c9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">假设<strong class="jp hj">用户名持有- &gt;测试用户</strong>，它将被<strong class="jp hj">转换为- &gt;测试用户</strong>，因为<strong class="jp hj">大写管道</strong>正在被使用，尽管持有数据的属性保持不变。</p><p id="9de9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">同样地说<strong class="jp hj">用户国持有- &gt;印度</strong>，它将<strong class="jp hj">转换为- &gt;印度</strong>，因为<strong class="jp hj">小写管道</strong>正在被使用。</p><p id="0b25" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">日期管道用于格式化日期值。像<em class="lt"> date、currency </em>这样的管道将接受管道函数的参数，要传递参数，需要在管道名称(<code class="du lp lq lr ls b"><em class="lt">date</em></code>)后面加上冒号(<code class="du lp lq lr ls b"><strong class="jp hj"><em class="lt">:</em></strong></code>)和参数值(<code class="du lp lq lr ls b">‘fullDate’</code>)。要检查所有参数，请参考<a class="ae mi" href="https://angular.io/api/common/DatePipe" rel="noopener ugc nofollow" target="_blank">角度文件</a>。</p><p id="76bc" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">例如:</p><pre class="iy iz ja jb fd lz ls ma mb aw mc bi"><span id="88ee" class="md kk hi ls b fi me mf l mg mh">&lt;p&gt;{{ loginDateTime | date: 'fullDate' }}&lt;/p&gt;</span></pre><p id="27df" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">它将输出一个格式化的日期，类似于:<strong class="jp hj">2022年5月28日星期六</strong>而不是时间戳。</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><h1 id="7d48" class="kj kk hi bd kl km mq ko kp kq mr ks kt io ms ip kv ir mt is kx iu mu iv kz la bi translated">链接多个管道</h1><p id="d17d" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">要将多个管道链接在一起，我们只需在不同的管道名称之间使用一个管道操作符(<code class="du lp lq lr ls b"><strong class="jp hj"><em class="lt">|</em></strong></code>)，参见下面的代码示例</p><pre class="iy iz ja jb fd lz ls ma mb aw mc bi"><span id="e596" class="md kk hi ls b fi me mf l mg mh">&lt;p&gt;{{ loginDateTime | date | uppercase}}&lt;/p&gt;</span></pre><p id="9cef" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">它将输出<strong class="jp hj">格式的日期，后面跟着所有大写的内容</strong>，比如:</p><p id="1f06" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><strong class="jp hj">2022年5月28日星期六</strong></p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><h1 id="5d50" class="kj kk hi bd kl km mq ko kp kq mr ks kt io ms ip kv ir mt is kx iu mu iv kz la bi translated">创建自定义管道</h1><p id="3a82" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">我们还可以创建自己的管道，并为其定制转换逻辑。使用命令<em class="lt">ng g p&lt;name _ of _ pipe&gt;</em>，假设我们创建自定义管道，该管道将数据修剪到某个限制，然后如果值超出该限制，则在末尾添加…。</p><p id="fc2a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">从在终端中运行<strong class="jp hj"> ng g p trim </strong>开始:</p><p id="ad79" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这将创建一个trim.pipe.ts，并在app.module.ts声明数组中声明它。它将接受该值，并考虑限制参数和值长度，它将决定是直接返回该值还是返回后跟…字符的分片值</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mv"><img src="../Images/244a93d6bf2112c613ed21bbf949ede3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLocpkdoM7YWiGynuOFhWw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">trim.pipe.ts code</figcaption></figure><p id="49d7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了执行转换，它实现了<strong class="jp hj"> PipeTransform接口</strong>。Angular调用<code class="du lp lq lr ls b">transform</code>方法，将绑定的值作为第一个参数，将任何参数作为列表形式的第二个参数。</p><p id="f41a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们还定义了<strong class="jp hj"> @Pipe decorator </strong>，它将一个类标记为管道并提供配置元数据。通过编写管道符号|后跟trimData，管道名称可直接用于模板绑定。</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><h1 id="62f5" class="kj kk hi bd kl km mq ko kp kq mr ks kt io ms ip kv ir mt is kx iu mu iv kz la bi translated">角形过滤管</h1><p id="3ef2" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">除了转换我们的数据，我们还可以使用管道使用过滤管道过滤我们的数据。</p><p id="346b" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们通过在Angular中创建一个由食物列表组成的基本应用程序来理解这个概念。</p><p id="075c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">每个食品都是一个对象，其中包含名称和类别属性。我们将添加一个搜索过滤器来过滤我们的食品列表，并返回与输入框中提供的类别相匹配的项目。</p><p id="67b6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们还将有一个添加食物按钮，在垃圾类别中添加一个预定义的食物项目。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mw"><img src="../Images/26961253436b3a7a4a5e810f6b2de361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYiqqhDdSSKqo88590Rf1Q.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Running Angular application showing Filter Pipe</figcaption></figure><p id="1d42" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在，如果我输入垃圾，它将触发我的过滤管道逻辑，并返回垃圾类别的食品。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/b3a6e18df4e69a59fc911457cf2fe567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6DgIM2kcWuNBYfpu6zdwg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Running Angular application showing Filter Pipe with junk category being searched</figcaption></figure><p id="4aa6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们看看如何实现这一点:</p><p id="32ef" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">从在你的终端中运行<strong class="jp hj"> ng g p过滤器</strong>开始。这将创建filter.pipe.ts并将其添加到app.module.ts中的声明数组中</p><p id="37a9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">如上所述，FilterPipe类实现了<strong class="jp hj"> PipeTransform接口</strong>，以便执行转换或数据过滤。Angular调用<code class="du lp lq lr ls b">transform</code>方法，将一个绑定的值作为第一个参数，这里将是一个食物项目的数组，将任何参数作为第二个参数。</p><p id="52c9" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们还定义了<strong class="jp hj"> @Pipe decorator </strong>，它将一个类标记为管道并提供配置元数据。在模板绑定中直接使用管道名称，方法是编写管道符号|后跟管道名称—这里是filter。</p><p id="10db" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">纯属性默认为真。为true时，管道是纯的，这意味着只有当输入参数改变而不是数据改变时，才会调用<code class="du lp lq lr ls b">transform()</code>方法。因此，如果我触发了过滤管道，比如在输入中键入垃圾，在此期间，如果我们将更多属于垃圾类别的数据推送到食品数组，它不会反映在结果中。</p><p id="680d" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">因此，我将pure property设置为false，这可能会影响我们的性能，但是当我们的输入参数发生变化或者数据发生变化时，我们的过滤管道逻辑将被触发。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/0dfa4ebe2de171298fb24476d4f802e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiZH8djyrzSRj0xBaGCKuQ.png"/></div></div></figure><p id="23f5" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">最后，将这个过滤管道添加到我们的HTML模板中。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/5dbb151bac00dce68bf24cb6482a92bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTMkXigoQoSOyFiGca88sg.png"/></div></div></figure></div></div>    
</body>
</html>
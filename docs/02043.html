<html>
<head>
<title>How to Develop a Text Recommendation Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何开发一个文本推荐引擎</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-develop-a-text-recommendation-engine-99d3b46effdb?source=collection_archive---------21-----------------------#2021-05-02">https://medium.com/geekculture/how-to-develop-a-text-recommendation-engine-99d3b46effdb?source=collection_archive---------21-----------------------#2021-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b1c1" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">使用TensorflowJS、TypeScript、ReactJS和MongoDB</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/e559f6d4ce3e906ee89aa167e811401f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KtHoihT_07qtAddbu6NNSQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Flow Diagram of a Serverless Recommendation Engine.</figcaption></figure><p id="3246" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">深度学习领域的最新进展使得<strong class="jp hj">将人工智能的力量扩展到网络浏览器</strong>成为可能。TensorflowJS于2018年推出，使web开发人员能够在其应用程序中集成最先进的模型。其中一个模型，<a class="ae kj" href="https://github.com/tensorflow/tfjs-models/tree/master/universal-sentence-encoder" rel="noopener ugc nofollow" target="_blank">通用句子编码器</a>，利用自然语言处理的进步将单词和句子转换成数学向量，称为单词嵌入。</p><p id="a969" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">由深度学习领域的开创性论文开发，包括谷歌的word2vec和斯坦福的GloVe。单词嵌入开启了各种应用:映射同义词和反义词，破译类比，测量偏差。<strong class="jp hj">文本推荐引擎可以理解为一个相似性优化问题。</strong>在向量空间中，这转化为寻找一组初始条件的最近点。</p><p id="ee59" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">使用TensorflowJS将ML操作外包到前端有几个好处，包括:隐私、成本效益、速度和方便。例如，<strong class="jp hj">联邦学习是一种分布式人工智能范式</strong>，它与移动电话和物联网等部署的设备共享训练和预测任务。</p><p id="099c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">以下构建文本推荐引擎的方法<strong class="jp hj">将深度学习的最新进展与地理数据库查询</strong>配对，以创建流畅的用户体验。这在需要快速响应时间和廉价计算成本的数据稀缺应用中特别有效，如社交网络。</p><h1 id="9ef4" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">1.准备我们的数据集</h1><p id="0185" class="pw-post-body-paragraph jn jo hi jp b jq lc ij js jt ld im jv jw le jy jz ka lf kc kd ke lg kg kh ki hb bi translated">假设要提供的潜在推荐的现有数据集已经存在。第一步是<strong class="jp hj">将文本分词</strong>成句子。之后，输入就可以输入TensorflowJS了:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="4b59" class="lm kl hi li b fi ln lo l lp lq">import { Tensor2D } from '@tensorflow/tfjs-node'<br/>import { UniversalSentenceEncoder } from '@tensorflow-models/universal-sentence-encoder'</span><span id="f104" class="lm kl hi li b fi lr lo l lp lq">const embed = async(sentences: string[]):Promise&lt;Tensor2D&gt; =&gt; {<br/>    const model = await use.load()<br/>    const embeddings = await model.embed(sentences)<br/>    return embeddings<br/>}</span></pre><p id="3d55" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在前面的代码中，导入了Tensorflow和句子编码器模型。然后，加载模型，在单行代码中将<strong class="jp hj">句子嵌入到矢量</strong>中。结果是一个由512维向量组成的2D张量，每个向量代表一个句子。</p><p id="e533" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">寻找两个512维点之间的距离是一项缓慢而昂贵的任务。然而，数据库处理空间关系有着悠久的传统。特别是，<strong class="jp hj"> MongoDB支持创建2D索引</strong>并在坐标对上执行查询。为此，我们将使用ml-PCA节点模块来降低单词嵌入的维数。首先，我们训练模型:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="08dc" class="lm kl hi li b fi ln lo l lp lq">import { PCA, IPCAModel } from 'ml-pca'<br/>import { promises as fs } from 'fs'</span><span id="7cdc" class="lm kl hi li b fi lr lo l lp lq">const trainPCA = async(embeddings:number[][]) =&gt; {<br/>    const pca = new PCA(embeddings)<br/>    await fs.writeFile(PCA_ROOT, JSON.stringify(pca))<br/>}</span></pre><p id="3f92" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后我们做出预测:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="1400" class="lm kl hi li b fi ln lo l lp lq">import PCA_Model from PCA_ROOT</span><span id="6d54" class="lm kl hi li b fi lr lo l lp lq">const reduceDimensions(embeddings:number[][]) =&gt; {<br/>    const pca = PCA.load(PCA_Model as IPCAModel)<br/>    const points = pca.predict([embeddings], {nComponents:2})<br/>    return points<br/>}</span></pre><p id="acaa" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">将结果保存到MongoDB后，我们就有了一个干净的推荐数据集，可以随时提供服务了。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ls"><img src="../Images/542c7b42f91494c783a47f43196791f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TNV23lkJdQqQW7b1"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae kj" href="https://unsplash.com/@bthjnr?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Beth Jnr</a> on <a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="dd99" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">2.处理用户的输入</h1><p id="5203" class="pw-post-body-paragraph jn jo hi jp b jq lc ij js jt ld im jv jw le jy jz ka lf kc kd ke lg kg kh ki hb bi translated">要获得提供建议的初始条件集，有两个选项:</p><ol class=""><li id="4021" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">用户所做选择的历史。</li><li id="d284" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">要求用户输入文本。</li></ol><p id="b65c" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">第一个选项很简单:首先，我们只需要找到一个函数来平均用户所做选择的位置。处理文本输入也不难，但是我们需要实现用于处理建议的相同管道。无论如何，我们将会剩下从其中获取DB 的<strong class="jp hj"> 2D坐标:</strong></p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="459b" class="lm kl hi li b fi ln lo l lp lq">const makeRecommendations = async(x:number, y:number) =&gt; {<br/>    const geoNear = {$geoNear: {near:[x,y], distanceField:'dist'}}<br/>    const limit = { $limit: 100 }</span><span id="7448" class="lm kl hi li b fi lr lo l lp lq">    // Get the top 100 Recommendations from the DB collection.<br/>    const recs = await Recs.aggregate([geoNear, limit]).toArray()<br/>    return recs<br/>}</span></pre><p id="bc6d" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们现在已经准备好提供建议了，但是我们还可以再做一件事来<strong class="jp hj">提高我们建议的准确性</strong>:重用最初的512维单词嵌入！</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/7b21f88addeffc764ea5cb4d9fd58610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wxi8HhQgY_MSIblC"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae kj" href="https://unsplash.com/@noahbuscher?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Noah Buscher</a> on <a class="ae kj" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="1f09" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">3.提供建议</h1><p id="3963" class="pw-post-body-paragraph jn jo hi jp b jq lc ij js jt ld im jv jw le jy jz ka lf kc kd ke lg kg kh ki hb bi translated">使用单词嵌入来排列前100个推荐是两个世界中最好的:2D索引的速度；以及512维向量的精度。但是要实现它，我们需要定义和<strong class="jp hj">计算两点之间的距离</strong>。在本例中，我将使用绝对值距离对建议进行排序:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="c72e" class="lm kl hi li b fi ln lo l lp lq">// Absolute Value Distance Computation.<br/>const similarity = (userInput:number[], recommendation:number[])=&gt; {<br/>    if (userInput.length !== recommendation.length) return Infinity</span><span id="3ae2" class="lm kl hi li b fi lr lo l lp lq">    // Iterate through each dimension and compute the difference.<br/>    const delta = userInput.reduce((d, i, idx) =&gt; <br/>        d + Math.abs(i - recommendation[idx])<br/>    , 0)</span><span id="b0fb" class="lm kl hi li b fi lr lo l lp lq">    return delta<br/>}</span><span id="f799" class="lm kl hi li b fi lr lo l lp lq">const sortRecomendations = (userInput:number[], recs:iRec[]) =&gt; { <br/>    return recs.sort(({embeddings:a}, {embeddings:b}) =&gt; <br/>        similarity(userInput, a) &gt; similarity(userInput, b) ? 1 : -1<br/>    )<br/>}</span></pre><p id="2dea" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">然后，使用绝对值距离在React应用程序中呈现排序的建议:</p><pre class="iy iz ja jb fd lh li lj lk aw ll bi"><span id="c831" class="lm kl hi li b fi ln lo l lp lq">import { useEffect, useState } from 'react'</span><span id="f5b9" class="lm kl hi li b fi lr lo l lp lq">const Recommendations = (recs: iRecs[], userInput:number) =&gt; {<br/>    const [ sorted, setSorted ] = useState&lt;iRecs[]&gt;()<br/>    useEffect(() =&gt; { <br/>        const sortedRecs = sortRecomendations(userInput, recs)<br/>        setSorted(sortedRecs)<br/>   }, [recs])</span><span id="e859" class="lm kl hi li b fi lr lo l lp lq">    return sorted.map((r, k) =&gt; &lt;Recommendation {...r} key={k} /&gt;<br/>}</span></pre><p id="1d71" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">最后，为了关闭我们的机器学习管道，我们需要一个系统来<strong class="jp hj">评估和提高结果的准确性</strong>。我建议将匿名化的事件发送到一个产品智能工具，比如Amplitude。这些想法可以让你开始评估模型的性能:</p><ul class=""><li id="af55" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki mi lz ma mb bi translated">建议的贴近度和点击率之间的相关性。</li><li id="27e9" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki mi lz ma mb bi translated">推荐越靠前，点击<strong class="jp hj">的</strong>就越多。</li><li id="f884" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki mi lz ma mb bi translated"><strong class="jp hj">测量</strong>基于时间和日期存在效率差异。</li><li id="a426" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki mi lz ma mb bi translated"><strong class="jp hj">根据搜索和兴趣对</strong>用户进行细分。</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/e559f6d4ce3e906ee89aa167e811401f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KtHoihT_07qtAddbu6NNSQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Review of the flow diagram for a Machine-Learning Text-Recommendation Engine’s Pipeline.</figcaption></figure><h1 id="e653" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">结论:潜在应用</h1><p id="81df" class="pw-post-body-paragraph jn jo hi jp b jq lc ij js jt ld im jv jw le jy jz ka lf kc kd ke lg kg kh ki hb bi translated">感谢您的阅读；作为奖励，我将向你展示六个想法，你可以在这些想法中应用这项技术来建立一个产品或业务:</p><ol class=""><li id="fed0" class="lt lu hi jp b jq jr jt ju jw lv ka lw ke lx ki ly lz ma mb bi translated">一个阅读推荐引擎:类似于网飞对电影所做的<strong class="jp hj">；或者谷歌的应用程序。你可以创建一个应用程序或时事通讯，根据用户的兴趣提供阅读建议。</strong></li><li id="30c8" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">文档索引:学术、医学或法律等领域可以受益于基于重要查询的分类和快速检索相关信息的能力。</li><li id="a881" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">搜索文档:AWS文档包含数千页和数百种产品。AWS Kendra 使用机器学习为其搜索引擎提供动力。有了这种算法，你可以创造一种竞争的、非专有的技术来在其他文档中搜索答案。</li><li id="5b9a" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">了解你的用户:如果你的网站或应用有一个搜索组件:你可以<strong class="jp hj">通过了解你的客户基于他们的搜索想要什么来指导你的营销工作</strong>。</li><li id="0f56" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">有意义的视觉化:试图从视觉上理解一次会议或一周的电子邮件后发生的事情是很困难的。想象一下基于单词嵌入创建图表来<strong class="jp hj">总结和测量非数字交互。</strong></li><li id="3fb5" class="lt lu hi jp b jq mc jt md jw me ka mf ke mg ki ly lz ma mb bi translated">社交网络:通过推荐最好的内容，在用户中发展有意义的关系，建立<strong class="jp hj">智能自动调节</strong>工具，来建立下一个繁荣的利基社交网络。</li></ol></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><p id="e16a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我希望你喜欢这个故事，并觉得它有用。如果你有兴趣阅读更多关于前端的创业型AI，请考虑给我一个关注。像往常一样，你们的掌声和鼓励的话语会受到高度赞赏。</p></div></div>    
</body>
</html>
<html>
<head>
<title>Distribute and Manage your SW using the IoT paradigm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用物联网模式分发和管理您的软件</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/distribute-and-manage-your-sw-using-the-iot-paradigm-406b2f1b4369?source=collection_archive---------58-----------------------#2021-08-03">https://medium.com/geekculture/distribute-and-manage-your-sw-using-the-iot-paradigm-406b2f1b4369?source=collection_archive---------58-----------------------#2021-08-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1cfe" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何简化分布式环境中的软件部署</h2></div><p id="6efe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">随着软件复杂性的增长和安全要求的日益严格，软件分发变得越来越具有挑战性。特别是在工业环境中，软件组件在许多隔离的、地理上分散的物理站点中部署和管理，自动化和保护软件分发是非常复杂的。有许多解决方案，每一个都是针对特定场景和特定假设而设计的。我们面临的挑战是为这项任务找到正确的工具和正确的方法。本文建议采用IIoT(工业物联网)范例来解决工业环境中复杂的软件分发问题。我将展示在隔离环境中运行的现代微服务解决方案的管理与典型的IIoT场景之间有许多共性。因此，在许多情况下，采用IIoT设计方法和使用物联网框架来分发软件将是有益的。下面介绍的方法并不是灵丹妙药。对于一些复杂的用例，如部署在内部数据中心的大型Kubernetes集群，物联网范式可能不适合，但对于许多较简单的情况，采用物联网设计模式将是一种快速的胜利。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/9c00142811c8db8987d1b658bfa14a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:60/0*Gk66JGjHP1FHwrhN"/></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kb"><img src="../Images/0879ee8d76151be4215411d4fd96ab3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZONJU8EWkvIF7RbO.png"/></div><figcaption class="kc kd et er es ke kf bd b be z dx">IoT to the rescue for SW distribution in Industrial settings</figcaption></figure><h1 id="d5a0" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">从简单设备到独立边缘</h1><p id="e89c" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">物联网框架通常涉及许多该框架必须控制的小型设备。这是每个商业物联网框架的<a class="ae ld" href="https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-device-management-overview" rel="noopener ugc nofollow" target="_blank">设备管理</a> (DM)模块的职责。每个设备都有一些元数据，比如DM大规模维护的状态和配置。DM模块还负责新设备的部署和软件升级，同时保持最高的安全标准。在传统物联网设置中，软件(通常嵌入在硬件中的固件)很小，有时甚至没有操作系统。在这种情况下，软件被打包成为设备定制的完整映像，软件升级过程只需下载整个映像并重启设备。在现代IIoT中，更多的责任被委托给“边缘”。今天，运行执行复杂计算(如机器学习(ML)模型或统计分析)的软件的设备很常见。我们看到一种趋势，即边缘变得越来越独立，这导致更快的响应时间和更少的带宽。这种趋势也意味着设备运行更复杂的软件，因此我们现在看到的设备运行类似后端的docker映像，而不是在设备上安装小映像。边缘变得更加独立的事实并没有改变管理的规模。物联网DM必须为每台设备维护元数据，无论它有多智能。它必须确保在防火墙和断开的网络之后进行安全的配置和更新。这使得它成为一种有趣的软件分发机制。</p><h1 id="4341" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">工业软件管理挑战</h1><p id="28d1" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">当涉及到软件分发时，基于现代微服务的软件带来了挑战，因为每个服务(根据设计)都是独立的实体。由于硬件和软件版本的许多可能组合，再加上许多物理上隔离的地理上分散的站点，软件<a class="ae ld" href="https://en.wikipedia.org/wiki/Configuration_management" rel="noopener ugc nofollow" target="_blank">配置管理</a> (CM)成为一个巨大的话题。显然，我不能在这里完整地描述它，但是为了本文的目的，我想强调几个基本的挑战:</p><ul class=""><li id="5811" class="le lf hi iz b ja jb jd je jg lg jk lh jo li js lj lk ll lm bi translated"><strong class="iz hj">可见性</strong>:系统的所有者需要了解安装的每个软件组件的详细信息和状态。有许多组件、装置、站点、硬件和软件版本等。，那将成为一项复杂的任务。</li><li id="945e" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated">联网:工业环境通常通过隔离的专用网络和几层防火墙与互联网隔离。因此，我们必须假设不可能打开端口并监听外部通知，即使是来自可信的控制系统。然而，我们需要能够从一个中心位置推送软件更新。</li><li id="93c2" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">身份</strong>:工业自动化是任何工业数字化转型的关键。我们应该假设在几乎所有的过程中都没有人的参与，因此传统上为人类身份设计的身份管理现在应该被实现来处理自动实体。每台设备都必须有一个带有权限和安全策略的身份。在站点和云之间的所有通信中(例如软件更新过程)，双方都应该对另一方的身份有信心。</li></ul><h1 id="7232" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">使用物联网范式</h1><p id="92bb" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">通过将每个托管的内部软件组件视为“设备”或“设备”中的“模块”，我们可以利用物联网框架从一个中心位置全面管理这些组件。并非今天所有可用的物联网框架都支持容器化软件，但随着“智能边缘”变得越来越流行，许多框架都支持。例如，我将使用Azure IoT Edge框架来演示集中软件部署和配置管理所需的不同功能。</p><h1 id="129a" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">安全双向通信</h1><p id="4b35" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">也许任何物联网解决方案的最基本功能都是能够与上游(设备到云)设备通信，以便将遥测数据从设备发送到云，以及与下游(云到设备)设备通信，以便将命令从云发送到设备。物联网解决方案使用多种通信协议来实现这一点，选择通常基于设备的计算能力和所需的连接级别。LWM2M、MQTT、AMQP和HTTPS只是物联网框架使用的通信协议的几个例子。每种协议的细节和属性以及它如何实现双向安全通信超出了本文的范围，但直接的结果是，如果我们选择使用物联网解决方案作为软件管理的框架，我们就可以跨防火墙和隔离网络进行安全的双向通信。</p><h1 id="d3ba" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">集中视图</h1><p id="a299" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">物联网框架的另一个最重要的功能是从一个中心位置监控数百万台设备的能力。物联网设备管理(DM)提供了收集、存储、查询和可视化设备元数据和状态的方法。在Azure IoT中，<a class="ae ld" href="https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-device-twins" rel="noopener ugc nofollow" target="_blank">设备双胞胎</a>和<a class="ae ld" href="https://docs.microsoft.com/en-us/azure/iot-hub/iot-hub-devguide-module-twins" rel="noopener ugc nofollow" target="_blank">模块双胞胎</a>是元数据、配置和条件的核心数据元素。这样，我们可以存储和监控安装的每个软件组件的版本和状态。Azure IoT提供可视化工具和集成，例如与Azure Monitor 的<a class="ae ld" href="https://docs.microsoft.com/en-us/azure/iot-edge/how-to-collect-and-transport-metrics?view=iotedge-2020-11" rel="noopener ugc nofollow" target="_blank">集成，该集成支持基于twins中捕获的数据的集中视图和警报。Azure Digital twin是另一个Azure服务，支持对twins中捕获的信息进行语义处理。这种语义处理可以捕获软件组件之间的关系，例如兼容性和配置有效性。典型物联网场景中所需的设备管理的规模和复杂性是巨大的，因此使用物联网基础设施进行软件分发可以提供所需的所有管理功能。</a></p><h1 id="48f8" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">大规模自动化软件部署。</h1><p id="8e48" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">物联网解决方案假定设备数量异常庞大。因此它们是为自动化和集成而设计的。当您推送更新时，您必须从数百万台已部署的设备中确定合适的设备，然后将合适的更新推送至所有符合条件的设备。这种自动化在工业环境中是必要的，因为像在物联网场景中一样，工业环境也包括大量部署的组件。Azure IoT Edge支持从Azure门户以及CLI和DevOps工具进行大规模部署。您可以将部署模板定义为自动识别目标并推送正确软件的代码。</p><h1 id="4d98" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">安全是核心</h1><p id="b535" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">恶意软件注入是针对工业软件的最常见的攻击手段之一。针对此类攻击有许多类型的缓解措施。核心是要遵循几个原则:</p><ul class=""><li id="006b" class="le lf hi iz b ja jb jd je jg lg jk lh jo li js lj lk ll lm bi translated"><strong class="iz hj">证明:</strong>确保软件位的完整性，例如通过使用数字签名来验证要安装的软件包的来源、真实性和完整性。</li><li id="5046" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">认证</strong>:在后端和设备之间使用相互强认证，这样双方可以相互信任。</li><li id="f6d9" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">授权</strong>:应用最小特权原则，这样系统的组件应该只能访问执行它们的角色所需的最少的资源和数据。</li><li id="e5b7" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">安全供应和密钥管理:</strong>使用物联网框架提供的工具&amp;协议注册新设备并存储其秘密。</li><li id="a054" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">安全通信</strong>:仅使用基于行业成熟安全协议的基于证书的安全通信通道。</li><li id="2eac" class="le lf hi iz b ja ln jd lo jg lp jk lq jo lr js lj lk ll lm bi translated"><strong class="iz hj">审核</strong>每个软件的更新和管理操作。</li></ul><p id="6b20" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所有这些原则都是所有领先物联网解决方案的设备供应和管理的核心。因此，在工业环境中采用物联网模式进行软件分发是一个立竿见影的安全胜利。</p><h1 id="b299" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">核心的容器</h1><p id="9233" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">在IIoT和工业环境中，软件和硬件的正确组合是关键。因此，软件分发基础设施必须支持任何硬件和任何操作系统，或者换句话说:运行容器。Azure物联网边缘模块被实现为Docker兼容的容器并不奇怪。Docker为创建容器提供了许多选项，这些选项也适用于物联网边缘模块。例如，您可以让模块访问主机存储、映射端口或限制模块内存和CPU的使用。Azure IoT Edge使用Docker背后的开源项目<a class="ae ld" href="https://github.com/moby/moby" rel="noopener ugc nofollow" target="_blank">莫比</a>作为其Docker兼容引擎。这为容器编排打开了大门。例如，Kubernetes可以与Azure IoT Hub对话，以在远程边缘设备中部署容器。这种集成的优势在于能够使用标准的Kubernetes工具和部署机制来<a class="ae ld" href="https://azure.microsoft.com/es-es/blog/manage-azure-iot-edge-deployments-with-kubernetes/" rel="noopener ugc nofollow" target="_blank">大规模编排edge模块</a>。</p><p id="7094" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用Kubernetes来编排边缘计算模块是完全有意义的。Azure IoT Edge严重依赖容器运行时和容器来执行本地处理。每个物联网边缘设备可能运行数十个容器，这些容器协同工作，以处理数据处理和业务逻辑。这些容器通过注册了多个边缘设备的物联网中心推送。通过使用标签，容器可以一次部署到多个边缘设备。Azure IoT Hub的行为就像Kubernetes的一个典型的工人节点。一旦Azure物联网控制平面指示在目标设备上将物联网边缘模块作为容器运行，它就会将容器映像打包为模块，并将其移交给远程边缘设备。由于每个边缘设备可能运行多个容器，因此可以将它们与Kubernetes pods进行比较。当物联网中心通过物联网边缘提供商<a class="ae ld" href="https://azure.microsoft.com/en-us/resources/videos/azure-friday-virtual-kubelet-introduction/" rel="noopener ugc nofollow" target="_blank">虚拟Kubelet </a>向Kubernetes注册时，主节点会将物联网中心视为一个节点。当部署以物联网中心为目标时，Kubernetes控制平面只需将调度部分移交给物联网中心。开发人员和操作人员可以使用在YAML声明的熟悉清单，这些清单是通过kubectl CLI推送的。</p><h1 id="90bd" class="kg kh hi bd ki kj kk kl km kn ko kp kq io kr ip ks ir kt is ku iu kv iv kw kx bi translated">摘要</h1><p id="d650" class="pw-post-body-paragraph ix iy hi iz b ja ky ij jc jd kz im jf jg la ji jj jk lb jm jn jo lc jq jr js hb bi translated">IIoT软件分发面临着与工业环境中的典型软件分发类似的挑战。两者都有许多组件在地理上分散的隔离网络中运行，都必须符合最高的安全标准，并从一个中心位置进行管理和监控。有些人会声称工业环境是IIoT的私人案例，因此使用IIoT框架和基础设施来管理工业环境中的软件是有意义的。</p><p id="1771" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后说明:为了能够继续发布新的故事，Medium现在要求作者拥有最低数量的关注者，所以请帮助我继续发布，并按下我名字旁边的“关注”按钮。</p></div></div>    
</body>
</html>
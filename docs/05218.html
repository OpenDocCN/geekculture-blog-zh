<html>
<head>
<title>Swift Map of a Location Address</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">位置地址的Swift地图</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swift-map-of-a-location-address-dadb167786d8?source=collection_archive---------3-----------------------#2021-07-15">https://medium.com/geekculture/swift-map-of-a-location-address-dadb167786d8?source=collection_archive---------3-----------------------#2021-07-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="62d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Swift MapKit将显示位置街道地址的地图</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/d3c320f82d1f52947923dea7711ffd36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*uWXfcck4W_nwZ8W2bh9oaQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">AppsGym ToDo App Map of a Location Address</figcaption></figure><h1 id="c8aa" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">方案</h1><p id="eb4d" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们的应用程序待办事项详细信息视图将有一个地图按钮，用户可以点击以显示位置文本字段地址的地图。</p><h1 id="a35d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">技术</h1><p id="a569" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们将利用<strong class="ih hj"> MapKit </strong>框架、<strong class="ih hj"> GLGeocoder() </strong>和地理编码。<strong class="ih hj">地理编码</strong>是将地址(如街道地址)转换为地理坐标(如纬度和经度)的过程，您可以使用地理坐标在地图上放置标记或定位地图。反向地理编码是将地理坐标转换为人类可读地址的过程(参考Google)。</p><p id="844e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的地图视图中，我们将把位置地址文本转换成一个<strong class="ih hj">地标</strong>坐标，然后用于定位和绘制地图。因此，我们将利用<strong class="ih hj">地理编码器geocodeAddressString(..)</strong>函数，以位置文本为参数，检索一个地标坐标，然后用一个<strong class="ih hj"> MKPointAnnotation() </strong>绘制一个地图图钉(Annotation)，以位置地址为图钉标题。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/1bc57c8bb5c5c528d6263067ba3885d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/1*RupILp0B6vHU_Mcex_z3fA.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">GIF Details Map Button Segues to the Map View</figcaption></figure><h1 id="bc30" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">观众</h1><p id="d86a" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">本文面向寻求完整、成熟、以代码为中心的解决方案来加速开发项目的Swift开发人员。下面的代码片段可以通过最小的定制来使用。</p><h1 id="8112" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">应用模型</h1><p id="76b8" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们的文章基于苹果应用商店上发布的AppsGym <a class="ae kt" href="https://appsgym.com/todo-lists-notifications-multimedia/" rel="noopener ugc nofollow" target="_blank"> ToDo </a>模型应用，你可以在AppsGym.com上免费下载完整的<a class="ae kt" href="https://appsgym.com/downloads/" rel="noopener ugc nofollow" target="_blank"> Xcode </a>项目。</p><h1 id="2233" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用户界面</h1><p id="c0b1" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">我们需要一个细节视图上的<strong class="ih hj">地图</strong><strong class="ih hj">ui按钮</strong>，它将继续到地图视图。笔记地图视图将在整个屏幕上显示地图，使用<strong class="ih hj"> MKMapView，</strong>突出显示红色大头针(注释),其标题作为位置地址。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ku"><img src="../Images/591d58bd5f8035f19e18203481471aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*zU4XO2QXEGFLtAvYOStykw.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">ToDo Details View Map Button</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/2a2ae26d8eb4e29fd1fb238acb7d306c.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*6twLhzmQwi-pSOP2-nv5LQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Map View Pin with Address</figcaption></figure><p id="9e4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">细节和地图<strong class="ih hj">故事板</strong>显示细节视图地图按钮和一个简单的“显示”序列，而地图视图只有一个<strong class="ih hj"> MKMapView </strong>覆盖整个视图区域。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/7adaf56fa0ed88170a073e8ec5793347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_xHlGbh5_lokzMcP94pNg.png"/></div></div></figure><p id="7d74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:在您的应用程序中，您可以选择一个覆盖部分视图的地图视图，或者甚至作为详细视图的弹出模式(请参考我们关于Swift浮动弹出的文章)。</p><h1 id="4d86" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">逻辑</h1><p id="80a1" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><strong class="ih hj">note detailsview controller . swift</strong>将包含一个地图UIButton，它最初将显示是否输入了一个位置(通过将按钮图像从灰色变为彩色)。如果有位置字段文本，该按钮将使用显示“推送”继续到<strong class="ih hj">notemapviewcontroller . swift</strong>。我们可以直接在故事板上建立序列，或者通过编程在UIButtonAction中建立序列。我们的模型应用程序使用直接故事板序列，因为这是一个相对简单的设置。<em class="lb">注意</em>:如果你正在使用<em class="lb"> SwiftUI </em>，那么使用编程方式。</p><p id="cf9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们需要NoteMapViewController中的实际位置地址，我们可以通过segue传递位置文本字段值，或者传递完整的note对象。对象方法允许我们访问所有笔记的其他属性，如标题、文件夹、图像等。在我们的模型应用程序中，我们将传递note对象以允许将来的灵活性。</p><p id="97b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">notes mapviewcontroller . swift</strong>作为<strong class="ih hj"><em class="lb">MKMapViewDelegate</em></strong>来绘制地图和定位标注管脚。</p><p id="dca5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用note对象传递location属性，因此我们将使用<strong class="ih hj"> geocodeAddressString(..)</strong>将定位文本串转换成一个<a class="ae kt" href="https://developer.apple.com/documentation/corelocation/clplacemark" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> CLPlacemark </strong> </a>，然后提取Placemark坐标来定位标注管脚。</p><p id="888f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="lb">注意</em> </strong>:如果您在应用程序中选择一个<em class="lb"> UITextView </em>，而不是UITextField，那么您需要将地址组件连接成一个单独的文本字符串，然后作为参数提交给geocodeAddressString(..).</p><h1 id="b53a" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">密码</h1><p id="cd10" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated"><strong class="ih hj">NoteDeatils View controller . swift</strong><strong class="ih hj">地图按钮&amp;转到地图视图</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="1b58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">notemapviewcontroller . swift</strong>T32】初始化</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="d592" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">notemapviewcontroller . swift<strong class="ih hj">viewDidLoad()</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="1326" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">notemapviewcontroller . swift<strong class="ih hj">委托方法</strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lc ld l"/></div></figure><p id="6c0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">位置文本无效怎么办？</strong></p><p id="5afd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果位置字段文本无效(例如“BlahBlah”)，则MapKit将根据用户的总体位置(通常是国家视图)绘制默认地图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/0a6f06e1788b4232b0df549e2938c748.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*JugyxIRkRhZtExnwj_4KMA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lf"><img src="../Images/40f7136d4ea05e2184490fe9dcd0aa71.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*mmphTYVwYOx70Haw4BWPdQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Default Map if Note Location Field Has Invalid Text (User in Australia)</figcaption></figure><p id="dd7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文介绍了显示注释位置地址文本字段地图的完整设置、逻辑和代码。“注释细节视图地图”按钮将转到一个专用的地图视图，该视图充当MKMapViewDelegate并绘制地图和任何带注释的图钉。希望这篇文章对你的应用有用。感谢阅读！</p></div></div>    
</body>
</html>
<html>
<head>
<title>Making the BOSS Enemy Wave in Unity using UI Value</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用UI值在Unity中制造BOSS敌人波</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/making-the-boss-enemy-wave-in-unity-using-ui-value-8be66173e2ce?source=collection_archive---------39-----------------------#2021-07-07">https://medium.com/geekculture/making-the-boss-enemy-wave-in-unity-using-ui-value-8be66173e2ce?source=collection_archive---------39-----------------------#2021-07-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4e392c7ffd164d9e7d50ac7973e81666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wmwqVYZwl9OUdncNvut5g.png"/></div></div></figure><p id="efed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的练习演示了使用UI元素部署boss敌人波。</p><p id="c942" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在完成这一部分时，我面临的最大挑战是在spawn manager中停止方法执行。在搜索了几个明显不起作用的选项后，我决定使用一个UI元素来成为这里的驱动程序。</p><p id="8ced" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是手头任务的基本伪代码。</p><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jo"><img src="../Images/60c9e63eeb9a598f9be7b8d7b164c030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QGqWwyMITQSgPIp0kqkIMA.png"/></div></div></figure><p id="631d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的文章没有按照上面显示的顺序，因为在让这种机制像看起来那样简单地工作之前，需要将一些东西放在一起。</p><p id="a024" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，让我们把敌人的波放在适当的位置。我正在添加另一个wave类型的脚本化对象。请阅读这篇<a class="ae jt" href="https://samarthdhroov.medium.com/implementing-enemy-wave-system-part-2-9779da7ba674" rel="noopener">文章</a>以了解更多关于可脚本化对象的信息。</p><div class="ju jv ez fb jw jx"><a href="https://samarthdhroov.medium.com/implementing-enemy-wave-system-part-2-9779da7ba674" rel="noopener follow" target="_blank"><div class="jy ab dw"><div class="jz ab ka cl cj kb"><h2 class="bd hj fi z dy kc ea eb kd ed ef hh bi translated">实施敌波系统—第二部分</h2><div class="ke l"><p class="bd b fp z dy kc ea eb kd ed ef dx translated">samarthdhroov.medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jx"/></div></div></a></div><ol class=""><li id="f7f2" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn kq kr ks kt bi translated">创建一个波对象的老板敌人，分配预置波和分配波的产卵经理没有失败。</li></ol><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/0737fc0468ab9ece4a8dc4e5429bf7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*aPmH0ZT4x5KEb2aNfS3V8A.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx">Unity</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/4dd595e4e368e9db5774a1b6e9ef44e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcPh3F2KjhuorhBLR7rRig.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Unity</figcaption></figure><p id="f5dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">boss敌人预置带有标准组件，如碰撞器，刚体，音频源，动画，和一个专用脚本。</p><blockquote class="la lb lc"><p id="9471" class="iq ir ld is b it iu iv iw ix iy iz ja le jc jd je lf jg jh ji lg jk jl jm jn hb bi translated"><strong class="is hj">一旦产卵经理得到这波，它将转移到下一波，在这种情况下，不存在。所以，它会退出游戏。</strong></p><p id="4892" class="iq ir ld is b it iu iv iw ix iy iz ja le jc jd je lf jg jh ji lg jk jl jm jn hb bi translated"><strong class="is hj">因此，当玩家和老板之间的战斗正在进行时，必须有一个信号让种子管理者暂停。解决方案？</strong></p></blockquote><p id="69f4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.Unity system带有一个名为“WaitUntil()”的内置方法。该参数是一个委托，当该委托为真时，暂停结束，繁殖管理器可以转到下一个任务。简单:)</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="70f5" class="lm ln hi li b fi lo lp l lq lr">else if(item.tag=="Boss Enemy")<br/>{yield return new WaitUntil(<strong class="li hj">() =&gt; EnemyDead()</strong>);}</span><span id="545e" class="lm ln hi li b fi ls lp l lq lr"><strong class="li hj">bool EnemyDead()</strong><br/>{<br/>if (_bossHealthBar.GetComponent&lt;ThrustSlider().GetSliderValue() &lt; 0.2f)<br/>           return true;<br/>       else<br/>           return false;<br/>   }</span></pre><ul class=""><li id="5a07" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">上面的EnemyDead()方法根据boss敌人的最新生命值返回一个布尔值。</li><li id="7eab" class="kl km hi is b it lu ix lv jb lw jf lx jj ly jn lt kr ks kt bi translated">如果老板的生命值低于0.2，实际上，可以认为老板已经死了。</li><li id="b0ea" class="kl km hi is b it lu ix lv jb lw jf lx jj ly jn lt kr ks kt bi translated">在这里，_bossHealthBar指的是附加了一个ThrustSlider组件的UI元素，该组件又有一个GetSliderValue()方法。</li></ul><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/7dccf1fb0f37ba61e9c22b6e207e6159.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*xewsKf5lgaB5XOZyjCSjyw.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx">C#</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/3a9b67d15c15b1d7dbc352f5daa6ce03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BndUT_o_LzhgDIxXfxUOZg.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Unity</figcaption></figure><figure class="jp jq jr js fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/7f5ae7b5bfdfe1c43beaaa683c331948.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*8ZF2F7yDeHDEJ4MCDFCqBw.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx">C#</figcaption></figure><p id="762d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.要实现这一点，boss脚本必须与这个UI元素对话。</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="661a" class="lm ln hi li b fi lo lp l lq lr">ThrustSlider _bossHealthBar; //HealthBar reference variable.<br/>private Player player; // Player Reference variable.</span><span id="05ec" class="lm ln hi li b fi ls lp l lq lr">void Start() // Getting hold of the bar's slider component.<br/>   {<br/>    _bossHealthBar = GameObject.Find("BossHealthBar").GetComponent&lt;ThrustSlider&gt;();</span><span id="ba41" class="lm ln hi li b fi ls lp l lq lr">if(GameObject.Find("Player")!= null) //Saves from Null Ref Exce.<br/>       {<br/>          player = GameObject.Find("Player").GetComponent&lt;Player&gt;();<br/>       }<br/>   }</span><span id="01e1" class="lm ln hi li b fi ls lp l lq lr">private void OnTriggerEnter2D(Collider2D collision) //Value changes.<br/>   {<br/>       float health = _bossHealthBar.GetSliderValue(); //Base value.<br/> <br/>       if (collision.tag == "<strong class="li hj">Laser</strong>")<br/>       {<br/>           <strong class="li hj">health -= 0.5f;</strong> // Value Deduction.<br/>           _bossHealthBar.ChangeSliderValue(health); // New value.<br/>           player.AddScore(10); // Addition to the player score.<br/>       }<br/> <br/>       if(collision.tag == "<strong class="li hj">GreenLaser</strong>")<br/>       {<br/>          <strong class="li hj"> health -= 1.0f; </strong>// Value Deduction.<br/>           _bossHealthBar.ChangeSliderValue(health); // New value.<br/>           player.AddScore(20); // Addition to the player score.<br/>       }<br/> <br/>       if(collision.tag == "<strong class="li hj">Missile</strong>")<br/>       {<br/>          <strong class="li hj"> health -= 1.5f; </strong>// Value Deduction.<br/>           _bossHealthBar.ChangeSliderValue(health); // New value.<br/>           player.AddScore(30); // Addition to the player score.<br/>       }<br/>   }</span></pre><h1 id="39be" class="mc ln hi bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">UI元素就是这样成为最后一战的裁判的。</h1><p id="fbc3" class="pw-post-body-paragraph iq ir hi is b it mz iv iw ix na iz ja jb nb jd je jf nc jh ji jj nd jl jm jn hb bi translated">(虽然我不确定这种战斗的行业标准实现是什么，但我决定现在就提出这个。随着时间的推移，我肯定会找到更好的解决方案。)</p><p id="99cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.让我们让老板开始，并移动到屏幕中心的预定位置，并准备发射。</p><ul class=""><li id="2b59" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">创建一个空的游戏对象，并根据敌人预设的大小和偏好放置它。</li><li id="6eac" class="kl km hi is b it lu ix lv jb lw jf lx jj ly jn lt kr ks kt bi translated">为精确起见，请给该对象添加一个标签。</li></ul><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/f68454e45070a0d59243b204d2ce231f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qTlyoPZodffVAIhsruXkQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">Unity</figcaption></figure><ul class=""><li id="ff00" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">转到boss脚本并添加对该对象的引用。</li></ul><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="2e51" class="lm ln hi li b fi lo lp l lq lr">GameObject bosslocationPoint;</span><span id="98b4" class="lm ln hi li b fi ls lp l lq lr">void Start(){</span><span id="bb2a" class="lm ln hi li b fi ls lp l lq lr">transform.position = new Vector3(12.0f, 4.6f, 0); //<strong class="li hj">Initial Position</strong></span><span id="47c5" class="lm ln hi li b fi ls lp l lq lr">bosslocationPoint = GameObject.FindGameObjectWithTag("LocationPoints");<br/>}</span><span id="f03a" class="lm ln hi li b fi ls lp l lq lr">void Update(){<br/>transform.position = <strong class="li hj">Vector2.MoveTowards</strong>(transform.position, bosslocationPoint.transform.position, moveSpeed * Time.deltaTime); // <strong class="li hj">New position</strong>.<br/>}</span></pre><p id="9ffc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.让我们生火吧。</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="39b4" class="lm ln hi li b fi lo lp l lq lr">void Update(){<br/>if(Vector2.Distance(transform.position, bosslocationPoint.transform.position) &lt; 0.1f &amp;&amp; player.getPlayerLives()&gt;0)<br/>}</span></pre><ul class=""><li id="d542" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">在这里，首先检查的是关于老板的职位。如果老板几乎到达定位点，消防协议将开始。</li><li id="b7fd" class="kl km hi is b it lu ix lv jb lw jf lx jj ly jn lt kr ks kt bi translated">第二，以防玩家在战斗中死亡，boss也应该停止射击。为此，玩家脚本有一个返回其最新生命计数的方法。</li></ul><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="8d3f" class="lm ln hi li b fi lo lp l lq lr">public int getPlayerLives()<br/>   {<br/>       return _lives;<br/>   }</span></pre><ul class=""><li id="3de1" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">所以，只要玩家有0多条命，boss就不要停火。</li></ul><p id="ada7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.让我们通过使用一个计数器变量来确定启动顺序。</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="8af2" class="lm ln hi li b fi lo lp l lq lr">private int fireCounter = 1; // 0 became a trouble. So I chose 1.</span></pre><figure class="jp jq jr js fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/063f20a4b568403918b615b45cf5c390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fk5Dpv7_m3NXZfl5XbVWcQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx">C#</figcaption></figure><ul class=""><li id="2c0b" class="kl km hi is b it iu ix iy jb kn jf ko jj kp jn lt kr ks kt bi translated">我认为这里的数学是不言自明的。</li><li id="6d0a" class="kl km hi is b it lu ix lv jb lw jf lx jj ly jn lt kr ks kt bi translated">根据攻击的选择，可以设计三种不同的射击方法。</li></ul><p id="0491" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">6.让我们摧毁老板。</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="f23c" class="lm ln hi li b fi lo lp l lq lr">if (_bossHealthBar.GetComponent&lt;ThrustSlider&gt;().GetSliderValue() &lt; 0.2f)<br/>{<br/>DestroyAnimation();<br/>}</span><span id="1f6f" class="lm ln hi li b fi ls lp l lq lr">void DestroyAnimation()<br/>   {<br/>       bossAnimator.SetBool("OnBossDeath", true); //start explosion.<br/>       explosionAudio.Play(); // Start Explosion sound.<br/>       Destroy(this.gameObject, 2.5f); // Destruction after 2.5 Sec.<br/>   }</span></pre><p id="6709" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">7.让我们摧毁玩家，送走老板。</p><pre class="jp jq jr js fd lh li lj lk aw ll bi"><span id="43b2" class="lm ln hi li b fi lo lp l lq lr">if (player.getPlayerLives() == 0)<br/>{ <br/>    spawnManager.OnPlayerDeath(); // Spawn Mgr stops spawning.<br/>    transform.Translate(Vector2.down * Time.time * 0.05f);<br/>}<br/> <br/>if (transform.position.y &gt; 12.0f)<br/>    Destroy(this.gameObject); <br/>//After the boss goes out of the screen, destroy it. </span></pre><p id="9eca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本文不包括UI实现。</p><p id="c81a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有了合适的fire方法和激活/停用的良好UI实现，手头的任务就应该完成了。</p><p id="e7a8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面是最终结果:)</p><div class="ju jv ez fb jw jx"><a href="https://drive.google.com/file/d/16LY-jjgg2htkCn9W3LdnX3_sCErH8Ruh/view?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="jy ab dw"><div class="jz ab ka cl cj kb"><h2 class="bd hj fi z dy kc ea eb kd ed ef hh bi translated">BossEnemyWave.mkv</h2><div class="ng l"><h3 class="bd b fi z dy kc ea eb kd ed ef dx translated">编辑描述</h3></div><div class="ke l"><p class="bd b fp z dy kc ea eb kd ed ef dx translated">drive.google.com</p></div></div></div></a></div><p id="14f6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">非常感谢</p></div></div>    
</body>
</html>
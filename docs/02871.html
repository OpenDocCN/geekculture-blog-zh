<html>
<head>
<title>How Confusion Matrices Are Useful in Machine Learning?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵在机器学习中如何有用？</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-confusion-matrices-are-useful-in-machine-learning-9893f88b0283?source=collection_archive---------58-----------------------#2021-05-26">https://medium.com/geekculture/how-confusion-matrices-are-useful-in-machine-learning-9893f88b0283?source=collection_archive---------58-----------------------#2021-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1c75" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">混淆矩阵，顾名思义，可能会令人困惑，但是在解决分类问题的过程中，它们可以用来消除你的困惑。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/701bf66f2170229d00bf12053a68e221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_Nc9VwlFoHFSnAAy9L7cA.jpeg"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Image by &lt;a href=”<a class="ae jn" href="https://pixabay.com/users/chenspec-7784448/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=5718425" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/users/chenspec-7784448/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=5718425</a>"&gt;chenspec&lt;/a&gt;</figcaption></figure><p id="2b9a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">混淆矩阵，顾名思义，可能会令人困惑，但是在解决分类问题的过程中，它们可以用来消除你的困惑。混淆矩阵是一个N×N矩阵，其中N是分类的目标值的数量。</p><p id="390b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它基本上是一个表格布局，允许我们了解算法的性能，尤其是在分类任务期间。它们有助于对我们的模型所做的分类有一个总体的了解。</p><p id="040b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">可以进一步分析由混淆矩阵完成的子分类，以确定这种模型的各种性能度量。该矩阵包含实际值与模型预测值的比较。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es kk"><img src="../Images/2307cca40dde2fccbae27f62b9a49a41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*3ZY_G615XFYf4C_r2-HJ_g.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx">Representation of a Confusion matrix</figcaption></figure><p id="5a62" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">混淆矩阵的定义和布局有四个子分类:</p><h2 id="2dee" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated"><em class="lg"> 1。真阳性</em></h2><p id="3334" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">考虑有两类(二元分类问题):一类是积极的(或正确的或任何你想要的)，另一类是消极的(或不正确的或与你想要的相反)。</p><p id="de8f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">真阳性是被我们的模型正确分类为正确类别的值。这些是我们的模型放在正确盒子里的值。</p><blockquote class="lm ln lo"><p id="967f" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">病人被归类为被感染，他们实际上已经被感染了。</p></blockquote><h2 id="9cad" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated"><em class="lg"> 2。真正的否定</em></h2><p id="f1b9" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">另一方面，真正的负数是那些被正确分类为第二类的值。这些值被我们的模型放在了正确的框中，但是它们被放在了带有不同标签的框中。</p><p id="7544" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">真负值中的负值并不意味着值被错误分类，而是实际上它们被放在了另一个盒子里。因此，它们也被正确地分类，因此被称为“真实的”。</p><blockquote class="lm ln lo"><p id="8e13" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">…另一名患者被归类为没有感染，但他们实际上没有感染…</p></blockquote><h2 id="521b" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">3.假阳性</h2><p id="6afd" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">现在，如果应该放在第二个盒子里的值实际上被我们的分类器放在了第一个盒子里。这是一种错误，更具体地说是一种类型I错误，其中负值被错误地分类为正值。</p><blockquote class="lm ln lo"><p id="d448" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">该模型预测患者会受到感染，但他们没有受到感染，而且完全健康。假警报。</p></blockquote><p id="bc5b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这种错误不是好事，但也不是完全有害的，因为可以进一步测试错误分类，以验证它们的实际类别。</p><h2 id="0449" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">4.假阴性</h2><p id="967a" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">与假阳性一样，假阴性也表示被错误分类的值。它们显示的值实际上是正的，但却被放在了负框中，造成了第二类错误。</p><blockquote class="lm ln lo"><p id="694b" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">患者被感染，但他们被送回家，因为他们被模型测试为阴性。真正的报警，但一点也不报警。</p></blockquote><p id="9729" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这种错误实际上可能是致命和危险的。可能在医疗、银行或司法领域最危险。</p><h1 id="d4f6" class="lt km hi bd kn lu lv lw kr lx ly lz kv io ma ip ky ir mb is lb iu mc iv le md bi translated"><strong class="ak"> <em class="lg">但是我们由此推断出什么呢？</em>T3】</strong></h1><p id="e5f2" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">我们有各种方法来分析模型的性能:</p><blockquote class="lm ln lo"><p id="1e43" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">准确度或分类准确度:</p></blockquote><p id="36b3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以计算出正确分类的值占提供给我们模型的总值的百分比。这是我们分类器的精度。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es me"><img src="../Images/2e94c3c309ec66bb4cf80b125f2345e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*AszlH-7FZwokO9n-kgMbcQ.png"/></div></div></figure><p id="68a2" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">精确度告诉我们模型的表现有多好，但是它的局限性是要求每一类中的观察值数量大致相同。</p><blockquote class="lm ln lo"><p id="72fd" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">精确</p></blockquote><p id="cf87" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">精度告诉我们，在模型放入正类的所有值中，有多少实际上是正的。它告诉我们，我们的模型在对正值进行分类时有多精确。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mf"><img src="../Images/6c9684f44373da704c5598cf3634382c.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*GBAdHtfdfv8BtmIWP-aqcA.png"/></div></figure><p id="e216" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它告诉我们应该在多大程度上相信我们的模型预测。它也被称为阳性预测值。</p><blockquote class="lm ln lo"><p id="a5d1" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">回忆或敏感度:</p></blockquote><p id="91ec" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你仔细想想，假阴性实际上是被误归类为阴性的正值，因此是假阴性。</p><p id="fab7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以使用假阴性和真阳性来确定模型能够从提供给它的全部实际正值中召回多少个正值。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mg"><img src="../Images/8623a6687d08fe32e43071d55aba0f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*OMXKUqrzm39MDs9kqLD1Lw.png"/></div></figure><p id="7229" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">回忆给了我们一个百分比，表示模型对积极结果的确信程度。这也被称为真阳性率。</p><blockquote class="lm ln lo"><p id="485e" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">特异性:</p></blockquote><p id="3029" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这类似于回忆，但不是负面的。它给出了被归类为负值的数值与实际上为负值的数值之比。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mh"><img src="../Images/791ae392ca4bc06b886b74ff5b08dd70.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*tLAEjX0Ev7KMmzgCOsfzsQ.png"/></div></figure><p id="a3ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">特异性为我们提供了模型对负面结果有多大把握的百分比。这也被称为真实负利率。</p><blockquote class="lm ln lo"><p id="6cf2" class="jo jp lp jq b jr js ij jt ju jv im jw lq jy jz ka lr kc kd ke ls kg kh ki kj hb bi translated">F1分数</p></blockquote><p id="1574" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">F1得分是精确度和召回率的<a class="ae jn" href="https://en.wikipedia.org/wiki/Harmonic_mean" rel="noopener ugc nofollow" target="_blank">调和平均值</a>。它从0到1不等，其中1表示最高精度和召回率，0表示最低可能值。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mi"><img src="../Images/d2c9f50e07d65865a1c6b0f53ef76755.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*5Qc4C7AInUfVrPQhRTm2tg.png"/></div></figure><p id="f293" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lp">如何在Python中创建混淆矩阵？</em>T9】</strong></p><p id="b26f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们可以使用Scikit-Learn的<em class="lp"> metrics </em>方法将混淆矩阵导入到我们的代码中。然后，我们可以将测试值和预测值传递到混淆矩阵()实例中。打印的值将是一个嵌套数组，包含四个值，分别是TP、FN、FP和TN。</p><pre class="iy iz ja jb fd mj mk ml mm aw mn bi"><span id="d4c7" class="kl km hi mk b fi mo mp l mq mr">from sklearn.metrics import confusion_matrix<br/>confusion_matrix = confusion_matrix(y_test, y_pred)<br/>print(confusion_matrix)</span><span id="56e7" class="kl km hi mk b fi ms mp l mq mr">#prints [[TP FP]<br/>#        [FN TN]]</span></pre><p id="51cb" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">此外，我们可以使用classification_report()创建一个包含精度、召回率和F1分数的图表，用于分析我们的模型的性能。</p><pre class="iy iz ja jb fd mj mk ml mm aw mn bi"><span id="e2db" class="kl km hi mk b fi mo mp l mq mr">from sklearn.metrics import classification_report<br/>classification_report = classification_report(y_test, y_pred)<br/>print(classification_report)</span><span id="d671" class="kl km hi mk b fi ms mp l mq mr">#prints a table with columns: precision recall f1-score support</span></pre><h2 id="9385" class="kl km hi bd kn ko kp kq kr ks kt ku kv jx kw kx ky kb kz la lb kf lc ld le lf bi translated">结论</h2><p id="dae0" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">因此，我们看到了一个简单的混淆矩阵结构如何帮助我们确定模型性能的许多方面，以及如何在未来的代码中实际实现它。</p></div><div class="ab cl mt mu gp mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="hb hc hd he hf"><p id="72c1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是机器学习和统计学习系列文章的第一篇。</p><p id="f651" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你喜欢它，并且它帮助你学到了一些新的东西，那么把它分享给一个刚刚开始学习数据科学的人，并关注更多这样的内容。</p><p id="867b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在推特上关注我，我也会解释这些东西:<a class="ae jn" href="https://twitter.com/AnityaGan9urde" rel="noopener ugc nofollow" target="_blank"> @AnityaGan9urde </a></p></div></div>    
</body>
</html>
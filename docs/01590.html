<html>
<head>
<title>How Ransomware Works</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">勒索软件的工作原理</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-ransomware-works-12b06462db8?source=collection_archive---------20-----------------------#2021-04-16">https://medium.com/geekculture/how-ransomware-works-12b06462db8?source=collection_archive---------20-----------------------#2021-04-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="439f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">用Golang创建一个简单的勒索软件</h2></div><h1 id="d293" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">摘要</h1><ul class=""><li id="4aa3" class="jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">介绍</li><li id="186c" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">一点历史</li><li id="825a" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">基本结构</li><li id="0061" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">在Golang实施</li><li id="7134" class="jp jq hi jr b js kh ju ki jw kj jy kk ka kl kc kd ke kf kg bi translated">最终考虑</li></ul></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="e9ae" class="ix iy hi bd iz ja kt jc jd je ku jg jh io kv ip jj ir kw is jl iu kx iv jn jo bi translated">介绍</h1><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ky"><img src="../Images/d4c9f5b84b7098d8fab9de12bf68d123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*acsgaK0495AUdN2-.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">“What I cannot create I do not understand.” — Richard Feynman</figcaption></figure><p id="a3f9" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">我认为，上个世纪一位重要的物理学家理查德·费曼的这段话，非常一致地总结了每个程序员对该领域研究的感受。</p><p id="6c16" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">在这条道路上，最终每个人都将面对信息安全领域(或者用一个更夸张的术语来说，黑客)。这就像杨颖:程序员应该涉足黑客阵营，反之亦然。</p><p id="fb76" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">几周前，我问了自己一个问题:勒索软件是如何工作的？我研究了一些公共实现，在这里我将展示一个小例子，这是目前最常用的网络攻击类型之一。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="2539" class="ix iy hi bd iz ja kt jc jd je ku jg jh io kv ip jj ir kw is jl iu kx iv jn jo bi translated">一点历史</h1><figure class="kz la lb lc fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es md"><img src="../Images/4b36c1f4f5ff4dc5a6d1b7797c8d3376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftEjJxIWs4XRsOUCajZPqg.jpeg"/></div></div></figure><p id="a78a" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">成功的勒索软件攻击的第一个可靠记录可以追溯到2005年，但在过去十年中，攻击的发生次数激增。</p><p id="33c3" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">由于其性质，勒索软件通常以大公司为目标。一些例子是CryptoLocker和WannaCry，这两个勒索软件感染了数千台机器并造成了大量损失。</p><p id="c4dc" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">攻击者有两种方法可以使勒索软件成为巨大的威胁。首先，在网络和操作系统中发现了漏洞和后门，使黑客能够注入恶意软件，感染所有连接的机器，无论是通过网络还是物理连接(如pendrives和其他即插即用设备)。</p><p id="6529" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">这些系统背后的公司(微软、antiviruses等)做出了巨大的努力来检测这些故障并纠正它们。因此，攻击者使用传统的网络钓鱼方法，将恶意软件伪装在pdf、可执行文件或其他可下载内容中。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="b47b" class="ix iy hi bd iz ja kt jc jd je ku jg jh io kv ip jj ir kw is jl iu kx iv jn jo bi translated">基本结构</h1><p id="2143" class="pw-post-body-paragraph lo lp hi jr b js jt ij lr ju jv im lt jw me lv lw jy mf ly lz ka mg mb mc kc hb bi translated">勒索软件本质上是一种扫描文件系统并加密文件的程序。这些文件有点像是被绑架的，因为攻击者需要支付赎金(通常是比特币或另一种加密货币，因为交易是匿名的)来提供解密文件的密钥。</p><p id="75e2" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">如果受害者没有文件的备份，除了付钱给攻击者之外，可能没有其他行动可做。但这是非常危险的，因为许多攻击者即使付款也不发送解密密钥。最有效的解决方案是建立安全协议并设置频繁的备份。</p><p id="0134" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">除了驻留在受害者机器中的软件之外，还经常使用命令服务器。每当新的受害者被感染时，该服务器接收数据并对其数据进行加密。然后，服务器检查支付流程，以确保当受害者支付所需金额时，解密密钥被发送到机器。</p></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="de23" class="ix iy hi bd iz ja kt jc jd je ku jg jh io kv ip jj ir kw is jl iu kx iv jn jo bi translated">在Golang实施</h1><p id="c5e8" class="pw-post-body-paragraph lo lp hi jr b js jt ij lr ju jv im lt jw me lv lw jy mf ly lz ka mg mb mc kc hb bi translated">第一部分是文件浏览器。有了它，我们将能够遍历从根文件夹或指定一个起始文件夹开始的机器上的所有文件。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="4119" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">在第一部分中，我们检测操作系统是Windows还是Linux，以获得正确的用户根文件夹(在这里添加Mac是相同的过程)。我们可以指定一个文件夹来启动，或者程序将在/Downloads/Test中启动。这是一种防止测试运行加密机器中所有数据的机制。然后我们用filepath映射和存储文件。WalkDir，返回数组。</p><p id="e201" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">现在，我们需要一个辅助程序来生成加密/解密密钥。我选择了AES-256-GCM算法，所以我们需要一个32字节的密钥(以匹配算法的256位)。我们将使用相同的密钥进行加密和解密，但在更现实的情况下，建议使用非对称加密(一个公钥和一个私钥)。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="19ca" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">接下来，让我们根据生成的密钥制作加密器。除了密钥之外，加密器还可以接收主目录和电子邮件联系人。我们使用MapFiles()函数获取所有文件，然后读取它，加密数据并重写。最后，生成一个自述文件，通知受害者其数据被绑架，并联系获取解密程序。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="b7a7" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">解密器与加密器非常相似，只是颠倒了操作的顺序。</p><figure class="kz la lb lc fd ld"><div class="bz dy l di"><div class="mh mi l"/></div></figure></div><div class="ab cl km kn gp ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="hb hc hd he hf"><h1 id="bb73" class="ix iy hi bd iz ja kt jc jd je ku jg jh io kv ip jj ir kw is jl iu kx iv jn jo bi translated">最终考虑</h1><p id="b5eb" class="pw-post-body-paragraph lo lp hi jr b js jt ij lr ju jv im lt jw me lv lw jy mf ly lz ka mg mb mc kc hb bi translated">要运行程序的各个部分，您可以使用“go build”为所有需要的平台和架构创建可执行文件。例如，要为Windows构建，只需运行:</p><p id="c2ad" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated"><code class="du mj mk ml mm b">$env GOOS=windows go build</code></p><p id="12fc" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">不要忘记事先获得一个密钥，并在程序中正确插入变量(密钥、目录和联系人)。</p><p id="8be5" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">在这个项目中有一些东西可以添加和改进。创建一个控制服务器，与加密货币支付集成，使用Go并发性来提高大块文件的读取、加密和写入，等等。</p><div class="mn mo ez fb mp mq"><a href="https://github.com/LuanSilveiraSouza/rangoware" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab dw"><div class="ms ab mt cl cj mu"><h2 class="bd hj fi z dy mv ea eb mw ed ef hh bi translated">luansilweirasouza/rangoware</h2><div class="mx l"><h3 class="bd b fi z dy mv ea eb mw ed ef dx translated">Rangoware是一个简单的勒索软件，使用AES-256-GCM加密，用Go语言编写。⚠️警告:这…</h3></div><div class="my l"><p class="bd b fp z dy mv ea eb mw ed ef dx translated">github.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne li mq"/></div></div></a></div><p id="d59a" class="pw-post-body-paragraph lo lp hi jr b js lq ij lr ju ls im lt jw lu lv lw jy lx ly lz ka ma mb mc kc hb bi translated">我希望这篇文章能给你带来一些知识！感谢阅读！</p></div></div>    
</body>
</html>
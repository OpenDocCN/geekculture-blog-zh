<html>
<head>
<title>Linux environment on macOS using Virtual Machine for development.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用虚拟机进行开发的macOS上的Linux环境。</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/vagrant-for-local-development-on-macos-272a8c91cbae?source=collection_archive---------4-----------------------#2022-05-31">https://medium.com/geekculture/vagrant-for-local-development-on-macos-272a8c91cbae?source=collection_archive---------4-----------------------#2022-05-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b08700ab1267bfd959caf02ef280c51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tCl9LmdLTO4w1wQKj2Wqbg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Vagrant</figcaption></figure><p id="7b71" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在将您的功能部署到服务器之前，本地开发环境在测试您的功能方面扮演着重要的角色。在需要不同配置和环境的本地机器中创建所有运行模块的完全集成环境是很难实现的。例如，在macOS中测试项目的完全集成，而有些模块需要linux环境。有一些方法可以通过创建模拟来测试你的模块，但是它们不提供完全的集成测试。</p><p id="75de" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在一个大型的工业项目中工作，需要多个模块聚集在一起测试一个变更，在服务器上验证一个变更将会成为一个乏味的任务。一个完全集成的本地开发环境在部署到服务器上之前对测试变化起着很大的作用。创建虚拟机提供了在本地主机操作系统中测试所需的不同环境的好处。</p><p id="614d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">流浪者</strong>提供了一种有效的方式来供应虚拟机。使用配置文件，在配置时启动虚拟机并安装所需的软件包。让我们来看看lavour的工作方式，并使用lavour file为虚拟机提供所需的软件包</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="9012" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">开始使用虚拟机的流浪者所需的上述步骤:-</p><ul class=""><li id="76d2" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">将oracle <a class="ae ki" href="https://www.oracle.com/in/virtualization/technologies/vm/downloads/virtualbox-downloads.html" rel="noopener ugc nofollow" target="_blank">虚拟盒</a>下载并安装到本地mac os机器上</li><li id="5a34" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">在本地mac os机器上下载并安装vagger，也可以使用<code class="du ko kp kq kr b">brew install vagrant</code>。</li><li id="74a4" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">创建一个文件夹(vacator/<project-name>)来保存vacator file(创建一个包含用于配置虚拟机的指令集的vacator file)。例如:-</project-name></li></ul><figure class="ks kt ku kv fd ij"><div class="bz dy l di"><div class="kw kx l"/></div><figcaption class="iq ir et er es is it bd b be z dx">Vagrantfile</figcaption></figure><p id="c11d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">浮动文件</strong>用于向虚拟机提供上述文件中定义的指令集。该文件可用于为多个虚拟机调配不同的资源。在上面的文件中需要注意的是，我已经提供了一个nfs挂载卷共享，然后在配置VM时将指令添加到了一个选项参数中</p><pre class="ks kt ku kv fd ky kr kz la aw lb bi"><span id="932d" class="lc ld hi kr b fi le lf l lg lh">Vagrant.configure(2) <strong class="kr hj">do</strong> <!-- -->|config|<br/>   opts = {<br/>          type: 'nfs',<br/>          linux__nfs_options: ['no_root_squash'],<br/>          map_uid: 0,<br/>          map_gid: 0<br/>   }<br/>   config.vm.synced_folder "/Users/himanshuchaudhary/pds_nvme_release_drop1", "/root/pds_nvme_release", opts</span></pre><p id="90d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在为nfs共享装载提供选项后，您可以将本地卷装载到将被同步的After。因此，您在本地主机的目录中所做的任何更改都将反映在VM中。使用nfs装载选项的另一个好处是当您需要卷装载来运行docker容器时。docker的mount选项有助于满足许多需求，其中之一是当您希望项目细节即使在VM被销毁后也能持久化时。</p><p id="dce3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">上面文件中的另一行是创建一个从本地主机网络到VM内部网络的私有网络接口桥。提供专用网络的好处是，如果您连接到网络，除了您的本地主机之外，它不会暴露给其他机器。</p><pre class="ks kt ku kv fd ky kr kz la aw lb bi"><span id="eb0e" class="lc ld hi kr b fi le lf l lg lh">Vagrant.configure(2) <strong class="kr hj">do</strong> <!-- -->|config|<br/>config.vm.network "private_network", ip: "192.168.56.9"</span></pre><p id="7461" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你想为整个网络创建一个网络接口，有一个选项可以在流浪者文件中创建公共网络。</p></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="00c0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦游民文件准备好了，运行<code class="du ko kp kq kr b">vagrant up</code>来供应虚拟机。它将添加虚拟机所需的配置，包括调配计算资源。如果是mac OS，当挂载nfs共享时，它会要求root密码(管理员密码)。</p><pre class="ks kt ku kv fd ky kr kz la aw lb bi"><span id="89e2" class="lc ld hi kr b fi le lf l lg lh">==&gt; default: Installing NFS client...<br/>==&gt; default: Exporting NFS shared folders...<br/>==&gt; default: Preparing to edit /etc/exports. Administrator privileges will be required...</span></pre><p id="4b41" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">提供管理员密码后，你的流浪者将被配置和运行。使用<code class="du ko kp kq kr b">vagrant ssh</code>ssh进入正在运行的虚拟机。当您通过ssh进入系统时，您可以在终端上看到配置和专用网络的详细信息</p><pre class="ks kt ku kv fd ky kr kz la aw lb bi"><span id="e30c" class="lc ld hi kr b fi le lf l lg lh">Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-91-generic x86_64)</span><span id="dd84" class="lc ld hi kr b fi li lf l lg lh">* Documentation:  <a class="ae ki" href="https://help.ubuntu.com" rel="noopener ugc nofollow" target="_blank">https://help.ubuntu.com</a><br/> * Management:     <a class="ae ki" href="https://landscape.canonical.com" rel="noopener ugc nofollow" target="_blank">https://landscape.canonical.com</a><br/> * Support:        <a class="ae ki" href="https://ubuntu.com/advantage" rel="noopener ugc nofollow" target="_blank">https://ubuntu.com/advantage</a></span><span id="b26f" class="lc ld hi kr b fi li lf l lg lh">System information as of Mon May 30 10:26:56 UTC 2022</span><span id="0ebe" class="lc ld hi kr b fi li lf l lg lh">System load:  0.0               Processes:               163<br/>  Usage of /:   9.6% of 38.71GB   Users logged in:         0<br/>  Memory usage: 6%                IPv4 address for enp0s3: 10.0.2.15<br/>  Swap usage:   0%                IPv4 address for enp0s8: 192.168.56.9</span></pre><p id="3fdb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，您已经有了一个使用vagrant启动并运行的虚拟机，该虚拟机可用于测试运行在虚拟机内部并从本地gRPC macOS客户端使用的gRPC服务器。或者测试REST微服务，一部分在本地运行，另一部分在虚拟机运行。还有其他好处，在下面的要点中描述。</p><p id="26a6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">流浪者提供命令来管理运行的虚拟机以及虚拟机<code class="du ko kp kq kr b">vboxmanage</code>命令:-</p><ul class=""><li id="87f1" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">要列出流浪者，您可以运行<code class="du ko kp kq kr b">vagrant box list</code>。一旦你有了流浪者的名字，你就可以用它来删除它或者获取运行虚拟机的详细信息。</li><li id="4a57" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">在流浪者运行<code class="du ko kp kq kr b">vagrant box update</code>中更新新版本的操作系统镜像。</li><li id="d656" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">要移除虚拟机，请使用<code class="du ko kp kq kr b">vagrant box remove -f.</code></li></ul></div><div class="ab cl js jt gp ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="hb hc hd he hf"><p id="3729" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对VM使用vagrant的好处:-</p><ul class=""><li id="f45d" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">它提供了一个单独的浮动文件来为所有系统创建一个开发环境，这是团队工作时所需要的。</li><li id="6fde" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">易于使用，因为所有配置都可以在单个文件中捕获，该文件可用于为虚拟机提供在Vagrantfile中提到的所有软件包以供使用。</li><li id="dd40" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">在本地机器上安装项目所需的所有软件会使任务变得繁重，并且这些过程会消耗多种资源。在虚拟机中安装它们可以避免这种情况。</li></ul><p id="1bbe" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">还有其他好处，包括虚拟机设置提供的好处。值得注意的是，可以使用vagger来配置多个具有相同配置的虚拟机。流浪者文件将有包和配置在一个地方，可以根据您的项目需求随时修改。使用单个文件来创建开发环境避免了维护包的列表，并使跟踪需要安装的版本变得容易。</p><blockquote class="lj lk ll"><p id="c5f0" class="iu iv lm iw b ix iy iz ja jb jc jd je ln jg jh ji lo jk jl jm lp jo jp jq jr hb bi translated"><strong class="iw hj"> <em class="hi">如何到达</em> </strong> <em class="hi"> :-邮件至</em><strong class="iw hj"><em class="hi">:</em>himanshusdec8@gmail.com</strong><em class="hi">如有任何关于实施云或什么是云的相关疑问或讨论。</em></p></blockquote><p id="b5d7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">拍手声👏如果你今天学到了什么好东西。关注<a class="lq lr ge" href="https://medium.com/u/64edd4213f30?source=post_page-----272a8c91cbae--------------------------------" rel="noopener" target="_blank"> Himanshu Chaudhary </a>获取更多关于云和云技术的文章。谢谢读者。🙂</p><p id="206e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">参考文件的链接:-</p><ul class=""><li id="a2ac" class="jz ka hi iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">https://www.vagrantup.com/docs<a class="ae ki" href="https://www.vagrantup.com/docs" rel="noopener ugc nofollow" target="_blank"/></li><li id="fd57" class="jz ka hi iw b ix kj jb kk jf kl jj km jn kn jr ke kf kg kh bi translated">【https://www.virtualbox.org/wiki/Technical_documentation T4】</li></ul></div></div>    
</body>
</html>
<html>
<head>
<title>How to Upload Images to Cloudinary With a React App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用React应用程序将图像上传到Cloudinary</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-upload-images-to-cloudinary-with-a-react-app-f0dcc357999c?source=collection_archive---------0-----------------------#2021-03-29">https://medium.com/geekculture/how-to-upload-images-to-cloudinary-with-a-react-app-f0dcc357999c?source=collection_archive---------0-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ac4de1c301de1e810fa7c7368b88163b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oy4POQNreHGGoeOCfuXjwA.jpeg"/></div></div></figure><h1 id="b1ca" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">介绍</h1><p id="12b3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">有时，在处理需要使用图像的应用程序时，将图像上传到服务器这样的简单过程会变得非常困难。Cloudinary使这一点非常容易实现。我们可以直接从前端上传和管理图像。在本文中，我将向您展示如何为图片上传过程创建和设置您的cloudinary帐户以及如何从react web应用程序上传图片的一步一步的过程。</p><h1 id="5ec9" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">先决条件</h1><ul class=""><li id="33ac" class="km kn hi jq b jr js jv jw jz ko kd kp kh kq kl kr ks kt ku bi translated">对javascript的基本理解</li><li id="70c8" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">React的基础知识</li><li id="880c" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">您机器上安装的最新版本的nodejs</li><li id="6dfb" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">React的最新版本</li><li id="6d50" class="km kn hi jq b jr kv jv kw jz kx kd ky kh kz kl kr ks kt ku bi translated">含糊不清的叙述</li></ul><h2 id="8bab" class="la ir hi bd is lb lc ld iw le lf lg ja jz lh li je kd lj lk ji kh ll lm jm ln bi translated">1.创建和设置您的cloudinary帐户</h2><p id="a03c" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">前往<a class="ae lo" href="https://cloudinary.com" rel="noopener ugc nofollow" target="_blank"> Cloudinary </a>。创建一个新帐户或登录帐户(如果您已经有一个)。登录后，你的主页应该如下图所示。继续点击<strong class="jq hj">上传</strong></p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/35506c056c80dc73c59395731467e02a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jxj7_bglRJjrmTzhPyuuA.jpeg"/></div></div></figure><p id="60cd" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">向下滚动到<strong class="jq hj">启用未签名上传</strong>的位置，点击启用。你会注意到我已经启用了我的。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/cc3a3cb3e62c92b8c3ab2b1231941a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oe3Apx31RFeLn9BSElZbWA.jpeg"/></div></div></figure><p id="713b" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">点击<strong class="jq hj">添加上传预设。</strong>这有助于您定义上传的默认行为。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/6b55d2e216af276ab390b56ac7443c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FMgwQgFif5OjlGy56d_RbQ.jpeg"/></div></div></figure><p id="e153" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">在<strong class="jq hj">上传预设名称</strong>中填入您选择的任何名称，然后将签名模式更改为<strong class="jq hj">未签名。</strong>这允许您在未经授权的情况下上传。</p><p id="3e77" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">单击“保存”,我们现在就完成了。记下您的上传预设名称，因为稍后会用到它。</p><p id="55b5" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated"><strong class="jq hj"> 2。设置反应</strong></p><p id="bc97" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">运行以下命令，使用您选择的终端在几秒钟内创建您的react应用程序</p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="9ef8" class="la ir hi ma b fi me mf l mg mh">npx create-react-app react-image-app</span></pre><p id="411b" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">运行此命令将目录更改到您刚刚创建的文件夹中，并启动它</p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="1ea8" class="la ir hi ma b fi me mf l mg mh">cd react-image-app &amp;&amp; npm start</span></pre><p id="0f08" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">现在我们已经设置好了react，用下面的代码替换您的app.js文件</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/6421e5516b9ad2d993914a5087ac8f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nc2ACjlNl9qRxdpcM9HPhg.png"/></div></div></figure><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="4285" class="la ir hi ma b fi me mf l mg mh">import React, { useState } from 'react'</span><span id="09da" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> App = () <em class="mk">=&gt;</em> {</span><span id="a89d" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> [image, setImage ] = useState("");</span><span id="c684" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> [ url, setUrl ] = useState("");<br/></span><span id="56bc" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> uploadImage = () <em class="mk">=&gt;</em> {</span><span id="fcd3" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> data = new FormData()</span><span id="0032" class="la ir hi ma b fi mj mf l mg mh">data.append("file", image)</span><span id="ee4c" class="la ir hi ma b fi mj mf l mg mh">data.append("upload_preset", "tutorial")</span><span id="bb28" class="la ir hi ma b fi mj mf l mg mh">data.append("cloud_name","breellz")<br/></span><span id="ba1b" class="la ir hi ma b fi mj mf l mg mh">fetch("  https://api.cloudinary.com/v1_1/breellz/image/upload",{</span><span id="c3a6" class="la ir hi ma b fi mj mf l mg mh">method:"post",</span><span id="f33e" class="la ir hi ma b fi mj mf l mg mh">body: data</span><span id="c08e" class="la ir hi ma b fi mj mf l mg mh">})</span><span id="a82c" class="la ir hi ma b fi mj mf l mg mh">.then(resp <em class="mk">=&gt;</em> resp.json())</span><span id="5a87" class="la ir hi ma b fi mj mf l mg mh">.then(data <em class="mk">=&gt;</em> {</span><span id="c835" class="la ir hi ma b fi mj mf l mg mh">setUrl(data.url)</span><span id="8377" class="la ir hi ma b fi mj mf l mg mh">})</span><span id="ae6a" class="la ir hi ma b fi mj mf l mg mh">.catch(err <em class="mk">=&gt;</em> console.log(err))</span><span id="f2ff" class="la ir hi ma b fi mj mf l mg mh">}</span><span id="bf1c" class="la ir hi ma b fi mj mf l mg mh">return (</span><span id="261b" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="d5c6" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="9f95" class="la ir hi ma b fi mj mf l mg mh">&lt;input <em class="mk">type</em>="file" <em class="mk">onChange</em>= {(e)<em class="mk">=&gt;</em> setImage(e.target.files[0])}&gt;&lt;/input&gt;</span><span id="49b0" class="la ir hi ma b fi mj mf l mg mh">&lt;button <em class="mk">onClick</em>={uploadImage}&gt;Upload&lt;/button&gt;</span><span id="8a15" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="4dc0" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="ae33" class="la ir hi ma b fi mj mf l mg mh">&lt;h1&gt;Uploaded image will be displayed here&lt;/h1&gt;</span><span id="09b4" class="la ir hi ma b fi mj mf l mg mh">&lt;img <em class="mk">src</em>={url}/&gt;</span><span id="1311" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="c116" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="9fa7" class="la ir hi ma b fi mj mf l mg mh">)</span><span id="a452" class="la ir hi ma b fi mj mf l mg mh">}</span><span id="aaf3" class="la ir hi ma b fi mj mf l mg mh">export default App;</span></pre><p id="81aa" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">我不会把重点放在造型上，原谅我，因为最终产品看起来真的很可笑。所以你可以随心所欲地设计风格。</p><p id="5a24" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated"><strong class="jq hj">下面是代码解释</strong></p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="68b2" class="la ir hi ma b fi me mf l mg mh">import React, { useState } from 'react'</span><span id="c0e9" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> App = () <em class="mk">=&gt;</em> {</span><span id="0ab0" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> [image, setImage ] = useState("");</span><span id="c6f3" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> [ url, setUrl ] = useState("");</span></pre><p id="e799" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">useState是一个react挂钩，允许您向函数组件添加react状态。这里有两种使用状态，一种用于保存要上传的图像，另一种用于保存上传到cloudinary后的图像url。</p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="35e8" class="la ir hi ma b fi me mf l mg mh"><em class="mk">const</em> uploadImage = () <em class="mk">=&gt;</em> {</span><span id="b826" class="la ir hi ma b fi mj mf l mg mh"><em class="mk">const</em> data = new FormData()</span><span id="cc0b" class="la ir hi ma b fi mj mf l mg mh">data.append("file", image)</span><span id="ce54" class="la ir hi ma b fi mj mf l mg mh">data.append("upload_preset", "tutorial")</span><span id="4f5b" class="la ir hi ma b fi mj mf l mg mh">data.append("cloud_name","breellz")</span></pre><p id="bc3c" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">单击上传按钮后，将调用uploadImage函数。<code class="du ml mm mn ma b"><strong class="jq hj">FormData</strong></code>接口提供了一种方法，可以很容易地构造一组表示表单字段及其值的键/值对，然后可以很容易地将它们发送到服务器。你可以在这里阅读更多关于那个<a class="ae lo" href="https://developer.mozilla.org/en-US/docs/Web/API/FormData" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="21a6" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">我在formData上使用append方法创建了一个键/值对。指向<strong class="jq hj">图像的文件。</strong><strong class="jq hj">upload _ preset</strong>值是我在设置您的cloudinary帐户时要求您记录的上传预置名称。您的云名称可以在您的cloudinary仪表盘上找到。请查看以下说明。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/f51db5f97559a2cfeda091ce982a71e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YxBzCpzPpROXPbwBmbCt5A.jpeg"/></div></div></figure><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="03d1" class="la ir hi ma b fi me mf l mg mh">fetch(" https://api.cloudinary.com/v1_1/breellz/image/upload",{</span><span id="4b2c" class="la ir hi ma b fi mj mf l mg mh">method:"post",</span><span id="9429" class="la ir hi ma b fi mj mf l mg mh">body: data</span><span id="32b2" class="la ir hi ma b fi mj mf l mg mh">})</span><span id="3d0b" class="la ir hi ma b fi mj mf l mg mh">.then(resp <em class="mk">=&gt;</em> resp.json())</span><span id="9555" class="la ir hi ma b fi mj mf l mg mh">.then(data <em class="mk">=&gt;</em> {</span><span id="a701" class="la ir hi ma b fi mj mf l mg mh">setUrl(data.url)</span><span id="5123" class="la ir hi ma b fi mj mf l mg mh">})</span><span id="7f98" class="la ir hi ma b fi mj mf l mg mh">.catch(err <em class="mk">=&gt;</em> console.log(err))</span><span id="02b0" class="la ir hi ma b fi mj mf l mg mh">}</span></pre><p id="115c" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">然后，我们向cloudinary endpoint发出一个post请求，请求体是数据。前往你的cloudinary主页，在账户详情下点击<strong class="jq hj">更多</strong></p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/916eaa688b3a83adaef679b2d1200b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hqOW8qSjwmQKmuKJWHYtfA.jpeg"/></div></div></figure><p id="1443" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">找到您的Api基本url，复制它，因为这是我们将向其发出请求的cloudinary端点。然后你添加'/image/upload '，就像我在上面的代码中做的那样。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/b74d4ec70c354ed0ebd0a2f6ab1fe36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDNmVOWhf3sMzd7gMpwn9w.jpeg"/></div></div></figure><p id="b536" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">发出请求后，我们将响应转换为json，然后将url设置为data.url</p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="2ee0" class="la ir hi ma b fi me mf l mg mh">console.log(data)</span></pre><p id="f49e" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">这将向您显示响应对象，您将看到图像url位于url属性中，如下所示。您可以使用url或secure_url属性。</p><figure class="lq lr ls lt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/e91b55cd8c6097599ad226e868507f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZ4zEitvpU4B31MgWj5FCw.jpeg"/></div></div></figure><p id="3261" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">然后，如果有任何错误，我们会将其记录到控制台。</p><pre class="lq lr ls lt fd lz ma mb mc aw md bi"><span id="18a6" class="la ir hi ma b fi me mf l mg mh">return (</span><span id="6235" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="c84e" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="4882" class="la ir hi ma b fi mj mf l mg mh">&lt;input <em class="mk">type</em>="file" <em class="mk">onChange</em>= {(e)<em class="mk">=&gt;</em> setImage(e.target.files[0])}&gt;&lt;/input&gt;</span><span id="19a6" class="la ir hi ma b fi mj mf l mg mh">&lt;button <em class="mk">onClick</em>={uploadImage}&gt;Upload&lt;/button&gt;</span><span id="e3e1" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="c067" class="la ir hi ma b fi mj mf l mg mh">&lt;div&gt;</span><span id="4d1e" class="la ir hi ma b fi mj mf l mg mh">&lt;h1&gt;Uploaded image will be displayed here&lt;/h1&gt;</span><span id="8ab4" class="la ir hi ma b fi mj mf l mg mh">&lt;img <em class="mk">src</em>={url}/&gt;</span><span id="2565" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="36d8" class="la ir hi ma b fi mj mf l mg mh">&lt;/div&gt;</span><span id="8b82" class="la ir hi ma b fi mj mf l mg mh">)</span><span id="03e4" class="la ir hi ma b fi mj mf l mg mh">}</span><span id="a0c4" class="la ir hi ma b fi mj mf l mg mh">export default App;</span></pre><p id="c308" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">我为文件上传创建了一个输入标签，并从我们的useState钩子中将onChange属性设置为<strong class="jq hj"> setImage </strong>。这确保了每当有一个文件被选择时，我们的状态被更新，并且<strong class="jq hj"> image(从useState析构)</strong>保存在<strong class="jq hj"> e.target.files[0] </strong>中找到的新文件。</p><p id="9131" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">每当单击按钮并且图像上传过程开始时，按钮上的onclick属性就调用该函数。</p><h1 id="d268" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">结论</h1><p id="7ce5" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">如您所见，这是一种非常简单直接的方式来处理上传到服务器的图像。</p><p id="46cf" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">如果你觉得这有用，请鼓掌，如果你有任何问题或建议，请随意发表评论</p><p id="7870" class="pw-post-body-paragraph jo jp hi jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>
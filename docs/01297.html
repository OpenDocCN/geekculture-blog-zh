<html>
<head>
<title>Kerberos v5: SSO authentication in Windows 10 Home using Apache directory studio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kerberos v5:使用Apache directory studio在Windows 10 Home中进行SSO认证</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/kerberos-v5-sso-authentication-in-windows-10-home-using-apache-directory-studio-fb0151899185?source=collection_archive---------4-----------------------#2021-04-05">https://medium.com/geekculture/kerberos-v5-sso-authentication-in-windows-10-home-using-apache-directory-studio-fb0151899185?source=collection_archive---------4-----------------------#2021-04-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="f9c8" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">学习带有Spring Security的Kerberos V5:IAM</h2><div class=""/><div class=""><h2 id="a91c" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">无缝SPNEGO HTTP身份验证</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es jg"><img src="../Images/5301916a5ad16caa0b94256a763ba8bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*Nd_OdUtrBjtDe0CCwvg02w.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">3 components in Kerberos network authentication protocol</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es js"><img src="../Images/66f0cb57f43275fb6d14ff8d375933d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNER_vY_8Py_atmPLiwz8g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Kerberos v5 Single Sign-On Security</figcaption></figure></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="e301" class="ke kf hi bd kg kh ki kj kk kl km kn ko ix kp iy kq ja kr jb ks jd kt je ku kv bi translated">范围</h1><p id="ed46" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi ls translated">这篇文章解释了如何在Windows 10 Home中使用Kerberos网络协议单点登录身份验证来实现安全性。它在Apache directory studio中启用Kerberos，Apache directory studio是一个LDAP服务器和密钥分发中心(KDC)。<br/> Kerberos v5单点登录(SSO)使用运行在不同端口的两个Spring boot应用程序进行解释。</p><h1 id="fc8a" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated"><strong class="ak">先决条件</strong></h1><p id="7342" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">如果您希望在您的本地环境中执行此操作，那么<strong class="ky hs"> <em class="mg">软件安装和应用的最低要求是:<br/><strong class="ky hs">a .</strong>Windows 10 Home<br/><strong class="ky hs">b .</strong>Apache Directory studio v 2 . 0 . 0<br/><strong class="ky hs">c .</strong>MIT Kerberos client-kfw-4 . 0 . 1<br/><strong class="ky hs">d .</strong>在Java SE平台v1.8开发两个Spring boot应用，测试Kerberos v5 SSO <br/> <strong class="ky hs"> e. </strong>浏览器配置。Firefox/Edge/Chrome【如下图】<br/><strong class="ky hs"><em class="mg">f .</em></strong><em class="mg">Spring Boot应用代码可以在</em> <a class="ae mh" href="https://github.com/ganesh-nag/Kerberos-V5-SSO-Authentication" rel="noopener ugc nofollow" target="_blank"> GitHub </a>看到。您需要使用链接中给出的两个项目来测试Kerberos v5 SSO。</em></strong></p></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><h1 id="ed8b" class="ke kf hi bd kg kh ki kj kk kl km kn ko ix kp iy kq ja kr jb ks jd kt je ku kv bi translated"><strong class="ak">安全配置</strong></h1><h2 id="8b19" class="mi kf hi bd kg mj mk ml kk mm mn mo ko lf mp mq kq lj mr ms ks ln mt mu ku ho bi translated"><strong class="ak"> Windows 10首页</strong></h2><p id="ade0" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">DNS主机名设置:C:\ Windows \ System32 \ drivers \ etc \ hosts<br/>127 . 0 . 0 . 1<strong class="ky hs">example.net</strong></p><blockquote class="mv mw mx"><p id="787f" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated">系统环境变量设置<br/>krb 5c name = C:\ Users \<strong class="ky hs">{ username }</strong>\ AppData \ Local \ Temp \ krb 5b cache</p></blockquote><h2 id="7fc0" class="mi kf hi bd kg mj mk ml kk mm mn mo ko lf mp mq kq lj mr ms ks ln mt mu ku ho bi translated"><strong class="ak"> Apache目录工作室</strong></h2><p id="8bb7" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated"><strong class="ky hs">答:</strong> Apache DS连接配置</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ng"><img src="../Images/193155374e75237b0599d39dccaddc46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Uu0WKP6o2f_m9cBgh-GLg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Overview tab</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es nh"><img src="../Images/63f05e47630c799b1ecff70cae4d0c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ip9sVs6rUADaNeTlV1uSgw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">SASL settings</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ni"><img src="../Images/cf53446b1c78e664f390102a2090bffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4vvScM8rVgdhY513cvqHbQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Kerberos server settings</figcaption></figure><p id="d537" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated"><strong class="ky hs"> b. </strong>将以下LDIF文件导入Apache DS，以创建<strong class="ky hs">层级、服务</strong>和<strong class="ky hs">用户</strong></p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nj"><img src="../Images/363df922844f73193950bf0cf8f6c12a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*DzYa9dk1MFR3NiZL7oMNFw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">hierarchy.ldif</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es nk"><img src="../Images/3089806ac8d837063d8a135bf614a2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZ6jPLX92eY_iKVj8q0JCQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">services.ldif</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nl"><img src="../Images/fcec7b6d72655b887e02fdaba4e89a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*RwpTerZ6OZPskoSNnQseYg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">users.ldif</figcaption></figure><h2 id="f733" class="mi kf hi bd kg mj mk ml kk mm mn mo ko lf mp mq kq lj mr ms ks ln mt mu ku ho bi translated">MIT Kerberos客户端</h2><p id="0d7c" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">使用记事本创建包含以下内容的krb5.ini文件，该文件应存储在C:\ program data \ MIT \ Kerberos 5 \ krb5 . ini下</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es nm"><img src="../Images/3b4c230f5781790b9dc7eb5eb2a7242c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3fb4eZXZi9hiXOuChZqoxw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">krb5.ini</figcaption></figure><blockquote class="mv mw mx"><p id="13f8" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated">上面的屏幕截图显示了<strong class="ky hs"> krb5cache </strong>位置存储票据，这些票据是使用服务主体名称创建的，并使用服务主体密码加密。这样，密码就不会通过网络发送，而这正是Kerberos的症结所在。</p><p id="2776" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated">当用户试图通过浏览器访问一个<strong class="ky hs"><em class="hi">/受保护的</em> </strong>端点时，如果<strong class="ky hs"> krb5cache </strong>为空，MIT Kerberos票证管理器将弹出，您提供服务主体凭证以创建票证授予票证(TGT)。KDC的票据授予服务器(TGS)创建TGT。MIT Kerberos票证管理器将在krb5.ini文件中查找域名和KDC位置来获取TGT。</p><p id="a4b4" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated">用于web应用程序的服务主体名称以<strong class="ky hs"> HTTP/HOSTNAME@REALM </strong>开头，即<strong class="ky hs"> HTTP/example.net/EXAMPLE。本例中的COM </strong>。您可以在上面我们在Apache DS中创建的<strong class="ky hs"> services.ldif </strong>文件中找到服务主体名称条目。</p></blockquote><h1 id="2c3d" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated"><strong class="ak">什么是SPNEGO和GSS-API？我们为什么需要？</strong></h1><p id="8ce5" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">Kerberos是一种主要在传输层(TCP/UDP)运行的安全网络身份验证协议。这就是我们需要SPNEGO的地方。<strong class="ky hs"> SPNEGO </strong> ( <em class="mg">简单且受保护的GSS_API协商机制</em>)为web应用扩展了Kerberos SSO。</p><p id="ea67" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">Web应用程序通信主要发生在web浏览器和通过HTTP托管web应用程序的web服务器之间。允许应用程序通过SPNEGO将Kerberos作为安全机制进行协商，并通过HTTP将票证作为SPNEGO令牌进行交换。</p><h2 id="a8fa" class="mi kf hi bd kg mj mk ml kk mm mn mo ko lf mp mq kq lj mr ms ks ln mt mu ku ho bi translated"><strong class="ak"> GSS-API </strong>是<strong class="ak">通用安全服务API </strong></h2><p id="3e16" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">它为访问不同的安全服务提供了一个公共接口。SPNEGO是GSS API的一部分，用于客户端和服务器协商安全机制的选择，例如Kerberos或NTLM。</p><p id="6f4c" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">SPNEGO是一种与认证者协商以决定使用何种协议的机制，即<strong class="ky hs"> GSS/SPNEGO - &gt;摘要- &gt; NTLM - &gt;基本</strong>。注意，Kerberos没有出现在这个列表中，因为每当支持协商时，总是选择<strong class="ky hs"> GSS/SPNEGO </strong>。“<strong class="ky hs"> SPNEGO </strong>”表示您更喜欢使用<strong class="ky hs"> GSS/SPNEGO </strong>机制来响应协商方案。</p><h1 id="da81" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated">事件的经过，一瞥</h1><ol class=""><li id="b019" class="nn no hi ky b kz la lc ld lf np lj nq ln nr lr ns nt nu nv bi translated">如果<strong class="ky hs"> krb5cache </strong> <em class="mg">为空，将弹出</em> MIT Kerberos票证管理器，用户需要提供服务主体凭证来创建票证授予票证(TGT)。服务主体凭据用于创建支持单点登录的TGT。</li><li id="15f1" class="nn no hi ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">身份验证成功后，票据授予票据(TGT)存储在主体的私有凭证集中，Kerberos主体存储在主体的主体集中。与TGT一起，一个<strong class="ky hs">服务器的长期</strong> <em class="mg">密钥</em>也存储在该主题中。这个密钥被目标服务器用来解密<strong class="ky hs">服务票</strong>。</li><li id="1254" class="nn no hi ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">Kerberos服务身份验证提供程序使用客户端的TGT获取目标服务器的服务票。这个服务票是使用<strong class="ky hs">服务器长期</strong> <em class="mg">密钥加密的。</em></li><li id="075f" class="nn no hi ky b kz nw lc nx lf ny lj nz ln oa lr ns nt nu nv bi translated">目标服务器<em class="mg">使用<strong class="ky hs">服务器长期</strong> <em class="mg">密钥</em> <strong class="ky hs">解密</strong></em>服务票。</li></ol><h1 id="1a4d" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated"><strong class="ak">发送SPNEGO令牌的用户代理配置</strong></h1><p id="71c4" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">Firefox设置</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ob"><img src="../Images/1285ad12595579279500eeb7bb98710f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4o4fQK1GLZ9nI6Mdc9311A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Firefox settings</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oc"><img src="../Images/90ddafd6164872aa66c71e025143311b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BehquaYOJiAmUKNxb7AICA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Firefox settings</figcaption></figure><h1 id="6e2c" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated"><strong class="ak">Kerberos V5 SSO认证如何工作？</strong></h1><p id="9a53" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">让我们启动两个运行REST服务的spring boot应用程序，看看票证是如何生成的，以及Kerberos SSO认证是如何工作的。</p><p id="2c31" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">让我们首先为服务主体创建密钥表文件，并将它们放在<strong class="ky hs">C:\ key tabs</strong><br/>Java<strong class="ky hs">ktab</strong>实用程序可用于创建密钥表文件，对于本例，它们存储在名为<strong class="ky hs"> webapp.keytab </strong>的文件中。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es od"><img src="../Images/67a856c45fc8f3de83760efa62b2b4bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPAgVgoa_qmswel-5FwtSA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">keytab files creation</figcaption></figure><p id="199e" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">必须在Spring boot应用程序的以下配置中提供key-tab的位置和服务主体名称，以验证身份验证。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oe"><img src="../Images/9b1d291c0564b018d33b92e0da7b0445.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XnEKMdfI_1YR3lM8qtyl0w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">keytab and service principal in spring boot</figcaption></figure><p id="1e4a" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">a.运行<strong class="ky hs">Kerberos authapplication</strong>Spring boot应用在<strong class="ky hs">端口8080 </strong> <br/>添加VM参数<strong class="ky hs">-DJ ava . security . krb5 . conf</strong>= " C:/Program Files/Java/JDK 1 . 8 . 0 _ 281/JRE/lib/security/krb5 . conf "</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es of"><img src="../Images/b6115ba2d3a7938c79f2d1215f2422fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zLAE60uUtB6Ifzog80heg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Run configuration using Java</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es og"><img src="../Images/4de176d6cde83ae82049f343472a87bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_MLf8-HZRRz0_McuQLXig.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Spring boot application started in port 8080</figcaption></figure><p id="0710" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">b.运行<strong class="ky hs">kerberosauthapplication 1</strong>Spring boot应用在<strong class="ky hs">端口8081 </strong> <br/>添加VM参数<strong class="ky hs">-DJ ava . security . krb5 . conf</strong>= " C:/Program Files/Java/JDK 1 . 8 . 0 _ 281/JRE/lib/security/krb5 . conf "</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oh"><img src="../Images/157f0cc4101a5bd1bad4e4fab93ddd77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2cXJockV4WCzRUGVsYYJg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Run configuration using Java</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oi"><img src="../Images/41bf07f34edf38799508214e3d2d4cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wy1I0727rD5nBata1BkpKQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Spring boot application started in port 8081</figcaption></figure><p id="d62c" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">当2个Spring boot应用程序运行时，我们点击<strong class="ky hs"> /protected </strong>端点，看看会发生什么。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oj"><img src="../Images/58b1a599c59732dc7996fc1296b52fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7iL9BqxZXuQZ1AwJYSEenA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">user hits /protected endpoint</figcaption></figure><p id="301b" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">从下面的屏幕截图可以看出，我们弹出了MIT Kerberos票证管理器。这是因为，krb5缓存是空的，我们必须生成一个TGT。要生成TGT，我们必须提供服务主体名称和密码。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ok"><img src="../Images/b87705dad06b80d509e92aca67936f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_g_IuQCk1QMxvLKdxWcxfg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">MIT Kerberos UI login</figcaption></figure><p id="be7c" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">如果输入的服务主体名称不正确，那么服务器会在响应中提示使用<strong class="ky hs">WWW-Authenticate:Negotiate</strong>。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es ol"><img src="../Images/0ccd8695a5adf37e860183d2d60eb8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dT2oM1DNDC3845iYlTO9kQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">invalid service principal credentials</figcaption></figure><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es om"><img src="../Images/3c0db3ff122b6b7a8107cfbcfaf8e5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Zdo3k7nTkxIeIZ4Un7qkA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">WWW-Authenticate: Negotiate in the response</figcaption></figure><p id="e354" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">现在，我们使用正确的服务主体凭证进行身份验证，以获得TGT和无缝Kerberos身份验证。如果成功，它将返回HTTP 200状态。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es on"><img src="../Images/729070607fc7a287ec0872d5943370e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01chXBhgchxACOT4ep4O5g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">service principal credentials to get TGT</figcaption></figure><p id="8971" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">下面的屏幕截图显示已经为服务主体生成了TGT。还有一种方法可以通过命令行生成TGT。导航到<br/>C:\ Program Files \ MIT \ Kerberos \ bin&gt;<em class="mg">kinit-k-t C:\ key tabs \ web app . keytab</em><a class="ae mh" href="mailto:HTTP/example.net@EXAMPLE.COM" rel="noopener ugc nofollow" target="_blank"><em class="mg">HTTP/example.net@EXAMPLE.COM</em></a><br/>这个命令将生成key-tab文件，就像上面的MIT Kerberos票证管理器生成的一样。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oo"><img src="../Images/29302543272279c42dea8f790e1d69f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvJlyXV8Yju0bWeLzYlcNg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">TGT generated</figcaption></figure><p id="a3e0" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">你可以在下面的屏幕截图中看到最后一个条目，用TGT创建的<strong class="ky hs"> krb5cache </strong>。这是<strong class="ky hs"> krb5.ini </strong>和<strong class="ky hs"> krb5.conf </strong>中给出的路径。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es op"><img src="../Images/c4f8af24a67cf23d63cfd3530a233443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*beyCu_IjH-CWONRSq_u_eA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">krb5cache</figcaption></figure><p id="28f2" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">使用正确的服务主体凭证生成TGT后，点击<strong class="ky hs"> /protected </strong>端点，您将看到<strong class="ky hs"> KerberosAuthApplication </strong>在<strong class="ky hs">端口8080 </strong>中运行，并收到来自服务器的响应。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es oq"><img src="../Images/81312d66ce1bde271f4ad42dfd152076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPAfdlennKrYkP4MAmcgFw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">KerberosAuthApplication</figcaption></figure><p id="87e9" class="pw-post-body-paragraph kw kx hi ky b kz my is lb lc mz iv le lf nb lh li lj nd ll lm ln nf lp lq lr hb bi translated">点击<strong class="ky hs"> SSO登录</strong>链接，您将可以访问运行在<strong class="ky hs">端口8081 </strong>的<strong class="ky hs">Kerberos authapplication 1</strong>，如下图所示。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es or"><img src="../Images/474f9d03edbc6af9343a2e66ee57f496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rXqczFM8wnJTFMsYmYuXw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">KerberosAuthApplication1</figcaption></figure><h1 id="34b1" class="ke kf hi bd kg kh mb kj kk kl mc kn ko ix md iy kq ja me jb ks jd mf je ku kv bi translated"><strong class="ak">结论</strong></h1><p id="43ea" class="pw-post-body-paragraph kw kx hi ky b kz la is lb lc ld iv le lf lg lh li lj lk ll lm ln lo lp lq lr hb bi translated">于是我们通过使用<strong class="ky hs"> Apache Directory Studio </strong>与<strong class="ky hs"> REST API </strong>集成，最终在<strong class="ky hs"> Windows 10 Home </strong>中完成了<strong class="ky hs"> Kerberos v5 SSO </strong>。上面给出的GitHub链接有经过测试的源代码，您可以利用它来进一步理解Kerberos的细微差别和症结。</p><h2 id="23fb" class="mi kf hi bd kg mj mk ml kk mm mn mo ko lf mp mq kq lj mr ms ks ln mt mu ku ho bi translated">发布于<em class="os">2021年4月5日</em></h2></div><div class="ab cl jx jy gp jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="hb hc hd he hf"><blockquote class="mv mw mx"><p id="603a" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><strong class="ky hs"> <em class="hi">其他中等文章，</em>由<em class="hi"> Ganesh Nagalingam </em> </strong></p><p id="a356" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" rel="noopener" href="/geekculture/quest-syntax-tree-and-remedy-code-smell-using-japa-visitor-patterns-f023a89842cf">使用JAPA访问者模式探索语法树和补救代码气味</a></p><p id="6833" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" rel="noopener" href="/nerd-for-tech/asynchronous-websocket-messaging-middleware-and-microservices-1a50a8f14e4b">异步WebSocket消息中间件和微服务</a></p><p id="6575" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" rel="noopener" href="/geekculture/amalgamate-angular-with-spring-cloud-architecture-through-cors-7f13b5fdb98f">通过CORS融合Angular和Spring Cloud架构</a></p><p id="4073" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" rel="noopener" href="/geekculture/multi-broker-insights-into-apache-kafka-cluster-architecture-617b0abfc53e"> <em class="hi">多代理洞察Apache Kafka集群架构</em> </a></p><p id="a426" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganeshblog.medium.com/remote-queue-definition-ibm-mq-v9-2-c3ec4f568dab?source=user_profile---------5----------------------------" rel="noopener">远程队列定义:IBM MQ v9.2 </a></p><p id="681e" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganeshblog.medium.com/kubernetes-pods-docker-containers-spin-vm-using-virtual-box-in-windows-10-home-d3be783ff087?source=user_profile---------0----------------------------" rel="noopener">Kubernetes Pods&amp;Docker Containers:在Windows 10 Home中使用虚拟盒子旋转虚拟机</a></p><p id="033f" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganeshblog.medium.com/federate-okta-idp-wso2-api-manager-as-gateway-to-spring-boot-microservices-integration-ba567567e81?source=user_profile---------1----------------------------" rel="noopener">联合OKTA IdP + WSO2 API管理器作为Spring boot微服务集成的网关</a></p><p id="2172" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganeshblog.medium.com/integrate-ibm-websphere-service-registry-and-repository-with-ibm-process-server-f97eeb0e2ea?source=user_profile---------6----------------------------" rel="noopener">将IBM WebSphere Service Registry and Repository与IBM Process Server集成</a></p><p id="b3b9" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganesh-nagalingam.medium.com/integrate-service-providers-sps-with-okta-identity-provider-idp-ce64a4e262ae" rel="noopener">整合服务提供商(sp)和OKTA身份提供商(IdP) </a></p><p id="9090" class="kw kx mg ky b kz my is lb lc mz iv le na nb lh li nc nd ll lm ne nf lp lq lr hb bi translated"><a class="ae mh" href="https://ganesh-nagalingam.medium.com/integrate-ibm-business-process-manager-with-hybrid-mobilefirst-application-5aed20841bf3?source=your_stories_page-------------------------------------" rel="noopener">将IBM业务流程管理器与混合MobileFirst应用程序集成</a></p></blockquote></div></div>    
</body>
</html>
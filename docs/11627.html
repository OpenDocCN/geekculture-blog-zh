<html>
<head>
<title>Angular:Using ngx-bootstrap Collapse feature for multiple sections</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">角度:对多个截面使用ngx引导折叠功能</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/angular-using-ngx-bootstrap-collapse-feature-for-multiple-sections-b4c801346a8?source=collection_archive---------5-----------------------#2022-04-01">https://medium.com/geekculture/angular-using-ngx-bootstrap-collapse-feature-for-multiple-sections-b4c801346a8?source=collection_archive---------5-----------------------#2022-04-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7a8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与bootstrap提供的折叠特性不同，ngx-bootstrap模块的折叠特性需要更多的代码才能工作。</p><p id="f94c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我经常看到跨多个平台的通用查询，其中开发人员被迫使用多个变量来跟踪多个部分的折叠状态。这个故事主要集中在:</p><ol class=""><li id="3916" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">如何使用单个变量来跟踪多个部分的折叠状态。</li><li id="287a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如何在没有jquery的情况下添加一个按钮来切换多个部分的折叠/展开状态。</li></ol><p id="0be2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是应用程序的外观。我们有一个<strong class="ih hj">“切换所有部分”</strong>按钮，后面是4个折叠部分。每个部分都可以展开或折叠，单击描述该部分的按钮的任意位置，并提供一个指示该部分折叠状态的箭头图标。</p><p id="5f9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">【切换所有部分】</strong>按钮将根据<strong class="ih hj">【切换所有部分】</strong>按钮状态展开所有部分或折叠部分。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es jr"><img src="../Images/30e5f5153bbc777de2af839beae7a38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cC5xpXydA9Azhpp8Tj2D-Q.png"/></div></div></figure><p id="37bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们单击第1部分和第4部分按钮时，下面是展开状态的第1部分和第4部分的屏幕截图。请注意，对于展开的部分，箭头图标的方向也发生了变化。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kd"><img src="../Images/58b7887f8872f63524611a2ed99361d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPExmko2e0U8tPFhyKb1-g.png"/></div></div></figure><p id="636b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，当我们点击<strong class="ih hj">“切换所有部分”</strong>按钮时，我们注意到所有部分现在都处于展开状态。这是因为<strong class="ih hj">“切换所有部分”</strong>按钮的状态已经从折叠变为展开。请注意，箭头图标的方向已针对该部分以及<strong class="ih hj">“切换所有部分”</strong>按钮进行了切换。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es ke"><img src="../Images/0ea344abb2b8ecf83f38906be20432ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybCdQIi1NxPa3gquYvzzfw.png"/></div></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kd"><img src="../Images/6ce7824cf398a3ff2be3a9dd14829e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tywPWo7pL0WNFlKbd0IGJw.png"/></div></div></figure><p id="7bee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看<strong class="ih hj"> AppComponent模板</strong>。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="3f01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于所有部分具有相似的外观，我们创建了引用<strong class="ih hj"> collapsibleSection，</strong>的模板，以便它可以在所有4个部分中重复使用。在这个模板中，我们有两个部分:</p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="2644" class="km kn hi ki b fi ko kp l kq kr">&lt;button type="button" class="btn btn-primary"        <strong class="ki hj">(click)="toggleSectionVisibility($event, options, sectionIndex)"        [attr.aria-expanded]="options[sectionIndex]"        <br/>[attr.aria-controls]="sectionIndex"</strong>&gt;        <br/>&lt;a&gt;&lt;i class="bi bi-arrow-down"            <br/><strong class="ki hj">[ngClass]="options[sectionIndex] ? 'bi bi-arrow-up' : 'bi bi-arrow-down'"</strong>&gt;&lt;/i&gt;          <br/>&lt;span&gt;{{ data.question }}&lt;/span&gt;&lt;/a&gt;      <br/>&lt;/button&gt;</span></pre><p id="e76f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">= &gt;一个按钮，包含一些描述该部分内容的文本和一个指示该部分折叠状态的箭头图标。</p><p id="9cd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">= &gt;<strong class="ih hj">[ng class]属性</strong>负责切换图标类。</p><p id="c850" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">= &gt;我们有一个带有<strong class="ih hj">属性</strong>的<div>标签。这包含该部分的内容。带有布尔值的[collapse]属性控制该部分的展开和折叠状态。</div></p><p id="7fb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意包含节内容的&lt; div &gt;标签的<strong class="ih hj"> ID必须与节按钮的<strong class="ih hj"> aria-controls属性</strong>相同。我们已经将部分</strong>的<strong class="ih hj">索引分配给了ID和aria-controls属性。</strong></p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="af5f" class="km kn hi ki b fi ko kp l kq kr">&lt;div class=”row” <strong class="ki hj">id=”{{ sectionIndex }}” [collapse]=”!options[sectionIndex]”</strong>&gt; <br/>&lt;div class=”jumbotron col-md-12"&gt; <strong class="ki hj">{{ data.answer }}</strong> &lt;/div&gt; <br/>&lt;/div&gt;</span></pre><p id="6652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在屏幕上呈现所有4个部分的模板，我们有下面这段HTML。</p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="192e" class="km kn hi ki b fi ko kp l kq kr">&lt;button <br/><strong class="ki hj">(click)="toggleAllSections($event)"</strong> class="btn btn-default"&gt;      <br/>&lt;a&gt;<br/>&lt;i class="bi bi-arrow-down" <strong class="ki hj">[ngClass]="            allSectionsToggleState ? 'bi bi-arrow-up' : 'bi bi-arrow-down'          "</strong>&gt;<br/>&lt;/i&gt;&lt;span&gt;Toggle All Sections&lt;/span&gt;&lt;/a&gt;    <br/>&lt;/button&gt;    </span><span id="7bcd" class="km kn hi ki b fi ks kp l kq kr">&lt;div *ngFor="let item of sectionData; let i = index"&gt;      <br/>&lt;ng-container  <strong class="ki hj">[ngTemplateOutlet]="collapsibleSection"        [ngTemplateOutletContext]="{data: item,options: sectionOptions[i],          sectionIndex: i}"</strong>&gt;     <br/>&lt;/ng-container&gt;    <br/>&lt;/div&gt;</span></pre><p id="2bf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> sectionData </strong>是一个由4个对象组成的数组，包含4个部分的数据。我们正在遍历它，并在带有<strong class="ih hj"> collapsibleSection </strong>引用的模板上显示它。</p><p id="6a34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> sectionOptions </strong>是一个由4个对象组成的数组，其中每个对象都包含决定节的折叠和展开状态的数据。因此，我们对所有部分都使用一个对象。</p><p id="145b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们转到<strong class="ih hj"> AppComponent类</strong>。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="61b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">allsectionstogglegate</strong>属性控制“切换所有部分”按钮和4个部分的展开/折叠状态。由于它最初是假的，所有4个部分也处于折叠状态。</p><p id="8c30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经定义了<strong class="ih hj"> sectionData，</strong>，它是一个由4个对象组成的数组。每个对象包含2个属性:<strong class="ih hj">问题</strong>和<strong class="ih hj">答案</strong>。当用户单击相应的部分按钮时，question属性的值显示在每个部分按钮上，answer属性的值显示为部分内容。</p><p id="d7f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<strong class="ih hj"> ngOnInit() </strong>生命周期钩子中，我们根据<strong class="ih hj"> sectionData的长度设置<strong class="ih hj"> sectionOptions </strong>的值。</strong>我们正在迭代<strong class="ih hj"> sectionData </strong>并且对于每一次迭代(对应于每一个部分)我们已经创建了一个对象<strong class="ih hj"> obj </strong>。</p><p id="2e15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">obj 的<strong class="ih hj">键将是<strong class="ih hj">迭代或段索引</strong>并且该键</strong>的<strong class="ih hj">值对于所有段将初始为<strong class="ih hj">假</strong>。这确保所有部分最初都处于折叠状态。</strong></p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="41c5" class="km kn hi ki b fi ko kp l kq kr"><strong class="ki hj">ngOnInit() { </strong><br/><strong class="ki hj">this.sectionData.forEach</strong>((item, itemIndex) =&gt; { <br/>let obj = {}; <br/><strong class="ki hj">obj[`${itemIndex}`] = false; <br/>this.sectionOptions.push(obj);</strong> <br/>}); <br/>}</span></pre><p id="9655" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当4个部分按钮中的任何一个被点击时，我们调用<strong class="ih hj">toggleSectionVisibility()</strong>方法，传递对应于该部分的<strong class="ih hj">选项对象</strong>以及<strong class="ih hj">部分索引</strong>作为参数。</p><p id="5968" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如已经看到的那样，<strong class="ih hj">选项对象</strong>包含作为节索引的键，并且值最初为假。在这个方法中，我们将把这个键的值从false切换到true，或者从true切换到false(基于初始值)。切换该值也将切换该部分的展开或折叠状态。</p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="2aab" class="km kn hi ki b fi ko kp l kq kr"><strong class="ki hj">toggleSectionVisibility(event, options, sectionIndex) {</strong><br/>options[`${sectionIndex}`] = !options[sectionIndex];<br/>}</span></pre><p id="584e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当点击“切换所有部分”按钮时，我们调用<strong class="ih hj"> toggleAllSections()。</strong>在这个方法中，我们首先切换<strong class="ih hj">allsectionstogglegate</strong>的值。接下来，我们将遍历<strong class="ih hj"> sectionOptions </strong>数组。正如我们已经知道的，这个数组包含4个对象，对应于4个部分。每个对象包含作为键的节索引和作为值的节的展开/折叠状态。</p><p id="bf14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在每次迭代中(对应于每个部分)，我们将键(部分索引)的值设置为<strong class="ih hj">allsectionstogglegate。</strong></p><pre class="js jt ju jv fd kh ki kj kk aw kl bi"><span id="e303" class="km kn hi ki b fi ko kp l kq kr"><strong class="ki hj">toggleAllSections(event) { </strong><br/>this.allSectionsToggleState = !this.allSectionsToggleState;    this.sectionOptions.forEach((item, itemIndex: number) =&gt; {      <strong class="ki hj">item[`${itemIndex}`] = this.allSectionsToggleState;</strong>    <br/>});<br/>}</span></pre><p id="8027" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的工作示例可以在下面找到。</p><div class="kt ku ez fb kv kw"><a href="https://stackblitz.com/edit/angular-s1txsp?file=src/app/app.component.ts" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hj fi z dy lb ea eb lc ed ef hh bi translated">角形(叉形)堆叠</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">一个基于rxjs，tslib，core-js，zone.js，@angular/core，@angular/forms，@angular/common的angular-cli项目…</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">stackblitz.com</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk kb kw"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>SwiftUI Animation Completion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SwiftUI动画完成</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/swiftui-animation-completion-b6f0d167159e?source=collection_archive---------2-----------------------#2022-10-24">https://medium.com/geekculture/swiftui-animation-completion-b6f0d167159e?source=collection_archive---------2-----------------------#2022-10-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/725525b64ac15d53a9fda0a97f55507e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KjkXJzxxVXaQBPEe"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/es/@jtzanno?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joao Tzanno</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5d57" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SwiftUI的动画中有一点相当恼人，那就是它缺少一个完成块来通知我们动画何时完成。</p><p id="6511" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不幸的是，还没有很好的解决方案，但是我们可以尝试一些方法。</p><h2 id="2eaa" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">概观</h2><p id="58a6" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">这个异步扩展可以让你在动画完成后轻松地执行操作。</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><h1 id="9e4c" class="kz ju hi bd jv la lb lc jz ld le lf kd lg lh li kg lj lk ll kj lm ln lo km lp bi translated">用例</h1><p id="0f6e" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">当您想要在动画完成后执行某个动作或链接动画时，具有完成回调特别有用。</p><p id="ad85" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设一个文本视图有两个动画，应该一个接一个地运行；第一个改变视图的比例，第二个改变它的颜色。我们一点击文本，动画就开始了。</p><p id="b4e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从同时运行两个动画开始。</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/b648f197b5e668ab89f4b137727dc0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/1*YtAjX1332yFXg5Vhl4_nSw.gif"/></div></figure><h2 id="5b96" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jg ke kf kg jk kh ki kj jo kk kl km kn bi translated">按顺序制作动画</h2><p id="3822" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">一切正常，除了我们想按顺序运行动画。因为我们没有完成回调，所以我们必须将第二个动画延迟相同的时间。在第二个块中，我们可以触发下一个动画。</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/3a001f5c7e8f05051732224fbc97b71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/1*nsckm7HmIVqNnlExMuq7pQ.gif"/></div></figure><p id="68b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到目前为止，一切看起来都很好，但是如果你想在动画完成后更新值，事情会变得更复杂。</p><p id="0ded" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们试着在两个动画完成后打开一个工作表。这将是一个幼稚的第一次尝试:</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="ebdb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里的问题是，只要我们点击组件，工作表就会显示出来。为了让它正常工作，我们必须触发一个对main的异步调度调用，这个调用只在一定时间后执行。延迟时间需要与动画持续时间相匹配。</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><figure class="kt ku kv kw fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/e8c6b872dc4d9a1e8ec25758fd0d6041.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/1*Ptx0LUrZDP2k39fAIJNNmA.gif"/></div></figure><h1 id="c681" class="kz ju hi bd jv la lb lc jz ld le lf kd lg lh li kg lj lk ll kj lm ln lo km lp bi translated">结果</h1><p id="d51e" class="pw-post-body-paragraph iv iw hi ix b iy ko ja jb jc kp je jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">现在，它的行为符合我们的预期，我们可以更进一步，将其抽象为一个异步函数，这将允许我们在动画上使用await:</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="deeb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要实现这一点，只需添加下面的扩展。</p><figure class="kt ku kv kw fd ij"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="b7cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">暂时就这样吧！</p></div><div class="ab cl lr ls gp lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="hb hc hd he hf"><p id="90a2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你喜欢我的内容吗？<br/>帮我继续捐款吧！</p><div class="ly lz ez fb ma mb"><a href="https://www.paypal.com/donate/?hosted_button_id=B3W6GJWSPB4VU" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab dw"><div class="md ab me cl cj mf"><h2 class="bd hj fi z dy mg ea eb mh ed ef hh bi translated">捐赠给爱德华多·多米尼二世</h2><div class="mi l"><h3 class="bd b fi z dy mg ea eb mh ed ef dx translated">通过捐赠或与朋友分享来帮助支持小爱德华多·多米尼。</h3></div><div class="mj l"><p class="bd b fp z dy mg ea eb mh ed ef dx translated">www.paypal.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp io mb"/></div></div></a></div></div></div>    
</body>
</html>
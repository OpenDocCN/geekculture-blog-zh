<html>
<head>
<title>Time Series forecasting using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/time-series-forecasting-using-python-de86c05bffef?source=collection_archive---------12-----------------------#2021-05-24">https://medium.com/geekculture/time-series-forecasting-using-python-de86c05bffef?source=collection_archive---------12-----------------------#2021-05-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="0cd0" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">你有没有想过预测比特币？</h2></div><p id="9afd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当然，你有。我们都有。</p><p id="6ab7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将给出一些细节，说明如何使用Python和用于时间序列分析的库<code class="du jt ju jv jw b">sktime</code>来实现这一点。</p><p id="7151" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">不要把我当成你的妈妈，但我不建议你在生产中尝试使用它:很可能你会失去你的钱(至少我应该警告你)。</p><figure class="jy jz ka kb fd kc er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es jx"><img src="../Images/90f80e85aa11c4529bff8891f1ac9d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqKfRDQS9zFOeWmMBvr0rw.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx">Denis Shilov (that’s me)</figcaption></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="973c" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">数据及其来源的选择</h1><p id="632c" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">币安是全球最大的密码交易所之一。它还有一个相对简单的API，所以下载数据不会花太多时间。</p><p id="56be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们选择下载15分钟蜡烛线的数据，因为与预测5分钟蜡烛线相比，这将是一项更复杂的任务，而且比预测30分钟蜡烛线(etc)更容易。</p><p id="cace" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们选择了BTC，因为这是对其他加密货币价格影响最大的主要加密货币。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="3d3f" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">导入和常量</h1><p id="3b2e" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们在这里使用的是:</p><ul class=""><li id="a5ad" class="lr ls hi iz b ja jb jd je jg lt jk lu jo lv js lw lx ly lz bi translated"><code class="du jt ju jv jw b">os</code>包与操作系统通信</li><li id="9923" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">币安API获取BTC历史数据</li><li id="8847" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">pickle</code>保存和加载数据</li><li id="4f8d" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">sktime</code>预测我们的时间序列数据</li><li id="8384" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">numpy</code>计算一些东西</li><li id="c844" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">pmdarima</code>检查平稳性</li><li id="9f12" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">lightgbm</code>是最著名的助推器之一</li><li id="b1b9" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated"><code class="du jt ju jv jw b">xgboost</code>是另一个著名的助力</li></ul><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="d598" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们加载一些API键和其他常量。</p><p id="f822" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如你所见，我们将在3周前的BTC-USDT对上用15分钟蜡烛训练我们的模型。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mh mg l"/></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="6aa1" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">加载数据</h1><p id="4a1f" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们将保存数据以备后用，只是为了在每次启动笔记本时不浪费时间加载这些数据。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mi mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mj mg l"/></div></figure><p id="fe84" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里我们加载数据。如果数据已经在缓存中，那么我们从缓存中加载。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="517b" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">检查数据</h1><p id="6f82" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">哈，我们终于来了！现在我们来玩玩数据:-)</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mi mg l"/></div></figure><p id="1df7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看它是什么样子的</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mk mg l"/></div></figure><p id="5f82" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据币安API，它对应于:</p><figure class="jy jz ka kb fd kc er es paragraph-image"><div class="er es ml"><img src="../Images/d1aa508cf145422fb14a1110954d66ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*Dsra9b0qjU1ArfEocz4x7w.png"/></div></figure><h2 id="d064" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">我们应该忽略:</h2><ol class=""><li id="3207" class="lr ls hi iz b ja lm jd ln jg na jk nb jo nc js nd lx ly lz bi translated">关闭时间，因为我们已经知道这是一个15分钟的蜡烛。</li><li id="a596" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">API告诉我们忽略最后一个元素</li><li id="e524" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">“引用资产量”，因为它重复了“量”的含义</li><li id="f59a" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">“买方买入报价资产量”，因为它重复了“买方买入基础资产量”的含义</li></ol></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="bbe0" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">解析数据</h1><p id="d9fc" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们的目标是预测<em class="ne">某事</em>。但是我们这里有4个价格，不是1个价格！</p><p id="c433" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我们会得到一根蜡烛的加权平均值，我们会试着去预测。</p><p id="f195" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">价格的高低不像开盘价和收盘价那么有趣，因为它们就像离群值。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nf mg l"/></div></figure><h2 id="d6e3" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">我们可以用什么来训练我们的模型？</h2><ol class=""><li id="ec89" class="lr ls hi iz b ja lm jd ln jg na jk nb jo nc js nd lx ly lz bi translated">加权平均值</li><li id="c849" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">卷</li><li id="7e4d" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">交易数量</li><li id="04e9" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js nd lx ly lz bi translated">接受者买入基础资产量</li></ol><p id="3e01" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将尝试执行的操作称为“时间序列预测”，因为我们将预测未来蜡烛的几个属性</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ng mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nh mg l"/></div></figure><p id="c39e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看最后一千个条目是什么样子的</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ni mg l"/></div></figure><p id="8cde" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们需要测试数据的平稳性。</p><p id="4a04" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">平稳过程是概率分布不依赖于时间的过程。</p><p id="189a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">而静止的东西更适合被预测！</p><p id="fda5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">白噪声是平稳过程最简单的例子。</p><p id="6011" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">提醒:白噪声过程是一个均值为零且不同时间的值之间没有相关性的过程。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ng mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><p id="f4bc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如我们所看到的，我们的时间序列是非平稳的。为了成功地预测它，我们需要把它变成一个静止的东西。</p><p id="66ad" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">怎么做？有几种选择:</p><ul class=""><li id="3e7f" class="lr ls hi iz b ja jb jd je jg lt jk lu jo lv js lw lx ly lz bi translated">差异。例如，您需要计算连续观察值之间的差异。</li><li id="6701" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">滚动平均值减法。滚动平均值是系列中前x次观察的平均值，其中每次观察之间的时间是一致的。</li><li id="ddc5" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">去趋势化是根本。这包括对时间以外的协变量进行回归。</li><li id="2ae2" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">季节性调整是采用差异的一种形式，但也可以理解为一种独立的技术。</li><li id="284d" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">数据的转换隐式地将差分运算符转换成其他东西；例如，对数的差实际上是比率。</li></ul><p id="b877" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有大量的技术可以使非平稳时间序列平稳。</p><p id="4796" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们决定从差异开始:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nk mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nl mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><p id="3287" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你看到了吗？现在我们有了作为平稳序列的所有时间序列！</p><p id="3397" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">与上面相同的事情(我的意思是差异)可以通过使用名称中带有“I”的模型来实现，这通常意味着集成。</p><p id="9f30" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，ARIMA就是这样一个模型，我们将在下一章中尝试使用它。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="ee83" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">尝试ARIMA</h1><p id="b61b" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">首先，我们必须说明我们用来衡量模型性能的规则。</p><p id="0540" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有许多不同的评估方法，它们适用于不同类型的模型:</p><ul class=""><li id="07ff" class="lr ls hi iz b ja jb jd je jg lt jk lu jo lv js lw lx ly lz bi translated">均方误差(mean square error)</li><li id="3144" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">AIC，用于惩罚模型过于复杂的特殊标准</li><li id="bbd6" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">sMAPE，这给了我们一个百分比误差</li><li id="1ca3" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi">…</li></ul><p id="4333" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的数据集由币安4个月的蜡烛组成。</p><p id="754d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将在数据集的最后一个月测试模型的性能，并在另外3个月进行训练。</p><p id="7ced" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我们将评估基于sMAPE的模型，以百分比的形式获得对我们的误差的评估:误差越低，我们的模型越好。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mi mg l"/></div></figure><p id="5044" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们将数据集分为评估模型性能所需的测试和训练部分:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nm mg l"/></div></figure><h1 id="03de" class="ku kv hi bd kw kx nn kz la lb no ld le io np ip lg ir nq is li iu nr iv lk ll bi translated">训练一个模型</h1><p id="1897" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">现在我们准备好为我们的时间序列建模了。</p><p id="0f8a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们将尝试AutoARIMA:它选择最合适的ARIMA模型，自动寻找最佳超参数。</p><p id="7728" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">默认情况下，它会比较基于AIC的模型，这很好:AIC同时考虑到了模型的复杂性和准确性。</p><p id="ed9b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">ARIMA季节性ARIMA(p，D，q)(P，D，Q，m)中的参数为:</p><ul class=""><li id="d449" class="lr ls hi iz b ja jb jd je jg lt jk lu jo lv js lw lx ly lz bi translated">p:非季节性AR部分的估计系数数</li><li id="80e4" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">d:向非季节性差异过渡的次数</li><li id="7baa" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">问:非季节性MA部分中估计系数的数量</li><li id="c7aa" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">p:季节性AR中估计系数的数量</li><li id="eac2" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">d:向季节差异转变的次数</li><li id="391f" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">问:季节性MA部分中估计系数的数量</li><li id="373a" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">m:季节性周期</li></ul><p id="603d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是使用sMAPE获得模型损失的一些代码:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ns mg l"/></div></figure><p id="4030" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出我们使用的每个时间序列的损失的效用函数:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nf mg l"/></div></figure><p id="c2e2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是分别为每个时间序列训练ARIMA模型的代码:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nt mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><p id="b288" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，对ARIMA来说，最容易的任务是预测交易数量，而最复杂的部分是价格。</p><p id="ef7a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这符合我们的常识:如果预测价格很容易，那么我们都会成为亿万富翁。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="9cef" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">使用GridSearch进行培训</h1><p id="1679" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">为了找到我们模型的最佳参数，我们将开始网格搜索。</p><p id="e9d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是找出哪种模型参数组合产生最佳性能的事情。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nu mg l"/></div></figure><h2 id="48c8" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">网格搜索结果</h2><p id="b97f" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们可以看到每个时间序列的最佳参数，以及sMAPE中的相应损失:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nv mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="3b38" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">尝试ETS</h1><p id="efbf" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们想尝试的另一个模型是ETS，它代表一个趋势分量(T)、一个季节分量(S)和一个误差项(E)。</p><p id="462d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于sktime中有一个AutoARIMA，那么AutoETS也呈现在这里。</p><p id="34e1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们的手很清楚:AutoETS将自己为我们提供最好的模型，默认选择AIC。</p><h2 id="d6fb" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">训练一个模型</h2><p id="d03c" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">由于我们已经从ARIMA之前的GridSearch结果中知道了最优sp，并且我们有相同的数据集，因此我们将重用它:</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nw mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ns mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><h2 id="c5cf" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">使用GridSearch进行培训</h2><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nx mg l"/></div></figure><h2 id="a85a" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">网格搜索结果</h2><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><p id="dc93" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从结果可以看出，ETS的sMAPE小于ARIMA。所以ETS在这个数据集上比ARIMA给出了更多的准确性。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="34ad" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">尝试先知</h1><p id="70c1" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">先知是脸书开发的一个模型。事实上，它是一个由以下部分组成的加性回归模型:</p><p id="b9dc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">季节性<code class="du jt ju jv jw b">s(t)</code>组件负责模拟与每周和每年季节性相关的周期性变化。​</p><p id="9938" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">组件<code class="du jt ju jv jw b">h(t)</code>负责用户指定的异常日，包括不规则日，例如黑色星期五。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ny mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><p id="a23e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，Prophet比ETS或ARIMA提供了更好的准确性。</p><p id="c0eb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">马克·扎克伯格，恭喜你，你花对了钱。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="07a5" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">尝试一些梯度推进</h1><h2 id="90ef" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">训练一个模型</h2><p id="7e99" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们试着用一下XGBoost，最著名的boosting东西之一。</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nh mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nj mg l"/></div></figure><h2 id="e642" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">使用GridSearch进行培训</h2><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nm mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="nz mg l"/></div></figure><h2 id="c5c2" class="mm kv hi bd kw mn mo mp la mq mr ms le jg mt mu lg jk mv mw li jo mx my lk mz bi translated">网格搜索结果</h2><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="oa mg l"/></div></figure><p id="438d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到一个有趣的细节。根据GridSearch的结果，窗口长度等于8给出了最有性能的预测价格。</p><p id="d64d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于其他特征(交易量、交易数量等)，需要长窗口。</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="a0e9" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">将不同的模型堆叠在一起</h1><p id="c5f4" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">栈是一种东西，它获取其他模型的输出，并使用另一个模型以某种方式对它们进行总结。</p><p id="76a5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们现在知道了每种时间序列的每个模型的最佳参数，所以我们可以重用它们！</p><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="mf mg l"/></div></figure><figure class="jy jz ka kb fd kc"><div class="bz dy l di"><div class="ob mg l"/></div></figure><p id="9dc2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到，在某些情况下，回归变量整体的表现比单个回归变量要好，而在某些情况下，则不然。</p><p id="86e7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个事实可以用一个迷因来说明。类人猿在一起很强壮，但他们仍然是类人猿。</p><figure class="jy jz ka kb fd kc er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es oc"><img src="../Images/c3de63d3f859032b440359ef80eba07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*CzLhJfsRDaIvrCVCZ547jg.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx">Some meme from google</figcaption></figure></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><h1 id="4649" class="ku kv hi bd kw kx ky kz la lb lc ld le io lf ip lg ir lh is li iu lj iv lk ll bi translated">结论</h1><p id="3358" class="pw-post-body-paragraph ix iy hi iz b ja lm ij jc jd ln im jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">感谢你阅读这篇文章，那是一次漫长的旅行。</p><p id="dcfa" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在简介里看我的其他故事:)</p><p id="5fc7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这篇文章要归功于我的合著者:</p><ul class=""><li id="cf78" class="lr ls hi iz b ja jb jd je jg lt jk lu jo lv js lw lx ly lz bi translated">瓦西里·基连科</li><li id="6143" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">安德烈·埃尔马科夫</li><li id="0e9a" class="lr ls hi iz b ja ma jd mb jg mc jk md jo me js lw lx ly lz bi translated">格里戈里·布奇洛夫</li></ul></div></div>    
</body>
</html>
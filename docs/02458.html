<html>
<head>
<title>How to Create Chatbot with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js创建聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/create-chatbot-with-nodejs-cf3d8bc3f302?source=collection_archive---------1-----------------------#2021-05-16">https://medium.com/geekculture/create-chatbot-with-nodejs-cf3d8bc3f302?source=collection_archive---------1-----------------------#2021-05-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/683ee234cda5aafda94610f2ab7566bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHLIgEGHmXXhiUELYbcZtg.png"/></div></div></figure><p id="5c31" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本教程我们需要的是:</p><ul class=""><li id="20a8" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">NPM和节点已安装</li><li id="81a5" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated">节点nlp模块</li></ul><h2 id="54be" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">设置我们的项目</h2><p id="ec9d" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">首先创建一个你想要创建项目的文件夹，我创建了名为<code class="du lc ld le lf b">chatbot_nodejs</code>的文件夹。</p><p id="632f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用命令<code class="du lc ld le lf b">npm init</code>初始化文件夹中的repo，用<code class="du lc ld le lf b">npm i node-nlp</code>安装模块。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/83d607fa767bb771d7185bc1d888b539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlGMe_mlqNBJecJ5K7T-4Q.png"/></div></div></figure><p id="9c85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在该文件夹中创建一个名为<code class="du lc ld le lf b">index.js</code>的文件。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/56ebf444ef7f1b748d5fce5abf8429a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*4YzF1RFnQqOJv0EklJpG_Q.png"/></div></figure><p id="f7c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们的项目已经设置好了。</p><h2 id="f625" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">创作意图</h2><p id="4856" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">在我们的项目文件夹中创建一个名为<code class="du lc ld le lf b">intents</code>的文件夹。我们将在json中创建我们的意图，所以我创建了两个名为<code class="du lc ld le lf b">greetings.bye.json</code>和<code class="du lc ld le lf b">greetings.hello.json</code>的JSON文件。在里面，我把我们的问题和答案组织成这样。</p><pre class="lh li lj lk fd lm lf ln lo aw lp bi"><span id="b0be" class="kc kd hi lf b fi lq lr l ls lt">{<br/>    "questions": [<br/>        "goodbye",<br/>        "bye take care",<br/>        "see you later",<br/>        "bye for now",<br/>        "i must go"<br/>    ],<br/>    "answers": [<br/>        "see you soon!",<br/>        "Till next time",<br/>        "bye bye",<br/>        "have a great day"<br/>    ]<br/>}</span><span id="683a" class="kc kd hi lf b fi lu lr l ls lt">{<br/>    "questions": [<br/>        "hello",<br/>        "hi",<br/>        "howdy",<br/>        "Greetings"<br/>    ],<br/>    "answers": [<br/>        "Hey there!",<br/>        "Hello",<br/>        "Hi",<br/>        "Greetings"<br/>    ]<br/>}</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/6e9a307d7ab5f0e0a6e6adb99b101936.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*2e1lZPCEIOiXFIF6q5IhIA.png"/></div></figure><p id="3955" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以通过创建新的json文件并像这样构建您的意图来添加更多内容。</p><h2 id="00d1" class="kc kd hi bd ke kf kg kh ki kj kk kl km jb kn ko kp jf kq kr ks jj kt ku kv kw bi translated">训练和保存聊天机器人</h2><p id="c638" class="pw-post-body-paragraph iq ir hi is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">在我们的项目文件夹中创建一个名为<code class="du lc ld le lf b">train.js</code>的文件。让我们编写一些代码来训练模型。</p><pre class="lh li lj lk fd lm lf ln lo aw lp bi"><span id="8b3f" class="kc kd hi lf b fi lq lr l ls lt">// Let's start with importing `NlpManager` from `node-nlp`. This will be responsible for training, saving, loading and processing.<br/>const { NlpManager } = require("node-nlp");<br/>// Creating new Instance of NlpManager class.<br/>const manager = new NlpManager({ languages: ["en"] });</span><span id="f304" class="kc kd hi lf b fi lu lr l ls lt">// Let's import fs module to read our json files.<br/>const fs = require("fs");</span><span id="295a" class="kc kd hi lf b fi lu lr l ls lt">// Let's read all our intents files in the folder intents<br/>const files = fs.readdirSync("./intents");</span><span id="96a3" class="kc kd hi lf b fi lu lr l ls lt">// Looping through the files and Parsing the string to object and passing it to manager instance to train and process it.<br/>for (const file of files) {<br/>    let data = fs.readFileSync(`./intents/${file}`);<br/>    data = JSON.parse(data);</span><span id="e515" class="kc kd hi lf b fi lu lr l ls lt">    const intent = file.replace(".json", "");</span><span id="6482" class="kc kd hi lf b fi lu lr l ls lt">    for (const question of data.questions) {<br/>        manager.addDocument("en", question, intent);<br/>    }</span><span id="b961" class="kc kd hi lf b fi lu lr l ls lt">    for (const answer of data.answers) {<br/>        manager.addAnswer("en", intent, answer);<br/>    }<br/>}</span><span id="e34f" class="kc kd hi lf b fi lu lr l ls lt">// let's create a function that will be responsible for Training and saving the manager instance.<br/>async function train_save(){<br/>    await manager.train();<br/>    manager.save();<br/>}</span><span id="d03b" class="kc kd hi lf b fi lu lr l ls lt">// Calling the above function<br/>train_save();</span></pre><p id="2fa5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的<code class="du lc ld le lf b">train.js</code>文件现在完成了。现在让我们创建我们的<code class="du lc ld le lf b">index.js</code>文件。</p><pre class="lh li lj lk fd lm lf ln lo aw lp bi"><span id="09b3" class="kc kd hi lf b fi lq lr l ls lt">// Let's start with importing `NlpManager` from `node-nlp`. This will be responsible for training, saving, loading and processing.<br/>const { NlpManager } = require("node-nlp");<br/>console.log("Starting Chatbot ...");</span><span id="90f6" class="kc kd hi lf b fi lu lr l ls lt">// Creating new Instance of NlpManager class.<br/>const manager = new NlpManager({ languages: ["en"] });<br/>// Loading our saved model<br/>manager.load();</span><span id="0e4d" class="kc kd hi lf b fi lu lr l ls lt">// Loading a module readline, this will be able to take input from the terminal.<br/>var readline = require("readline");<br/>var rl = readline.createInterface(process.stdin, process.stdout);</span><span id="d2fc" class="kc kd hi lf b fi lu lr l ls lt">console.log("Chatbot started!");<br/>rl.setPrompt("&gt; ");<br/>rl.prompt();</span><span id="2aac" class="kc kd hi lf b fi lu lr l ls lt">rl.on("line", async function (line) {<br/>    // Here Passing our input text to the manager to get response and display response answer.<br/>    const response = await manager.process("en", line);<br/>    console.log(response.answer);<br/>    rl.prompt();<br/>}).on("close", function () {<br/>    process.exit(0);<br/>});</span></pre><p id="7915" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们的文件完整了。我们现在需要做的就是创建两个脚本train和start。打开<code class="du lc ld le lf b">package.json</code>，添加两个脚本。</p><pre class="lh li lj lk fd lm lf ln lo aw lp bi"><span id="5938" class="kc kd hi lf b fi lq lr l ls lt">"scripts": {<br/>    "train": "node train.js",<br/>    "start": "node index.js"<br/>  },</span></pre><ul class=""><li id="6e96" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><code class="du lc ld le lf b">train</code>脚本将运行<code class="du lc ld le lf b">train.js</code>文件。</li><li id="a6e0" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><code class="du lc ld le lf b">start</code>脚本将运行<code class="du lc ld le lf b">index.js</code>文件。</li></ul><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/4b6d58aedcbd1bee0e997921331b3212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MEu8MaaJB9rVMGzDBKTUkA.png"/></div></div></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/0d1dd2634c8a82625a60aa33a50351ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j76fCiCEDM1czGM34WUm1Q.png"/></div></div></figure><p id="e56b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们的项目完成了。您可以从我的Github下载这个源代码。</p><p id="2b35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae ly" href="https://github.com/Programmer101N/chatbot_nodejs" rel="noopener ugc nofollow" target="_blank">在Github上访问这个项目</a></p><p id="a28d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lz">更多内容请看</em><a class="ae ly" href="http://plainenglish.io" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="lz">plain English . io</em></strong></a></p></div></div>    
</body>
</html>
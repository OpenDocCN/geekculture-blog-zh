<html>
<head>
<title>Anticipating Data Cleaning Issues When Importing JSON Into Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测将JSON导入Pandas时的数据清理问题</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/anticipating-data-cleaning-issues-when-importing-json-into-pandas-600f6787a6fa?source=collection_archive---------25-----------------------#2021-05-01">https://medium.com/geekculture/anticipating-data-cleaning-issues-when-importing-json-into-pandas-600f6787a6fa?source=collection_archive---------25-----------------------#2021-05-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9b5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> JavaScript对象符号</strong> ( <strong class="ih hj"> JSON </strong>)已经成为将数据从一台机器、进程或节点传输到另一台机器、进程或节点的非常有用的标准。通常，客户端向服务器发送数据请求，服务器查询本地存储中的数据，然后将数据从SQL Server表转换成客户端可以使用的JSON。有时，第一个服务器(比如说web服务器)将请求转发给数据库服务器会使事情变得更加复杂。JSON通过以下方式促进了这一点:</p><ul class=""><li id="036e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">可供人类阅读</li><li id="fc77" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">可由大多数客户端设备使用</li><li id="ae71" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">在结构上不受限制</li></ul><p id="4500" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">JSON非常灵活，这意味着它可以适应任何东西。JSON文件中的结构甚至可以改变，因此不同的键可能出现在不同的位置。例如，文件可能以一些解释键开始，这些解释键与其余的<em class="jr">数据</em>键具有非常不同的结构。或者某些键在某些情况下可能存在，但在其他情况下不存在。我们回顾了一些处理这种混乱的方法(嗯，我指的是灵活性)。</p><h1 id="1019" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">在我们开始之前…</h1><p id="ac53" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">这篇文章摘自《Python数据清理》一书中的一章，这本书是我写的，由Packt出版。可以在这里购买:<a class="ae kv" href="https://www.amazon.com/Python-Data-Cleaning-Cookbook-techniques-ebook/dp/B08MB9D3HZ/ref=sr_1_3?dchild=1&amp;keywords=python+data+cleaning+cookbook&amp;qid=1619866892&amp;s=digital-text&amp;sr=1-3" rel="noopener ugc nofollow" target="_blank">https://www . Amazon . com/Python-Data-Cleaning-Cookbook-techniques-ebook/DP/b 08 MB 9d 3hz/ref = Sr _ 1 _ 3？dchild=1 &amp;关键字= python+data+cleaning+cookbook&amp;qid = 1619866892&amp;s = digital-text&amp;Sr = 1-3</a>。</p><p id="103e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码可以从GitHub的<a class="ae kv" href="https://github.com/PacktPublishing/Python-Data-Cleaning-Cookbook" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/packt publishing/Python-Data-Cleaning-Cookbook</a>下载。</p><p id="6a4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本帖中，我们将使用关于政治候选人的新闻报道数据。这些数据在<a class="ae kv" href="http://dataverse.harvard.edu/dataset.xhtml?persistentId=doi" rel="noopener ugc nofollow" target="_blank">dataverse.harvard.edu/dataset.xhtml?persistentId=doi</a>:10.7910/DVN/0兹洛克可供公众使用。我将那里的JSON文件合并成一个文件，并从合并的数据中随机选择了60，000个新闻故事。这个示例(<code class="du kw kx ky kz b">allcandidatenewssample.json</code>)可以在本书的GitHub资源库中找到。</p><h1 id="814a" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">怎么做…</h1><p id="b754" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在做了一些数据检查和清理之后，我们将把一个JSON文件导入pandas:</p><ol class=""><li id="2f45" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc la jj jk jl bi translated">导入<code class="du kw kx ky kz b">json,</code> <code class="du kw kx ky kz b">pprint,</code>和<code class="du kw kx ky kz b">Counter</code>。</li></ol><p id="792b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">改进了加载JSON数据时返回的列表和字典的显示。在这篇文章的后面，我们会看到当我们需要对加载的数据做一些初步的统计时,<code class="du kw kx ky kz b">collections</code>模块非常有用。</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="df40" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; import pandas as pd</span><span id="3f78" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; import numpy as np </span><span id="1a7f" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; import json </span><span id="f9ca" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; import pprint </span><span id="388c" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; from collections import Counter<!-- --> </span></pre><p id="bc6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.加载JSON数据并寻找潜在的问题。</p><p id="045a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du kw kx ky kz b">json load</code>方法返回关于政治候选人的新闻报道的数据。<code class="du kw kx ky kz b">load</code>返回词典列表。使用<code class="du kw kx ky kz b">len</code>获得列表的大小，这是本例中新闻故事的总数。(每个列表项都是一个字典，包含标题、源等的关键字以及它们各自的值。)使用<code class="du kw kx ky kz b">pprint</code>显示前两个字典。从源键获取第一个列表项的值:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="e15d" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; with open('data/allcandidatenewssample.json') as f:<br/> ...   candidatenews = json.load(f)<br/> ... <br/> <br/>&gt;&gt;&gt; len(candidatenews) <br/>60000 </span><span id="41c6" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(candidatenews[0:2]) <br/>[{'date': '2019-12-25 10:00:00',<br/>  'domain': 'www.nbcnews.com',<br/>  'panel_position': 1,  <br/>  'query': 'Michael Bloomberg', <br/>  'source': 'NBC News',  <br/>  'story_position': 6,  <br/>  'time': '18 hours ago', <br/>  'title': 'Bloomberg cuts ties with company using prison inmates to         make campaign calls',  <br/>  'url': 'https://www.nbcnews.com/politics/2020-election/bloomberg-cuts-ties-company-using-prison-inmates-make-campaign-calls-n1106971'}, <br/> {'date': '2019-11-09 08:00:00',  <br/>  'domain': 'www.townandcountrymag.com',  <br/>  'panel_position': 1,  <br/>  'query': 'Amy Klobuchar',  <br/>  'source': 'Town &amp; Country Magazine', <br/>  'story_position': 3,  <br/>  'time': '18 hours ago',  <br/>  'title': "Democratic Candidates React to Michael Bloomberg's Potential Run",  <br/>  'url': https://www.townandcountrymag.com/society/politics/a29739854/michael-bloomberg-democratic-candidates-campaign-reactions/'}] &gt;&gt;&gt; pprint.pprint(candidatenews[0]['source']) 'NBC News'</span></pre><p id="7a22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.检查字典结构的差异。</p><p id="a420" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用<code class="du kw kx ky kz b">Counter</code>检查列表中任何少于或多于九个正常键的词典。在删除它们之前，查看几个几乎没有数据的字典(只有两个关键字的字典)。确认剩余的词典列表具有预期的长度-<em class="jr">60000-2382 = 57618</em>:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="5adb" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; Counter([len(item) for item in candidatenews])<br/>Counter({9: 57202, 2: 2382, 10: 416})</span><span id="fa70" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(next(item for item in candidatenews if len(item)&lt;9))<br/>{'date': '2019-09-11 18:00:00', 'reason': 'Not collected'}</span><span id="b886" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(next(item for item in candidatenews if len(item)&gt;9))<br/>{'category': 'Satire',<br/> 'date': '2019-08-21 04:00:00',<br/> 'domain': 'politics.theonion.com',<br/> 'panel_position': 1,<br/> 'query': 'John Hickenlooper',<br/> 'source': 'Politics | The Onion',<br/> 'story_position': 8,<br/> 'time': '4 days ago',<br/> 'title': ''And Then There Were 23,' Says Wayne Messam Crossing Out '<br/>          'Hickenlooper Photo \n'<br/>          'In Elaborate Grid Of Rivals',<br/> 'url': '<a class="ae kv" href="https://politics.theonion.com/and-then-there-were-23-says-wayne-messam-crossing-ou-1837311060'" rel="noopener ugc nofollow" target="_blank">https://politics.theonion.com/and-then-there-were-23-says-wayne-messam-crossing-ou-1837311060'</a>}<br/>&gt;&gt;&gt; pprint.pprint([item for item in candidatenews if len(item)==2][0:10])<br/>[{'date': '2019-09-11 18:00:00', 'reason': 'Not collected'},<br/> {'date': '2019-07-24 00:00:00', 'reason': 'No Top stories'},<br/>... <br/> {'date': '2019-01-03 00:00:00', 'reason': 'No Top stories'}]</span><span id="8a7d" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; candidatenews = [item for item in candidatenews if len(item)&gt;2]</span><span id="3e52" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; len(candidatenews)<br/>57618</span></pre><p id="e1e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.从JSON数据生成计数。</p><p id="b166" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为政治(一个报道政治新闻的网站)买几本字典，展示几本字典:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="aa9b" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; politico = [item for item in candidatenews if item["source"] == "Politico"]</span><span id="b70d" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; len(politico)<br/>2732</span><span id="af7b" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(politico[0:2])<br/>[{'date': '2019-05-18 18:00:00',<br/>  'domain': '<a class="ae kv" href="http://www.politico.com'" rel="noopener ugc nofollow" target="_blank">www.politico.com'</a>,<br/>  'panel_position': 1,<br/>  'query': 'Marianne Williamson',<br/>  'source': 'Politico',<br/>  'story_position': 7,<br/>  'time': '1 week ago',<br/>  'title': 'Marianne Williamson reaches donor threshold for Dem debates',<br/>  'url': '<a class="ae kv" href="https://www.politico.com/story/2019/05/09/marianne-williamson-2020-election-1315133'" rel="noopener ugc nofollow" target="_blank">https://www.politico.com/story/2019/05/09/marianne-williamson-2020-election-1315133'</a>},<br/> {'date': '2018-12-27 06:00:00',<br/>  'domain': '<a class="ae kv" href="http://www.politico.com'" rel="noopener ugc nofollow" target="_blank">www.politico.com'</a>,<br/>  'panel_position': 1,<br/>  'query': 'Julian Castro',<br/>  'source': 'Politico',<br/>  'story_position': 1,<br/>  'time': '1 hour ago',<br/>  'title': "O'Rourke and Castro on collision course in Texas",<br/>  'url': '<a class="ae kv" href="https://www.politico.com/story/2018/12/27/orourke-julian-castro-collision-texas-election-1073720'" rel="noopener ugc nofollow" target="_blank">https://www.politico.com/story/2018/12/27/orourke-julian-castro-collision-texas-election-1073720'</a>}]</span></pre><p id="b54f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.获取<code class="du kw kx ky kz b">source</code>数据并确认其具有预期长度。</p><p id="b14b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显示新<code class="du kw kx ky kz b">sources</code>列表中的前几个项目。按来源生成新闻故事的计数，并显示10个最受欢迎的来源。请注意，来自<em class="jr"> The Hill </em>的故事可以将<code class="du kw kx ky kz b">TheHill</code>(不带空格)或<code class="du kw kx ky kz b">The Hill</code>作为<code class="du kw kx ky kz b">source</code>的值:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="798c" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; sources = [item.get('source') for item in candidatenews]</span><span id="bb1c" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; type(sources)<br/>&lt;class 'list'&gt;</span><span id="2bc3" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; len(sources)<br/>57618</span><span id="a0d5" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; sources[0:5]<br/>['NBC News', 'Town &amp; Country Magazine', 'TheHill', 'CNBC.com', 'Fox News']</span><span id="786e" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(Counter(sources).most_common(10))<br/>[('Fox News', 3530),<br/> ('CNN.com', 2750),<br/> ('Politico', 2732),<br/> ('TheHill', 2383),<br/> ('The New York Times', 1804),<br/> ('Washington Post', 1770),<br/> ('Washington Examiner', 1655),<br/> ('The Hill', 1342),<br/> ('New York Post', 1275),<br/> ('Vox', 941)]</span></pre><p id="6f56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.修复字典中值的任何错误。</p><p id="a223" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">固定<code class="du kw kx ky kz b">The Hill</code>的<code class="du kw kx ky kz b">source</code>值。请注意<code class="du kw kx ky kz b">The Hill</code>现在是新闻故事最常见的来源:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="b7b5" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; for newsdict in candidatenews:<br/>...     newsdict.update((k, "The Hill") for k, v in newsdict.items()<br/>...      if k == "source" and v == "TheHill")<br/>... </span><span id="6a64" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; sources = [item.get('source') for item in candidatenews]</span><span id="e764" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; pprint.pprint(Counter(sources).most_common(10))<br/>[('The Hill', 3725),<br/> ('Fox News', 3530),<br/> ('CNN.com', 2750),<br/> ('Politico', 2732),<br/> ('The New York Times', 1804),<br/> ('Washington Post', 1770),<br/> ('Washington Examiner', 1655),<br/> ('New York Post', 1275),<br/> ('Vox', 941),<br/> ('Breitbart', 799)]</span></pre><p id="53af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">7.创建一个熊猫数据框架。</p><p id="17dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将JSON数据传递给pandas <code class="du kw kx ky kz b">DataFrame</code>方法。将<code class="du kw kx ky kz b">date</code>列转换为<code class="du kw kx ky kz b">datetime</code>数据类型:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="1112" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; candidatenewsdf = pd.DataFrame(candidatenews)</span><span id="c60a" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; candidatenewsdf.dtypes<br/>title             object<br/>url               object<br/>source            object<br/>time              object<br/>date              object<br/>query             object<br/>story_position     int64<br/>panel_position    object<br/>domain            object<br/>category          object<br/>dtype: object</span></pre><p id="edad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">8.确认我们正在获取<code class="du kw kx ky kz b">source</code>的预期值。</p><p id="2606" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，重命名<code class="du kw kx ky kz b">date</code>列:</p><pre class="lb lc ld le fd lf kz lg lh aw li bi"><span id="2b2d" class="lj jt hi kz b fi lk ll l lm ln">&gt;&gt;&gt; candidatenewsdf.rename(columns={'date':'storydate'}, inplace=True)</span><span id="b482" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; candidatenewsdf.storydate = candidatenewsdf.storydate.astype('datetime64[ns]')</span><span id="ed69" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; candidatenewsdf.shape<br/>(57618, 10)</span><span id="b7d4" class="lj jt hi kz b fi lo ll l lm ln">&gt;&gt;&gt; candidatenewsdf.source.value_counts(sort=True).head(10)<br/>The Hill               3725<br/>Fox News               3530<br/>CNN.com                2750<br/>Politico               2732<br/>The New York Times     1804<br/>Washington Post        1770<br/>Washington Examiner    1655<br/>New York Post          1275<br/>Vox                     941<br/>Breitbart               799<br/>Name: source, dtype: int64</span></pre><p id="8138" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在有一个熊猫数据框架，其中只有新闻故事，有有意义的数据，并且<code class="du kw kx ky kz b">source</code>的值是固定的。</p><h1 id="63a4" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">它是如何工作的…</h1><p id="d541" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">方法返回一个字典列表。这使得在处理这些数据时可以使用许多熟悉的工具:列表方法、切片、列表理解、字典更新等等。有时候，也许你只需要填充一个列表或者计算一个给定类别中的个体数量，就没有必要使用熊猫了。</p><p id="fd4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<em class="jr">步骤2 </em>到<em class="jr"> 6 </em>中，我们使用列表方法做许多我们通常对熊猫做的相同检查。在<em class="jr">步骤3 </em>中，我们使用<code class="du kw kx ky kz b">Counter</code>和列表理解(<code class="du kw kx ky kz b">Counter([len(item) for item in candidatenews])</code>)来获得每个字典中的键的数量。这告诉我们有2382本字典只有2个键，416本有10个键。我们使用<code class="du kw kx ky kz b">next</code>来寻找少于9个键或多于9个键的字典的例子，以了解这些条目的结构。我们使用切片来显示10个带有2个键的字典，以查看这些字典中是否有数据。然后我们只选择那些超过2个关键字的字典。</p><p id="3c90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在<em class="jr">步骤4 </em>中，我们创建了字典列表的一个子集，其中<code class="du kw kx ky kz b">source</code>等于<code class="du kw kx ky kz b">Politico</code>，并查看几个条目。然后，我们创建一个只包含源数据的列表，并在<em class="jr">步骤5 </em>中使用<code class="du kw kx ky kz b">Counter</code>列出10个最常见的源。</p><p id="51de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jr">步骤6 </em>演示了如何在字典列表中有条件地替换键值。在这种情况下，每当<code class="du kw kx ky kz b">key (k)</code>为<code class="du kw kx ky kz b">source</code>并且<code class="du kw kx ky kz b">value (v)</code>为<code class="du kw kx ky kz b">TheHill</code>时，我们就将键值更新为<code class="du kw kx ky kz b">The Hill</code>。<code class="du kw kx ky kz b">for k, v in newsdict.items()</code>段是这条线的无名英雄。它遍历<code class="du kw kx ky kz b">candidatenews</code>中所有字典的所有键/值对。</p><p id="8cf7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过将字典列表传递给pandas <code class="du kw kx ky kz b">DataFrame</code>方法，很容易创建pandas数据框架。我们在<em class="jr">步骤7 </em>中这样做。主要的复杂之处在于，我们需要将日期列从字符串转换成日期，因为日期在JSON中只是字符串。</p><h1 id="66e7" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">还有更多…</h1><p id="3033" class="pw-post-body-paragraph if ig hi ih b ii kq ik il im kr io ip iq ks is it iu kt iw ix iy ku ja jb jc hb bi translated">在<em class="jr">步骤5 </em>和<em class="jr">步骤6 </em>中，我们使用<code class="du kw kx ky kz b">item.get('source')</code>代替<code class="du kw kx ky kz b">item['source']</code>。当字典中可能缺少键时，这很方便。当键丢失时，<code class="du kw kx ky kz b">get</code>返回<code class="du kw kx ky kz b">None</code>，但是我们可以使用可选的第二个参数来指定要返回的值。</p><p id="5ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在<em class="jr">步骤8 </em>中将<code class="du kw kx ky kz b">date</code>列重命名为<code class="du kw kx ky kz b">storydate</code>。这不是必需的，但却是一个好主意。<code class="du kw kx ky kz b">date</code>不仅没有告诉您日期实际代表什么，它还是一个如此通用的列名，以至于在某些时候一定会引起问题。</p><p id="748f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">新闻故事数据非常适合表格结构。将每个列表项表示为一行，将键/值对表示为该行的列和列值是有意义的。没有明显的复杂性，比如键值本身就是字典列表。想象一下，每个故事有一个<code class="du kw kx ky kz b">authors</code>键，每个作者有一个列表项作为键值，这个列表项是关于作者的信息的字典。在Python中处理JSON数据时，这一点也不奇怪。我的书《Python数据清理指南》也研究了JSON结构更复杂的情况。</p></div></div>    
</body>
</html>
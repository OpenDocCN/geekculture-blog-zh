# 我需要多少个 AWS 账户？

> 原文：<https://medium.com/geekculture/how-many-aws-accounts-do-i-need-d54261a0ab04?source=collection_archive---------4----------------------->

具有多帐户设置的 AWS 基础设施被认为是最佳实践。但是，如果您是新手，刚刚开始您的 AWS 云之旅，您会遇到的第一个问题是，我应该拥有多少个 AWS 客户？使用 AWS 组织，您可以集中添加、创建和管理 AWS 帐户。此外，AWS 组织的理念是构建最适合您组织需求的客户，或多或少与您组织管理不同团队的方式保持一致，这些团队参与设计、实施和使用 AWS 服务来支持您的业务。

![](img/004fbce251c52edacc642d21e4574942.png)

[Cards photo created by rawpixel.com — www.freepik.com](https://www.freepik.com/photos/cards)

## 当您决定使用 AWS 时，很少有问题变得非常常见

1.  我应该如何用组织单位构建 AWS 组织层次结构？
2.  我需要多少个 AWS 账户？
3.  如何将这些 AWS 客户放入正确的 AWS 组织单位？
4.  您应该如何利用 AWS 组织的治理和法规遵从性功能？

我见过一些公司在引入 AWS 组织之前就开始了他们的 AWS 之旅，也见过一些公司开始利用 AWS 组织集中管理 AWS 帐户的几个重要方面。

为了回答这些问题，以下是您在决定 AWS 组织结构时应该考虑的几个方面，以及您应该选择的 AWS 客户数量。

## 业务和团队的未来发展

随着业务和团队的增长，通常会有单独的小组/团队负责基础设施的特定领域，其中一些与 AWS 架构良好的框架的支柱直接相关，而一些则与这些支柱重叠。由于其中一些功能需要专业知识，您最有可能拥有以下部分或全部团队。公司越大，职能越分散，公司越小，小团队中的职能越多。

*   平台/基础设施团队
*   网络团队
*   安全团队
*   应用/服务团队
*   数据仓库团队

## 领域驱动设计

即使你是一个小团队，有一个团队负责所有领域(早期启动)，随着你的成长，你会有更多的团队负责特定的应用/业务领域。考虑到未来，您可能希望每个应用程序/业务域都有单独的帐户。这种客户分离允许将这些应用程序/业务领域相关的团队转移到公司内不同的组织/领导层级下。内聚的微服务是一个业务领域的组件，应该保持在一起。

*   您的系统架构将在决定域的数量以及如何*内聚*域和相关组件方面发挥作用，这些组件应该部署在同一个帐户中。

## 环境

每个服务/应用程序都有不止一个环境。成熟的团队使用围绕蓝/绿部署、自动化单元、Smoke、回归测试、功能标志和可观察性的最佳实践来减少检测和修复任何问题的平均时间，可以减少环境的数量。但是，通常您会有开发、阶段和生产环境。

*   多少环境？
*   每个环境的用途
*   您是否应该将一些环境组合到一个帐户中？例如，Beta 测试、性能测试、将 env 转入“生产前”帐户？

## 灾难恢复

根据您的业务需要灾难恢复就绪程度的业务要求，通过为应用程序/服务定义明确的恢复点目标和恢复时间目标，您需要复制部分(或全部)基础架构和部署，并备份您的数据，以便您可以利用基础架构作为具有部署管道的代码，在不同区域建立基础架构，从而满足您的 RPO 和 RTO。

*   每个主站点/区域的灾难恢复。
*   使用相同的帐户(作为主要帐户)但在该帐户中使用不同的区域？
*   根据您需要的主区域和辅助区域(以及帐户)之间的隔离级别，将帐户分开可能是一个好主意，这样，如果您的主帐户受到威胁并且您无法访问它，您可以从单独的帐户(和区域)使用灾难恢复。

## 多区域

随着业务扩展到国际市场，不同的地理政治区域都有数据隐私要求，为了向来自世界各地的用户提供更好的用户体验，您应该将基础架构和应用扩展到全球多个区域。实施多区域本身就很棘手，成本也很高，但这里的要点是考虑 AWS 客户时要牢记未来。

*   您将使用哪些区域？考虑你的主要市场和国际市场。
*   决定您在同一地理位置的二级区域(用于灾难恢复)

## 沙盒/测试

为团队可以进行快速概念验证的沙盒保持独立的 AWS 帐户以及为基础设施测试保持独立的帐户是很重要的。

*   基础架构概念验证的沙盒
*   基础设施测试的测试账户
*   每个应用程序/服务都有单独的沙箱

如果我们把以上所有的放在一起，下面是我的两个建议，显示了初始(小)和更多扩展的未来版本，记住灾难恢复，多区域等。

## 在 CI/CD 渠道中使用正确的帐户

一旦您创建了客户和组织层次结构，就 PoC、开发、单元测试的 CI/CD 管道以及使用基础架构作为代码部署到每个环境而言，您将有默认的区域要部署，然后有其他区域(对于灾难恢复或多区域)要部署。根据您的基础设施和应用程序/服务的“可观察”程度，您应该能够将您的管道配置为(半)自动部署到所有需要的环境、客户和区域。

此外，考虑到灾难恢复，您在两个不同的区域设置了活动和非活动(备份、热备用、热备用)设置，您可能还希望每个应用程序都有一个主站点和辅助站点的映射，以便在灾难恢复场景中执行*故障转移*后，这些映射可以轻松地集中切换*并且团队可以继续在其部署管道中指定主站点和辅助站点，而不必知道主站点和辅助站点及其各自帐户的变化。*

这里的要点是将**{应用程序/服务}+{环境}+{区域}+{主要或辅助站点} → {AWS 帐户}** 映射外部化和集中化，以便在您的基础架构中作为代码，**{应用程序+环境+区域+主要/辅助}** 特定配置可以在幕后映射到 AWS 帐户，而无需每个团队知道他们的帐户 id 并将其硬编码到他们的配置文件中。

就组织层级的最佳实践而言，这是 AWS 的一篇很好的[博客，你应该参考一下。](https://aws.amazon.com/blogs/mt/best-practices-for-organizational-units-with-aws-organizations/)
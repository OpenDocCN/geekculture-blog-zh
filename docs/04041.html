<html>
<head>
<title>A quick introduction to Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker快速介绍</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/a-quick-introduction-to-docker-c18a382100fa?source=collection_archive---------28-----------------------#2021-06-20">https://medium.com/geekculture/a-quick-introduction-to-docker-c18a382100fa?source=collection_archive---------28-----------------------#2021-06-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8e3d263555e9d103935d1588903bb2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2MRZ0jlBP0gUxuQeU4IXzQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@carrier_lost?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Ian Taylor</a> on <a class="ae iu" href="https://unsplash.com/s/photos/docker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ad29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">事情是这样的。你创建了一段代码，可能是一个ROS节点或者一个ReactJS应用程序，然后你把这个包交给一个朋友。构建应用程序并开始使用它很简单。没那么快。出问题了，你之前用的Python版本变了，或者点云库更新了。好吧，接下来的几个小时将会试着把你的包裹和你朋友的系统匹配起来，反之亦然。如果有一种方法可以确保软件包在各种不同的计算机上运行相同，那会怎么样？一种可以传递的容器？有！它叫做Docker</p><p id="a022" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们开始吧！</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><p id="796b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设你用的是Ubuntu。首先从<a class="ae iu" href="https://docs.docker.com/engine/install/ubuntu/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>安装Docker</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="44b5" class="kj kk hi kf b fi kl km l kn ko">$ sudo apt-get remove docker docker-engine docker.io containerd runc<br/>$ sudo apt-get update <br/>$ sudo apt-get install apt-transport-https ca-certificates curl gnupg lsb_release<br/>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg<br/>$ echo \  "deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null<br/>$ sudo apt-get install docker-ce docker-ce-cli containerd.io<br/>$ sudo docker run hello-world</span></pre><p id="8cbc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在你都准备好了。一旦<a class="ae iu" href="https://kumarvikram.com/hello-world-docker-first-container/" rel="noopener ugc nofollow" target="_blank"> hello-world </a>容器运行，Docker就会安装到您的系统中。是的，就是这么简单。有几个命令对Docker很有用。查看这个<a class="ae iu" href="https://github.com/wsargent/docker-cheat-sheet#dockerfile" rel="noopener ugc nofollow" target="_blank">小抄</a>了解更多。</p><p id="4239" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们试着用ROS设置Docker。因此，有许多更简单的选择，如这个ROS <a class="ae iu" href="https://hub.docker.com/_/ros" rel="noopener ugc nofollow" target="_blank">图像</a>或这个SLAM工具箱<a class="ae iu" href="https://hub.docker.com/r/stevemacenski/slam-toolbox" rel="noopener ugc nofollow" target="_blank">图像</a>。是的，Docker非常灵活，你可以得到一个Ubuntu映像，或者一个基于Ubuntu映像的ROS映像，或者一个基于ROS和Ubuntu的ROS包映像。</p><p id="d0f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们尝试在我们的案例中构建我们自己的ROS包映像。运行以下命令来提取docker映像:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="c667" class="kj kk hi kf b fi kl km l kn ko">$ sudo docker pull ubuntu</span></pre><p id="2155" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后通过运行以下命令启动docker容器:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="3095" class="kj kk hi kf b fi kl km l kn ko">$ sudo docker run -it ubuntu bash</span></pre><p id="8c49" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">it命令允许将终端中编写的命令传输到Docker容器，并将Docker容器的输出写入终端。bash命令防止容器立即启动和终止。你可以试着使用这个Docker容器，但是你会发现大多数东西都没有设置好。让我们把他们安置好</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="370e" class="kj kk hi kf b fi kl km l kn ko">$ apt-get update <br/>$ apt-get install lsb-release -y <br/>$ apt-get install net-tools -y <br/>$ apt-get install iputils-ping -y <br/>$ apt-get install gnupg -y <br/>$ apt-get install curl -y<br/>$ apt install python-catkin-tools -y</span></pre><p id="2712" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意，不再需要sudo了，因为在Docker容器中，您是在“root”下运行的。现在所有的依赖项都已经安装完毕，我们可以安装ROS和ROS包了。现在让我们使用SLAM工具箱。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="97d5" class="kj kk hi kf b fi kl km l kn ko">$ sh -c ‘echo “deb <a class="ae iu" href="http://packages.ros.org/ros/ubuntu" rel="noopener ugc nofollow" target="_blank">http://packages.ros.org/ros/ubuntu</a> $(lsb_release -sc) main” &gt; /etc/apt/sources.list.d/ros-latest.list’<br/>$ curl -s <a class="ae iu" href="https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc</a> | apt-key add —</span><span id="e8c4" class="kj kk hi kf b fi kp km l kn ko">$ apt-get update<br/>$ apt install ros-noetic-desktop-full<br/>$ mkdir -p /catkin_ws/src &amp;&amp; cd /catkin_ws<br/>$ catkin build<br/>$ cd src &amp;&amp; git clone <a class="ae iu" href="https://github.com/SteveMacenski/slam_toolbox.git" rel="noopener ugc nofollow" target="_blank">https://github.com/SteveMacenski/slam_toolbox.git</a><br/>$ source /opt/ros/noetic/setup.bash<br/>$ rosdep update<br/>$ rosdep install -y -r --from-paths src --ignore-src --rosdistro=noetic -y<br/>$ catkin build</span></pre><p id="de75" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在你已经成功地安装了ROS和ROS包。尝试运行roscore，看看是否所有的东西都安装正确。如果一切顺利，那么继续设置您的环境。假设您的docker正在同一设备上与ROS主机通信。例如，如果您的Turtlebot3带有运行docker的板载PC，docker中的ROS包可以与板载PC上本地运行的ROS包和ROS主机进行通信</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="6e31" class="kj kk hi kf b fi kl km l kn ko">$ echo “source /opt/ros/noetic/setup.bash” &gt;&gt; ~/.bashrc<br/>$ echo “source /catkin_ws/devel/setup.bash” &gt;&gt; ~/.bashrc<br/>$ echo “export ROS_MASTER_URI=<a class="ae iu" href="http://172.17.0.1:11311" rel="noopener ugc nofollow" target="_blank">http://172.17.0.1:11311</a>" &gt;&gt; ~/.bashrc<br/>$ echo “export ROS_IP=172.17.0.2” &gt;&gt; ~/.bashrc<br/>$ echo “192.174.28.20 turtlebot” &gt;&gt; /etc/hosts</span></pre><p id="363e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，主机设备上的ROS主URI始终是172.17.0.1。将有两个IP地址，在我们的例子中，辅助IP地址是192.174.28.20。这可以使用以下命令进行检查:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="5ea8" class="kj kk hi kf b fi kl km l kn ko">$ ifconfig</span></pre><p id="3f35" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">turtlebot这个名字是PC的名字。这不是用户名。例如，在下面的终端中，PC的名称是linux-desktop，用户名是mark。/etc/hosts中的名称应该是PC的名称，而不是用户名！</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/0e303999ea19a4f70eafe26b609a18f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*bw5Ar4SYsX70fMLPq-BNKw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://ubuntu.com/tutorials/command-line-for-beginners#3-opening-a-terminal" rel="noopener ugc nofollow" target="_blank">https://ubuntu.com/tutorials/command-line-for-beginners#3-opening-a-terminal</a></figcaption></figure><p id="02ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">瞧啊。您已经准备好运行具有ROS功能的docker容器了。为了退出容器，键入" exit"。</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="2fce" class="kj kk hi kf b fi kl km l kn ko">$ exit</span></pre><p id="7270" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了回到该容器中，请执行以下操作:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="e65f" class="kj kk hi kf b fi kl km l kn ko">$ sudo docker ps -a </span></pre><p id="94e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将显示所有封闭的容器。重新启动先前关闭的容器的名称。所以在下图中，之前关闭的容器的名字是“jolly_lewin”。</p><figure class="ka kb kc kd fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/f47196db1072f5d8de472ddf9c770eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*heeZ38QhfpyOCC7ZMfDAJg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://stackoverflow.com/questions/48105317/what-is-the-difference-between-docker-ps-all-and-docker-ps-all" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/48105317/what-is-the-difference-between-docker-ps-all-and-docker-ps-all</a></figcaption></figure><p id="f7dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">重新启动并连接到容器的命令有:</p><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="e47f" class="kj kk hi kf b fi kl km l kn ko">$ sudo docker restart jolly_lewin<br/>$ sudo docker attach jolly_lewin</span></pre><p id="75c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是了。创建混合了ROS和Ubuntu元素的Docker容器的快速指南。在下一课中，我们将介绍创建整个容器的方法，就像我们在这里使用Dockerfile所做的那样。敬请期待！</p></div></div>    
</body>
</html>
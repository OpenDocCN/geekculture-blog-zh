<html>
<head>
<title>How to setup React-Native + Microsoft CodePush with Sentry Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Sentry平台设置React-Native + Microsoft CodePush</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-setup-react-native-microsoft-codepush-with-sentry-platform-df1b717d6a7?source=collection_archive---------5-----------------------#2022-05-02">https://medium.com/geekculture/how-to-setup-react-native-microsoft-codepush-with-sentry-platform-df1b717d6a7?source=collection_archive---------5-----------------------#2022-05-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3a2202dfff29b49238856f5b3d89a79f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kH9buEsNIZC7RHB_"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@karlp?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Karl Pawlowicz</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1d7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将向您展示如何在Sentry平台上正确设置使用Microsoft CodePush的react-native应用程序，正确上传源代码地图以观察引发错误的正确行。</p><h1 id="0630" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">关于react-native代码</h1><p id="549e" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">第一步是在您的react-native项目上安装Sentry SDK，您可以通过运行上述命令来实现这一点。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="aa22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">安装后，考虑到您已经正确配置了Microsoft CodePush，您必须更改您的<code class="du lc ld le lf b">index.js</code>源文件，这是您必须要做的修改。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="d948" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将解释<code class="du lc ld le lf b">release</code>属性中包含的内容:</p><p id="b796" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lc ld le lf b"><strong class="ix hj">BUNDLE_ID</strong></code> : <code class="du lc ld le lf b">com.yourapp.bundleid</code> &gt;你可以在<code class="du lc ld le lf b">android &gt; app &gt; build.gradle</code>文件上找到。</p><p id="bc8c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lc ld le lf b"><strong class="ix hj">NATIVE_VERSION</strong></code>:你的build.gradle上的原生版本是不是和<code class="du lc ld le lf b">5.4.4</code>一样，你可以在<code class="du lc ld le lf b">android &gt; app &gt; build.gradle</code>文件上找到这个信息。</p><p id="05f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lc ld le lf b"><strong class="ix hj">CODEPUSH_DIST</strong></code>:这是你的代码推送信息版本，你可以在你的应用中心找到，在这个例子中是<code class="du lc ld le lf b">v196</code>。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/8f2ddf2ab93292da520c8a13e81962c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AylTzuHt3cKOWyM5aR5l-w.png"/></div></div></figure><p id="7128" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个配置之后，你现在必须上传你在sentry上发布的最后一个codepush版本的源代码，这样做更好，在Sentry配置上生成一个正确的新codepush版本。</p><p id="9f19" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，您必须将源地图导出到一个文件夹并上传到Sentry，我使用以下命令导出codepush的源地图:</p><p id="7020" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du lc ld le lf b">release-react -a YourOrgOnAppCenter/your-project-on-app-center -d Production — output-dir “./build”</code></p><p id="7664" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这将生成一个<code class="du lc ld le lf b">build</code>文件夹，其中包含Sentry平台正确处理您的代码所需的代码推送文件，该文件夹如下所示:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lh"><img src="../Images/c033f130e537b84e4a69cd7e73ad3646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*8czZ7NayTPKe3RBr5U5r-w.png"/></div></figure><p id="b83f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，考虑到您已经登录了<code class="du lc ld le lf b">sentry-cli</code>，要将它上传到Sentry，您将运行上面的命令:</p><pre class="kw kx ky kz fd li lf lj lk aw ll bi"><span id="a24e" class="lm ju hi lf b fi ln lo l lp lq">sentry-cli react-native appcenter <!-- -->YourOrgOnAppCenter/your-project-on-app-center<!-- --> android "./build/CodePush" --bundle-id "$BUNDLE_ID" --version-name "$<!-- -->NATIVE_VERSION<!-- -->" --dist "$CODEPUSH_DIST"</span></pre><p id="f367" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，它们是相同的变量，以前在react本机配置上使用，通常这种版本控制和上传过程是在一些CI服务上进行的，如Github操作。</p><p id="8447" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是此时，您的react-native代码推送应用程序的源映射被正确地更新到Sentry，并且您的错误必须被正确地报告，准确地通知抛出错误的行，如上例，我建议在一个<code class="du lc ld le lf b">Staging</code>代码推送包中检查这个抛出错误。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lr"><img src="../Images/4d33e83fb949717be88da6f73b997183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__dwuib2xzDnbNkNNjGQfw.png"/></div></div></figure><p id="de7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">谢谢大家的关注！下一篇文章再见。</p></div></div>    
</body>
</html>
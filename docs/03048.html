<html>
<head>
<title>Integration of LVM with Hadoop Cluster and providing Elasticity to DataNode Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LVM与Hadoop集群的集成，为DataNode存储提供了灵活性</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/integration-of-lvm-with-hadoop-cluster-and-providing-elasticity-to-datanode-storage-6beb70513f3?source=collection_archive---------33-----------------------#2021-05-30">https://medium.com/geekculture/integration-of-lvm-with-hadoop-cluster-and-providing-elasticity-to-datanode-storage-6beb70513f3?source=collection_archive---------33-----------------------#2021-05-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/ebc909135a89a76cb44ee51168c7d2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htUtKVmaUso7Wa2rjqaV0Q.png"/></div></div></figure><div class=""/><p id="c68a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">在</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Linux" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Linux </strong> </a> <strong class="is hu">中，逻辑卷管理器(LVM)是一个</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Device_mapper" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">设备映射器</strong> </a> <strong class="is hu">框架，为</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Linux_kernel" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Linux内核</strong> </a> <strong class="is hu">提供</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Logical_volume_management" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">逻辑卷管理</strong> </a> <strong class="is hu">。大多数现代的</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Linux_distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Linux发行版</strong> </a> <strong class="is hu">都是LVM感知的，以至于能够将它们的</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Root_file_system" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">根文件系统</strong> </a> <strong class="is hu">放在一个</strong> <a class="ae jo" href="https://en.wikipedia.org/wiki/Logical_volume" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">逻辑卷</strong> </a> <strong class="is hu">上。</strong></p><p id="a43e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Heinz Mauelshagen于1998年编写了最初的LVM代码，当时他在Sistina Software工作，从HP-UX的卷管理器那里获得了主要的设计指导方针。</p><p id="7078" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">卷管理</strong>在物理存储上创建<strong class="is hu"> <em class="jp">抽象层</em> </strong>，允许您创建逻辑存储卷。这在许多方面比直接使用物理存储提供了更大的灵活性。此外，硬件存储配置对软件是隐藏的，因此可以在不停止应用程序或卸载文件系统的情况下调整和移动它。这可以降低运营成本。</p><p id="c549" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">与直接使用物理存储相比，逻辑卷具有以下优势:</p><ul class=""><li id="1031" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">灵活容量</strong></li></ul><p id="d146" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用逻辑卷时，文件系统可以跨多个磁盘扩展，因为您可以将磁盘和分区聚合到单个逻辑卷中。</p><ul class=""><li id="eaf7" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">可调整大小的存储池</strong></li></ul><p id="36ca" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以使用简单的软件命令扩展逻辑卷或减少逻辑卷的大小，而无需对底层磁盘设备进行重新格式化和重新分区。</p><ul class=""><li id="33db" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">在线数据重新定位</strong></li></ul><p id="7a86" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要部署更新、更快或更有弹性的存储子系统，您可以在系统处于活动状态时移动数据。使用磁盘时，可以重新排列磁盘上的数据。例如，您可以在移除热插拔磁盘之前清空它。</p><ul class=""><li id="4c93" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">方便设备命名</strong></li></ul><p id="9522" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以在用户定义和自定义命名的组中管理逻辑存储卷。</p><ul class=""><li id="64e4" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">磁盘分条</strong></li></ul><p id="dac8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以创建一个逻辑卷，在两个或多个磁盘上对数据进行条带化。这可以显著提高吞吐量。</p><ul class=""><li id="dbcb" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">镜像卷</strong></li></ul><p id="01ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">逻辑卷提供了一种为数据配置镜像的便捷方式。</p><ul class=""><li id="451b" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">卷快照</strong></li></ul><p id="1a84" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用逻辑卷，您可以拍摄设备快照以进行一致的备份，或者在不影响真实数据的情况下测试更改的效果。</p><ul class=""><li id="b5c2" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">精简卷</strong></li></ul><p id="0ea3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以对逻辑卷进行精简配置。这允许您创建大于可用盘区的逻辑卷。</p><ul class=""><li id="5fd2" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated"><strong class="is hu">缓存卷</strong></li></ul><p id="7452" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">缓存逻辑卷使用由快速块设备(如SSD驱动器)组成的小型逻辑卷，通过将经常使用的块存储在更小、更快的逻辑卷上来提高更大、更慢的逻辑卷的性能。</p><h1 id="f028" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">LVM建筑概述</h1><p id="1e6a" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">LVM逻辑卷的底层物理存储单元是块设备，如分区或整个磁盘。该设备被初始化为LVM物理卷(PV)。</p><p id="45b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了创建<strong class="is hu">一个LVM逻辑卷，物理卷</strong>被组合成一个<strong class="is hu">卷组(VG) </strong>。这将创建一个磁盘空间池，从中可以分配LVM逻辑卷(LV)。这个过程类似于将磁盘划分为分区的方式。文件系统和应用程序(如数据库)使用逻辑卷。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div class="er es lc"><img src="../Images/3ea7eb6368edb77ab47eaa3038d9ac8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*Lf1eeaLumVA3QcQWQ9kn1Q.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Source: Wikipedia</figcaption></figure><h1 id="1c0d" class="jz ka ht bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">APACHE HADOOP</h1><p id="d86c" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated"><a class="ae jo" href="https://hadoop.apache.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Apache Hadoop软件</strong> </a> <strong class="is hu">库是一个框架</strong>，它允许使用简单的编程模型跨计算机集群对大型数据集进行<strong class="is hu">分布式处理。它被设计成从单个服务器扩展到数千台机器，每台机器提供本地计算和存储。该库本身不是依靠硬件来提供高可用性，而是被设计为检测和处理应用层的故障，因此在一个计算机集群上提供高可用性服务，而每个计算机都可能容易出现故障。</strong></p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="26ff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，我使用了<strong class="is hu"> AWS cloud </strong>，在那里我启动了我的Hadoop集群，并创建了<strong class="is hu">一个NameNode </strong>和<strong class="is hu">一个DataNode </strong>。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/e27983497b335ec0126a2cba90f4459d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Q8Pl5XvW_Ch_QQEAuFMKg.png"/></div></div></figure><p id="9f67" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">启动后，我们必须设置Hadoop集群的<strong class="is hu"> NameNode，并验证我们将使用<code class="du ls lt lu lv b"><strong class="is hu">jps</strong></code> <strong class="is hu"> </strong>命令，该命令显示<strong class="is hu">当前Java进程</strong> <strong class="is hu">正在<strong class="is hu">虚拟机(JVM)中运行</strong>。</strong></strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/10763874ac1edd99824d49d423b6b923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HhqtqqAoUCt1Jqip0q7qyA.png"/></div></div></figure><p id="557d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">类似地，在DataNode中，我们有<strong class="is hu">来配置和启动</strong>在<strong class="is hu"> EC2实例中的DataNode进程。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/0a042744e5ae7d2e56f87b3e8a6d8c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgzNdbMyOJYstqLhzAfwWw.png"/></div></div></figure><p id="489c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在成功配置和初始化上述过程之后，它应该看起来像这样。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/1dbd57e0afadf83a1b26144b6968f689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mQw9kfpcAeymf-DL8MSRTw.png"/></div></div></figure><blockquote class="ly lz ma"><p id="93a5" class="iq ir jp is b it iu iv iw ix iy iz ja mb jc jd je mc jg jh ji md jk jl jm jn hb bi translated"><code class="du ls lt lu lv b"><strong class="is hu">hadoop dfsadmin -report</strong></code></p></blockquote><p id="9c9d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此命令在CLI中显示Namenode和DataNode的整个群集报告。</p><p id="748c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">在Chrome、Firefox等任何兼容浏览器中打开provide URL，我们还可以看到上述集群的Web控制台UI报告。</strong></p><blockquote class="ly lz ma"><p id="5339" class="iq ir jp is b it iu iv iw ix iy iz ja mb jc jd je mc jg jh ji md jk jl jm jn hb bi translated"><code class="du ls lt lu lv b"><strong class="is hu">http://&lt;IPv4_of_NameNode&gt;:50070/dfshealth.jps</strong></code></p></blockquote><p id="f802" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意:附加到两个EC2实例的安全组应该允许端口号50070，否则我们将看不到任何东西。</strong></p><p id="d7aa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是我们需要的基本设置，以便详细见证实际情况。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><figure class="ld le lf lg fd hk"><div class="bz dy l di"><div class="me mf l"/></div></figure><h2 id="a71a" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated"><strong class="ak">步骤1:创建并连接两个EBS卷</strong></h2><p id="a1d1" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">我们将创建两个大小为15GiB的EBS通用SSD卷，在扩展我们的DataNode移动存储时用作附加存储。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7ac59724a5ae2172607da4a0849d8f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PBEqGZBj6RBpH8OrIZqJZw.png"/></div></div></figure><p id="5c6a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">正如我们在<strong class="is hu"> AWS中看到的，标记为<strong class="is hu">物理驱动器1 </strong>和<strong class="is hu">物理驱动器2的两个卷</strong>。</strong></p><p id="d0d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是在DataNode中，设备的<strong class="is hu">名称将被不同地映射</strong>，比如<strong class="is hu"> /dev/xvdf </strong>和<strong class="is hu"> /dev/xvdg </strong>，这基本上模仿了<strong class="is hu"> /dev/sdf </strong>和<strong class="is hu"> /dev/sdg。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mu"><img src="../Images/a462e22d538f2f3bd1653e6ba64fc54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D0sM4FQ15NLgh-ongnvVw.png"/></div></div></figure><h2 id="eec4" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated"><strong class="ak">步骤2:安装必要的软件包</strong></h2><p id="5eba" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">现在我们已经附加了卷，我们将在DataNode系统中下载<strong class="is hu"> lvm2 </strong>包。DataNode系统正在运行<strong class="is hu"> RHEL 8云映像(AMI)。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mv"><img src="../Images/8cc72098ed0131c93472280f3e53ad80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Iv3wqopZEk16wVqj6TuAQ.png"/></div></div></figure><p id="9ef3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用<strong class="is hu"> yum package </strong>管理器来<strong class="is hu">安装lvm2包及其依赖项。</strong></p><h2 id="7e8c" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated">步骤3:从物理分区创建物理卷</h2><p id="0d37" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated"><strong class="is hu"> /dev/xvdf </strong>和<strong class="is hu"> /dev/xvdg </strong>是我们将使用<code class="du ls lt lu lv b"><strong class="is hu">pvcreate</strong></code>命令创建物理卷的物理分区。</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="61bd" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">pvcreate /dev/xvdf /dev/xvdg</strong></span></pre><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ne"><img src="../Images/8d58cdacd66eedea389155dfe092edf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sCUgFZnjZr8yiY6x6foBPA.png"/></div></div></figure><p id="1ac2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以使用三个命令来显示LVM物理卷的属性:pvs、pvdisplay和pvscan。</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="54a5" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">pvs</strong><strong class="lv hu"> </strong></span></pre><p id="8e4a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">PVS命令以可配置的形式提供物理卷信息，每个物理卷显示一行。pvs命令提供了大量的格式控制，对于脚本编写非常有用。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="6919" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">pvscan</strong><strong class="lv hu"> </strong></span></pre><p id="a94d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">PVS can命令扫描系统中所有支持的LVM块设备的物理卷。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="3cdf" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">pvdisplay</strong></span></pre><p id="a948" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">PV display命令为每个物理卷提供详细的多行输出。它以固定格式显示物理属性(大小、数据区、卷组等)。</em> </strong></p><h2 id="9fae" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated">步骤4:创建物理卷的卷组</h2><p id="4726" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">物理卷被组合成卷组(VG)。这将创建一个磁盘空间池，从中可以分配逻辑卷。</p><p id="069f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在卷组中，可用于分配的磁盘空间被划分为固定大小的单元，称为盘区。扩展区是可以分配的最小空间单位。在一个物理卷中，盘区被称为物理盘区。</p><p id="2f23" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">逻辑卷被分配到与物理盘区大小相同的逻辑盘区中。因此，卷组中所有逻辑卷的盘区大小都是相同的。卷组将逻辑盘区映射到物理盘区。</p><p id="f9d1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要创建卷组，请使用以下命令:</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="b672" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">vgcreate hadoop /dev/xvdf /dev/xvdg</strong></span></pre><p id="fb21" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这就创建了一个名为<strong class="is hu"> <em class="jp"> hadoop </em> </strong>的VG。PVs<strong class="is hu">/dev/xvdf</strong><em class="jp"/>和<strong class="is hu"> <em class="jp"> /dev/xvdg </em> </strong>是VG <strong class="is hu"> hadoop </strong>的基本存储级别。</p><p id="bfd8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以后可以用PVs扩展上述VG。要扩展VG，请使用以下命令:</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="a4d5" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">vgextend hadoop /dev/xvdh</strong></span></pre><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nf"><img src="../Images/22e282e01237db83e85ab0aa55791e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nqg6aOa2jYKJWLClNEojXg.png"/></div></div></figure><p id="f632" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有两个命令可以用来显示<strong class="is hu"> LVM卷组</strong>的属性:<strong class="is hu"> vgs </strong>和<strong class="is hu"> vgdisplay </strong>。</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="fe36" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">vgscan</strong></span></pre><p id="9282" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">vgscan命令扫描系统中所有支持的LVM块设备以查找卷组，也可用于显示现有的卷组。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="f5bc" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">vgs</strong></span></pre><p id="8926" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">vgs命令以可配置的形式提供卷组信息，每个卷组显示一行。vgs命令提供了大量的格式控制，对于脚本编写非常有用。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="69d8" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">vgdisplay</strong></span></pre><p id="4c28" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">vgdisplay命令以固定的形式显示卷组属性(如大小、盘区、物理卷的数量等)。</em> </strong></p><h2 id="aa76" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated"><strong class="ak">步骤— 5:从卷组创建逻辑卷</strong></h2><p id="5d15" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">要创建逻辑卷，请使用以下命令:</p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="16a8" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">lvcreate -L 12G -n Volume1 hadoop</strong></span></pre><p id="ada4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="du ls lt lu lv b"><strong class="is hu">-n</strong></code>选项允许用户将LV名称设置为lv01。在本例中,<code class="du ls lt lu lv b"><strong class="is hu">-L</strong></code>选项允许用户以Mb为单位设置LV的大小，但是也可以使用任何其他单位。默认情况下，LV类型是线性的，但是用户可以通过使用<code class="du ls lt lu lv b"><strong class="is hu">--type</strong></code>选项指定所需的类型。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ng"><img src="../Images/d824a8388afcea212e75ae84abd9cc1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUvRPiZN-lsr2zqYXfNF9w.png"/></div></div></figure><p id="8511" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有三个命令可以用来显示<strong class="is hu"> LVM逻辑卷的属性:lvs、lvdisplay和lvscan。</strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="e915" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">lvs</strong></span></pre><p id="02ce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">LVS命令以可配置的形式提供逻辑卷信息，每个逻辑卷显示一行。lvs命令提供了大量的格式控制，对于脚本编写非常有用。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="9687" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">lvdisplay</strong></span></pre><p id="1bf0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">lvdisplay命令以固定格式显示逻辑卷属性(如大小、布局和映射)。</em> </strong></p><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="3294" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">lvscan</strong></span></pre><p id="5ba2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"><em class="jp">LVS can命令扫描系统中的所有逻辑卷并列出它们。</em> </strong></p><h2 id="382b" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated"><strong class="ak">步骤6:格式化逻辑卷</strong></h2><p id="710f" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">现在，为了使用存储空间，我们必须格式化ext4文件系统中的逻辑卷一次。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nh"><img src="../Images/ca9c30bf2cd62bb69f7eb637804c7593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28sOHi4UKwoNS5z42DebEA.png"/></div></div></figure><h2 id="cffc" class="mg ka ht bd kb mh mi mj kf mk ml mm kj jb mn mo kn jf mp mq kr jj mr ms kv mt bi translated">步骤7:为卷1 (LV)创建一个挂载点</h2><p id="1729" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">格式化之后，现在我们将逻辑卷挂载到/dn1目录，该目录是我们在配置DataNode系统时已经创建的。</p><p id="4da3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意，在挂载之前，我们需要停止DataNode进程。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ni"><img src="../Images/ae85ca33c35c3bcb82606d3b3f4b1416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uv8BiuuqYL7qUD93_QfB1A.png"/></div></div></figure><pre class="ld le lf lg fd mw lv mx my aw mz bi"><span id="e914" class="mg ka ht lv b fi na nb l nc nd"><strong class="lv hu">df -h</strong></span></pre><p id="5546" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">该命令显示卷1的12GiB空间被挂载到/dn1。</strong></p><p id="6325" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">再次启动DataNode后，我们可以看到我们的Hadoop DataNode现在有12GiB的存储空间。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nj"><img src="../Images/e11a0b60dedd160c97251d77ae661a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfs5SEXIFnkH0xYZ6ZB_TA.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/c2d1e657100074e99b49eb71f46a7eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mmhz4m2qBZBkDwbNg0wdpw.png"/></div></div></figure></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h1 id="bab7" class="jz ka ht bd kb kc nk ke kf kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw bi translated">增加逻辑卷</h1><p id="4b2c" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">为了增加逻辑卷的大小，我们使用了<strong class="is hu"> lvextend </strong>命令。</p><p id="6509" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">当我们扩展逻辑卷时，我们可以指明我们想要扩展多少，或者在扩展之后我们想要它有多大。</strong></p><p id="af78" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">在我们扩展了逻辑卷之后，有必要增加文件系统的大小来匹配。</strong></p><p id="e02e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">默认情况下，大多数文件系统调整工具会将文件系统的大小增加到底层逻辑卷的大小，因此我们不需要担心为两个命令指定相同的大小。这也是我们在lvextend中使用 <code class="du ls lt lu lv b"><strong class="is hu">--resizefs</strong></code> <strong class="is hu">选项的原因。</strong></p><p id="b29b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下命令将逻辑卷<strong class="is hu"> /dev/hadoop/Volume1 </strong>扩展到16千兆字节(GiB)。</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es np"><img src="../Images/dd002fc97717643c9758a63a5ab1dd37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8L7PKFIg866TwcJ4wjVhQ.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nq"><img src="../Images/db53b414bc17e5f6d9dcb5ce61cd61b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfL6ZXrF10LcHrPgOKy2-A.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/f5af13006901fd0569dad54b75ad9e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvnSX1i1jQizIHOriYsXUg.png"/></div></div></figure><p id="b54a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面的命令将<strong class="is hu"> 8千兆字节(GiB) </strong>添加到逻辑卷<strong class="is hu"> /dev/hadoop/Volume1，该卷扩展到24千兆字节。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nr"><img src="../Images/24e56cbc2a3f42d6283b7cfb0bbf6181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tkqkjLlp_9X7LJJcNeFVWg.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ns"><img src="../Images/70a431004c81ccbad34848be783c0dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGu6eYRMjSwEXsQZtaTEww.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mv"><img src="../Images/4a174154ca7cd18748dcf1f0531bbf56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYgCR0bDL1Bsj3TX-TRIyQ.png"/></div></div></figure></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h1 id="6cd6" class="jz ka ht bd kb kc nk ke kf kg nl ki kj kk nm km kn ko nn kq kr ks no ku kv kw bi translated">缩小逻辑卷</h1><p id="3ff0" class="pw-post-body-paragraph iq ir ht is b it kx iv iw ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn hb bi translated">我们可以使用<strong class="is hu"> lvreduce </strong>命令来减小逻辑卷的大小。</p><p id="b2a3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果您正在减少的逻辑卷包含文件系统，为了防止数据丢失，我们必须确保文件系统没有使用正在减少的逻辑卷中的空间。因此，当逻辑卷包含文件系统时，建议您使用lvreduce命令的<code class="du ls lt lu lv b"><strong class="is hu">--resizefs</strong></code>选项。当我们使用此选项时，lvreduce命令会在收缩逻辑卷之前尝试缩减文件系统。如果收缩文件系统失败(在文件系统已满或文件系统不支持收缩时会发生这种情况)，则lvreduce命令将失败，并且不会尝试收缩逻辑卷。</p><p id="d3ce" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">请注意，我们需要停止DataNode，因为缩小或减少存储大小并不常见，我们需要停止Datanode进程，因为它将该操作视为数据丢失。</strong></p><p id="9f50" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下命令将逻辑卷<strong class="is hu"> /dev/hadoop/Volume1 </strong>扩展到7gb(GiB)</p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nt"><img src="../Images/b67391c9cd5aaef7f73d910690c3ca43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*waFXUj8Rtg30AOh7hRE5bA.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nq"><img src="../Images/913b17a7b08ed8bc0a4c587adad2e39e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpw4gz0FhypFcNCAVpktLg.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/52f2f9fa134ff5ba5a051bfc52c51239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gRFIPw0EqM1Olw_hfo9ULg.png"/></div></div></figure><p id="86d3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下命令将1 <strong class="is hu"> gigibyte(GiB) </strong>删除到逻辑卷<strong class="is hu"> /dev/hadoop/Volume1。</strong></p><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nu"><img src="../Images/ebdd44fe2fd53e8e208bd3a5e4d99f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGTuddr0sIaZHyON3kdqAg.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nv"><img src="../Images/2234f95bd120edf319383899974ec1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEBpTPfn5INlLnXJzV6Spg.png"/></div></div></figure><figure class="ld le lf lg fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7a86421712bc62745a003e0ebded0fd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKz1xhKo63q4oJ30ezLnnQ.png"/></div></div></figure></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="197a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我要感谢维姆·达加先生提供了一个令人敬畏的研究课题；很有趣。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><figure class="ld le lf lg fd hk"><div class="bz dy l di"><div class="nw mf l"/></div></figure><blockquote class="nx"><p id="7c73" class="ny nz ht bd oa ob oc od oe of og jn dx translated">“一个读者在他死之前经历了一千次生命，Jojen说。从不读书的人只活一个。”<br/> ― <strong class="ak">乔治·R·R·马丁，</strong> <a class="ae jo" href="https://g.co/kgs/C2KdG9" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">与龙共舞</strong> </a></p></blockquote></div></div>    
</body>
</html>
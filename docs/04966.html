<html>
<head>
<title>Evaluating Classification Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估分类模型</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/evaluating-classification-models-3a28a569962c?source=collection_archive---------37-----------------------#2021-07-06">https://medium.com/geekculture/evaluating-classification-models-3a28a569962c?source=collection_archive---------37-----------------------#2021-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7681" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">常用工具和指标概述</h2></div><h1 id="c25a" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">介绍</h1><p id="1b83" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">分类模型代表了机器学习世界中一些最有用和最实用的算法。从预测是否会下雨到确定信用卡欺诈活动，这些类型的模型使用提供给它们的可用数据将它们的预测输出分成两组或更多组。多年来，出现了各种解决分类问题的策略，包括逻辑回归、决策树、k近邻等等。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div class="er es kl"><img src="../Images/0e672f7f49a6d89f9efa32132580a404.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*4W89StobCKMHS5kGh3C4KQ.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Example of a complex decision tree. Image by author.</figcaption></figure><p id="8ff4" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">考虑到可用的不同策略，一个自然的问题出现了:<strong class="jr hj">如何对分类模型进行评估和相互比较？</strong>虽然构建分类模型的实际过程将留待下次讨论，但本文将带您了解一些最常用的评估工具和指标。</p><h1 id="be43" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">混乱矩阵</h1><p id="350c" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">在深入研究通常用于回答上述问题的具体指标之前，我们必须首先了解基础知识。为了简单起见，我们只看二进制分类模型，但是要知道后面的概念也很容易扩展到多维数据。混乱矩阵，顾名思义，相当简单。它向我们展示了一个模型的预测是如何与真实和正确的值相比较的，也就是所谓的基本事实。让我们看一个例子:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lc"><img src="../Images/9194cea75f7b45d0916d0c4591105cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*56Yy_Z4SFC5eeSTd_us0nw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Example of a confusion matrix. Image by author.</figcaption></figure><p id="7836" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">这里有四个要点，每个象限一个:</p><ol class=""><li id="24e2" class="lh li hi jr b js kx jv ky jy lj kc lk kg ll kk lm ln lo lp bi translated"><strong class="jr hj">真阴性(TN) </strong>是预测标签为0且真实标签也为0的预测数。这可以在左上象限找到。注意:在这个上下文中，负数不一定意味着负值，而是代表真/假、开/关、活/死等的二进制的一部分。</li><li id="3b35" class="lh li hi jr b js lq jv lr jy ls kc lt kg lu kk lm ln lo lp bi translated"><strong class="jr hj">真阳性(TP) </strong>与真阴性相似，但有相反的标记(在本例中为1)。这可以在右下象限找到。</li><li id="37b8" class="lh li hi jr b js lq jv lr jy ls kc lt kg lu kk lm ln lo lp bi translated"><strong class="jr hj">假阴性(FN) </strong>是模型预测为负值，而实际情况为正值的场景。这可以在左下象限找到。</li><li id="6b39" class="lh li hi jr b js lq jv lr jy ls kc lt kg lu kk lm ln lo lp bi translated"><strong class="jr hj">假阳性(FP) </strong>是模型预测为正值，而实际为负值的情况。这可以在右上象限找到。</li></ol><p id="82ac" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">这四条信息可以以各种方式组合起来，以描述模型的整体有效性。现在，让我们来看看其中的一些具体指标。</p><h1 id="16ac" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">韵律学</h1><h2 id="acb5" class="lv iy hi bd iz lw lx ly jd lz ma mb jh jy mc md jj kc me mf jl kg mg mh jn mi bi translated">准确(性)</h2><p id="63da" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">准确性是最直观的度量标准，本质上是对一个模型的预测有多少是正确的——也就是说，与事实相符——的一种度量。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mj"><img src="../Images/ce571427b0b0de96ff120e0c18aa57e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N5tJ3YjejkcWCG57KHH9MQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Formula for Accuracy. Image by author.</figcaption></figure><p id="6fda" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">虽然看起来除了这个度量标准之外没有什么需要，但是仅仅依靠准确性来评估分类模型是错误的。考虑下面这个经常被引用来强调这个问题的场景:100个病人正在接受一种疾病的测试，而这种疾病只发生在1%的人身上。一个预测根本没有人患病的模型在技术上有99%的准确率，但对于实际发现被感染的病人来说完全没有用！</p><p id="66ab" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">使用在混淆矩阵示例中找到的值，准确度大约为80.72%。</p><h2 id="d8f6" class="lv iy hi bd iz lw lx ly jd lz ma mb jh jy mc md jj kc me mf jl kg mg mh jn mi bi translated">精确</h2><p id="20e5" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">一个模型的正预测包含真阳性和假阳性。Precision查看所有预测的正值，并确定百分之多少是真正的正值。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mj"><img src="../Images/bd467a84fda19730e002d8abdb2dd749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slDE9MTnSuKYnUwtfepM9g.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Formula for Precision. Image by author.</figcaption></figure><p id="93d9" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">使用在混淆矩阵示例中找到的值，精度将大约为76.74%。</p><h2 id="c160" class="lv iy hi bd iz lw lx ly jd lz ma mb jh jy mc md jj kc me mf jl kg mg mh jn mi bi translated">回忆</h2><p id="4711" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">Recall scores模型预测的真实阳性数占真实阳性总数的百分比。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mj"><img src="../Images/5e9e4593faa2c93262be21475f277851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkW4Szh9CVXakAUgxcpSKQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Formula for Recall. Image by author.</figcaption></figure><p id="a71d" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">在“准确性”一节中提到的疾病场景的背景下考虑这个指标。虽然准确率为99%，但召回率将为0%，因为将有零个真阳性和一个假阴性(实际患有疾病的患者，但模型自动分类为没有患病)。</p><p id="453a" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">使用混淆矩阵示例中的值，召回率大约为74.16%。</p><h2 id="a447" class="lv iy hi bd iz lw lx ly jd lz ma mb jh jy mc md jj kc me mf jl kg mg mh jn mi bi translated">F1分数</h2><p id="0feb" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">精确度和召回率呈现出相反的关系，它们的相对重要性完全取决于所处理的数据的上下文。一般来说，在这两个指标上都获得高分是更好的选择。F1分数代表精确度和召回率的调和平均值，并作为两者之间平衡的衡量标准。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es mj"><img src="../Images/66e0a5b56bc9d5e224c5c1360ec0379e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F1FRDBfvXFwAQzr-7UWt5A.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Formula for F1 Score. Image by author.</figcaption></figure><p id="f266" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">作为使用调和平均值而不是算术平均值的结果，只有当<em class="ml"/>精度和召回都具有高值时，F1分数才能具有高值。任何一个指标的低值都会显著降低F1分数。</p><p id="1662" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">使用在混淆矩阵示例中找到的值，F1分数将约为75.43%。</p><h1 id="19c6" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">ROC曲线</h1><p id="6b9e" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">对于那些希望有更直观的分类模型评估方法的人来说，你很幸运。受试者工作特征(ROC)曲线绘制了假阳性率与真阳性率的关系，并提供了模型有效性的快速解释可视化。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="er es lc"><img src="../Images/b3c186926f89ed9ad9bbcfc5477aa01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdl7EofcO1JokW-Cs6xyNQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Example of an ROC Curve. Image by author.</figcaption></figure><p id="f333" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">斜虚线表示随机猜测的模型。具有某种程度预测能力的有用模型将具有向左上方延伸的曲线。在本例中，逻辑回归模型的性能用蓝线表示。多个模型迭代和类型的ROC曲线可以覆盖在同一个图上，以便快速比较。通过<a class="ae mk" href="https://en.wikipedia.org/wiki/Integral" rel="noopener ugc nofollow" target="_blank">积分</a>测量曲线下面积(AUC ),仍可对单个曲线进行定量评估和比较。在上面的例子中，这个值用“AUC = 0.88”表示。完美分类所有值的模型将具有1.00的AUC。</p><h1 id="6c0d" class="ix iy hi bd iz ja jb jc jd je jf jg jh io ji ip jj ir jk is jl iu jm iv jn jo bi translated">结论</h1><p id="ee8a" class="pw-post-body-paragraph jp jq hi jr b js jt ij ju jv jw im jx jy jz ka kb kc kd ke kf kg kh ki kj kk hb bi translated">理解这些工具和指标以及它们之间的区别是正确评估分类模型性能的关键。不同的问题需要调优模型，根据对领域最有意义的东西来优化不同的度量。虽然存在其他评估方法，但本文涵盖的主题提供了一个坚实的基础。</p><p id="e669" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated">如果你喜欢这篇文章，请留下👏或者有任何反馈的评论！</p><p id="a18c" class="pw-post-body-paragraph jp jq hi jr b js kx ij ju jv ky im jx jy kz ka kb kc la ke kf kg lb ki kj kk hb bi translated"><strong class="jr hj">Github</strong>:<a class="ae mk" href="https://github.com/tjkyner" rel="noopener ugc nofollow" target="_blank">https://github.com/tjkyner</a><br/><strong class="jr hj">中</strong>:<a class="ae mk" href="https://tjkyner.medium.com/" rel="noopener">https://tjkyner.medium.com/</a><br/><strong class="jr hj">LinkedIn</strong>:<a class="ae mk" href="https://www.linkedin.com/in/tjkyner" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/tjkyner/</a></p></div></div>    
</body>
</html>
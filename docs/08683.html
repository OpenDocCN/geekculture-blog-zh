<html>
<head>
<title>Sklearn expects Data to be In Shape</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Sklearn期望数据处于良好状态</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/sklearn-expects-data-to-be-in-shape-64fbcaf80a8c?source=collection_archive---------5-----------------------#2021-11-10">https://medium.com/geekculture/sklearn-expects-data-to-be-in-shape-64fbcaf80a8c?source=collection_archive---------5-----------------------#2021-11-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4d9b" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Sklearn需要一个2D数组</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/80b44c5393dfd8480de34c13ed82ccf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ThYoV-yYHR47I-Rj"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@fabioha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">fabio</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8a40" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">问题陈述:</strong>下面sklearn错误说明了一切。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="a990" class="kp kq hi kl b fi kr ks l kt ku">ValueError: Expected 2D array, got 1D array instead: array=[2 7 8 4 1 6]. Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.</span></pre><p id="6161" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们认识到在构建一个基本的sklearn线性回归模型时，使数据成形的重要性。</p><p id="4f81" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">导入必要的库，</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="e4e4" class="kp kq hi kl b fi kr ks l kt ku">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LinearRegression</span></pre><p id="cede" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">创建一个样本数据框，</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="2648" class="kp kq hi kl b fi kr ks l kt ku">data = {'X':[1,2,3,4,5,6,7,8,9,10],<br/>        'y':[5,7,9,11,13,15,17,19,21,23]}<br/>df = pd.DataFrame(data)</span></pre><p id="0ef4" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从数据帧df中获取X，y数据，</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="e41c" class="kp kq hi kl b fi kr ks l kt ku">X = df["X"]<br/>y = df["y"]</span></pre><p id="dc91" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">执行<a class="ae jn" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">列车试运行</a>，</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="43e6" class="kp kq hi kl b fi kr ks l kt ku">X_Train, X_Test, Y_Train, Y_Test = train_test_split(X, y, test_size = 1/3, random_state = 0)</span></pre><p id="9d32" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">建立一个基本的<a class="ae jn" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank">线性回归模型</a>，</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="b532" class="kp kq hi kl b fi kr ks l kt ku"># instantiate the model with desired parameter values<br/>lr = LinearRegression()</span><span id="8b83" class="kp kq hi kl b fi kv ks l kt ku"># fit the model to the training data<br/>lr.fit(X_Train, Y_Train)</span><span id="b76d" class="kp kq hi kl b fi kv ks l kt ku"># apply the model to test data<br/>y_pred = lr.predict(X_Test)                                            </span><span id="6e18" class="kp kq hi kl b fi kv ks l kt ku"># get coef, intercept values<br/>print (lr.coef_)<br/>print (lr.intercept_)</span></pre><p id="f695" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这里有一个错误！</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="7a0b" class="kp kq hi kl b fi kr ks l kt ku">ValueError: Expected 2D array, got 1D array instead: array=[2 7 8 4 1 6]. Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.</span></pre><p id="7ea8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在遇到这个错误之前，我从来不知道我们需要2D数组来获得sklearn工作。让我们调试错误。该错误指出它需要2D数组，但却得到了1D数组。X的形状给出了(10)的输出，这显然是一个1D数组。</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="eee0" class="kp kq hi kl b fi kr ks l kt ku">X.shape</span><span id="3ad1" class="kp kq hi kl b fi kv ks l kt ku">Output: (10,)</span></pre><p id="3653" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们用X = df["X"]得到X变量。这将生成一个形状为(10，)没有任何列的序列。有很多方法可以将2D数组赋值给x。让我们来看看其中的几种</p><pre class="iy iz ja jb fd kk kl km kn aw ko bi"><span id="51cd" class="kp kq hi kl b fi kr ks l kt ku">#Option 1 - Reshaping to (-1,1)<br/>X = np.array(X).reshape(-1,1)</span><span id="c62e" class="kp kq hi kl b fi kv ks l kt ku">#Option 2 - Getting as a dataframe<br/>X = df.iloc[:, :-1].values</span><span id="b2bd" class="kp kq hi kl b fi kv ks l kt ku">#Option 3 - Getting as a dataframe<br/>X = df[["X"]]</span></pre><p id="3811" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">一旦我们修改了X，剩下的代码运行良好，并给出了输出。</p><p id="1db1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">思考内容:</strong>无论何时使用sklearn，在模型中使用它之前，请确保将2D数组分配给预测变量。</p></div></div>    
</body>
</html>
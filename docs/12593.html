<html>
<head>
<title>Making a Deep Learning Chandler Bing AI(from f.r.i.e.n.d.s)Part-2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">做深度学习的钱德勒·宾·艾(来自美国国防科学研究院)第二部分</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/making-a-deep-learning-chandler-bing-ai-from-f-r-i-e-n-d-s-part-2-83e991321f63?source=collection_archive---------13-----------------------#2022-05-20">https://medium.com/geekculture/making-a-deep-learning-chandler-bing-ai-from-f-r-i-e-n-d-s-part-2-83e991321f63?source=collection_archive---------13-----------------------#2022-05-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/04093374ae4e6cb14d6eaf48d961e299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Or9Y-I1_gYvg3r535rbgUQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx"><a class="ae iu" href="https://www.sportskeeda.com/pop-culture/chandler-bing-s-growth-how-friends-character-went-just-funny-guy-father-two" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="e83f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在最后一部分，我们制作了一个包含《老友记》中所有对话的数据集，并对它们进行了情感分析。如果你还没有读第一部分，我建议你先读一下:</p><div class="jt ju ez fb jv jw"><a rel="noopener follow" target="_blank" href="/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">制作深度学习的钱德勒·宾聊天机器人第一部分</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">我是f.r.i.e.n.d.s的粉丝钱德和乔伊是我最喜欢的角色。钱德勒可能超级讽刺，但也…</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">medium.com</p></div></div><div class="kf l"><div class="kg l kh ki kj kf kk io jw"/></div></div></a></div><p id="67e6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">假设你已经阅读了上面的文章，让我们继续。</p><p id="5799" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将使用数据集中的数据训练一个NLP模型。我经历了很多NLP模型，并决定基于GPT-2的模型，因为它很容易制作和使用，所以在这里使用是最好的。</p><p id="4fec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们将为这个项目使用Aitextgen库，让我们安装它:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="e378" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们导入Aitextgen:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="ce0b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检查您的GPU(如果您在Google Colab或Kaggle Notebook中执行此操作，请确保使用GPU运行时):</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kr"><img src="../Images/20b4ea1c4e661e33ddb42748c7bf7117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtFlzkcos5m5KNfhp-1u8Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The output</figcaption></figure><p id="97c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下载<a class="ae iu" href="https://huggingface.co/gpt2" rel="noopener ugc nofollow" target="_blank"> 124M GPT-2型号</a>:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="cd91" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们来看看我在<a class="ae iu" rel="noopener" href="/geekculture/making-a-chandler-bing-chatbot-from-f-r-i-e-n-d-s-part-1-5cd2af606ffe">上一篇文章</a>中制作的数据集:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="57ba" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们需要清理数据集并删除不需要的列和空格:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="0607" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看新数据帧的形状:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/541f76d595e02dd9bb9e2fcb42f1ede5.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*7oRjdvthVcu-s5D8qPaVMg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">The output</figcaption></figure><p id="b2fe" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们把单词分成两行，以便更好地训练:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/a5b82cebd8bc3f66659e3b835ef1ae26.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*FbkiFaEbNVNsnlY-capmwQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">as you can see there are two rows now</figcaption></figure><p id="017d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们将清理后的对话保存在一个. txt文件中:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="e482" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">现在我们可以使用上面的文本文件来微调模型并设置正确的参数:</strong></p><p id="fc2f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们挂载我们的Gdrive来保存模型:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="aaa2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们根据我们的需求微调模型:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/c549f17de5b1873ec8d1ea461027534a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v6n9AI6O9J081A9QLFjthQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">This process will take about 25 minutes.</figcaption></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/f8b4615b81d7d45a6fa5ea7f7c5230ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dZYgFywkLJHJ2oRG_8y7IA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Its done and its a 6gigabyte model</figcaption></figure><p id="978f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在不再需要对模型进行训练，我们可以直接加载训练好的模型，并根据需要使用它:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="a1ef" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们使用该模型在没有任何提示的情况下生成一个样本:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/ff687598b6d66280f363b6c7e827fafb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15QiY2b54trrSyHTnFEkcw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">The Output</figcaption></figure><p id="4cd3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，在它产生文本的时候，每个角色会怎么说话。现在让我们添加一个提示“chandler会这样说:”并过滤输出。</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="e701" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，女士们，先生们，我向你们展示一个人工智能，它可以生成来自联邦民主共和联盟的钱德勒·宾所说的话。😁</p><blockquote class="kw kx ky"><p id="0a9d" class="iv iw kz ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">钱德勒会这么说:" " " "滚出去，滚出去！" " " " "我出来了！" " " " "听到了，听到了。" " " " "“听到了。" ==========</p><p id="8c93" class="iv iw kz ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">这是钱德勒会说的话:" " " "我什么时候…"…我是不是希望…"…如果我不会每天都有“完美的婚礼”，那就是========</p><p id="734a" class="iv iw kz ix b iy iz ja jb jc jd je jf la jh ji jj lb jl jm jn lc jp jq jr js hb bi translated">这是钱德勒会说的话:" " " "罗斯，当我回顾" "我们在一起的时光…"…我会在芫荽叶酱里谈论我自己…"</p></blockquote><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/54003f0a37f0349d3512ba99ab637b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-sI99tKAGgD49NARj71MA.png"/></div></div></figure><figure class="kl km kn ko fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/756e7a38b6e7356eb35ee6875967d16f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZfT5cT68eTUoxhfWysu0IQ.png"/></div></div></figure><p id="2987" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果非常好，但如果您将步骤数设置为较高的数字，模型会更好，效果会更好。我没有这方面的硬件，所以只能用我现有的硬件。</p><p id="d37f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你喜欢这篇文章，请考虑在medium上关注我，它确实对我帮助很大。T3】</p><p id="720c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">关于Colab笔记本，请点击此处:</p><div class="jt ju ez fb jv jw"><a href="https://colab.research.google.com/drive/1tjnkyzBSCvqEMtjJsn6kT3QLYnhZDTAY?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">Chandler_Bing_AI.ipynb</h2><div class="kd l"><h3 class="bd b fi z dy kb ea eb kc ed ef dx translated">Eeman_Majumder</h3></div><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">colab.research.google.com</p></div></div><div class="kf l"><div class="le l kh ki kj kf kk io jw"/></div></div></a></div><p id="938a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更多内容请查看我的github:</p><div class="jt ju ez fb jv jw"><a href="https://github.com/Eeman1113/Chandler-Bing-Deep-Learning-AI" rel="noopener  ugc nofollow" target="_blank"><div class="jx ab dw"><div class="jy ab jz cl cj ka"><h2 class="bd hj fi z dy kb ea eb kc ed ef hh bi translated">GitHub-eeman 1113/Chandler-Bing-深度学习-AI</h2><div class="ke l"><p class="bd b fp z dy kb ea eb kc ed ef dx translated">github.com</p></div></div><div class="kf l"><div class="lf l kh ki kj kf kk io jw"/></div></div></a></div><p id="0c79" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请在twitter上关注我的每日AIML研究动态:</p><figure class="kl km kn ko fd ij"><div class="bz dy l di"><div class="lg kq l"/></div></figure><p id="8bc1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读😁，下周见👋🏼</p></div></div>    
</body>
</html>
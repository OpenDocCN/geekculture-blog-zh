<html>
<head>
<title>Pod Security Admission Controller — Namespace Level</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pod安全准入控制器—名称空间级别</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/pod-security-admission-controller-namespace-level-52158281d918?source=collection_archive---------2-----------------------#2022-12-24">https://medium.com/geekculture/pod-security-admission-controller-namespace-level-52158281d918?source=collection_archive---------2-----------------------#2022-12-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="d066" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">如何在命名空间级别应用pod安全性概述</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f15a3efbfb5974b7e6c28010aad0992a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7DhVxBWLKw_5M_jP"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Photo by <a class="ae jn" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alina Grubnyak</a> on <a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="4d56" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">准入控制器</h2><p id="4ddc" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">一个<a class="ae jn" href="https://faun.pub/kubernetes-admission-controller-2913a5b3d0c1" rel="noopener ugc nofollow" target="_blank"> <strong class="ko hj"> <em class="lf">准入控制器</em> </strong> </a> <strong class="ko hj"> <em class="lf"> </em> </strong>是一段代码，它在对象持久化之前，但是在请求被认证和授权之后，拦截对Kubernetes API服务器的请求。<br/>了解更多— <strong class="ko hj"> </strong> <a class="ae jn" href="https://faun.pub/kubernetes-admission-controller-2913a5b3d0c1" rel="noopener ugc nofollow" target="_blank"> <strong class="ko hj">入院控制器</strong> </a></p><h2 id="1989" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Pod安全策略→ Pod安全准入控制器</h2><p id="0700" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">之前有<strong class="ko hj"> PodSecurityPolicy (PSP) </strong>但是从Kubernetes v1.21开始，<strong class="ko hj"> PodSecurityPolicy </strong>被<a class="ae jn" href="https://kubernetes.io/blog/2021/04/08/kubernetes-1-21-release-announcement/#podsecuritypolicy-deprecation" rel="noopener ugc nofollow" target="_blank">弃用</a>并且<strong class="ko hj">在<strong class="ko hj"> v1.25 </strong>中从Kubernetes中移除</strong>。</p><p id="39d3" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated"><strong class="ko hj">从1.23版开始→ </strong>默认启用PodSecurity准入功能。1.23版之前的<br/><strong class="ko hj">→</strong>需要手动启用PodSecuirty许可。</p><h2 id="da95" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Pod安全准入控制器相对于Pod安全策略准入控制器的优势</h2><p id="8c11" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">PSP的一个问题是很难在粒度级别上申请限制性权限，因此不可避免地增加了安全风险。当创建pod的请求被提交到集群时，PSP被应用，没有办法将PSP应用到已经在集群中运行的pod。</p><p id="68c1" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">我们可以使用Pod安全准入控制器来代替PSP准入控制器。它可以应用于命名空间级别，也可以应用于集群级别。</p><p id="b1ce" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">Pod安全准入控制器使用Pod安全标准，可假设为三种精确预定义的Pod安全策略(<em class="lf">特权、基线、</em>和<em class="lf">受限</em>)。</p><p id="7e15" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">在下一节中，我们将讨论如何通过利用pod安全准入控制器在名称空间级别上应用pod安全标准。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h2 id="a544" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">在命名空间级别应用Pod安全性</h2><p id="8f99" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">正如我们已经讨论过的，我们可以在名称空间级别应用pod安全性。为此，我们必须在名称空间定义中添加一些标签，以便一个名称空间能够响应我们的需求。以下是将附加到我们的名称空间的标签。</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="f495" class="jo jp hi lt b fi lx ly l lz ma"># Mandatory<br/>pod-security.kubernetes.io/<strong class="lt hj">&lt;MODE&gt;</strong>: <strong class="lt hj">&lt;LEVEL&gt; </strong></span><span id="9c28" class="jo jp hi lt b fi mb ly l lz ma"># Optional     <strong class="lt hj">   </strong><br/>pod-security.kubernetes.io/<strong class="lt hj">&lt;MODE&gt;</strong>-version: <strong class="lt hj">&lt;VERSION&gt;</strong></span></pre><p id="d1cb" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">为了在特定的名称空间上启用pod安全效果，我们可以附加两个标签。一个是强制的，另一个是可选的。</p><p id="a6fd" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">在上面的标签中，有几个占位符。如— <code class="du mc md me lt b"><strong class="ko hj">&lt;MODE&gt;</strong></code> <strong class="ko hj">、</strong> <code class="du mc md me lt b"><strong class="ko hj">&lt;LEVEL&gt;</strong></code> <strong class="ko hj"> </strong>和<code class="du mc md me lt b"> <strong class="ko hj">&lt;VERSION&gt;</strong></code> <strong class="ko hj">。</strong>接下来，我们将讨论应该放置什么来代替这些占位符。</p><h2 id="6f0c" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">pod安全标准</h2><p id="59bc" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated"><code class="du mc md me lt b"><strong class="ko hj">LEVEL :</strong></code> <strong class="ko hj"> </strong>代替<code class="du mc md me lt b"><strong class="ko hj">&lt;LEVEL&gt;</strong></code>，我们必须定义<strong class="ko hj"> pod安全标准之一</strong>。目前，有三种pod安全标准可用。</p><blockquote class="mf mg mh"><p id="89bd" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ●特权级— </em> </strong> <em class="hi">无限制策略，提供尽可能广泛的权限级别。</em></p><p id="a1d2" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ●基线— </em> </strong> <em class="hi">防止已知权限升级的最低限制性策略。有一个</em> <a class="ae jn" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/#baseline" rel="noopener ugc nofollow" target="_blank"> <em class="hi">综合列表</em> </a> <em class="hi">列出了应该实施或禁止的控制。例如，如果我们想要在标记为名称空间的基线中创建一个pod，那么必须禁止特权pod。</em></p><p id="ddd8" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ●受限— </em> </strong> <em class="hi">严格受限策略，该策略的主要目的是遵循当前的pod强化最佳实践。类似于基线标准，有一个</em> <a class="ae jn" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted" rel="noopener ugc nofollow" target="_blank"> <em class="hi">控制列表</em> </a> <em class="hi">应该被强制或禁止。例如，任何容器都不能有根用户权限。容器必须以非根用户身份运行。</em></p></blockquote><h2 id="4635" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">准入控制模式</h2><p id="3db5" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">如前所述，Kubernetes<strong class="ko hj"/><a class="ae jn" href="https://kubernetes.io/docs/concepts/security/pod-security-standards/" rel="noopener ugc nofollow" target="_blank"><strong class="ko hj">Pod安全标准</strong> </a>为Pod定义了不同的隔离级别。这些标准让我们定义如何以一种清晰、一致的方式限制pod的行为。</p><p id="29c3" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">Kubernetes提供了一个内置的<em class="lf"> Pod安全</em>准入控制器来执行Pod安全标准。我们可以配置名称空间来定义我们希望在每个名称空间中用于pod安全性的准入控制<code class="du mc md me lt b"><strong class="ko hj">MODE</strong></code>。目前，有三种模式可用。讨论如下—</p><blockquote class="mf mg mh"><p id="a255" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ● enforce — </em> </strong> <em class="hi">违反政策将导致pod被拒绝。</em></p><p id="a1aa" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ●审计— </em> </strong> <em class="hi">违反策略会触发向</em> <a class="ae jn" href="https://kubernetes.io/docs/tasks/debug/debug-cluster/audit/" rel="noopener ugc nofollow" target="_blank"> <em class="hi">审计日志</em> </a> <em class="hi">中记录的事件添加审计注释，但在其他情况下是允许的。</em></p><p id="19d3" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><strong class="ko hj"> <em class="hi"> ●警告— </em> </strong> <em class="hi">违反策略将触发面向用户的警告，但在其他情况下是允许的。</em></p></blockquote><p id="df50" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated"><code class="du mc md me lt b"><strong class="ko hj">VERSION :</strong></code> <strong class="ko hj"> </strong>版本必须是有效的Kubernetes次要版本，或“最新”版本。此标签将Pod安全策略的版本固定为定义的版本。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><h2 id="a0c1" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">游戏攻略</h2><p id="09e7" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">创建一个名为<em class="lf"> baseline-ns-1 </em>的新命名空间，并用以下标签对其进行标记:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="c8cc" class="jo jp hi lt b fi lx ly l lz ma"><strong class="lt hj">$</strong> kubectl create ns baseline-ns-1</span><span id="8f55" class="jo jp hi lt b fi mb ly l lz ma"><strong class="lt hj"># Add labels</strong></span><span id="5c06" class="jo jp hi lt b fi mb ly l lz ma"><strong class="lt hj">$</strong> kubectl label ns baseline-ns-1 \<br/>&gt; pod-security.kubernetes.io/enforce=baseline \<br/>&gt; pod-security.kubernetes.io/enforce-version=v1.25</span></pre><p id="e495" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">创建命名空间并应用标签后，pod清单文件如下所示:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="222c" class="jo jp hi lt b fi lx ly l lz ma">apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>  creationTimestamp: "2022-11-08T09:26:17Z"<br/><strong class="lt hj">  labels:</strong><br/>    kubernetes.io/metadata.name: baseline-ns-1<br/><strong class="lt hj">    pod-security.kubernetes.io/enforce: baseline<br/>    pod-security.kubernetes.io/enforce-version: v1.25</strong><br/><strong class="lt hj">  name: baseline-ns-1</strong><br/>  resourceVersion: "4779"<br/>  uid: 2a8708f3-6f25-4cfb-84c1-ef6c825e23c5<br/>spec:<br/>  finalizers:<br/>  - kubernetes<br/>status:<br/>  phase: Active</span></pre><p id="2ebd" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">由于我们贴有“<strong class="ko hj">强制</strong>模式”和“<strong class="ko hj">基线</strong>pod安全标准”的标签，如果一个pod不符合“<strong class="ko hj">基线</strong>标准，它将被拒绝。让我们使用以下pod清单在<em class="lf"> baseline-ns-1 </em>名称空间中创建一个pod:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="0036" class="jo jp hi lt b fi lx ly l lz ma"># pod-1.yaml</span><span id="ffdb" class="jo jp hi lt b fi mb ly l lz ma">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  labels:<br/>    run: pod-1<br/>  name: pod-1<br/>  namespace: baseline-ns-1<br/>spec:<br/>  containers:<br/>  - image: nginx<br/>    name: pod-1<br/><strong class="lt hj">    securityContext:<br/>       privileged: true</strong></span></pre><p id="607c" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">在应用上述pod清单创建pod后，将发出以下命令:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="3b1c" class="jo jp hi lt b fi lx ly l lz ma">Error from server (Forbidden): error when creating "pod-1.yaml": <strong class="lt hj">pods "pod-1" is forbidden: violates PodSecurity "baseline:v1.25": privileged (container "pod-1" must not set securityContext.privileged=true)</strong></span></pre><p id="8041" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">出现错误是因为在pod定义中我们定义了一个<strong class="ko hj">security context . privileged = true</strong>。这违反了<em class="lf">基线-ns-1 </em>名称空间的<em class="lf"> Pod安全性</em>标准。</p><p id="aecc" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">现在，有两种方法可以将我们的pod部署到<em class="lf"> baseline-ns-1 </em>名称空间中。要么我们必须将名称空间标签修改为“<strong class="ko hj"> warn </strong>或“<strong class="ko hj"> audit </strong>”，要么我们可以从pod清单中删除<em class="lf"> </em> <strong class="ko hj"> <em class="lf">特权</em> </strong>权限。</p><p id="b133" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">让我们将pod安全准入控制器模式更改为“<strong class="ko hj">警告</strong>，而不是“<strong class="ko hj">强制</strong>”</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="ca9c" class="jo jp hi lt b fi lx ly l lz ma">apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>  creationTimestamp: "2022-11-08T09:26:17Z"<br/><strong class="lt hj">  </strong>labels:<br/>    kubernetes.io/metadata.name: baseline-ns-1<br/>    pod-security.kubernetes.io/<strong class="lt hj">warn</strong>: baseline<strong class="lt hj"><br/>    </strong>pod-security.kubernetes.io/<strong class="lt hj">warn</strong>-version: v1.25<br/>  name: baseline-ns-1<br/>  resourceVersion: "4779"<br/>  uid: 2a8708f3-6f25-4cfb-84c1-ef6c825e23c5<br/>spec:<br/>  finalizers:<br/>  - kubernetes<br/>status:<br/>  phase: Active</span></pre><p id="20a2" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">然后应用相同的pod清单文件在<em class="lf"> baseline-ns-1 </em>名称空间上创建一个pod。应用pod清单后，将会创建pod，但由于pod清单仍然违反pod安全标准，将会出现如下警告消息:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="683e" class="jo jp hi lt b fi lx ly l lz ma"><strong class="lt hj">Warning: </strong><em class="lf">would violate PodSecurity "baseline:v1.25": privileged </em>(container "pod-1" must not set securityContext.privileged=true)<br/>pod/pod-1 created</span></pre><h2 id="0e67" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">同时应用多个Pod安全标准:</h2><p id="68e7" class="pw-post-body-paragraph km kn hi ko b kp kq ij kr ks kt im ku jz kv kw kx kd ky kz la kh lb lc ld le hb bi translated">如果需要，我们可以使用多个pod安全标准和一个名称空间。下面是一个名为<strong class="ko hj"><em class="lf">baseline-ns-2</em></strong><em class="lf"/>的名称空间的例子，它标有不同的pod安全标准组合。使用以下清单创建新的命名空间:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="d156" class="jo jp hi lt b fi lx ly l lz ma">apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>  name: baseline-ns-2<br/>  labels:<br/>   <strong class="lt hj"> </strong># <strong class="lt hj"><em class="lf">baseline </em></strong>Standard with <strong class="lt hj"><em class="lf">enforce </em></strong>Mode </span><span id="0b81" class="jo jp hi lt b fi mb ly l lz ma">    pod-security.kubernetes.io/enforce: baseline<br/>    pod-security.kubernetes.io/enforce-version: v1.25</span><span id="e30b" class="jo jp hi lt b fi mb ly l lz ma">    # <strong class="lt hj"><em class="lf">restricted </em></strong>Standard with <strong class="lt hj"><em class="lf">warn </em></strong>Mode</span><span id="d02e" class="jo jp hi lt b fi mb ly l lz ma">    pod-security.kubernetes.io/warn: restricted<br/>    pod-security.kubernetes.io/warn-version: v1.25</span></pre><p id="c761" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">上面定义的清单定义了一个名称空间<strong class="ko hj"><em class="lf">baseline-ns-2</em></strong><em class="lf"/>，它将</p><p id="24ed" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">●阻止任何不满足<code class="du mc md me lt b">baseline</code>策略要求的pod。</p><p id="4bd6" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">●为任何不符合<code class="du mc md me lt b">restricted</code>策略要求的已创建pod生成面向用户的警告。</p><p id="ef37" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">●将<code class="du mc md me lt b">baseline</code>和<code class="du mc md me lt b">restricted</code>策略的版本固定为v1.25</p><p id="bca4" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated"><strong class="ko hj">具有root权限的容器:</strong>下面是一个具有<strong class="ko hj"> <em class="lf"> nginx </em> </strong>容器的pod的清单，它将作为Root用户运行。让我们使用下面的清单创建一个pod，看看<strong class="ko hj"><em class="lf">baseline-ns-2</em></strong>名称空间的pod安全标准是如何反应的。</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="f0f3" class="jo jp hi lt b fi lx ly l lz ma"># pod-2.yaml</span><span id="a9e8" class="jo jp hi lt b fi mb ly l lz ma">apiVersion: v1<br/>kind: Pod<br/>metadata:<br/>  name: pod-2<br/>  namespace: baseline-ns-2<br/>spec:<br/>  containers:<br/>  - name: pod-2<br/>    image: nginx<br/><strong class="lt hj">    securityContext:<br/>      runAsUser: 0</strong></span></pre><p id="779c" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">应用上述清单后，将创建一个新的pod，因为它不违反<strong class="ko hj">基线</strong>标准，但它违反<strong class="ko hj">限制</strong>标准。尽管它违反了<strong class="ko hj">受限</strong>标准，还是创建了一个pod。为什么？因为受限标准处于警告模式。这就是为什么它会在pod创建过程中抛出警告消息。警告消息应该是这样的:</p><pre class="iy iz ja jb fd ls lt lu lv aw lw bi"><span id="7fd2" class="jo jp hi lt b fi lx ly l lz ma"><strong class="lt hj">Warning:</strong> would violate PodSecurity "restricted:v1.25": allowPrivilegeEscalation != false (container "pod-2" must set securityContext.allowPrivilegeEscalation=false), unrestricted capabilities (container "pod-2" must set securityContext.capabilities.drop=["ALL"]), <strong class="lt hj">runAsNonRoot != true (pod or container "pod-2" must set securityContext.runAsNonRoot=true</strong>), runAsUser=0 (container "pod-2" must not set runAsUser=0), seccompProfile (pod or container "pod-2" must set securityContext.seccompProfile.type to "RuntimeDefault" or "Localhost")</span></pre><p id="64a0" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated">在下一篇文章中，我们将讨论如何在集群级别实施pod安全标准。</p><p id="dd82" class="pw-post-body-paragraph km kn hi ko b kp lg ij kr ks lh im ku jz li kw kx kd lj kz la kh lk lc ld le hb bi translated"><strong class="ko hj">接下来:</strong> <a class="ae jn" rel="noopener" href="/faun/pod-security-admission-controller-cluster-level-bda83b80d916"> <strong class="ko hj"> Pod安全准入控制器—集群级</strong> </a></p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><blockquote class="mf mg mh"><p id="fe48" class="km kn lf ko b kp lg ij kr ks lh im ku mi li kw kx mj lj kz la mk lk lc ld le hb bi translated"><em class="hi">如果你觉得这篇文章很有帮助，请点击</em> <strong class="ko hj"> <em class="hi">跟随</em> </strong> <em class="hi">👉</em> <strong class="ko hj"> <em class="hi"> </em> </strong> <em class="hi">和</em> <strong class="ko hj"> <em class="hi">拍手</em> </strong> <em class="hi">👏</em> <strong class="ko hj"> <em class="hi"> </em> </strong> <em class="hi">按钮帮助我写更多这样的文章。<br/>谢谢🖤 </em></p></blockquote><h2 id="21ea" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">👉所有关于Linux的文章</h2><div class="ml mm ez fb mn"><div role="button" tabindex="0" class="ab bv ff cb dy mo mp bn mq jh mr"><div class="ms l"><div class="ab q"><div class="l di"><img alt="Md Shamim" class="l de bw mt mu du" src="../Images/b46bdc53005abde6c6cb3e8ff0c200c3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*Hqd8Xz1WHsoL1s2To3awnA.png"/><div class="dr bw l mt mu ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" rel="noopener follow" target="_top" href="/@shamimice03?source=post_page-----52158281d918--------------------------------"> Md沙米姆</a></p></div></div><div class="mx my fg l"><h2 class="bd hj sk sl dy sm ea eb sn ed ef hh bi translated">所有关于Linux的文章</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi so au sp sq sr pn ss an fx fy st su sv gb gc gd de bk ge" rel="noopener follow" target="_top" href="/@shamimice03/list/all-articles-on-linux-1339e15e3304?source=post_page-----52158281d918--------------------------------">View list</a></div><div class="sw l dw"><span class="bd b fp z dx">12 stories</span></div></div></div><div class="nk dh nl dy ab nm dw di"><div class="di nc bv nd ne"><div class="dh l"><img alt="" class="dh" src="../Images/259cf1a3ab76526a3f714f7cbaffac3d.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*G7yx3xB6zA_6GXrSu3ZWVA.png"/></div></div><div class="di nc bv nf ng nh"><div class="dh l"><img alt="" class="dh" src="../Images/985a8b8ce1f1090a033d94ee7ac5f4fd.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*SoRvlTzozcRF9cua"/></div></div><div class="di bv ni nj nh"><div class="dh l"><img alt="" class="dh" src="../Images/d917609dcb8b45812e60ccd8bf2ed277.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*AcbQlR9WFnBxlLpV"/></div></div></div></div></div><h2 id="9e84" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">👉关于Kubernetes的所有文章</h2><div class="ml mm ez fb mn"><div role="button" tabindex="0" class="ab bv ff cb dy mo mp bn mq jh mr"><div class="ms l"><div class="ab q"><div class="l di"><img alt="Md Shamim" class="l de bw mt mu du" src="../Images/b46bdc53005abde6c6cb3e8ff0c200c3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*Hqd8Xz1WHsoL1s2To3awnA.png"/><div class="dr bw l mt mu ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" rel="noopener follow" target="_top" href="/@shamimice03?source=post_page-----52158281d918--------------------------------"> Md沙米姆</a></p></div></div><div class="mx my fg l"><h2 class="bd hj sk sl dy sm ea eb sn ed ef hh bi translated">关于Kubernetes的所有文章</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi so au sp sq sr pn ss an fx fy st su sv gb gc gd de bk ge" rel="noopener follow" target="_top" href="/@shamimice03/list/all-articles-on-kubernetes-7ae1a0f96f3b?source=post_page-----52158281d918--------------------------------">View list</a></div><div class="sw l dw"><span class="bd b fp z dx">24 stories</span></div></div></div><div class="nk dh nl dy ab nm dw di"><div class="di nc bv nd ne"><div class="dh l"><img alt="" class="dh" src="../Images/f1050aa27a3ef03122558b1ba1de1f58.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*7DhVxBWLKw_5M_jP"/></div></div><div class="di nc bv nf ng nh"><div class="dh l"><img alt="" class="dh" src="../Images/f1c4131e92176033bce05392de197205.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*AkrEbqlA_j76u2I5Tm8npg.png"/></div></div><div class="di bv ni nj nh"><div class="dh l"><img alt="" class="dh" src="../Images/27d4385154af67764cf37713dbbdc38e.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*98RmgcHgM1cyOobu"/></div></div></div></div></div><h2 id="d2a9" class="jo jp hi bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">👉所有关于头盔的文章</h2><div class="ml mm ez fb mn"><div role="button" tabindex="0" class="ab bv ff cb dy mo mp bn mq jh mr"><div class="ms l"><div class="ab q"><div class="l di"><img alt="Md Shamim" class="l de bw mt mu du" src="../Images/b46bdc53005abde6c6cb3e8ff0c200c3.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*Hqd8Xz1WHsoL1s2To3awnA.png"/><div class="dr bw l mt mu ds n aw dt"/></div><div class="gg l dw"><p class="bd b fp z dy dz ea eb ec ed ee ef dx translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" rel="noopener follow" target="_top" href="/@shamimice03?source=post_page-----52158281d918--------------------------------"> Md沙米姆</a></p></div></div><div class="mx my fg l"><h2 class="bd hj sk sl dy sm ea eb sn ed ef hh bi translated">HelmーSeries</h2></div><div class="ab q"><div class="l dw"><a class="bd b be z bi so au sp sq sr pn ss an fx fy st su sv gb gc gd de bk ge" rel="noopener follow" target="_top" href="/@shamimice03/list/helmseries-6e2076d48ba8?source=post_page-----52158281d918--------------------------------">View list</a></div><div class="sw l dw"><span class="bd b fp z dx">11 stories</span></div></div></div><div class="nk dh nl dy ab nm dw di"><div class="di nc bv nd ne"><div class="dh l"><img alt="" class="dh" src="../Images/9ba5df61339b6f5d2ad01696050835e3.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*3NGLzkzV47jeWMX8"/></div></div><div class="di nc bv nf ng nh"><div class="dh l"><img alt="" class="dh" src="../Images/74e4f8812ce0aceba2616e176b3021c2.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*wzqjRqAlMOjlwt7x"/></div></div><div class="di bv ni nj nh"><div class="dh l"><img alt="" class="dh" src="../Images/a734d6746ba78eda4d8d1347c4231bae.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*6RKJMoeEspoXyjGN"/></div></div></div></div></div></div></div>    
</body>
</html>
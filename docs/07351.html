<html>
<head>
<title>Working with Time and Date in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中处理时间和日期</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/working-with-time-and-date-in-python-6cce748f90f5?source=collection_archive---------11-----------------------#2021-09-15">https://medium.com/geekculture/working-with-time-and-date-in-python-6cce748f90f5?source=collection_archive---------11-----------------------#2021-09-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4fd647019ff356f621fa915b37b6e945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vshzf-TcXKmzAIXI"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@towfiqu999999?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Towfiqu barbhuiya</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9ed1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我经常要做的事情之一是处理包括时间在内的各种形式的数据。我认为这对于每个人来说都是有益的，因为有时改变你的时间或日期格式是强制性的。例如，您可能正在分析来自温度或湿度传感器的时间序列数据，或者您可能正在查看一些公司销售报告信息，或者您正在记录您的个人开支。用例实际上并不重要，您总是需要处理时间和日期来正确地表示在某个时间点发生的信息。因此，在这篇文章中，我将分享一些最常见的时间和日期操作，你可以在Python中完成。</p><h1 id="eac6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">获取当前时间和日期</strong></h1><p id="3e12" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">要开始在python中处理时间和日期，您需要将datetime模块导入到代码中:</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="9ef8" class="lf ju hi lb b fi lg lh l li lj">import datetime</span></pre><p id="1e6f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，你可以很容易地得到当前的时间和日期</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="8045" class="lf ju hi lb b fi lg lh l li lj">current_time = datetime.datetime.now()<br/>print(current_time)</span></pre><p id="146d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在运行此示例的过程中，我收到了下面提供的响应:</p><p id="dfac" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="86ed" class="lf ju hi lb b fi lg lh l li lj">2021-09-12 22:11:15.327779</span></pre><p id="019f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如您所见，返回的响应格式为<strong class="ix hj"> <em class="lk">年-月-日小时:分钟:秒。毫秒</em>。</strong>需要注意的是<strong class="ix hj"> <em class="lk"> now() </em> </strong>方法返回一个时间的本地日期和时间，这样完全取决于你所在的位置。另外，您可以将一个timezone参数传递给<em class="lk"/><strong class="ix hj"><em class="lk">now()</em></strong>方法，这样您就可以接收UTC格式的时间和日期。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="7ef3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e8e5" class="lf ju hi lb b fi lg lh l li lj">2021-09-12 22:19:38.959631<br/>2021-09-12 19:19:38.959631+00:00</span></pre><p id="ef7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如你在我的例子中看到的，UTC时间比我的本地时间少3个小时。</p><p id="3685" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">很多时候你不需要拥有毫秒级的信息，所以你可以直接使用<strong class="ix hj"><em class="lk">【split()】</em></strong>的方法。需要注意的是，<strong class="ix hj"><em class="lk">datetime . datetime . now()</em></strong><em class="lk"/>返回的对象是一个<em class="lk"/><strong class="ix hj"><em class="lk">datetime</em></strong><em class="lk"/>类，<em class="lk"> s </em> o如果要应用<em class="lk"> </em> <strong class="ix hj"> <em class="lk"> split()，就必须将其转换为一个字符串。</em>T45】</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ffdf" class="lf ju hi lb b fi lg lh l li lj">current_time_without_ms = str(datetime.datetime.now()).split('.')[0]<br/>print(current_time_without_ms)</span></pre><p id="3796" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在运行这个示例的过程中，我收到了下面提供的响应。</p><p id="089c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="6882" class="lf ju hi lb b fi lg lh l li lj">2021-09-12 22:30:17</span></pre><p id="d472" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的代码示例中需要<strong class="ix hj"><em class="lk">【0】</em></strong>的原因是因为应用后，<strong class="ix hj"> <em class="lk"> split()，</em> </strong>响应将是一个字符串对象列表<em class="lk"> s. </em>如本例所示，结果如下所示。</p><p id="8e10" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="07c8" class="lf ju hi lb b fi lg lh l li lj">['2021-09-12 22:30:017', '193881']</span></pre><p id="41ca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我们只需要列表中的第一个元素。</p><h1 id="af89" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">检索单独的数据字段</strong></h1><p id="a076" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">现在使用同一个<strong class="ix hj"> <em class="lk"> current_time </em> </strong>对象，我们可以分别检索各个字段。我认为下面的代码是不言自明的。请注意，打印的结果使用python f-string，这需要一些字符串格式才能很好地显示结果。下面提供了代码示例。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="6781" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="852c" class="lf ju hi lb b fi lg lh l li lj">2021-09-13 18:06:04</span></pre><h1 id="3982" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">使用时间戳</h1><p id="098d" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">你可能遇到的另一件事是Unix时间戳。您还可以听到一些不同的名称，其中一个很常见的名称是Posix timestamp，但实际上意思是相同的。在物联网行业中，各种设备向服务器发送时间戳信息而不是纯日期和时间是很常见的，因为它占用更少的空间。所以Unix时间戳就是自1970年1月1日00:00:00 UTC以来经过的秒数。知道这一点就足以处理Python中的时间戳了。</p><p id="4a89" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">例如，您想将UTC时间2021–09–10 16:54:23转换为时间戳？</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="92f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="1330" class="lf ju hi lb b fi lg lh l li lj">1631292863.0</span></pre><p id="793b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果您想进行时间和日期的转换，可以使用<strong class="ix hj"><em class="lk">fromtimestamp()</em></strong>方法:</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="86c3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b4e2" class="lf ju hi lb b fi lg lh l li lj">2021-09-10 16:54:23+00:00</span></pre><p id="e837" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您所看到的，使用datetime模块处理时间戳非常简单。</p><p id="84c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">实际上有一个很酷的网站，我在处理时间戳时经常使用。您可以将时间和日期转换成时间戳，反之亦然，还可以做更多的事情。你可以随时复查你的计算是否正确:<a class="ae iu" href="https://www.epochconverter.com/" rel="noopener ugc nofollow" target="_blank">https://www.epochconverter.com/</a></p><h1 id="fb51" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">计算时差</h1><p id="cc3c" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">另一件很常见的事情是，如果我们给时间对象减去或加上某种值，就可以找出过去的日期和时间(或者未来的日期和时间)。也就是说<strong class="ix hj"> <em class="lk"> timedelta() </em> </strong>方法开始起作用。比方说，你有一个特定的日期，例如<strong class="ix hj"><em class="lk">2021–08–10 17:45:00</em></strong>并且你想知道，如果你加上或减去特定的天数、小时数等，那么这个日期和时间是未来的还是过去的。下面的代码示例演示了如何做到这一点。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="78c1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="f684" class="lf ju hi lb b fi lg lh l li lj">2021-08-06 15:32:00<br/>2021-08-12 21:07:00</span></pre><p id="b677" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="lk"> strptime() </em> </strong>方法用于从保存时间和日期信息的字符串创建datetime对象，在本例中为<strong class="ix hj"><em class="lk">start _ time _ and _ date</em></strong>。</p><p id="35cc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，如果你想知道确切的日期和时间，你可以这样做，但是如果你想知道两个日期或时间戳之间的差异，比如说天/小时/分钟/秒呢？这也可以实现。让我们从前面的例子中得到结果，并找出<strong class="ix hj"><em class="lk">2021–08–12 21:07:00</em></strong>和<strong class="ix hj"><em class="lk">2021–08–06 15:32:00</em></strong>之间的区别</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="2acc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="f27d" class="lf ju hi lb b fi lg lh l li lj">6 days, 5:35:00</span></pre><p id="e84d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如您所看到的，我们已经很容易地计算出两个datetime对象之间的差异。</p><h1 id="238a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">了解strftime()和strptime()方法</h1><p id="126a" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这里最后要说的就是这两种方法。它们在datetime模块中提供，其用途是方便地将datetime对象转换为字符串，反之亦然。现在我不打算深入探讨所有的格式化可能性，但是它们在python文档中有很好的描述，您可以在下面的文章中找到:</p><div class="ln lo ez fb lp lq"><a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">日期时间-基本日期和时间类型- Python 3.9.7文档</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">模块只提供一个具体的类，即类。该类可以表示简单的时区，具有固定的…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">docs.python.org</p></div></div></div></a></div><p id="dbff" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">无论如何，我会给你看几个例子。假设您需要创建一个包含日期字符串的datetime对象。现在，这些字符串可以有各种格式，这就是为什么你需要一个格式化字符串，以便日期时间模块可以正确解析你的输入。下面举例说明了<strong class="ix hj"> <em class="lk"> strptime() </em> </strong>方法的用法</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="a183" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4f9c" class="lf ju hi lb b fi lg lh l li lj">2021-08-06 16:00:00<br/>2021-08-06 16:00:00<br/>2021-08-06 16:00:00<br/>2021-08-06 16:00:00<br/>2021-08-06 16:00:00</span></pre><p id="e9b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从示例中可以看出，所有情况下的输出都是相同的。这是因为我们向<strong class="ix hj"><em class="lk">strptime()</em></strong><em class="lk">提供了日期和时间字符串的精确格式。</em></p><p id="f3c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以反过来使用与<strong class="ix hj"> <em class="lk"> strftime() </em> </strong>相同的逻辑，这将允许我们从datetime对象中获取一个字符串。为了更好地直观理解，我将使用相同的<strong class="ix hj"><em class="lk">2021–08–06 16:00:00</em></strong>值</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="ll lm l"/></div></figure><p id="5388" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="49f0" class="lf ju hi lb b fi lg lh l li lj">2021-08-06 16:00:00<br/>2021/08/06 16/00/00<br/>06 August 21 - 16:00:00<br/>06 August 21 - 04 PM<br/>Aug 2021, 06 / 04 PM</span></pre><p id="2f0d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我上面提供的文档链接中，你可以找到其他的格式化选项，但是我希望你能够了解这两种方法是如何工作的，以及何时如何使用它们。</p><h1 id="1d92" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="2270" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在python中，处理时间和日期是一项非常常见的任务。本教程展示了理解如何使用python中的datetime模块来简化日常工作中处理时间序列数据的基础知识。</p><p id="5614" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经将这里使用的所有例子上传到我的github库。有一点我想提一下，实际上这个模块叫做datetime。但是使用的类也叫datetime。这就是为什么在代码中你会看到</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="ffb8" class="lf ju hi lb b fi lg lh l li lj">import datetime as dt<br/>from datetime import datetime</span></pre><p id="796e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这样做是为了更方便地访问datetime类方法，因此，例如，您可以编写<strong class="ix hj"><em class="lk">current _ time = datetime . datetime . now()</em></strong>，而不是<strong class="ix hj"> <em class="lk"/></strong></p><p id="8ce0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望这不会太令人困惑，但如果你有任何问题，我很乐意回答。</p><p id="d72a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">链接到github库，所有的例子都在一个地方:<a class="ae iu" href="https://github.com/vycart/datetime_tutorial" rel="noopener ugc nofollow" target="_blank">https://github.com/vycart/datetime_tutorial</a></p><p id="1219" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>
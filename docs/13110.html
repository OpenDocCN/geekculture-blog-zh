<html>
<head>
<title>How to Improve DOM Structure with React Portal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用React Portal改进DOM结构</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/how-to-improve-dom-structure-with-react-portal-6e6fe249bcc5?source=collection_archive---------4-----------------------#2022-06-18">https://medium.com/geekculture/how-to-improve-dom-structure-with-react-portal-6e6fe249bcc5?source=collection_archive---------4-----------------------#2022-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c38f833d7904d09dcdf2f937088537a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJjyhDY5-zL5aIE39psK5Q.png"/></div></div></figure><h1 id="ac9d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">这是什么？</h1><p id="1348" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">根据<a class="ae km" href="https://reactjs.org/docs/portals.html" rel="noopener ugc nofollow" target="_blank">官方React文档</a>，</p><blockquote class="kn ko kp"><p id="0672" class="jo jp kq jq b jr kr jt ju jv ks jx jy kt ku kb kc kv kw kf kg kx ky kj kk kl hb bi translated"><em class="hi">门户提供了一种一流的方式来将子组件呈现到位于父组件的DOM层次结构之外的DOM节点中。</em></p></blockquote><p id="5476" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">看一下这个例子——假设您有一个<code class="du kz la lb lc b">Calculator</code>组件，其中有一个<code class="du kz la lb lc b">Buttons</code>组件。它看起来会像这样:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/e33485dcb01b98bdcda42cf7018b4d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzM9ul2uXfOx6on8CXTIvg.png"/></div></div></figure><p id="68bf" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">根组件<code class="du kz la lb lc b">App</code>及其所有子组件将呈现在一个DOM节点中(很可能是一个id为<code class="du kz la lb lc b">#root</code>的div)。使用React Portal，可以在id为<code class="du kz la lb lc b">#root</code>的div外部呈现像<code class="du kz la lb lc b">Buttons</code>这样的子组件。您可以想象DOM的结构是这样的:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/3cdfb554ee709175cfb52e5b542d1e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yh4m79lqHX5Wun9P-7d4DQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">DOM structure after using React Portal</figcaption></figure><h1 id="db75" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">我为什么要知道这个？</h1><p id="dcc9" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">在某些情况下，有必要在根元素之外呈现一些JSX或组件。这种情况的最好例子是模态。</p><p id="3ed2" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">模态通常会覆盖整个屏幕。人们会认为这也会反映在DOM结构中。然而，React中不会发生这种情况。如果一个模态嵌套在一个组件中，这也是DOM结构看起来的样子。这可能会让使用屏幕阅读器的人感到困惑。从可访问性的角度来看，这是一个问题。</p><p id="68bc" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">在普通的JS和HTML中解决这个问题可能有点容易，但是在React中就比较难了。因为React应用程序只有一个挂载点，所以将元素或组件放在这个挂载点之外是一个挑战。有了React Portal，这变得很容易。</p><p id="2afd" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">尽管元素或组件将被<em class="kq">移植到</em>一个不同的DOM节点，但它仍将作为一个常规的React元素。这意味着我们的模态与挂载点在不同的DOM节点中。但是它仍然可以接收属性和状态，并且表现得像一个常规的嵌套React元素。</p><h1 id="bbb8" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">我如何使用它？</h1><p id="9eda" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">让我们使用上一节中的模态例子。创建React门户并将其挂载到不同的DOM节点可以分两步完成:</p><h1 id="45b3" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第一步:</h1><p id="7ce3" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">创建另一个DOM节点来挂载模型:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/ea54966d558b730a6e400db6a9430372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TSGN1zsY5VUNtL0gGuK8eg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">New div in the HTML file</figcaption></figure><p id="1a00" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">React应用程序将被挂载到id为<code class="du kz la lb lc b">#root</code>的div中。模态将被安装到id为<code class="du kz la lb lc b">#modal-root</code>的div上。</p><h1 id="ad7c" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">第二步:</h1><p id="af2d" class="pw-post-body-paragraph jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl hb bi translated">创建门户包装组件:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/60bf105a66337dd4f2bf7d7524dbbbb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fFWreaectsl-8PzE0Bz-eg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Wrapper component that implements React Portal</figcaption></figure><p id="ffee" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">这个包装器组件将接受一个子元素，并为它创建一个门户。<code class="du kz la lb lc b">useEffect</code>挂钩安装元件，并在组件卸载时进行清理。</p><p id="ba57" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">下面是它可能的样子:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/6f6d3518be01bb65173487b73c448c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBjKmaqIad6bF5wa1czBVA.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">Wrapping Modal with the wrapper component</figcaption></figure><p id="06af" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">即使<code class="du kz la lb lc b">Modal</code>组件嵌套在应用程序层次结构中，它在DOM结构中看起来也会不同:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/ea569df4d2b1db515f3609b49cb7fe51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4t_C1YmN8NUzJkr0v3evQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">DOM structure after using React Portal on Modal</figcaption></figure><p id="5224" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated">在真正的DOM结构中，你不会像这样直接看到<code class="du kz la lb lc b">Modal</code>组件，而是看到一个div。这只是一个演示。</p><h1 id="fb0d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">额外资源</h1><ol class=""><li id="9d64" class="ln lo hi jq b jr js jv jw jz lp kd lq kh lr kl ls lt lu lv bi translated"><a class="ae km" href="https://blog.logrocket.com/learn-react-portals-by-example/" rel="noopener ugc nofollow" target="_blank">本文</a>有另一个使用React门户的好用例。</li><li id="a505" class="ln lo hi jq b jr lw jv lx jz ly kd lz kh ma kl ls lt lu lv bi translated">一个<a class="ae km" href="https://malcoded.com/posts/react-portals/" rel="noopener ugc nofollow" target="_blank">对话框组件</a>也是一个很好的场景，React Portal非常方便。</li><li id="6f97" class="ln lo hi jq b jr lw jv lx jz ly kd lz kh ma kl ls lt lu lv bi translated">你需要React门户网站的推荐人吗？那么【React 16的这个解决方案可能会有帮助。</li><li id="085a" class="ln lo hi jq b jr lw jv lx jz ly kd lz kh ma kl ls lt lu lv bi translated">了解如何使用React挂钩、上下文和门户创建模态组件。</li></ol></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><p id="1752" class="pw-post-body-paragraph jo jp hi jq b jr kr jt ju jv ks jx jy jz ku kb kc kd kw kf kg kh ky kj kk kl hb bi translated"><em class="kq">原载于</em> <a class="ae km" href="https://niharraoteblog.netlify.app/guide-to-react-portals" rel="noopener ugc nofollow" target="_blank"> <em class="kq">我的</em> <em class="kq">博客</em> </a> <em class="kq">。</em></p></div></div>    
</body>
</html>
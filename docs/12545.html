<html>
<head>
<title>Creating JAX-RS RESTful APIs with Apache CXF and Tomcat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Apache CXF和Tomcat创建JAX-RS RESTful API</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/creating-jax-rs-restful-apis-with-apache-cxf-and-tomcat-c3e13f3b65c4?source=collection_archive---------3-----------------------#2022-05-18">https://medium.com/geekculture/creating-jax-rs-restful-apis-with-apache-cxf-and-tomcat-c3e13f3b65c4?source=collection_archive---------3-----------------------#2022-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/73a8b736200a386cbc26131cea8b821d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CZjkQ_2eA-JMSFsR"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/@andre_klimke?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andre Klimke</a> on <a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="758e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Apache CXF是一个开源的web服务框架，它支持多种类型的API，如JAX-RS (REST)和JAX-WS (SOAP ),以及多种传输，如HTTP和JMS。</p><p id="8387" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Apache CXF符合JAX-RS，这是一个关于在Java企业应用程序中创建RESTful APIs的Java EE规范，由JSR-311标准引入。</p><p id="c414" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">JAX-RS标准有几种实现，比如Jersey、RESTeasy，当然还有Apache CXF。</p><p id="079a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本文中，我将讨论如何使用Apache CXF创建一个简单的JAX遥感应用程序，并将其部署在Tomcat中。</p><p id="d615" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先使用您喜欢的IDE创建一个简单的空maven项目。我将使用IntelliJ的想法。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ju"><img src="../Images/1072f8c2bf06dd0f999b64c3ba3f0dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--AbHT8zVCrbTg0LmrBL5Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Creating A New Maven Project</figcaption></figure><p id="6981" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">创建maven项目后，我们需要在pom.xml中添加一些依赖项，这些依赖项将用于创建我们的web应用程序。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="2e41" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们可以看到提供JAX遥感功能的初始<code class="du kb kc kd ke b">cxf-rt-frontend-jaxrs</code>依赖关系。由于spring与Apache CXF紧密集成并在CXF内部使用，我们将使用Spring来配置JAX-RS配置，因此添加了两个Spring依赖项<code class="du kb kc kd ke b">spring-context</code>和<code class="du kb kc kd ke b">spring-web</code>。由于这个web应用程序将被部署在tomcat服务器中，因此还添加了<code class="du kb kc kd ke b">javax.servlet.servlet-api</code>依赖项。为了集成JSON支持，添加了<code class="du kb kc kd ke b">jackson-jaxrs-json-provider</code>依赖项。</p><p id="5199" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">添加完这些初始依赖项后，我们就可以开始创建基本的类结构了。在这里，我将在<code class="du kb kc kd ke b">src.main.java</code>目录下创建3个包，分别命名为<code class="du kb kc kd ke b">models</code>、<code class="du kb kc kd ke b">repositories</code>和<code class="du kb kc kd ke b">services</code>。</p><p id="0bca" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在模型包中，让我们创建一个名为Song的简单类。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="762c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了模拟数据层，让我们在<code class="du kb kc kd ke b">respositories</code>目录中创建一个SongRepository类。请注意，我们将创建一个虚拟对象，并将其直接提供给一个请求，而不是连接到一个真实的数据库，因为这将使事情复杂化。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="da2c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，让我们创建应用程序最重要的部分，服务类。这里我们将使用下面列出的标准JAX遥感注解。</p><ul class=""><li id="a6f0" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js kk kl km kn bi translated"><code class="du kb kc kd ke b">@Path</code> —表示URI路径</li><li id="c57d" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated"><code class="du kb kc kd ke b">@Consumes</code> —表示API使用给定的媒体类型</li><li id="4e3c" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated"><code class="du kb kc kd ke b">@Produces</code> —表示API使用给定的媒体类型</li><li id="b2f1" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated"><code class="du kb kc kd ke b">@GET</code> —表示获取方法。</li></ul><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><h2 id="f814" class="kt ku hi bd kv kw kx ky kz la lb lc ld jg le lf lg jk lh li lj jo lk ll lm ln bi translated">添加配置</h2><p id="139a" class="pw-post-body-paragraph iv iw hi ix b iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo ls jq jr js hb bi translated">在创建了上述简单的类结构之后，让我们添加必要的配置。这些配置将被添加到<code class="du kb kc kd ke b">src/main/resources/WEB-INF/</code>目录中。</p><p id="5e42" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为我们使用Spring来设置JAX-RS服务，所以让我们首先创建一个<code class="du kb kc kd ke b">beans.xml</code>并在其中定义我们的服务类。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="fa8a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这里，我们已经在<code class="du kb kc kd ke b">&lt;jaxrs:server&gt;</code>标签中定义了服务beans，并提供了我们服务中的单一服务。如果您有多个服务，您可以在这里将它们都列为beans。</p><p id="b73b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于我们需要为这个API添加JSON支持，我们将在这里引用之前添加的<code class="du kb kc kd ke b">JacksonJsonProvider</code>。</p><p id="90b9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们创建最终的配置，<code class="du kb kc kd ke b">web.xml</code>。我们需要首先在<code class="du kb kc kd ke b">context-param</code>标签下引用beans.xml文件来建立两个配置之间的联系。如前所述，CXF使用<a class="ae iu" href="https://cxf.apache.org/docs/configuration.html" rel="noopener ugc nofollow" target="_blank"> Spring </a>来提供服务的XML配置，所以spring <code class="du kb kc kd ke b">ContextLoaderListener</code>是通过一个监听器添加的。</p><p id="f40c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于JAX-RS规范是建立在Servlet之上的，JAX-RS的实现应该提供一个Servlet作为应用程序的入口点。这个Servlet负责请求的初始处理。在Apache CFX中，我们使用一个名为<code class="du kb kc kd ke b">CXFServlet</code>的Servlet。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="5f40" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，您的应用程序代码结构应该如下所示。</p><figure class="jv jw jx jy fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/df63415b7e82404c4fa0694298a2c4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*GwR1SjCKvHs-PDlWzTFBbA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Final Project Structure</figcaption></figure><h2 id="ffd0" class="kt ku hi bd kv kw kx ky kz la lb lc ld jg le lf lg jk lh li lj jo lk ll lm ln bi translated">包装</h2><p id="2abe" class="pw-post-body-paragraph iv iw hi ix b iy lo ja jb jc lp je jf jg lq ji jj jk lr jm jn jo ls jq jr js hb bi translated">创建代码后，我们应该将它打包成一个<code class="du kb kc kd ke b">.war</code>文件，部署在Tomcat服务器中。为此，我们需要在<code class="du kb kc kd ke b">pom.xml</code>文件中再添加两个配置。</p><ol class=""><li id="762e" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js lu kl km kn bi translated">用<code class="du kb kc kd ke b">&lt;packaging&gt;war&lt;/packaging&gt;</code>指定包装</li><li id="fe85" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js lu kl km kn bi translated">用下面的<code class="du kb kc kd ke b">maven-war-plugin</code>指定配置位置和war名称。</li></ol><pre class="jv jw jx jy fd lv ke lw lx aw ly bi"><span id="be6c" class="kt ku hi ke b fi lz ma l mb mc">&lt;build&gt;<br/>    &lt;plugins&gt;<br/>        &lt;plugin&gt;<br/>            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;<br/>            &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;<br/>            &lt;configuration&gt;<br/>                &lt;webResources&gt;<br/>                    &lt;resource&gt;<br/>                        &lt;directory&gt;src/main/resources&lt;/directory&gt;<br/>                    &lt;/resource&gt;<br/>                &lt;/webResources&gt;<br/>                &lt;warName&gt;jaxrswar&lt;/warName&gt;<br/>            &lt;/configuration&gt;<br/>        &lt;/plugin&gt;<br/>    &lt;/plugins&gt;<br/>&lt;/build&gt;</span></pre><p id="c5c5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最终的pom.xml如下所示。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="c6c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这之后，您可以在项目目录上运行<code class="du kb kc kd ke b">mvn clean install</code>,一个jaxrswar.war文件将在目标文件夹中创建。</p><p id="86d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，您应该将它部署在一个servlet-container中，为此，我将使用Apache Tomcat 9。</p><p id="1a22" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我已经创建了一个简单的Dockerfile，它将很容易地创建一个包含我们构建的war文件的docker映像。</p><figure class="jv jw jx jy fd ij"><div class="bz dy l di"><div class="jz ka l"/></div></figure><p id="bc01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将它包含在项目主文件夹中，并在终端中从该文件夹运行<code class="du kb kc kd ke b">docker build .</code>。如果构建成功，它会给你一个如下的响应。</p><pre class="jv jw jx jy fd lv ke lw lx aw ly bi"><span id="30ec" class="kt ku hi ke b fi lz ma l mb mc">Sending build context to Docker daemon  21.63MB<br/>Step 1/4 : FROM tomcat:9.0.62-jdk8<br/> ---&gt; 84d55ba5d6c1<br/>Step 2/4 : ADD target/jaxrswar.war /usr/local/tomcat/webapps/<br/> ---&gt; 5ccea8c355e3<br/>Step 3/4 : EXPOSE 8080<br/> ---&gt; Running in 67cccd7a72ef<br/>Removing intermediate container 67cccd7a72ef<br/> ---&gt; 3af35b518c31<br/>Step 4/4 : CMD ["catalina.sh", "run"]<br/> ---&gt; Running in 9403e9c69cbf<br/>Removing intermediate container 9403e9c69cbf<br/> ---&gt; 6d42782fb41e<br/>Successfully built 6d42782fb41e</span></pre><p id="9f4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，您可以复制image-id并创建一个新的容器，如下所示。</p><pre class="jv jw jx jy fd lv ke lw lx aw ly bi"><span id="2f8d" class="kt ku hi ke b fi lz ma l mb mc">docker run -p 8080:8080 6d42782fb41e</span></pre><p id="475c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你做的一切都是正确的，这一定不能给任何错误，战争应该部署成功。</p><p id="e997" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，为了测试API，您可以在浏览器中输入下面的URL。</p><pre class="jv jw jx jy fd lv ke lw lx aw ly bi"><span id="3346" class="kt ku hi ke b fi lz ma l mb mc"><a class="ae iu" href="http://localhost:8080/jaxrswar/songs/2" rel="noopener ugc nofollow" target="_blank">http://localhost:8080/jaxrswar/songs/2</a></span></pre><p id="9d8f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它应该返回一个样本JSON响应！你可以在我的Github上找到完整的项目。</p><div class="md me ez fb mf mg"><a href="https://github.com/rashm1n/CXF-JAXRS/tree/master" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">GitHub - rashm1n/CXF-JAXRS:使用Apache CXF创建RESTful JAX-RS API</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu io mg"/></div></div></a></div></div><div class="ab cl mv mw gp mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="hb hc hd he hf"><p id="0aaf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">文章到此结束，感谢您的阅读。如果您想了解更多关于JAXRS和Apache CXF的知识，请参考参考资料！干杯。如果你喜欢这篇文章，在linkedin/twitter上关注一下吧！</p><div class="md me ez fb mf mg"><a href="https://www.linkedin.com/in/rashmin95/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hj fi z dy ml ea eb mm ed ef hh bi translated">Ravindu Rashmin -软件工程师- WSO2 | LinkedIn</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">在世界上最大的职业社区LinkedIn上查看Ravindu Rashmin的个人资料。Ravindu列出了7个工作…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">www.linkedin.com</p></div></div><div class="mp l"><div class="nc l mr ms mt mp mu io mg"/></div></div></a></div><p id="c945" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考</p><ul class=""><li id="5695" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js kk kl km kn bi translated"><a class="ae iu" href="https://cxf.apache.org/docs/jax-rs.html" rel="noopener ugc nofollow" target="_blank">https://cxf.apache.org/docs/jax-rs.html</a></li><li id="377a" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated"><a class="ae iu" href="https://cxf.apache.org/docs/jaxrs-services-configuration.html#JAXRSServicesConfiguration-ConfiguringJAX-RSservicesincontainerwithSpringconfigurationfile" rel="noopener ugc nofollow" target="_blank">https://cxf . Apache . org/docs/jaxrs-services-configuration . html # JAXRSServicesConfiguration-ConfiguringJAX-rsservicesincontainerwithpspringconfigurationfile</a>。</li><li id="4d0f" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">【https://en.wikipedia.org/wiki/Apache_CXF T4】</li><li id="3bcf" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated"><a class="ae iu" href="https://www.baeldung.com/apache-cxf-rest-api" rel="noopener ugc nofollow" target="_blank">https://www.baeldung.com/apache-cxf-rest-api</a></li></ul></div></div>    
</body>
</html>
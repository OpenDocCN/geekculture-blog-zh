# B2B SaaS 集成的最佳认证方法

> 原文：<https://medium.com/geekculture/the-best-authentication-methods-for-b2b-saas-integrations-8c0272007679?source=collection_archive---------8----------------------->

![](img/0f950df1e53be5c11b1d07ce15b39143.png)

从软件开发的早期开始，*认证*(也称为 auth)就是必不可少的。为了确保系统和数据的安全性，您必须确保只有正确识别的用户才允许登录系统。

如果你正在构建本地集成，将你的 SaaS 产品连接到你的客户使用的其他应用，其中一个棘手的问题是处理第三方应用的细微差别，比如身份验证。有时您需要为自己的应用程序设置身份验证，有时您需要配置您的集成来使用已经提供的任何身份验证模式。在这两种情况下，了解用户身份验证方法的工作原理以及要寻找什么可以节省您的时间，并防止集成问题。

在与我们的客户合作的过程中，我的团队已经帮助 SaaS 团队使用基本认证、API 密钥和 Open Auth 2.0(又名 OAuth 2.0)实现了本地集成，包括 OAuth 2.0 的非规范变体。随着时间的推移，身份验证类型的偏好肯定会发生变化，基本身份验证长期以来一直是首选的方法，尽管大多数开发人员已经转而使用 API keys 和 OAuth 2.0，原因我们很快会谈到。

让我们看看这些主要的身份验证方法是如何工作的，并在[本地集成](https://prismatic.io/resources/build-vs-buy-adding-native-integrations-to-your-product/)的背景下深入了解细节。我们还将触及*授权*(访问特定资源的许可)，但这不是本文的重点。

# 了解基本身份验证方法

基本身份验证使用传统的用户名和密码方法。如上所述，这在现代 SaaS 应用程序中不再常见，但我们仍然在许多遗留系统中看到它，包括 FTP 或更老的基于 HTTP 的应用程序。

对于 HTTP 中基本 auth 的最简单用例，取用户名和密码，在它们之间放一个`:`，并使用 [base64](https://www.base64encode.org/) 对整体进行编码。然后，将整个 base-64 编码的字符串作为标头放在 HTTP 请求中:

```
curl https://example.com \
  --header *"Authorization: Basic bXl1c2VyOm15UEBzU3cwUmQ="*
```

为了确保它符合标准，总是对带有`Basic {base64 encoded username:password}`值的头使用`Authorization`前缀。

更简单的方法是将用户名和密码放在 URL 的开头:

```
curl [https://myuser:myP%40sSw0rd@example.com](https://myuser:myP%40sSw0rd@example.com)
```

然而，这种模式长期以来一直被否决，因为在任何人都可以阅读的公开场合键入凭据不是一种好的安全做法。

# 为什么 SaaS 团队使用基本认证方法进行集成

用于集成的基本身份验证的吸引力很简单:基本身份验证非常容易实现。您需要做的就是解码 base64 编码的头，并验证用户名/密码组合是否正确。就是这样。由于其简单性，当您在内部构建定制集成而不使用 API 或集成平台时，基本身份验证是有意义的。

# 使用基本身份验证方法进行集成时需要考虑的事项

虽然基本身份验证实现起来很简单，但它也有一些缺点。每个集成都获得相同的凭证，并且您不能限制凭证的范围。也就是说，您不能更改与凭据相关的授权。因此，每个集成都可以做凭证允许的任何事情。而且，如果您要更改凭证，使用它们的每个集成都需要单独更新为新的凭证。这种大量手动设置和更新凭据的方法意味着基本身份验证不适用于大规模集成。

# 了解 API 密钥认证方法

API 密钥是用于标识和认证的单个字符串，特别是对于使用 API(应用程序编程接口)的集成。基于 API 密钥的认证通常被称为*基于令牌的认证*，在现代 SaaS 应用中很常见。

要使用 API 密钥设置 auth，您的应用程序会创建一个密钥供您在集成中使用。你经常可以在*设置*或*配置*菜单下的应用程序中生成一个密钥。

HTTP 请求中的 API 键示例如下:

```
curl https://example.com \
  --header *"Authorization: Bearer mF_9.B5f-4.1JqM"*
```

您可能会注意到，该模式与我们用于基本 auth 的模式非常相似，具有`Authorization`头，但是这次使用了`Bearer {token}`值。

API 键也可以作为一些 API 的参数传入:

```
curl [https://example.com?token=mF_9.B5f-4.1JqM](https://example.com?token=mF_9.B5f-4.1JqM)
```

或者，您甚至可以为 API 键使用自定义头:

```
curl https://example.com \
  --header *"x-acme-api-key: mF_9.B5f-4.1JqM"*
```

# 为什么 SaaS 团队使用 API 密钥认证方法进行集成

尽管 API 身份验证方法比基本身份验证需要更多的设置，但它们并不难实现。通常，生成应用程序将 API 键(或这些键的散列)存储在一个表中，并将这些键与相应的用户匹配起来。

使用 API 键的一个好处是，您可以设置权限(授权)的范围，这与基本的 auth 不同。您可以设置单个令牌对特定资源进行只读访问，同时设置另一个令牌通过 API 访问所有可用的资源。因此，您可以为每个集成使用不同的令牌，即使用户更改了密码也没有关系 API 键仍然映射到该用户名。如果集成不再需要访问 API，您可以从应用程序中删除/禁用相应的 API 密钥。

如果您使用的是[嵌入式集成平台](https://prismatic.io/resources/embedded-ipaas-scalable-integration-strategy/)(也称为嵌入式 iPaaS)，那么 API 密钥是与您的应用集成的理想选择。

# 使用 API 密钥身份验证方法进行集成时需要考虑的事项

用户需要将 API 密钥从一个应用程序复制并粘贴到另一个应用程序。这一手动步骤不会花费太多时间，但是当数据没有被正确剪切和粘贴时，它会导致问题。另一个缺点是 API 密钥通常不会过期。因此，有人可能会破坏 API 密钥，它将继续发挥作用，直到有人意识到并进入源应用程序以禁用/删除它。

# 了解 OAuth 2.0 方法

[OAuth 2.0](https://oauth.net/2/) 无处不在。毫无疑问，你自己也在很多应用程序中使用过它。一般来说，它是这样设置的，你点击应用程序 A 中的一个按钮，应用程序 A 就会把你转到应用程序 B，询问你是否希望分享一些东西(电子邮件等)。)与应用程序 A。您点击按钮同意此数据共享，应用程序 A 被授予代表您访问应用程序 B 的权限。

虽然这在表面上非常简单，但其复杂性是在幕后处理的。它是这样工作的:

![](img/9a1a727f6c3832f0b78207327b63ed44.png)

# 为什么 SaaS 团队使用 OAuth 2.0 方法进行集成

OAuth 2.0 最强大的特性之一是，授权(许可)可以很容易地限定在所需的特定访问范围内:对帐户的读访问、对联系人的读/写访问等。每个集成可以使用不同的访问令牌，如果用户更改密码也没有关系；OAuth 访问令牌仍然有效。

撤销刷新令牌也很简单，从而使用户无法生成新的访问令牌。与此同时，如果访问令牌不知何故遭到破坏，它通常会很快过期并限制可能导致的损害。

OAuth 的用户体验基本上是轻松的，因为用户不需要输入任何数据，比如凭证或 API 密钥。相反，用户只需要批准应用程序之间的授权请求。

虽然 OAuth 2.0 非常适合使用嵌入式集成平台(嵌入式 iPaaS)构建与第三方应用的集成，但它也是最强大、最安全的身份验证方法——无论您对集成做了什么。

# 使用 OAuth 2.0 方法进行集成时需要考虑的事情

使用 OAuth 2.0 的开销比使用基本身份验证或 API 密钥要大。您需要构建基础设施来跟踪使用 OAuth 2.0 的任何应用程序的客户端 id 和客户端机密。此外，需要设置您的应用程序/API 来创建一个回调 URL，该 URL 将授权代码作为输入，并将其交换为访问令牌和刷新令牌(如果适用)。

最后，您还需要构建一些东西来定期刷新访问令牌。这可能是 cron 作业、AWS Lambda 等。

# 结论

如果您正在构建您的应用程序和第三方应用程序之间的自定义内部集成，由于用户体验和内置保护，使用 OAuth 2.0 可能是最有意义的。如果你因为某种原因不能走这条路，那么使用 API 密匙仍然可以提供良好的用户体验和相当的安全性。虽然基本身份验证有其使用案例，但对于大多数现代 SaaS 应用程序来说，它并不是最佳的。

然而，如果您使用嵌入式 iPaaS 来创建、部署和维护与您的应用程序的本机集成，那么该平台应该带有许多应用程序的内置连接器，这些连接器可以处理您的大多数身份验证需求，而不需要您编写额外的代码。您甚至可以设置您的应用程序，以便创建一个 API 密钥，然后当客户激活集成时，在集成配置中向您的客户提供该密钥。

无论您是在内部构建集成还是使用嵌入式集成平台，对用户身份验证方法的基本了解都将有助于您执行集成计划。
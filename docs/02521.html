<html>
<head>
<title>Understanding ARP Poisoning &amp; MITM Attack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解ARP中毒和MITM攻击</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/understanding-arp-poisoning-mitm-attack-7b12a3b061bd?source=collection_archive---------7-----------------------#2021-05-18">https://medium.com/geekculture/understanding-arp-poisoning-mitm-attack-7b12a3b061bd?source=collection_archive---------7-----------------------#2021-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a3c34e6fa3c0917abbd114353da27953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hrYtAJhmAkP2qJxFI3It1Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image by: https://www.paubox.com/</figcaption></figure><p id="2865" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ARP中毒和中间人攻击(MITM)是网络攻击的类型，这使得黑客能够窥探双方之间的通信。从技术上讲，ARP中毒是一种中间人攻击。因此，在这篇文章中，我将解释ARP中毒和中间人攻击。但是在进入ARP中毒之前，我们应该对ARP有适当的了解。</p><h1 id="1aa5" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是ARP？</h1><p id="2b85" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">ARP首字母缩写代表<strong class="iw hj">地址解析协议</strong>，顾名思义，它是一种支持设备间网络通信的协议。ARP用于将互联网协议(IP)地址转换为局域网中的<strong class="iw hj">【固定物理机地址】</strong>，也称为<strong class="iw hj">媒体访问控制(MAC) </strong>地址。通常，ARP在设备内部用于与路由器通信，使这些设备能够连接到互联网。</p><p id="8aa3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">主机维护着ARP缓存，并使用它连接到网站和网络上的其他目的地。然而，如果主机没有正在寻找的IP地址的MAC地址，它将通过发送ARP请求包向网络上的其它机器请求匹配的MAC地址。</p><p id="f7e7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，IP和MAC地址之间的映射过程非常重要，因为IP和MAC地址的长度互不相同。因此，需要翻译来识别系统中的彼此。如你所知，有一个新版本的互联网协议被命名为<strong class="iw hj"> IPv6 </strong>，但使用最多的仍然是IPv4。因此，IPv4地址是32位长，而MAC地址是48位长。因此，ARP需要将32位地址转换为48位地址，反之亦然。</p><p id="7b27" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，ARP协议在安全性方面也不好。这就是为什么IPv6采用了名为<strong class="iw hj">邻居发现协议(NDP)的新协议。</strong>邻居发现协议在安全方面非常强大，使用密钥来验证主机身份。</p><h1 id="c203" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是ARP中毒(ARP欺骗)？</h1><p id="b8ff" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">ARP中毒是一种中间人(MitM)攻击，它允许黑客通过局域网(LAN)窥探双方的通信。正如我上面提到的，ARP协议主要是为了效率而不是安全而设计的。因为协议的设计者从未包括验证ARP消息的认证系统。因此，同一网络中的任何设备都可以应答ARP请求，即使原始消息不是为它请求的。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/993b3ce112ccb02c4d4169bf68566317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZoJ8_UQ6EyAD9ZWb9itRwg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image: ARP Poisoning (https://laptrinhx.com/)</figcaption></figure><p id="f631" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们来看看黑客在攻击时遵循的步骤。</p><ol class=""><li id="a867" class="la lb hi iw b ix iy jb jc jf lc jj ld jn le jr lf lg lh li bi translated">首先，他们必须能够访问网络，这样他们才能扫描网络，找出连接设备的IP地址。</li><li id="0471" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr lf lg lh li bi translated">下一步通常是选择一个目标，例如网络上的特定端点或路由器之类的网络设备。</li><li id="3231" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr lf lg lh li bi translated">然后，攻击者将使用欺骗工具来执行ARP中毒攻击。他们可以使用的工具种类繁多，比如<strong class="iw hj"> Arpspoof </strong>或者<strong class="iw hj"> Driftnet </strong>。因此，在配置了适用的设置后，他将开始攻击。</li><li id="e71a" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr lf lg lh li bi translated">攻击的结果是，属于路由器和设备的两个IP地址都会认为攻击者的MAC地址是正确的。</li><li id="9428" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr lf lg lh li bi translated">现在，这两台设备将更新它们的ARP缓存条目。从那时起，两个设备都与攻击者通信，而不是直接相互通信。但问题是攻击者假装是网络通信信道的双方。正因为如此，那两个人不知道他们在和外面的人交流。</li><li id="b01c" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr lf lg lh li bi translated">现在攻击者可以在他们不知情的情况下秘密地执行任何操作。</li></ol><h1 id="b255" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">如何识别ARP缓存中毒攻击？</h1><p id="3871" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">如果特定设备的ARP缓存中毒，最简单的识别方法是使用命令行。</p><p id="6012" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">打开机器的终端，输入以下命令显示ARP表。该命令适用于Windows和Linux操作系统。</p><pre class="kw kx ky kz fd lo lp lq lr aw ls bi"><span id="31a2" class="lt jt hi lp b fi lu lv l lw lx"><strong class="lp hj">arp -a</strong></span></pre><p id="5733" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">输出结果将如下所示，</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/018b08176d99cf5dd028e212a152f03e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*oDNU-JP0xOzq-8Ua52LXSQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">Image: ARP table</figcaption></figure><p id="7c81" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然而，如果你的表格显示两个不同的IP地址有<strong class="iw hj">相同的MAC地址</strong>，这意味着你受到ARP中毒的攻击。</p><p id="1b36" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，如果您想发现大型网络中的ARP中毒，并获得有关攻击者正在进行的通信类型的更多信息，您可以使用名为<strong class="iw hj"> Wireshark protocol </strong>的开源软件。</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/61c62d38488c3c4fe890cefffb713420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoHXlvhNAcL65fsaGWY7bQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Image: Network Traffic using WireShark</figcaption></figure><h1 id="40e8" class="js jt hi bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">如何预防ARP中毒？</h1><p id="8b0b" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">有几种方法可以用来防止网络上的ARP中毒。</p><ul class=""><li id="c9fb" class="la lb hi iw b ix iy jb jc jf lc jj ld jn le jr ma lg lh li bi translated"><strong class="iw hj">使用虚拟专用网络(VPN)⁠: </strong>使用虚拟专用网络是防止ARP中毒最简单、最有效的方法。它允许您的设备通过加密的隧道连接互联网，这使得ARP欺骗攻击者不可能。</li><li id="6f1b" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr ma lg lh li bi translated"><strong class="iw hj">使用静态ARP:</strong>ARP协议允许你为一个IP地址创建一个静态ARP条目。因此，它将阻止设备侦听该地址的ARP响应。</li><li id="92ea" class="la lb hi iw b ix lj jb lk jf ll jj lm jn ln jr ma lg lh li bi translated"><strong class="iw hj">运行欺骗攻击:</strong>您可以自己运行欺骗攻击来检查现有的防御措施是否正常工作，如果不正常，您可以检测系统中的弱点并修复它们。</li></ul></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><h1 id="408d" class="js jt hi bd ju jv mi jx jy jz mj kb kc kd mk kf kg kh ml kj kk kl mm kn ko kp bi translated">中间人(MITM)攻击</h1><p id="9d82" class="pw-post-body-paragraph iu iv hi iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr hb bi translated">正如我上面提到的，ARP中毒是一种MITM攻击。中间人攻击是最常见同时也是最危险的攻击之一。MITM攻击是一种窃听攻击，攻击者截取双方之间的通信。进入通信后，攻击者假装双方都是合法的参与者。通过这种方式，最初的双方都不知道存在攻击者，并且他们进行通信时认为他们彼此直接相连。但实际情况是，双方都是在攻击者不知情的情况下与攻击者交流，而不是直接与对方交流。</p><p id="ac35" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">例如，假设有一个名叫John的人，攻击者针对给定的IP地址(通常是特定子网的默认网关)发送伪造的ARP响应。因此，这将导致John的设备使用攻击者机器的MAC地址而不是路由器的MAC地址来填充其ARP缓存。然后，约翰的机器会错误地将网络流量转发给攻击者。然而，对约翰来说，一切可能看起来很正常，直到为时已晚。</p><p id="af80" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，攻击者可以轻松地执行这些MITM攻击，以窃取登录凭据或机密信息，监视受害者，或者中断通信或破坏数据。</p><p id="74be" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">此外，还有几种类型的中间人攻击，如<strong class="iw hj"> DNS中毒、HTTPS欺骗、Wi-Fi窃听、</strong>和<strong class="iw hj">会话劫持。因此，在我的下一篇文章中，我将解释DNS中毒(DNS欺骗)。</strong></p><p id="87d5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">所以，这是文章的结尾，我希望你喜欢它。快乐编码👨‍💻。</p></div><div class="ab cl mb mc gp md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hb hc hd he hf"><h2 id="f918" class="lt jt hi bd ju mn mo mp jy mq mr ms kc jf mt mu kg jj mv mw kk jn mx my ko mz bi translated">参考</h2><div class="na nb ez fb nc nd"><a href="https://www.varonis.com/blog/arp-poisoning/" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab dw"><div class="nf ab ng cl cj nh"><h2 class="bd hj fi z dy ni ea eb nj ed ef hh bi translated">ARP中毒:它是什么&amp;如何防止ARP欺骗攻击</h2><div class="nk l"><h3 class="bd b fi z dy ni ea eb nj ed ef dx translated">ARP中毒是一种网络攻击，它滥用广泛使用的地址解析协议(ARP)中的弱点来…</h3></div><div class="nl l"><p class="bd b fp z dy ni ea eb nj ed ef dx translated">www.varonis.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr io nd"/></div></div></a></div><div class="na nb ez fb nc nd"><a href="https://www.csoonline.com/article/3340117/what-is-a-man-in-the-middle-attack-how-mitm-attacks-work-and-how-to-prevent-them.html" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab dw"><div class="nf ab ng cl cj nh"><h2 class="bd hj fi z dy ni ea eb nj ed ef hh bi translated">什么是中间人攻击？MitM攻击的工作原理以及如何防范它们</h2><div class="nk l"><h3 class="bd b fi z dy ni ea eb nj ed ef dx translated">中间人(MitM)攻击是指攻击者截获双方之间的通信，以秘密地…</h3></div><div class="nl l"><p class="bd b fp z dy ni ea eb nj ed ef dx translated">www.csoonline.com</p></div></div><div class="nm l"><div class="ns l no np nq nm nr io nd"/></div></div></a></div><div class="na nb ez fb nc nd"><a href="https://www.pcwdld.com/find-device-or-ip-address-using-mac-address" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab dw"><div class="nf ab ng cl cj nh"><h2 class="bd hj fi z dy ni ea eb nj ed ef hh bi translated">用MAC地址查找设备或IP地址-命令行和工具！</h2><div class="nk l"><h3 class="bd b fi z dy ni ea eb nj ed ef dx translated">如果没有IP地址，您将如何与设备通信？你可能处于这样一种情况，你没有…</h3></div><div class="nl l"><p class="bd b fp z dy ni ea eb nj ed ef dx translated">www.pcwdld.com</p></div></div><div class="nm l"><div class="nt l no np nq nm nr io nd"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Full Data Analysis For a Classification Task (Supervised Learning)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类任务的完整数据分析(监督学习)</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/full-data-analysis-for-a-classification-task-supervised-learning-e6cc4a85f7ee?source=collection_archive---------5-----------------------#2021-12-21">https://medium.com/geekculture/full-data-analysis-for-a-classification-task-supervised-learning-e6cc4a85f7ee?source=collection_archive---------5-----------------------#2021-12-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢<strong class="ih hj"> Hyosang Kim(富柏林)、Raniyaharini Rajendran(富柏林)</strong>的团队合作！</p><p id="eee7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">监督学习(SL) </strong>是学习一个函数的<a class="ae jd" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>任务，该函数<a class="ae jd" href="https://en.wikipedia.org/wiki/Map_(mathematics)" rel="noopener ugc nofollow" target="_blank">基于示例输入输出对将</a>输入映射到输出。[1]大多数实用的机器学习使用监督学习。监督学习问题可以进一步分为回归和分类问题。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/e95d9d0fd2d3b8fd73aaebe51be757a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WNnfb0MTq6cQk2BI.png"/></div></div></figure><p id="9f66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，我们将进行全面的数据分析。为了进行分析，我们将使用成人数据集(<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/adult" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/adult</a>)，其中包含来自美国的人口普查数据。目标是预测一个人的年收入是否超过5万美元。我们考虑的是积极阶层，年收入超过5万英镑。</p><p id="7269" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">了解数据集</strong></p><p id="d194" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了看看我们有什么，让我们看看文件。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jq"><img src="../Images/14132988d9942c902115a1b453f9aaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*scCQgEct_jjK5BdlTx3SNQ.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jr"><img src="../Images/fccb131b5f0eb4d497b44c9145fe0793.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*V7XgyRtwR1dAT2QOfH2dcQ.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/093677f200066e3fa79ba8d74d47546c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*laLXeZfEQ0ucbBenuyWM5A.png"/></div></div></figure><p id="da0b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们看到的，我们必须手动添加列名。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/7e111da43a0e7d199bbc97ac74ad33d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nofvGTS59nAKs49CDI4bgQ.png"/></div></div></figure><p id="ed02" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">标签:&gt; 50K，&lt;=50K</p><p id="3bf7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Dataset characteristics: Multivariate</p><p id="f219" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Attribute characteristics: Categorical, Integer</p><p id="afb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Number of Instances(Total): 48842</p><p id="8204" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Number of Instances(Train):32561</p><p id="cc6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Number of Instances(Test):16281</p><p id="e1f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Number of Attributes:14</p><p id="05fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">年龄:</strong>连续。</p><p id="cfb6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">工作类:</strong>私人，自营企业，自营企业，联邦政府，地方政府，州政府，无薪，从未工作。</p><p id="4dce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> fnlwgt: </strong>连续。</p><p id="d5ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">教育:</strong>学士、部分大学、11年级、HS-grad、Prof-school、Assoc-acdm、Assoc-voc、9年级、7-8年级、12年级、硕士、1-4年级、10年级、博士、5-6年级、学前班。</p><p id="c0ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">教育-编号:</strong>连续。</p><p id="068f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">婚姻状况:</strong>已婚-未婚-配偶，离婚，未婚，分居，丧偶，已婚-配偶不在，已婚-配偶。</p><p id="ea81" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">职业:<strong class="ih hj">技术支持、工艺修理、其他服务、销售、行政管理、专业教授、清洁工、机器操作检查、行政文员、农业渔业、运输搬运、私人住宅服务、保安服务、武装部队。</strong></p><p id="7257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关系:</strong>妻子，亲生子女，丈夫，非家庭成员，其他亲属，未婚。</p><p id="bf34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">种族:白人，亚洲太平洋岛民，美洲印第安爱斯基摩人，其他，黑人。</p><p id="c3dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">性别:</strong>女，男。</p><p id="d740" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">资本增值:</strong>持续。</p><p id="e185" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">资金损失:</strong>连续。</p><p id="28ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">每周工时:</strong>连续。</p><p id="148d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">本土国家:</strong>美国、柬埔寨、英国、波多黎各、加拿大、德国、美国外围地区(关岛-USVI等)、印度、日本、希腊、中国、古巴、伊朗、洪都拉斯、菲律宾、意大利、波兰、牙买加、越南、墨西哥、葡萄牙、爱尔兰、法国、多米尼加共和国、老挝、厄瓜多尔、台湾、海地、哥伦比亚、匈牙利、危地马拉、尼加拉瓜、苏格兰、泰国、南斯拉夫、萨尔瓦多、特立尼达和多巴哥、秘鲁、香港、荷兰。</p><p id="1cf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在相关文件夹下，有两个不同的。分别命名包含测试和训练数据的文件。我们需要一个组合数据集来执行数据预处理步骤。因此，我们将读取两个文件，并在“指示器”列的帮助下合并它们，以再次划分它们来构建模型零件</p><p id="1252" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有一个带有指示器列的合并数据集。它已经准备好了！</p><p id="c630" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在读取文件和添加列名之后，时间是在“指示器”列的帮助下结合训练和测试数据集，以了解哪一行是用于将来的训练或测试的。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/69697b6815140d269b02687fdcd5210e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_oev0dvXZXYPIa3T79KxA.png"/></div></div></figure><p id="ec55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将原始数据转换成可理解的格式。数据预处理中的典型任务，</p><p id="810d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据整合</strong></p><p id="7b5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">多个数据库、数据仓库或文件的集成(实体识别、价值解析)</em></p><p id="65d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据清理</strong></p><p id="9ea2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">填写缺失值</em></p><p id="cb2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当没有提供一个或多个项目或整个单位的信息时，可能会出现数据缺失。在现实生活中，丢失数据是一个非常大的问题。对于我们的数据集，首先我们使用<em class="jv"> isna() </em>函数来查看我们是否有缺失值。由于缺少值的表示，结果为null。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/bd8db2f65b1f666018c5f3557e65b361.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/0*ToLCcs1iyswajE_E"/></div></figure><p id="3f79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在成人数据集中，缺失值有一个字母数字值“？”。因此，改变函数来检测这些值是我们的第二种方法。使用str.contains函数<em class="jv"> (str.contains('\？')))</em>，缺失值直接可见。列列表有“？”作为缺失值。我们也可以通过频率表来识别它们。此表对于查找相关列的模式值很有用。举个例子，</p><p id="5646" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">工作类</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jx"><img src="../Images/e9b781ceadba437c437d10648f6b98e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/0*gir6UJqngdRNRcrz"/></div></figure><p id="9845" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">职业</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jy"><img src="../Images/354749de5aa8c79a29783410cf9f26ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/0*41yD-8FRRzhJY2oQ"/></div></figure><p id="16d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面有四个主要步骤来处理这些值。</p><ul class=""><li id="d7ad" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">忽略观察。</li><li id="cb96" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated"><strong class="ih hj">替换为最频繁的值(模式)。</strong></li><li id="eddc" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">开发一个模型来预测缺失值。</li><li id="61f7" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">将缺失数据视为另一个类别</li></ul><p id="6181" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们想继续用最频繁值法(模式)进行替换。工作类别、职业和本国列的新频率表如下。</p><p id="1c88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">工作类</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kn"><img src="../Images/99980f97689d801c43aea9601f4aeea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/0*cbR6C82zf6lKnDLc"/></div></figure><p id="90f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">职业</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jy"><img src="../Images/87f7efa570360741c38ffeabf09f34ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/0*ROCot1u5noD9_fq9"/></div></figure><p id="d68d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">母国(前19) </em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ko"><img src="../Images/bb1a69e8097fc7efac6b46bb999b7802.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/0*6oaF6USUg786cR8n"/></div></figure><p id="cd92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">平滑噪声数据</em></p><p id="68e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">识别或移除异常值</em></p><p id="5aff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">离群点检测用于异常检测，其中人们对检测异常或不寻常的观察感兴趣。检测异常值有四种主要方法。</p><p id="f899" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数值离群点</strong> <br/>这是一维特征空间中最简单的非参数离群点检测方法。在这里，异常值是通过IQR(四分位间距)计算的。计算第一个和第三个四分位数(Q1，Q3)。异常值是位于四分位数范围之外的数据点x_i。使用四分位数乘数值k=1，范围限制是箱线图的典型上下须。</p><p id="c893" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">z分数</p><p id="dbc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于密度的噪声应用空间聚类</p><p id="1e8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">隔离森林</p><p id="0935" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的数据集，我们将解释箱线图和直方图，并应用第一个，<strong class="ih hj">数值异常值</strong>。我们也解释箱线图和属性直方图。</p><p id="45e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">单变量分析也许是最简单的统计分析形式。像其他形式的统计一样，它可以是推断性的，也可以是描述性的。关键事实是只涉及一个变量。对于连续变量</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kp"><img src="../Images/e73a0144882cda8b0733e462c13a6766.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/0*zaZh2jboBmPjA1Z0"/></div></figure><p id="5a72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数值直方图，</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kq"><img src="../Images/6a5f59af493a0edc085a4b18ce0d0f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ytah8D9vKfMc0A2d"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Histograms of each numerical columns before removing outliers from dataset</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kv"><img src="../Images/b08e4e3035bef2a53ac2db2612877732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*1261zIMfoXYPy_N9DcDG3w.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kw"><img src="../Images/f1323b99462721861d42055f9d621534.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/0*oc8gPw6LSl8ZjOb2"/></div></figure><p id="68f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">剔除异常值之前的“fnlwgt”列(其中之一)的箱线图如下。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kx"><img src="../Images/9dc85191d574f3c71a51db319f21c0c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BoyRCwSSuaSkJqoZ"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Boxplot for ‘fnlwgt’</figcaption></figure><p id="1b7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据集有分类值和数值。对于分类列，频率表很有用。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/f889f3d792b7715db2cd92271121cfd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/0*1CjheVEPinajaPKc"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Frequency table for ‘occupation’</figcaption></figure><p id="51d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从箱线图和直方图中我们可以很容易地看到，数据集有许多异常值，并且数值列的分布不是均匀分布的。对于<strong class="ih hj"> fnlwgt </strong>列，偏态分布是不对称的，因为自然限制阻止了一侧的结果，并且它具有右偏态分布。</p><p id="3de7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们编写了一个函数来计算每个数字属性的IOR。我们借助IOR方法(数值，k=1)发现异常值，对每个数值列平均改变异常值。</p><p id="b8fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">如何处理离群值？</strong></p><ol class=""><li id="3d3c" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc kz kf kg kh bi translated">在您的测试工具中设置一个过滤器。</li><li id="b8f3" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc kz kf kg kh bi translated">在测试后分析期间移除或更改异常值。</li><li id="1a72" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc kz kf kg kh bi translated"><strong class="ih hj">改变离群值。</strong></li><li id="c761" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc kz kf kg kh bi translated">考虑基本分布</li><li id="3446" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc kz kf kg kh bi translated">考虑轻度异常值的值。</li></ol><p id="c578" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了去除离群值，我们将改变离群值。由于大量的异常值，删除观察值是不合理的。我们也不知道这些是自然的异常值还是人为的。</p><p id="fbf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注1: </strong>如果偏度在-0.5到0.5之间，则数据相当对称。如果偏斜度介于-1和-0.5之间或介于0.5和1之间，则数据是中度偏斜的。如果偏斜度小于-1或大于1，则数据高度偏斜。<br/> <strong class="ih hj">子结果1: </strong>用中位数代替离群值无效(已尝试)。<br/> <strong class="ih hj">子结果2: </strong>作为第二种方法，我们试图通过IQR方法从我们的数据框架中去除异常值。它效率不高。<br/> <strong class="ih hj">子结果3: </strong>对数变换对异常值也无效。<br/> <strong class="ih hj">子结果4: </strong> Z-score对异常值也无效。<br/> <strong class="ih hj">结果:</strong>我们借助IOR方法(数值)发现异常值，并对每列均值改变异常值。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/ae7745a15488b6e53629cd293a7d1a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*DtW-Yf7mT83HJCKi4Mg4rw.png"/></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lb"><img src="../Images/afecdc46ae1c1574d82605c6a60795eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*13PwoEnXFDhUBM3U"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Boxplot for ‘<strong class="bd lc">fnlwgt</strong>’ after the related process</figcaption></figure><p id="7508" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据预处理部分之后，我们再次检查了箱线图和直方图。我们看到异常值的数量肯定比以前少了。数字列的分布仍然不是均匀分布的。</p><p id="3fa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了检查类别不平衡，不同标签的计数的可视化就足够了。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ld"><img src="../Images/6afe3b2a199279f559a8252e7ce0e411.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/0*6Nd4NMQlPR8ai4Nx"/></div><figcaption class="kr ks et er es kt ku bd b be z dx">Visualization of the number of different labels</figcaption></figure><p id="14e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过观察目标类在数据集中的分布，很容易识别类不平衡。正如我们很容易看到的，<strong class="ih hj">我们的数据集遭遇了类不平衡问题</strong>。</p><p id="6997" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当训练数据中存在类别不平衡时，由于较大类别的先验概率增加，机器学习模型通常会对较大类别进行过度分类。结果，属于较小类的实例通常比属于较大类的实例更经常被错误分类。</p><p id="4a32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其他缺点:</p><ul class=""><li id="b1a1" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">错误分类错误的不等成本</li><li id="91e2" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">偏斜类别分布</li><li id="e09a" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">预测建模的挑战</li><li id="6fcd" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">由于其增加的先验概率，过度分类多数组</li></ul><p id="ca23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">打击不平衡训练数据</strong></p><p id="71c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说，主要选项如下:</p><ul class=""><li id="1773" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">收集更多数据</li><li id="f9b6" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">更改绩效指标</li><li id="d751" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated"><strong class="ih hj">随机欠采样和过采样</strong></li></ul><p id="ffb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机过采样包括从少数类中随机选择样本，并替换，然后将它们添加到训练数据集中。随机欠采样包括从多数类中随机选择样本，并将其从训练数据集中删除。</p><p id="9fb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一般来说<strong class="ih hj">过采样更好</strong>，因为你把所有的信息都保存在训练数据集中。</p><ul class=""><li id="0f83" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">尝试不同的算法</li><li id="536d" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">尝试被惩罚的模型</li></ul><p id="fd75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将继续进行<strong class="ih hj">随机过采样</strong>。</p><p id="3abd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如你所见，编码并执行这一部分后，<strong class="ih hj">‘结果’</strong>列的新分布图如下，看起来更好。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ld"><img src="../Images/3a6e0a136e9087ea3a063f23608c17d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/0*-TsrBrEfzAHgeXn_"/></div></figure><p id="66cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">采用过采样方法后，新的分布图如上。训练数据集中实例的更新数量是<strong class="ih hj"> 49438。</strong></p><p id="1092" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关矩阵只是一个显示相关性的表格。这种方法最适用于展示彼此之间线性关系的变量。</p><p id="4922" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关性在-1和+1之间变化。</p><p id="e0e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">-1:完全负线性相关</p><p id="2b42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">+1:完美的正线性相关</p><p id="5cf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">0:无相关性</p><p id="6eef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用以下公式推导相关性:</p><p id="2d24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相关性=协方差(X，Y) / SQRT( Var(X)* Var(Y))</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es le"><img src="../Images/f4bb39eba1bbdef8cf7ccd8a94accccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L6Ad1_ID6w4j-2ud"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Correlation matrix with colors</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lf"><img src="../Images/2a583e056229fd67da2bba7df7036875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/0*AKEjQQpUIT-2tRFD"/></div><figcaption class="kr ks et er es kt ku bd b be z dx">Correlation matrix with colors and numerical values</figcaption></figure><p id="5104" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">沿着表格对角线的相关系数都等于1，因为每个变量与其自身完全相关，并且相关矩阵完全对称。一般来说，低于0.3的相关系数值被认为是弱的；0.3–0.7为中度；&gt; 0.7为强。<strong class="ih hj">我们可以看到，最大值(没有对角线)是0.137879，最小值是-0.092355。这些相关性很弱。因此，我们不能说有相关的价值。</strong></p><p id="2f90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">功能选择</strong></p><p id="f103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成数据预处理步骤并检查相关矩阵后，我们希望继续使用相同的列和指示列。当我们想要划分数据集来测试和训练零件时，这个<strong class="ih hj">索引</strong>，<strong class="ih hj"> ind(测试，训练)</strong>列将会很有帮助。由于我们应用了过采样方法，数据集的新维度总共是(65719，16)(49438:train，16281: test)。</p><p id="eae6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注:特征选择部分是下一篇文章的另一个主题。我们会看到更多的细节。现在，继续前进！</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lg"><img src="../Images/92aeba952b187da103067c1c85689554.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/0*Il0SmxwdUYzT6uhs"/></div></figure><p id="38fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分类模型</strong></p><p id="df78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将实验五个监督模型，即KNN，决策树，朴素贝叶斯，SVM和感知器。</p><p id="3f45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">K-最近邻算法(k-NN) </strong></p><p id="d10f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">k-近邻算法是一种非参数分类方法。在k-NN分类中，输出是一个类成员。一个对象通过其邻居的多数投票来分类，其中该对象被分配到其knearest邻居中最常见的类别(k是正整数，通常很小)。</p><p id="4e82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">决策树:</strong></p><p id="039d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决策树(DTs)是一种用于分类和回归的非参数监督学习方法。目标是创建一个模型，通过学习从数据特征推断的简单决策规则来预测目标变量的值。</p><p id="5d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">朴素贝叶斯:</strong></p><p id="ec9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯方法是一组基于应用贝叶斯定理的监督学习算法，其“朴素”假设是在给定类变量的值的情况下，每对要素之间的条件独立性。</p><p id="970f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">支持向量机:</strong></p><p id="925f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">支持向量机是一组有监督的学习方法。给定一组训练样本，每个样本被标记为属于两个类别中的一个，SVM训练算法建立一个模型，将新样本分配给一个类别或另一个类别，使其成为非概率二元线性分类器。</p><p id="32ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">感知器:</strong></p><p id="9b8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感知器是单层神经网络。它们由四个主要部分组成，包括输入值、权重和偏差、净和以及激活函数。</p><p id="6ff3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">评估设置</strong></p><p id="39fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">交叉验证是一种重采样过程，用于评估给定数据集的机器学习模型。10重分层交叉验证有一个称为k的参数，它指的是给定数据样本可以分成的组数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lh"><img src="../Images/cfc74008d91bb52ebb5f817dc8ac5334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EjAVORLIcJ_5mG0w"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es li"><img src="../Images/38aa65825c439e996088fdaeef673622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c2HY_DvM-GusvbxA"/></div></div></figure></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="47f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">评估措施</strong></p><p id="46e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混淆矩阵:</strong>混淆矩阵是一种将错误分类数量列表的方式</p><p id="62ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">准确度:</strong>分类准确度就是我们通常所说的，当我们使用术语准确度时。它是正确预测数与输入样本总数的比率。</p><p id="ee20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">精度= TP+TN/TP+FP+FN+TN </em></p><p id="2a88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">精度:</strong>精度是正确预测的正观测值与总预测正观测值的比率。</p><p id="19d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">精度= TP/TP+FP </em></p><p id="e7ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">召回(灵敏度):</strong>召回是正确预测的正面观察与实际类别中所有观察的比率</p><p id="50c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">召回= TP/TP+FN </em></p><p id="4250" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> F1评分:</strong> F1评分是准确率和召回率的加权平均值。</p><p id="69cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">F1得分= 2*(召回率*精确度)/(召回率+精确度)</p><p id="f10b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> AUC图和ROC曲线:</strong> ROC曲线(受试者操作特征曲线)是显示分类模型在所有分类阈值的性能的图。该曲线绘制了两个参数:</p><ul class=""><li id="84e1" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">真阳性率</li><li id="7386" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">假阳性率(FPR)</li></ul><p id="9c44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> TPR= TP/TP+FN </strong></p><p id="89ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> FPR = FP/FP+TN </strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/8d40d368cf31b74b85a0463850deb90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d-zgBiQ7FytQurV7"/></div></div></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lr"><img src="../Images/6bbb75a105071257b18272fbf1253498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ig6C8f9NZaCd72--"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><strong class="bd lc">AUC Plot and ROC Curve for KNN</strong></figcaption></figure></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="31db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型参数整定</strong></p><p id="3b2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整是为学习算法选择一组最佳<a class="ae jd" href="https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)" rel="noopener ugc nofollow" target="_blank">超参数</a>的过程。</p><p id="4737" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整涉及的步骤:</p><ul class=""><li id="c899" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">为模型选择合适的算法</li><li id="0e7d" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">决定参数空间(不同分类器的参数不同)</li><li id="3c28" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">决定搜索参数空间的方法</li><li id="9a02" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">确定交叉验证方法(我们使用了10层交叉验证)</li><li id="f941" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">决定评估模型的评分标准</li></ul><p id="9a53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最初有两个超参数调谐搜索。它们是:</p><ul class=""><li id="3daa" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">GridSearchCV</li><li id="8a3d" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">随机搜索</li></ul><p id="3687" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们使用GridSearchCv，因为它考虑了所有可能的超参数组合。另一方面，RandomizedsearchCV使用随机选择的少量样本。因此GridSearchCV比RandomizedSearchCV更有效。</p><p id="c45f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> KNN: </strong>最佳参数:{'metric': 'manhattan '，' n_neighbors': 17，' p': 1，' weights': 'uniform'}</p><p id="1bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">决策树:</strong>最佳参数:{'criterion': 'gini '，' max_depth': 7，' min_samples_leaf': 3，' min_samples_split': 2}</p><p id="6728" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">朴素贝叶斯:</strong>最佳参数:{ ' var _ smoothing ':1.2328467394420658 e-05 }</p><p id="4ede" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> SVM: </strong>最佳参数:{C=0.1，gamma=1，kernel = rbf总时间= 1.1分钟}</p><p id="bc77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">决定边界</strong></p><p id="7239" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">判定边界是一条线(在两个要素的情况下)，其中一个类的所有(或大多数)样本位于该线的一侧，另一个类的所有样本位于该线的另一侧。线<em class="jv">将</em>从一个类中分离出来。如果你有两个以上的特征，决策边界不是一条线，而是你的特征空间维度中的超平面。</p><p id="d070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的数据集中，绘制决策边界的类包含两个以上的要素。大多数课程包括五个特点。决策边界支持提供给具有两个特征的类。因此，在我们的问题中，我们包括了填充特征值，它包含了被忽略的其他特征。举个例子，</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ls"><img src="../Images/f72f97185f05657b2c80a7b42ba77551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DU6tAyPdDpqg0l20"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><strong class="bd lc">Decision Boundary for KNN</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/737aefff88734169d516e5ea4863c695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wKO21F4tsVCgC9_Z"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><strong class="bd lc">Decision Boundary for Decision Tree</strong></figcaption></figure></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="f911" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">模型参数的影响</strong></p><p id="fdd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个分类器都有自己的一组参数，其中许多参数在提高模型性能方面起着重要作用。这里，让我们检查影响不同分类器性能的参数。</p><p id="619b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">KNN的参数</strong></p><p id="987c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">n_neighbors': [3，5，7，9，11，13，15，17，19，21，23]，</p><p id="ed3f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p': (1，2)，</p><p id="8826" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">权重':['统一'，'距离']，</p><p id="e834" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">公制':['欧几里德'，'曼哈顿'，'闵可夫斯基']</p><p id="f5e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最佳参数:{'metric': 'manhattan '，' n_neighbors': 17，' p': 1，' weights': 'uniform'}</p><p id="1f21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整后，模型精度从0.72提高到0.80。</p><p id="1ad5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">决策树的参数</strong></p><p id="79bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“标准”:[“基尼”、“熵”]，</p><p id="d101" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">" max_depth ":范围(1，15)，</p><p id="7727" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“min_samples_split”:范围(1，10)，</p><p id="5e93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">" min_samples_leaf ":范围(1，5)</p><p id="3da9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最佳参数:{'criterion': 'gini '，' max_depth': 7，' min_samples_leaf': 3，' min_samples_split': 2}</p><p id="3344" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整后，模型精度从0.77提高到0.83。</p><p id="d8b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">朴素贝叶斯的参数</strong></p><p id="d4eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">' var_smoothing': np.logspace(0，-9，num=100)</p><p id="66fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">朴素贝叶斯通常没有任何参数。唯一使用的参数是var_smoothing。然而，这对分类器的性能没有任何影响。</p><p id="7851" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最佳参数:{ ' var _ smoothing ':1.2328467394420658 e-05 }</p><p id="dc0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">超参数调整后，模型的精度没有变化，保持在0.79不变</p><p id="7d89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">SVM</strong>的参数</p><p id="1e7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">C': [0.1，1，10，100]，</p><p id="cfe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">伽马':[1，0.1，0.01，0.001]，</p><p id="1669" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">内核':['rbf '，' poly '，' sigmoid']</p><p id="5eab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最佳参数:{C=0.1，gamma=1，kernel = rbf总时间= 1.1分钟}</p><p id="e6e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">即使在超参数调整之后，我们也可以观察到模型的精度保持不变。</p><p id="76dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">公平意识评估</strong></p><p id="f66e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习中训练模型的偏见可能源于反映现有偏见的数据本身。这种历史性的不公平是我们试图从我们的训练模型中衡量的。当错误类似地分布在保护组中时，模型是公平的。在我们的任务中，受保护的属性是‘性别’，指的是男性和女性不同的生理特征。</p><p id="4393" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以将数据视为x，并使用机器学习模型来计算分数f(x)，该分数将用于预测，我们可以产生二进制结果y_hat = {0，1}。在我们的数据集中，y_hat值0表示收入超过50K，1表示收入低于50K。此外，受保护的属性可以表示为s = {0，1}。在我们的数据集中，s的二进制值显示为{' Female '，' Male'}。“女性”是受保护的群体，“男性”是不受保护的群体。此外，在我们的训练模型中，我们知道真实的类值y = {0，1}。数据x将与受保护的属性s相关联，这将通过随后的公平感知测量来验证。</p><p id="1a4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集:X _测试_数值，X _测试['性别']，y _测试，y _预测</p><p id="ee2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Data = x { X_test_numerical，X_test['sex] }</p><p id="b12b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">受保护的属性= s { '女性'，'男性' }</p><p id="d54b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测结果= y_hat {0，1}</p><p id="853a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">真实类值= y {0，1}</p><p id="45be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">公平的衡量标准</strong></p><p id="42c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">统计奇偶差异</em></p><p id="ea4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">平等机会(EOD) </em></p><p id="9973" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jv">完全不同的虐待</em></p><p id="6980" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据集</strong></p><p id="b2b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使X数据集将X_test_numerical与列X_test['sex']合并。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lu"><img src="../Images/63a031f143228baa752a12f8743976c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CrpbzL1-7jtPDeVJ"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx"><strong class="bd lc">Table for each classifier combined with its prediction and real value y</strong></figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/5e4918d98c3e3160c962df35e2e1e8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0dDRBP48-bwrswfX"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">KNN</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/cb4f5eacf1bf923adc01a676c248c3e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MgieSocRD9ioeRsX"/></div></div><figcaption class="kr ks et er es kt ku bd b be z dx">Perceptron</figcaption></figure><p id="8efe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将对每个分类器和结果表应用3个度量的函数。</p><p id="a47c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">def statParityDif</p><p id="453b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">def等于OppDif</p><p id="77e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定义不同对待</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lx"><img src="../Images/b61aa1274b79bdef126fbb054856f397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Eqk3BU4ZWqxj_1c"/></div></div></figure><p id="c43c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">公平范围和直方图</strong></p><p id="bb61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了评估每个分类器的公平性，我们参考以下关于公平范围的论文(<a class="ae jd" href="https://arxiv.org/pdf/2110.13029.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2110.13029.pdf</a>)。</p><p id="f4e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果测量值落在-0.1到0.1之间的范围内，我们可以说分类器不包含对数据集中受保护属性S的偏向。换句话说，如果测量值低于-0.1或高于0.1，我们可以说分类器对属性s有偏差。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/c38ddb4859645697ad422f9618f0d00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8G8Awk5RyV6y32AL"/></div></div></figure><p id="f803" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除了分类器决策树的统计奇偶性差异之外，度量值都落入公平范围[-0.1，0.1]。与其他分类器相比，分类器决策树显示了稍微极端的测量值。总之，我们的培训模型中没有明显的歧视行为。</p><p id="15fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">减轻分类器歧视</strong></p><p id="8d7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦分类器已经被训练，即使是简单的情况也很难消除偏见。然而，有一些方法可以减轻它，这在页面<a class="ae jd" href="https://www.borealisai.com/en/blog/tutorial1-bias-and-fairness-ai" rel="noopener ugc nofollow" target="_blank">https://www . borealisai . com/en/blog/tutorial 1-bias-and-failure-ai</a>中有所提及。</p><p id="34d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们可以在预处理阶段接近它，这是关于通过计算潜在偏见来移除受保护的属性。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ly"><img src="../Images/069b7e11f7fef4c8a749bcbbea511df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K7ayOgsMDjmZFieu"/></div></div></figure><p id="6805" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种测量显示了数据x和受保护属性p之间的依赖程度，在上面的描述中是s。如果这个度量值增加，受保护的属性就变得更容易从数据中预测，这就给分类器的潜在辨别能力加上了数学界限。</p><p id="bf71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，它有一个缺点，即即使您消除了一个受保护的属性，剩下的其他要素也可能与受保护的属性密切相关，并可能被用于辨别。例如，种族与人的地址高度相关，因此仅移除种族特征不能移除分类器的偏见。</p><p id="56bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，有一种操作数据集的方法。它是关于数据对{x，y}的重新加权，其中x是数据集，y是类标签。这使得受保护属性p的弱势群体更有可能通过权重获得积极的结果。然后他们训练一个分类器，在它的成本函数中使用这些权重。或者，他们建议根据这些权重对训练数据进行重新采样，并使用标准分类器。</p><p id="8f73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，处理中的算法可以通过测量间接偏见来减少分类器包含的偏见。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lz"><img src="../Images/509030b79e11b176871730fb7640bd13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cZMDgXEJxdbC2Y3Q"/></div></div></figure><p id="0b9e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这度量了标签y和受保护属性p之间的依赖关系。如果度量可以忽略，则意味着很难从受保护属性预测标签，并且不存在偏差。</p><p id="0f26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> KNN实施</strong></p><p id="a218" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在实现K近邻算法时，我们参考了本页。<a class="ae jd" href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/tutorial-to-implement-k-nearest-neighbors-in-python-from scratch/</a></p><p id="4702" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">功能定义</strong></p><p id="447d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">两行之间的欧几里德距离</strong></p><p id="1a5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为KNN是基于两个实例有多近的标准，所以需要得到它们之间的距离的函数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ma"><img src="../Images/d87385a96bac13a02b434bf372479502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IBmy2nk22APf6dyU"/></div></div></figure><p id="43e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">基于距离的K个最近邻居</strong></p><p id="418a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基于实例之间的计算距离，我们将得到历史数据和新实例之间的k最小距离，这是得到结果的函数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/368e4a2924f448c5854431637bc703bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KgNRRAVTD3WsJB6S"/></div></div></figure></div><div class="ab cl lj lk gp ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="hb hc hd he hf"><p id="f826" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> KNN实施结果</strong></p><p id="89f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于运行时间太长，实现的KNN不可能处理测试集中的所有实例。然而，当我们尝试使用实例20的较小测试集时，我们观察到预测精度为0.75。因此，将实现的KNN与函数库进行比较是没有意义的，这仍然可以启发我们在方便的库中使用哪些方法或步骤，然后更好地理解算法。</p><p id="4aa2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">KNN的慢跑时间</strong></p><p id="c3ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与其他训练模式相比，它的速度很慢。这是因为该模型不能提前概括，而是必须查找所有历史数据，如果数据量很大，将会减慢计算过程。</p><p id="ba2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">改进</strong></p><p id="1a0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果使用余弦相似度而不是欧氏距离，时间复杂度可以得到改善。因为欧几里得包含的运算比余弦相似多。</p><p id="85a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">余弦相似度:n维空间中两个n维向量之间夹角的余弦值。它是两个向量的点积除以两个向量的长度(或幅度)的乘积。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/1ae264c4054bcc445fa4a3b72464dda9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rY3Wf4jOpppA_wu1"/></div></div></figure><p id="9525" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">完整代码:</strong><a class="ae jd" href="https://colab.research.google.com/drive/132A4iWdRVVE0LsOdCt_n0UzS_QHDnvKR?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">https://colab . research . Google . com/drive/132 a4 iwdrvve 0 lso DCT _ n0UzS _ QHDnvKR？usp =分享</strong> </a></p><p id="182d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考</strong></p><p id="49ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" rel="noopener" href="/analytics-vidhya/undersampling-and-oversampling-an-old-and-a-new-approach-4f984a0e8392">https://medium . com/analytics-vid hya/under sampling-and-over sampling-a-old-and-a-new-approach-4f 984 A0 e 8392</a></p><p id="fdd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://towardsdatascience.com/training-models-on-imbalanced-data-561fa3f842b5" rel="noopener" target="_blank">https://towards data science . com/training-models-on-unbalanced-data-561 fa 3f 842 b5</a></p><p id="4d2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://corporatefinanceinstitute.com/resources/excel/study/correlation-matrix/#:~:text=A%20correlation%20matrix%20is%20simply,visually%20represented%20in%20a%20scatterplot.&amp;text=A%20correlation%20matrix%20consists%20of%20rows%20and%20columns%20that%20show%20the%20variables" rel="noopener ugc nofollow" target="_blank">https://corporatefinanceinstitute . com/resources/excel/study/correlation-matrix/#:~:text = A % 20 correlation % 20 matrix % 20 is % 20简单地、直观地% 20表示% 20in % 20a %散点图。text = A % 20 correlation % 20 matrix % 20由% 20行% 20列% 20组成，显示% 20变量。</a></p><p id="79e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.borealisai.com/en/blog/tutorial1-bias-and-fairness-ai" rel="noopener ugc nofollow" target="_blank">https://www . borealisai . com/en/blog/tutorial 1-bias-and-failure-ai</a>。</p><p id="5173" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://arxiv.org/pdf/2110.13029.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2110.13029.pdf</a></p><p id="8c7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/tutorial-to-implement-k-nearest-neighbors-in-python-from scratch/</a></p><p id="f6e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://en.wikipedia.org/wiki/Supervised_learning<a class="ae jd" href="https://en.wikipedia.org/wiki/Supervised_learning" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>
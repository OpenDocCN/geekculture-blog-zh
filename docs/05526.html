<html>
<head>
<title>Your One-Stop Shop Intro to PWAs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您对PWAs的一站式介绍</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/your-one-stop-shop-intro-to-pwas-4770fcc5ccd5?source=collection_archive---------15-----------------------#2021-07-23">https://medium.com/geekculture/your-one-stop-shop-intro-to-pwas-4770fcc5ccd5?source=collection_archive---------15-----------------------#2021-07-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0033feaafb6b37c702564373cc42ef4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWGISgRy7ocoBfyorJ8QEg.png"/></div></div></figure><p id="ab94" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PWA！PWA！我们听到每个人都在赞美PWAs(渐进式web应用程序)的优点，但它到底是什么，为什么如此受欢迎，它是如何工作的？</p><p id="3e58" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这到底是什么？</p><p id="5548" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">PWAs是web应用程序，它允许您拥有一个适用于web和本地环境的单一代码库。我们可以使用我们熟悉的技术来构建一个普通的网站(即HTML/CSS/ Javascript)，但也可以通过访问设备硬件、推送通知和离线功能来获得无缝、独特的原生体验，这只是其中的几个例子。</p><p id="bfb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我们为什么要关心？</strong></p><p id="f61c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经确定，PWAs本质上是一个在跨平台设备上工作的增强型网站。因为PWA是通过互联网提供的，所以不需要下载就可以像本地应用程序一样运行。对于用户来说，与同一应用程序的本地版本相比，这将减少本地设备上使用的空间。与Android和iOS原生应用相比，Pinterest的PWA只占下载成本的一小部分，只有150KB(见下图)。作为一名开发者，你可以绕过通过应用商店发布应用的更严格的规则。也就是说，pwa<em class="jo"/>可以在app store中部署，这对可发现性是一个很好的补充。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jp"><img src="../Images/c1035f5df4cc1d14ce2a188050387973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ui7MxibwYvnmVfhBK7DKIw.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx">Source: <a class="ae jy" href="https://www.simicart.com/blog/pwa-case-studies/" rel="noopener ugc nofollow" target="_blank">https://www.simicart.com/blog/pwa-case-studies/</a></figcaption></figure><p id="697e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">另外，PWAs得到了<em class="jo">速度，</em>小✨.实现可靠、快速性能的最佳方法是通过<a class="ae jy" href="https://developers.google.com/web/updates/2015/11/app-shell" rel="noopener ugc nofollow" target="_blank">应用程序外壳架构。</a>把你的应用外壳想象成一个模板——一个应用启动所需的准系统——其中的内容将通过必要的API调用动态加载。您的PWA可以利用服务人员在初始加载时缓存您的应用程序外壳及其内容，以便页面可以在线和离线查看。这意味着用户仍然可以离线浏览您的应用程序，并通过您的服务人员在您的web浏览器中即时查看缓存的任何内容。请注意，在离线模式下发出的任何请求都可以排队，以便在连接可用时通过实现<a class="ae jy" href="https://blog.bitsrc.io/5-reasons-to-choose-pwa-for-your-web-and-mobile-apps-515c6d0e784d" rel="noopener ugc nofollow" target="_blank">后台同步来恢复。</a>很酷吧？</p><p id="283f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">难怪主要玩家已经进入这个领域，并享受其成果:<a class="ae jy" href="https://developers.google.com/web/showcase/2017/twitter" rel="noopener ugc nofollow" target="_blank"> Twitter报告称，通过尽可能依赖缓存数据，数据消耗减少了70%</a>,<a class="ae jy" href="https://developers.google.com/web/showcase/2017/forbes" rel="noopener ugc nofollow" target="_blank">Forbes看到每用户会话增加了43%</a>和<a class="ae jy" href="https://developers.google.com/web/showcase/2017/lancome" rel="noopener ugc nofollow" target="_blank">lanc me增加了17% </a>。令人印象深刻。公司正在认识到PWAs作为一种解决方案的经济性和高效性，以便为他们的品牌建立更好的用户体验。</p><p id="8657" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在哪里可以找到野生的PWA？👀</p><p id="d08c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可能已经见过甚至自己使用过PWA。让我们在网络浏览器上浏览星巴克的网站。请注意，PWA在Chrome浏览器的地址栏右侧会有一个“安装”图标，这将作为一个独立的应用程序打开星巴克网站。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/87c1a37e27f0b7118c5ebae6d50969b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*30BgwQS6W5MqJEOmWkD4rQ.png"/></div></div></figure><p id="3fd7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在iOS设备上，在Safari中打开应用程序，然后轻按“添加到主屏幕”瞧，您已经成功地在您的设备上安装了PWA！</p><figure class="jq jr js jt fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/0363459132dfa2cff6ca02913ab55048.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*o9H2Z4Dw29pkRGb4go8Zyg.png"/></div></figure><p id="3319" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">准备好潜得更深了吗？</strong></p><p id="7410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来看看使你的应用程序可安装并具有离线功能所需的最低要求。此外，查看<a class="ae jy" href="https://web.dev/pwa-checklist/" rel="noopener ugc nofollow" target="_blank"> PWA清单</a>并在你的Chrome开发者工具中生成一份Lighthouse报告，以确保你的应用满足核心要求并检查其性能得分。</p><ol class=""><li id="33fd" class="kb kc hi is b it iu ix iy jb kd jf ke jj kf jn kg kh ki kj bi translated">Manifest.json</li></ol><p id="6268" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">manifest.json文件只是根目录中的一个<code class="du kk kl km kn b">.json</code>文件，其中保存了应用程序的元数据。看看来自<a class="ae jy" href="https://web.dev/add-manifest/" rel="noopener ugc nofollow" target="_blank"> Google </a>的样本<code class="du kk kl km kn b">manifest.json</code>文件:</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="8602" class="ks kt hi kn b fi ku kv l kw kx">{<br/>  "short_name": "Weather",<br/>  "name": "Weather: Do I need an umbrella?",<br/>  "icons": [<br/>    {<br/>      "src": "/images/icons-192.png",<br/>      "type": "image/png",<br/>      "sizes": "192x192"<br/>    },<br/>    {<br/>      "src": "/images/icons-512.png",<br/>      "type": "image/png",<br/>      "sizes": "512x512"<br/>    }<br/>  ],<br/>  "start_url": "/?source=pwa",<br/>  "background_color": "#3367D6",<br/>  "display": "standalone",<br/>  "scope": "/",<br/>  "theme_color": "#3367D6"<br/>}</span></pre><p id="3e16" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的数据保存了你的应用程序的最小视图，而不需要发出网络请求。名称和至少一个图标(通常是您的徽标)是必需的。Chrome还将使用这些数据来创建一个闪屏，这样你的应用程序的用户在加载时就会有一个品牌视图。当用户查看你的应用程序时，他们总是知道自己在哪里，而没有空白加载屏幕的悬念。</p><p id="fc52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">确保你还记得在你的脚本中链接你的清单文件，并在Chrome DevTools的应用程序标签中测试它的配置是否正确😉</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="7a42" class="ks kt hi kn b fi ku kv l kw kx">&lt;link rel="manifest" href="/manifest.json"&gt;</span></pre><p id="3380" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.服务人员</p><p id="0f35" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">根据谷歌的说法，服务工作者“本质上是一个JavaScript文件，它独立于主浏览器线程运行，拦截网络请求，缓存或从缓存中检索资源，并传递推送消息。”它是一个强大的基于事件的异步API，可以执行不同的任务，并从本质上改变请求。因此，必须通过安全连接为服务人员提供服务，以通过SSL认证加密您的网络请求(除了<code class="du kk kl km kn b">localhost</code>)。请注意，服务人员无权访问DOM、localStorage或您的窗口，因为它是一个完全独立于您的站点的线程。</p><p id="3cbd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于服务人员来说，有3个关键的生命周期事件:注册、安装和激活。</p><figure class="jq jr js jt fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ky"><img src="../Images/447b8e9d6b00c1b11b0fed26556cf675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyUQfEo-S0zSDCgT68Y2Ig.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx">source: <a class="ae jy" href="https://www.simicart.com/blog/pwa-service-worker/" rel="noopener ugc nofollow" target="_blank">https://www.simicart.com/blog/pwa-service-worker/</a></figcaption></figure><p id="6311" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，注册服务人员将在安装位置查找并下载您的<code class="du kk kl km kn b">service-worker.js</code>文件，然后被激活。注册通常位于您的<code class="du kk kl km kn b">app.js</code>或<code class="du kk kl km kn b">index.html</code>文件中:</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="2118" class="ks kt hi kn b fi ku kv l kw kx">if('serviceWorker' in navigator) {<br/>  navigator.serviceWorker.register('./service-worker.js');<br/>};</span></pre><p id="f7de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，一旦您的服务人员成功注册，下一步就是安装它——这是大部分缓存魔术发生的地方。在您的<code class="du kk kl km kn b">service-worker.js</code>文件中，服务人员利用<a class="ae jy" href="https://web.dev/cache-api-quick-guide/" rel="noopener ugc nofollow" target="_blank">缓存API </a>，您可以在这里传入您的<a class="ae jy" href="https://developers.google.com/web/fundamentals/architecture/app-shell" rel="noopener ugc nofollow" target="_blank">应用程序外壳文件</a>。</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="1986" class="ks kt hi kn b fi ku kv l kw kx">const cacheName = 'demo-cache-name'</span><span id="170f" class="ks kt hi kn b fi kz kv l kw kx">const appShellFiles = [ ... ] // put your files paths here</span><span id="bc71" class="ks kt hi kn b fi kz kv l kw kx">self.addEventListener('install', (event) =&gt; {<br/>  event.waitUntil(async () =&gt; {<br/>    const cache = await caches.open(cacheName);<br/>    await cache.addAll(<!-- -->appShellFiles<!-- -->);<br/>  });<br/>});</span></pre><p id="5b08" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们可以激活我们的服务人员，您可以在那里管理您的缓存文件。请注意，一次只能运行一个版本的服务工作程序。如果已更新，它将不会运行，直到先前版本的服务工作程序没有客户端(刷新将导致客户端重叠)。这是清理缓存和整理服务人员版本的好地方。作为开发人员，如果<code class="du kk kl km kn b">self.skipWaiting()</code>更符合您的需求，您会发现它有助于在安装后立即激活服务人员。</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="2d50" class="ks kt hi kn b fi ku kv l kw kx">self.addEventListener('activate', (event) =&gt; {<br/>  // delete any caches that aren't in expectedCache<br/>  // which will get rid of previous sw<br/>  self.skipWaiting();<br/>  event.waitUntil(<br/>    caches.keys().then(keys =&gt; Promise.all(<br/>      keys.map(key =&gt; {<br/>        if (key !== expectedCache) {<br/>          return caches.delete(key);<br/>        }<br/>      })<br/>    ))<br/>  );<br/>});</span></pre><p id="58cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这三个事件总结了服务人员的生命周期，但是另一个经常使用的事件是<code class="du kk kl km kn b">fetch</code>。你猜对了，这就是我们可以告诉我们的服务人员使用Fetch API管理和处理缓存文件的地方。</p><pre class="jq jr js jt fd ko kn kp kq aw kr bi"><span id="3a0f" class="ks kt hi kn b fi ku kv l kw kx">self.addEventListener('fetch', (event) =&gt; {<br/>  event.respondWith(<br/>    caches.match(event.request)<br/>  );<br/>});</span></pre><p id="8859" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一点上，你可以在Chrome DevTools中导航到你的网络标签，并检查你的缓存文件在你勾选“离线”框时是否仍然可见。🥳</p><p id="cbfb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于服务人员来说，其他一些真正酷的用例是如上所述的后台同步、推送通知、集成IndexedDB以获得更大的数据存储容量，以及更多的自定义任务。</p><p id="cc29" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">最终想法</strong></p><p id="6122" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">没有什么新奇的技术，进入门槛很低，而且当你利用PWAs时，回报相当可观。已经转变为高质量pwa的公司的结果很有说服力，并推动了底线。现在，这一切都解释了为什么它们会风靡一时。</p><p id="aca7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">唷！我们已经了解了PWAs的大部分内容，但是如果你还不满足，下面是一些进一步的阅读材料:</p><ul class=""><li id="52ff" class="kb kc hi is b it iu ix iy jb kd jf ke jj kf jn la kh ki kj bi translated"><a class="ae jy" href="https://developers.google.com/web/ilt/pwa/live-data-in-the-service-worker" rel="noopener ugc nofollow" target="_blank">如何将IndexedDB整合到您的PWA中</a></li><li id="e89f" class="kb kc hi is b it lb ix lc jb ld jf le jj lf jn la kh ki kj bi translated"><a class="ae jy" href="https://infrequently.org/2015/06/progressive-apps-escaping-tabs-without-losing-our-soul/" rel="noopener ugc nofollow" target="_blank">进步的网络应用:逃离标签而不丢失我们的灵魂</a></li><li id="a787" class="kb kc hi is b it lb ix lc jb ld jf le jj lf jn la kh ki kj bi translated"><a class="ae jy" href="https://infrequently.org/2016/09/what-exactly-makes-something-a-progressive-web-app/" rel="noopener ugc nofollow" target="_blank">到底是什么让某个东西成为一个进步的网络应用</a></li><li id="8cb6" class="kb kc hi is b it lb ix lc jb ld jf le jj lf jn la kh ki kj bi translated"><a class="ae jy" href="https://web.dev/service-worker-mindset/" rel="noopener ugc nofollow" target="_blank">服务人员心态</a></li></ul></div></div>    
</body>
</html>
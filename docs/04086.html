<html>
<head>
<title>Drug-Target interaction prediction through Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Python预测药物-靶标相互作用</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/drug-target-interaction-prediction-through-python-4af9e76fc90?source=collection_archive---------27-----------------------#2021-06-21">https://medium.com/geekculture/drug-target-interaction-prediction-through-python-4af9e76fc90?source=collection_archive---------27-----------------------#2021-06-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5fee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我展示了使用SVD(奇异值分解)和矩阵分解来预测药物-靶标相互作用的Python代码片段，这在推荐系统中被大量使用。这个实现的核心逻辑是基于<a class="ae jd" href="https://www.nature.com/articles/s41467-017-00680-8" rel="noopener ugc nofollow" target="_blank">罗等人的论文</a>。</p><p id="2623" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://drugcentral.org/about" rel="noopener ugc nofollow" target="_blank">药物中心</a>提供药物信息资源。我们可以从文献综述、药物标签和外部数据源下载已知的药物-靶标相互作用。截至2021年6月18日，<a class="ae jd" href="https://drugcentral.org/download" rel="noopener ugc nofollow" target="_blank">药物中心</a>共有2529种药物、2870个靶点和17390个药物-靶点相互作用。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4bd0fa035749f5da9fde65e346492b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cA-di3af3hKcm2-0UabtA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Drug-Target interaction</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ju"><img src="../Images/a3e7fbc967e23a1f9ae00cbef3824d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyET3Zs7oJFM-lrjDex0iA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Drug-target interaction file loading, summary of drug and target.</figcaption></figure><p id="214a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了发现新的药物-靶标相互作用候选物，如果我们可以发现相似的药物或靶标特征(例如，化学结构、副作用、疾病关联)并假设药物作用机制对相似的药物或靶标类型有效，已知的药物-靶标相互作用可以是一个很好的起点。</p><p id="5912" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">药物-靶标相互作用的矩阵大小为7，258，230 (=2529种药物× 2870种靶标)，目前已知的相互作用为17390，仅占药物-靶标空间的0.0024%。<a class="ae jd" href="https://www.nature.com/articles/s41467-017-00680-8" rel="noopener ugc nofollow" target="_blank">罗等</a>介绍了一种用于药物-靶标相互作用预测的网络集成方法，并开发了<a class="ae jd" href="https://github.com/luoyunan/DTINet" rel="noopener ugc nofollow" target="_blank"> DTINet </a>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jv"><img src="../Images/4696636c934307c3d795b1dd8a0a2702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XC9v3iXzfhZx4xlpGEd--A.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx"><a class="ae jd" href="https://public.tableau.com/views/DrugCentral_DrugTargetInteraction/Dashboard?:language=en-US&amp;:display_count=n&amp;:origin=viz_share_link" rel="noopener ugc nofollow" target="_blank">Drug-Target sparse matrix chart.</a> Each blue dot(17390) is a drug-target interaction. Yellow highlighted dot shows one drug-target interaction (cefotetan-P03956)</figcaption></figure><p id="291e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DTINet由以下五个步骤组成。让我们实现每一步。</p><ul class=""><li id="f55e" class="jw jx hi ih b ii ij im in iq jy iu jz iy ka jc kb kc kd ke bi translated">步骤1:收集药物和目标(蛋白质)信息</li><li id="824b" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">步骤2:使用Jaccard距离生成相似性矩阵</li><li id="1966" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">步骤3:使用奇异值分解降低相似矩阵维数</li><li id="bf11" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">步骤4:矩阵完成搜索新的药物-目标相互作用</li><li id="d526" class="jw jx hi ih b ii kf im kg iq kh iu ki iy kj jc kb kc kd ke bi translated">步骤5:评估预测的药物-靶标相互作用</li></ul><blockquote class="kk kl km"><p id="40d3" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">步骤1:收集药物和目标(蛋白质)信息</strong></p></blockquote><p id="a261" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://github.com/luoyunan/DTINet/tree/master/data" rel="noopener ugc nofollow" target="_blank"> DTINet </a>共享来自各种数据源的原始数据。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kr"><img src="../Images/a66c0e0c9e49ba42a39aa45641303d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DeMDEVdcmyyXXr8Ba6XeYA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx"><a class="ae jd" href="https://www.notion.so/Drug-Target-interaction-prediction-through-Python-caa453aef2894b5e9bb271ed12943540" rel="noopener ugc nofollow" target="_blank">Drug/Target information</a></figcaption></figure><p id="2dfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过许多药物信息提供商(如DrugCentral、ChEMBL、OpenTarget)的API服务，我们可以下载一个实时数据。但是这增加了代码的复杂性，所以我使用DTINet数据来理解整个过程。在下一篇文章中，我将把API服务应用到这个过程中。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ks"><img src="../Images/1abdfd035b5dbfd33daa9e306157351a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_y0JQY02Z_K2pDVEtVKtA.png"/></div></div></figure><blockquote class="kk kl km"><p id="fd12" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">步骤2:使用Jaccard距离生成相似性矩阵</strong></p></blockquote><p id="eee0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2计算每个特征的相似性距离。例如，药物-疾病表由1或0值组成。值1是药物和疾病之间的真实关联。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kt"><img src="../Images/b2acf69a34db21f40e0999237f925c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwHpLYdRAokgRkomnrvkrQ.png"/></div></div></figure><p id="eb11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用Jaccard相似性系数来计算相似性距离。药物-疾病关联越相似，产生的Jaccard系数越高。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ku"><img src="../Images/8ec617954b48c3bc04735b1da3a9e434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pqs1Tc_k8Byr0OrCrZkoUQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Jaccard similarity coefficient of drugs for diseases</figcaption></figure><blockquote class="kk kl km"><p id="ebc3" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">步骤3:使用奇异值分解降低相似矩阵维数</strong></p></blockquote><p id="c395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦计算出所有的相似性矩阵，它就将分离的矩阵分别连接到药物和目标矩阵。药物有四个相似度矩阵，行数和列数为708×2832(行:药物，列:药物相互作用+疾病+副作用+药物相似度)。在连接之前，需要对值进行规范化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kv"><img src="../Images/a5e0354d0d7b4b31854473a8824c3d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hh_U7nDAuZ6U32dcOdRTFw.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Concatenate matrix of Drug similarity</figcaption></figure><p id="1fe1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">药物相似度维数为2832，目标相似度维数为4536。使用SVD算法，降低到100维。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kw"><img src="../Images/6c1873f9868f73560ee96aed5947020c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUZaJhB7wfOxtv7_ZCOviQ.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Truncated drug similarity table using SVD</figcaption></figure><blockquote class="kk kl km"><p id="1904" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">步骤4:矩阵完成以搜索新的药物-靶标相互作用</strong></p></blockquote><p id="4c6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过步骤1到步骤3，我们生成了已知药物-靶标相互作用表(R: 708×1512)、药物相似度表(P: 708×100)和靶标相似度表(Q: 1512×100)。利用这些矩阵，我们可以采用推荐系统中常用的矩阵分解算法。</p><p id="eaeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">DTINet使用了于等人开发的归纳矩阵完成 (IMC)，因为IMC提供了Matlab或者C++/Python或者Matlab的包装器，所以我应用了纯Python脚本编写的<a class="ae jd" href="https://towardsdatascience.com/recommendation-system-matrix-factorization-d61978660b4b" rel="noopener" target="_blank">矩阵分解计算</a>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es kx"><img src="../Images/e7e768b89bb74f7bae42dfbe167b1edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-xDI4ESp21nTuwWHYCDwA.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Matrix factorization calculation</figcaption></figure><blockquote class="kk kl km"><p id="e1c0" class="if ig kn ih b ii ij ik il im in io ip ko ir is it kp iv iw ix kq iz ja jb jc hb bi translated"><strong class="ih hj">步骤5:评估预测的药物-靶标相互作用</strong></p></blockquote><p id="7c8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，我们将通过矩阵分解计算的药物靶标矩阵与已知的药物靶标矩阵进行比较。有许多估计方法(如中华民国，RMSE)。我使用Sci-kit learn中的roc_auc_score函数来计算roc曲线下的面积(ROC AUC)。</p><p id="8736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分数差是因为机器学习算法和训练场景差。此外，它是一个非常稀疏的矩阵，所以梯度算法的性能在我看来很低。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ky"><img src="../Images/6fbe148b99d202c490ceec29b72e0d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCDfk-HTMg5DXnMhE9YDKg.png"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">ROC AUC score</figcaption></figure><p id="6ea5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将重点介绍使用Python实现药物-靶标交互模型。<a class="ae jd" href="https://pubmed.ncbi.nlm.nih.gov/33912218/" rel="noopener ugc nofollow" target="_blank">刘等</a>采用了图卷积网络()。我将为下一篇文章准备一个演示。</p><p id="a9e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">源代码写在<a class="ae jd" href="https://colab.research.google.com/drive/1drR0JvLIBtL1BIqw5CXPl5hQHdPSblhK?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>和<a class="ae jd" href="https://public.tableau.com/app/profile/byeungchun.kwon/viz/DrugCentral_DrugTargetInteraction/Dashboard" rel="noopener ugc nofollow" target="_blank">drug central数据的稀疏图</a>在Tableau公共网站。</p><div class="kz la ez fb lb lc"><a href="https://colab.research.google.com/drive/1drR0JvLIBtL1BIqw5CXPl5hQHdPSblhK?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab dw"><div class="le ab lf cl cj lg"><h2 class="bd hj fi z dy lh ea eb li ed ef hh bi translated">谷歌联合实验室</h2><div class="lj l"><h3 class="bd b fi z dy lh ea eb li ed ef dx translated">药物-靶标相互作用预测</h3></div><div class="lk l"><p class="bd b fp z dy lh ea eb li ed ef dx translated">colab.research.google.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq jo lc"/></div></div></a></div><p id="66b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">Tableau Dashboard—</strong><a class="ae jd" href="https://public.tableau.com/app/profile/byeungchun.kwon/viz/DrugCentral_DrugTargetInteraction/Dashboard" rel="noopener ugc nofollow" target="_blank">https://public . Tableau . com/app/profile/byeungchun . kwon/viz/drug central _ DrugTargetInteraction/Dashboard</a></p></div></div>    
</body>
</html>
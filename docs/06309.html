<html>
<head>
<title>Using Daily’s video chat API with Anvil</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Anvil使用Daily的视频聊天API</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/using-dailys-video-chat-api-with-anvil-689c5a10e7b4?source=collection_archive---------35-----------------------#2021-08-16">https://medium.com/geekculture/using-dailys-video-chat-api-with-anvil-689c5a10e7b4?source=collection_archive---------35-----------------------#2021-08-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://www.daily.co/" rel="noopener ugc nofollow" target="_blank"> Daily </a>的API让你只需几行代码就能给任何应用添加实时视频通话。<a class="ae jd" href="https://anvil.works" rel="noopener ugc nofollow" target="_blank"> Anvil </a>使得完全用Python构建web应用程序变得容易——不需要Javascript。在这篇文章中，我将告诉你如何一起使用它们，并告诉你如何开始使用Daily的API。</p><p id="2c53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将开发一款应用程序，让您的用户加入视频通话。您可以将它与任何东西集成，例如基于网络游戏的通信、基于视频的协作软件或实时客户支持。(点击此处<a class="ae jd" href="https://anvil.works/learn/examples" rel="noopener ugc nofollow" target="_blank">查看一些您可以使用Anvil构建的应用示例</a>。)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/d069ed5563606f6266a43cc905a259a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2wDmBumeITf-lcymBUB_pg.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Daily call being started</figcaption></figure><p id="65db" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">等等Daily不是JavaScript API吗？没错，但是用Anvil </em> <strong class="ih hj"> <em class="ju">可以将Javascript库导入到你的Python前端</em> </strong> <em class="ju">。怎么会？继续阅读… </em></p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="5b00" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">创建加入视频通话的表单</h1><h2 id="c23f" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">创建应用程序</h2><p id="5d30" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">用Anvil创建web应用程序很简单。我们将创建一个来开始。</p><p id="f767" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://anvil.works/login" rel="noopener ugc nofollow" target="_blank">登录</a>到Anvil，点击‘新建空白App’。选择材料设计主题。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lt"><img src="../Images/08f50d0437e7903b74076881d010ee9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*39h74euK9NW3GG43.png"/></div></div></figure><h2 id="9b50" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">创建用户界面</h2><p id="cafc" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">我们需要一个带有文本框的表单来输入我们的会议室的名称和按钮来开始和停止通话。我们完成的表单看起来会像这样:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lu"><img src="../Images/b79b9864f9c451abac8df06f65100907.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*TH7M9huvZMKKVuJw0ByoWw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">Finished call form</figcaption></figure><p id="1bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们通过拖放<a class="ae jd" href="https://anvil.works/docs/client/components" rel="noopener ugc nofollow" target="_blank">组件</a>来构建表单。让我们从将一张卡片放入表单开始。然后将一个<a class="ae jd" href="https://anvil.works/docs/client/components/basic#textbox" rel="noopener ugc nofollow" target="_blank">文本框</a>拖到卡片中，在右边的属性面板中，将组件的名称改为<code class="du lv lw lx ly b">room_name_textbox</code>。</p><p id="da7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在文本框下方，拖放两个<a class="ae jd" href="https://anvil.works/docs/client/components/basic#button" rel="noopener ugc nofollow" target="_blank">按钮</a>。将第一个按钮的名称改为<code class="du lv lw lx ly b">start_call_button</code>，文本改为<code class="du lv lw lx ly b">Start call</code>。将第二个按钮的名称改为<code class="du lv lw lx ly b">end_call_button</code>，文本改为<code class="du lv lw lx ly b">End call</code>。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/7340c91525d7b4ea652a393b544d1e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*nE9GfVbFh6CQ4V9hicQUyg.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Building our call form</figcaption></figure><p id="d70a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就是这样！我们的用户界面已经完成。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="63d2" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">使用每日API</h1><h2 id="65bb" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">创建每日视频通话室</h2><p id="26d4" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">我们需要创建一个我们的Anvil应用程序用户可以加入的视频通话室。</p><p id="b284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们转到<a class="ae jd" href="https://dashboard.daily.co/rooms" rel="noopener ugc nofollow" target="_blank">https://dashboard.daily.co/rooms</a>，点击<code class="du lv lw lx ly b">Create room</code>并给我们的房间命名。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/6b417e1cdca6d8edb97017ec93e7fcfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*L34gzEPXVaJ2N8nXEADjOw.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Creating a room</figcaption></figure><p id="b451" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于创建房间的更多信息，每日有一个有用的指南<a class="ae jd" href="https://docs.daily.co/docs/experiment-in-the-dashboard#step-by-step-guide-create-a-daily-room-url-from-the-dashboard" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p><h2 id="9529" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">导入每日API库</h2><p id="f634" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">要导入Daily的库，请导航到我们应用程序的<a class="ae jd" href="https://anvil.works/docs/client/javascript#using-native-javascript-libraries" rel="noopener ugc nofollow" target="_blank">原生库</a>并添加以下代码行:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="5fe4" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">开始通话</h2><p id="f202" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">Anvil允许您在Python代码中导入和使用JavaScript函数——为您处理所有转换。让我们编写用户界面启动呼叫所需的代码。</p><p id="cedb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">导航回我们的<code class="du lv lw lx ly b">Form1</code>，在表单的<a class="ae jd" href="https://anvil.works/docs/editor#code-view" rel="noopener ugc nofollow" target="_blank">代码视图</a>的顶部，导入<code class="du lv lw lx ly b"><a class="ae jd" href="https://docs.daily.co/reference#the-dailyiframe-class" rel="noopener ugc nofollow" target="_blank">DailyIframe</a></code> <a class="ae jd" href="https://docs.daily.co/reference#the-dailyiframe-class" rel="noopener ugc nofollow" target="_blank">类</a>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="af56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，回到表单的<a class="ae jd" href="https://anvil.works/docs/editor#design-view" rel="noopener ugc nofollow" target="_blank">设计视图</a>，为我们的<code class="du lv lw lx ly b">start_call_button</code>创建一个点击事件处理程序。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/68bd42416d882e8a9f09f6a805fe410c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qyH0h0B4wl4Abfn2xQdApA.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Adding a click event to our ‘Start call’ button</figcaption></figure><p id="91b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每次点击按钮都会调用<code class="du lv lw lx ly b">start_call_button_click</code>函数。在该函数中，我们将检查用户是否输入了房间名称，然后创建一个名为<code class="du lv lw lx ly b">call_frame</code>的<code class="du lv lw lx ly b">DailyIframe</code>实例。然后，我们将调用<code class="du lv lw lx ly b">DailyIframe</code>的方法，将我们的会议室链接加上<code class="du lv lw lx ly b">room_name</code>作为参数传递给它。</p><p id="63e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">(将</em> <code class="du lv lw lx ly b"><em class="ju">'https://your-team.daily.co/'</em></code> <em class="ju">替换为自己的会议室链接，可以在自己的</em> <a class="ae jd" href="https://dashboard.daily.co/" rel="noopener ugc nofollow" target="_blank"> <em class="ju">每日仪表盘</em> </a> <em class="ju">中找到)。)</em></p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><h2 id="c746" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">如果那个房间不存在呢？</h2><p id="cc14" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">如果指定的房间不存在，<code class="du lv lw lx ly b">join()</code>方法将抛出异常。我们可以用通常的方法抓住它，用一个木块。然后我们会用Anvil的函数弹出一个对话框:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="b9e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是我们的开始通话功能完成。让我们编写结束呼叫的功能。</p><h2 id="a601" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">结束通话</h2><p id="a743" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">当用户点击“结束呼叫”时，我们希望通过调用<code class="du lv lw lx ly b">DailyIframe</code>的和方法来结束呼叫。</p><p id="af51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像我们对<code class="du lv lw lx ly b">start_call_button</code>所做的那样，为<code class="du lv lw lx ly b">end_call_button</code>创建一个名为<code class="du lv lw lx ly b">end_call_button_click</code>的事件处理函数。然后调用这些方法:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lz ma l"/></div></figure><p id="d203" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">干得好！我们的应用程序的用户现在可以输入他们想要加入的会议名称，开始和结束通话，而无需离开您的Anvil应用程序。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="801f" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">就是这样！</h1><p id="fd1f" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">我们刚刚只用Python创建了一个web应用程序；将它与Daily整合在一起，让它只需点击一个按钮就可以开始视频通话。很酷吧。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/d069ed5563606f6266a43cc905a259a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2wDmBumeITf-lcymBUB_pg.gif"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Daily call being started</figcaption></figure><h2 id="703b" class="la kd hi bd ke lb lc ld ki le lf lg km iq lh li kq iu lj lk ku iy ll lm ky ln bi translated">克隆应用程序</h2><p id="7b3a" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">如果你想看这个应用的源代码，你可以<strong class="ih hj">在这里</strong>克隆完成的应用:</p><div class="mb mc ez fb md me"><a href="https://anvil.works/build#clone:PGXAZV7D53UI5FCJ%3d6VO4CP4AGJI4LHMCURXCYN2R" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hj fi z dy mj ea eb mk ed ef hh bi translated">注册</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">Anvil是一个免费的基于Python的拖放式web应用构建器</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">铁砧工厂</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jo me"/></div></div></a></div></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="7f9c" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">刚接触Anvil？</h1><p id="5f79" class="pw-post-body-paragraph if ig hi ih b ii lo ik il im lp io ip iq lq is it iu lr iw ix iy ls ja jb jc hb bi translated">如果你是新来的，欢迎！Anvil是一个只使用Python就能构建全栈web应用的平台。不需要与JS、HTML、CSS、Python、SQL和它们所有的框架角力——只需要用Python 构建所有的框架。</p><p id="3552" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是—在浏览器中运行<a class="ae jd" href="https://anvil.works/docs/client/python" rel="noopener ugc nofollow" target="_blank">的Python。在服务器</a>上运行的<a class="ae jd" href="https://anvil.works/docs/server" rel="noopener ugc nofollow" target="_blank">python。Python让</a><a class="ae jd" href="https://anvil.works/docs/client" rel="noopener ugc nofollow" target="_blank">构建你的UI </a>。一个<a class="ae jd" href="https://anvil.works/docs/client/ui" rel="noopener ugc nofollow" target="_blank">拖放UI编辑器</a>。我们甚至有一个内置的<a class="ae jd" href="https://anvil.works/docs/data-tables" rel="noopener ugc nofollow" target="_blank"> Python数据库</a>，以防你没有自己的数据库。</p><p id="eb10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么不试试应用程序构建器呢？<strong class="ih hj">免费的！</strong>点击此处开始:</p><p id="9d8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://anvil.works/build" rel="noopener ugc nofollow" target="_blank">https://anvil.works/build</a></p><p id="1a2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">想试试别的教程吗？</strong>通过我们的反馈表单教程了解Anvil中的数据库:</p><p id="9be8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jd" href="https://anvil.works/learn/tutorials/feedback-form" rel="noopener ugc nofollow" target="_blank">https://anvil.works/learn/tutorials/feedback-form</a></p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="9693" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">原发布于</em><a class="ae jd" href="https://anvil.works/articles/daily-co-video-chat" rel="noopener ugc nofollow" target="_blank"><em class="ju">https://anvil . works</em></a><em class="ju">。</em></p></div></div>    
</body>
</html>
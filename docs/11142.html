<html>
<head>
<title>Introduction to PyTorch for Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习PyTorch简介</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/introduction-to-pytorch-for-deep-learning-483d4a65d594?source=collection_archive---------2-----------------------#2022-03-07">https://medium.com/geekculture/introduction-to-pytorch-for-deep-learning-483d4a65d594?source=collection_archive---------2-----------------------#2022-03-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><h2 id="76b7" class="hg hh hi bd b fp hj hk hl hm hn ho dx hp translated" aria-label="kicker paragraph">深度学习教程</h2><div class=""/><div class=""><h2 id="b09c" class="pw-subtitle-paragraph io hr hi bd b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf dx translated">基于迁移学习的PyTorch图像分类。</h2></div><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/c90479d15f93d3d53c952191bb6dc10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*meaiTcEbax8BRbbA"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx">Photo by <a class="ae jw" href="https://unsplash.com/@acharki95?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aziz Acharki</a> on <a class="ae jw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fa28" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">推荐系统、网络搜索、语言翻译、无人驾驶汽车等人工智能应用改变了我们的生活。人工智能最热门的子领域之一是深度学习。</p><p id="4beb" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">深度学习是人工神经网络的扩展。人工神经网络由一个隐藏层组成，而深度神经网络由多个隐藏层组成。</p><p id="7220" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">深度学习分析中用到很多矩阵运算。您需要使用一个库来实现这些操作。深度学习使用最多的库是PyTorch和TensorFlow。TensorFlow多用于工业，PyTorch多用于学术研究。</p><p id="5342" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在这篇文章中，我将谈论深度学习的PyTorch。总而言之，</p><ul class=""><li id="bcfa" class="kt ku hi jz b ka kb kd ke kg kv kk kw ko kx ks ky kz la lb bi translated">PyTorch是什么？</li><li id="e050" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks ky kz la lb bi translated">PyTorch的优点。</li><li id="5b3e" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks ky kz la lb bi translated">如何安装PyTorch？</li><li id="3350" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks ky kz la lb bi translated">用真实世界的数据集练习。</li></ul><p id="4501" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">举个简单的例子，我从网上拿一张图片，用PyTorch预测这张图片的类别。对于想要学习PyTorch的初学者来说，这是一个完美的例子。在这个例子中，我将使用一张狗的图片并预测狗的属。如果你愿意，你可以使用不同的图片，如茶或花。</p><p id="7d1a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在开始之前，请不要忘记订阅我们的youtube频道，我们在那里创建关于人工智能、数据科学、机器学习和深度学习的内容👇</p><div class="lh li ez fb lj lk"><a href="https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">蒂伦达兹学院</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">Tirendaz Academy是一个在线教育平台，在数据科学、人工智能、机器…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">www.youtube.com</p></div></div><div class="lt l"><div class="lu l lv lw lx lt ly jq lk"/></div></div></a></div><p id="652b" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们深入了解PyTorch是什么。</p></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><h1 id="8af0" class="mg mh hi bd mi mj mk ml mm mn mo mp mq ix mr iy ms ja mt jb mu jd mv je mw mx bi translated">PyTorch是什么</h1><p id="8e22" class="pw-post-body-paragraph jx jy hi jz b ka my is kc kd mz iv kf kg na ki kj kk nb km kn ko nc kq kr ks hb bi translated">PyTorch是一个用Python语言编写的流行库。专门用于深度学习。PyTorch主要是由脸书开发的。它后来在2017年成为一个免费的开源库。</p><p id="369c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">使用PyTorch，您可以轻松地执行数组操作并构建动态神经网络。您也可以使用GPU来加速这些过程。换句话说，你可以简单灵活地使用PyTorch来制作快速的深度学习项目。</p><p id="8ce0" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">那么为什么要选择PyTorch呢？让我们来看看PyTorch的优点。</p><div class="lh li ez fb lj lk"><a href="https://www.youtube.com/shorts/9yD_AZeAD6A" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">找数据科学工作的5个技巧</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">数据科学技巧|数据科学家路线图|人工智能与机器学习和深度学习教程(python 2022Hi…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">www.youtube.com</p></div></div><div class="lt l"><div class="nd l lv lw lx lt ly jq lk"/></div></div></a></div><h1 id="e861" class="mg mh hi bd mi mj ne ml mm mn nf mp mq ix ng iy ms ja nh jb mu jd ni je mw mx bi translated">为什么是PyTorch？</h1><p id="d0e1" class="pw-post-body-paragraph jx jy hi jz b ka my is kc kd mz iv kf kg na ki kj kk nb km kn ko nc kq kr ks hb bi translated">它非常受欢迎，因为PyTorch易于使用。它有一个庞大的开发者和用户社区。许多公司和研究小组使用PyTorch进行深度学习。因此，了解PyTorch在工业界和学术界都是一项抢手的技能。</p><p id="2387" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">您还可以使用PyTorch进行端到端的项目。也就是说，你可以将它与PyTorch一起用于深度学习项目步骤，如数据预处理、模型构建和模型部署。</p><p id="06e9" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如你所知，Python是一种解释性语言。在PyTorch中，它以渴望模式工作，因为它是用Python编写的。换句话说，您可以立即看到您用PyTorch编写的代码的结果。因此，您可以很容易地找到您的调试代码。</p><p id="9398" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">云对于大数据非常重要。像AWS或Azure这样的云服务让你的工作变得更容易，因为深度学习与大数据一起工作。你可以在云平台上使用PyTorch。</p><p id="7e3d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">深度学习需要强大的计算机。如果你没有强大的电脑，也不用担心。你可以在Google Colab和Kaggle内核上免费使用PyTorch。</p><p id="20a9" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">PyTorch支持并行计算。所以你可以在PyTorch中使用GPU或者TPU进行数学运算。因此，你可以更快地完成深度学习过程。</p><p id="2ce3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">PyTorch拥有一个庞大的生态系统以及基于PyTorch的开源库。比如让深度学习项目代码编写变得简单的fastai，就是基于PyTorch编写的。有了fastai，你可以同时分析计算机视觉和自然语言处理。</p><p id="b24a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如你所见，PyTorch是深度学习项目的完美库。选择PyTorch的理由还有很多。我在这里只提到了一些重要的优势。让我们继续，看看如何安装PyTorch。</p><div class="lh li ez fb lj lk"><a href="https://www.youtube.com/shorts/81r8_xrfWqc" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">数据科学的7个真实例子</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">现实生活中的数据科学示例|数据科学应用|机器学习和深度学习项目嗨，伙计们…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">www.youtube.com</p></div></div><div class="lt l"><div class="nj l lv lw lx lt ly jq lk"/></div></div></a></div></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><h1 id="99b4" class="mg mh hi bd mi mj mk ml mm mn mo mp mq ix mr iy ms ja mt jb mu jd mv je mw mx bi translated">PyTorch装置</h1><p id="3a1e" class="pw-post-body-paragraph jx jy hi jz b ka my is kc kd mz iv kf kg na ki kj kk nb km kn ko nc kq kr ks hb bi translated">如果你有一台功能强大的电脑，你可以在电脑上安装PyTorch。在你的电脑上安装PyTorch非常简单。PyTorch的官方网站通过准备一个简单的界面使安装变得容易。要安装PyTorch，去PyTorch的官网，选择合适的选项，然后就创建了一个命令。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es nk"><img src="../Images/df9feef60251121524576f90a4e2c061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UyAKTq5uuY-t0L2T4E3eQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx"><a class="ae jw" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank">PyTorch Installation</a></figcaption></figure><p id="5332" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">之后，在终端或您在anaconda中创建的虚拟环境中运行这个命令。要在Anaconda上安装PyTorch，请打开Anaconda提示符并设置以下代码来创建一个新的虚拟环境。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="da32" class="nq mh hi nm b fi nr ns l nt nu">conda create — name pytorch</span></pre><p id="41d6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">创建了一个名为PyTorch的新虚拟环境。接下来，你要激活这个环境。为此:</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="64f5" class="nq mh hi nm b fi nr ns l nt nu">conda activate pytorch</span></pre><p id="e0e8" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">之后，将从PyTorch站点复制的命令粘贴到这里。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="4f25" class="nq mh hi nm b fi nr ns l nt nu">conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch</span></pre><p id="bb68" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">就这么简单。如果你的电脑有NVIDIA显卡，别忘了选择GPU选项。有了GPU，你可以把你的深度学习分析速度提高50倍。</p><p id="9a6f" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如果你没有强大的电脑，也不用担心，你也可以利用AWS这样的云平台做深度学习分析。但是使用这项服务是要付费的。</p><p id="9b5e" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如果你想免费做你的深度学习分析，你可以用Colab。Colab是谷歌提供的基于云的免费服务。Colab的界面类似于Jupyter笔记本。您可以在Colab中运行您的Python代码。也可以配合GPU使用Colab。</p><p id="af8c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">PyTorch安装在Colab中，所以不需要单独安装。现在来看看PyTorch的安装版本。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="f658" class="nq mh hi nm b fi nr ns l nt nu">import torch<br/>print(torch.__version__)</span></pre><p id="b660" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Colab的一个优点是界面类似于Jupyter笔记本。如果你知道如何使用Jupyter笔记本，你可以很容易地使用Colab。默认情况下，Colab不支持GPU。我们来看看这个。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="2169" class="nq mh hi nm b fi nr ns l nt nu">print(torch.cuda.is_available())</span></pre><p id="40b4" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">输出为假。要使用GPU，请从运行时菜单中选择更改运行类型，并从硬件加速器部分选择GPU。</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es nv"><img src="../Images/1653f600c1942850004b71924d70e1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*2CiBSQ9ysjLAMkjY0Ta3Wg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx">Change Run Type</figcaption></figure><p id="a701" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我们再次运行这个命令。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="0c54" class="nq mh hi nm b fi nr ns l nt nu">print(torch.cuda.is_available())</span></pre><p id="5ce9" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">true被写到屏幕上。之后，我的代码在GPU上运行。如果你买的是Pro版的Colab，可以用更好的GPU，更大的内存。免费版本足以满足我在这篇博文中将要做的分析。</p><p id="5f49" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">到目前为止，已经向我介绍了PyTorch并展示了如何安装它。我希望一切都好。你可以在评论区写下你的问题。最好的学习方法是通过做让我们继续做一个简单的应用程序来理解PyTorch。</p><div class="lh li ez fb lj lk"><a href="https://www.youtube.com/shorts/iYSWwZeEC2c" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">7个了不起的计算机视觉项目创意</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">计算机视觉项目创意机器学习应用深度学习人工智能项目Python AI…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">www.youtube.com</p></div></div><div class="lt l"><div class="nw l lv lw lx lt ly jq lk"/></div></div></a></div></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><h1 id="d598" class="mg mh hi bd mi mj mk ml mm mn mo mp mq ix mr iy ms ja mt jb mu jd mv je mw mx bi translated">Pytorch应用</h1><p id="738f" class="pw-post-body-paragraph jx jy hi jz b ka my is kc kd mz iv kf kg na ki kj kk nb km kn ko nc kq kr ks hb bi translated">现在让我向你展示如何使用PyTorch进行图像分类。在本练习中，我将从互联网上获取一张图片，并指定这张图片的类别。</p><p id="b9bc" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在2000年代，图像分类是一个难题。但是2010年以后，随着新架构的发展和GPU的提升，图像分类变得更容易做了。</p><blockquote class="nx"><p id="4bea" class="ny nz hi bd oa ob oc od oe of og ks dx translated">你可以在这里找到我在这篇博文<a class="ae jw" href="https://github.com/TirendazAcademy/Deep-Learning-with-PyTorch/blob/main/1-Introduction_PyTorch.ipynb" rel="noopener ugc nofollow" target="_blank">中使用的笔记本。</a></p></blockquote><p id="c3e6" class="pw-post-body-paragraph jx jy hi jz b ka oh is kc kd oi iv kf kg oj ki kj kk ok km kn ko ol kq kr ks hb bi translated">例如，让我们给一只狗拍照。如果您愿意，可以使用不同的图像进行分析。让我们使用urlib库从web上获取一个图像。首先，让我们导入这个库并请求。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="6b87" class="nq mh hi nm b fi nr ns l nt nu">import urllib.request</span></pre><p id="fe89" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">好了，现在让我们用一个url变量，把我们要获取图片的网站的链接赋给这个变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="d140" class="nq mh hi nm b fi nr ns l nt nu">url = “<a class="ae jw" href="https://github.com/pytorch/hub/raw/master/images/dog.jpg" rel="noopener ugc nofollow" target="_blank">https://github.com/pytorch/hub/raw/master/images/dog.jpg</a>"</span></pre><p id="e4ae" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们将在这个链接中找到的图像的名称赋给file_name变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="d37a" class="nq mh hi nm b fi nr ns l nt nu">file_name = “dog.jpg”</span></pre><p id="cf00" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我从网上找一张图片。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="0d28" class="nq mh hi nm b fi nr ns l nt nu">urllib.request.urlretrieve(url, file_name)</span></pre><p id="09f6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在，我们有了一张照片。</p><p id="20a6" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在先用枕头库看图，再用matplotlib看图。首先，让我们导入库。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="fdeb" class="nq mh hi nm b fi nr ns l nt nu">import matplotlib.pyplot as plt<br/>from PIL import Image</span></pre><p id="a16a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们将图像赋给img变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="fb56" class="nq mh hi nm b fi nr ns l nt nu">img = Image.open(‘dog.jpg’)</span></pre><p id="3355" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">用matplotlib来看图吧。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="6cac" class="nq mh hi nm b fi nr ns l nt nu">plt.imshow(img)</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es om"><img src="../Images/b71e668fcf727e82504d85c43aa8dbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*rW4mWKv6YTndHSFyaMNJ7g.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx"><a class="ae jw" href="https://github.com/pytorch/hub/raw/master/images/dog.jpg" rel="noopener ugc nofollow" target="_blank">A cute dog</a></figcaption></figure><p id="6932" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们理解这个图像是一只狗。但是计算机将如何理解这张图片呢？我要谈谈这个。我的目标是找到这张图片的标签。为此，我将使用基于神经网络的算法。</p><p id="4807" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在将图像交给算法之前，需要对图像进行预处理。确保图片可用于算法。我们的照片是彩色的。它有3个通道，RGB，尺寸为1600*1200。记住，Pytorch中的数据预处理步骤称为转换。现在让我们用变换使图像适合分析。</p><p id="5b2a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们先导入PyTorch，然后进行转换。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="1cca" class="nq mh hi nm b fi nr ns l nt nu">import torch<br/>from torchvision import transforms</span></pre><p id="32d7" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们使用compose方法来定义一系列预处理步骤。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="1c10" class="nq mh hi nm b fi nr ns l nt nu">preprocess = transforms.Compose([<br/>    transforms.Resize(256),        #1<br/>    transforms.CenterCrop(224),    #2<br/>    transforms.ToTensor(),         #3<br/>    transforms.Normalize(          #4<br/>    mean=[0.485, 0.456, 0.406],<br/>    std=[0.229, 0.224, 0.225])])</span></pre><p id="54e2" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们看看这些代码:</p><ol class=""><li id="dff0" class="kt ku hi jz b ka kb kd ke kg kv kk kw ko kx ks on kz la lb bi translated">我用resize方法将图像的大小调整为256。</li><li id="d193" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks on kz la lb bi translated">我应用中心剪辑来拟合神经网络。</li><li id="5655" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks on kz la lb bi translated">如你所知，神经网络处理数字数据。我把这个图像转换成张量。张量是PyTorch中的基本数据对象。你可以把张量想象成一个有额外特性的NumPy数组。</li><li id="9be4" class="kt ku hi jz b ka lc kd ld kg le kk lf ko lg ks on kz la lb bi translated">图像由像素值组成。我在0-1之间缩放这些像素值。通过这种缩放，您可以做出更快、更准确的预测。</li></ol><p id="fd0c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">因此，我们创建了数据预处理步骤，使图像适合神经网络，并将其分配给预处理变量。现在，让我们将这些步骤应用到现有的图片中。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="1731" class="nq mh hi nm b fi nr ns l nt nu">img_tensor = preprocess(img)</span></pre><p id="6776" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">你可以看到，img_tensor的大小是224*224，由3个通道以RGB的形式组成。深度学习算法处理数百万数据。一次给模型提供所有这些数据是没有意义的。数据以称为批的组的形式提供给神经网络。大数据的批量通常是32或64。您可以根据您的分析来指定这些值。</p><p id="ecaf" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我只有一张图片，但是深度学习模型期望数据是批量的。现在让我们向数据中添加一个批处理。我将使用unsqueeze方法向数据添加一个维度。在这个方法中，我们需要指定添加维度的位置。我将设置0，在开始时添加维度。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="9e70" class="nq mh hi nm b fi nr ns l nt nu">batch = img_tensor.unsqueeze(0)</span></pre><p id="6b0a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我们看看数据的大小。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="0443" class="nq mh hi nm b fi nr ns l nt nu">print(batch.shape)</span></pre><p id="54d3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">因此，我的数据是1批，3个通道，224*224像素。现在图像准备进入神经网络。</p><p id="4ac5" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如你所知，训练深度学习模型既费时又费钱。使用预先训练好的模型更有意义。你可以在PyTorch repo中找到预先训练好的模型。</p><p id="cb8c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">例如，用Torchvision上传一个用于分类图像的模型是非常容易的。让我们用2012年赢得ImageNet比赛的AlexNet来对图像进行分类。首先，我们从torchvision导入模型。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="472a" class="nq mh hi nm b fi nr ns l nt nu">from torchvision import models</span></pre><p id="6764" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">AlexNet对图片进行分类效果很好。AlexNet有不同的型号。您可以选择适合您的分析的模型。</p><blockquote class="nx"><p id="d7bb" class="ny nz hi bd oa ob oc od oe of og ks dx translated">深度学习与其说是一门科学，不如说是一门艺术。</p></blockquote><p id="9bba" class="pw-post-body-paragraph jx jy hi jz b ka oh is kc kd oi iv kf kg oj ki kj kk ok km kn ko ol kq kr ks hb bi translated">现在让我们安装alexnet。使用pretrained=True选项，加载之前训练的模型系数。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="2f4f" class="nq mh hi nm b fi nr ns l nt nu">model = models.alexnet(pretrained=True)</span></pre><p id="f1d4" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我们创建一个设备变量，如果它在GPU上，那么分析将在GPU上运行，如果它不在GPU上，那么分析将在CPU上运行。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="3cbb" class="nq mh hi nm b fi nr ns l nt nu">device = “cuda” if torch.cuda.is_available() else “cpu”</span></pre><p id="c291" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">因为我正在制作一个简单的应用程序，所以这个分析不需要GPU。您也可以在CPU上运行此分析。现在让我们用model.eval配置模型。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="fc6f" class="nq mh hi nm b fi nr ns l nt nu">model.eval()</span></pre><p id="7591" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们选择运行模型的设备。为此，我使用了刚刚创建的设备变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="9eac" class="nq mh hi nm b fi nr ns l nt nu">model.to(device)</span></pre><p id="e5c3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们将运行模型的命令分配给变量y。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="f921" class="nq mh hi nm b fi nr ns l nt nu">y = model(batch.to(device))<br/>print(y.shape)<br/>#outout : torch.Size([1, 1000])</span></pre><p id="ee02" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我们来看y的维度，这里1代表数据的批次。因为我们只有一个图像，所以批号是1。因为类的数量是1000，所以1000的值写在屏幕上。现在让我们看看获得最大值的类。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="01ac" class="nq mh hi nm b fi nr ns l nt nu">y_max, index = torch.max(y,1)</span></pre><p id="54dc" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们把这些变量打印到屏幕上。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="c5f1" class="nq mh hi nm b fi nr ns l nt nu">print(index, y_max)</span><span id="c2c6" class="nq mh hi nm b fi oo ns l nt nu">#output: tensor([258], device='cuda:0') tensor([16.8252], device='cuda:0', grad_fn=&lt;MaxBackward0&gt;)</span></pre><p id="913a" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">我的模型找到了官方最高值为16.8252的第258个指数的类。但是我们不知道索引为258的类。现在让我们从PyTorch的站点获取类名。让我先创建一个url变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="032a" class="nq mh hi nm b fi nr ns l nt nu">url = ‘<a class="ae jw" href="https://pytorch.tips/imagenet-labels'" rel="noopener ugc nofollow" target="_blank">https://pytorch.tips/imagenet-labels'</a></span></pre><p id="fdb5" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们创建一个类标签变量。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="b745" class="nq mh hi nm b fi nr ns l nt nu">fname = ‘imagenet_class_labels.txt’</span></pre><p id="d4f1" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我们用这些变量从网上得到这个列表。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="790d" class="nq mh hi nm b fi nr ns l nt nu">urllib.request.urlretrieve(url, fname)</span></pre><p id="6c35" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">让我们打开这个列表。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="2a6b" class="nq mh hi nm b fi nr ns l nt nu">with open("imagenet_class_labels.txt") as f:<br/>  classes = [line.strip() for line in f.readlines()]<br/>print(classes[258])</span><span id="eab0" class="nq mh hi nm b fi oo ns l nt nu"># output: 258: 'Samoyed, Samoyede'</span></pre><p id="315d" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">如你所见，狗的品种写在屏幕上。那么，模型达到这个结果的概率是多少呢？让我们使用softmax()函数来看看这一点。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="71dd" class="nq mh hi nm b fi nr ns l nt nu">probe = torch.nn.functional.softmax(y, dim=1)[0] * 100</span></pre><p id="92a3" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在让我展示一下这种可能性。我准备用tensor.item()方法来看概率。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="1bc6" class="nq mh hi nm b fi nr ns l nt nu">print(classes[index[0]], probe[index[0]].item())</span><span id="6380" class="nq mh hi nm b fi oo ns l nt nu"># output: 258: 'Samoyed, Samoyede', 72.44749450683594</span></pre><p id="1461" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">该模型对狗的品种的预测达到了72%。您还可以使用sort()方法打印前5个预测。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="6e19" class="nq mh hi nm b fi nr ns l nt nu"> _, indices = torch.sort(y, descending=True)</span></pre><p id="409b" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">现在，让我们打印最大到5的预测。</p><pre class="jh ji jj jk fd nl nm nn no aw np bi"><span id="7a00" class="nq mh hi nm b fi nr ns l nt nu">for idx in indices[0][:5]:<br/>    print(classes[idx], probe[idx].item())</span></pre><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es op"><img src="../Images/6a3ed29459279d114fb2053216cfe213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*283WYDJWhVz1WovbkcNMgg.png"/></div></div></figure><p id="e928" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">正如你所看到的，我的模型最初预测萨摩耶犬72 %,而预测沙袋鼠犬13 %,博美犬5%。</p></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><h1 id="f28c" class="mg mh hi bd mi mj mk ml mm mn mo mp mq ix mr iy ms ja mt jb mu jd mv je mw mx bi translated">结论</h1><p id="291b" class="pw-post-body-paragraph jx jy hi jz b ka my is kc kd mz iv kf kg na ki kj kk nb km kn ko nc kq kr ks hb bi translated">在这篇文章中，我谈到了深度学习的PyTorch。综上所述，我首先解释了PyTorch是什么，以及它的优点。接下来，我向您展示了安装。最后，我讲述了如何使用预先训练好的alexnet来估计图像的类别。</p></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><p id="363c" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">就是这样。感谢您的阅读。我希望你喜欢它。你可能会对下面的文章感兴趣。</p><div class="lh li ez fb lj lk"><a rel="noopener follow" target="_blank" href="/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">成为机器学习专家的6个步骤</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">机器学习是人工智能的一个子领域，旨在使用数据自动建立模型。在这篇文章中，我将…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">medium.com</p></div></div><div class="lt l"><div class="oq l lv lw lx lt ly jq lk"/></div></div></a></div><div class="lh li ez fb lj lk"><a href="https://levelup.gitconnected.com/top-10-python-libraries-and-5-best-books-for-data-science-fa0d0cf171a6" rel="noopener  ugc nofollow" target="_blank"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hs fi z dy lp ea eb lq ed ef hr bi translated">10大Python库和5本最佳数据科学书籍</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">在这篇文章中，我将谈论数据科学家应该知道的10个Python库。我还会推荐5本书…</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="lt l"><div class="or l lv lw lx lt ly jq lk"/></div></div></a></div><p id="1bc7" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">别忘了关注我们的<a class="ae jw" href="https://www.youtube.com/channel/UCFU9Go20p01kC64w-tmFORw" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae jw" href="https://github.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae jw" href="https://twitter.com/TirendazAcademy" rel="noopener ugc nofollow" target="_blank"><em class="os">Twitter</em></a><em class="os"/>|<a class="ae jw" href="https://www.kaggle.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">ka ggle</a>|<em class="os">|</em><a class="ae jw" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank"><em class="os">LinkedIn</em></a><em class="os"/>👍</p><p id="7c83" class="pw-post-body-paragraph jx jy hi jz b ka kb is kc kd ke iv kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hs"> <em class="os">如果这篇帖子有帮助，请点击鼓掌👏按钮几下，以示支持👇</em>T25】</strong></p></div></div>    
</body>
</html>
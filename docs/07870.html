<html>
<head>
<title>Learn What Room Is, And How To Use It</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解什么是房间，以及如何使用它</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/learn-the-basics-of-room-in-android-ca6434264fe1?source=collection_archive---------24-----------------------#2021-10-04">https://medium.com/geekculture/learn-the-basics-of-room-in-android-ca6434264fe1?source=collection_archive---------24-----------------------#2021-10-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cdd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解如何使用Room在本地数据库中保存数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b65d1bdd69b50eb9e9db977e09c1d874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZDLoXKPNtrQJohBbhXJNA.png"/></div></div></figure><p id="6de5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个故事中，你将学习Android中的基本空间。请注意，在这个故事中，我假设你有一些Android开发和Kotlin知识，这意味着我不会在这里解释简单的语言。</p><h2 id="b098" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">注意</h2><p id="494d" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">在这个故事中，我们不会真的构建一个示例应用程序。我将只展示一些片段和它们的解释。</p><p id="7d97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你想使用Room和其他先进的概念来构建一个示例Android应用程序，你将不得不等待。我打算写一篇关于它的报道。</p><h2 id="3d8e" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">通告</h2><p id="10a6" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">我只是稍微更新了一下故事图片的设计，它现在有了一点暗但是更强烈的颜色，现在是故事主题的图片。</p><p id="7fc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很想得到一些关于故事图像的反馈！</p><p id="1c54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开始吧！</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="6301" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">什么是房间？</h1><p id="6df6" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">Room是Android架构组件的一部分，它在SQLite上提供了一个抽象层，允许更健壮的数据库访问，同时仍然提供SQLite的全部功能。</p><p id="63c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上就是SQLite的改进版，特别是针对Android的改进。</p><p id="4d34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是Android官方文档对Room的描述:</p><blockquote class="ln lo lp"><p id="5664" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">Room persistence库在SQLite上提供了一个抽象层，允许流畅的数据库访问，同时充分利用SQLite的强大功能。特别是，Room提供了以下好处:</p><p id="9605" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">SQL查询的编译时验证。</p><p id="298d" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">-最大限度减少重复和容易出错的样板代码的便捷注释。</p><p id="4506" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">-简化的数据库迁移路径。</p><p id="d99a" class="if ig lq ih b ii ij ik il im in io ip lr ir is it ls iv iw ix lt iz ja jb jc hb bi translated">出于这些考虑，我们强烈建议您使用Room，而不是直接使用SQLite APIs。</p></blockquote></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="27a0" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">房间依赖关系及其工作原理</h1><p id="aefe" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">好了，现在我们知道了什么是房间，让我们看看如何将它添加到我们的项目中，以及它是如何工作的。</p><h2 id="0094" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">房间依赖关系</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="f435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一个<code class="du lw lx ly lz b">implementation</code>和<code class="du lw lx ly lz b">annotationProcessor</code>是要求能够使用房间。可选的依赖项并不总是必需的，只有当您确实需要这些特性时，才应该添加它们。</p><h2 id="8d17" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">房间如何工作</h2><p id="af1e" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">房间的三个主要组成部分是:</p><ul class=""><li id="56fe" class="ma mb hi ih b ii ij im in iq mc iu md iy me jc mf mg mh mi bi translated"><strong class="ih hj">实体:</strong>表示房间数据库中的一个表格。它应该标注有<code class="du lw lx ly lz b">@Entity</code>。</li><li id="4f33" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated"><strong class="ih hj"> DAO </strong>:包含访问数据库的方法的接口。上面标注了<code class="du lw lx ly lz b">@Dao</code>。</li><li id="77c0" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated"><strong class="ih hj">数据库:</strong>代表数据库。它是一个连接SQLite数据库的对象，所有的操作都是通过它执行的。上面注有<code class="du lw lx ly lz b">@Database</code>。</li></ul><p id="8ff5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，房间不是ORM相反，它是一个完整的库，允许我们更容易地创建和操作SQLite数据库。</p><p id="d71c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过使用注释，我们可以定义我们的数据库、表和操作。Room会自动将这些注释翻译成SQLite指令和查询，以在数据库引擎中执行相应的操作。</p><p id="86fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是房间建筑的样子:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/35ab775f62cf871382d6c15f8017b612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*QAoMJOCOrxlYsmpN.png"/></div><figcaption class="mp mq et er es mr ms bd b be z dx">Room architecture</figcaption></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="f02f" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">房间实施</h1><p id="d577" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">现在让我们来看看如何在我们的应用程序中实现Room。</p><p id="be74" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，这些例子相当简单，实际上你可以做的比我在这个故事中向你展示的要多得多。因此，请务必稍后查看Room文档，以了解更多关于Room以及如何实现它的信息。</p><h2 id="6c78" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">实体</h2><p id="5cb8" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">让我们创建一个<code class="du lw lx ly lz b">Phone</code>实体，看看我们如何在房间中创建实体。<code class="du lw lx ly lz b">Phone</code>的每个实例代表应用程序数据库中<code class="du lw lx ly lz b">phone</code>表中的一行。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="53dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很简单，对吧？</p><p id="e08c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认情况下，Room将使用字段名作为列名。但是如果你想给你的列起一个不同的名字，你可以使用<code class="du lw lx ly lz b">@ColumnInfo</code>。</p><p id="12b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我不认为我必须解释什么<code class="du lw lx ly lz b">@PrimaryKey</code>，因为如果你有一点点数据库知识，你可能会知道。</p><p id="016f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们继续讨论道斯。</p><h2 id="a579" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">道斯</h2><p id="2077" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">下面的代码定义了一个名为<code class="du lw lx ly lz b">PhoneDao</code>的DAO。<code class="du lw lx ly lz b">PhoneDao</code>提供了应用程序的其余部分用来与<code class="du lw lx ly lz b">phone</code>表中的数据进行交互的方法。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="c114" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">需要注意的几件事:</p><ul class=""><li id="e5a9" class="ma mb hi ih b ii ij im in iq mc iu md iy me jc mf mg mh mi bi translated">所有的刀都要用<code class="du lw lx ly lz b">@Dao</code>标注。</li><li id="8006" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated">用<code class="du lw lx ly lz b">@Insert</code>、<code class="du lw lx ly lz b">@Update</code>或<code class="du lw lx ly lz b">@Delete</code>标注的函数必须接收所需类的一个实例作为参数，它分别代表我们想要插入、更新或删除的对象。</li><li id="8bcc" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated">在插入或更新操作的情况下，我们可以使用属性<code class="du lw lx ly lz b">onConflict</code>来指示当执行操作发生冲突时该做什么。可供使用的策略有<code class="du lw lx ly lz b">REPLACE</code><em class="lq"/><code class="du lw lx ly lz b">ABORT</code><code class="du lw lx ly lz b">FAIL</code><code class="du lw lx ly lz b">IGNORE</code>和<code class="du lw lx ly lz b">ROLLBACK</code>。</li><li id="6ed5" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated">如果我们想从一个或多个实体获得特定的信息，我们可以用<code class="du lw lx ly lz b">@Query</code>注释一个函数，并提供一个SQL脚本作为参数。</li></ul><p id="095d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看我们实际上是如何创建数据库的。</p><h2 id="e1dc" class="jp jq hi bd jr js jt ju jv jw jx jy jz iq ka kb kc iu kd ke kf iy kg kh ki kj bi translated">数据库ˌ资料库</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="874a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，这里需要注意一些事情:</p><ul class=""><li id="9718" class="ma mb hi ih b ii ij im in iq mc iu md iy me jc mf mg mh mi bi translated">这是一个必须扩展<code class="du lw lx ly lz b">RoomDatabase</code>的抽象类。</li><li id="f69d" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated">它必须用<code class="du lw lx ly lz b">@Database</code>进行注释，并接收一个实体列表，其中包含组成数据库的所有类，所有这些类都必须用<code class="du lw lx ly lz b">@Entity</code>进行注释。我们还必须提供一个数据库版本。</li><li id="fbec" class="ma mb hi ih b ii mj im mk iq ml iu mm iy mn jc mf mg mh mi bi translated">我们必须为包含在<code class="du lw lx ly lz b">@Database</code>注释中的每个实体声明一个抽象函数。这个函数必须返回相应的DAO，它是一个用<code class="du lw lx ly lz b">@Dao</code>标注的类。</li></ul></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="d094" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">使用房间</h1><p id="b6dd" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">困难的部分已经完成了。剩下要做的就是在我们的应用程序中的任何地方使用空间。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="d97e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是创建房间数据库实例的方法。很简单，对吧？</p><p id="6736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们实际上是如何使用它的呢？嗯，这也很简单。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="c172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅此而已。现在，您已经实现了一个功能齐全的房间数据库，并准备进行扩展！</p><p id="08d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">很酷，不是吗？</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="b6c5" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">最后的想法</h1><p id="1fde" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">你刚刚学会了如何给你的应用增加空间，以及如何实际使用它。</p><p id="d12a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这个故事对你有帮助。我很想知道你是否喜欢Room，以及你是否打算在未来的项目中使用它。</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><h1 id="8dda" class="kw jq hi bd jr kx ky kz jv la lb lc jz ld le lf kc lg lh li kf lj lk ll ki lm bi translated">仅此而已。感谢您阅读这个故事！</h1><p id="f388" class="pw-post-body-paragraph if ig hi ih b ii kk ik il im kl io ip iq km is it iu kn iw ix iy ko ja jb jc hb bi translated">如果你喜欢这个故事，一定要为它鼓掌！你想问我什么都可以。</p><p id="9efb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Twitter上关注我:</p><div class="mt mu ez fb mv mw"><a href="https://twitter.com/Re_allyedge" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab dw"><div class="my ab mz cl cj na"><h2 class="bd hj fi z dy nb ea eb nc ed ef hh bi translated">re _ ally边缘</h2><div class="nd l"><p class="bd b fp z dy nb ea eb nc ed ef dx translated">twitter.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj jn mw"/></div></div></a></div><p id="6b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Patreon上支持我:</p><div class="mt mu ez fb mv mw"><a href="https://www.patreon.com/allyedge" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab dw"><div class="my ab mz cl cj na"><h2 class="bd hj fi z dy nb ea eb nc ed ef hh bi translated">阿里木阿尔斯兰卡亚是创造编程故事和教程。帕特里翁</h2><div class="nk l"><h3 class="bd b fi z dy nb ea eb nc ed ef dx translated">今天就成为阿里木阿尔斯兰卡亚的赞助人:在世界上最大的…</h3></div><div class="nd l"><p class="bd b fp z dy nb ea eb nc ed ef dx translated">www.patreon.com</p></div></div><div class="ne l"><div class="nl l ng nh ni ne nj jn mw"/></div></div></a></div></div></div>    
</body>
</html>
<html>
<head>
<title>Handling Forms in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以角度处理表单</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/handling-forms-in-angular-f71ee08766b8?source=collection_archive---------4-----------------------#2022-06-07">https://medium.com/geekculture/handling-forms-in-angular-f71ee08766b8?source=collection_archive---------4-----------------------#2022-06-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="46ba" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在Angular中理解模板驱动和反应式表单</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/4a206c9e78650b842fdfce02b2d15e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TtTWq4tP8Epq1LFZ.gif"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Handling Forms in Angular</figcaption></figure><p id="85e0" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">用表单处理用户输入始终是应用程序的重要组成部分。应用程序使用表单使用户能够登录、更新配置文件以及执行许多其他数据输入任务。</p><p id="5593" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">Angular为我们提供了两种处理表单的方法:模板驱动和反应式方法。</p><p id="4f2a" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">模板驱动是指我们在HTML模板中处理大部分与表单相关的东西，并让angular通过放置一些指令如NgForm、NgModel、NgModelGroup等来处理用户输入。另一方面，在反应式表单中，所有与表单相关的逻辑都是在组件类本身中编写的，我们在HTML模板中编写的极少量逻辑只是为了绑定formGroup、(ngSubmit)、formControlName等内容。</p><p id="5f5e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">让我们尝试构建基本表单并理解这两种方法:</p><h1 id="2b70" class="kj kk hi bd kl km kn ko kp kq kr ks kt io ku ip kv ir kw is kx iu ky iv kz la bi translated"><strong class="ak">模板驱动的表单</strong></h1><p id="0734" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">在模板驱动的表单中:</p><ol class=""><li id="e394" class="lg lh hi jp b jq jr jt ju jw li ka lj ke lk ki ll lm ln lo bi translated">使用<code class="du lp lq lr ls b">ngForm</code>指令设置表单</li><li id="b32d" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">使用<code class="du lp lq lr ls b">ngModel</code>指令设置控件</li><li id="ce43" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated"><code class="du lp lq lr ls b">ngModel</code>还提供了双向数据绑定</li></ol><p id="51c6" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">为了使用模板驱动的表单，我们必须导入<code class="du lp lq lr ls b">FormsModule</code></p><p id="f139" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们在app.module.ts中这样做:</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="38b5" class="mc kk hi ls b fi md me l mf mg">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { AppComponent } from './app.component';<br/><strong class="ls hj">import { FormsModule } from '@angular/forms';</strong></span><span id="3d4e" class="mc kk hi ls b fi mh me l mf mg">@NgModule({</span><span id="aea4" class="mc kk hi ls b fi mh me l mf mg">declarations: [<br/>AppComponent<br/>],</span><span id="7653" class="mc kk hi ls b fi mh me l mf mg">imports: [<br/>BrowserModule,<br/><strong class="ls hj">FormsModule,</strong><br/>],</span><span id="6a04" class="mc kk hi ls b fi mh me l mf mg">...</span><span id="5ae9" class="mc kk hi ls b fi mh me l mf mg">})<br/>export class AppModule { }</span></pre><p id="cb49" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在此之后，我们的任务是创建一个常规的HTML表单，然后将其转换为模板驱动的表单，angular为我们做了这些。在这里，我将创建一个基本的形式，占用用户名和电子邮件。</p><p id="c8f7" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们所要做的就是将<strong class="jp hj"> ngForm指令</strong>添加到我们的表单中，并将其设置为一个局部变量。在这里，我将它设置为#f。它可以如下完成:</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="1fdf" class="mc kk hi ls b fi md me l mf mg">&lt;form (ngSubmit)="onFormSubmit()" <strong class="ls hj">#f="ngForm"</strong>&gt;</span></pre><p id="6449" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated"><code class="du lp lq lr ls b">ngForm</code>会自动为我们做以下事情:</p><ol class=""><li id="01ff" class="lg lh hi jp b jq jr jt ju jw li ka lj ke lk ki ll lm ln lo bi translated">将自身绑定到<code class="du lp lq lr ls b">&lt;Form&gt;</code>指令</li><li id="0e29" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">创建顶级<code class="du lp lq lr ls b">FormGroup</code>实例</li><li id="c7b9" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">为每个拥有<code class="du lp lq lr ls b">ngModel</code>指令的子控件创建<code class="du lp lq lr ls b">FormControl</code>实例。</li><li id="92a4" class="lg lh hi jp b jq lt jt lu jw lv ka lw ke lx ki ll lm ln lo bi translated">为每个<code class="du lp lq lr ls b">NgModelGroup</code>指令创建<code class="du lp lq lr ls b">FormGroup</code>实例。</li></ol><p id="9084" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">所以我们的下一个任务是将<strong class="jp hj"> ngModel指令</strong>添加到我们希望angular获取的所有表单控件中。<code class="du lp lq lr ls b">ngModel</code>将使用<code class="du lp lq lr ls b">name</code>属性为它所附加的每个<code class="du lp lq lr ls b">Form</code>字段创建<code class="du lp lq lr ls b">FormControl</code>实例。</p><p id="d718" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在，一旦模板准备好了，我们就可以放入最后一部分向组件提交数据。</p><p id="6af1" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">我们使用<code class="du lp lq lr ls b">ngSubmit</code>事件将表单数据提交给组件类。我们使用<a class="ae mi" href="https://www.tektutorialshub.com/angular/angular-data-binding/" rel="noopener ugc nofollow" target="_blank">事件绑定</a>(括号)将<code class="du lp lq lr ls b">ngSubmit</code>绑定到组件类中的<code class="du lp lq lr ls b">onFormSubmit</code>方法。当用户点击提交按钮时，将触发<code class="du lp lq lr ls b">ngSubmit</code>事件。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mj"><img src="../Images/5808bb84ab667fa7b73c6f4acdad84d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtB-WNB1hVT_xkarUhzdCg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">A simple HTML form with Angular Forms Controls added to it</figcaption></figure><p id="fd36" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在我们的组件中，我们只记录NgForm数据，onFormSubmit方法中没有其他内容。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/fcf4eca68c1d18b667cea30c1b89ab28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPYLoxLjen8_OpmINFeJdg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">A component which will log our NgForm data</figcaption></figure><p id="355e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">现在<strong class="jp hj">使用ng serve运行应用</strong>并且<strong class="jp hj">转到Chrome开发者工具的控制台。</strong>现在尝试添加一些数据，单击提交，您将看到NgForm数据记录在控制台中(如下图所示)。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ml"><img src="../Images/f82d36800e7b9e7f2312e6a957735c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zBFYyag2FYTZfVMhzMHRkA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx">Application showing logged NgForm data</figcaption></figure><p id="36fe" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">NgForm为我们提供了大量数据来控制表单、设置验证和获取值,我们将在另一篇文章中讨论这些内容。现在，要获取这些值，我们可以做console . log(this . my form . values)；</p><p id="07a5" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">值将是保存数据的对象:</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="04cd" class="mc kk hi ls b fi md me l mf mg">values: Object {</span><span id="caa5" class="mc kk hi ls b fi mh me l mf mg"> <strong class="ls hj">email</strong>: “test@test.com”<br/> <strong class="ls hj">username</strong>: “test”</span><span id="5805" class="mc kk hi ls b fi mh me l mf mg">}</span></pre></div><div class="ab cl mn mo gp mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="hb hc hd he hf"><h1 id="b657" class="kj kk hi bd kl km mu ko kp kq mv ks kt io mw ip kv ir mx is kx iu my iv kz la bi translated"><strong class="ak">反应形式</strong></h1><p id="698a" class="pw-post-body-paragraph jn jo hi jp b jq lb ij js jt lc im jv jw ld jy jz ka le kc kd ke lf kg kh ki hb bi translated">要处理反应式表单，您将使用<code class="du lp lq lr ls b">ReactiveFormsModule</code>而不是<code class="du lp lq lr ls b">FormsModule</code>。在代码编辑器中打开<code class="du lp lq lr ls b">app.module.ts</code>，并添加<code class="du lp lq lr ls b">ReactiveFormsModule</code>:</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="82ad" class="mc kk hi ls b fi md me l mf mg">import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/><strong class="ls hj">import { ReactiveFormsModule } from '@angular/forms';</strong><br/><br/>import { AppComponent } from './app.component';<br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    <strong class="ls hj">ReactiveFormsModule,</strong><br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</span></pre><p id="5279" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">使用反应式表单方法，我们的整个逻辑是在组件类本身中编写和处理的。让我们创建一个基本的HTML模板，然后转移到组件类逻辑。</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="710b" class="mc kk hi ls b fi md me l mf mg">&lt;form <strong class="ls hj">[formGroup]="myForm"</strong> <strong class="ls hj">(ngSubmit)="onSubmit(myForm)"</strong>&gt;<br/>  &lt;div&gt;<br/>    &lt;label&gt;<br/>      Name:<br/>      &lt;input <strong class="ls hj">formControlName</strong>="name" placeholder="Your name"&gt;<br/>    &lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;div&gt;<br/>    &lt;label&gt;<br/>      Email:<br/>      &lt;input <strong class="ls hj">formControlName</strong>="email" placeholder="Your email"&gt;<br/>    &lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;div&gt;<br/>    &lt;label&gt;<br/>      Message:<br/>      &lt;input <strong class="ls hj">formControlName</strong>="message" placeholder="Your message"&gt;<br/>    &lt;/label&gt;<br/>  &lt;/div&gt;<br/>  &lt;button type="submit"&gt;Send&lt;/button&gt;<br/>&lt;/form&gt;</span></pre><p id="5fec" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">这里我们使用<strong class="jp hj">表单组</strong>,因为这个指令将告诉Angular把它当作一个表单组，并且它已经被命名为myForm。然后，我们开发了一个基本的表单模板，允许用户输入他们的姓名、电子邮件和一些消息，并通过发送按钮提交。<strong class="jp hj">提交</strong>与表单提交时触发的<strong class="jp hj"> (ngSubmit) </strong>事件绑定。然后，我们在每个表单字段上都有一个<strong class="jp hj"> formControlName </strong>，它是一个带有值的指令，该值将是组件类中使用的名称。</p><p id="9d5e" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在component类中，我们定义了一个FormGroup，在FormGroup中有单独的FormControls。如果在<em class="mm">更新</em> a <code class="du lp lq lr ls b">FormControl</code>时提供了一个值，它将被用作该字段的初始值。我们还可以提供更多的参数，比如一组内置的和定制的验证，以及类似的异步验证，我们将在另一篇文章中讨论。</p><pre class="iy iz ja jb fd ly ls lz ma aw mb bi"><span id="e385" class="mc kk hi ls b fi md me l mf mg">import { Component, OnInit } from '<a class="ae mi" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/><strong class="ls hj">import { FormControl, FormGroup } from '</strong><a class="ae mi" href="http://twitter.com/angular/forms" rel="noopener ugc nofollow" target="_blank"><strong class="ls hj">@angular/forms</strong></a><strong class="ls hj">';</strong></span><span id="3891" class="mc kk hi ls b fi mh me l mf mg"><a class="ae mi" href="http://twitter.com/Component" rel="noopener ugc nofollow" target="_blank">@Component</a>({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.css']<br/>})<br/>export class AppComponent implements OnInit {<br/>  <strong class="ls hj">myForm: FormGroup;</strong></span><span id="79f3" class="mc kk hi ls b fi mh me l mf mg">ngOnInit() {<br/>    <strong class="ls hj">this.myForm = new FormGroup({<br/>      name: new FormControl('Sammy'),<br/>      email: new FormControl(''),<br/>      message: new FormControl('')<br/>    });</strong><br/>  }</span><span id="0ef3" class="mc kk hi ls b fi mh me l mf mg">onSubmit(form: FormGroup) {<br/>    <strong class="ls hj">console.log('Valid?', form.valid); // true or false<br/>    console.log('Name', form.value.name);<br/>    console.log('Email', form.value.email);<br/>    console.log('Message', form.value.message);</strong><br/>  }<br/>}</span></pre><p id="6464" class="pw-post-body-paragraph jn jo hi jp b jq jr ij js jt ju im jv jw jx jy jz ka kb kc kd ke kf kg kh ki hb bi translated">在这里，我们没有将表单数据提交到某个外部服务器，我们只是记录所有的表单值。</p></div></div>    
</body>
</html>
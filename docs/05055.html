<html>
<head>
<title>What is SchemaCrawler and Why would you need it?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是SchemaCrawler，为什么需要它？</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/what-is-schemacrawler-and-why-would-you-need-it-b9c496054533?source=collection_archive---------11-----------------------#2021-07-08">https://medium.com/geekculture/what-is-schemacrawler-and-why-would-you-need-it-b9c496054533?source=collection_archive---------11-----------------------#2021-07-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/048a183a2fa01120835e61b1c8e769e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byKQPjD1IynEYrf69yHNvg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://www.flickr.com/photos/128691640@N04/" rel="noopener ugc nofollow" target="_blank">Nivek.Old.Gold</a> on <a class="ae iu" href="https://www.flickr.com/" rel="noopener ugc nofollow" target="_blank">Flickr</a></figcaption></figure><p id="3ba5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇博文中，我将解释如何使用模式爬虫工具从给定的模式中获取表细节。为了保持解释和工作流程简单，我将做一个关于爬行MySQL localhost表的演练，并向您展示元数据信息的输出json。</p></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="5fda" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">介绍</h2><p id="0e79" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">SchemaCrawler是一个开源工具，您可以简单地利用它来抓取数据库模式/表对象，并以可读的格式提取元数据输出。它是高度可定制的，您可以使用他们在发行版示例中提供的样板代码，并实现更多的用例。</p><p id="9eb8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">他们的<a class="ae iu" href="https://www.schemacrawler.com/" rel="noopener ugc nofollow" target="_blank">网站</a>上的定义是:</p><blockquote class="la lb lc"><p id="73bb" class="iv iw ld ix b iy iz ja jb jc jd je jf le jh ji jj lf jl jm jn lg jp jq jr js hb bi translated">SchemaCrawler是一个免费的数据库模式发现和理解工具。SchemaCrawler为数据治理提供了一系列有用的特性。您可以使用正则表达式<a class="ae iu" href="https://www.schemacrawler.com/schemacrawler-grep.html" rel="noopener ugc nofollow" target="_blank">搜索数据库模式对象</a>，并以可读的文本格式输出模式和数据。输出服务于数据库文档，并被设计成<a class="ae iu" href="http://en.wikipedia.org/wiki/Diff" rel="noopener ugc nofollow" target="_blank">不同于其他数据库模式的</a>。SchemaCrawler还生成<a class="ae iu" href="https://www.schemacrawler.com/diagramming.html" rel="noopener ugc nofollow" target="_blank">模式图。你可以用任何标准的脚本语言对你的数据库执行脚本。使用</a><a class="ae iu" href="https://www.schemacrawler.com/lint.html" rel="noopener ugc nofollow" target="_blank"> lint可以发现潜在的模式设计问题。</a></p></blockquote></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="5253" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">安装步骤:</h2><ol class=""><li id="1a24" class="lh li hi ix b iy kv jc kw jg lj jk lk jo ll js lm ln lo lp bi translated">进入主页面-<a class="ae iu" href="https://www.schemacrawler.com/" rel="noopener ugc nofollow" target="_blank">https://www.schemacrawler.com</a>你会找到下载发行版的地方(<a class="ae iu" href="https://github.com/schemacrawler/SchemaCrawler/releases/" rel="noopener ugc nofollow" target="_blank">https://github.com/schemacrawler/SchemaCrawler/releases/</a></li><li id="c472" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">下载最新的zip文件并解压。</li><li id="873f" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">一旦你拉开拉链，你会看到一个README.html。打开它，你会看到要下载的先决条件。</li><li id="cea9" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">确保JAVA路径设置正确后，进入发行版中的__downloader目录。</li><li id="529a" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">通过调用<br/>安装您需要的库。/download.sh插件<br/>。/download.sh杰克逊<br/>。/download.sh python <br/>。/download.sh velocity(不确定是否有必要，但我还是安装了)<br/>之后你就可以开始了。</li><li id="9850" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">你可以使用他们已经在发行版中提供的测试数据库。为此，您需要从根目录进入_testdb目录并运行<strong class="ix hj">。/startdbserver.sh </strong>。这将为您创建示例模式和表。您也可以查看目录中的README页面以获得任何帮助。</li><li id="9f47" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">或者，您可以直接传入不同的连接详细信息，以便爬行到源数据库中。为此，你需要从根目录进入/examples/python目录并编辑<strong class="ix hj"> python.sh </strong>。例如，您可以用自己的RDBMS替换默认连接细节，或者用其他可选标志替换任何其他连接。如果你输入<strong class="ix hj">，你可以查看更多关于旗帜的信息。/schemacrawler.sh -h </strong>进入__schemacrawler目录。您可以简单地在python.sh中使用下面的例子，通过相应地更改值:<br/> <br/> #！/usr/bin/env bash <br/>../../_ schema crawler/schema crawler . sh \<br/>—server = MySQL \<br/>—host = localhost \<br/>—database = testdb \<br/>—user = username \<br/>—password = user 1234 \<br/>—port = 3306 \<br/>—log-level = INFO \<br/>—output-file = output . JSON \<br/>—INFO-level = standard \<br/>—命令脚本\ <br/></li><li id="fb94" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">一旦设置了连接细节，就可以在/examples/python目录下测试<strong class="ix hj"> tables.py </strong>脚本，方法是执行shell脚本和python脚本作为参数:<br/> <strong class="ix hj">。/python.sh tables.py </strong></li><li id="c0c6" class="lh li hi ix b iy lq jc lr jg ls jk lt jo lu js lm ln lo lp bi translated">这将为您提供表名、子表等。然后，您可以修改脚本以引入更多元数据，如主键、数据长度、数据类型等。</li></ol></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="b66d" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">演示演练:</h2><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/75b92e364924b532ba8b01b0df9b833b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATrZggQe_NjyteqfJpeBUg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Workflow Diagram</figcaption></figure><p id="4841" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了这个测试，我在本地主机中创建了一个示例MySQL模式和一个表。</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/48f47d7735632b937bcea2509abaac5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACjmw-97i9Lj5pMHk8yFTg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">schema and table details</figcaption></figure><p id="1396" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后我继续编辑<strong class="ix hj"> python.sh ( </strong>驻留在examples/python目录<strong class="ix hj"> ) </strong>以获得我的本地主机的连接细节</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/f902774632aa395a5f3e7ef935759657.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*fs7dTkXADpGW5ERrKCSxwg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">python.sh</figcaption></figure><p id="8061" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参数解释</p><blockquote class="la lb lc"><p id="5eab" class="iv iw ld ix b iy iz ja jb jc jd je jf le jh ji jj lf jl jm jn lg jp jq jr js hb bi translated"><strong class="ix hj">服务器</strong>:连接系统类型<br/> <strong class="ix hj">主机</strong>:连接<br/> <strong class="ix hj">数据库的主机</strong>:你要抓取的数据库名称<br/> <strong class="ix hj">用户</strong>:连接的用户名<br/> <strong class="ix hj">密码</strong>:连接端口<br/> <strong class="ix hj">的密码</strong>:连接端口<br/> <strong class="ix hj">日志级别</strong>:设置日志级别例如:关闭、严重、警告、信息、全部【T2缺省值是standard，但是您可以将其更改为minimum、standard、detailed、maximum <br/> <strong class="ix hj"> command </strong>:您可以选择是执行我提供的示例中的脚本，还是运行shell命令(<strong class="ix hj"> command= </strong> execute)，或者引入模式的细节(<strong class="ix hj"> command= </strong> schema)， 或者执行过滤(<strong class="ix hj">命令</strong>= filter)<br/><strong class="ix hj">sort-tables</strong>:是否按字母顺序对表进行排序<br/> <strong class="ix hj">脚本</strong>:您可以在这里直接传入python脚本的名称，但是在我的示例中，我是在运行bash脚本python.sh时从一个参数中获取它的</p></blockquote><p id="39df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">编辑完上述bash脚本后，我修改了/examples/python位置中现有的<strong class="ix hj"> tables.py </strong> python脚本。除非您需要该表的更多细节，否则您可以简单地使用为测试目的提供的默认脚本。</p><figure class="lw lx ly lz fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="4c23" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我在上面所做的是，我在给定的模式中引入了可用表的列名、数据类型、长度和主键。由于SchemaCrawler工具的隐式序列化程序读取和提取表/列的不必要信息有点复杂，所以我只提取了有用的元数据信息，并将它们写入JSON并保存为<strong class="ix hj"> tables.json </strong>。您仍然可以通过使用以下两个参数来使用隐式序列化特性，而不是使用我在上面的<strong class="ix hj"> python.sh </strong>中使用的<strong class="ix hj">命令脚本</strong>参数。<br/> —命令序列化<br/> —输出格式=JSON</p><p id="c491" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">tables.json如下所示</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div class="er es me"><img src="../Images/989bd54f33fd6d900878fdb20b8c9e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*FWUEziliSTIO4fz7kzFQxA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx">tables.json</figcaption></figure><p id="c9dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果您将上面的输出与我之前展示的MySQL表的截图进行比较，它应该是匹配的。你可以带任何数量的桌子进来。例如，假设我在MySQL本地主机中创建了另一个表</p><figure class="lw lx ly lz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/440768a5965ac79d762288374de94eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ul8LwY8_nKkECaN-1dF5aA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">test_db_v2</figcaption></figure><p id="16f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我通过schema crawler运行python.sh，它应该会拉入新表以及之前的表(test_db)的详细信息</p><figure class="lw lx ly lz fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure></div><div class="ab cl jt ju gp jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="hb hc hd he hf"><h2 id="dbef" class="ka kb hi bd kc kd ke kf kg kh ki kj kk jg kl km kn jk ko kp kq jo kr ks kt ku bi translated">最终想法:</h2><p id="aad9" class="pw-post-body-paragraph iv iw hi ix b iy kv ja jb jc kw je jf jg kx ji jj jk ky jm jn jo kz jq jr js hb bi translated">如果您在任何需要自动化和维护各种源系统类型(例如:DB2、Postgres、Oracle等)的表/模式元数据细节的项目中工作，这个工具会非常方便。).如果您要从头开始为每个源系统类型实现一个爬虫，这将极大地减少您需要投入的开发工作。</p></div></div>    
</body>
</html>
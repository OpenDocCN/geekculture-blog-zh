<html>
<head>
<title>On the shortcomings of continuous representations of chemical space</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">化学空间连续表象的缺点</h1>
<blockquote>原文：<a href="https://medium.com/geekculture/on-the-shortcomings-of-continuous-representations-of-chemical-space-4b1d5054be8b?source=collection_archive---------13-----------------------#2021-07-18">https://medium.com/geekculture/on-the-shortcomings-of-continuous-representations-of-chemical-space-4b1d5054be8b?source=collection_archive---------13-----------------------#2021-07-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="829b" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">介绍</h1><p id="3356" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">该论文(Gomez-Bombarelli等人，2018年)介绍了化学VAE，并为(Zhavoronkov等人，2019年)中描述的GENTRL模型提供了核心探索技术，在其导言中包含了一些斯塔克主张。我们在此引用一段摘录:</p><p id="9f6c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">“……计算分子设计受到用于探索化学空间的搜索策略的限制。当前的方法要么彻底搜索固定的库，要么使用离散的局部搜索方法，如遗传算法或类似的离散插值技术……化合物的遗传生成需要人工指定突变和交叉规则的试探法。<em class="kg">离散优化方法难以有效搜索大面积的化学空间，因为不可能用梯度引导搜索</em>。</p><p id="2efe" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">引文中的重点是我们的。在这篇文章中，我们在Norachem表明，这些过分的断言经不起推敲。特别是，我们演示了以下内容:</p><p id="95f6" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">权利要求1 </strong>。离散遗传操作可以进入化学空间的区域，这些区域位于化学VAE潜在空间的视界之外。</p><p id="e811" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">权利要求2 </strong>。大的、非结构化的和高维的化学空间向下投射到较低维的潜在空间导致不可接受的信息和结构多样性的损失。</p><p id="bd56" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">但首先，接下来的讨论需要一些背景知识。</p><h1 id="fadc" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">基于梯度的化学VAE搜索</h1><p id="0a28" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们从化学VAE的基于梯度的方法的简要描述开始，其细节可以在原始论文中找到。本文中的图1提供了一个很好的概述，如下所示:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/9a461b90a801484aeec8faa9cc499c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjooLK1iVKwIaLE9MqqvOw.jpeg"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Figure 1 from (Gomez-Bombarelli et al., 2018): An overview of the approach taken by Chemical VAE</figcaption></figure><p id="76dd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">图1(a)示出了分子的规范SMILES表示被转换成高维独热向量，该向量然后被编码器向下映射到较低维的潜在空间。这个潜在空间是基于三个分子特性共同训练的:cLogP、合成可及性得分(SAS)和药物相似性的定量估计(QED)。潜在空间中的每个点通过函数<em class="kg"> f </em>对应于这些属性的有序三元组值。</p><p id="0c34" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">图1(b)说明了如何使用梯度下降来搜索潜在空间中具有最佳分子性质组合的点。当找到一个最佳点时，它被解码器转换成一个高维的独热向量。这个向量然后被转换成一个规范的SMILES字符串。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="5679" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">图1(b)也预示了这种特殊的分子设计计算方法的固有局限性。不言而喻，只有当一个分子的解码被认为是一个等价的化学结构时，它才能被认为存在于潜在空间中。通过这种基于梯度的搜索方法，任何不能被正确解码的分子必然是不可接近的。因此，除非解码器是潜在空间在所有类似药物的化学空间上的满射，否则将会有一大类——通常是非常大的——分子用这种特殊的搜索方法保持不可见。</p><p id="1aec" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">但是化学VAE的解码器显然不是满射。这当然是个问题。符合任何运动设计目标的最佳分子几乎肯定位于看不见的部分，因为潜在空间代表了药物样化学空间中非常薄的一部分。关于这一点，我们将在本文后面有更多的论述。</p><h1 id="d13d" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">离散遗传搜索</h1><p id="1660" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">离散遗传方法操纵分子的原始图论复杂性，而不把它们投射到更简单的线性形式。这种分子的忠实表示允许任何化学结构的重建，从而使该方法接近潜在的所有类药物化学空间。(Gomez-Bombarelli等人，2018年)的作者批评了“人工指定突变和交叉规则的启发式规则”的必要性我们将证明，一个简单的随机方法，没有任何复杂的启发，产生优秀的分子，不能被化学VAE解码。</p><p id="dd27" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">分子遗传创造的简单随机方法可能具有以下两个操作符:</p><p id="dc14" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">算子1 ( <strong class="jf hj"> <em class="kg">随机交叉算子</em> </strong>)。给定两个亲代分子，随机交叉算子通过在随机选择的位置组合亲代来产生子代，如图2所示:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es le"><img src="../Images/67cf98b89397f7fb4c6ce802209d9651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*r5xlvZe5kx5CsE-wLraIjA.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Figure 2: Randomised crossover operation</figcaption></figure><p id="eadc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在左边的母体分子中，红色突出显示的键是一种可能的随机选择。右边绿色的键表示一种可能的方式，通过这种方式，来自双亲的合成片段可以结合形成后代。</p><p id="a056" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">算子2 ( <strong class="jf hj"> <em class="kg">随机变异算子</em> </strong>)。给定一个父分子，随机突变算子通过用另一个原子替换父分子中随机选择的原子来产生子代，如图3所示:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lf"><img src="../Images/d3d2d1db8b46b9d9c0de73b05db75375.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*efK0VGifdn7hXBBCjC9bAw.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Figure 3: Randomised mutation operation</figcaption></figure><p id="fe56" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在左边的母体分子中，红色的氢原子被随机选择，并被绿色的氯原子取代——这本身就是一种随机选择——从而形成了右边的后代。</p><p id="f4c1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">注意，上图中的两个操作符很容易定义和实现。他们不需要繁琐或复杂的手工制作的规则。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="ae54" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">有了这些离散的操作符，我们就可以在类似药物的化学空间中寻找具有上述三种特性的分子:cLogP、SAS和QED。当我们进行搜索时，我们可以记录下遇到的分子中被化学VAE正确解码的部分。得到的序列将为我们提供两种搜索方法所扫描的化学空间的相对大小的良好比较。</p><h1 id="5a31" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">两种搜索方法的比较</h1><p id="168b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">我们的计算实验从一组150个分子开始，这些分子是从250，000个分子的同一集合中随机均匀采样的，化学VAE就是在这些分子上训练的——这确保了诺拉切姆在模拟开始之前不会对类似药物的化学空间有更大的看法。然后，我们对Norachem的生成设计进行了128次迭代，目标是生产出具有三种感兴趣特性的最佳组合的分子。</p><p id="859f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在模拟过程中，随机操作者构建并评估了许多不同的分子结构。对于每次迭代，我们计算从化学VAE的潜在空间中正确解码的结构数量，如下所述:</p><p id="34f2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">对于我们在离散搜索中构建的每个新分子，化学VAE的解码器返回一个可能解码的规范微笑字符串列表。如果下列情况之一为真，则认为分子<em class="kg"> m </em>已被正确解码:</p><ol class=""><li id="340a" class="lg lh hi jf b jg kb jk kc jo li js lj jw lk ka ll lm ln lo bi translated">在<em class="kg"> m </em>的规范微笑表示和化学VAE返回的规范微笑字符串之一之间存在精确匹配，或者</li><li id="ab4a" class="lg lh hi jf b jg lp jk lq jo lr js ls jw lt ka ll lm ln lo bi translated">化学VAE返回的一个规范微笑字符串代表了一个分子，其图形结构与<em class="kg"> m </em>的图形结构同构。</li></ol><p id="97e7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">后一种情况确保了微笑表征中的微小差异不会掩盖分子的潜在结构等价性。前一种检查被包括在内，因为它进行起来更便宜。</p><p id="a562" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这一计算产生了一个序列，为通过化学VAE发现的离散生成的结构的数量建立了一个上限。正确解码结构的累积百分比与迭代次数的关系如图4所示:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lu"><img src="../Images/e3c2b9e706923339cdd7e21cbfbd9407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ecrCeCZ6vq3t756W2cWILA.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Figure 4: The percentage of the discrete search molecules that are visible to Chemical VAE</figcaption></figure><p id="d64a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">第一次迭代中大约有8%的分子被正确解码。随着迭代的进行，这个数字迅速下降，然后稳定在3.5%左右，这意味着通过离散搜索方法构建和评估的分子中有96.5%无法通过化学VAE获得！<strong class="jf hj"> <em class="kg">这为权利要求1 </em> </strong>提供了鲜明的论证。</p><p id="1932" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">即使采用“愚蠢”的随机策略，离散操作者也可以扫描化学VAE无法到达的类似药物的化学空间区域。当我们使用Norachem的人工智能为给定的练习构造接近最优的启发式算子时，这种差异就变得更大了。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="adf7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">当我们比较这两种方法时，必须记住的一个观察结果是，随着迭代次数的增加，化学VAE的趋势一直很低。Norachem的生成设计在每次迭代中都创造出越来越好的分子，因此上面的图4生动地表明了一个令人不安的事实，即基于梯度的化学VAE搜索未能在设计的后期阶段看到大多数好分子。</p><p id="a085" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">图5显示了一个这样的好分子，它被化学VAE未能解码的离散算子发现:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lv"><img src="../Images/6924c0055edc1bbd2f394601e7052d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*ceEXWJ58K03goi6HK11jKA.jpeg"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Figure 5: A sample good molecule that cannot be decoded by Chemical VAE</figcaption></figure><p id="89d5" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这种分子对所有感兴趣的性质都有极好的价值。然而，它对化学VAE仍然是不可见的，正如返回的标准微笑无效这一事实所证明的那样。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="f797" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">我们已经证明，离散算符可以发现化学VAE不能发现的分子。但是反过来可能吗？化学VAE能找到离散算符不能表示的分子吗？</p><p id="a767" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">答案是绝对的<em class="kg">不</em>！这一点已经在离散遗传搜索一节中提出来了。通过非常简单的规定，离散操作者可以重建任何类似药物的分子——尤其是那些可逆向合成的分子。换句话说，这些离散算子扫描的化学区域是由化学VAE的潜在空间所表示的区域的适当超集。</p><h1 id="0e9c" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">依赖VAEs进行药物设计的一些后果</h1><p id="1b14" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">在引言中，我们说明了变分自动编码器方法形成了GENTRL(生成张量强化学习)的核心探索技术，gen TRL是Insilico Medicine的主要深度学习模型。</p><p id="f30b" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">潜在空间连续性的一个重要结果是，梯度下降算子在达到最小值之前遇到各种分子结构的概率非常低。这反过来使得支架跳跃不太可能，并导致与已知文献相差不远的分子推荐——这是一种不理想的情况。<strong class="jf hj"> <em class="kg">这是权利要求2 </em>的依据</strong>。</p><p id="c6fd" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">权利要求2的实质内容得到了以下事实的证实:( Zhavoronkov等人，2019年)的原始出版物很快受到了批评，如(Walters和Murcko，2020年),其中批评者指出GENTRL的最佳化合物的行为是其与已知DDR1激酶抑制剂结构相似的明显结果。在(Zhavoronkov和Aspuru-Guzik，2020年)中，作者试图回应这些批评——我们认为不充分——同时承认GENTRL的化合物缺乏优化。</p></div><div class="ab cl kx ky gp kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="hb hc hd he hf"><p id="d8d7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">诺拉切姆的生成设计是唯一适合回答(Zhavoronkov等人，2020年)和随后的评论提出的挑战。我们将Norachem和GENTRL之间的详细比较分析推迟到以后的文章中。</p><h1 id="8d98" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论</h1><p id="d631" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">主要结论是，基于梯度的方法是搜索巨大和无结构的药物样化学空间的次优方式。任何试图将几乎无限的化学空间向下投射到有限维度的连续表示的尝试都将导致信息的丢失并导致劣质候选药物。</p><p id="3647" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Norachem的生成式设计克服了基于梯度的方法的局限性，它不局限于连续表示，并使用人工智能来优化搜索化学空间不同区域的试探法。</p><h1 id="52bf" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">参考</h1><p id="bbca" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">Gomez-Bombarelli，r .，Wei，J. N .，Duvenaud .，Hernandez-洛巴托，J. M .，Sanchez-Lengeling，b .，Sheberla，d .，Aguilera-iparaguirre，j .，Hirzel，T. D .，Adams，R. P .，Aspuru-Guzik，A. (2018)。使用数据驱动的连续分子表示进行自动化学设计。ACS Cent。Sci。4  (2)，268–276</p><p id="8a8a" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">Zhavoronkov，a .，Ivanenkov，Y. A .，Aliper，a .，Veselov，M. S .，Aladinskiy，V. A .，Aladinskaya，A. V .，Terentiev，V. A .，Polykovskiy，D. A .，Kuznetsov，M. D .，Asadulaev，a .，Volkov，y .，Zholus，a .，Shayakhmetov，R. R .，Zhebrak，a .，Minaeva，L. I .，Zagribelnyy，B. A .，Lee，l深度学习能够快速识别有效的DDR1激酶抑制剂。<em class="kg">自然生物技术37 </em>，1038–1040</p><p id="ce09" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">沃尔特斯，W.P .，穆尔科，M. (2020)。评估生殖人工智能对药物化学的影响。<em class="kg">纳特生物技术公司38 </em>，143-145页。DOI:10.1038/s 41587–020–0418–2</p><p id="913e" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">扎沃龙科夫(2020)。回复‘评估生殖AI对药物化学的影响’。<em class="kg">自然新闻，自然出版集团</em>。<a class="ae lw" href="http://www.nature.com/articles/s41587-020-0417-3" rel="noopener ugc nofollow" target="_blank">www.nature.com/articles/s41587-020-0417-3</a></p></div></div>    
</body>
</html>